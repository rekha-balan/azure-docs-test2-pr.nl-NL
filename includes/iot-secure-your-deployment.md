# <a name="secure-your-iot-deployment"></a><span data-ttu-id="00b76-101">Secure your IoT deployment</span><span class="sxs-lookup"><span data-stu-id="00b76-101">Secure your IoT deployment</span></span>
<span data-ttu-id="00b76-102">This article provides the next level of detail for securing the Azure IoT-based Internet of Things (IoT) infrastructure.</span><span class="sxs-lookup"><span data-stu-id="00b76-102">This article provides the next level of detail for securing the Azure IoT-based Internet of Things (IoT) infrastructure.</span></span> <span data-ttu-id="00b76-103">It links to implementation level details for configuring and deploying each component.</span><span class="sxs-lookup"><span data-stu-id="00b76-103">It links to implementation level details for configuring and deploying each component.</span></span> <span data-ttu-id="00b76-104">It also provides comparisons and choices between various competing methods.</span><span class="sxs-lookup"><span data-stu-id="00b76-104">It also provides comparisons and choices between various competing methods.</span></span>

<span data-ttu-id="00b76-105">Securing the Azure IoT deployment can be divided into the following three security areas:</span><span class="sxs-lookup"><span data-stu-id="00b76-105">Securing the Azure IoT deployment can be divided into the following three security areas:</span></span>

* <span data-ttu-id="00b76-106">**Device Security**: Securing the IoT device while it is deployed in the wild.</span><span class="sxs-lookup"><span data-stu-id="00b76-106">**Device Security**: Securing the IoT device while it is deployed in the wild.</span></span>
* <span data-ttu-id="00b76-107">**Connection Security**: Ensuring all data transmitted between the IoT device and IoT Hub is confidential and tamper-proof.</span><span class="sxs-lookup"><span data-stu-id="00b76-107">**Connection Security**: Ensuring all data transmitted between the IoT device and IoT Hub is confidential and tamper-proof.</span></span>
* <span data-ttu-id="00b76-108">**Cloud Security**: Providing a means to secure data while it moves through, and is stored in the cloud.</span><span class="sxs-lookup"><span data-stu-id="00b76-108">**Cloud Security**: Providing a means to secure data while it moves through, and is stored in the cloud.</span></span>

![Three security areas][img-overview]

## <a name="secure-device-provisioning-and-authentication"></a><span data-ttu-id="00b76-110">Secure device provisioning and authentication</span><span class="sxs-lookup"><span data-stu-id="00b76-110">Secure device provisioning and authentication</span></span>
<span data-ttu-id="00b76-111">The Azure IoT Suite secures IoT devices by the following two methods:</span><span class="sxs-lookup"><span data-stu-id="00b76-111">The Azure IoT Suite secures IoT devices by the following two methods:</span></span>

* <span data-ttu-id="00b76-112">By providing a unique identity key (security tokens) for each device, which can be used by the device to communicate with the IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="00b76-112">By providing a unique identity key (security tokens) for each device, which can be used by the device to communicate with the IoT Hub.</span></span>
* <span data-ttu-id="00b76-113">By using an on-device [X.509 certificate][lnk-x509] and private key as a means to authenticate the device to the IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="00b76-113">By using an on-device [X.509 certificate][lnk-x509] and private key as a means to authenticate the device to the IoT Hub.</span></span> <span data-ttu-id="00b76-114">This authentication method ensures that the private key on the device is not known outside the device at any time, providing a higher level of security.</span><span class="sxs-lookup"><span data-stu-id="00b76-114">This authentication method ensures that the private key on the device is not known outside the device at any time, providing a higher level of security.</span></span>

<span data-ttu-id="00b76-115">The security token method provides authentication for each call made by the device to IoT Hub by associating the symmetric key to each call.</span><span class="sxs-lookup"><span data-stu-id="00b76-115">The security token method provides authentication for each call made by the device to IoT Hub by associating the symmetric key to each call.</span></span> <span data-ttu-id="00b76-116">X.509-based authentication allows authentication of an IoT device at the physical layer as part of the TLS connection establishment.</span><span class="sxs-lookup"><span data-stu-id="00b76-116">X.509-based authentication allows authentication of an IoT device at the physical layer as part of the TLS connection establishment.</span></span> <span data-ttu-id="00b76-117">The security-token-based method can be used without the X.509 authentication which is a less secure pattern.</span><span class="sxs-lookup"><span data-stu-id="00b76-117">The security-token-based method can be used without the X.509 authentication which is a less secure pattern.</span></span> <span data-ttu-id="00b76-118">The choice between the two methods is primarily dictated by how secure the device authentication needs to be, and availability of secure storage on the device (to store the private key securely).</span><span class="sxs-lookup"><span data-stu-id="00b76-118">The choice between the two methods is primarily dictated by how secure the device authentication needs to be, and availability of secure storage on the device (to store the private key securely).</span></span>

## <a name="iot-hub-security-tokens"></a><span data-ttu-id="00b76-119">IoT Hub security tokens</span><span class="sxs-lookup"><span data-stu-id="00b76-119">IoT Hub security tokens</span></span>
<span data-ttu-id="00b76-120">IoT Hub uses security tokens to authenticate devices and services to avoid sending keys on the network.</span><span class="sxs-lookup"><span data-stu-id="00b76-120">IoT Hub uses security tokens to authenticate devices and services to avoid sending keys on the network.</span></span> <span data-ttu-id="00b76-121">Additionally, security tokens are limited in time validity and scope.</span><span class="sxs-lookup"><span data-stu-id="00b76-121">Additionally, security tokens are limited in time validity and scope.</span></span> <span data-ttu-id="00b76-122">Azure IoT SDKs automatically generate tokens without requiring any special configuration.</span><span class="sxs-lookup"><span data-stu-id="00b76-122">Azure IoT SDKs automatically generate tokens without requiring any special configuration.</span></span> <span data-ttu-id="00b76-123">Some scenarios, however, require the user to generate and use security tokens directly.</span><span class="sxs-lookup"><span data-stu-id="00b76-123">Some scenarios, however, require the user to generate and use security tokens directly.</span></span> <span data-ttu-id="00b76-124">These include the direct use of the MQTT, AMQP, or HTTP surfaces, or the implementation of the token service pattern.</span><span class="sxs-lookup"><span data-stu-id="00b76-124">These include the direct use of the MQTT, AMQP, or HTTP surfaces, or the implementation of the token service pattern.</span></span>

<span data-ttu-id="00b76-125">More details on the structure of the security token and its usage can be found in the following articles:</span><span class="sxs-lookup"><span data-stu-id="00b76-125">More details on the structure of the security token and its usage can be found in the following articles:</span></span>

* <span data-ttu-id="00b76-126">[Security token structure][lnk-security-tokens]</span><span class="sxs-lookup"><span data-stu-id="00b76-126">[Security token structure][lnk-security-tokens]</span></span>
* <span data-ttu-id="00b76-127">[Using SAS tokens as a device][lnk-sas-tokens]</span><span class="sxs-lookup"><span data-stu-id="00b76-127">[Using SAS tokens as a device][lnk-sas-tokens]</span></span>

<span data-ttu-id="00b76-128">Each IoT Hub has an [identity registry][lnk-identity-registry] that can be used to create per-device resources in the service, such as a queue that contains in-flight cloud-to-device messages, and to allow access to the device-facing endpoints.</span><span class="sxs-lookup"><span data-stu-id="00b76-128">Each IoT Hub has an [identity registry][lnk-identity-registry] that can be used to create per-device resources in the service, such as a queue that contains in-flight cloud-to-device messages, and to allow access to the device-facing endpoints.</span></span> <span data-ttu-id="00b76-129">The IoT Hub identity registry provides secure storage of device identities and security keys for a solution.</span><span class="sxs-lookup"><span data-stu-id="00b76-129">The IoT Hub identity registry provides secure storage of device identities and security keys for a solution.</span></span> <span data-ttu-id="00b76-130">Individual or groups of device identities can be added to an allow list, or a block list, enabling complete control over device access.</span><span class="sxs-lookup"><span data-stu-id="00b76-130">Individual or groups of device identities can be added to an allow list, or a block list, enabling complete control over device access.</span></span> <span data-ttu-id="00b76-131">The following articles provide more details on the structure of the identity registry and supported operations.</span><span class="sxs-lookup"><span data-stu-id="00b76-131">The following articles provide more details on the structure of the identity registry and supported operations.</span></span>

<span data-ttu-id="00b76-132">[IoT Hub supports protocols such as MQTT, AMQP, and HTTP][lnk-protocols].</span><span class="sxs-lookup"><span data-stu-id="00b76-132">[IoT Hub supports protocols such as MQTT, AMQP, and HTTP][lnk-protocols].</span></span> <span data-ttu-id="00b76-133">Each of these protocols use security tokens from the IoT device to IoT Hub differently:</span><span class="sxs-lookup"><span data-stu-id="00b76-133">Each of these protocols use security tokens from the IoT device to IoT Hub differently:</span></span>

* <span data-ttu-id="00b76-134">AMQP: SASL PLAIN and AMQP Claims-based security ({policyName}@sas.root.{iothubName} in the case of IoT hub-level tokens; {deviceId} in case of device-scoped tokens).</span><span class="sxs-lookup"><span data-stu-id="00b76-134">AMQP: SASL PLAIN and AMQP Claims-based security ({policyName}@sas.root.{iothubName} in the case of IoT hub-level tokens; {deviceId} in case of device-scoped tokens).</span></span>
* <span data-ttu-id="00b76-135">MQTT: CONNECT packet uses {deviceId} as the {ClientId}, {IoThubhostname}/{deviceId} in the **Username** field and a SAS token in the **Password** field.</span><span class="sxs-lookup"><span data-stu-id="00b76-135">MQTT: CONNECT packet uses {deviceId} as the {ClientId}, {IoThubhostname}/{deviceId} in the **Username** field and a SAS token in the **Password** field.</span></span>
* <span data-ttu-id="00b76-136">HTTP: Valid token is in the authorization request header.</span><span class="sxs-lookup"><span data-stu-id="00b76-136">HTTP: Valid token is in the authorization request header.</span></span>

<span data-ttu-id="00b76-137">IoT Hub identity registry can be used to configure per-device security credentials and access control.</span><span class="sxs-lookup"><span data-stu-id="00b76-137">IoT Hub identity registry can be used to configure per-device security credentials and access control.</span></span> <span data-ttu-id="00b76-138">However, if an IoT solution already has a significant investment in a [custom device identity registry and/or authentication scheme][lnk-custom-auth], it can be integrated into an existing infrastructure with IoT Hub by creating a token service.</span><span class="sxs-lookup"><span data-stu-id="00b76-138">However, if an IoT solution already has a significant investment in a [custom device identity registry and/or authentication scheme][lnk-custom-auth], it can be integrated into an existing infrastructure with IoT Hub by creating a token service.</span></span>

### <a name="x509-certificate-based-device-authentication"></a><span data-ttu-id="00b76-139">X.509 certificate-based device authentication</span><span class="sxs-lookup"><span data-stu-id="00b76-139">X.509 certificate-based device authentication</span></span>
<span data-ttu-id="00b76-140">The use of a [device-based X.509 certificate][lnk-use-x509] and its associated private and public key pair allows additional authentication at the physical layer.</span><span class="sxs-lookup"><span data-stu-id="00b76-140">The use of a [device-based X.509 certificate][lnk-use-x509] and its associated private and public key pair allows additional authentication at the physical layer.</span></span> <span data-ttu-id="00b76-141">The private key is stored securely in the device and is not discoverable outside the device.</span><span class="sxs-lookup"><span data-stu-id="00b76-141">The private key is stored securely in the device and is not discoverable outside the device.</span></span> <span data-ttu-id="00b76-142">The X.509 certificate contains information about the device, such as device ID, and other organizational details.</span><span class="sxs-lookup"><span data-stu-id="00b76-142">The X.509 certificate contains information about the device, such as device ID, and other organizational details.</span></span> <span data-ttu-id="00b76-143">A signature of the certificate is generated by using the private key.</span><span class="sxs-lookup"><span data-stu-id="00b76-143">A signature of the certificate is generated by using the private key.</span></span>

<span data-ttu-id="00b76-144">High-level device provisioning flow:</span><span class="sxs-lookup"><span data-stu-id="00b76-144">High-level device provisioning flow:</span></span>

* <span data-ttu-id="00b76-145">Associate an identifier to a physical device – device identity and/or X.509 certificate associated to the device during device manufacturing or commissioning.</span><span class="sxs-lookup"><span data-stu-id="00b76-145">Associate an identifier to a physical device – device identity and/or X.509 certificate associated to the device during device manufacturing or commissioning.</span></span>
* <span data-ttu-id="00b76-146">Create a corresponding identity entry in IoT Hub – device identity and associated device information in the IoT Hub identity registry.</span><span class="sxs-lookup"><span data-stu-id="00b76-146">Create a corresponding identity entry in IoT Hub – device identity and associated device information in the IoT Hub identity registry.</span></span>
* <span data-ttu-id="00b76-147">Securely store X.509 certificate thumbprint in IoT Hub identity registry.</span><span class="sxs-lookup"><span data-stu-id="00b76-147">Securely store X.509 certificate thumbprint in IoT Hub identity registry.</span></span>

### <a name="root-certificate-on-device"></a><span data-ttu-id="00b76-148">Root certificate on device</span><span class="sxs-lookup"><span data-stu-id="00b76-148">Root certificate on device</span></span>
<span data-ttu-id="00b76-149">While establishing a secure TLS connection with IoT Hub, the IoT device authenticates IoT Hub using a root certificate which is part of the device SDK.</span><span class="sxs-lookup"><span data-stu-id="00b76-149">While establishing a secure TLS connection with IoT Hub, the IoT device authenticates IoT Hub using a root certificate which is part of the device SDK.</span></span> <span data-ttu-id="00b76-150">For the C client SDK the certificate is located under the folder "\\c\\certs" under the root of the repo.</span><span class="sxs-lookup"><span data-stu-id="00b76-150">For the C client SDK the certificate is located under the folder "\\c\\certs" under the root of the repo.</span></span> <span data-ttu-id="00b76-151">Though these root certificates are long-lived, they still may expire or be revoked.</span><span class="sxs-lookup"><span data-stu-id="00b76-151">Though these root certificates are long-lived, they still may expire or be revoked.</span></span> <span data-ttu-id="00b76-152">If there is no way of updating the certificate on the device, the device may not be able to subsequently connect to the IoT Hub (or any other cloud service).</span><span class="sxs-lookup"><span data-stu-id="00b76-152">If there is no way of updating the certificate on the device, the device may not be able to subsequently connect to the IoT Hub (or any other cloud service).</span></span> <span data-ttu-id="00b76-153">Having a means to update the root certificate once the IoT device is deployed will effectively mitigate this risk.</span><span class="sxs-lookup"><span data-stu-id="00b76-153">Having a means to update the root certificate once the IoT device is deployed will effectively mitigate this risk.</span></span>

## <a name="securing-the-connection"></a><span data-ttu-id="00b76-154">Securing the connection</span><span class="sxs-lookup"><span data-stu-id="00b76-154">Securing the connection</span></span>
<span data-ttu-id="00b76-155">Internet connection between the IoT device and IoT Hub is secured using the Transport Layer Security (TLS) standard.</span><span class="sxs-lookup"><span data-stu-id="00b76-155">Internet connection between the IoT device and IoT Hub is secured using the Transport Layer Security (TLS) standard.</span></span> <span data-ttu-id="00b76-156">Azure IoT supports [TLS 1.2][lnk-tls12], TLS 1.1 and TLS 1.0, in this order.</span><span class="sxs-lookup"><span data-stu-id="00b76-156">Azure IoT supports [TLS 1.2][lnk-tls12], TLS 1.1 and TLS 1.0, in this order.</span></span> <span data-ttu-id="00b76-157">Support for TLS 1.0 is provided for backward compatibility only.</span><span class="sxs-lookup"><span data-stu-id="00b76-157">Support for TLS 1.0 is provided for backward compatibility only.</span></span> <span data-ttu-id="00b76-158">It is recommended to use TLS 1.2 since it provides the most security.</span><span class="sxs-lookup"><span data-stu-id="00b76-158">It is recommended to use TLS 1.2 since it provides the most security.</span></span>

<span data-ttu-id="00b76-159">Azure IoT Suite supports the following Cipher Suites, in this order.</span><span class="sxs-lookup"><span data-stu-id="00b76-159">Azure IoT Suite supports the following Cipher Suites, in this order.</span></span>

| <span data-ttu-id="00b76-160">Cipher Suite</span><span class="sxs-lookup"><span data-stu-id="00b76-160">Cipher Suite</span></span> | <span data-ttu-id="00b76-161">Length</span><span class="sxs-lookup"><span data-stu-id="00b76-161">Length</span></span> |
| --- | --- |
| <span data-ttu-id="00b76-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="00b76-162">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA384 (0xc028) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="00b76-163">7680 bits RSA) FS</span><span class="sxs-lookup"><span data-stu-id="00b76-163">7680 bits RSA) FS</span></span> |<span data-ttu-id="00b76-164">256</span><span class="sxs-lookup"><span data-stu-id="00b76-164">256</span></span> |
| <span data-ttu-id="00b76-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="00b76-165">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0xc027) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="00b76-166">3072 bits RSA) FS</span><span class="sxs-lookup"><span data-stu-id="00b76-166">3072 bits RSA) FS</span></span> |<span data-ttu-id="00b76-167">128</span><span class="sxs-lookup"><span data-stu-id="00b76-167">128</span></span> |
| <span data-ttu-id="00b76-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="00b76-168">TLS\_ECDHE\_RSA\_WITH\_AES\_256\_CBC\_SHA (0xc014) ECDH secp384r1 (eq.</span></span> <span data-ttu-id="00b76-169">7680 bits RSA) FS</span><span class="sxs-lookup"><span data-stu-id="00b76-169">7680 bits RSA) FS</span></span> |<span data-ttu-id="00b76-170">256</span><span class="sxs-lookup"><span data-stu-id="00b76-170">256</span></span> |
| <span data-ttu-id="00b76-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span><span class="sxs-lookup"><span data-stu-id="00b76-171">TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA (0xc013) ECDH secp256r1 (eq.</span></span> <span data-ttu-id="00b76-172">3072 bits RSA) FS</span><span class="sxs-lookup"><span data-stu-id="00b76-172">3072 bits RSA) FS</span></span> |<span data-ttu-id="00b76-173">128</span><span class="sxs-lookup"><span data-stu-id="00b76-173">128</span></span> |
| <span data-ttu-id="00b76-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span><span class="sxs-lookup"><span data-stu-id="00b76-174">TLS\_RSA\_WITH\_AES\_256\_GCM\_SHA384 (0x9d)</span></span> |<span data-ttu-id="00b76-175">256</span><span class="sxs-lookup"><span data-stu-id="00b76-175">256</span></span> |
| <span data-ttu-id="00b76-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span><span class="sxs-lookup"><span data-stu-id="00b76-176">TLS\_RSA\_WITH\_AES\_128\_GCM\_SHA256 (0x9c)</span></span> |<span data-ttu-id="00b76-177">128</span><span class="sxs-lookup"><span data-stu-id="00b76-177">128</span></span> |
| <span data-ttu-id="00b76-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span><span class="sxs-lookup"><span data-stu-id="00b76-178">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256 (0x3d)</span></span> |<span data-ttu-id="00b76-179">256</span><span class="sxs-lookup"><span data-stu-id="00b76-179">256</span></span> |
| <span data-ttu-id="00b76-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span><span class="sxs-lookup"><span data-stu-id="00b76-180">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA256 (0x3c)</span></span> |<span data-ttu-id="00b76-181">128</span><span class="sxs-lookup"><span data-stu-id="00b76-181">128</span></span> |
| <span data-ttu-id="00b76-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span><span class="sxs-lookup"><span data-stu-id="00b76-182">TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA (0x35)</span></span> |<span data-ttu-id="00b76-183">256</span><span class="sxs-lookup"><span data-stu-id="00b76-183">256</span></span> |
| <span data-ttu-id="00b76-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span><span class="sxs-lookup"><span data-stu-id="00b76-184">TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA (0x2f)</span></span> |<span data-ttu-id="00b76-185">128</span><span class="sxs-lookup"><span data-stu-id="00b76-185">128</span></span> |
| <span data-ttu-id="00b76-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span><span class="sxs-lookup"><span data-stu-id="00b76-186">TLS\_RSA\_WITH\_3DES\_EDE\_CBC\_SHA (0xa)</span></span> |<span data-ttu-id="00b76-187">112</span><span class="sxs-lookup"><span data-stu-id="00b76-187">112</span></span> |

## <a name="securing-the-cloud"></a><span data-ttu-id="00b76-188">Securing the cloud</span><span class="sxs-lookup"><span data-stu-id="00b76-188">Securing the cloud</span></span>
<span data-ttu-id="00b76-189">Azure IoT Hub allows definition of [access control policies][lnk-protocols] for each security key.</span><span class="sxs-lookup"><span data-stu-id="00b76-189">Azure IoT Hub allows definition of [access control policies][lnk-protocols] for each security key.</span></span> <span data-ttu-id="00b76-190">It uses the following set of permissions to grant access to each of IoT Hub's endpoints.</span><span class="sxs-lookup"><span data-stu-id="00b76-190">It uses the following set of permissions to grant access to each of IoT Hub's endpoints.</span></span> <span data-ttu-id="00b76-191">Permissions limit the access to an IoT Hub based on functionality.</span><span class="sxs-lookup"><span data-stu-id="00b76-191">Permissions limit the access to an IoT Hub based on functionality.</span></span>

* <span data-ttu-id="00b76-192">**RegistryRead**.</span><span class="sxs-lookup"><span data-stu-id="00b76-192">**RegistryRead**.</span></span> <span data-ttu-id="00b76-193">Grants read access to the identity registry.</span><span class="sxs-lookup"><span data-stu-id="00b76-193">Grants read access to the identity registry.</span></span> <span data-ttu-id="00b76-194">For more information, see [identity registry][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="00b76-194">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="00b76-195">**RegistryReadWrite**.</span><span class="sxs-lookup"><span data-stu-id="00b76-195">**RegistryReadWrite**.</span></span> <span data-ttu-id="00b76-196">Grants read and write access to the identity registry.</span><span class="sxs-lookup"><span data-stu-id="00b76-196">Grants read and write access to the identity registry.</span></span> <span data-ttu-id="00b76-197">For more information, see [identity registry][lnk-identity-registry].</span><span class="sxs-lookup"><span data-stu-id="00b76-197">For more information, see [identity registry][lnk-identity-registry].</span></span>
* <span data-ttu-id="00b76-198">**ServiceConnect**.</span><span class="sxs-lookup"><span data-stu-id="00b76-198">**ServiceConnect**.</span></span> <span data-ttu-id="00b76-199">Grants access to cloud service-facing communication and monitoring endpoints.</span><span class="sxs-lookup"><span data-stu-id="00b76-199">Grants access to cloud service-facing communication and monitoring endpoints.</span></span> <span data-ttu-id="00b76-200">For example, it grants permission to back-end cloud services to receive device-to-cloud messages, send cloud-to-device messages, and retrieve the corresponding delivery acknowledgments.</span><span class="sxs-lookup"><span data-stu-id="00b76-200">For example, it grants permission to back-end cloud services to receive device-to-cloud messages, send cloud-to-device messages, and retrieve the corresponding delivery acknowledgments.</span></span>
* <span data-ttu-id="00b76-201">**DeviceConnect**.</span><span class="sxs-lookup"><span data-stu-id="00b76-201">**DeviceConnect**.</span></span> <span data-ttu-id="00b76-202">Grants access to device-facing endpoints.</span><span class="sxs-lookup"><span data-stu-id="00b76-202">Grants access to device-facing endpoints.</span></span> <span data-ttu-id="00b76-203">For example, it grants permission to send device-to-cloud messages and receive cloud-to-device messages.</span><span class="sxs-lookup"><span data-stu-id="00b76-203">For example, it grants permission to send device-to-cloud messages and receive cloud-to-device messages.</span></span> <span data-ttu-id="00b76-204">This permission is used by devices.</span><span class="sxs-lookup"><span data-stu-id="00b76-204">This permission is used by devices.</span></span>

<span data-ttu-id="00b76-205">There are two ways to obtain **DeviceConnect** permissions with IoT Hub with [security tokens][lnk-sas-tokens]: using a device identity key, or a shared access key.</span><span class="sxs-lookup"><span data-stu-id="00b76-205">There are two ways to obtain **DeviceConnect** permissions with IoT Hub with [security tokens][lnk-sas-tokens]: using a device identity key, or a shared access key.</span></span> <span data-ttu-id="00b76-206">Moreover, it is important to note that all functionality accessible from devices is exposed by design on endpoints with prefix `/devices/{deviceId}`.</span><span class="sxs-lookup"><span data-stu-id="00b76-206">Moreover, it is important to note that all functionality accessible from devices is exposed by design on endpoints with prefix `/devices/{deviceId}`.</span></span>

<span data-ttu-id="00b76-207">[Service components can only generate security tokens][lnk-service-tokens] using shared access policies granting the appropriate permissions.</span><span class="sxs-lookup"><span data-stu-id="00b76-207">[Service components can only generate security tokens][lnk-service-tokens] using shared access policies granting the appropriate permissions.</span></span>

<span data-ttu-id="00b76-208">Azure IoT Hub and other services which may be part of the solution allow management of users using the Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="00b76-208">Azure IoT Hub and other services which may be part of the solution allow management of users using the Azure Active Directory.</span></span>

<span data-ttu-id="00b76-209">Data ingested by Azure IoT Hub can be consumed by a variety of services such as Azure Stream Analytics and Azure blob storage.</span><span class="sxs-lookup"><span data-stu-id="00b76-209">Data ingested by Azure IoT Hub can be consumed by a variety of services such as Azure Stream Analytics and Azure blob storage.</span></span> <span data-ttu-id="00b76-210">These services allow management access.</span><span class="sxs-lookup"><span data-stu-id="00b76-210">These services allow management access.</span></span> <span data-ttu-id="00b76-211">Read more about these services and available options below:</span><span class="sxs-lookup"><span data-stu-id="00b76-211">Read more about these services and available options below:</span></span>

* <span data-ttu-id="00b76-212">[Azure DocumentDB][lnk-docdb]: A scalable, fully-indexed database service for semi-structured data that manages metadata for the devices you provision, such as attributes, configuration, and security properties.</span><span class="sxs-lookup"><span data-stu-id="00b76-212">[Azure DocumentDB][lnk-docdb]: A scalable, fully-indexed database service for semi-structured data that manages metadata for the devices you provision, such as attributes, configuration, and security properties.</span></span> <span data-ttu-id="00b76-213">DocumentDB offers high-performance and high-throughput processing, schema-agnostic indexing of data, and a rich SQL query interface.</span><span class="sxs-lookup"><span data-stu-id="00b76-213">DocumentDB offers high-performance and high-throughput processing, schema-agnostic indexing of data, and a rich SQL query interface.</span></span>
* <span data-ttu-id="00b76-214">[Azure Stream Analytics][lnk-asa]: Real-time stream processing in the cloud that enables you to rapidly develop and deploy a low-cost analytics solution to uncover real-time insights from devices, sensors, infrastructure, and applications.</span><span class="sxs-lookup"><span data-stu-id="00b76-214">[Azure Stream Analytics][lnk-asa]: Real-time stream processing in the cloud that enables you to rapidly develop and deploy a low-cost analytics solution to uncover real-time insights from devices, sensors, infrastructure, and applications.</span></span> <span data-ttu-id="00b76-215">The data from this fully-managed service can scale to any volume while still achieving high throughput, low latency, and resiliency.</span><span class="sxs-lookup"><span data-stu-id="00b76-215">The data from this fully-managed service can scale to any volume while still achieving high throughput, low latency, and resiliency.</span></span>
* <span data-ttu-id="00b76-216">[Azure App Services][lnk-appservices]: A cloud platform to build powerful web and mobile apps that connect to data anywhere; in the cloud or on-premises.</span><span class="sxs-lookup"><span data-stu-id="00b76-216">[Azure App Services][lnk-appservices]: A cloud platform to build powerful web and mobile apps that connect to data anywhere; in the cloud or on-premises.</span></span> <span data-ttu-id="00b76-217">Build engaging mobile apps for iOS, Android, and Windows.</span><span class="sxs-lookup"><span data-stu-id="00b76-217">Build engaging mobile apps for iOS, Android, and Windows.</span></span> <span data-ttu-id="00b76-218">Integrate with your Software as a Service (SaaS) and enterprise applications with out-of-the-box connectivity to dozens of cloud-based services and enterprise applications.</span><span class="sxs-lookup"><span data-stu-id="00b76-218">Integrate with your Software as a Service (SaaS) and enterprise applications with out-of-the-box connectivity to dozens of cloud-based services and enterprise applications.</span></span> <span data-ttu-id="00b76-219">Code in your favorite language and IDE (.NET, Node.js, PHP, Python, or Java) to build web apps and APIs faster than ever.</span><span class="sxs-lookup"><span data-stu-id="00b76-219">Code in your favorite language and IDE (.NET, Node.js, PHP, Python, or Java) to build web apps and APIs faster than ever.</span></span>
* <span data-ttu-id="00b76-220">[Logic Apps][lnk-logicapps]: The Logic Apps feature of Azure App Service helps integrate your IoT solution to your existing line-of-business systems and automate workflow processes.</span><span class="sxs-lookup"><span data-stu-id="00b76-220">[Logic Apps][lnk-logicapps]: The Logic Apps feature of Azure App Service helps integrate your IoT solution to your existing line-of-business systems and automate workflow processes.</span></span> <span data-ttu-id="00b76-221">Logic Apps enables developers to design workflows that start from a trigger and then execute a series of steps—rules and actions that use powerful connectors to integrate with your business processes.</span><span class="sxs-lookup"><span data-stu-id="00b76-221">Logic Apps enables developers to design workflows that start from a trigger and then execute a series of steps—rules and actions that use powerful connectors to integrate with your business processes.</span></span> <span data-ttu-id="00b76-222">Logic Apps offers out-of-the-box connectivity to a vast ecosystem of SaaS, cloud-based, and on-premises applications.</span><span class="sxs-lookup"><span data-stu-id="00b76-222">Logic Apps offers out-of-the-box connectivity to a vast ecosystem of SaaS, cloud-based, and on-premises applications.</span></span>
* <span data-ttu-id="00b76-223">[Azure blob storage][lnk-blob]: Reliable, economical cloud storage for the data that your devices send to the cloud.</span><span class="sxs-lookup"><span data-stu-id="00b76-223">[Azure blob storage][lnk-blob]: Reliable, economical cloud storage for the data that your devices send to the cloud.</span></span>

## <a name="conclusion"></a><span data-ttu-id="00b76-224">Conclusion</span><span class="sxs-lookup"><span data-stu-id="00b76-224">Conclusion</span></span>
<span data-ttu-id="00b76-225">This article provides overview of implementation level details for designing and deploying an IoT infrastructure using Azure IoT.</span><span class="sxs-lookup"><span data-stu-id="00b76-225">This article provides overview of implementation level details for designing and deploying an IoT infrastructure using Azure IoT.</span></span> <span data-ttu-id="00b76-226">Configuring each component to be secure is key in securing the overall IoT infrastructure.</span><span class="sxs-lookup"><span data-stu-id="00b76-226">Configuring each component to be secure is key in securing the overall IoT infrastructure.</span></span> <span data-ttu-id="00b76-227">The design choices available in Azure IoT provide some level of flexibility and choice; however, each choice may have security implications.</span><span class="sxs-lookup"><span data-stu-id="00b76-227">The design choices available in Azure IoT provide some level of flexibility and choice; however, each choice may have security implications.</span></span> <span data-ttu-id="00b76-228">It is recommended that each of these choices be evaluated through a risk/cost assessment.</span><span class="sxs-lookup"><span data-stu-id="00b76-228">It is recommended that each of these choices be evaluated through a risk/cost assessment.</span></span>

[img-overview]: https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/iot-secure-your-deployment/overview.png

[lnk-security-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#security-token-structure
[lnk-sas-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-sas-tokens-in-a-device-app
[lnk-identity-registry]: ../articles/iot-hub/iot-hub-devguide-identity-registry.md
[lnk-protocols]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-custom-auth]: ../articles/iot-hub/iot-hub-devguide-security.md#custom-device-authentication
[lnk-x509]: http://www.itu.int/rec/T-REC-X.509-201210-I/en
[lnk-use-x509]: ../articles/iot-hub/iot-hub-devguide-security.md
[lnk-tls12]: https://tools.ietf.org/html/rfc5246
[lnk-service-tokens]: ../articles/iot-hub/iot-hub-devguide-security.md#use-security-tokens-from-service-components
[lnk-docdb]: https://azure.microsoft.com/services/documentdb/
[lnk-asa]: https://azure.microsoft.com/services/stream-analytics/
[lnk-appservices]: https://azure.microsoft.com/services/app-service/
[lnk-logicapps]: https://azure.microsoft.com/services/app-service/logic/
[lnk-blob]: https://azure.microsoft.com/services/storage/

