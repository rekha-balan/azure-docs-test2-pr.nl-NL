

<span data-ttu-id="8d9b3-101">For applications that need to scale compute resources out and in, scale operations are implicitly balanced across fault and update domains.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-101">For applications that need to scale compute resources out and in, scale operations are implicitly balanced across fault and update domains.</span></span> <span data-ttu-id="8d9b3-102">For an introduction to VM scale sets refer to the recent [Azure blog announcement](https://azure.microsoft.com/blog/azure-vm-scale-sets-public-preview/).</span><span class="sxs-lookup"><span data-stu-id="8d9b3-102">For an introduction to VM scale sets refer to the recent [Azure blog announcement](https://azure.microsoft.com/blog/azure-vm-scale-sets-public-preview/).</span></span>

<span data-ttu-id="8d9b3-103">Take a look at these videos for more about VM scale sets:</span><span class="sxs-lookup"><span data-stu-id="8d9b3-103">Take a look at these videos for more about VM scale sets:</span></span>

* [<span data-ttu-id="8d9b3-104">Mark Russinovich talks Azure Scale Sets</span><span class="sxs-lookup"><span data-stu-id="8d9b3-104">Mark Russinovich talks Azure Scale Sets</span></span>](https://channel9.msdn.com/Blogs/Regular-IT-Guy/Mark-Russinovich-Talks-Azure-Scale-Sets/)  
* [<span data-ttu-id="8d9b3-105">Virtual Machine Scale Sets with Guy Bowerman</span><span class="sxs-lookup"><span data-stu-id="8d9b3-105">Virtual Machine Scale Sets with Guy Bowerman</span></span>](https://channel9.msdn.com/Shows/Cloud+Cover/Episode-191-Virtual-Machine-Scale-Sets-with-Guy-Bowerman)

## <a name="creating-and-managing-vm-scale-sets"></a><span data-ttu-id="8d9b3-106">Creating and managing VM scale sets</span><span class="sxs-lookup"><span data-stu-id="8d9b3-106">Creating and managing VM scale sets</span></span>
<span data-ttu-id="8d9b3-107">VM scale sets can be defined and deployed using JSON templates and [REST APIs](https://msdn.microsoft.com/library/mt589023.aspx) just like individual Azure Resource Manager VMs.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-107">VM scale sets can be defined and deployed using JSON templates and [REST APIs](https://msdn.microsoft.com/library/mt589023.aspx) just like individual Azure Resource Manager VMs.</span></span> <span data-ttu-id="8d9b3-108">Therefore, any standard Azure Resource Manager deployment methods can be used.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-108">Therefore, any standard Azure Resource Manager deployment methods can be used.</span></span> <span data-ttu-id="8d9b3-109">For more information about templates, see [Authoring Azure Resource Manager templates](../articles/resource-group-authoring-templates.md).</span><span class="sxs-lookup"><span data-stu-id="8d9b3-109">For more information about templates, see [Authoring Azure Resource Manager templates](../articles/resource-group-authoring-templates.md).</span></span>

<span data-ttu-id="8d9b3-110">A set of example templates for VM scale sets can be found in the Azure Quickstart templates GitHub repository here:</span><span class="sxs-lookup"><span data-stu-id="8d9b3-110">A set of example templates for VM scale sets can be found in the Azure Quickstart templates GitHub repository here:</span></span>

<span data-ttu-id="8d9b3-111">[https://github.com/Azure/azure-quickstart-templates](https://github.com/Azure/azure-quickstart-templates) - look for templates with *vmss* in the title.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-111">[https://github.com/Azure/azure-quickstart-templates](https://github.com/Azure/azure-quickstart-templates) - look for templates with *vmss* in the title.</span></span>

<span data-ttu-id="8d9b3-112">In the detail pages for these templates you'll see a button that links to the portal deployment feature.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-112">In the detail pages for these templates you'll see a button that links to the portal deployment feature.</span></span> <span data-ttu-id="8d9b3-113">To deploy the VM scale set, click on the button and then fill in any parameters that are required in the portal.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-113">To deploy the VM scale set, click on the button and then fill in any parameters that are required in the portal.</span></span> <span data-ttu-id="8d9b3-114">If you're not sure whether a resource supports upper or mixed case it is safer to always use lower case parameter values.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-114">If you're not sure whether a resource supports upper or mixed case it is safer to always use lower case parameter values.</span></span> <span data-ttu-id="8d9b3-115">There is also a handy video dissection of a VM scale set template here:</span><span class="sxs-lookup"><span data-stu-id="8d9b3-115">There is also a handy video dissection of a VM scale set template here:</span></span>

[<span data-ttu-id="8d9b3-116">VM Scale Set Template Dissection</span><span class="sxs-lookup"><span data-stu-id="8d9b3-116">VM Scale Set Template Dissection</span></span>](https://channel9.msdn.com/Blogs/Azure/VM-Scale-Set-Template-Dissection/player)

## <a name="scaling-a-vm-scale-set-out-and-in"></a><span data-ttu-id="8d9b3-117">Scaling a VM scale set out and in</span><span class="sxs-lookup"><span data-stu-id="8d9b3-117">Scaling a VM scale set out and in</span></span>
<span data-ttu-id="8d9b3-118">To increase or decrease the number of virtual machines in a VM scale set, simply change the *capacity* property and redeploy the template.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-118">To increase or decrease the number of virtual machines in a VM scale set, simply change the *capacity* property and redeploy the template.</span></span> <span data-ttu-id="8d9b3-119">This simplicity makes it easy to write your own custom scaling layer if you want to define custom scale events that are not supported by Azure autoscale.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-119">This simplicity makes it easy to write your own custom scaling layer if you want to define custom scale events that are not supported by Azure autoscale.</span></span>

<span data-ttu-id="8d9b3-120">If you are redeploying a template to change the capacity, you could define a much smaller template which only includes the SKU and the updated capacity.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-120">If you are redeploying a template to change the capacity, you could define a much smaller template which only includes the SKU and the updated capacity.</span></span> <span data-ttu-id="8d9b3-121">An example of this is shown here: [https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/201-vmss-scale-in-or-out/azuredeploy.json](https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/201-vmss-linux-nat/azuredeploy.json).</span><span class="sxs-lookup"><span data-stu-id="8d9b3-121">An example of this is shown here: [https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/201-vmss-scale-in-or-out/azuredeploy.json](https://raw.githubusercontent.com/Azure/azure-quickstart-templates/master/201-vmss-linux-nat/azuredeploy.json).</span></span>

<span data-ttu-id="8d9b3-122">To walk through the steps that create a scale set that is automatically scaled, see [Automatically Scale Machines in a Virtual Machine Scale Set](../articles/virtual-machines/windows/vmss-powershell-creating.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span><span class="sxs-lookup"><span data-stu-id="8d9b3-122">To walk through the steps that create a scale set that is automatically scaled, see [Automatically Scale Machines in a Virtual Machine Scale Set](../articles/virtual-machines/windows/vmss-powershell-creating.md?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)</span></span>

## <a name="monitoring-your-vm-scale-set"></a><span data-ttu-id="8d9b3-123">Monitoring your VM scale set</span><span class="sxs-lookup"><span data-stu-id="8d9b3-123">Monitoring your VM scale set</span></span>
<span data-ttu-id="8d9b3-124">It is currently recommended you use the [Azure Resource Explorer](https://resources.azure.com) to view VM scale sets.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-124">It is currently recommended you use the [Azure Resource Explorer](https://resources.azure.com) to view VM scale sets.</span></span> <span data-ttu-id="8d9b3-125">VM scale sets are a resource under Microsoft.Compute, so from this site you can see them by expanding the following links:</span><span class="sxs-lookup"><span data-stu-id="8d9b3-125">VM scale sets are a resource under Microsoft.Compute, so from this site you can see them by expanding the following links:</span></span>

    subscriptions -> your subscription -> resourceGroups -> providers -> Microsoft.Compute -> virtualMachineScaleSets -> your VM scale set -> etc.

## <a name="vm-scale-set-scenarios"></a><span data-ttu-id="8d9b3-126">VM scale set scenarios</span><span class="sxs-lookup"><span data-stu-id="8d9b3-126">VM scale set scenarios</span></span>
<span data-ttu-id="8d9b3-127">This section lists some typical VM scale set scenarios.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-127">This section lists some typical VM scale set scenarios.</span></span> <span data-ttu-id="8d9b3-128">Some higher level Azure services (like Batch, Service Fabric, Azure Container Service) will use these scenarios.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-128">Some higher level Azure services (like Batch, Service Fabric, Azure Container Service) will use these scenarios.</span></span>

* <span data-ttu-id="8d9b3-129">**RDP / SSH to VM scale set instances** - A VM scale set is created inside a VNET and individual VMs in are not allocated public IP addresses.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-129">**RDP / SSH to VM scale set instances** - A VM scale set is created inside a VNET and individual VMs in are not allocated public IP addresses.</span></span> <span data-ttu-id="8d9b3-130">This is a good thing because you don't generally want the expense and management overhead of allocating separate IP addresses to all the stateless resources in your compute grid, and you can easily connect to these VMs from other resources in your VNET including ones which have public IP addresses like load balancers or standalone virtual machines.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-130">This is a good thing because you don't generally want the expense and management overhead of allocating separate IP addresses to all the stateless resources in your compute grid, and you can easily connect to these VMs from other resources in your VNET including ones which have public IP addresses like load balancers or standalone virtual machines.</span></span>
* <span data-ttu-id="8d9b3-131">**Connect to VMs using NAT rules** - You can create a public IP address, assign it to a load balancer, and define inbound NAT rules which map a port on the IP address to a port on a VM in the VM scale set.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-131">**Connect to VMs using NAT rules** - You can create a public IP address, assign it to a load balancer, and define inbound NAT rules which map a port on the IP address to a port on a VM in the VM scale set.</span></span> <span data-ttu-id="8d9b3-132">E.g.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-132">E.g.</span></span>
  
   <span data-ttu-id="8d9b3-133">Public IP->Port 50000 -> vmss\_0->Port 22  Public IP->Port 50001 -> vmss\_1->Port 22  Public IP->Port 50002-> vmss\_2->Port 22</span><span class="sxs-lookup"><span data-stu-id="8d9b3-133">Public IP->Port 50000 -> vmss\_0->Port 22  Public IP->Port 50001 -> vmss\_1->Port 22  Public IP->Port 50002-> vmss\_2->Port 22</span></span>
  
   <span data-ttu-id="8d9b3-134">Here's an example of creating a VM scale set which uses NAT rules to enable SSH connection to every VM in a scale set using a single public IP: [https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-linux-nat](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-linux-nat)</span><span class="sxs-lookup"><span data-stu-id="8d9b3-134">Here's an example of creating a VM scale set which uses NAT rules to enable SSH connection to every VM in a scale set using a single public IP: [https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-linux-nat](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-linux-nat)</span></span>
  
   <span data-ttu-id="8d9b3-135">Here's an example of doing the same with RDP and Windows: [https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-windows-nat](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-windows-nat)</span><span class="sxs-lookup"><span data-stu-id="8d9b3-135">Here's an example of doing the same with RDP and Windows: [https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-windows-nat](https://github.com/Azure/azure-quickstart-templates/tree/master/201-vmss-windows-nat)</span></span>
* <span data-ttu-id="8d9b3-136">**Connect to VMs using a "jumpbox"** - If you create a VM scale set and a standalone VM in the same VNET, the standalone VM and the VM scale set VMs can connect to one another using their internal IP addresses as defined by the VNET/Subnet.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-136">**Connect to VMs using a "jumpbox"** - If you create a VM scale set and a standalone VM in the same VNET, the standalone VM and the VM scale set VMs can connect to one another using their internal IP addresses as defined by the VNET/Subnet.</span></span> <span data-ttu-id="8d9b3-137">If you create a public IP address and assign it to the standalone VM you can RDP or SSH to the standalone VM and then connect from that machine to your VM scale set instances.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-137">If you create a public IP address and assign it to the standalone VM you can RDP or SSH to the standalone VM and then connect from that machine to your VM scale set instances.</span></span> <span data-ttu-id="8d9b3-138">You may notice at this point that a simple VM scale set is inherently more secure than a simple standalone VM with a public IP address in its default configuration.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-138">You may notice at this point that a simple VM scale set is inherently more secure than a simple standalone VM with a public IP address in its default configuration.</span></span>
  
   <span data-ttu-id="8d9b3-139">For an example of this approach, this template creates a simple Mesos cluster consisting of a standalone Master VM which manages a VM scale-set based cluster of VMs: [https://github.com/gbowerman/azure-myriad/blob/master/mesos-vmss-simple-cluster.json](https://github.com/gbowerman/azure-myriad/blob/master/mesos-vmss-simple-cluster.json)</span><span class="sxs-lookup"><span data-stu-id="8d9b3-139">For an example of this approach, this template creates a simple Mesos cluster consisting of a standalone Master VM which manages a VM scale-set based cluster of VMs: [https://github.com/gbowerman/azure-myriad/blob/master/mesos-vmss-simple-cluster.json](https://github.com/gbowerman/azure-myriad/blob/master/mesos-vmss-simple-cluster.json)</span></span>
* <span data-ttu-id="8d9b3-140">**Round robin load balancing to VM scale set instances** - If you want to deliver work to a compute cluster of VMs using a "round-robin" approach, you can configure an Azure load balancer with load-balancing rules accordingly.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-140">**Round robin load balancing to VM scale set instances** - If you want to deliver work to a compute cluster of VMs using a "round-robin" approach, you can configure an Azure load balancer with load-balancing rules accordingly.</span></span> <span data-ttu-id="8d9b3-141">You can also define probes to verify your application is running by pinging ports with a specified protocol, interval and request path.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-141">You can also define probes to verify your application is running by pinging ports with a specified protocol, interval and request path.</span></span>
  
   <span data-ttu-id="8d9b3-142">Here is an example which creates a VM scale set of VMs running IIS web server, and uses a load balancer to balance the load that each VM receives.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-142">Here is an example which creates a VM scale set of VMs running IIS web server, and uses a load balancer to balance the load that each VM receives.</span></span> <span data-ttu-id="8d9b3-143">It also uses the HTTP protocol to ping a specific URL on each VM: [https://github.com/gbowerman/azure-myriad/blob/master/vmss-win-iis-vnet-storage-lb.json](https://github.com/gbowerman/azure-myriad/blob/master/vmss-win-iis-vnet-storage-lb.json) - look at the Microsoft.Network/loadBalancers resource type and the networkProfile and extensionProfile in the virtualMachineScaleSet.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-143">It also uses the HTTP protocol to ping a specific URL on each VM: [https://github.com/gbowerman/azure-myriad/blob/master/vmss-win-iis-vnet-storage-lb.json](https://github.com/gbowerman/azure-myriad/blob/master/vmss-win-iis-vnet-storage-lb.json) - look at the Microsoft.Network/loadBalancers resource type and the networkProfile and extensionProfile in the virtualMachineScaleSet.</span></span>
* <span data-ttu-id="8d9b3-144">**Deploying a VM scale set as a compute cluster in a PaaS cluster manager** - VM scale sets are sometimes described as a next-generation worker role.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-144">**Deploying a VM scale set as a compute cluster in a PaaS cluster manager** - VM scale sets are sometimes described as a next-generation worker role.</span></span> <span data-ttu-id="8d9b3-145">It's a valid description but it also runs the risk of confusing scale set features with PaaS v1 Worker role features.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-145">It's a valid description but it also runs the risk of confusing scale set features with PaaS v1 Worker role features.</span></span> <span data-ttu-id="8d9b3-146">In a sense VM scale sets provide a true "worker role" or worker resource, in that they provide a generalized compute resource which is platform/runtime independent, customizable and integrates into Azure Resource Manager IaaS.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-146">In a sense VM scale sets provide a true "worker role" or worker resource, in that they provide a generalized compute resource which is platform/runtime independent, customizable and integrates into Azure Resource Manager IaaS.</span></span>
  
   <span data-ttu-id="8d9b3-147">A PaaS v1 worker role, while limited in terms of platform/runtime support (Windows platform images only) also includes services such as VIP swap, configurable upgrade settings, runtime/app deployment specific settings which are either not *yet* available in VM scale sets, or will be delivered by other higher level PaaS services like Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-147">A PaaS v1 worker role, while limited in terms of platform/runtime support (Windows platform images only) also includes services such as VIP swap, configurable upgrade settings, runtime/app deployment specific settings which are either not *yet* available in VM scale sets, or will be delivered by other higher level PaaS services like Service Fabric.</span></span> <span data-ttu-id="8d9b3-148">With this in mind you can look at VM scale sets as an infrastructure which supports PaaS.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-148">With this in mind you can look at VM scale sets as an infrastructure which supports PaaS.</span></span> <span data-ttu-id="8d9b3-149">I.e. PaaS solutions like Service Fabric or cluster managers like Mesos can build on top of VM scale sets as a scalable compute layer.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-149">I.e. PaaS solutions like Service Fabric or cluster managers like Mesos can build on top of VM scale sets as a scalable compute layer.</span></span>
  
   <span data-ttu-id="8d9b3-150">Here is an example of a Mesos cluster which deploys a VM Scale Set in the same VNET as a standalone VM.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-150">Here is an example of a Mesos cluster which deploys a VM Scale Set in the same VNET as a standalone VM.</span></span> <span data-ttu-id="8d9b3-151">The standalone VM is a Mesos master, and the VM scale set represents a set of slave nodes: [https://github.com/gbowerman/azure-myriad/blob/master/mesos-vmss-simple-cluster.json](https://github.com/gbowerman/azure-myriad/blob/master/mesos-vmss-simple-cluster.json).</span><span class="sxs-lookup"><span data-stu-id="8d9b3-151">The standalone VM is a Mesos master, and the VM scale set represents a set of slave nodes: [https://github.com/gbowerman/azure-myriad/blob/master/mesos-vmss-simple-cluster.json](https://github.com/gbowerman/azure-myriad/blob/master/mesos-vmss-simple-cluster.json).</span></span> <span data-ttu-id="8d9b3-152">Future versions of the [Azure Container Service](https://azure.microsoft.com/blog/azure-container-service-now-and-the-future/) will deploy more complex/hardened versions of this scenario based on VM scale sets.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-152">Future versions of the [Azure Container Service](https://azure.microsoft.com/blog/azure-container-service-now-and-the-future/) will deploy more complex/hardened versions of this scenario based on VM scale sets.</span></span>

## <a name="vm-scale-set-performance-and-scale-guidance"></a><span data-ttu-id="8d9b3-153">VM scale set performance and scale guidance</span><span class="sxs-lookup"><span data-stu-id="8d9b3-153">VM scale set performance and scale guidance</span></span>
* <span data-ttu-id="8d9b3-154">During the public preview, do not create more than 500 VMs in multiple VM Scale Sets at a time.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-154">During the public preview, do not create more than 500 VMs in multiple VM Scale Sets at a time.</span></span>
* <span data-ttu-id="8d9b3-155">Plan for no more than 40 VMs per storage account.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-155">Plan for no more than 40 VMs per storage account.</span></span>
* <span data-ttu-id="8d9b3-156">Spread out the first letters of storage account names as much as possible.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-156">Spread out the first letters of storage account names as much as possible.</span></span>  <span data-ttu-id="8d9b3-157">The example VMSS templates in [Azure Quickstart templates](https://github.com/Azure/azure-quickstart-templates/) provide examples of how to do this.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-157">The example VMSS templates in [Azure Quickstart templates](https://github.com/Azure/azure-quickstart-templates/) provide examples of how to do this.</span></span>
* <span data-ttu-id="8d9b3-158">If using custom VMs, plan for no more than 40 VMs per VM scale set, in a single storage account.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-158">If using custom VMs, plan for no more than 40 VMs per VM scale set, in a single storage account.</span></span>  <span data-ttu-id="8d9b3-159">You will need the image pre-copied into the storage account before you can begin VM scale set deployment.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-159">You will need the image pre-copied into the storage account before you can begin VM scale set deployment.</span></span> <span data-ttu-id="8d9b3-160">See the FAQ for more information.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-160">See the FAQ for more information.</span></span>
* <span data-ttu-id="8d9b3-161">Plan for no more than 2048 VMs per VNET.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-161">Plan for no more than 2048 VMs per VNET.</span></span>  <span data-ttu-id="8d9b3-162">This limit will be increased in the future.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-162">This limit will be increased in the future.</span></span>
* <span data-ttu-id="8d9b3-163">The number of VMs you can create is limited by your Compute core quota in any region.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-163">The number of VMs you can create is limited by your Compute core quota in any region.</span></span> <span data-ttu-id="8d9b3-164">You may need to contact Customer Support to increase your Compute quota limit increased even if you have a high limit of cores for use with cloud services or IaaS v1 today.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-164">You may need to contact Customer Support to increase your Compute quota limit increased even if you have a high limit of cores for use with cloud services or IaaS v1 today.</span></span> <span data-ttu-id="8d9b3-165">To query your quota you can run the following Azure CLI command: *azure vm list-usage*, and the following PowerShell command: *Get-AzureRmVMUsage* (if using a version of PowerShell below 1.0 use *Get-AzureVMUsage*).</span><span class="sxs-lookup"><span data-stu-id="8d9b3-165">To query your quota you can run the following Azure CLI command: *azure vm list-usage*, and the following PowerShell command: *Get-AzureRmVMUsage* (if using a version of PowerShell below 1.0 use *Get-AzureVMUsage*).</span></span>

## <a name="vm-scale-set-frequently-asked-questions"></a><span data-ttu-id="8d9b3-166">VM scale set frequently asked questions</span><span class="sxs-lookup"><span data-stu-id="8d9b3-166">VM scale set frequently asked questions</span></span>
<span data-ttu-id="8d9b3-167">**Q.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-167">**Q.**</span></span> <span data-ttu-id="8d9b3-168">How many VMs can you have in a VM scale set?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-168">How many VMs can you have in a VM scale set?</span></span>

<span data-ttu-id="8d9b3-169">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-169">**A.**</span></span> <span data-ttu-id="8d9b3-170">100 if you use platform images which can be distributed across multiple storage accounts.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-170">100 if you use platform images which can be distributed across multiple storage accounts.</span></span> <span data-ttu-id="8d9b3-171">If you use custom images, up to 40, since custom images are limited to a single storage account during preview.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-171">If you use custom images, up to 40, since custom images are limited to a single storage account during preview.</span></span>

<span data-ttu-id="8d9b3-172">**Q** What other resource limits exist for VM scale sets?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-172">**Q** What other resource limits exist for VM scale sets?</span></span>

<span data-ttu-id="8d9b3-173">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-173">**A.**</span></span> <span data-ttu-id="8d9b3-174">You are limited to creating no more than 500 VMs in multiple scale sets per region during the preview period.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-174">You are limited to creating no more than 500 VMs in multiple scale sets per region during the preview period.</span></span> <span data-ttu-id="8d9b3-175">The existing [Azure Subscription Service Limits/](../articles/azure-subscription-service-limits.md) apply.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-175">The existing [Azure Subscription Service Limits/](../articles/azure-subscription-service-limits.md) apply.</span></span>

<span data-ttu-id="8d9b3-176">**Q.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-176">**Q.**</span></span> <span data-ttu-id="8d9b3-177">Are Data Disks Supported within VM scale sets?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-177">Are Data Disks Supported within VM scale sets?</span></span>

<span data-ttu-id="8d9b3-178">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-178">**A.**</span></span> <span data-ttu-id="8d9b3-179">Not in the initial release.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-179">Not in the initial release.</span></span> <span data-ttu-id="8d9b3-180">Your options for storing data are:</span><span class="sxs-lookup"><span data-stu-id="8d9b3-180">Your options for storing data are:</span></span>

* <span data-ttu-id="8d9b3-181">Azure files (SMB shared drives)</span><span class="sxs-lookup"><span data-stu-id="8d9b3-181">Azure files (SMB shared drives)</span></span>
* <span data-ttu-id="8d9b3-182">OS drive</span><span class="sxs-lookup"><span data-stu-id="8d9b3-182">OS drive</span></span>
* <span data-ttu-id="8d9b3-183">Temp drive (local, not backed by Azure storage)</span><span class="sxs-lookup"><span data-stu-id="8d9b3-183">Temp drive (local, not backed by Azure storage)</span></span>
* <span data-ttu-id="8d9b3-184">External data service (e.g. remote DB, Azure tables, Azure blobs)</span><span class="sxs-lookup"><span data-stu-id="8d9b3-184">External data service (e.g. remote DB, Azure tables, Azure blobs)</span></span>

<span data-ttu-id="8d9b3-185">**Q.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-185">**Q.**</span></span> <span data-ttu-id="8d9b3-186">Which Azure regions support for VM scale sets?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-186">Which Azure regions support for VM scale sets?</span></span>

<span data-ttu-id="8d9b3-187">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-187">**A.**</span></span> <span data-ttu-id="8d9b3-188">Any region which supports Azure Resource Manager supports VM Scale Sets.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-188">Any region which supports Azure Resource Manager supports VM Scale Sets.</span></span>

<span data-ttu-id="8d9b3-189">**Q.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-189">**Q.**</span></span> <span data-ttu-id="8d9b3-190">How do you create a VM scale sets using a custom image?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-190">How do you create a VM scale sets using a custom image?</span></span>

<span data-ttu-id="8d9b3-191">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-191">**A.**</span></span> <span data-ttu-id="8d9b3-192">Leave the vhdContainers property blank, for example:</span><span class="sxs-lookup"><span data-stu-id="8d9b3-192">Leave the vhdContainers property blank, for example:</span></span>

    "storageProfile": {
        "osDisk": {
            "name": "vmssosdisk",
            "caching": "ReadOnly",
            "createOption": "FromImage",
            "image": {
                "uri": [https://mycustomimage.blob.core.windows.net/system/Microsoft.Compute/Images/mytemplates/template-osDisk.vhd](https://mycustomimage.blob.core.windows.net/system/Microsoft.Compute/Images/mytemplates/template-osDisk.vhd)
            },
            "osType": "Windows"
        }
    },


<span data-ttu-id="8d9b3-193">**Q.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-193">**Q.**</span></span> <span data-ttu-id="8d9b3-194">If I reduce my VM scale set capacity from 20 to 15, which VMs will be removed?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-194">If I reduce my VM scale set capacity from 20 to 15, which VMs will be removed?</span></span>

<span data-ttu-id="8d9b3-195">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-195">**A.**</span></span> <span data-ttu-id="8d9b3-196">Virtual machines are removed from the scale set evenly across upgrade domains and fault domains to maximize availability.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-196">Virtual machines are removed from the scale set evenly across upgrade domains and fault domains to maximize availability.</span></span>

<span data-ttu-id="8d9b3-197">**Q.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-197">**Q.**</span></span> <span data-ttu-id="8d9b3-198">How about it if I then increase the capacity from 15 to 18?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-198">How about it if I then increase the capacity from 15 to 18?</span></span>

<span data-ttu-id="8d9b3-199">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-199">**A.**</span></span> <span data-ttu-id="8d9b3-200">If you increase to 18, VMs with index 15, 16, 17 will be created.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-200">If you increase to 18, VMs with index 15, 16, 17 will be created.</span></span> <span data-ttu-id="8d9b3-201">In both cases the VMs are balanced across FDs and UDs.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-201">In both cases the VMs are balanced across FDs and UDs.</span></span>

<span data-ttu-id="8d9b3-202">**Q.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-202">**Q.**</span></span> <span data-ttu-id="8d9b3-203">When using multiple extensions in a VM scale set, can I enforce an execution sequence?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-203">When using multiple extensions in a VM scale set, can I enforce an execution sequence?</span></span>

<span data-ttu-id="8d9b3-204">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-204">**A.**</span></span> <span data-ttu-id="8d9b3-205">Not directly, but for the customScript extension, your script could wait for another extension to complete (for example by monitoring the extension log - see [https://github.com/Azure/azure-quickstart-templates/blob/master/201-vmss-lapstack-autoscale/install\_lap.sh](https://github.com/Azure/azure-quickstart-templates/blob/master/201-vmss-lapstack-autoscale/install_lap.sh)).</span><span class="sxs-lookup"><span data-stu-id="8d9b3-205">Not directly, but for the customScript extension, your script could wait for another extension to complete (for example by monitoring the extension log - see [https://github.com/Azure/azure-quickstart-templates/blob/master/201-vmss-lapstack-autoscale/install\_lap.sh](https://github.com/Azure/azure-quickstart-templates/blob/master/201-vmss-lapstack-autoscale/install_lap.sh)).</span></span>

<span data-ttu-id="8d9b3-206">**Q.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-206">**Q.**</span></span> <span data-ttu-id="8d9b3-207">Do VM scale sets work with Azure availability sets?</span><span class="sxs-lookup"><span data-stu-id="8d9b3-207">Do VM scale sets work with Azure availability sets?</span></span>

<span data-ttu-id="8d9b3-208">**A.**</span><span class="sxs-lookup"><span data-stu-id="8d9b3-208">**A.**</span></span> <span data-ttu-id="8d9b3-209">Yes.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-209">Yes.</span></span> <span data-ttu-id="8d9b3-210">A VM scale set is an implicit availability set with 3 FDs and 5 UDs.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-210">A VM scale set is an implicit availability set with 3 FDs and 5 UDs.</span></span> <span data-ttu-id="8d9b3-211">You don't need to configure anything under virtualMachineProfile.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-211">You don't need to configure anything under virtualMachineProfile.</span></span> <span data-ttu-id="8d9b3-212">In future releases, VM scale sets are likely to span multiple tenants but for now a scale set is a single availability set.</span><span class="sxs-lookup"><span data-stu-id="8d9b3-212">In future releases, VM scale sets are likely to span multiple tenants but for now a scale set is a single availability set.</span></span>

