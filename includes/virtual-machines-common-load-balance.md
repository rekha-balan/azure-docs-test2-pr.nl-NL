

<span data-ttu-id="eee75-101">There are two levels of load balancing available for Azure infrastructure services:</span><span class="sxs-lookup"><span data-stu-id="eee75-101">There are two levels of load balancing available for Azure infrastructure services:</span></span>

* <span data-ttu-id="eee75-102">**DNS Level**:  Load balancing for traffic to different cloud services located in different data centers, to different Azure websites located in different data centers, or to external endpoints.</span><span class="sxs-lookup"><span data-stu-id="eee75-102">**DNS Level**:  Load balancing for traffic to different cloud services located in different data centers, to different Azure websites located in different data centers, or to external endpoints.</span></span> <span data-ttu-id="eee75-103">This is done with Azure Traffic Manager and the Round Robin load balancing method.</span><span class="sxs-lookup"><span data-stu-id="eee75-103">This is done with Azure Traffic Manager and the Round Robin load balancing method.</span></span>
* <span data-ttu-id="eee75-104">**Network Level**:  Load balancing of incoming Internet traffic to different virtual machines of a cloud service, or load balancing of traffic between virtual machines in a cloud service or virtual network.</span><span class="sxs-lookup"><span data-stu-id="eee75-104">**Network Level**:  Load balancing of incoming Internet traffic to different virtual machines of a cloud service, or load balancing of traffic between virtual machines in a cloud service or virtual network.</span></span> <span data-ttu-id="eee75-105">This is done with the Azure load balancer.</span><span class="sxs-lookup"><span data-stu-id="eee75-105">This is done with the Azure load balancer.</span></span>

## <a name="traffic-manager-load-balancing-for-cloud-services-and-websites"></a><span data-ttu-id="eee75-106">Traffic Manager load balancing for cloud services and websites</span><span class="sxs-lookup"><span data-stu-id="eee75-106">Traffic Manager load balancing for cloud services and websites</span></span>
<span data-ttu-id="eee75-107">Traffic Manager allows you to control the distribution of user traffic to endpoints, which can include cloud services, websites, external sites, and other Traffic Manager profiles.</span><span class="sxs-lookup"><span data-stu-id="eee75-107">Traffic Manager allows you to control the distribution of user traffic to endpoints, which can include cloud services, websites, external sites, and other Traffic Manager profiles.</span></span> <span data-ttu-id="eee75-108">Traffic Manager works by applying an intelligent policy engine to Domain Name System (DNS) queries for the domain names of your Internet resources.</span><span class="sxs-lookup"><span data-stu-id="eee75-108">Traffic Manager works by applying an intelligent policy engine to Domain Name System (DNS) queries for the domain names of your Internet resources.</span></span> <span data-ttu-id="eee75-109">Your cloud services or websites can be running in different datacenters across the world.</span><span class="sxs-lookup"><span data-stu-id="eee75-109">Your cloud services or websites can be running in different datacenters across the world.</span></span>

<span data-ttu-id="eee75-110">You must use either REST or Windows PowerShell to configure external endpoints or Traffic Manager profiles as endpoints.</span><span class="sxs-lookup"><span data-stu-id="eee75-110">You must use either REST or Windows PowerShell to configure external endpoints or Traffic Manager profiles as endpoints.</span></span>

<span data-ttu-id="eee75-111">Traffic Manager uses three load-balancing methods to distribute traffic:</span><span class="sxs-lookup"><span data-stu-id="eee75-111">Traffic Manager uses three load-balancing methods to distribute traffic:</span></span>

* <span data-ttu-id="eee75-112">**Failover**:  Use this method when you want to use a primary endpoint for all traffic, but provide backups in case the primary becomes unavailable.</span><span class="sxs-lookup"><span data-stu-id="eee75-112">**Failover**:  Use this method when you want to use a primary endpoint for all traffic, but provide backups in case the primary becomes unavailable.</span></span>
* <span data-ttu-id="eee75-113">**Performance**:  Use this method when you have endpoints in different geographic locations and you want requesting clients to use the "closest" endpoint in terms of the lowest latency.</span><span class="sxs-lookup"><span data-stu-id="eee75-113">**Performance**:  Use this method when you have endpoints in different geographic locations and you want requesting clients to use the "closest" endpoint in terms of the lowest latency.</span></span>
* <span data-ttu-id="eee75-114">**Round Robin:**  Use this method when you want to distribute load across a set of cloud services in the same datacenter or across cloud services or websites in different datacenters.</span><span class="sxs-lookup"><span data-stu-id="eee75-114">**Round Robin:**  Use this method when you want to distribute load across a set of cloud services in the same datacenter or across cloud services or websites in different datacenters.</span></span>

<span data-ttu-id="eee75-115">For more information, see [About Traffic Manager Load Balancing Methods](../articles/traffic-manager/traffic-manager-routing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="eee75-115">For more information, see [About Traffic Manager Load Balancing Methods](../articles/traffic-manager/traffic-manager-routing-methods.md).</span></span>

<span data-ttu-id="eee75-116">The following diagram shows an example of the Round Robin load balancing method for distributing traffic between different cloud services.</span><span class="sxs-lookup"><span data-stu-id="eee75-116">The following diagram shows an example of the Round Robin load balancing method for distributing traffic between different cloud services.</span></span>

![loadbalancing](https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/virtual-machines-common-load-balance/TMSummary.png)

<span data-ttu-id="eee75-118">The basic process is the following:</span><span class="sxs-lookup"><span data-stu-id="eee75-118">The basic process is the following:</span></span>

1. <span data-ttu-id="eee75-119">An Internet client queries a domain name corresponding to a web service.</span><span class="sxs-lookup"><span data-stu-id="eee75-119">An Internet client queries a domain name corresponding to a web service.</span></span>
2. <span data-ttu-id="eee75-120">DNS forwards the name query request to Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="eee75-120">DNS forwards the name query request to Traffic Manager.</span></span>
3. <span data-ttu-id="eee75-121">Traffic Manager chooses the next cloud service in the Round Robin list and sends back the DNS name.</span><span class="sxs-lookup"><span data-stu-id="eee75-121">Traffic Manager chooses the next cloud service in the Round Robin list and sends back the DNS name.</span></span> <span data-ttu-id="eee75-122">The Internet client's DNS server resolves the name to an IP address and sends it to the Internet client.</span><span class="sxs-lookup"><span data-stu-id="eee75-122">The Internet client's DNS server resolves the name to an IP address and sends it to the Internet client.</span></span>
4. <span data-ttu-id="eee75-123">The Internet client connects with the cloud service chosen by Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="eee75-123">The Internet client connects with the cloud service chosen by Traffic Manager.</span></span>

<span data-ttu-id="eee75-124">For more information, see [Traffic Manager](../articles/traffic-manager/traffic-manager-overview.md).</span><span class="sxs-lookup"><span data-stu-id="eee75-124">For more information, see [Traffic Manager](../articles/traffic-manager/traffic-manager-overview.md).</span></span>

## <a name="azure-load-balancing-for-virtual-machines"></a><span data-ttu-id="eee75-125">Azure load balancing for virtual machines</span><span class="sxs-lookup"><span data-stu-id="eee75-125">Azure load balancing for virtual machines</span></span>
<span data-ttu-id="eee75-126">Virtual machines in the same cloud service or virtual network can communicate with each other directly using their private IP addresses.</span><span class="sxs-lookup"><span data-stu-id="eee75-126">Virtual machines in the same cloud service or virtual network can communicate with each other directly using their private IP addresses.</span></span> <span data-ttu-id="eee75-127">Computers and services outside the cloud service or virtual network can only communicate with virtual machines in a cloud service or virtual network with a configured endpoint.</span><span class="sxs-lookup"><span data-stu-id="eee75-127">Computers and services outside the cloud service or virtual network can only communicate with virtual machines in a cloud service or virtual network with a configured endpoint.</span></span> <span data-ttu-id="eee75-128">An endpoint is a mapping of a public IP address and port to that private IP address and port of a virtual machine or web role within an Azure cloud service.</span><span class="sxs-lookup"><span data-stu-id="eee75-128">An endpoint is a mapping of a public IP address and port to that private IP address and port of a virtual machine or web role within an Azure cloud service.</span></span>

<span data-ttu-id="eee75-129">The Azure Load Balancer randomly distributes a specific type of incoming traffic across multiple virtual machines or services in a configuration known as a load-balanced set.</span><span class="sxs-lookup"><span data-stu-id="eee75-129">The Azure Load Balancer randomly distributes a specific type of incoming traffic across multiple virtual machines or services in a configuration known as a load-balanced set.</span></span> <span data-ttu-id="eee75-130">For example, you can spread the load of web request traffic across multiple web servers or web roles.</span><span class="sxs-lookup"><span data-stu-id="eee75-130">For example, you can spread the load of web request traffic across multiple web servers or web roles.</span></span>

<span data-ttu-id="eee75-131">The following diagram shows a load-balanced endpoint for standard (unencrypted) web traffic that is shared among three virtual machines for the public and private TCP port of 80.</span><span class="sxs-lookup"><span data-stu-id="eee75-131">The following diagram shows a load-balanced endpoint for standard (unencrypted) web traffic that is shared among three virtual machines for the public and private TCP port of 80.</span></span> <span data-ttu-id="eee75-132">These three virtual machines are in a load-balanced set.</span><span class="sxs-lookup"><span data-stu-id="eee75-132">These three virtual machines are in a load-balanced set.</span></span>

![loadbalancing](https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/virtual-machines-common-load-balance/LoadBalancing.png)

<span data-ttu-id="eee75-134">For more information, see [Azure Load Balancer](../articles/load-balancer/load-balancer-overview.md).</span><span class="sxs-lookup"><span data-stu-id="eee75-134">For more information, see [Azure Load Balancer](../articles/load-balancer/load-balancer-overview.md).</span></span> <span data-ttu-id="eee75-135">For the steps to create a load-balanced set, see [Configure a load-balanced set](../articles/load-balancer/load-balancer-get-started-internet-arm-ps.md).</span><span class="sxs-lookup"><span data-stu-id="eee75-135">For the steps to create a load-balanced set, see [Configure a load-balanced set](../articles/load-balancer/load-balancer-get-started-internet-arm-ps.md).</span></span>

<span data-ttu-id="eee75-136">Azure can also load balance within a cloud service or virtual network.</span><span class="sxs-lookup"><span data-stu-id="eee75-136">Azure can also load balance within a cloud service or virtual network.</span></span> <span data-ttu-id="eee75-137">This is known as internal load balancing and can be used in the following ways:</span><span class="sxs-lookup"><span data-stu-id="eee75-137">This is known as internal load balancing and can be used in the following ways:</span></span>

* <span data-ttu-id="eee75-138">To load balance between servers in different tiers of a multi-tier application (for example, between web and database tiers).</span><span class="sxs-lookup"><span data-stu-id="eee75-138">To load balance between servers in different tiers of a multi-tier application (for example, between web and database tiers).</span></span>
* <span data-ttu-id="eee75-139">To load balance line-of-business (LOB) applications hosted in Azure without requiring additional load balancer hardware or software.</span><span class="sxs-lookup"><span data-stu-id="eee75-139">To load balance line-of-business (LOB) applications hosted in Azure without requiring additional load balancer hardware or software.</span></span>
* <span data-ttu-id="eee75-140">To include on-premises servers in the set of computers whose traffic is load balanced.</span><span class="sxs-lookup"><span data-stu-id="eee75-140">To include on-premises servers in the set of computers whose traffic is load balanced.</span></span>

<span data-ttu-id="eee75-141">Similar to Azure load balancing, internal load balancing is facilitated by configuring an internal load-balanced set.</span><span class="sxs-lookup"><span data-stu-id="eee75-141">Similar to Azure load balancing, internal load balancing is facilitated by configuring an internal load-balanced set.</span></span>

<span data-ttu-id="eee75-142">The following diagram shows an example of an internal load-balanced endpoint for a line of business (LOB) application that is shared among three virtual machines in a cross-premises virtual network.</span><span class="sxs-lookup"><span data-stu-id="eee75-142">The following diagram shows an example of an internal load-balanced endpoint for a line of business (LOB) application that is shared among three virtual machines in a cross-premises virtual network.</span></span>

![loadbalancing](https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/virtual-machines-common-load-balance/LOBServers.png)

## <a name="load-balancer-considerations"></a><span data-ttu-id="eee75-144">Load balancer considerations</span><span class="sxs-lookup"><span data-stu-id="eee75-144">Load balancer considerations</span></span>
<span data-ttu-id="eee75-145">A load balancer is configured by default to timeout an idle session in 4 minutes.</span><span class="sxs-lookup"><span data-stu-id="eee75-145">A load balancer is configured by default to timeout an idle session in 4 minutes.</span></span> <span data-ttu-id="eee75-146">If your application behind a load balancer leaves a connection idle for more than 4 minutes and it doesn't have a Keep-Alive configuration, the connection will be dropped.</span><span class="sxs-lookup"><span data-stu-id="eee75-146">If your application behind a load balancer leaves a connection idle for more than 4 minutes and it doesn't have a Keep-Alive configuration, the connection will be dropped.</span></span> <span data-ttu-id="eee75-147">You can change the load balancer behavior to allow a [longer timeout setting for Azure load balancer](../articles/load-balancer/load-balancer-tcp-idle-timeout.md).</span><span class="sxs-lookup"><span data-stu-id="eee75-147">You can change the load balancer behavior to allow a [longer timeout setting for Azure load balancer](../articles/load-balancer/load-balancer-tcp-idle-timeout.md).</span></span>

<span data-ttu-id="eee75-148">Other consideration is the type of distribution mode supported by Azure Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="eee75-148">Other consideration is the type of distribution mode supported by Azure Load Balancer.</span></span> <span data-ttu-id="eee75-149">You can configure source IP affinity (source IP, destination IP) or source IP protocol (source IP , destination IP and protocol).</span><span class="sxs-lookup"><span data-stu-id="eee75-149">You can configure source IP affinity (source IP, destination IP) or source IP protocol (source IP , destination IP and protocol).</span></span> <span data-ttu-id="eee75-150">Check out [Azure Load Balancer distribution mode (source IP affinity)](../articles/load-balancer/load-balancer-distribution-mode.md) for more information.</span><span class="sxs-lookup"><span data-stu-id="eee75-150">Check out [Azure Load Balancer distribution mode (source IP affinity)](../articles/load-balancer/load-balancer-distribution-mode.md) for more information.</span></span>

## <a name="next-steps"></a><span data-ttu-id="eee75-151">Next steps</span><span class="sxs-lookup"><span data-stu-id="eee75-151">Next steps</span></span>
<span data-ttu-id="eee75-152">For the steps to create a load-balanced set, see [Configure an internal load-balanced set](../articles/load-balancer/load-balancer-get-started-ilb-arm-ps.md).</span><span class="sxs-lookup"><span data-stu-id="eee75-152">For the steps to create a load-balanced set, see [Configure an internal load-balanced set](../articles/load-balancer/load-balancer-get-started-ilb-arm-ps.md).</span></span>

<span data-ttu-id="eee75-153">For more information about load balancer, see [Internal load balancing](../articles/load-balancer/load-balancer-internal-overview.md).</span><span class="sxs-lookup"><span data-stu-id="eee75-153">For more information about load balancer, see [Internal load balancing](../articles/load-balancer/load-balancer-internal-overview.md).</span></span>




