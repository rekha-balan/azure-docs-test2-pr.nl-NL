# <a name="azure-service-bus"></a><span data-ttu-id="c8a86-101">Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="c8a86-101">Azure Service Bus</span></span>
<span data-ttu-id="c8a86-102">Whether an application or service runs in the cloud or on premises, it often needs to interact with other applications or services.</span><span class="sxs-lookup"><span data-stu-id="c8a86-102">Whether an application or service runs in the cloud or on premises, it often needs to interact with other applications or services.</span></span> <span data-ttu-id="c8a86-103">To provide a broadly useful way to do this, Azure offers Service Bus.</span><span class="sxs-lookup"><span data-stu-id="c8a86-103">To provide a broadly useful way to do this, Azure offers Service Bus.</span></span> <span data-ttu-id="c8a86-104">This article takes a look at this technology, describing what it is and why you might want to use it.</span><span class="sxs-lookup"><span data-stu-id="c8a86-104">This article takes a look at this technology, describing what it is and why you might want to use it.</span></span>

## <a name="service-bus-fundamentals"></a><span data-ttu-id="c8a86-105">Service Bus fundamentals</span><span class="sxs-lookup"><span data-stu-id="c8a86-105">Service Bus fundamentals</span></span>
<span data-ttu-id="c8a86-106">Different situations call for different styles of communication.</span><span class="sxs-lookup"><span data-stu-id="c8a86-106">Different situations call for different styles of communication.</span></span> <span data-ttu-id="c8a86-107">Sometimes, letting applications send and receive messages through a simple queue is the best solution.</span><span class="sxs-lookup"><span data-stu-id="c8a86-107">Sometimes, letting applications send and receive messages through a simple queue is the best solution.</span></span> <span data-ttu-id="c8a86-108">In other situations, an ordinary queue isn't enough; a queue with a publish-and-subscribe mechanism is better.</span><span class="sxs-lookup"><span data-stu-id="c8a86-108">In other situations, an ordinary queue isn't enough; a queue with a publish-and-subscribe mechanism is better.</span></span> <span data-ttu-id="c8a86-109">And in some cases, all that's really needed is a connection between applications&#151;queues aren't required.</span><span class="sxs-lookup"><span data-stu-id="c8a86-109">And in some cases, all that's really needed is a connection between applications&#151;queues aren't required.</span></span> <span data-ttu-id="c8a86-110">Service Bus provides all three options, letting your applications interact in several different ways.</span><span class="sxs-lookup"><span data-stu-id="c8a86-110">Service Bus provides all three options, letting your applications interact in several different ways.</span></span>

<span data-ttu-id="c8a86-111">Service Bus is a multi-tenant cloud service, which means that the service is shared by multiple users.</span><span class="sxs-lookup"><span data-stu-id="c8a86-111">Service Bus is a multi-tenant cloud service, which means that the service is shared by multiple users.</span></span> <span data-ttu-id="c8a86-112">Each user, such as an application developer, creates a *namespace*, then defines the communication mechanisms she needs within that namespace.</span><span class="sxs-lookup"><span data-stu-id="c8a86-112">Each user, such as an application developer, creates a *namespace*, then defines the communication mechanisms she needs within that namespace.</span></span> <span data-ttu-id="c8a86-113">[Figure 1](#Fig1) shows how this looks.</span><span class="sxs-lookup"><span data-stu-id="c8a86-113">[Figure 1](#Fig1) shows how this looks.</span></span>

<a name="Fig1"></a><span data-ttu-id="c8a86-114">![Diagram of Azure Service Bus][svc-bus]</span><span class="sxs-lookup"><span data-stu-id="c8a86-114">![Diagram of Azure Service Bus][svc-bus]</span></span>

<span data-ttu-id="c8a86-115">**Figure 1: Service Bus provides a multi-tenant service for connecting applications through the cloud.**</span><span class="sxs-lookup"><span data-stu-id="c8a86-115">**Figure 1: Service Bus provides a multi-tenant service for connecting applications through the cloud.**</span></span>

<span data-ttu-id="c8a86-116">Within a namespace, you can use one or more instances of four different communication mechanisms, each of which connects applications in a different way.</span><span class="sxs-lookup"><span data-stu-id="c8a86-116">Within a namespace, you can use one or more instances of four different communication mechanisms, each of which connects applications in a different way.</span></span> <span data-ttu-id="c8a86-117">The choices are:</span><span class="sxs-lookup"><span data-stu-id="c8a86-117">The choices are:</span></span>

* <span data-ttu-id="c8a86-118">*Queues*, which allow one-directional communication.</span><span class="sxs-lookup"><span data-stu-id="c8a86-118">*Queues*, which allow one-directional communication.</span></span> <span data-ttu-id="c8a86-119">Each queue acts as an intermediary (sometimes called a *broker*) that stores sent messages until they are received.</span><span class="sxs-lookup"><span data-stu-id="c8a86-119">Each queue acts as an intermediary (sometimes called a *broker*) that stores sent messages until they are received.</span></span> <span data-ttu-id="c8a86-120">Each message is received by a single recipient.</span><span class="sxs-lookup"><span data-stu-id="c8a86-120">Each message is received by a single recipient.</span></span>
* <span data-ttu-id="c8a86-121">*Topics*, which provide one-directional communication using *subscriptions*-a single topic can have multiple subscriptions.</span><span class="sxs-lookup"><span data-stu-id="c8a86-121">*Topics*, which provide one-directional communication using *subscriptions*-a single topic can have multiple subscriptions.</span></span> <span data-ttu-id="c8a86-122">Like a queue, a topic acts as a broker, but each subscription can optionally use a filter to receive only messages that match specific criteria.</span><span class="sxs-lookup"><span data-stu-id="c8a86-122">Like a queue, a topic acts as a broker, but each subscription can optionally use a filter to receive only messages that match specific criteria.</span></span>
* <span data-ttu-id="c8a86-123">*Relays*, which provide bi-directional communication.</span><span class="sxs-lookup"><span data-stu-id="c8a86-123">*Relays*, which provide bi-directional communication.</span></span> <span data-ttu-id="c8a86-124">Unlike queues and topics, a relay doesn't store in-flight messages-it's not a broker.</span><span class="sxs-lookup"><span data-stu-id="c8a86-124">Unlike queues and topics, a relay doesn't store in-flight messages-it's not a broker.</span></span> <span data-ttu-id="c8a86-125">Instead, it just passes them on to the destination application.</span><span class="sxs-lookup"><span data-stu-id="c8a86-125">Instead, it just passes them on to the destination application.</span></span>
* <span data-ttu-id="c8a86-126">*Event Hubs*, which provide event and telemetry ingress to the cloud at massive scale, with low latency and high reliability.</span><span class="sxs-lookup"><span data-stu-id="c8a86-126">*Event Hubs*, which provide event and telemetry ingress to the cloud at massive scale, with low latency and high reliability.</span></span>

<span data-ttu-id="c8a86-127">When you create a queue, topic, relay, or Event Hub, you give it a name.</span><span class="sxs-lookup"><span data-stu-id="c8a86-127">When you create a queue, topic, relay, or Event Hub, you give it a name.</span></span> <span data-ttu-id="c8a86-128">Combined with whatever you called your namespace, this name creates a unique identifier for the object.</span><span class="sxs-lookup"><span data-stu-id="c8a86-128">Combined with whatever you called your namespace, this name creates a unique identifier for the object.</span></span> <span data-ttu-id="c8a86-129">Applications can provide this name to Service Bus, then use that queue, topic, relay, or Event Hub to communicate with one another.</span><span class="sxs-lookup"><span data-stu-id="c8a86-129">Applications can provide this name to Service Bus, then use that queue, topic, relay, or Event Hub to communicate with one another.</span></span> 

<span data-ttu-id="c8a86-130">To use any of these objects, Windows applications can use Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="c8a86-130">To use any of these objects, Windows applications can use Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="c8a86-131">For queues, topics, and Event Hubs Windows applications can also use Service Bus-defined messaging APIs.</span><span class="sxs-lookup"><span data-stu-id="c8a86-131">For queues, topics, and Event Hubs Windows applications can also use Service Bus-defined messaging APIs.</span></span> <span data-ttu-id="c8a86-132">To make these objects easier to use from non-Windows applications, Microsoft provides SDKs for Java, Node.js, and other languages.</span><span class="sxs-lookup"><span data-stu-id="c8a86-132">To make these objects easier to use from non-Windows applications, Microsoft provides SDKs for Java, Node.js, and other languages.</span></span> <span data-ttu-id="c8a86-133">You can also access queues, topics, and Event Hubs using REST APIs over HTTP.</span><span class="sxs-lookup"><span data-stu-id="c8a86-133">You can also access queues, topics, and Event Hubs using REST APIs over HTTP.</span></span> 

<span data-ttu-id="c8a86-134">It's important to understand that even though Service Bus itself runs in the cloud (that is, in Microsoft's Azure datacenters), applications that use it can run anywhere.</span><span class="sxs-lookup"><span data-stu-id="c8a86-134">It's important to understand that even though Service Bus itself runs in the cloud (that is, in Microsoft's Azure datacenters), applications that use it can run anywhere.</span></span> <span data-ttu-id="c8a86-135">You can use Service Bus to connect applications running on Azure, for example, or applications running inside your own datacenter.</span><span class="sxs-lookup"><span data-stu-id="c8a86-135">You can use Service Bus to connect applications running on Azure, for example, or applications running inside your own datacenter.</span></span> <span data-ttu-id="c8a86-136">You can also use it to connect an application running on Azure or another cloud platform with an on-premises application or with tablets and phones.</span><span class="sxs-lookup"><span data-stu-id="c8a86-136">You can also use it to connect an application running on Azure or another cloud platform with an on-premises application or with tablets and phones.</span></span> <span data-ttu-id="c8a86-137">It's even possible to connect household appliances, sensors, and other devices to a central application or to one other.</span><span class="sxs-lookup"><span data-stu-id="c8a86-137">It's even possible to connect household appliances, sensors, and other devices to a central application or to one other.</span></span> <span data-ttu-id="c8a86-138">Service Bus is a generic communication mechanism in the cloud that's accessible from pretty much anywhere.</span><span class="sxs-lookup"><span data-stu-id="c8a86-138">Service Bus is a generic communication mechanism in the cloud that's accessible from pretty much anywhere.</span></span> <span data-ttu-id="c8a86-139">How you use it depends on what your applications need to do.</span><span class="sxs-lookup"><span data-stu-id="c8a86-139">How you use it depends on what your applications need to do.</span></span>

## <a name="queues"></a><span data-ttu-id="c8a86-140">Queues</span><span class="sxs-lookup"><span data-stu-id="c8a86-140">Queues</span></span>
<span data-ttu-id="c8a86-141">Suppose you decide to connect two applications using a Service Bus queue.</span><span class="sxs-lookup"><span data-stu-id="c8a86-141">Suppose you decide to connect two applications using a Service Bus queue.</span></span> <span data-ttu-id="c8a86-142">[Figure 2](#Fig2) illustrates this situation.</span><span class="sxs-lookup"><span data-stu-id="c8a86-142">[Figure 2](#Fig2) illustrates this situation.</span></span>

<a name="Fig2"></a><span data-ttu-id="c8a86-143">![Diagram of Service Bus Queues][queues]</span><span class="sxs-lookup"><span data-stu-id="c8a86-143">![Diagram of Service Bus Queues][queues]</span></span>

<span data-ttu-id="c8a86-144">**Figure 2: Service Bus queues provide one-way asynchronous queuing.**</span><span class="sxs-lookup"><span data-stu-id="c8a86-144">**Figure 2: Service Bus queues provide one-way asynchronous queuing.**</span></span>

<span data-ttu-id="c8a86-145">The process is simple: A sender sends a message to a Service Bus queue, and a receiver picks up that message at some later time.</span><span class="sxs-lookup"><span data-stu-id="c8a86-145">The process is simple: A sender sends a message to a Service Bus queue, and a receiver picks up that message at some later time.</span></span> <span data-ttu-id="c8a86-146">A queue can have just a single receiver, as [Figure 2](#Fig2) shows, or multiple applications can read from the same queue.</span><span class="sxs-lookup"><span data-stu-id="c8a86-146">A queue can have just a single receiver, as [Figure 2](#Fig2) shows, or multiple applications can read from the same queue.</span></span> <span data-ttu-id="c8a86-147">In the latter situation, each message is read by just one receiver-for a multi-cast service you should use a topic instead.</span><span class="sxs-lookup"><span data-stu-id="c8a86-147">In the latter situation, each message is read by just one receiver-for a multi-cast service you should use a topic instead.</span></span>

<span data-ttu-id="c8a86-148">Each message has two parts: a set of properties, each a key/value pair, and a binary message body.</span><span class="sxs-lookup"><span data-stu-id="c8a86-148">Each message has two parts: a set of properties, each a key/value pair, and a binary message body.</span></span> <span data-ttu-id="c8a86-149">How they're used depends on what an application is trying to do.</span><span class="sxs-lookup"><span data-stu-id="c8a86-149">How they're used depends on what an application is trying to do.</span></span> <span data-ttu-id="c8a86-150">For example, an application sending a message about a recent sale might include the properties *Seller="Ava"* and *Amount=10000*.</span><span class="sxs-lookup"><span data-stu-id="c8a86-150">For example, an application sending a message about a recent sale might include the properties *Seller="Ava"* and *Amount=10000*.</span></span> <span data-ttu-id="c8a86-151">The message body might contain a scanned image of the sale's signed contract or, if there isn't one, just remain empty.</span><span class="sxs-lookup"><span data-stu-id="c8a86-151">The message body might contain a scanned image of the sale's signed contract or, if there isn't one, just remain empty.</span></span>

<span data-ttu-id="c8a86-152">A receiver can read a message from a Service Bus queue in two different ways.</span><span class="sxs-lookup"><span data-stu-id="c8a86-152">A receiver can read a message from a Service Bus queue in two different ways.</span></span> <span data-ttu-id="c8a86-153">The first option, called *ReceiveAndDelete*, removes a message from the queue and immediately deletes it.</span><span class="sxs-lookup"><span data-stu-id="c8a86-153">The first option, called *ReceiveAndDelete*, removes a message from the queue and immediately deletes it.</span></span> <span data-ttu-id="c8a86-154">This is simple, but if the receiver crashes before it finishes processing the message, the message will be lost.</span><span class="sxs-lookup"><span data-stu-id="c8a86-154">This is simple, but if the receiver crashes before it finishes processing the message, the message will be lost.</span></span> <span data-ttu-id="c8a86-155">Because it's been removed from the queue, no other receiver can access it.</span><span class="sxs-lookup"><span data-stu-id="c8a86-155">Because it's been removed from the queue, no other receiver can access it.</span></span> 

<span data-ttu-id="c8a86-156">The second option, *PeekLock*, is meant to help with this problem.</span><span class="sxs-lookup"><span data-stu-id="c8a86-156">The second option, *PeekLock*, is meant to help with this problem.</span></span> <span data-ttu-id="c8a86-157">Like ReceiveAndDelete, a PeekLock read removes a message from the queue.</span><span class="sxs-lookup"><span data-stu-id="c8a86-157">Like ReceiveAndDelete, a PeekLock read removes a message from the queue.</span></span> <span data-ttu-id="c8a86-158">It doesn't delete the message, however.</span><span class="sxs-lookup"><span data-stu-id="c8a86-158">It doesn't delete the message, however.</span></span> <span data-ttu-id="c8a86-159">Instead, it locks the message, making it invisible to other receivers, then waits for one of three events:</span><span class="sxs-lookup"><span data-stu-id="c8a86-159">Instead, it locks the message, making it invisible to other receivers, then waits for one of three events:</span></span>

* <span data-ttu-id="c8a86-160">If the receiver processes the message successfully, it calls *Complete*, and the queue deletes the message.</span><span class="sxs-lookup"><span data-stu-id="c8a86-160">If the receiver processes the message successfully, it calls *Complete*, and the queue deletes the message.</span></span> 
* <span data-ttu-id="c8a86-161">If the receiver decides that it can't process the message successfully, it calls *Abandon*.</span><span class="sxs-lookup"><span data-stu-id="c8a86-161">If the receiver decides that it can't process the message successfully, it calls *Abandon*.</span></span> <span data-ttu-id="c8a86-162">The queue then removes the lock from the message and makes it available to other receivers.</span><span class="sxs-lookup"><span data-stu-id="c8a86-162">The queue then removes the lock from the message and makes it available to other receivers.</span></span>
* <span data-ttu-id="c8a86-163">If the receiver calls neither of these within a configurable period of time (by default, 60 seconds), the queue assumes the receiver has failed.</span><span class="sxs-lookup"><span data-stu-id="c8a86-163">If the receiver calls neither of these within a configurable period of time (by default, 60 seconds), the queue assumes the receiver has failed.</span></span> <span data-ttu-id="c8a86-164">In this case, it behaves as if the receiver had called Abandon, making the message available to other receivers.</span><span class="sxs-lookup"><span data-stu-id="c8a86-164">In this case, it behaves as if the receiver had called Abandon, making the message available to other receivers.</span></span>

<span data-ttu-id="c8a86-165">Notice what can happen here: The same message might be delivered twice, perhaps to two different receivers.</span><span class="sxs-lookup"><span data-stu-id="c8a86-165">Notice what can happen here: The same message might be delivered twice, perhaps to two different receivers.</span></span> <span data-ttu-id="c8a86-166">Applications using Service Bus queues must be prepared for this.</span><span class="sxs-lookup"><span data-stu-id="c8a86-166">Applications using Service Bus queues must be prepared for this.</span></span> <span data-ttu-id="c8a86-167">To make duplicate detection easier, each message has a unique MessageID property that by default stays the same no matter how many times the message is read from a queue.</span><span class="sxs-lookup"><span data-stu-id="c8a86-167">To make duplicate detection easier, each message has a unique MessageID property that by default stays the same no matter how many times the message is read from a queue.</span></span> 

<span data-ttu-id="c8a86-168">Queues are useful in quite a few situations.</span><span class="sxs-lookup"><span data-stu-id="c8a86-168">Queues are useful in quite a few situations.</span></span> <span data-ttu-id="c8a86-169">They let applications communicate even when both aren't running at the same time, something that's especially handy with batch and mobile applications.</span><span class="sxs-lookup"><span data-stu-id="c8a86-169">They let applications communicate even when both aren't running at the same time, something that's especially handy with batch and mobile applications.</span></span> <span data-ttu-id="c8a86-170">A queue with multiple receivers also provides automatic load balancing, since sent messages are spread across these receivers.</span><span class="sxs-lookup"><span data-stu-id="c8a86-170">A queue with multiple receivers also provides automatic load balancing, since sent messages are spread across these receivers.</span></span>

## <a name="topics"></a><span data-ttu-id="c8a86-171">Topics</span><span class="sxs-lookup"><span data-stu-id="c8a86-171">Topics</span></span>
<span data-ttu-id="c8a86-172">Useful as they are, queues aren't always the right solution.</span><span class="sxs-lookup"><span data-stu-id="c8a86-172">Useful as they are, queues aren't always the right solution.</span></span> <span data-ttu-id="c8a86-173">Sometimes, Service Bus topics are better.</span><span class="sxs-lookup"><span data-stu-id="c8a86-173">Sometimes, Service Bus topics are better.</span></span> <span data-ttu-id="c8a86-174">[Figure 3](#Fig3) illustrates this idea.</span><span class="sxs-lookup"><span data-stu-id="c8a86-174">[Figure 3](#Fig3) illustrates this idea.</span></span>

<a name="Fig3"></a><span data-ttu-id="c8a86-175">![Diagram of Service Bus Topics and Subscriptions][topics-subs]</span><span class="sxs-lookup"><span data-stu-id="c8a86-175">![Diagram of Service Bus Topics and Subscriptions][topics-subs]</span></span>

<span data-ttu-id="c8a86-176">**Figure 3: Based on the filter a subscribing application specifies, it can receive some or all of the messages sent to a Service Bus topic.**</span><span class="sxs-lookup"><span data-stu-id="c8a86-176">**Figure 3: Based on the filter a subscribing application specifies, it can receive some or all of the messages sent to a Service Bus topic.**</span></span>

<span data-ttu-id="c8a86-177">A topic is similar in many ways to a queue.</span><span class="sxs-lookup"><span data-stu-id="c8a86-177">A topic is similar in many ways to a queue.</span></span> <span data-ttu-id="c8a86-178">Senders submit messages to a topic in the same way that they submit messages to a queue, and those messages look the same as with queues.</span><span class="sxs-lookup"><span data-stu-id="c8a86-178">Senders submit messages to a topic in the same way that they submit messages to a queue, and those messages look the same as with queues.</span></span> <span data-ttu-id="c8a86-179">The big difference is that topics let each receiving application create its own subscription by defining a *filter*.</span><span class="sxs-lookup"><span data-stu-id="c8a86-179">The big difference is that topics let each receiving application create its own subscription by defining a *filter*.</span></span> <span data-ttu-id="c8a86-180">A subscriber will then see only the messages that match that filter.</span><span class="sxs-lookup"><span data-stu-id="c8a86-180">A subscriber will then see only the messages that match that filter.</span></span> <span data-ttu-id="c8a86-181">For example, [Figure 3](#Fig3) shows a sender and a topic with three subscribers, each with its own filter:</span><span class="sxs-lookup"><span data-stu-id="c8a86-181">For example, [Figure 3](#Fig3) shows a sender and a topic with three subscribers, each with its own filter:</span></span>

* <span data-ttu-id="c8a86-182">Subscriber 1 receives only messages that contain the property *Seller="Ava"*.</span><span class="sxs-lookup"><span data-stu-id="c8a86-182">Subscriber 1 receives only messages that contain the property *Seller="Ava"*.</span></span>
* <span data-ttu-id="c8a86-183">Subscriber 2 receives messages that contain the property *Seller="Ruby"* and/or contain an *Amount* property whose value is greater than 100,000.</span><span class="sxs-lookup"><span data-stu-id="c8a86-183">Subscriber 2 receives messages that contain the property *Seller="Ruby"* and/or contain an *Amount* property whose value is greater than 100,000.</span></span> <span data-ttu-id="c8a86-184">Perhaps Ruby is the sales manager, and so she wants to see both her own sales and all big sales regardless of who makes them.</span><span class="sxs-lookup"><span data-stu-id="c8a86-184">Perhaps Ruby is the sales manager, and so she wants to see both her own sales and all big sales regardless of who makes them.</span></span>
* <span data-ttu-id="c8a86-185">Subscriber 3 has set its filter to *True*, which means that it receives all messages.</span><span class="sxs-lookup"><span data-stu-id="c8a86-185">Subscriber 3 has set its filter to *True*, which means that it receives all messages.</span></span> <span data-ttu-id="c8a86-186">For example, this application might be responsible for maintaining an audit trail and therefore it needs to see all the messages.</span><span class="sxs-lookup"><span data-stu-id="c8a86-186">For example, this application might be responsible for maintaining an audit trail and therefore it needs to see all the messages.</span></span>

<span data-ttu-id="c8a86-187">As with queues, subscribers to a topic can read messages using either ReceiveAndDelete or PeekLock.</span><span class="sxs-lookup"><span data-stu-id="c8a86-187">As with queues, subscribers to a topic can read messages using either ReceiveAndDelete or PeekLock.</span></span> <span data-ttu-id="c8a86-188">Unlike queues, however, a single message sent to a topic can be received by multiple subscribers.</span><span class="sxs-lookup"><span data-stu-id="c8a86-188">Unlike queues, however, a single message sent to a topic can be received by multiple subscribers.</span></span> <span data-ttu-id="c8a86-189">This approach, commonly called *publish and subscribe*, is useful whenever multiple applications might be interested in the same messages.</span><span class="sxs-lookup"><span data-stu-id="c8a86-189">This approach, commonly called *publish and subscribe*, is useful whenever multiple applications might be interested in the same messages.</span></span> <span data-ttu-id="c8a86-190">By defining the right filter, each subscriber can tap into just the part of the message stream that it needs to see.</span><span class="sxs-lookup"><span data-stu-id="c8a86-190">By defining the right filter, each subscriber can tap into just the part of the message stream that it needs to see.</span></span>

## <a name="relays"></a><span data-ttu-id="c8a86-191">Relays</span><span class="sxs-lookup"><span data-stu-id="c8a86-191">Relays</span></span>
<span data-ttu-id="c8a86-192">Both queues and topics provide one-way asynchronous communication through a broker.</span><span class="sxs-lookup"><span data-stu-id="c8a86-192">Both queues and topics provide one-way asynchronous communication through a broker.</span></span> <span data-ttu-id="c8a86-193">Traffic flows in just one direction, and there's no direct connection between senders and receivers.</span><span class="sxs-lookup"><span data-stu-id="c8a86-193">Traffic flows in just one direction, and there's no direct connection between senders and receivers.</span></span> <span data-ttu-id="c8a86-194">But what if you don't want this?</span><span class="sxs-lookup"><span data-stu-id="c8a86-194">But what if you don't want this?</span></span> <span data-ttu-id="c8a86-195">Suppose your applications need to both send and receive messages, or perhaps you want a direct link between them and you don't need a broker to store messages.</span><span class="sxs-lookup"><span data-stu-id="c8a86-195">Suppose your applications need to both send and receive messages, or perhaps you want a direct link between them and you don't need a broker to store messages.</span></span> <span data-ttu-id="c8a86-196">To address scenarios such as this, Service Bus provides relays, as [Figure 4](#Fig4) shows.</span><span class="sxs-lookup"><span data-stu-id="c8a86-196">To address scenarios such as this, Service Bus provides relays, as [Figure 4](#Fig4) shows.</span></span>

<a name="Fig4"></a><span data-ttu-id="c8a86-197">![Diagram of Service Bus Relay][relay]</span><span class="sxs-lookup"><span data-stu-id="c8a86-197">![Diagram of Service Bus Relay][relay]</span></span>

<span data-ttu-id="c8a86-198">**Figure 4: Service Bus relay provides synchronous, two-way communication between applications.**</span><span class="sxs-lookup"><span data-stu-id="c8a86-198">**Figure 4: Service Bus relay provides synchronous, two-way communication between applications.**</span></span>

<span data-ttu-id="c8a86-199">The obvious question to ask about relays is this: Why would I use one?</span><span class="sxs-lookup"><span data-stu-id="c8a86-199">The obvious question to ask about relays is this: Why would I use one?</span></span> <span data-ttu-id="c8a86-200">Even if I don't need queues, why make applications communicate via a cloud service rather than just interact directly?</span><span class="sxs-lookup"><span data-stu-id="c8a86-200">Even if I don't need queues, why make applications communicate via a cloud service rather than just interact directly?</span></span> <span data-ttu-id="c8a86-201">The answer is that talking directly can be harder than you might think.</span><span class="sxs-lookup"><span data-stu-id="c8a86-201">The answer is that talking directly can be harder than you might think.</span></span>

<span data-ttu-id="c8a86-202">Suppose you want to connect two on-premises applications, both running inside corporate datacenters.</span><span class="sxs-lookup"><span data-stu-id="c8a86-202">Suppose you want to connect two on-premises applications, both running inside corporate datacenters.</span></span> <span data-ttu-id="c8a86-203">Each of these applications sits behind a firewall, and each datacenter probably uses network address translation (NAT).</span><span class="sxs-lookup"><span data-stu-id="c8a86-203">Each of these applications sits behind a firewall, and each datacenter probably uses network address translation (NAT).</span></span> <span data-ttu-id="c8a86-204">The firewall blocks incoming data on all but a few ports, and NAT implies that the machine each application is running on doesn't have a fixed IP address that you can reach directly from outside the datacenter.</span><span class="sxs-lookup"><span data-stu-id="c8a86-204">The firewall blocks incoming data on all but a few ports, and NAT implies that the machine each application is running on doesn't have a fixed IP address that you can reach directly from outside the datacenter.</span></span> <span data-ttu-id="c8a86-205">Without some extra help, connecting these applications over the public Internet is problematic.</span><span class="sxs-lookup"><span data-stu-id="c8a86-205">Without some extra help, connecting these applications over the public Internet is problematic.</span></span>

<span data-ttu-id="c8a86-206">A Service Bus relay provides this help.</span><span class="sxs-lookup"><span data-stu-id="c8a86-206">A Service Bus relay provides this help.</span></span> <span data-ttu-id="c8a86-207">To communicate bi-directionally through a relay, each application establishes an outbound TCP connection with Service Bus, then keeps it open.</span><span class="sxs-lookup"><span data-stu-id="c8a86-207">To communicate bi-directionally through a relay, each application establishes an outbound TCP connection with Service Bus, then keeps it open.</span></span> <span data-ttu-id="c8a86-208">All communication between the two applications will travel over these connections.</span><span class="sxs-lookup"><span data-stu-id="c8a86-208">All communication between the two applications will travel over these connections.</span></span> <span data-ttu-id="c8a86-209">Because each connection was established from inside the datacenter, the firewall will allow incoming traffic to each application without opening new ports.</span><span class="sxs-lookup"><span data-stu-id="c8a86-209">Because each connection was established from inside the datacenter, the firewall will allow incoming traffic to each application without opening new ports.</span></span> <span data-ttu-id="c8a86-210">This approach also gets around the NAT problem, because each application has a consistent endpoint in the cloud throughout the communication.</span><span class="sxs-lookup"><span data-stu-id="c8a86-210">This approach also gets around the NAT problem, because each application has a consistent endpoint in the cloud throughout the communication.</span></span> <span data-ttu-id="c8a86-211">By exchanging data through the relay, the applications can avoid the problems that would otherwise make communication difficult.</span><span class="sxs-lookup"><span data-stu-id="c8a86-211">By exchanging data through the relay, the applications can avoid the problems that would otherwise make communication difficult.</span></span> 

<span data-ttu-id="c8a86-212">To use Service Bus relays, applications rely on Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="c8a86-212">To use Service Bus relays, applications rely on Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="c8a86-213">Service Bus provides WCF bindings that make it straightforward for Windows applications to interact via relays.</span><span class="sxs-lookup"><span data-stu-id="c8a86-213">Service Bus provides WCF bindings that make it straightforward for Windows applications to interact via relays.</span></span> <span data-ttu-id="c8a86-214">Applications that already use WCF can typically just specify one of these bindings, then talk to each other through a relay.</span><span class="sxs-lookup"><span data-stu-id="c8a86-214">Applications that already use WCF can typically just specify one of these bindings, then talk to each other through a relay.</span></span> <span data-ttu-id="c8a86-215">Unlike queues and topics, however, using relays from non-Windows applications, while possible, requires some programming effort; no standard libraries are provided.</span><span class="sxs-lookup"><span data-stu-id="c8a86-215">Unlike queues and topics, however, using relays from non-Windows applications, while possible, requires some programming effort; no standard libraries are provided.</span></span>

<span data-ttu-id="c8a86-216">Unlike queues and topics, applications don't explicitly create relays.</span><span class="sxs-lookup"><span data-stu-id="c8a86-216">Unlike queues and topics, applications don't explicitly create relays.</span></span> <span data-ttu-id="c8a86-217">Instead, when an application that wishes to receive messages establishes a TCP connection with Service Bus, a relay is created automatically.</span><span class="sxs-lookup"><span data-stu-id="c8a86-217">Instead, when an application that wishes to receive messages establishes a TCP connection with Service Bus, a relay is created automatically.</span></span> <span data-ttu-id="c8a86-218">When the connection is dropped, the relay is deleted.</span><span class="sxs-lookup"><span data-stu-id="c8a86-218">When the connection is dropped, the relay is deleted.</span></span> <span data-ttu-id="c8a86-219">To let an application find the relay created by a specific listener, Service Bus provides a registry that enables applications to locate a specific relay by name.</span><span class="sxs-lookup"><span data-stu-id="c8a86-219">To let an application find the relay created by a specific listener, Service Bus provides a registry that enables applications to locate a specific relay by name.</span></span>

<span data-ttu-id="c8a86-220">Relays are the right solution when you need direct communication between applications.</span><span class="sxs-lookup"><span data-stu-id="c8a86-220">Relays are the right solution when you need direct communication between applications.</span></span> <span data-ttu-id="c8a86-221">For example, consider an airline reservation system running in an on-premises datacenter that must be accessed from check-in kiosks, mobile devices, and other computers.</span><span class="sxs-lookup"><span data-stu-id="c8a86-221">For example, consider an airline reservation system running in an on-premises datacenter that must be accessed from check-in kiosks, mobile devices, and other computers.</span></span> <span data-ttu-id="c8a86-222">Applications running on all of these systems could rely on Service Bus relays in the cloud to communicate, wherever they might be running.</span><span class="sxs-lookup"><span data-stu-id="c8a86-222">Applications running on all of these systems could rely on Service Bus relays in the cloud to communicate, wherever they might be running.</span></span>

## <a name="event-hubs"></a><span data-ttu-id="c8a86-223">Event Hubs</span><span class="sxs-lookup"><span data-stu-id="c8a86-223">Event Hubs</span></span>
<span data-ttu-id="c8a86-224">Event Hubs is a highly scalable ingestion system that can process millions of events per second, enabling your application to process and analyze the massive amounts of data produced by your connected devices and applications.</span><span class="sxs-lookup"><span data-stu-id="c8a86-224">Event Hubs is a highly scalable ingestion system that can process millions of events per second, enabling your application to process and analyze the massive amounts of data produced by your connected devices and applications.</span></span> <span data-ttu-id="c8a86-225">For example, you could use an Event Hub to collect live engine performance data from a fleet of cars.</span><span class="sxs-lookup"><span data-stu-id="c8a86-225">For example, you could use an Event Hub to collect live engine performance data from a fleet of cars.</span></span> <span data-ttu-id="c8a86-226">Once collected into Event Hubs, you can transform and store data using any real-time analytics provider or storage cluster.</span><span class="sxs-lookup"><span data-stu-id="c8a86-226">Once collected into Event Hubs, you can transform and store data using any real-time analytics provider or storage cluster.</span></span> <span data-ttu-id="c8a86-227">For more information about Event Hubs, see the [Event Hubs overview][Event Hubs overview].</span><span class="sxs-lookup"><span data-stu-id="c8a86-227">For more information about Event Hubs, see the [Event Hubs overview][Event Hubs overview].</span></span>

## <a name="summary"></a><span data-ttu-id="c8a86-228">Summary</span><span class="sxs-lookup"><span data-stu-id="c8a86-228">Summary</span></span>
<span data-ttu-id="c8a86-229">Connecting applications has always been part of building complete solutions, and the range of scenarios that require applications and services to communicate with each other is set to increase as more applications and devices are connected to the Internet.</span><span class="sxs-lookup"><span data-stu-id="c8a86-229">Connecting applications has always been part of building complete solutions, and the range of scenarios that require applications and services to communicate with each other is set to increase as more applications and devices are connected to the Internet.</span></span> <span data-ttu-id="c8a86-230">By providing cloud-based technologies for achieving this through queues, topics, relays, and Event Hubs, Service Bus aims to make this essential function easier to implement and more broadly available.</span><span class="sxs-lookup"><span data-stu-id="c8a86-230">By providing cloud-based technologies for achieving this through queues, topics, relays, and Event Hubs, Service Bus aims to make this essential function easier to implement and more broadly available.</span></span>

[svc-bus]: https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/hybrid-solutions/SvcBus_01_architecture.png
[queues]: https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/hybrid-solutions/SvcBus_02_queues.png
[topics-subs]: https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/hybrid-solutions/SvcBus_03_topicsandsubscriptions.png
[relay]: https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/hybrid-solutions/SvcBus_04_relay.png
[Event Hubs overview]: https://msdn.microsoft.com/library/azure/dn836025.aspx




