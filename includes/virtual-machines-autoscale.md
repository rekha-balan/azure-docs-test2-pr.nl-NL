<span data-ttu-id="55e88-101">You can easily [automatically scale](../articles/monitoring-and-diagnostics/insights-autoscale-best-practices.md) your [virtual machines (VMs)](../articles/virtual-machines/windows/overview.md) when you use [virtual machine scale sets](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) and the [autoscaling feature of Azure Monitor](../articles/monitoring-and-diagnostics/monitoring-overview-autoscale.md).</span><span class="sxs-lookup"><span data-stu-id="55e88-101">You can easily [automatically scale](../articles/monitoring-and-diagnostics/insights-autoscale-best-practices.md) your [virtual machines (VMs)](../articles/virtual-machines/windows/overview.md) when you use [virtual machine scale sets](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-overview.md) and the [autoscaling feature of Azure Monitor](../articles/monitoring-and-diagnostics/monitoring-overview-autoscale.md).</span></span> <span data-ttu-id="55e88-102">Your VMs need to be members of a scale set to be automatically scaled.</span><span class="sxs-lookup"><span data-stu-id="55e88-102">Your VMs need to be members of a scale set to be automatically scaled.</span></span> <span data-ttu-id="55e88-103">This article provides information that enables you to better understand how to scale your VMs both vertically and horizontally using automatic and manual methods.</span><span class="sxs-lookup"><span data-stu-id="55e88-103">This article provides information that enables you to better understand how to scale your VMs both vertically and horizontally using automatic and manual methods.</span></span>

## <a name="horizontal-or-vertical-scaling"></a><span data-ttu-id="55e88-104">Horizontal or vertical scaling</span><span class="sxs-lookup"><span data-stu-id="55e88-104">Horizontal or vertical scaling</span></span>

<span data-ttu-id="55e88-105">The autoscale feature of Azure Monitor only scales horizontally, which is an increase ("out") or decrease ("in") of the number of VMs.</span><span class="sxs-lookup"><span data-stu-id="55e88-105">The autoscale feature of Azure Monitor only scales horizontally, which is an increase ("out") or decrease ("in") of the number of VMs.</span></span> <span data-ttu-id="55e88-106">Horizontal scaling is more flexible in a cloud situation as it allows you to run potentially thousands of VMs to handle load.</span><span class="sxs-lookup"><span data-stu-id="55e88-106">Horizontal scaling is more flexible in a cloud situation as it allows you to run potentially thousands of VMs to handle load.</span></span> <span data-ttu-id="55e88-107">You scale horizontally by either automatically or manually changing the capacity (or instance count) of the scale set.</span><span class="sxs-lookup"><span data-stu-id="55e88-107">You scale horizontally by either automatically or manually changing the capacity (or instance count) of the scale set.</span></span> 

<span data-ttu-id="55e88-108">Vertical scaling keeps the same number of VMs, but makes the VMs more ("up") or less ("down") powerful.</span><span class="sxs-lookup"><span data-stu-id="55e88-108">Vertical scaling keeps the same number of VMs, but makes the VMs more ("up") or less ("down") powerful.</span></span> <span data-ttu-id="55e88-109">Power is measured in attributes such as memory, CPU speed, or disk space.</span><span class="sxs-lookup"><span data-stu-id="55e88-109">Power is measured in attributes such as memory, CPU speed, or disk space.</span></span> <span data-ttu-id="55e88-110">Vertical scaling is dependent on the availability of larger hardware, which quickly hits an upper limit and can vary by region.</span><span class="sxs-lookup"><span data-stu-id="55e88-110">Vertical scaling is dependent on the availability of larger hardware, which quickly hits an upper limit and can vary by region.</span></span> <span data-ttu-id="55e88-111">Vertical scaling also usually requires a VM to stop and restart.</span><span class="sxs-lookup"><span data-stu-id="55e88-111">Vertical scaling also usually requires a VM to stop and restart.</span></span> <span data-ttu-id="55e88-112">You scale vertically by setting a new size in the configuration of the VMs in the scale set.</span><span class="sxs-lookup"><span data-stu-id="55e88-112">You scale vertically by setting a new size in the configuration of the VMs in the scale set.</span></span>

<span data-ttu-id="55e88-113">Using runbooks in [Azure Automation](../articles/automation/automation-intro.md), you can easily [scale VMs in a scale set](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-vertical-scale-reprovision.md) up or down.</span><span class="sxs-lookup"><span data-stu-id="55e88-113">Using runbooks in [Azure Automation](../articles/automation/automation-intro.md), you can easily [scale VMs in a scale set](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-vertical-scale-reprovision.md) up or down.</span></span>

## <a name="create-a-virtual-machine-scale-set"></a><span data-ttu-id="55e88-114">Create a virtual machine scale set</span><span class="sxs-lookup"><span data-stu-id="55e88-114">Create a virtual machine scale set</span></span>

<span data-ttu-id="55e88-115">Scale sets make it easy for you to deploy and manage identical VMs as a set.</span><span class="sxs-lookup"><span data-stu-id="55e88-115">Scale sets make it easy for you to deploy and manage identical VMs as a set.</span></span> <span data-ttu-id="55e88-116">You can create Linux or Windows scale sets using the [Azure portal](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-portal-create.md), [Azure PowerShell](../articles/virtual-machines/windows/tutorial-create-vmss.md), or the [Azure CLI](../articles/virtual-machines/linux/tutorial-create-vmss.md).</span><span class="sxs-lookup"><span data-stu-id="55e88-116">You can create Linux or Windows scale sets using the [Azure portal](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-portal-create.md), [Azure PowerShell](../articles/virtual-machines/windows/tutorial-create-vmss.md), or the [Azure CLI](../articles/virtual-machines/linux/tutorial-create-vmss.md).</span></span> <span data-ttu-id="55e88-117">You can also create and manage scale sets with SDKs such as [Python](https://azure.microsoft.com/develop/python/) or [Node.js](/nodejs/azure), or directly with the [REST APIs](/rest/api/compute/virtualmachinescalesets).</span><span class="sxs-lookup"><span data-stu-id="55e88-117">You can also create and manage scale sets with SDKs such as [Python](https://azure.microsoft.com/develop/python/) or [Node.js](/nodejs/azure), or directly with the [REST APIs](/rest/api/compute/virtualmachinescalesets).</span></span> <span data-ttu-id="55e88-118">Automatic scaling of VMs is accomplished by applying metrics and rules to the scale set.</span><span class="sxs-lookup"><span data-stu-id="55e88-118">Automatic scaling of VMs is accomplished by applying metrics and rules to the scale set.</span></span>

## <a name="configure-autoscale-for-a-scale-set"></a><span data-ttu-id="55e88-119">Configure autoscale for a scale set</span><span class="sxs-lookup"><span data-stu-id="55e88-119">Configure autoscale for a scale set</span></span>

<span data-ttu-id="55e88-120">Automatic scaling provides the right number of VMs to handle the load on your application.</span><span class="sxs-lookup"><span data-stu-id="55e88-120">Automatic scaling provides the right number of VMs to handle the load on your application.</span></span> <span data-ttu-id="55e88-121">It enables you to add VMs to handle increases in load and save money by removing VMs that are sitting idle.</span><span class="sxs-lookup"><span data-stu-id="55e88-121">It enables you to add VMs to handle increases in load and save money by removing VMs that are sitting idle.</span></span> <span data-ttu-id="55e88-122">You specify a minimum and maximum number of VMs to run based on a set of rules.</span><span class="sxs-lookup"><span data-stu-id="55e88-122">You specify a minimum and maximum number of VMs to run based on a set of rules.</span></span> <span data-ttu-id="55e88-123">Having a minimum makes sure your application is always running even under no load.</span><span class="sxs-lookup"><span data-stu-id="55e88-123">Having a minimum makes sure your application is always running even under no load.</span></span> <span data-ttu-id="55e88-124">Having a maximum value limits your total possible hourly cost.</span><span class="sxs-lookup"><span data-stu-id="55e88-124">Having a maximum value limits your total possible hourly cost.</span></span>

<span data-ttu-id="55e88-125">You can enable autoscale when you create the scale set using [Azure PowerShell](../articles/monitoring-and-diagnostics/insights-powershell-samples.md#create-and-manage-autoscale-settings) or [Azure CLI](https://docs.microsoft.com/cli/azure/monitor/autoscale-settings).</span><span class="sxs-lookup"><span data-stu-id="55e88-125">You can enable autoscale when you create the scale set using [Azure PowerShell](../articles/monitoring-and-diagnostics/insights-powershell-samples.md#create-and-manage-autoscale-settings) or [Azure CLI](https://docs.microsoft.com/cli/azure/monitor/autoscale-settings).</span></span> <span data-ttu-id="55e88-126">You can also enable it after the scale set is created.</span><span class="sxs-lookup"><span data-stu-id="55e88-126">You can also enable it after the scale set is created.</span></span> <span data-ttu-id="55e88-127">You can create a scale set, install the extension, and configure autoscale using an [Azure Resource Manager template](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-windows-autoscale.md).</span><span class="sxs-lookup"><span data-stu-id="55e88-127">You can create a scale set, install the extension, and configure autoscale using an [Azure Resource Manager template](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-windows-autoscale.md).</span></span> <span data-ttu-id="55e88-128">In the Azure portal, enable autoscale from Azure Monitor, or enable autoscale from the scale set settings.</span><span class="sxs-lookup"><span data-stu-id="55e88-128">In the Azure portal, enable autoscale from Azure Monitor, or enable autoscale from the scale set settings.</span></span>

![Enable autoscale](./media/virtual-machines-autoscale/virtual-machines-autoscale-enable.png)
 
### <a name="metrics"></a><span data-ttu-id="55e88-130">Metrics</span><span class="sxs-lookup"><span data-stu-id="55e88-130">Metrics</span></span>

<span data-ttu-id="55e88-131">The autoscale feature of Azure Monitor enables you to scale the number of running VMs up or down based on [metrics](../articles/monitoring-and-diagnostics/insights-autoscale-common-metrics.md).</span><span class="sxs-lookup"><span data-stu-id="55e88-131">The autoscale feature of Azure Monitor enables you to scale the number of running VMs up or down based on [metrics](../articles/monitoring-and-diagnostics/insights-autoscale-common-metrics.md).</span></span> <span data-ttu-id="55e88-132">By default, VMs provide basic host-level metrics for disk, network, and CPU usage.</span><span class="sxs-lookup"><span data-stu-id="55e88-132">By default, VMs provide basic host-level metrics for disk, network, and CPU usage.</span></span> <span data-ttu-id="55e88-133">When you configure the collection of diagnostics data using the diagnostic extension, additional guest OS performance counters become available for disk, CPU, and memory.</span><span class="sxs-lookup"><span data-stu-id="55e88-133">When you configure the collection of diagnostics data using the diagnostic extension, additional guest OS performance counters become available for disk, CPU, and memory.</span></span>

![Metric criteria](./media/virtual-machines-autoscale/virtual-machines-autoscale-criteria.png)

<span data-ttu-id="55e88-135">If your application needs to scale based on metrics that are not available through the host, then the VMs in the scale set need to have either the [Linux diagnostic extension](../articles/virtual-machines/linux/diagnostic-extension.md) or [Windows diagnostics extension](../articles/virtual-machines/windows/ps-extensions-diagnostics.md) installed.</span><span class="sxs-lookup"><span data-stu-id="55e88-135">If your application needs to scale based on metrics that are not available through the host, then the VMs in the scale set need to have either the [Linux diagnostic extension](../articles/virtual-machines/linux/diagnostic-extension.md) or [Windows diagnostics extension](../articles/virtual-machines/windows/ps-extensions-diagnostics.md) installed.</span></span> <span data-ttu-id="55e88-136">If you create a scale set using the Azure portal, you need to also use Azure PowerShell or the Azure CLI to install the extension with the diagnostics configuration that you need.</span><span class="sxs-lookup"><span data-stu-id="55e88-136">If you create a scale set using the Azure portal, you need to also use Azure PowerShell or the Azure CLI to install the extension with the diagnostics configuration that you need.</span></span>
 
### <a name="rules"></a><span data-ttu-id="55e88-137">Rules</span><span class="sxs-lookup"><span data-stu-id="55e88-137">Rules</span></span>

<span data-ttu-id="55e88-138">[Rules](../articles/monitoring-and-diagnostics/monitoring-autoscale-scale-by-custom-metric.md) combine a metric with an action to be performed.</span><span class="sxs-lookup"><span data-stu-id="55e88-138">[Rules](../articles/monitoring-and-diagnostics/monitoring-autoscale-scale-by-custom-metric.md) combine a metric with an action to be performed.</span></span> <span data-ttu-id="55e88-139">When rule conditions are met, one or more autoscale actions are triggered.</span><span class="sxs-lookup"><span data-stu-id="55e88-139">When rule conditions are met, one or more autoscale actions are triggered.</span></span> <span data-ttu-id="55e88-140">For example, you might have a rule defined that increases the number of VMs by 1 if the average CPU usage goes above 85 percent.</span><span class="sxs-lookup"><span data-stu-id="55e88-140">For example, you might have a rule defined that increases the number of VMs by 1 if the average CPU usage goes above 85 percent.</span></span>

![Autoscale actions](./media/virtual-machines-autoscale/virtual-machines-autoscale-actions.png)
 
### <a name="notifications"></a><span data-ttu-id="55e88-142">Notifications</span><span class="sxs-lookup"><span data-stu-id="55e88-142">Notifications</span></span>

<span data-ttu-id="55e88-143">You can [set up triggers](../articles/monitoring-and-diagnostics/insights-autoscale-to-webhook-email.md) so that specific web URLs are called or emails are sent based on the autoscale rules that you create.</span><span class="sxs-lookup"><span data-stu-id="55e88-143">You can [set up triggers](../articles/monitoring-and-diagnostics/insights-autoscale-to-webhook-email.md) so that specific web URLs are called or emails are sent based on the autoscale rules that you create.</span></span> <span data-ttu-id="55e88-144">Webhooks allow you to route the Azure alert notifications to other systems for post-processing or custom notifications.</span><span class="sxs-lookup"><span data-stu-id="55e88-144">Webhooks allow you to route the Azure alert notifications to other systems for post-processing or custom notifications.</span></span>

## <a name="manually-scale-vms-in-a-scale-set"></a><span data-ttu-id="55e88-145">Manually scale VMs in a scale set</span><span class="sxs-lookup"><span data-stu-id="55e88-145">Manually scale VMs in a scale set</span></span>

### <a name="horizontal"></a><span data-ttu-id="55e88-146">Horizontal</span><span class="sxs-lookup"><span data-stu-id="55e88-146">Horizontal</span></span>

<span data-ttu-id="55e88-147">You can add or remove VMs by changing the capacity of the scale set.</span><span class="sxs-lookup"><span data-stu-id="55e88-147">You can add or remove VMs by changing the capacity of the scale set.</span></span> <span data-ttu-id="55e88-148">In the Azure portal, you can decrease or increase the number of VMs (shown as **instance count**) in the scale set by sliding the Override condition bar on the Scaling screen left or right.</span><span class="sxs-lookup"><span data-stu-id="55e88-148">In the Azure portal, you can decrease or increase the number of VMs (shown as **instance count**) in the scale set by sliding the Override condition bar on the Scaling screen left or right.</span></span>

<span data-ttu-id="55e88-149">Using Azure PowerShell, you need to get the scale set object using [Get-AzureRmVmss](https://docs.microsoft.com/powershell/module/azurerm.compute/get-azurermvmss).</span><span class="sxs-lookup"><span data-stu-id="55e88-149">Using Azure PowerShell, you need to get the scale set object using [Get-AzureRmVmss](https://docs.microsoft.com/powershell/module/azurerm.compute/get-azurermvmss).</span></span> <span data-ttu-id="55e88-150">You then set the **sku.capacity** property to the number of VMs that you want and update the scale set with [Update-AzureRmVmss](https://docs.microsoft.com/powershell/module/azurerm.compute/update-azurermvmss).</span><span class="sxs-lookup"><span data-stu-id="55e88-150">You then set the **sku.capacity** property to the number of VMs that you want and update the scale set with [Update-AzureRmVmss](https://docs.microsoft.com/powershell/module/azurerm.compute/update-azurermvmss).</span></span> <span data-ttu-id="55e88-151">Using Azure CLI, you change the capacity with the **--new-capacity** parameter for the [az vmss scale](https://docs.microsoft.com/cli/azure/vmss#az_vmss_scale) command.</span><span class="sxs-lookup"><span data-stu-id="55e88-151">Using Azure CLI, you change the capacity with the **--new-capacity** parameter for the [az vmss scale](https://docs.microsoft.com/cli/azure/vmss#az_vmss_scale) command.</span></span>

### <a name="vertical"></a><span data-ttu-id="55e88-152">Vertical</span><span class="sxs-lookup"><span data-stu-id="55e88-152">Vertical</span></span>

<span data-ttu-id="55e88-153">You can manually change the size of the VMs in the Azure portal on the Size screen for the scale set.</span><span class="sxs-lookup"><span data-stu-id="55e88-153">You can manually change the size of the VMs in the Azure portal on the Size screen for the scale set.</span></span> <span data-ttu-id="55e88-154">You can use Azure PowerShell with Get-AzureRmVmss, setting the image reference sku property, and then using [Update-AzureRmVmss](https://docs.microsoft.com/powershell/module/azurerm.compute/update-azurermvmss) and [Update-AzureRmVmssInstance](https://docs.microsoft.com/powershell/module/azurerm.compute/update-azurermvmssinstance).</span><span class="sxs-lookup"><span data-stu-id="55e88-154">You can use Azure PowerShell with Get-AzureRmVmss, setting the image reference sku property, and then using [Update-AzureRmVmss](https://docs.microsoft.com/powershell/module/azurerm.compute/update-azurermvmss) and [Update-AzureRmVmssInstance](https://docs.microsoft.com/powershell/module/azurerm.compute/update-azurermvmssinstance).</span></span>

## <a name="next-steps"></a><span data-ttu-id="55e88-155">Next steps</span><span class="sxs-lookup"><span data-stu-id="55e88-155">Next steps</span></span>

- <span data-ttu-id="55e88-156">Learn more about scale sets in [Design Considerations for Scale Sets](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-design-overview.md).</span><span class="sxs-lookup"><span data-stu-id="55e88-156">Learn more about scale sets in [Design Considerations for Scale Sets](../articles/virtual-machine-scale-sets/virtual-machine-scale-sets-design-overview.md).</span></span>

