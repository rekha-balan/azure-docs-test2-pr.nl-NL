
<span data-ttu-id="e7e43-101">Each endpoint has a *public port* and a *private port*:</span><span class="sxs-lookup"><span data-stu-id="e7e43-101">Each endpoint has a *public port* and a *private port*:</span></span>

* <span data-ttu-id="e7e43-102">The public port is used by the Azure load balancer to listen for incoming traffic to the virtual machine from the Internet.</span><span class="sxs-lookup"><span data-stu-id="e7e43-102">The public port is used by the Azure load balancer to listen for incoming traffic to the virtual machine from the Internet.</span></span>
* <span data-ttu-id="e7e43-103">The private port is used by the virtual machine to listen for incoming traffic, typically destined to an application or service running on the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="e7e43-103">The private port is used by the virtual machine to listen for incoming traffic, typically destined to an application or service running on the virtual machine.</span></span>

<span data-ttu-id="e7e43-104">Default values for the IP protocol and TCP or UDP ports for well-known network protocols are provided when you create endpoints with the Azure classic portal.</span><span class="sxs-lookup"><span data-stu-id="e7e43-104">Default values for the IP protocol and TCP or UDP ports for well-known network protocols are provided when you create endpoints with the Azure classic portal.</span></span> <span data-ttu-id="e7e43-105">For custom endpoints, you'll need to specify the correct IP protocol (TCP or UDP) and the public and private ports.</span><span class="sxs-lookup"><span data-stu-id="e7e43-105">For custom endpoints, you'll need to specify the correct IP protocol (TCP or UDP) and the public and private ports.</span></span> <span data-ttu-id="e7e43-106">To distribute incoming traffic randomly across multiple virtual machines, you'll need to create a load-balanced set consisting of multiple endpoints.</span><span class="sxs-lookup"><span data-stu-id="e7e43-106">To distribute incoming traffic randomly across multiple virtual machines, you'll need to create a load-balanced set consisting of multiple endpoints.</span></span>

<span data-ttu-id="e7e43-107">After you create an endpoint, you can use an access control list (ACL) to define rules that permit or deny the incoming traffic to the public port of the endpoint based on its source IP address.</span><span class="sxs-lookup"><span data-stu-id="e7e43-107">After you create an endpoint, you can use an access control list (ACL) to define rules that permit or deny the incoming traffic to the public port of the endpoint based on its source IP address.</span></span> <span data-ttu-id="e7e43-108">However, if the virtual machine is in an Azure virtual network, you should use network security groups instead.</span><span class="sxs-lookup"><span data-stu-id="e7e43-108">However, if the virtual machine is in an Azure virtual network, you should use network security groups instead.</span></span> <span data-ttu-id="e7e43-109">For details, see [About network security groups](../articles/virtual-network/virtual-networks-nsg.md).</span><span class="sxs-lookup"><span data-stu-id="e7e43-109">For details, see [About network security groups](../articles/virtual-network/virtual-networks-nsg.md).</span></span>

> [!NOTE]
> <span data-ttu-id="e7e43-110">Firewall configuration for Azure virtual machines is done automatically for ports associated with remote connectivity endpoints that Azure sets up automatically.</span><span class="sxs-lookup"><span data-stu-id="e7e43-110">Firewall configuration for Azure virtual machines is done automatically for ports associated with remote connectivity endpoints that Azure sets up automatically.</span></span> <span data-ttu-id="e7e43-111">For ports specified for all other endpoints, no configuration is done automatically to the firewall of the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="e7e43-111">For ports specified for all other endpoints, no configuration is done automatically to the firewall of the virtual machine.</span></span> <span data-ttu-id="e7e43-112">When you create an endpoint for the virtual machine, you'll need to ensure that the firewall of the virtual machine also allows the traffic for the protocol and private port corresponding to the endpoint configuration.</span><span class="sxs-lookup"><span data-stu-id="e7e43-112">When you create an endpoint for the virtual machine, you'll need to ensure that the firewall of the virtual machine also allows the traffic for the protocol and private port corresponding to the endpoint configuration.</span></span> <span data-ttu-id="e7e43-113">To configure the firewall, see the documentation or on-line help for the operating system running on the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="e7e43-113">To configure the firewall, see the documentation or on-line help for the operating system running on the virtual machine.</span></span>
> 
> 

## <a name="create-an-endpoint"></a><span data-ttu-id="e7e43-114">Create an endpoint</span><span class="sxs-lookup"><span data-stu-id="e7e43-114">Create an endpoint</span></span>
1. <span data-ttu-id="e7e43-115">If you haven't already done so, sign in to the [Azure classic portal](http://manage.windowsazure.com).</span><span class="sxs-lookup"><span data-stu-id="e7e43-115">If you haven't already done so, sign in to the [Azure classic portal](http://manage.windowsazure.com).</span></span>
2. <span data-ttu-id="e7e43-116">Click **Virtual Machines**, and then click the name of the virtual machine that you want to configure.</span><span class="sxs-lookup"><span data-stu-id="e7e43-116">Click **Virtual Machines**, and then click the name of the virtual machine that you want to configure.</span></span>
3. <span data-ttu-id="e7e43-117">Click **Endpoints**.</span><span class="sxs-lookup"><span data-stu-id="e7e43-117">Click **Endpoints**.</span></span> <span data-ttu-id="e7e43-118">The **Endpoints** page lists all the current endpoints for the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="e7e43-118">The **Endpoints** page lists all the current endpoints for the virtual machine.</span></span> <span data-ttu-id="e7e43-119">(This example is a Windows VM.</span><span class="sxs-lookup"><span data-stu-id="e7e43-119">(This example is a Windows VM.</span></span> <span data-ttu-id="e7e43-120">A Linux VM will by default show an endpoint for SSH.)</span><span class="sxs-lookup"><span data-stu-id="e7e43-120">A Linux VM will by default show an endpoint for SSH.)</span></span>
   
   ![Endpoints](https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/virtual-machines-common-classic-setup-endpoints/endpointswindows.png)
4. <span data-ttu-id="e7e43-122">In the taskbar, click **Add**.</span><span class="sxs-lookup"><span data-stu-id="e7e43-122">In the taskbar, click **Add**.</span></span>
5. <span data-ttu-id="e7e43-123">On the **Add an endpoint to a virtual machine** page, choose the type of endpoint.</span><span class="sxs-lookup"><span data-stu-id="e7e43-123">On the **Add an endpoint to a virtual machine** page, choose the type of endpoint.</span></span>
   
   * <span data-ttu-id="e7e43-124">If you're creating a new endpoint that isn't part of a load-balanced set, or is the first endpoint in a new load-balanced set, choose **Add a stand-alone endpoint**, then click the left arrow.</span><span class="sxs-lookup"><span data-stu-id="e7e43-124">If you're creating a new endpoint that isn't part of a load-balanced set, or is the first endpoint in a new load-balanced set, choose **Add a stand-alone endpoint**, then click the left arrow.</span></span>
   * <span data-ttu-id="e7e43-125">Otherwise, choose **Add an endpoint to an existing load-balanced set**, select the name of the load-balanced set, then click the left arrow.</span><span class="sxs-lookup"><span data-stu-id="e7e43-125">Otherwise, choose **Add an endpoint to an existing load-balanced set**, select the name of the load-balanced set, then click the left arrow.</span></span> <span data-ttu-id="e7e43-126">On the **Specify the details of the endpoint** page, type a name for the endpoint, then click the check mark to create the endpoint.</span><span class="sxs-lookup"><span data-stu-id="e7e43-126">On the **Specify the details of the endpoint** page, type a name for the endpoint, then click the check mark to create the endpoint.</span></span>
6. <span data-ttu-id="e7e43-127">On the **Specify the details of the endpoint** page, type a name for the endpoint in **Name**.</span><span class="sxs-lookup"><span data-stu-id="e7e43-127">On the **Specify the details of the endpoint** page, type a name for the endpoint in **Name**.</span></span> <span data-ttu-id="e7e43-128">You can also choose a network protocol name from the list, which will fill in initial values for the **Protocol**, **Public Port**, and **Private Port**.</span><span class="sxs-lookup"><span data-stu-id="e7e43-128">You can also choose a network protocol name from the list, which will fill in initial values for the **Protocol**, **Public Port**, and **Private Port**.</span></span>
7. <span data-ttu-id="e7e43-129">For a customized endpoint, in **Protocol**, choose either **TCP** or **UDP**.</span><span class="sxs-lookup"><span data-stu-id="e7e43-129">For a customized endpoint, in **Protocol**, choose either **TCP** or **UDP**.</span></span>
8. <span data-ttu-id="e7e43-130">For customized ports, in **Public Port**, type the port number for the incoming traffic from the Internet.</span><span class="sxs-lookup"><span data-stu-id="e7e43-130">For customized ports, in **Public Port**, type the port number for the incoming traffic from the Internet.</span></span> <span data-ttu-id="e7e43-131">In **Private Port**, type the port number on which the virtual machine is listening.</span><span class="sxs-lookup"><span data-stu-id="e7e43-131">In **Private Port**, type the port number on which the virtual machine is listening.</span></span> <span data-ttu-id="e7e43-132">These port numbers can be different.</span><span class="sxs-lookup"><span data-stu-id="e7e43-132">These port numbers can be different.</span></span> <span data-ttu-id="e7e43-133">Ensure that the firewall on the virtual machine has been configured to allow the traffic corresponding to the protocol (in step 7) and private port.</span><span class="sxs-lookup"><span data-stu-id="e7e43-133">Ensure that the firewall on the virtual machine has been configured to allow the traffic corresponding to the protocol (in step 7) and private port.</span></span>
9. <span data-ttu-id="e7e43-134">If this endpoint will be the first one in a load-balanced set, click **Create a load-balanced set**, and then click the right arrow.</span><span class="sxs-lookup"><span data-stu-id="e7e43-134">If this endpoint will be the first one in a load-balanced set, click **Create a load-balanced set**, and then click the right arrow.</span></span> <span data-ttu-id="e7e43-135">On the **Configure the load-balanced set** page, specify a load-balanced set name, a probe protocol and port, and the probe interval and number of probes sent.</span><span class="sxs-lookup"><span data-stu-id="e7e43-135">On the **Configure the load-balanced set** page, specify a load-balanced set name, a probe protocol and port, and the probe interval and number of probes sent.</span></span> <span data-ttu-id="e7e43-136">The Azure load balancer sends probes to the virtual machines in a load-balanced set to monitor their availability.</span><span class="sxs-lookup"><span data-stu-id="e7e43-136">The Azure load balancer sends probes to the virtual machines in a load-balanced set to monitor their availability.</span></span> <span data-ttu-id="e7e43-137">The Azure load balancer does not forward traffic to virtual machines that do not respond to the probe.</span><span class="sxs-lookup"><span data-stu-id="e7e43-137">The Azure load balancer does not forward traffic to virtual machines that do not respond to the probe.</span></span> <span data-ttu-id="e7e43-138">Click the right arrow.</span><span class="sxs-lookup"><span data-stu-id="e7e43-138">Click the right arrow.</span></span>
10. <span data-ttu-id="e7e43-139">Click the check mark to create the endpoint.</span><span class="sxs-lookup"><span data-stu-id="e7e43-139">Click the check mark to create the endpoint.</span></span>

<span data-ttu-id="e7e43-140">The new endpoint will be listed on the **Endpoints** page.</span><span class="sxs-lookup"><span data-stu-id="e7e43-140">The new endpoint will be listed on the **Endpoints** page.</span></span>

![Endpoint creation successful](https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/virtual-machines-common-classic-setup-endpoints/endpointwindowsnew.png)

## <a name="manage-the-acl-on-an-endpoint"></a><span data-ttu-id="e7e43-142">Manage the ACL on an endpoint</span><span class="sxs-lookup"><span data-stu-id="e7e43-142">Manage the ACL on an endpoint</span></span>
<span data-ttu-id="e7e43-143">To define the set of computers that can send traffic, the ACL on an endpoint can restrict traffic based upon source IP address.</span><span class="sxs-lookup"><span data-stu-id="e7e43-143">To define the set of computers that can send traffic, the ACL on an endpoint can restrict traffic based upon source IP address.</span></span> <span data-ttu-id="e7e43-144">Follow these steps to add, modify, or remove an ACL on an endpoint.</span><span class="sxs-lookup"><span data-stu-id="e7e43-144">Follow these steps to add, modify, or remove an ACL on an endpoint.</span></span>

> [!NOTE]
> <span data-ttu-id="e7e43-145">If the endpoint is part of a load-balanced set, any changes you make to the ACL on an endpoint are applied to all endpoints in the set.</span><span class="sxs-lookup"><span data-stu-id="e7e43-145">If the endpoint is part of a load-balanced set, any changes you make to the ACL on an endpoint are applied to all endpoints in the set.</span></span>
> 
> 

<span data-ttu-id="e7e43-146">If the virtual machine is in an Azure virtual network, we recommend network security groups instead of ACLs.</span><span class="sxs-lookup"><span data-stu-id="e7e43-146">If the virtual machine is in an Azure virtual network, we recommend network security groups instead of ACLs.</span></span> <span data-ttu-id="e7e43-147">For details, see [About network security groups](../articles/virtual-network/virtual-networks-nsg.md).</span><span class="sxs-lookup"><span data-stu-id="e7e43-147">For details, see [About network security groups](../articles/virtual-network/virtual-networks-nsg.md).</span></span>

1. <span data-ttu-id="e7e43-148">If you haven't already done so, sign in to the Azure classic portal.</span><span class="sxs-lookup"><span data-stu-id="e7e43-148">If you haven't already done so, sign in to the Azure classic portal.</span></span>
2. <span data-ttu-id="e7e43-149">Click **Virtual Machines**, and then click the name of the virtual machine that you want to configure.</span><span class="sxs-lookup"><span data-stu-id="e7e43-149">Click **Virtual Machines**, and then click the name of the virtual machine that you want to configure.</span></span>
3. <span data-ttu-id="e7e43-150">Click **Endpoints**.</span><span class="sxs-lookup"><span data-stu-id="e7e43-150">Click **Endpoints**.</span></span> <span data-ttu-id="e7e43-151">From the list, select the appropriate endpoint.</span><span class="sxs-lookup"><span data-stu-id="e7e43-151">From the list, select the appropriate endpoint.</span></span>
   
   ![ACL list](https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/virtual-machines-common-classic-setup-endpoints/EndpointsShowsDefaultEndpointsForVM.png)
4. <span data-ttu-id="e7e43-153">In the taskbar, click **Manage ACL** to open the **Specify ACL details** dialog box.</span><span class="sxs-lookup"><span data-stu-id="e7e43-153">In the taskbar, click **Manage ACL** to open the **Specify ACL details** dialog box.</span></span>
   
   ![Specify ACL details](https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/virtual-machines-common-classic-setup-endpoints/EndpointACLdetails.png)
5. <span data-ttu-id="e7e43-155">Use rows in the list to add, delete, or edit rules for an ACL and change their order.</span><span class="sxs-lookup"><span data-stu-id="e7e43-155">Use rows in the list to add, delete, or edit rules for an ACL and change their order.</span></span> <span data-ttu-id="e7e43-156">The **Remote Subnet** value is an IP address range for incoming traffic from the Internet that the Azure load balancer uses to permit or deny the traffic based on its source IP address.</span><span class="sxs-lookup"><span data-stu-id="e7e43-156">The **Remote Subnet** value is an IP address range for incoming traffic from the Internet that the Azure load balancer uses to permit or deny the traffic based on its source IP address.</span></span> <span data-ttu-id="e7e43-157">Be sure to specify the IP address range in CIDR format, also known as address prefix format.</span><span class="sxs-lookup"><span data-stu-id="e7e43-157">Be sure to specify the IP address range in CIDR format, also known as address prefix format.</span></span> <span data-ttu-id="e7e43-158">An example is 131.107.0.0/16.</span><span class="sxs-lookup"><span data-stu-id="e7e43-158">An example is 131.107.0.0/16.</span></span>

<span data-ttu-id="e7e43-159">You can use rules to allow only traffic from specific computers corresponding to your computers on the Internet or to deny traffic from specific, known address ranges.</span><span class="sxs-lookup"><span data-stu-id="e7e43-159">You can use rules to allow only traffic from specific computers corresponding to your computers on the Internet or to deny traffic from specific, known address ranges.</span></span>

<span data-ttu-id="e7e43-160">The rules are evaluated in order starting with the first rule and ending with the last rule.</span><span class="sxs-lookup"><span data-stu-id="e7e43-160">The rules are evaluated in order starting with the first rule and ending with the last rule.</span></span> <span data-ttu-id="e7e43-161">This means that rules should be ordered from least restrictive to most restrictive.</span><span class="sxs-lookup"><span data-stu-id="e7e43-161">This means that rules should be ordered from least restrictive to most restrictive.</span></span> <span data-ttu-id="e7e43-162">For examples and more information, see [What is a Network Access Control List?](../articles/virtual-network/virtual-networks-acl.md).</span><span class="sxs-lookup"><span data-stu-id="e7e43-162">For examples and more information, see [What is a Network Access Control List?](../articles/virtual-network/virtual-networks-acl.md).</span></span>





