# <a name="how-to-create-a-custom-virtual-machine"></a><span data-ttu-id="2b7b9-101">How to Create a Custom Virtual Machine</span><span class="sxs-lookup"><span data-stu-id="2b7b9-101">How to Create a Custom Virtual Machine</span></span>
<span data-ttu-id="2b7b9-102">A *custom* virtual machine refers to a virtual machine you create using the **From Gallery** method because it lets you configure more options than the **Quick Create** method.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-102">A *custom* virtual machine refers to a virtual machine you create using the **From Gallery** method because it lets you configure more options than the **Quick Create** method.</span></span> <span data-ttu-id="2b7b9-103">These options include:</span><span class="sxs-lookup"><span data-stu-id="2b7b9-103">These options include:</span></span>

* <span data-ttu-id="2b7b9-104">More choices for the image to use to create the virtual machine (VM)</span><span class="sxs-lookup"><span data-stu-id="2b7b9-104">More choices for the image to use to create the virtual machine (VM)</span></span>
* <span data-ttu-id="2b7b9-105">Connecting the VM to a virtual network</span><span class="sxs-lookup"><span data-stu-id="2b7b9-105">Connecting the VM to a virtual network</span></span>
* <span data-ttu-id="2b7b9-106">Adding the VM to an existing cloud service</span><span class="sxs-lookup"><span data-stu-id="2b7b9-106">Adding the VM to an existing cloud service</span></span>
* <span data-ttu-id="2b7b9-107">Adding the VM to an availability set</span><span class="sxs-lookup"><span data-stu-id="2b7b9-107">Adding the VM to an availability set</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2b7b9-108">If you want your virtual machine to use a virtual network so you can connect to it directly by hostname or set up cross-premises connections, make sure you specify the virtual network when you create the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-108">If you want your virtual machine to use a virtual network so you can connect to it directly by hostname or set up cross-premises connections, make sure you specify the virtual network when you create the virtual machine.</span></span> <span data-ttu-id="2b7b9-109">A virtual machine can be configured to join a virtual network only when you create the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-109">A virtual machine can be configured to join a virtual network only when you create the virtual machine.</span></span> <span data-ttu-id="2b7b9-110">For more information about virtual networks, see [Azure Virtual Network Overview](http://go.microsoft.com/fwlink/p/?LinkID=294063).</span><span class="sxs-lookup"><span data-stu-id="2b7b9-110">For more information about virtual networks, see [Azure Virtual Network Overview](http://go.microsoft.com/fwlink/p/?LinkID=294063).</span></span>
> 
> 

1. <span data-ttu-id="2b7b9-111">Sign in to the [Azure portal](http://manage.windowsazure.com).</span><span class="sxs-lookup"><span data-stu-id="2b7b9-111">Sign in to the [Azure portal](http://manage.windowsazure.com).</span></span>
2. <span data-ttu-id="2b7b9-112">On the command bar, click **New**.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-112">On the command bar, click **New**.</span></span>
3. <span data-ttu-id="2b7b9-113">Click **Compute**, click **Virtual Machine**, and then click **From Gallery**.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-113">Click **Compute**, click **Virtual Machine**, and then click **From Gallery**.</span></span>
4. <span data-ttu-id="2b7b9-114">Choose the image you want to use, and then click the arrow to continue.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-114">Choose the image you want to use, and then click the arrow to continue.</span></span>
5. <span data-ttu-id="2b7b9-115">If multiple versions of the image are available, in **Version Release Date**, pick the version you want to use.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-115">If multiple versions of the image are available, in **Version Release Date**, pick the version you want to use.</span></span>
6. <span data-ttu-id="2b7b9-116">In **Virtual Machine Name**, type the name that you want to use for the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-116">In **Virtual Machine Name**, type the name that you want to use for the virtual machine.</span></span>
7. <span data-ttu-id="2b7b9-117">Use **Tier** and **Size** to select the appropriate size for the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-117">Use **Tier** and **Size** to select the appropriate size for the virtual machine.</span></span> <span data-ttu-id="2b7b9-118">The size you select affects the maximum configuration of the virtual machine, as well as the pricing.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-118">The size you select affects the maximum configuration of the virtual machine, as well as the pricing.</span></span> <span data-ttu-id="2b7b9-119">For configuration details, see [Virtual Machine and Cloud Service Sizes for Azure](http://go.microsoft.com/fwlink/p/?LinkID=389844).</span><span class="sxs-lookup"><span data-stu-id="2b7b9-119">For configuration details, see [Virtual Machine and Cloud Service Sizes for Azure](http://go.microsoft.com/fwlink/p/?LinkID=389844).</span></span>
8. <span data-ttu-id="2b7b9-120">In **New User Name**, type a name for the administrative account that you want to use to manage the server.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-120">In **New User Name**, type a name for the administrative account that you want to use to manage the server.</span></span>
9. <span data-ttu-id="2b7b9-121">In **New Password**, type a strong password for the administrative account.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-121">In **New Password**, type a strong password for the administrative account.</span></span> <span data-ttu-id="2b7b9-122">In **Confirm Password**, retype the same password.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-122">In **Confirm Password**, retype the same password.</span></span>
10. <span data-ttu-id="2b7b9-123">Click the arrow to continue.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-123">Click the arrow to continue.</span></span>
11. <span data-ttu-id="2b7b9-124">In **Cloud Service**, do one of the following:</span><span class="sxs-lookup"><span data-stu-id="2b7b9-124">In **Cloud Service**, do one of the following:</span></span>
    
    * <span data-ttu-id="2b7b9-125">If this is the first or only virtual machine in the cloud service, select **Create a New Cloud Service**.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-125">If this is the first or only virtual machine in the cloud service, select **Create a New Cloud Service**.</span></span> <span data-ttu-id="2b7b9-126">Then, in **Cloud Service DNS Name**, type a name that uses between 3 and 24 lowercase letters and numbers.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-126">Then, in **Cloud Service DNS Name**, type a name that uses between 3 and 24 lowercase letters and numbers.</span></span> <span data-ttu-id="2b7b9-127">This name becomes part of the URI that is used to contact the virtual machine through the cloud service.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-127">This name becomes part of the URI that is used to contact the virtual machine through the cloud service.</span></span>
    * <span data-ttu-id="2b7b9-128">If this virtual machine is being added to a cloud service, select it in the list.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-128">If this virtual machine is being added to a cloud service, select it in the list.</span></span>
    
    > [!NOTE]
    > <span data-ttu-id="2b7b9-129">For more information about placing virtual machines in the same cloud service, see [How to connect virtual machines in a cloud service](https://azure.microsoft.com/manage/windows/how-to-guides/connect-to-a-cloud-service/).</span><span class="sxs-lookup"><span data-stu-id="2b7b9-129">For more information about placing virtual machines in the same cloud service, see [How to connect virtual machines in a cloud service](https://azure.microsoft.com/manage/windows/how-to-guides/connect-to-a-cloud-service/).</span></span>
    > 
    > 
12. <span data-ttu-id="2b7b9-130">In **Region/Affinity Group/Virtual Network**, select region, affinity group, or virtual network that you want to use for the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-130">In **Region/Affinity Group/Virtual Network**, select region, affinity group, or virtual network that you want to use for the virtual machine.</span></span> <span data-ttu-id="2b7b9-131">For more information about affinity groups, see [About Affinity Groups for Virtual Network](../articles/virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="2b7b9-131">For more information about affinity groups, see [About Affinity Groups for Virtual Network](../articles/virtual-network/virtual-networks-migrate-to-regional-vnet.md).</span></span>
13. <span data-ttu-id="2b7b9-132">In **Storage Account**, select an existing storage account for the VHD file, or use an automatically generated storage account.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-132">In **Storage Account**, select an existing storage account for the VHD file, or use an automatically generated storage account.</span></span> <span data-ttu-id="2b7b9-133">Only one storage account per region is automatically created.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-133">Only one storage account per region is automatically created.</span></span> <span data-ttu-id="2b7b9-134">All other virtual machines that you create with this setting are located in this storage account.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-134">All other virtual machines that you create with this setting are located in this storage account.</span></span> <span data-ttu-id="2b7b9-135">You are limited to 20 storage accounts.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-135">You are limited to 20 storage accounts.</span></span>
14. <span data-ttu-id="2b7b9-136">If you want the virtual machine to belong to an availability set, in **Availability Set**, select **Create availability set** or add it to an existing availability set.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-136">If you want the virtual machine to belong to an availability set, in **Availability Set**, select **Create availability set** or add it to an existing availability set.</span></span>
    
    <span data-ttu-id="2b7b9-137">**Note**: Virtual machines in an availability set are deployed to different fault domains.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-137">**Note**: Virtual machines in an availability set are deployed to different fault domains.</span></span> <span data-ttu-id="2b7b9-138">Placing multiple virtual machines in an availability set helps ensure that your application is available during network failures, local disk hardware failures, and any planned downtime.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-138">Placing multiple virtual machines in an availability set helps ensure that your application is available during network failures, local disk hardware failures, and any planned downtime.</span></span>
15. <span data-ttu-id="2b7b9-139">Under **Endpoints**, review the new endpoints that will be created to allow connections to the virtual machine, such through Remote Desktop or a Secure Shell (SSH) client.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-139">Under **Endpoints**, review the new endpoints that will be created to allow connections to the virtual machine, such through Remote Desktop or a Secure Shell (SSH) client.</span></span> <span data-ttu-id="2b7b9-140">You also can add endpoints now, or create them later.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-140">You also can add endpoints now, or create them later.</span></span> <span data-ttu-id="2b7b9-141">For instructions on creating them later, see [How to Set Up Endpoints to a Virtual Machine](../articles/virtual-machines/windows/classic/setup-endpoints.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="2b7b9-141">For instructions on creating them later, see [How to Set Up Endpoints to a Virtual Machine](../articles/virtual-machines/windows/classic/setup-endpoints.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json).</span></span>
16. <span data-ttu-id="2b7b9-142">Under **VM Agent**, decide whether to install the VM Agent.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-142">Under **VM Agent**, decide whether to install the VM Agent.</span></span> <span data-ttu-id="2b7b9-143">This agent provides the environment for you to install extensions that can help you interact with the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-143">This agent provides the environment for you to install extensions that can help you interact with the virtual machine.</span></span> <span data-ttu-id="2b7b9-144">For details, see [Manage Extensions](http://go.microsoft.com/FWLink/p/?LinkID=390493).</span><span class="sxs-lookup"><span data-stu-id="2b7b9-144">For details, see [Manage Extensions](http://go.microsoft.com/FWLink/p/?LinkID=390493).</span></span>
17. <span data-ttu-id="2b7b9-145">Click the arrow to create the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-145">Click the arrow to create the virtual machine.</span></span>
    
    ![Custom virtual machine creation successful](https://docstestmedia1.blob.core.windows.net/azure-media/includes/media/howto-custom-create-vm/VMSuccessWindows.png)

## <a name="next-steps"></a><span data-ttu-id="2b7b9-147">Next Steps</span><span class="sxs-lookup"><span data-stu-id="2b7b9-147">Next Steps</span></span>
<span data-ttu-id="2b7b9-148">After the virtual machine is created, it's started automatically.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-148">After the virtual machine is created, it's started automatically.</span></span> <span data-ttu-id="2b7b9-149">When the portal shows the status as running, you can log in to the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2b7b9-149">When the portal shows the status as running, you can log in to the virtual machine.</span></span> <span data-ttu-id="2b7b9-150">For instructions, see one of the following articles:</span><span class="sxs-lookup"><span data-stu-id="2b7b9-150">For instructions, see one of the following articles:</span></span>

* [<span data-ttu-id="2b7b9-151">How to Log on to a Virtual Machine Running Linux</span><span class="sxs-lookup"><span data-stu-id="2b7b9-151">How to Log on to a Virtual Machine Running Linux</span></span>](../articles/virtual-machines/linux/mac-create-ssh-keys.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json)
* [<span data-ttu-id="2b7b9-152">How to Log on to a Virtual Machine Running Windows Server</span><span class="sxs-lookup"><span data-stu-id="2b7b9-152">How to Log on to a Virtual Machine Running Windows Server</span></span>](../articles/virtual-machines/windows/classic/connect-logon.md?toc=%2fazure%2fvirtual-machines%2fwindows%2fclassic%2ftoc.json)


