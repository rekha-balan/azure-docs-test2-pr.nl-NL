---
title: Troubleshoot Application Proxy | Microsoft Docs
description: Covers how to troubleshoot errors in Azure AD Application Proxy.
services: active-directory
documentationcenter: ''
author: kgremban
manager: femila
editor: harshja
ms.assetid: 970caafb-40b8-483c-bb46-c8b032a4fb74
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/27/2017
ms.author: kgremban
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 069b805f72708bf0ceb579c2b13d0dc68f11d975
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44554176"
---
# <a name="troubleshoot-application-proxy-problems-and-error-messages"></a><span data-ttu-id="7a410-103">Troubleshoot Application Proxy problems and error messages</span><span class="sxs-lookup"><span data-stu-id="7a410-103">Troubleshoot Application Proxy problems and error messages</span></span>
<span data-ttu-id="7a410-104">If errors occur in accessing a published application or in publishing applications, check the following options to see if Microsoft Azure AD Application Proxy is working correctly:</span><span class="sxs-lookup"><span data-stu-id="7a410-104">If errors occur in accessing a published application or in publishing applications, check the following options to see if Microsoft Azure AD Application Proxy is working correctly:</span></span>

* <span data-ttu-id="7a410-105">Open the Windows Services console and verify that the **Microsoft AAD Application Proxy Connector** service is enabled and running.</span><span class="sxs-lookup"><span data-stu-id="7a410-105">Open the Windows Services console and verify that the **Microsoft AAD Application Proxy Connector** service is enabled and running.</span></span> <span data-ttu-id="7a410-106">You may also want to look at the Application Proxy service properties page, as shown in the following image:</span><span class="sxs-lookup"><span data-stu-id="7a410-106">You may also want to look at the Application Proxy service properties page, as shown in the following image:</span></span>  
  <span data-ttu-id="7a410-107">![Microsoft AAD Application Proxy Connector Properties window screenshot](https://docstestmedia1.blob.core.windows.net/azure-media/articles/active-directory/media/active-directory-application-proxy-troubleshoot/connectorproperties.png)</span><span class="sxs-lookup"><span data-stu-id="7a410-107">![Microsoft AAD Application Proxy Connector Properties window screenshot](https://docstestmedia1.blob.core.windows.net/azure-media/articles/active-directory/media/active-directory-application-proxy-troubleshoot/connectorproperties.png)</span></span>
* <span data-ttu-id="7a410-108">Open Event Viewer and look for Application Proxy connector events in **Applications and Services Logs** > **Microsoft** > **AadApplicationProxy** > **Connector** > **Admin**.</span><span class="sxs-lookup"><span data-stu-id="7a410-108">Open Event Viewer and look for Application Proxy connector events in **Applications and Services Logs** > **Microsoft** > **AadApplicationProxy** > **Connector** > **Admin**.</span></span>
* <span data-ttu-id="7a410-109">If needed, more detailed logs are available by [turning on the Application Proxy connector session logs](application-proxy-understand-connectors.md#under-the-hood).</span><span class="sxs-lookup"><span data-stu-id="7a410-109">If needed, more detailed logs are available by [turning on the Application Proxy connector session logs](application-proxy-understand-connectors.md#under-the-hood).</span></span>

<span data-ttu-id="7a410-110">For more information about the Azure AD Troubleshooting tool, see [Troubleshooting tool to validate connector networking prerequisites](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/03/troubleshooting-tool-to-validate-connector-networking-prerequisites).</span><span class="sxs-lookup"><span data-stu-id="7a410-110">For more information about the Azure AD Troubleshooting tool, see [Troubleshooting tool to validate connector networking prerequisites](https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/03/troubleshooting-tool-to-validate-connector-networking-prerequisites).</span></span>

## <a name="the-page-is-not-rendered-correctly"></a><span data-ttu-id="7a410-111">The page is not rendered correctly</span><span class="sxs-lookup"><span data-stu-id="7a410-111">The page is not rendered correctly</span></span>
<span data-ttu-id="7a410-112">You may have problems with your application rendering or functioning incorrectly without receiving specific error messages.</span><span class="sxs-lookup"><span data-stu-id="7a410-112">You may have problems with your application rendering or functioning incorrectly without receiving specific error messages.</span></span> <span data-ttu-id="7a410-113">This can occur if you published the article path, but the application requires content that exists outside that path.</span><span class="sxs-lookup"><span data-stu-id="7a410-113">This can occur if you published the article path, but the application requires content that exists outside that path.</span></span>

<span data-ttu-id="7a410-114">For example, if you publish the path https://yourapp/app but the application calls images in https://yourapp/media, they won't be rendered.</span><span class="sxs-lookup"><span data-stu-id="7a410-114">For example, if you publish the path https://yourapp/app but the application calls images in https://yourapp/media, they won't be rendered.</span></span> <span data-ttu-id="7a410-115">Make sure that you publish the application using the highest level path you need to include all relevant content.</span><span class="sxs-lookup"><span data-stu-id="7a410-115">Make sure that you publish the application using the highest level path you need to include all relevant content.</span></span> <span data-ttu-id="7a410-116">In this example, it would be http://yourapp/.</span><span class="sxs-lookup"><span data-stu-id="7a410-116">In this example, it would be http://yourapp/.</span></span>

<span data-ttu-id="7a410-117">If you change your path to include referenced content, but still need users to land on a deeper link in the path, see the blog post [Setting the right link for Application Proxy applications in the Azure AD access panel and Office 365 app launcher](https://blogs.technet.microsoft.com/applicationproxyblog/2016/04/06/setting-the-right-link-for-application-proxy-applications-in-the-azure-ad-access-panel-and-office-365-app-launcher/).</span><span class="sxs-lookup"><span data-stu-id="7a410-117">If you change your path to include referenced content, but still need users to land on a deeper link in the path, see the blog post [Setting the right link for Application Proxy applications in the Azure AD access panel and Office 365 app launcher](https://blogs.technet.microsoft.com/applicationproxyblog/2016/04/06/setting-the-right-link-for-application-proxy-applications-in-the-azure-ad-access-panel-and-office-365-app-launcher/).</span></span>

## <a name="connector-errors"></a><span data-ttu-id="7a410-118">Connector errors</span><span class="sxs-lookup"><span data-stu-id="7a410-118">Connector errors</span></span>

<span data-ttu-id="7a410-119">Use the [Azure AD Application Proxy Connector Ports Test Tool](https://aadap-portcheck.connectorporttest.msappproxy.net/) to verify that your connector can reach the Application Proxy service.</span><span class="sxs-lookup"><span data-stu-id="7a410-119">Use the [Azure AD Application Proxy Connector Ports Test Tool](https://aadap-portcheck.connectorporttest.msappproxy.net/) to verify that your connector can reach the Application Proxy service.</span></span> <span data-ttu-id="7a410-120">At a minimum, make sure that the Central US region and the region closest to you have all green checkmarks.</span><span class="sxs-lookup"><span data-stu-id="7a410-120">At a minimum, make sure that the Central US region and the region closest to you have all green checkmarks.</span></span> <span data-ttu-id="7a410-121">Beyond that, more green checkmarks means greater resiliency.</span><span class="sxs-lookup"><span data-stu-id="7a410-121">Beyond that, more green checkmarks means greater resiliency.</span></span> 

<span data-ttu-id="7a410-122">If registration fails during the Connector wizard installation, there are two ways to view the reason for the failure.</span><span class="sxs-lookup"><span data-stu-id="7a410-122">If registration fails during the Connector wizard installation, there are two ways to view the reason for the failure.</span></span> <span data-ttu-id="7a410-123">Either look in the event log under **Applications and Services Logs\Microsoft\AadApplicationProxy\Connector\Admin**, or run the following Windows PowerShell command.</span><span class="sxs-lookup"><span data-stu-id="7a410-123">Either look in the event log under **Applications and Services Logs\Microsoft\AadApplicationProxy\Connector\Admin**, or run the following Windows PowerShell command.</span></span>

    Get-EventLog application –source “Microsoft AAD Application Proxy Connector” –EntryType “Error” –Newest 1

<span data-ttu-id="7a410-124">Once you find the Connector error from the event log, us this list of common errors to resolve the problem:</span><span class="sxs-lookup"><span data-stu-id="7a410-124">Once you find the Connector error from the event log, us this list of common errors to resolve the problem:</span></span>

- <span data-ttu-id="7a410-125">**Connector registration failed: Make sure you enabled Application Proxy in the Azure Management Portal and that you entered your Active Directory user name and password correctly. Error: 'One or more errors occurred.'**</span><span class="sxs-lookup"><span data-stu-id="7a410-125">**Connector registration failed: Make sure you enabled Application Proxy in the Azure Management Portal and that you entered your Active Directory user name and password correctly. Error: 'One or more errors occurred.'**</span></span>

  <span data-ttu-id="7a410-126">If you closed the registration window without signing in to Azure AD, run the Connector wizard again and register the Connector.</span><span class="sxs-lookup"><span data-stu-id="7a410-126">If you closed the registration window without signing in to Azure AD, run the Connector wizard again and register the Connector.</span></span>

  <span data-ttu-id="7a410-127">If the registration window opens and then immediately closes without allowing you to log in, you will probably get this error.</span><span class="sxs-lookup"><span data-stu-id="7a410-127">If the registration window opens and then immediately closes without allowing you to log in, you will probably get this error.</span></span> <span data-ttu-id="7a410-128">This error occurs when there is a networking error on your system.</span><span class="sxs-lookup"><span data-stu-id="7a410-128">This error occurs when there is a networking error on your system.</span></span> <span data-ttu-id="7a410-129">Make sure that it is possible to connect from a browser to a public website and that the ports are open as specified in [Application Proxy prerequisites](active-directory-application-proxy-enable.md).</span><span class="sxs-lookup"><span data-stu-id="7a410-129">Make sure that it is possible to connect from a browser to a public website and that the ports are open as specified in [Application Proxy prerequisites](active-directory-application-proxy-enable.md).</span></span>

- <span data-ttu-id="7a410-130">**Connector registration failed: Make sure your computer is connected to the Internet. Error: 'There was no endpoint listening at https://connector.msappproxy.net:9090/register/RegisterConnector that could accept the message. This is often caused by an incorrect address or SOAP action. See InnerException, if present, for more details.'**</span><span class="sxs-lookup"><span data-stu-id="7a410-130">**Connector registration failed: Make sure your computer is connected to the Internet. Error: 'There was no endpoint listening at https://connector.msappproxy.net:9090/register/RegisterConnector that could accept the message. This is often caused by an incorrect address or SOAP action. See InnerException, if present, for more details.'**</span></span>

  <span data-ttu-id="7a410-131">If you sign in using your Azure AD username and password but then receive this error, it may be that all ports above 8081 are blocked.</span><span class="sxs-lookup"><span data-stu-id="7a410-131">If you sign in using your Azure AD username and password but then receive this error, it may be that all ports above 8081 are blocked.</span></span> <span data-ttu-id="7a410-132">Make sure that the necessary ports are open.</span><span class="sxs-lookup"><span data-stu-id="7a410-132">Make sure that the necessary ports are open.</span></span> <span data-ttu-id="7a410-133">For more information, see [Application Proxy prerequisites](active-directory-application-proxy-enable.md).</span><span class="sxs-lookup"><span data-stu-id="7a410-133">For more information, see [Application Proxy prerequisites](active-directory-application-proxy-enable.md).</span></span>

- <span data-ttu-id="7a410-134">**Clear error is presented in the registration window. Cannot proceed**</span><span class="sxs-lookup"><span data-stu-id="7a410-134">**Clear error is presented in the registration window. Cannot proceed**</span></span>

  <span data-ttu-id="7a410-135">If you see this error and then the window closes it means that you entered the wrong username or password.</span><span class="sxs-lookup"><span data-stu-id="7a410-135">If you see this error and then the window closes it means that you entered the wrong username or password.</span></span> <span data-ttu-id="7a410-136">Try again.</span><span class="sxs-lookup"><span data-stu-id="7a410-136">Try again.</span></span> 

- <span data-ttu-id="7a410-137">**Connector registration failed: Make sure you enabled Application Proxy in the Azure Management Portal and that you entered your Active Directory user name and password correctly. Error: 'AADSTS50059: No tenant-identifying information found in either the request or implied by any provided credentials and search by service principal URI has failed.**</span><span class="sxs-lookup"><span data-stu-id="7a410-137">**Connector registration failed: Make sure you enabled Application Proxy in the Azure Management Portal and that you entered your Active Directory user name and password correctly. Error: 'AADSTS50059: No tenant-identifying information found in either the request or implied by any provided credentials and search by service principal URI has failed.**</span></span> 

  <span data-ttu-id="7a410-138">You are trying to sign in using a Microsoft Account and not a domain that is part of the organization ID of the directory you are trying to access.</span><span class="sxs-lookup"><span data-stu-id="7a410-138">You are trying to sign in using a Microsoft Account and not a domain that is part of the organization ID of the directory you are trying to access.</span></span> <span data-ttu-id="7a410-139">Make sure that the admin is part of the same domain name as the tenant domain, for example, if the Azure AD domain is contoso.com, the admin should be admin@contoso.com.</span><span class="sxs-lookup"><span data-stu-id="7a410-139">Make sure that the admin is part of the same domain name as the tenant domain, for example, if the Azure AD domain is contoso.com, the admin should be admin@contoso.com.</span></span> 

- <span data-ttu-id="7a410-140">**Failed to retrieve the current execution policy for running PowerShell scripts.**</span><span class="sxs-lookup"><span data-stu-id="7a410-140">**Failed to retrieve the current execution policy for running PowerShell scripts.**</span></span> 

  <span data-ttu-id="7a410-141">If the Connector installation fails, check to make sure that PowerShell execution policy is not disabled.</span><span class="sxs-lookup"><span data-stu-id="7a410-141">If the Connector installation fails, check to make sure that PowerShell execution policy is not disabled.</span></span> 

  1. <span data-ttu-id="7a410-142">Open the Group Policy Editor.</span><span class="sxs-lookup"><span data-stu-id="7a410-142">Open the Group Policy Editor.</span></span> 
  2. <span data-ttu-id="7a410-143">Go to **Computer Configuration** > **Administrative Templates** > **Windows Components** > **Windows PowerShell** and double-click **Turn on Script Execution**.</span><span class="sxs-lookup"><span data-stu-id="7a410-143">Go to **Computer Configuration** > **Administrative Templates** > **Windows Components** > **Windows PowerShell** and double-click **Turn on Script Execution**.</span></span> 
  3. <span data-ttu-id="7a410-144">The execution policy can be set to either **Not Configured** or **Enabled**.</span><span class="sxs-lookup"><span data-stu-id="7a410-144">The execution policy can be set to either **Not Configured** or **Enabled**.</span></span> <span data-ttu-id="7a410-145">If set to **Enabled**, make sure that under Options, the Execution Policy is set to either **Allow local scripts and remote signed scripts** or to **Allow all scripts**.</span><span class="sxs-lookup"><span data-stu-id="7a410-145">If set to **Enabled**, make sure that under Options, the Execution Policy is set to either **Allow local scripts and remote signed scripts** or to **Allow all scripts**.</span></span> 

- <span data-ttu-id="7a410-146">**Connector failed to download the configuration.**</span><span class="sxs-lookup"><span data-stu-id="7a410-146">**Connector failed to download the configuration.**</span></span> 

  <span data-ttu-id="7a410-147">The Connector’s client certificate, which is used for authentication, expired.</span><span class="sxs-lookup"><span data-stu-id="7a410-147">The Connector’s client certificate, which is used for authentication, expired.</span></span> <span data-ttu-id="7a410-148">This may also occur if you have the Connector installed behind a proxy.</span><span class="sxs-lookup"><span data-stu-id="7a410-148">This may also occur if you have the Connector installed behind a proxy.</span></span> <span data-ttu-id="7a410-149">In this case, the Connector cannot access the Internet and will not be able to provide applications to remote users.</span><span class="sxs-lookup"><span data-stu-id="7a410-149">In this case, the Connector cannot access the Internet and will not be able to provide applications to remote users.</span></span> <span data-ttu-id="7a410-150">Renew trust manually using the `Register-AppProxyConnector` cmdlet in Windows PowerShell.</span><span class="sxs-lookup"><span data-stu-id="7a410-150">Renew trust manually using the `Register-AppProxyConnector` cmdlet in Windows PowerShell.</span></span> <span data-ttu-id="7a410-151">If your Connector is behind a proxy, it is necessary to grant Internet access to the Connector accounts “network services” and “local system.”</span><span class="sxs-lookup"><span data-stu-id="7a410-151">If your Connector is behind a proxy, it is necessary to grant Internet access to the Connector accounts “network services” and “local system.”</span></span> <span data-ttu-id="7a410-152">This can be accomplished either by granting them access to the Proxy or by setting them to bypass the proxy.</span><span class="sxs-lookup"><span data-stu-id="7a410-152">This can be accomplished either by granting them access to the Proxy or by setting them to bypass the proxy.</span></span> 

- <span data-ttu-id="7a410-153">**Connector registration failed: Make sure you are a Global Administrator of your Active Directory to register the Connector. Error: 'The registration request was denied.'**</span><span class="sxs-lookup"><span data-stu-id="7a410-153">**Connector registration failed: Make sure you are a Global Administrator of your Active Directory to register the Connector. Error: 'The registration request was denied.'**</span></span> 

  <span data-ttu-id="7a410-154">The alias you're trying to log in with isn't an admin on this domain.</span><span class="sxs-lookup"><span data-stu-id="7a410-154">The alias you're trying to log in with isn't an admin on this domain.</span></span> <span data-ttu-id="7a410-155">Your Connector is always installed for the directory that owns the user’s domain.</span><span class="sxs-lookup"><span data-stu-id="7a410-155">Your Connector is always installed for the directory that owns the user’s domain.</span></span> <span data-ttu-id="7a410-156">Make sure that the admin account you are trying to sign in with has global permissions to the Azure AD tenant.</span><span class="sxs-lookup"><span data-stu-id="7a410-156">Make sure that the admin account you are trying to sign in with has global permissions to the Azure AD tenant.</span></span> 

## <a name="kerberos-errors"></a><span data-ttu-id="7a410-157">Kerberos errors</span><span class="sxs-lookup"><span data-stu-id="7a410-157">Kerberos errors</span></span>

<span data-ttu-id="7a410-158">This list covers the more common error that come from Kerberos setup and configuration, and includes suggestions for resolution.</span><span class="sxs-lookup"><span data-stu-id="7a410-158">This list covers the more common error that come from Kerberos setup and configuration, and includes suggestions for resolution.</span></span>

- <span data-ttu-id="7a410-159">**Failed to retrieve the current execution policy for running PowerShell scripts.**</span><span class="sxs-lookup"><span data-stu-id="7a410-159">**Failed to retrieve the current execution policy for running PowerShell scripts.**</span></span> 

  <span data-ttu-id="7a410-160">If the Connector installation fails, check to make sure that PowerShell execution policy is not disabled.</span><span class="sxs-lookup"><span data-stu-id="7a410-160">If the Connector installation fails, check to make sure that PowerShell execution policy is not disabled.</span></span> 

  1. <span data-ttu-id="7a410-161">Open the Group Policy Editor.</span><span class="sxs-lookup"><span data-stu-id="7a410-161">Open the Group Policy Editor.</span></span> 
  2. <span data-ttu-id="7a410-162">Go to **Computer Configuration** > **Administrative Templates** > **Windows Components** > **Windows PowerShell** and double-click **Turn on Script Execution**.</span><span class="sxs-lookup"><span data-stu-id="7a410-162">Go to **Computer Configuration** > **Administrative Templates** > **Windows Components** > **Windows PowerShell** and double-click **Turn on Script Execution**.</span></span> 
  3. <span data-ttu-id="7a410-163">The execution policy can be set to either **Not Configured** or **Enabled**.</span><span class="sxs-lookup"><span data-stu-id="7a410-163">The execution policy can be set to either **Not Configured** or **Enabled**.</span></span> <span data-ttu-id="7a410-164">If set to **Enabled**, make sure that under Options, the Execution Policy is set to either **Allow local scripts and remote signed scripts** or to **Allow all scripts**.</span><span class="sxs-lookup"><span data-stu-id="7a410-164">If set to **Enabled**, make sure that under Options, the Execution Policy is set to either **Allow local scripts and remote signed scripts** or to **Allow all scripts**.</span></span> 

- <span data-ttu-id="7a410-165">**12008 - Azure AD exceeded the maximum number of permitted Kerberos authentication attempts to the backend server.**</span><span class="sxs-lookup"><span data-stu-id="7a410-165">**12008 - Azure AD exceeded the maximum number of permitted Kerberos authentication attempts to the backend server.**</span></span> 

  <span data-ttu-id="7a410-166">This error may indicate incorrect configuration between Azure AD and the backend application server, or a problem in time and date configuration on both machines.</span><span class="sxs-lookup"><span data-stu-id="7a410-166">This error may indicate incorrect configuration between Azure AD and the backend application server, or a problem in time and date configuration on both machines.</span></span> <span data-ttu-id="7a410-167">The backend server declined the Kerberos ticket created by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="7a410-167">The backend server declined the Kerberos ticket created by Azure AD.</span></span> <span data-ttu-id="7a410-168">Verify that Azure AD and the backend application server are configured correctly.</span><span class="sxs-lookup"><span data-stu-id="7a410-168">Verify that Azure AD and the backend application server are configured correctly.</span></span> <span data-ttu-id="7a410-169">Make sure that the time and date configuration on the Azure AD and the backend application server are synchronized.</span><span class="sxs-lookup"><span data-stu-id="7a410-169">Make sure that the time and date configuration on the Azure AD and the backend application server are synchronized.</span></span> 

- <span data-ttu-id="7a410-170">**13016 - Azure AD cannot retrieve a Kerberos ticket on behalf of the user because there is no UPN in the edge token or in the access cookie.**</span><span class="sxs-lookup"><span data-stu-id="7a410-170">**13016 - Azure AD cannot retrieve a Kerberos ticket on behalf of the user because there is no UPN in the edge token or in the access cookie.**</span></span> 

  <span data-ttu-id="7a410-171">There is a problem with the STS configuration.</span><span class="sxs-lookup"><span data-stu-id="7a410-171">There is a problem with the STS configuration.</span></span> <span data-ttu-id="7a410-172">Fix the UPN claim configuration in the STS.</span><span class="sxs-lookup"><span data-stu-id="7a410-172">Fix the UPN claim configuration in the STS.</span></span> 

- <span data-ttu-id="7a410-173">**13019 - Azure AD cannot retrieve a Kerberos ticket on behalf of the user because of the following general API error.**</span><span class="sxs-lookup"><span data-stu-id="7a410-173">**13019 - Azure AD cannot retrieve a Kerberos ticket on behalf of the user because of the following general API error.**</span></span> 

  <span data-ttu-id="7a410-174">This event may indicate incorrect configuration between Azure AD and the domain controller server, or a problem in time and date configuration on both machines.</span><span class="sxs-lookup"><span data-stu-id="7a410-174">This event may indicate incorrect configuration between Azure AD and the domain controller server, or a problem in time and date configuration on both machines.</span></span> <span data-ttu-id="7a410-175">The domain controller declined the Kerberos ticket created by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="7a410-175">The domain controller declined the Kerberos ticket created by Azure AD.</span></span> <span data-ttu-id="7a410-176">Verify that Azure AD and the backend application server are configured correctly, especially the SPN configuration.</span><span class="sxs-lookup"><span data-stu-id="7a410-176">Verify that Azure AD and the backend application server are configured correctly, especially the SPN configuration.</span></span> <span data-ttu-id="7a410-177">Make sure the Azure AD is domain joined to the same domain as the domain controller to ensure that the domain controller establishes trust with Azure AD.</span><span class="sxs-lookup"><span data-stu-id="7a410-177">Make sure the Azure AD is domain joined to the same domain as the domain controller to ensure that the domain controller establishes trust with Azure AD.</span></span> <span data-ttu-id="7a410-178">Make sure that the time and date configuration on the Azure AD and the domain controller are synchronized.</span><span class="sxs-lookup"><span data-stu-id="7a410-178">Make sure that the time and date configuration on the Azure AD and the domain controller are synchronized.</span></span> 

- <span data-ttu-id="7a410-179">**13020 - Azure AD cannot retrieve a Kerberos ticket on behalf of the user because the backend server SPN is not defined.**</span><span class="sxs-lookup"><span data-stu-id="7a410-179">**13020 - Azure AD cannot retrieve a Kerberos ticket on behalf of the user because the backend server SPN is not defined.**</span></span> 

  <span data-ttu-id="7a410-180">This event may indicate incorrect configuration between Azure AD and the domain controller server, or a problem in time and date configuration on both machines.</span><span class="sxs-lookup"><span data-stu-id="7a410-180">This event may indicate incorrect configuration between Azure AD and the domain controller server, or a problem in time and date configuration on both machines.</span></span> <span data-ttu-id="7a410-181">The domain controller declined the Kerberos ticket created by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="7a410-181">The domain controller declined the Kerberos ticket created by Azure AD.</span></span> <span data-ttu-id="7a410-182">Verify that Azure AD and the backend application server are configured correctly, especially the SPN configuration.</span><span class="sxs-lookup"><span data-stu-id="7a410-182">Verify that Azure AD and the backend application server are configured correctly, especially the SPN configuration.</span></span> <span data-ttu-id="7a410-183">Make sure the Azure AD is domain joined to the same domain as the domain controller to ensure that the domain controller establishes trust with Azure AD.</span><span class="sxs-lookup"><span data-stu-id="7a410-183">Make sure the Azure AD is domain joined to the same domain as the domain controller to ensure that the domain controller establishes trust with Azure AD.</span></span> <span data-ttu-id="7a410-184">Make sure that the time and date configuration on the Azure AD and the domain controller are synchronized.</span><span class="sxs-lookup"><span data-stu-id="7a410-184">Make sure that the time and date configuration on the Azure AD and the domain controller are synchronized.</span></span> 

- <span data-ttu-id="7a410-185">**13022 - Azure AD cannot authenticate the user because the backend server responds to Kerberos authentication attempts with an HTTP 401 error.**</span><span class="sxs-lookup"><span data-stu-id="7a410-185">**13022 - Azure AD cannot authenticate the user because the backend server responds to Kerberos authentication attempts with an HTTP 401 error.**</span></span> 

  <span data-ttu-id="7a410-186">This event may indicate incorrect configuration between Azure AD and the backend application server, or a problem in time and date configuration on both machines.</span><span class="sxs-lookup"><span data-stu-id="7a410-186">This event may indicate incorrect configuration between Azure AD and the backend application server, or a problem in time and date configuration on both machines.</span></span> <span data-ttu-id="7a410-187">The backend server declined the Kerberos ticket created by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="7a410-187">The backend server declined the Kerberos ticket created by Azure AD.</span></span> <span data-ttu-id="7a410-188">Verify that Azure AD and the backend application server are configured correctly.</span><span class="sxs-lookup"><span data-stu-id="7a410-188">Verify that Azure AD and the backend application server are configured correctly.</span></span> <span data-ttu-id="7a410-189">Make sure that the time and date configuration on the Azure AD and the backend application server are synchronized.</span><span class="sxs-lookup"><span data-stu-id="7a410-189">Make sure that the time and date configuration on the Azure AD and the backend application server are synchronized.</span></span> 

## <a name="end-user-errors"></a><span data-ttu-id="7a410-190">End user errors</span><span class="sxs-lookup"><span data-stu-id="7a410-190">End user errors</span></span>

<span data-ttu-id="7a410-191">This list covers errors that your end users might encounter when they try to access the app and fail.</span><span class="sxs-lookup"><span data-stu-id="7a410-191">This list covers errors that your end users might encounter when they try to access the app and fail.</span></span> 

- <span data-ttu-id="7a410-192">**The website cannot display the page.**</span><span class="sxs-lookup"><span data-stu-id="7a410-192">**The website cannot display the page.**</span></span> 

  <span data-ttu-id="7a410-193">Your user may get this error when trying to access the app you published if the application is an IWA application.</span><span class="sxs-lookup"><span data-stu-id="7a410-193">Your user may get this error when trying to access the app you published if the application is an IWA application.</span></span> <span data-ttu-id="7a410-194">The defined SPN for this application may be incorrect.</span><span class="sxs-lookup"><span data-stu-id="7a410-194">The defined SPN for this application may be incorrect.</span></span> <span data-ttu-id="7a410-195">For IWA apps, make sure that the SPN configured for this application is correct.</span><span class="sxs-lookup"><span data-stu-id="7a410-195">For IWA apps, make sure that the SPN configured for this application is correct.</span></span> 

- <span data-ttu-id="7a410-196">**The website cannot display the page.**</span><span class="sxs-lookup"><span data-stu-id="7a410-196">**The website cannot display the page.**</span></span> 

  <span data-ttu-id="7a410-197">Your user may get this error when trying to access the app you published if the application is an OWA application.</span><span class="sxs-lookup"><span data-stu-id="7a410-197">Your user may get this error when trying to access the app you published if the application is an OWA application.</span></span> <span data-ttu-id="7a410-198">This could be caused by one of the following:</span><span class="sxs-lookup"><span data-stu-id="7a410-198">This could be caused by one of the following:</span></span> 
  - <span data-ttu-id="7a410-199">The defined SPN for this application is incorrect.</span><span class="sxs-lookup"><span data-stu-id="7a410-199">The defined SPN for this application is incorrect.</span></span> <span data-ttu-id="7a410-200">Make sure that the SPN configured for this application is correct.</span><span class="sxs-lookup"><span data-stu-id="7a410-200">Make sure that the SPN configured for this application is correct.</span></span>
  - <span data-ttu-id="7a410-201">The user who tried to access the application is using a Microsoft account rather than the proper corporate account to sign in, or the user is a guest user.</span><span class="sxs-lookup"><span data-stu-id="7a410-201">The user who tried to access the application is using a Microsoft account rather than the proper corporate account to sign in, or the user is a guest user.</span></span> <span data-ttu-id="7a410-202">Make sure the user signs in using their corporate account that matches the domain of the published application.</span><span class="sxs-lookup"><span data-stu-id="7a410-202">Make sure the user signs in using their corporate account that matches the domain of the published application.</span></span> <span data-ttu-id="7a410-203">Microsoft Account users and guest cannot access IWA applications.</span><span class="sxs-lookup"><span data-stu-id="7a410-203">Microsoft Account users and guest cannot access IWA applications.</span></span>
  - <span data-ttu-id="7a410-204">The user who tried to access the application is not properly defined for this application on the on-prem side.</span><span class="sxs-lookup"><span data-stu-id="7a410-204">The user who tried to access the application is not properly defined for this application on the on-prem side.</span></span> <span data-ttu-id="7a410-205">Make sure that this user has the proper permissions as defined for this backend application on the on-prem machine.</span><span class="sxs-lookup"><span data-stu-id="7a410-205">Make sure that this user has the proper permissions as defined for this backend application on the on-prem machine.</span></span>

- <span data-ttu-id="7a410-206">**This corporate app can’t be accessed. You are not authorized to access this application. Authorization failed. Make sure to assign the user with access to this application.**</span><span class="sxs-lookup"><span data-stu-id="7a410-206">**This corporate app can’t be accessed. You are not authorized to access this application. Authorization failed. Make sure to assign the user with access to this application.**</span></span> 

  <span data-ttu-id="7a410-207">Your users may get this error when trying to access the app you published if they use Microsoft accounts instead of their corporate account to sign in.</span><span class="sxs-lookup"><span data-stu-id="7a410-207">Your users may get this error when trying to access the app you published if they use Microsoft accounts instead of their corporate account to sign in.</span></span> <span data-ttu-id="7a410-208">Guest users may also get this error.</span><span class="sxs-lookup"><span data-stu-id="7a410-208">Guest users may also get this error.</span></span> <span data-ttu-id="7a410-209">Microsoft Account users and guests cannot access IWA applications.</span><span class="sxs-lookup"><span data-stu-id="7a410-209">Microsoft Account users and guests cannot access IWA applications.</span></span> <span data-ttu-id="7a410-210">Make sure the user signs in using their corporate account that matches the domain of the published application.</span><span class="sxs-lookup"><span data-stu-id="7a410-210">Make sure the user signs in using their corporate account that matches the domain of the published application.</span></span> 

  <span data-ttu-id="7a410-211">You may not have assigned the user for this application.</span><span class="sxs-lookup"><span data-stu-id="7a410-211">You may not have assigned the user for this application.</span></span> <span data-ttu-id="7a410-212">Go to the **Application** tab, and under **Users and Groups**, assign this user or user group to this application.</span><span class="sxs-lookup"><span data-stu-id="7a410-212">Go to the **Application** tab, and under **Users and Groups**, assign this user or user group to this application.</span></span>

- <span data-ttu-id="7a410-213">**This corporate app can’t be accessed right now. Please try again later…The connector timed out.**</span><span class="sxs-lookup"><span data-stu-id="7a410-213">**This corporate app can’t be accessed right now. Please try again later…The connector timed out.**</span></span> 

  <span data-ttu-id="7a410-214">Your users may get this error when trying to access the app you published if they are not properly defined for this application on the on-prem side.</span><span class="sxs-lookup"><span data-stu-id="7a410-214">Your users may get this error when trying to access the app you published if they are not properly defined for this application on the on-prem side.</span></span> <span data-ttu-id="7a410-215">Make sure that your users have the proper permissions as defined for this backend application on the on-prem machine.</span><span class="sxs-lookup"><span data-stu-id="7a410-215">Make sure that your users have the proper permissions as defined for this backend application on the on-prem machine.</span></span> 

- <span data-ttu-id="7a410-216">**This corporate app can’t be accessed. You are not authorized to access this application. Authorization failed. Make sure that the user has a license for Azure Active Directory Premium or Basic.**</span><span class="sxs-lookup"><span data-stu-id="7a410-216">**This corporate app can’t be accessed. You are not authorized to access this application. Authorization failed. Make sure that the user has a license for Azure Active Directory Premium or Basic.**</span></span>

  <span data-ttu-id="7a410-217">Your users may get this error when trying to access the app you published if they weren't explicitly assigned with a Premium/Basic license by the subscriber’s administrator.</span><span class="sxs-lookup"><span data-stu-id="7a410-217">Your users may get this error when trying to access the app you published if they weren't explicitly assigned with a Premium/Basic license by the subscriber’s administrator.</span></span> <span data-ttu-id="7a410-218">Go to the subscriber’s Active Directory **Licenses** tab and make sure that this user or user group is assigned a Premium or Basic license.</span><span class="sxs-lookup"><span data-stu-id="7a410-218">Go to the subscriber’s Active Directory **Licenses** tab and make sure that this user or user group is assigned a Premium or Basic license.</span></span>

## <a name="my-error-wasnt-listed-here"></a><span data-ttu-id="7a410-219">My error wasn't listed here</span><span class="sxs-lookup"><span data-stu-id="7a410-219">My error wasn't listed here</span></span>

<span data-ttu-id="7a410-220">If you encounter an error or problem with Azure AD Application Proxy that isn't listed in this troubleshooting guide, we'd like to hear about it.</span><span class="sxs-lookup"><span data-stu-id="7a410-220">If you encounter an error or problem with Azure AD Application Proxy that isn't listed in this troubleshooting guide, we'd like to hear about it.</span></span> <span data-ttu-id="7a410-221">Send an email to our [feedback team](mailto:aadapfeedback@microsoft.com) with the details of the error you encountered.</span><span class="sxs-lookup"><span data-stu-id="7a410-221">Send an email to our [feedback team](mailto:aadapfeedback@microsoft.com) with the details of the error you encountered.</span></span>

## <a name="see-also"></a><span data-ttu-id="7a410-222">See also</span><span class="sxs-lookup"><span data-stu-id="7a410-222">See also</span></span>
* [<span data-ttu-id="7a410-223">Enable Application Proxy for Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="7a410-223">Enable Application Proxy for Azure Active Directory</span></span>](active-directory-application-proxy-enable.md)
* [<span data-ttu-id="7a410-224">Publish applications with Application Proxy</span><span class="sxs-lookup"><span data-stu-id="7a410-224">Publish applications with Application Proxy</span></span>](active-directory-application-proxy-publish.md)
* [<span data-ttu-id="7a410-225">Enable single sign-on</span><span class="sxs-lookup"><span data-stu-id="7a410-225">Enable single sign-on</span></span>](active-directory-application-proxy-sso-using-kcd.md)
* [<span data-ttu-id="7a410-226">Enable conditional access</span><span class="sxs-lookup"><span data-stu-id="7a410-226">Enable conditional access</span></span>](active-directory-application-proxy-conditional-access.md)


<!--Image references-->
[1]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/active-directory/media/active-directory-application-proxy-troubleshoot/connectorproperties.png
[2]: ./media/active-directory-application-proxy-troubleshoot/sessionlog.png


