---
title: Resolve license problems for a group in Azure Active Directory | Microsoft Docs
description: How to identify and resolve license assignment problems when you're using Azure Active Directory group-based licensing
services: active-directory
keywords: Azure AD licensing
documentationcenter: ''
author: curtand
manager: femila
editor: ''
ms.assetid: ''
ms.service: active-directory
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 02/28/2017
ms.author: curtand
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 68155ebaa6af36500bfe856c9bcd49f5efb6cbc2
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44564465"
---
# <a name="identify-and-resolve-license-assignment-problems-for-a-group-in-azure-active-directory"></a><span data-ttu-id="b374c-104">Identify and resolve license assignment problems for a group in Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="b374c-104">Identify and resolve license assignment problems for a group in Azure Active Directory</span></span>

<span data-ttu-id="b374c-105">Group-based licensing in Azure Active Directory (Azure AD) introduces the concept of users in a licensing error state.</span><span class="sxs-lookup"><span data-stu-id="b374c-105">Group-based licensing in Azure Active Directory (Azure AD) introduces the concept of users in a licensing error state.</span></span> <span data-ttu-id="b374c-106">In this article, we explain the reasons why users might end up in this state.</span><span class="sxs-lookup"><span data-stu-id="b374c-106">In this article, we explain the reasons why users might end up in this state.</span></span>

<span data-ttu-id="b374c-107">When you assign licenses directly to individual users, without using group-based licensing, the assignment operation might fail.</span><span class="sxs-lookup"><span data-stu-id="b374c-107">When you assign licenses directly to individual users, without using group-based licensing, the assignment operation might fail.</span></span> <span data-ttu-id="b374c-108">For example, when you execute the PowerShell cmdlet `Set-MsolUserLicense` on a user, the cmdlet can fail for a number of reasons that are related to business logic.</span><span class="sxs-lookup"><span data-stu-id="b374c-108">For example, when you execute the PowerShell cmdlet `Set-MsolUserLicense` on a user, the cmdlet can fail for a number of reasons that are related to business logic.</span></span> <span data-ttu-id="b374c-109">For example, there might be an insufficient number of licenses or a conflict between two service plans that can't be assigned at the same time.</span><span class="sxs-lookup"><span data-stu-id="b374c-109">For example, there might be an insufficient number of licenses or a conflict between two service plans that can't be assigned at the same time.</span></span> <span data-ttu-id="b374c-110">The problem is immediately reported back to you.</span><span class="sxs-lookup"><span data-stu-id="b374c-110">The problem is immediately reported back to you.</span></span>

<span data-ttu-id="b374c-111">When you're using group-based licensing, the same errors can occur, but they happen in the background when the Azure AD service is assigning licenses.</span><span class="sxs-lookup"><span data-stu-id="b374c-111">When you're using group-based licensing, the same errors can occur, but they happen in the background when the Azure AD service is assigning licenses.</span></span> <span data-ttu-id="b374c-112">For this reason, the errors can't be communicated to you immediately.</span><span class="sxs-lookup"><span data-stu-id="b374c-112">For this reason, the errors can't be communicated to you immediately.</span></span> <span data-ttu-id="b374c-113">Instead, they're recorded on the user object and then reported via the administrative portal.</span><span class="sxs-lookup"><span data-stu-id="b374c-113">Instead, they're recorded on the user object and then reported via the administrative portal.</span></span> <span data-ttu-id="b374c-114">Note that the original intent to license the user is never lost, but it's recorded in an error state for future investigation and resolution.</span><span class="sxs-lookup"><span data-stu-id="b374c-114">Note that the original intent to license the user is never lost, but it's recorded in an error state for future investigation and resolution.</span></span>

<span data-ttu-id="b374c-115">To find users that are in an error state for each group, open the blade for each group.</span><span class="sxs-lookup"><span data-stu-id="b374c-115">To find users that are in an error state for each group, open the blade for each group.</span></span> <span data-ttu-id="b374c-116">Under **Licenses**, there will be a notification displayed if there are any users in an error state.</span><span class="sxs-lookup"><span data-stu-id="b374c-116">Under **Licenses**, there will be a notification displayed if there are any users in an error state.</span></span> <span data-ttu-id="b374c-117">Select the notification to open a list of all affected users.</span><span class="sxs-lookup"><span data-stu-id="b374c-117">Select the notification to open a list of all affected users.</span></span> <span data-ttu-id="b374c-118">You can view the users individually to understand the underlying problem.</span><span class="sxs-lookup"><span data-stu-id="b374c-118">You can view the users individually to understand the underlying problem.</span></span> <span data-ttu-id="b374c-119">In this article, we'll describe each potential problem and the way to resolve it.</span><span class="sxs-lookup"><span data-stu-id="b374c-119">In this article, we'll describe each potential problem and the way to resolve it.</span></span>

## <a name="not-enough-licenses"></a><span data-ttu-id="b374c-120">Not enough licenses</span><span class="sxs-lookup"><span data-stu-id="b374c-120">Not enough licenses</span></span>

<span data-ttu-id="b374c-121">**Problem:** There aren't enough available licenses for one of the products that's specified in the group.</span><span class="sxs-lookup"><span data-stu-id="b374c-121">**Problem:** There aren't enough available licenses for one of the products that's specified in the group.</span></span> <span data-ttu-id="b374c-122">You need to either purchase more licenses for the product, or free up unused licenses from other users or groups.</span><span class="sxs-lookup"><span data-stu-id="b374c-122">You need to either purchase more licenses for the product, or free up unused licenses from other users or groups.</span></span>

<span data-ttu-id="b374c-123">To see how many licenses are available, go to **Azure Active Directory** > **Licenses** > **All products**.</span><span class="sxs-lookup"><span data-stu-id="b374c-123">To see how many licenses are available, go to **Azure Active Directory** > **Licenses** > **All products**.</span></span>

<span data-ttu-id="b374c-124">To see which users and groups are consuming licenses, click a product.</span><span class="sxs-lookup"><span data-stu-id="b374c-124">To see which users and groups are consuming licenses, click a product.</span></span> <span data-ttu-id="b374c-125">Under **Licensed users**, you'll see all users who've had licenses assigned directly or via one or more groups.</span><span class="sxs-lookup"><span data-stu-id="b374c-125">Under **Licensed users**, you'll see all users who've had licenses assigned directly or via one or more groups.</span></span> <span data-ttu-id="b374c-126">Under **Licensed groups**, you'll see all groups that have that product assigned.</span><span class="sxs-lookup"><span data-stu-id="b374c-126">Under **Licensed groups**, you'll see all groups that have that product assigned.</span></span>

<span data-ttu-id="b374c-127">**PowerShell:** PowerShell cmdlets report this error as _CountViolation_.</span><span class="sxs-lookup"><span data-stu-id="b374c-127">**PowerShell:** PowerShell cmdlets report this error as _CountViolation_.</span></span>

## <a name="conflicting-service-plans"></a><span data-ttu-id="b374c-128">Conflicting service plans</span><span class="sxs-lookup"><span data-stu-id="b374c-128">Conflicting service plans</span></span>

<span data-ttu-id="b374c-129">**Problem:** One of the products that's specified in the group contains a service plan that conflicts with another service plan that's already assigned to the user via a different product.</span><span class="sxs-lookup"><span data-stu-id="b374c-129">**Problem:** One of the products that's specified in the group contains a service plan that conflicts with another service plan that's already assigned to the user via a different product.</span></span> <span data-ttu-id="b374c-130">Some service plans are configured in a way that they can't be assigned to the same user as another related service plan.</span><span class="sxs-lookup"><span data-stu-id="b374c-130">Some service plans are configured in a way that they can't be assigned to the same user as another related service plan.</span></span>

<span data-ttu-id="b374c-131">Consider the following example.</span><span class="sxs-lookup"><span data-stu-id="b374c-131">Consider the following example.</span></span> <span data-ttu-id="b374c-132">A user has a license for Office 365 Enterprise **E1** assigned directly, with all the plans enabled.</span><span class="sxs-lookup"><span data-stu-id="b374c-132">A user has a license for Office 365 Enterprise **E1** assigned directly, with all the plans enabled.</span></span> <span data-ttu-id="b374c-133">The user has been added to a group that has the Office 365 Enterprise **E3** product assigned to it.</span><span class="sxs-lookup"><span data-stu-id="b374c-133">The user has been added to a group that has the Office 365 Enterprise **E3** product assigned to it.</span></span> <span data-ttu-id="b374c-134">This product contains service plans that can't overlap with the plans included in E1, so the group license assignment will fail with the “Conflicting service plans” error.</span><span class="sxs-lookup"><span data-stu-id="b374c-134">This product contains service plans that can't overlap with the plans included in E1, so the group license assignment will fail with the “Conflicting service plans” error.</span></span> <span data-ttu-id="b374c-135">In this example, the conflicting service plans are:</span><span class="sxs-lookup"><span data-stu-id="b374c-135">In this example, the conflicting service plans are:</span></span>

-   <span data-ttu-id="b374c-136">SharePoint Online (Plan 2) conflicts with SharePoint Online (Plan 1).</span><span class="sxs-lookup"><span data-stu-id="b374c-136">SharePoint Online (Plan 2) conflicts with SharePoint Online (Plan 1).</span></span>
-   <span data-ttu-id="b374c-137">Exchange Online (Plan 2) conflicts with Exchange Online (Plan 1).</span><span class="sxs-lookup"><span data-stu-id="b374c-137">Exchange Online (Plan 2) conflicts with Exchange Online (Plan 1).</span></span>

<span data-ttu-id="b374c-138">To solve this conflict, you need to disable those two plans either on the E1 license that's directly assigned to the user.</span><span class="sxs-lookup"><span data-stu-id="b374c-138">To solve this conflict, you need to disable those two plans either on the E1 license that's directly assigned to the user.</span></span> <span data-ttu-id="b374c-139">Or, you need to modify the entire group license assignment and disable the plans in the E3 license.</span><span class="sxs-lookup"><span data-stu-id="b374c-139">Or, you need to modify the entire group license assignment and disable the plans in the E3 license.</span></span> <span data-ttu-id="b374c-140">Alternatively, you might decide to remove the E1 license from the user if it's redundant in the context of the E3 license.</span><span class="sxs-lookup"><span data-stu-id="b374c-140">Alternatively, you might decide to remove the E1 license from the user if it's redundant in the context of the E3 license.</span></span>

<span data-ttu-id="b374c-141">The decision about how to resolve conflicting product licenses always belongs to the administrator.</span><span class="sxs-lookup"><span data-stu-id="b374c-141">The decision about how to resolve conflicting product licenses always belongs to the administrator.</span></span> <span data-ttu-id="b374c-142">Azure AD doesn't automatically resolve license conflicts.</span><span class="sxs-lookup"><span data-stu-id="b374c-142">Azure AD doesn't automatically resolve license conflicts.</span></span>

<span data-ttu-id="b374c-143">**PowerShell:** PowerShell cmdlets report this error as _MutuallyExclusiveViolation_.</span><span class="sxs-lookup"><span data-stu-id="b374c-143">**PowerShell:** PowerShell cmdlets report this error as _MutuallyExclusiveViolation_.</span></span>

## <a name="other-products-depend-on-this-license"></a><span data-ttu-id="b374c-144">Other products depend on this license</span><span class="sxs-lookup"><span data-stu-id="b374c-144">Other products depend on this license</span></span>

<span data-ttu-id="b374c-145">**Problem:** One of the products that's specified in the group contains a service plan that must be enabled for another service plan, in another product, to function.</span><span class="sxs-lookup"><span data-stu-id="b374c-145">**Problem:** One of the products that's specified in the group contains a service plan that must be enabled for another service plan, in another product, to function.</span></span> <span data-ttu-id="b374c-146">This error occurs when Azure AD attempts to remove the underlying service plan.</span><span class="sxs-lookup"><span data-stu-id="b374c-146">This error occurs when Azure AD attempts to remove the underlying service plan.</span></span> <span data-ttu-id="b374c-147">For example, this can happen as a result of the user being removed from the group.</span><span class="sxs-lookup"><span data-stu-id="b374c-147">For example, this can happen as a result of the user being removed from the group.</span></span>

<span data-ttu-id="b374c-148">To solve this problem, you'll need to make sure that the required plan is still assigned to users through some other method, or that the dependent services are disabled for those users.</span><span class="sxs-lookup"><span data-stu-id="b374c-148">To solve this problem, you'll need to make sure that the required plan is still assigned to users through some other method, or that the dependent services are disabled for those users.</span></span> <span data-ttu-id="b374c-149">After doing that, you can properly remove the group license from those users.</span><span class="sxs-lookup"><span data-stu-id="b374c-149">After doing that, you can properly remove the group license from those users.</span></span>

<span data-ttu-id="b374c-150">**PowerShell:** PowerShell cmdlets report this error as _DependencyViolation_.</span><span class="sxs-lookup"><span data-stu-id="b374c-150">**PowerShell:** PowerShell cmdlets report this error as _DependencyViolation_.</span></span>

## <a name="usage-location-isnt-allowed"></a><span data-ttu-id="b374c-151">Usage location isn't allowed</span><span class="sxs-lookup"><span data-stu-id="b374c-151">Usage location isn't allowed</span></span>

<span data-ttu-id="b374c-152">**Problem:** Some Microsoft services aren't available in all locations because of local laws and regulations.</span><span class="sxs-lookup"><span data-stu-id="b374c-152">**Problem:** Some Microsoft services aren't available in all locations because of local laws and regulations.</span></span> <span data-ttu-id="b374c-153">Before you can assign a license to a user, you have to specify the “Usage location” property for the user.</span><span class="sxs-lookup"><span data-stu-id="b374c-153">Before you can assign a license to a user, you have to specify the “Usage location” property for the user.</span></span> <span data-ttu-id="b374c-154">You can do this under the **User** > **Profile** > **Settings** section in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="b374c-154">You can do this under the **User** > **Profile** > **Settings** section in the Azure portal.</span></span>

<span data-ttu-id="b374c-155">When Azure AD attempts to assign a group license to a user whose usage location isn't supported, it will fail and record this error on the user.</span><span class="sxs-lookup"><span data-stu-id="b374c-155">When Azure AD attempts to assign a group license to a user whose usage location isn't supported, it will fail and record this error on the user.</span></span>

<span data-ttu-id="b374c-156">To solve this problem, remove users from nonsupported locations from the licensed group.</span><span class="sxs-lookup"><span data-stu-id="b374c-156">To solve this problem, remove users from nonsupported locations from the licensed group.</span></span> <span data-ttu-id="b374c-157">Alternatively, if the current usage location values don't represent the actual user location, you can modify them so that the licenses are correctly assigned next time (if the new location is supported).</span><span class="sxs-lookup"><span data-stu-id="b374c-157">Alternatively, if the current usage location values don't represent the actual user location, you can modify them so that the licenses are correctly assigned next time (if the new location is supported).</span></span>

<span data-ttu-id="b374c-158">**PowerShell:** PowerShell cmdlets report this error as _ProhibitedInUsageLocationViolation_.</span><span class="sxs-lookup"><span data-stu-id="b374c-158">**PowerShell:** PowerShell cmdlets report this error as _ProhibitedInUsageLocationViolation_.</span></span>

> [!NOTE]
> <span data-ttu-id="b374c-159">When Azure AD assigns group licenses, any users without a usage location specified inherit the location of the directory.</span><span class="sxs-lookup"><span data-stu-id="b374c-159">When Azure AD assigns group licenses, any users without a usage location specified inherit the location of the directory.</span></span> <span data-ttu-id="b374c-160">We recommend that administrators set the correct usage location values on users before using group-based licensing to comply with local laws and regulations.</span><span class="sxs-lookup"><span data-stu-id="b374c-160">We recommend that administrators set the correct usage location values on users before using group-based licensing to comply with local laws and regulations.</span></span>

## <a name="what-happens-when-theres-more-than-one-product-license-on-a-group"></a><span data-ttu-id="b374c-161">What happens when there's more than one product license on a group?</span><span class="sxs-lookup"><span data-stu-id="b374c-161">What happens when there's more than one product license on a group?</span></span>

<span data-ttu-id="b374c-162">You can assign more than one product license to a group.</span><span class="sxs-lookup"><span data-stu-id="b374c-162">You can assign more than one product license to a group.</span></span> <span data-ttu-id="b374c-163">For example, you can assign Office 365 Enterprise E3 and Enterprise Mobility + Security to a group to easily enable all included services for users.</span><span class="sxs-lookup"><span data-stu-id="b374c-163">For example, you can assign Office 365 Enterprise E3 and Enterprise Mobility + Security to a group to easily enable all included services for users.</span></span>

<span data-ttu-id="b374c-164">Azure AD attempts to assign all licenses that are specified in the group to each user.</span><span class="sxs-lookup"><span data-stu-id="b374c-164">Azure AD attempts to assign all licenses that are specified in the group to each user.</span></span> <span data-ttu-id="b374c-165">If Azure AD can't assign one of the products because of business logic problems (for example, if there aren't enough licenses for all, or if there are conflicts with other services that are enabled on the user), it won't assign the other licenses in the group either.</span><span class="sxs-lookup"><span data-stu-id="b374c-165">If Azure AD can't assign one of the products because of business logic problems (for example, if there aren't enough licenses for all, or if there are conflicts with other services that are enabled on the user), it won't assign the other licenses in the group either.</span></span>

<span data-ttu-id="b374c-166">You'll be able to see the users who failed to get assigned failed and check which products have been affected by this.</span><span class="sxs-lookup"><span data-stu-id="b374c-166">You'll be able to see the users who failed to get assigned failed and check which products have been affected by this.</span></span>

## <a name="how-do-you-force-license-processing-in-a-group-to-resolve-errors"></a><span data-ttu-id="b374c-167">How do you force license processing in a group to resolve errors?</span><span class="sxs-lookup"><span data-stu-id="b374c-167">How do you force license processing in a group to resolve errors?</span></span>

<span data-ttu-id="b374c-168">Depending on what steps you've taken to resolve errors, it might be necessary to manually trigger processing of a group to update the user state.</span><span class="sxs-lookup"><span data-stu-id="b374c-168">Depending on what steps you've taken to resolve errors, it might be necessary to manually trigger processing of a group to update the user state.</span></span>

<span data-ttu-id="b374c-169">For example, if you freed up some licenses by removing direct license assignments from users, you'll need to trigger processing of groups that previously failed to fully license all user members.</span><span class="sxs-lookup"><span data-stu-id="b374c-169">For example, if you freed up some licenses by removing direct license assignments from users, you'll need to trigger processing of groups that previously failed to fully license all user members.</span></span> <span data-ttu-id="b374c-170">To do that, find the group blade, open **Licenses**, and select the **Reprocess** button in the toolbar.</span><span class="sxs-lookup"><span data-stu-id="b374c-170">To do that, find the group blade, open **Licenses**, and select the **Reprocess** button in the toolbar.</span></span>

## <a name="next-steps"></a><span data-ttu-id="b374c-171">Next steps</span><span class="sxs-lookup"><span data-stu-id="b374c-171">Next steps</span></span>

<span data-ttu-id="b374c-172">To learn more about other scenarios for license management through groups, see the following:</span><span class="sxs-lookup"><span data-stu-id="b374c-172">To learn more about other scenarios for license management through groups, see the following:</span></span>

* [<span data-ttu-id="b374c-173">Assigning licenses to a group in Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="b374c-173">Assigning licenses to a group in Azure Active Directory</span></span>](active-directory-licensing-group-assignment-azure-portal.md)
* [<span data-ttu-id="b374c-174">What is group-based licensing in Azure Active Directory?</span><span class="sxs-lookup"><span data-stu-id="b374c-174">What is group-based licensing in Azure Active Directory?</span></span>](active-directory-licensing-whatis-azure-portal.md)
* [<span data-ttu-id="b374c-175">How to migrate individual licensed users to group-based licensing in Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="b374c-175">How to migrate individual licensed users to group-based licensing in Azure Active Directory</span></span>](active-directory-licensing-group-migration-azure-portal.md)
* [<span data-ttu-id="b374c-176">Azure Active Directory group-based licensing additional scenarios</span><span class="sxs-lookup"><span data-stu-id="b374c-176">Azure Active Directory group-based licensing additional scenarios</span></span>](active-directory-licensing-group-advanced.md)
