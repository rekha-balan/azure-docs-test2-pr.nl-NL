---
title: 'Azure AD Connect sync: Make a configuration change in Azure AD Connect sync | Microsoft Docs'
description: Walks you through how to make a change to the configuration in Azure AD Connect sync.
services: active-directory
documentationcenter: ''
author: billmath
manager: mtillman
editor: ''
ms.assetid: 7b9df836-e8a5-4228-97da-2faec9238b31
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/30/2018
ms.component: hybrid
ms.author: billmath
ms.openlocfilehash: 4795e21c4279b6d313ba56296bafc49daf7bbb48
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44824075"
---
# <a name="azure-ad-connect-sync-make-a-change-to-the-default-configuration"></a><span data-ttu-id="30588-103">Azure AD Connect sync: Make a change to the default configuration</span><span class="sxs-lookup"><span data-stu-id="30588-103">Azure AD Connect sync: Make a change to the default configuration</span></span>
<span data-ttu-id="30588-104">The purpose of this article is to walk you through how to make changes to the default configuration in Azure Active Directory (Azure AD) Connect sync. It provides steps for some common scenarios.</span><span class="sxs-lookup"><span data-stu-id="30588-104">The purpose of this article is to walk you through how to make changes to the default configuration in Azure Active Directory (Azure AD) Connect sync. It provides steps for some common scenarios.</span></span> <span data-ttu-id="30588-105">With this knowledge, you should be able to make simple changes to your own configuration based on your own business rules.</span><span class="sxs-lookup"><span data-stu-id="30588-105">With this knowledge, you should be able to make simple changes to your own configuration based on your own business rules.</span></span>

> [!WARNING]
> <span data-ttu-id="30588-106">If you make changes to the default sync rules then these changes will be overwritten the next time Azure AD Connect is updated, resulting in unexpected and likely unwanted synchronization results.</span><span class="sxs-lookup"><span data-stu-id="30588-106">If you make changes to the default sync rules then these changes will be overwritten the next time Azure AD Connect is updated, resulting in unexpected and likely unwanted synchronization results.</span></span>
>
> <span data-ttu-id="30588-107">The out-of-box sync rules have a thumbprint.</span><span class="sxs-lookup"><span data-stu-id="30588-107">The out-of-box sync rules have a thumbprint.</span></span> <span data-ttu-id="30588-108">If you make a change to these rules, the thumbprint is no longer matching.</span><span class="sxs-lookup"><span data-stu-id="30588-108">If you make a change to these rules, the thumbprint is no longer matching.</span></span> <span data-ttu-id="30588-109">You might have problems in the future when you try to apply a new release of Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="30588-109">You might have problems in the future when you try to apply a new release of Azure AD Connect.</span></span> <span data-ttu-id="30588-110">Only make changes the way it is described in this article.</span><span class="sxs-lookup"><span data-stu-id="30588-110">Only make changes the way it is described in this article.</span></span>

## <a name="synchronization-rules-editor"></a><span data-ttu-id="30588-111">Synchronization Rules Editor</span><span class="sxs-lookup"><span data-stu-id="30588-111">Synchronization Rules Editor</span></span>
<span data-ttu-id="30588-112">The Synchronization Rules Editor is used to see and change the default configuration.</span><span class="sxs-lookup"><span data-stu-id="30588-112">The Synchronization Rules Editor is used to see and change the default configuration.</span></span> <span data-ttu-id="30588-113">You can find it on the **Start** menu under the **Azure AD Connect** group.</span><span class="sxs-lookup"><span data-stu-id="30588-113">You can find it on the **Start** menu under the **Azure AD Connect** group.</span></span>  
<span data-ttu-id="30588-114">![Start menu with Sync Rule Editor](./media/active-directory-aadconnectsync-change-the-configuration/startmenu2.png)</span><span class="sxs-lookup"><span data-stu-id="30588-114">![Start menu with Sync Rule Editor](./media/active-directory-aadconnectsync-change-the-configuration/startmenu2.png)</span></span>

<span data-ttu-id="30588-115">When you open the editor, you see the default out-of-box rules.</span><span class="sxs-lookup"><span data-stu-id="30588-115">When you open the editor, you see the default out-of-box rules.</span></span>

![Sync Rule Editor](./media/active-directory-aadconnectsync-change-the-configuration/sre2.png)

### <a name="navigating-in-the-editor"></a><span data-ttu-id="30588-117">Navigating in the editor</span><span class="sxs-lookup"><span data-stu-id="30588-117">Navigating in the editor</span></span>
<span data-ttu-id="30588-118">Using the drop-downs at the top of the editor, you can quickly find a specific rule.</span><span class="sxs-lookup"><span data-stu-id="30588-118">Using the drop-downs at the top of the editor, you can quickly find a specific rule.</span></span> <span data-ttu-id="30588-119">For example, if you want to see the rules where the attribute proxyAddresses is included, you can change the drop-downs to the following:</span><span class="sxs-lookup"><span data-stu-id="30588-119">For example, if you want to see the rules where the attribute proxyAddresses is included, you can change the drop-downs to the following:</span></span>  
![SRE filtering](./media/active-directory-aadconnectsync-change-the-configuration/filtering.png)  
<span data-ttu-id="30588-121">To reset filtering and load a fresh configuration, press F5 on the keyboard.</span><span class="sxs-lookup"><span data-stu-id="30588-121">To reset filtering and load a fresh configuration, press F5 on the keyboard.</span></span>

<span data-ttu-id="30588-122">On the upper right is the **Add new rule** button.</span><span class="sxs-lookup"><span data-stu-id="30588-122">On the upper right is the **Add new rule** button.</span></span> <span data-ttu-id="30588-123">You use this button to create your own custom rule.</span><span class="sxs-lookup"><span data-stu-id="30588-123">You use this button to create your own custom rule.</span></span>

<span data-ttu-id="30588-124">At the bottom are buttons for acting on a selected sync rule.</span><span class="sxs-lookup"><span data-stu-id="30588-124">At the bottom are buttons for acting on a selected sync rule.</span></span> <span data-ttu-id="30588-125">**Edit** and **Delete** do what you expect them to.</span><span class="sxs-lookup"><span data-stu-id="30588-125">**Edit** and **Delete** do what you expect them to.</span></span> <span data-ttu-id="30588-126">**Export** produces a PowerShell script for re-creating the sync rule.</span><span class="sxs-lookup"><span data-stu-id="30588-126">**Export** produces a PowerShell script for re-creating the sync rule.</span></span> <span data-ttu-id="30588-127">With this procedure, you can move a sync rule from one server to another.</span><span class="sxs-lookup"><span data-stu-id="30588-127">With this procedure, you can move a sync rule from one server to another.</span></span>

## <a name="create-your-first-custom-rule"></a><span data-ttu-id="30588-128">Create your first custom rule</span><span class="sxs-lookup"><span data-stu-id="30588-128">Create your first custom rule</span></span>
<span data-ttu-id="30588-129">The most common changes are to the attribute flows.</span><span class="sxs-lookup"><span data-stu-id="30588-129">The most common changes are to the attribute flows.</span></span> <span data-ttu-id="30588-130">The data in your source directory might not be the same as in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="30588-130">The data in your source directory might not be the same as in Azure AD.</span></span> <span data-ttu-id="30588-131">In the example in this section, make sure the given name of a user is always in *proper case*.</span><span class="sxs-lookup"><span data-stu-id="30588-131">In the example in this section, make sure the given name of a user is always in *proper case*.</span></span>

### <a name="disable-the-scheduler"></a><span data-ttu-id="30588-132">Disable the scheduler</span><span class="sxs-lookup"><span data-stu-id="30588-132">Disable the scheduler</span></span>
<span data-ttu-id="30588-133">The [scheduler](active-directory-aadconnectsync-feature-scheduler.md) runs every 30 minutes by default.</span><span class="sxs-lookup"><span data-stu-id="30588-133">The [scheduler](active-directory-aadconnectsync-feature-scheduler.md) runs every 30 minutes by default.</span></span> <span data-ttu-id="30588-134">Make sure it is not starting while you are making changes and troubleshooting your new rules.</span><span class="sxs-lookup"><span data-stu-id="30588-134">Make sure it is not starting while you are making changes and troubleshooting your new rules.</span></span> <span data-ttu-id="30588-135">To temporarily disable the scheduler, start PowerShell and run `Set-ADSyncScheduler -SyncCycleEnabled $false`.</span><span class="sxs-lookup"><span data-stu-id="30588-135">To temporarily disable the scheduler, start PowerShell and run `Set-ADSyncScheduler -SyncCycleEnabled $false`.</span></span>

![Disable the scheduler](./media/active-directory-aadconnectsync-change-the-configuration/schedulerdisable.png)  

### <a name="create-the-rule"></a><span data-ttu-id="30588-137">Create the rule</span><span class="sxs-lookup"><span data-stu-id="30588-137">Create the rule</span></span>
1. <span data-ttu-id="30588-138">Click **Add new rule**.</span><span class="sxs-lookup"><span data-stu-id="30588-138">Click **Add new rule**.</span></span>
2. <span data-ttu-id="30588-139">On the **Description** page, enter the following:</span><span class="sxs-lookup"><span data-stu-id="30588-139">On the **Description** page, enter the following:</span></span>  
   <span data-ttu-id="30588-140">![Inbound rule filtering](./media/active-directory-aadconnectsync-change-the-configuration/description2.png)</span><span class="sxs-lookup"><span data-stu-id="30588-140">![Inbound rule filtering](./media/active-directory-aadconnectsync-change-the-configuration/description2.png)</span></span>  
   * <span data-ttu-id="30588-141">**Name**: Give the rule a descriptive name.</span><span class="sxs-lookup"><span data-stu-id="30588-141">**Name**: Give the rule a descriptive name.</span></span>
   * <span data-ttu-id="30588-142">**Description**: Give some clarification so someone else can understand what the rule is for.</span><span class="sxs-lookup"><span data-stu-id="30588-142">**Description**: Give some clarification so someone else can understand what the rule is for.</span></span>
   * <span data-ttu-id="30588-143">**Connected System**: This is the system in which the object can be found.</span><span class="sxs-lookup"><span data-stu-id="30588-143">**Connected System**: This is the system in which the object can be found.</span></span> <span data-ttu-id="30588-144">In this case, select **Active Directory Connector**.</span><span class="sxs-lookup"><span data-stu-id="30588-144">In this case, select **Active Directory Connector**.</span></span>
   * <span data-ttu-id="30588-145">**Connected System/Metaverse Object Type**: Select **User** and **Person**, respectively.</span><span class="sxs-lookup"><span data-stu-id="30588-145">**Connected System/Metaverse Object Type**: Select **User** and **Person**, respectively.</span></span>
   * <span data-ttu-id="30588-146">**Link Type**: Change this value to **Join**.</span><span class="sxs-lookup"><span data-stu-id="30588-146">**Link Type**: Change this value to **Join**.</span></span>
   * <span data-ttu-id="30588-147">**Precedence**: Provide a value that is unique in the system.</span><span class="sxs-lookup"><span data-stu-id="30588-147">**Precedence**: Provide a value that is unique in the system.</span></span> <span data-ttu-id="30588-148">A lower numeric value indicates higher precedence.</span><span class="sxs-lookup"><span data-stu-id="30588-148">A lower numeric value indicates higher precedence.</span></span>
   * <span data-ttu-id="30588-149">**Tag**: Leave this empty.</span><span class="sxs-lookup"><span data-stu-id="30588-149">**Tag**: Leave this empty.</span></span> <span data-ttu-id="30588-150">Only out-of-box rules from Microsoft should have this box populated with a value.</span><span class="sxs-lookup"><span data-stu-id="30588-150">Only out-of-box rules from Microsoft should have this box populated with a value.</span></span>
3. <span data-ttu-id="30588-151">On the **Scoping filter** page, enter **givenName ISNOTNULL**.</span><span class="sxs-lookup"><span data-stu-id="30588-151">On the **Scoping filter** page, enter **givenName ISNOTNULL**.</span></span>  
   <span data-ttu-id="30588-152">![Inbound rule scoping filter](./media/active-directory-aadconnectsync-change-the-configuration/scopingfilter.png)</span><span class="sxs-lookup"><span data-stu-id="30588-152">![Inbound rule scoping filter](./media/active-directory-aadconnectsync-change-the-configuration/scopingfilter.png)</span></span>  
   <span data-ttu-id="30588-153">This section is used to define to which objects the rule should apply.</span><span class="sxs-lookup"><span data-stu-id="30588-153">This section is used to define to which objects the rule should apply.</span></span> <span data-ttu-id="30588-154">If it's left empty, the rule would apply to all user objects.</span><span class="sxs-lookup"><span data-stu-id="30588-154">If it's left empty, the rule would apply to all user objects.</span></span> <span data-ttu-id="30588-155">However, that would include conference rooms, service accounts, and other non-people user objects.</span><span class="sxs-lookup"><span data-stu-id="30588-155">However, that would include conference rooms, service accounts, and other non-people user objects.</span></span>
4. <span data-ttu-id="30588-156">On the **Join rules** page, leave the field empty.</span><span class="sxs-lookup"><span data-stu-id="30588-156">On the **Join rules** page, leave the field empty.</span></span>
5. <span data-ttu-id="30588-157">On the **Transformations** page, change **FlowType** to **Expression**.</span><span class="sxs-lookup"><span data-stu-id="30588-157">On the **Transformations** page, change **FlowType** to **Expression**.</span></span> <span data-ttu-id="30588-158">For **Target Attribute**, select **givenName**.</span><span class="sxs-lookup"><span data-stu-id="30588-158">For **Target Attribute**, select **givenName**.</span></span> <span data-ttu-id="30588-159">And for **Source**, enter **PCase([givenName])**.</span><span class="sxs-lookup"><span data-stu-id="30588-159">And for **Source**, enter **PCase([givenName])**.</span></span>
   <span data-ttu-id="30588-160">![Inbound rule transformations](./media/active-directory-aadconnectsync-change-the-configuration/transformations.png)</span><span class="sxs-lookup"><span data-stu-id="30588-160">![Inbound rule transformations](./media/active-directory-aadconnectsync-change-the-configuration/transformations.png)</span></span>  
   <span data-ttu-id="30588-161">The sync engine is case-sensitive for both the function name and the name of the attribute.</span><span class="sxs-lookup"><span data-stu-id="30588-161">The sync engine is case-sensitive for both the function name and the name of the attribute.</span></span> <span data-ttu-id="30588-162">If you type something wrong, you see a warning when you add the rule.</span><span class="sxs-lookup"><span data-stu-id="30588-162">If you type something wrong, you see a warning when you add the rule.</span></span> <span data-ttu-id="30588-163">You can save and continue, but you need to reopen and correct the rule.</span><span class="sxs-lookup"><span data-stu-id="30588-163">You can save and continue, but you need to reopen and correct the rule.</span></span>
6. <span data-ttu-id="30588-164">Click **Add** to save the rule.</span><span class="sxs-lookup"><span data-stu-id="30588-164">Click **Add** to save the rule.</span></span>

<span data-ttu-id="30588-165">Your new custom rule should be visible with the other sync rules in the system.</span><span class="sxs-lookup"><span data-stu-id="30588-165">Your new custom rule should be visible with the other sync rules in the system.</span></span>

### <a name="verify-the-change"></a><span data-ttu-id="30588-166">Verify the change</span><span class="sxs-lookup"><span data-stu-id="30588-166">Verify the change</span></span>
<span data-ttu-id="30588-167">With this new change, you want to make sure it is working as expected and is not throwing any errors.</span><span class="sxs-lookup"><span data-stu-id="30588-167">With this new change, you want to make sure it is working as expected and is not throwing any errors.</span></span> <span data-ttu-id="30588-168">Depending on the number of objects you have, there are two ways to do this step:</span><span class="sxs-lookup"><span data-stu-id="30588-168">Depending on the number of objects you have, there are two ways to do this step:</span></span>

- <span data-ttu-id="30588-169">Run a full sync on all objects.</span><span class="sxs-lookup"><span data-stu-id="30588-169">Run a full sync on all objects.</span></span>
- <span data-ttu-id="30588-170">Run a preview and full sync on a single object.</span><span class="sxs-lookup"><span data-stu-id="30588-170">Run a preview and full sync on a single object.</span></span>

<span data-ttu-id="30588-171">Open the **Synchronization Service** from the **Start** menu.</span><span class="sxs-lookup"><span data-stu-id="30588-171">Open the **Synchronization Service** from the **Start** menu.</span></span> <span data-ttu-id="30588-172">The steps in this section are all in this tool.</span><span class="sxs-lookup"><span data-stu-id="30588-172">The steps in this section are all in this tool.</span></span>

<span data-ttu-id="30588-173">**Full sync on all objects**</span><span class="sxs-lookup"><span data-stu-id="30588-173">**Full sync on all objects**</span></span>  

   1. <span data-ttu-id="30588-174">Select **Connectors** at the top.</span><span class="sxs-lookup"><span data-stu-id="30588-174">Select **Connectors** at the top.</span></span> <span data-ttu-id="30588-175">Identify the connector that you changed in the previous section (in this case, Active Directory Domain Services), and select it.</span><span class="sxs-lookup"><span data-stu-id="30588-175">Identify the connector that you changed in the previous section (in this case, Active Directory Domain Services), and select it.</span></span> 
   2. <span data-ttu-id="30588-176">For **Actions**, select **Run**.</span><span class="sxs-lookup"><span data-stu-id="30588-176">For **Actions**, select **Run**.</span></span>
   3. <span data-ttu-id="30588-177">Select **Full Synchronization**, and then select **OK**.</span><span class="sxs-lookup"><span data-stu-id="30588-177">Select **Full Synchronization**, and then select **OK**.</span></span>
   <span data-ttu-id="30588-178">![Full sync](./media/active-directory-aadconnectsync-change-the-configuration/fullsync.png)</span><span class="sxs-lookup"><span data-stu-id="30588-178">![Full sync](./media/active-directory-aadconnectsync-change-the-configuration/fullsync.png)</span></span>  
   <span data-ttu-id="30588-179">The objects are now updated in the metaverse.</span><span class="sxs-lookup"><span data-stu-id="30588-179">The objects are now updated in the metaverse.</span></span> <span data-ttu-id="30588-180">Verify your changes by looking at the object in the metaverse.</span><span class="sxs-lookup"><span data-stu-id="30588-180">Verify your changes by looking at the object in the metaverse.</span></span>

<span data-ttu-id="30588-181">**Preview and full sync on a single object**</span><span class="sxs-lookup"><span data-stu-id="30588-181">**Preview and full sync on a single object**</span></span>  

   1. <span data-ttu-id="30588-182">Select **Connectors** at the top.</span><span class="sxs-lookup"><span data-stu-id="30588-182">Select **Connectors** at the top.</span></span> <span data-ttu-id="30588-183">Identify the connector that you changed in the previous section (in this case, Active Directory Domain Services), and select it.</span><span class="sxs-lookup"><span data-stu-id="30588-183">Identify the connector that you changed in the previous section (in this case, Active Directory Domain Services), and select it.</span></span>
   2. <span data-ttu-id="30588-184">Select **Search Connector Space**.</span><span class="sxs-lookup"><span data-stu-id="30588-184">Select **Search Connector Space**.</span></span> 
   3. <span data-ttu-id="30588-185">Use **Scope** to find an object that you want to use to test the change.</span><span class="sxs-lookup"><span data-stu-id="30588-185">Use **Scope** to find an object that you want to use to test the change.</span></span> <span data-ttu-id="30588-186">Select the object and click **Preview**.</span><span class="sxs-lookup"><span data-stu-id="30588-186">Select the object and click **Preview**.</span></span> 
   4. <span data-ttu-id="30588-187">On the new screen, select **Commit Preview**.</span><span class="sxs-lookup"><span data-stu-id="30588-187">On the new screen, select **Commit Preview**.</span></span>  
   <span data-ttu-id="30588-188">![Commit preview](./media/active-directory-aadconnectsync-change-the-configuration/commitpreview.png)</span><span class="sxs-lookup"><span data-stu-id="30588-188">![Commit preview](./media/active-directory-aadconnectsync-change-the-configuration/commitpreview.png)</span></span>  
   <span data-ttu-id="30588-189">The change is now committed to the metaverse.</span><span class="sxs-lookup"><span data-stu-id="30588-189">The change is now committed to the metaverse.</span></span>

<span data-ttu-id="30588-190">**View the object in the metaverse**</span><span class="sxs-lookup"><span data-stu-id="30588-190">**View the object in the metaverse**</span></span>  

1. <span data-ttu-id="30588-191">Pick a few sample objects to make sure that the value is expected and that the rule applied.</span><span class="sxs-lookup"><span data-stu-id="30588-191">Pick a few sample objects to make sure that the value is expected and that the rule applied.</span></span> 
2. <span data-ttu-id="30588-192">Select **Metaverse Search** from the top.</span><span class="sxs-lookup"><span data-stu-id="30588-192">Select **Metaverse Search** from the top.</span></span> <span data-ttu-id="30588-193">Add any filter that you need to find the relevant objects.</span><span class="sxs-lookup"><span data-stu-id="30588-193">Add any filter that you need to find the relevant objects.</span></span> 
3. <span data-ttu-id="30588-194">From the search result, open an object.</span><span class="sxs-lookup"><span data-stu-id="30588-194">From the search result, open an object.</span></span> <span data-ttu-id="30588-195">Look at the attribute values, and also verify in the **Sync Rules** column that the rule applied as expected.</span><span class="sxs-lookup"><span data-stu-id="30588-195">Look at the attribute values, and also verify in the **Sync Rules** column that the rule applied as expected.</span></span>  
<span data-ttu-id="30588-196">![Metaverse search](./media/active-directory-aadconnectsync-change-the-configuration/mvsearch.png)</span><span class="sxs-lookup"><span data-stu-id="30588-196">![Metaverse search](./media/active-directory-aadconnectsync-change-the-configuration/mvsearch.png)</span></span>  

### <a name="enable-the-scheduler"></a><span data-ttu-id="30588-197">Enable the scheduler</span><span class="sxs-lookup"><span data-stu-id="30588-197">Enable the scheduler</span></span>
<span data-ttu-id="30588-198">If everything is as expected, you can enable the scheduler again.</span><span class="sxs-lookup"><span data-stu-id="30588-198">If everything is as expected, you can enable the scheduler again.</span></span> <span data-ttu-id="30588-199">From PowerShell, run `Set-ADSyncScheduler -SyncCycleEnabled $true`.</span><span class="sxs-lookup"><span data-stu-id="30588-199">From PowerShell, run `Set-ADSyncScheduler -SyncCycleEnabled $true`.</span></span>

## <a name="other-common-attribute-flow-changes"></a><span data-ttu-id="30588-200">Other common attribute flow changes</span><span class="sxs-lookup"><span data-stu-id="30588-200">Other common attribute flow changes</span></span>
<span data-ttu-id="30588-201">The previous section described how to make changes to an attribute flow.</span><span class="sxs-lookup"><span data-stu-id="30588-201">The previous section described how to make changes to an attribute flow.</span></span> <span data-ttu-id="30588-202">In this section, some additional examples are provided.</span><span class="sxs-lookup"><span data-stu-id="30588-202">In this section, some additional examples are provided.</span></span> <span data-ttu-id="30588-203">The steps for how to create the sync rule is abbreviated, but you can find the full steps in the previous section.</span><span class="sxs-lookup"><span data-stu-id="30588-203">The steps for how to create the sync rule is abbreviated, but you can find the full steps in the previous section.</span></span>

### <a name="use-an-attribute-other-than-the-default"></a><span data-ttu-id="30588-204">Use an attribute other than the default</span><span class="sxs-lookup"><span data-stu-id="30588-204">Use an attribute other than the default</span></span>
<span data-ttu-id="30588-205">In this Fabrikam scenario, there is a forest where the local alphabet is used for given name, surname, and display name.</span><span class="sxs-lookup"><span data-stu-id="30588-205">In this Fabrikam scenario, there is a forest where the local alphabet is used for given name, surname, and display name.</span></span> <span data-ttu-id="30588-206">The Latin character representation of these attributes can be found in the extension attributes.</span><span class="sxs-lookup"><span data-stu-id="30588-206">The Latin character representation of these attributes can be found in the extension attributes.</span></span> <span data-ttu-id="30588-207">For building a global address list in Azure AD and Office 365, the organization wants to use these attributes instead.</span><span class="sxs-lookup"><span data-stu-id="30588-207">For building a global address list in Azure AD and Office 365, the organization wants to use these attributes instead.</span></span>

<span data-ttu-id="30588-208">With a default configuration, an object from the local forest looks like this:</span><span class="sxs-lookup"><span data-stu-id="30588-208">With a default configuration, an object from the local forest looks like this:</span></span>  
![Attribute flow 1](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp1.png)

<span data-ttu-id="30588-210">To create a rule with other attribute flows, do the following:</span><span class="sxs-lookup"><span data-stu-id="30588-210">To create a rule with other attribute flows, do the following:</span></span>

1. <span data-ttu-id="30588-211">Open the **Synchronization Rules Editor** from the **Start** menu.</span><span class="sxs-lookup"><span data-stu-id="30588-211">Open the **Synchronization Rules Editor** from the **Start** menu.</span></span>
2. <span data-ttu-id="30588-212">With **Inbound** still selected to the left, click the **Add new rule** button.</span><span class="sxs-lookup"><span data-stu-id="30588-212">With **Inbound** still selected to the left, click the **Add new rule** button.</span></span>
3. <span data-ttu-id="30588-213">Give the rule a name and description.</span><span class="sxs-lookup"><span data-stu-id="30588-213">Give the rule a name and description.</span></span> <span data-ttu-id="30588-214">Select the on-premises Active Directory instance and the relevant object types.</span><span class="sxs-lookup"><span data-stu-id="30588-214">Select the on-premises Active Directory instance and the relevant object types.</span></span> <span data-ttu-id="30588-215">In **Link Type**, select **Join**.</span><span class="sxs-lookup"><span data-stu-id="30588-215">In **Link Type**, select **Join**.</span></span> <span data-ttu-id="30588-216">For **Precedence**, pick a number that is not used by another rule.</span><span class="sxs-lookup"><span data-stu-id="30588-216">For **Precedence**, pick a number that is not used by another rule.</span></span> <span data-ttu-id="30588-217">The out-of-box rules start with 100, so the value 50 can be used in this example.</span><span class="sxs-lookup"><span data-stu-id="30588-217">The out-of-box rules start with 100, so the value 50 can be used in this example.</span></span>
  <span data-ttu-id="30588-218">![Attribute flow 2](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp2.png)</span><span class="sxs-lookup"><span data-stu-id="30588-218">![Attribute flow 2](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp2.png)</span></span>
4. <span data-ttu-id="30588-219">Leave **Scoping filter** empty.</span><span class="sxs-lookup"><span data-stu-id="30588-219">Leave **Scoping filter** empty.</span></span> <span data-ttu-id="30588-220">(That is, it should apply to all user objects in the forest.)</span><span class="sxs-lookup"><span data-stu-id="30588-220">(That is, it should apply to all user objects in the forest.)</span></span>
5. <span data-ttu-id="30588-221">Leave **Join rules** empty.</span><span class="sxs-lookup"><span data-stu-id="30588-221">Leave **Join rules** empty.</span></span> <span data-ttu-id="30588-222">(That is, let the out-of-box rule handle any joins.)</span><span class="sxs-lookup"><span data-stu-id="30588-222">(That is, let the out-of-box rule handle any joins.)</span></span>
6. <span data-ttu-id="30588-223">In **Transformations**, create the following flows:</span><span class="sxs-lookup"><span data-stu-id="30588-223">In **Transformations**, create the following flows:</span></span>  
  <span data-ttu-id="30588-224">![Attribute flow 3](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp3.png)</span><span class="sxs-lookup"><span data-stu-id="30588-224">![Attribute flow 3](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp3.png)</span></span>
7. <span data-ttu-id="30588-225">Click **Add** to save the rule.</span><span class="sxs-lookup"><span data-stu-id="30588-225">Click **Add** to save the rule.</span></span>
8. <span data-ttu-id="30588-226">Go to **Synchronization Service Manager**.</span><span class="sxs-lookup"><span data-stu-id="30588-226">Go to **Synchronization Service Manager**.</span></span> <span data-ttu-id="30588-227">On **Connectors**, select the connector where you added the rule.</span><span class="sxs-lookup"><span data-stu-id="30588-227">On **Connectors**, select the connector where you added the rule.</span></span> <span data-ttu-id="30588-228">Select **Run**, and then select **Full Synchronization**.</span><span class="sxs-lookup"><span data-stu-id="30588-228">Select **Run**, and then select **Full Synchronization**.</span></span> <span data-ttu-id="30588-229">A full synchronization recalculates all objects by using the current rules.</span><span class="sxs-lookup"><span data-stu-id="30588-229">A full synchronization recalculates all objects by using the current rules.</span></span>

<span data-ttu-id="30588-230">This is the result for the same object with this custom rule:</span><span class="sxs-lookup"><span data-stu-id="30588-230">This is the result for the same object with this custom rule:</span></span>  
![Attribute flow 4](./media/active-directory-aadconnectsync-change-the-configuration/attributeflowjp4.png)

### <a name="length-of-attributes"></a><span data-ttu-id="30588-232">Length of attributes</span><span class="sxs-lookup"><span data-stu-id="30588-232">Length of attributes</span></span>
<span data-ttu-id="30588-233">String attributes are indexable by default, and the maximum length is 448 characters.</span><span class="sxs-lookup"><span data-stu-id="30588-233">String attributes are indexable by default, and the maximum length is 448 characters.</span></span> <span data-ttu-id="30588-234">If you are working with string attributes that might contain more, make sure to include the following in the attribute flow:</span><span class="sxs-lookup"><span data-stu-id="30588-234">If you are working with string attributes that might contain more, make sure to include the following in the attribute flow:</span></span>  
<span data-ttu-id="30588-235">`attributeName` <- `Left([attributeName],448)`.</span><span class="sxs-lookup"><span data-stu-id="30588-235">`attributeName` <- `Left([attributeName],448)`.</span></span>

### <a name="changing-the-userprincipalsuffix"></a><span data-ttu-id="30588-236">Changing the userPrincipalSuffix</span><span class="sxs-lookup"><span data-stu-id="30588-236">Changing the userPrincipalSuffix</span></span>
<span data-ttu-id="30588-237">The userPrincipalName attribute in Active Directory is not always known by the users and might not be suitable as the sign-in ID.</span><span class="sxs-lookup"><span data-stu-id="30588-237">The userPrincipalName attribute in Active Directory is not always known by the users and might not be suitable as the sign-in ID.</span></span> <span data-ttu-id="30588-238">With the Azure AD Connect sync installation wizard, you can choose a different attribute--for example, *mail*.</span><span class="sxs-lookup"><span data-stu-id="30588-238">With the Azure AD Connect sync installation wizard, you can choose a different attribute--for example, *mail*.</span></span> <span data-ttu-id="30588-239">But in some cases, the attribute must be calculated.</span><span class="sxs-lookup"><span data-stu-id="30588-239">But in some cases, the attribute must be calculated.</span></span>

<span data-ttu-id="30588-240">For example, the company Contoso has two Azure AD directories, one for production and one for testing.</span><span class="sxs-lookup"><span data-stu-id="30588-240">For example, the company Contoso has two Azure AD directories, one for production and one for testing.</span></span> <span data-ttu-id="30588-241">They want the users in their test tenant to use another suffix in the sign-in ID:</span><span class="sxs-lookup"><span data-stu-id="30588-241">They want the users in their test tenant to use another suffix in the sign-in ID:</span></span>  
<span data-ttu-id="30588-242">`userPrincipalName` <- `Word([userPrincipalName],1,"@") & "@contosotest.com"`.</span><span class="sxs-lookup"><span data-stu-id="30588-242">`userPrincipalName` <- `Word([userPrincipalName],1,"@") & "@contosotest.com"`.</span></span>

<span data-ttu-id="30588-243">In this expression, take everything left of the first @-sign (Word) and concatenate with a fixed string.</span><span class="sxs-lookup"><span data-stu-id="30588-243">In this expression, take everything left of the first @-sign (Word) and concatenate with a fixed string.</span></span>

### <a name="convert-a-multi-value-attribute-to-single-value"></a><span data-ttu-id="30588-244">Convert a multi-value attribute to single value</span><span class="sxs-lookup"><span data-stu-id="30588-244">Convert a multi-value attribute to single value</span></span>
<span data-ttu-id="30588-245">Some attributes in Active Directory are multi-valued in the schema, even though they look single-valued in Active Directory Users and Computers.</span><span class="sxs-lookup"><span data-stu-id="30588-245">Some attributes in Active Directory are multi-valued in the schema, even though they look single-valued in Active Directory Users and Computers.</span></span> <span data-ttu-id="30588-246">An example is the description attribute:</span><span class="sxs-lookup"><span data-stu-id="30588-246">An example is the description attribute:</span></span>  
<span data-ttu-id="30588-247">`description` <- `IIF(IsNullOrEmpty([description]),NULL,Left(Trim(Item([description],1)),448))`.</span><span class="sxs-lookup"><span data-stu-id="30588-247">`description` <- `IIF(IsNullOrEmpty([description]),NULL,Left(Trim(Item([description],1)),448))`.</span></span>

<span data-ttu-id="30588-248">In this expression, if the attribute has a value, take the first item (*Item*) in the attribute, remove leading and trailing spaces (*Trim*), and then keep the first 448 characters (*Left*) in the string.</span><span class="sxs-lookup"><span data-stu-id="30588-248">In this expression, if the attribute has a value, take the first item (*Item*) in the attribute, remove leading and trailing spaces (*Trim*), and then keep the first 448 characters (*Left*) in the string.</span></span>

### <a name="do-not-flow-an-attribute"></a><span data-ttu-id="30588-249">Do not flow an attribute</span><span class="sxs-lookup"><span data-stu-id="30588-249">Do not flow an attribute</span></span>
<span data-ttu-id="30588-250">For background on the scenario for this section, see [Control the attribute flow process](active-directory-aadconnectsync-understanding-declarative-provisioning.md#control-the-attribute-flow-process).</span><span class="sxs-lookup"><span data-stu-id="30588-250">For background on the scenario for this section, see [Control the attribute flow process](active-directory-aadconnectsync-understanding-declarative-provisioning.md#control-the-attribute-flow-process).</span></span>

<span data-ttu-id="30588-251">There are two ways to not flow an attribute.</span><span class="sxs-lookup"><span data-stu-id="30588-251">There are two ways to not flow an attribute.</span></span> <span data-ttu-id="30588-252">The first is by using the installation wizard to [remove selected attributes](active-directory-aadconnect-get-started-custom.md#azure-ad-app-and-attribute-filtering).</span><span class="sxs-lookup"><span data-stu-id="30588-252">The first is by using the installation wizard to [remove selected attributes](active-directory-aadconnect-get-started-custom.md#azure-ad-app-and-attribute-filtering).</span></span> <span data-ttu-id="30588-253">This option works if you have never synchronized the attribute before.</span><span class="sxs-lookup"><span data-stu-id="30588-253">This option works if you have never synchronized the attribute before.</span></span> <span data-ttu-id="30588-254">However, if you have started to synchronize this attribute and later remove it with this feature, the sync engine stops managing the attribute and the existing values are left in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="30588-254">However, if you have started to synchronize this attribute and later remove it with this feature, the sync engine stops managing the attribute and the existing values are left in Azure AD.</span></span>

<span data-ttu-id="30588-255">If you want to remove the value of an attribute and make sure it does not flow in the future, you need create a custom rule.</span><span class="sxs-lookup"><span data-stu-id="30588-255">If you want to remove the value of an attribute and make sure it does not flow in the future, you need create a custom rule.</span></span>

<span data-ttu-id="30588-256">In this Fabrikam scenario, we have realized that some of the attributes we synchronize to the cloud should not be there.</span><span class="sxs-lookup"><span data-stu-id="30588-256">In this Fabrikam scenario, we have realized that some of the attributes we synchronize to the cloud should not be there.</span></span> <span data-ttu-id="30588-257">We want to make sure these attributes are removed from Azure AD.</span><span class="sxs-lookup"><span data-stu-id="30588-257">We want to make sure these attributes are removed from Azure AD.</span></span>  
![Bad extension attributes](./media/active-directory-aadconnectsync-change-the-configuration/badextensionattribute.png)

1. <span data-ttu-id="30588-259">Create a new inbound synchronization rule and populate the description.</span><span class="sxs-lookup"><span data-stu-id="30588-259">Create a new inbound synchronization rule and populate the description.</span></span>
  <span data-ttu-id="30588-260">![Descriptions](./media/active-directory-aadconnectsync-change-the-configuration/syncruledescription.png)</span><span class="sxs-lookup"><span data-stu-id="30588-260">![Descriptions](./media/active-directory-aadconnectsync-change-the-configuration/syncruledescription.png)</span></span>
2. <span data-ttu-id="30588-261">Create attribute flows with **Expression** for **FlowType** and with **AuthoritativeNull** for **Source**.</span><span class="sxs-lookup"><span data-stu-id="30588-261">Create attribute flows with **Expression** for **FlowType** and with **AuthoritativeNull** for **Source**.</span></span> <span data-ttu-id="30588-262">The literal **AuthoritativeNull** indicates that the value should be empty in the metaverse, even if a lower-precedence sync rule tries to populate the value.</span><span class="sxs-lookup"><span data-stu-id="30588-262">The literal **AuthoritativeNull** indicates that the value should be empty in the metaverse, even if a lower-precedence sync rule tries to populate the value.</span></span>
  <span data-ttu-id="30588-263">![Transformation for extension attributes](./media/active-directory-aadconnectsync-change-the-configuration/syncruletransformations.png)</span><span class="sxs-lookup"><span data-stu-id="30588-263">![Transformation for extension attributes](./media/active-directory-aadconnectsync-change-the-configuration/syncruletransformations.png)</span></span>
3. <span data-ttu-id="30588-264">Save the sync rule.</span><span class="sxs-lookup"><span data-stu-id="30588-264">Save the sync rule.</span></span> <span data-ttu-id="30588-265">Start the **Synchronization Service**, find the connector, select **Run**, and then select **Full Synchronization**.</span><span class="sxs-lookup"><span data-stu-id="30588-265">Start the **Synchronization Service**, find the connector, select **Run**, and then select **Full Synchronization**.</span></span> <span data-ttu-id="30588-266">This step recalculates all attribute flows.</span><span class="sxs-lookup"><span data-stu-id="30588-266">This step recalculates all attribute flows.</span></span>
4. <span data-ttu-id="30588-267">Verify that the intended changes are about to be exported by searching the Connector Space.</span><span class="sxs-lookup"><span data-stu-id="30588-267">Verify that the intended changes are about to be exported by searching the Connector Space.</span></span>
  <span data-ttu-id="30588-268">![Staged delete](./media/active-directory-aadconnectsync-change-the-configuration/deletetobeexported.png)</span><span class="sxs-lookup"><span data-stu-id="30588-268">![Staged delete](./media/active-directory-aadconnectsync-change-the-configuration/deletetobeexported.png)</span></span>

## <a name="create-rules-with-powershell"></a><span data-ttu-id="30588-269">Create rules with PowerShell</span><span class="sxs-lookup"><span data-stu-id="30588-269">Create rules with PowerShell</span></span>
<span data-ttu-id="30588-270">Using the sync rule editor works fine when you only have a few changes to make.</span><span class="sxs-lookup"><span data-stu-id="30588-270">Using the sync rule editor works fine when you only have a few changes to make.</span></span> <span data-ttu-id="30588-271">If you need to make many changes, PowerShell might be a better option.</span><span class="sxs-lookup"><span data-stu-id="30588-271">If you need to make many changes, PowerShell might be a better option.</span></span> <span data-ttu-id="30588-272">Some advanced features are only available with PowerShell.</span><span class="sxs-lookup"><span data-stu-id="30588-272">Some advanced features are only available with PowerShell.</span></span>

### <a name="get-the-powershell-script-for-an-out-of-box-rule"></a><span data-ttu-id="30588-273">Get the PowerShell script for an out-of-box rule</span><span class="sxs-lookup"><span data-stu-id="30588-273">Get the PowerShell script for an out-of-box rule</span></span>
<span data-ttu-id="30588-274">To see the PowerShell script that created an out-of-box rule, select the rule in the sync rules editor and click **Export**.</span><span class="sxs-lookup"><span data-stu-id="30588-274">To see the PowerShell script that created an out-of-box rule, select the rule in the sync rules editor and click **Export**.</span></span> <span data-ttu-id="30588-275">This action gives you the PowerShell script that created the rule.</span><span class="sxs-lookup"><span data-stu-id="30588-275">This action gives you the PowerShell script that created the rule.</span></span>

### <a name="advanced-precedence"></a><span data-ttu-id="30588-276">Advanced precedence</span><span class="sxs-lookup"><span data-stu-id="30588-276">Advanced precedence</span></span>
<span data-ttu-id="30588-277">The out-of-box sync rules start with a precedence value of 100.</span><span class="sxs-lookup"><span data-stu-id="30588-277">The out-of-box sync rules start with a precedence value of 100.</span></span> <span data-ttu-id="30588-278">If you have many forests and you need to make many custom changes, then 99 sync rules might not be enough.</span><span class="sxs-lookup"><span data-stu-id="30588-278">If you have many forests and you need to make many custom changes, then 99 sync rules might not be enough.</span></span>

<span data-ttu-id="30588-279">You can instruct the sync engine that you want additional rules inserted before the out-of-box rules.</span><span class="sxs-lookup"><span data-stu-id="30588-279">You can instruct the sync engine that you want additional rules inserted before the out-of-box rules.</span></span> <span data-ttu-id="30588-280">To get this behavior, follow these steps:</span><span class="sxs-lookup"><span data-stu-id="30588-280">To get this behavior, follow these steps:</span></span>

1. <span data-ttu-id="30588-281">Mark the first out-of-box sync rule (**In from AD-User Join**) in the sync rules editor and select **Export**.</span><span class="sxs-lookup"><span data-stu-id="30588-281">Mark the first out-of-box sync rule (**In from AD-User Join**) in the sync rules editor and select **Export**.</span></span> <span data-ttu-id="30588-282">Copy the SR Identifier value.</span><span class="sxs-lookup"><span data-stu-id="30588-282">Copy the SR Identifier value.</span></span>  
<span data-ttu-id="30588-283">![PowerShell before change](./media/active-directory-aadconnectsync-change-the-configuration/powershell1.png)</span><span class="sxs-lookup"><span data-stu-id="30588-283">![PowerShell before change](./media/active-directory-aadconnectsync-change-the-configuration/powershell1.png)</span></span>  
2. <span data-ttu-id="30588-284">Create the new sync rule.</span><span class="sxs-lookup"><span data-stu-id="30588-284">Create the new sync rule.</span></span> <span data-ttu-id="30588-285">You can use the sync rules editor to create it.</span><span class="sxs-lookup"><span data-stu-id="30588-285">You can use the sync rules editor to create it.</span></span> <span data-ttu-id="30588-286">Export the rule to a PowerShell script.</span><span class="sxs-lookup"><span data-stu-id="30588-286">Export the rule to a PowerShell script.</span></span>
3. <span data-ttu-id="30588-287">In the property **PrecedenceBefore**, insert the Identifier value from the out-of-box rule.</span><span class="sxs-lookup"><span data-stu-id="30588-287">In the property **PrecedenceBefore**, insert the Identifier value from the out-of-box rule.</span></span> <span data-ttu-id="30588-288">Set the **Precedence** to **0**.</span><span class="sxs-lookup"><span data-stu-id="30588-288">Set the **Precedence** to **0**.</span></span> <span data-ttu-id="30588-289">Make sure the Identifier attribute is unique and that you are not reusing a GUID from another rule.</span><span class="sxs-lookup"><span data-stu-id="30588-289">Make sure the Identifier attribute is unique and that you are not reusing a GUID from another rule.</span></span> <span data-ttu-id="30588-290">Also make sure that the **ImmutableTag** property is not set.</span><span class="sxs-lookup"><span data-stu-id="30588-290">Also make sure that the **ImmutableTag** property is not set.</span></span> <span data-ttu-id="30588-291">This property should be set only for an out-of-box rule.</span><span class="sxs-lookup"><span data-stu-id="30588-291">This property should be set only for an out-of-box rule.</span></span>
4. <span data-ttu-id="30588-292">Save the PowerShell script and run it.</span><span class="sxs-lookup"><span data-stu-id="30588-292">Save the PowerShell script and run it.</span></span> <span data-ttu-id="30588-293">The result is that your custom rule is assigned the precedence value of 100 and all other out-of-box rules are incremented.</span><span class="sxs-lookup"><span data-stu-id="30588-293">The result is that your custom rule is assigned the precedence value of 100 and all other out-of-box rules are incremented.</span></span>  
![PowerShell after change](./media/active-directory-aadconnectsync-change-the-configuration/powershell2.png)  

<span data-ttu-id="30588-295">You can have many custom sync rules by using the same **PrecedenceBefore** value when needed.</span><span class="sxs-lookup"><span data-stu-id="30588-295">You can have many custom sync rules by using the same **PrecedenceBefore** value when needed.</span></span>

## <a name="enable-synchronization-of-usertype"></a><span data-ttu-id="30588-296">Enable synchronization of UserType</span><span class="sxs-lookup"><span data-stu-id="30588-296">Enable synchronization of UserType</span></span>
<span data-ttu-id="30588-297">Azure AD Connect supports synchronization of the **UserType** attribute for **User** objects in version 1.1.524.0 and later.</span><span class="sxs-lookup"><span data-stu-id="30588-297">Azure AD Connect supports synchronization of the **UserType** attribute for **User** objects in version 1.1.524.0 and later.</span></span> <span data-ttu-id="30588-298">More specifically, the following changes have been introduced:</span><span class="sxs-lookup"><span data-stu-id="30588-298">More specifically, the following changes have been introduced:</span></span>

- <span data-ttu-id="30588-299">The schema of the object type **User** in the Azure AD Connector is extended to include the UserType attribute, which is of the type string and is single-valued.</span><span class="sxs-lookup"><span data-stu-id="30588-299">The schema of the object type **User** in the Azure AD Connector is extended to include the UserType attribute, which is of the type string and is single-valued.</span></span>
- <span data-ttu-id="30588-300">The schema of the object type **Person** in the metaverse is extended to include the UserType attribute, which is of the type string and is single-valued.</span><span class="sxs-lookup"><span data-stu-id="30588-300">The schema of the object type **Person** in the metaverse is extended to include the UserType attribute, which is of the type string and is single-valued.</span></span>

<span data-ttu-id="30588-301">By default, the UserType attribute is not enabled for synchronization because there is no corresponding UserType attribute in on-premises Active Directory.</span><span class="sxs-lookup"><span data-stu-id="30588-301">By default, the UserType attribute is not enabled for synchronization because there is no corresponding UserType attribute in on-premises Active Directory.</span></span> <span data-ttu-id="30588-302">You must manually enable synchronization.</span><span class="sxs-lookup"><span data-stu-id="30588-302">You must manually enable synchronization.</span></span> <span data-ttu-id="30588-303">Before doing this, you must take note of the following behavior enforced by Azure AD:</span><span class="sxs-lookup"><span data-stu-id="30588-303">Before doing this, you must take note of the following behavior enforced by Azure AD:</span></span>

- <span data-ttu-id="30588-304">Azure AD only accepts two values for the UserType attribute: **Member** and **Guest**.</span><span class="sxs-lookup"><span data-stu-id="30588-304">Azure AD only accepts two values for the UserType attribute: **Member** and **Guest**.</span></span>
- <span data-ttu-id="30588-305">If the UserType attribute is not enabled for synchronization in Azure AD Connect, Azure AD users created through directory synchronization would have the UserType attribute set to **Member**.</span><span class="sxs-lookup"><span data-stu-id="30588-305">If the UserType attribute is not enabled for synchronization in Azure AD Connect, Azure AD users created through directory synchronization would have the UserType attribute set to **Member**.</span></span>
- <span data-ttu-id="30588-306">Azure AD does not permit the UserType attribute on existing Azure AD users to be changed by Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="30588-306">Azure AD does not permit the UserType attribute on existing Azure AD users to be changed by Azure AD Connect.</span></span> <span data-ttu-id="30588-307">It can only be set during the creation of the Azure AD users.</span><span class="sxs-lookup"><span data-stu-id="30588-307">It can only be set during the creation of the Azure AD users.</span></span>

<span data-ttu-id="30588-308">Before enabling synchronization of the UserType attribute, you must first decide how the attribute is derived from on-premises Active Directory.</span><span class="sxs-lookup"><span data-stu-id="30588-308">Before enabling synchronization of the UserType attribute, you must first decide how the attribute is derived from on-premises Active Directory.</span></span> <span data-ttu-id="30588-309">The following are the most common approaches:</span><span class="sxs-lookup"><span data-stu-id="30588-309">The following are the most common approaches:</span></span>

- <span data-ttu-id="30588-310">Designate an unused on-premises AD attribute (such as extensionAttribute1) to be used as the source attribute.</span><span class="sxs-lookup"><span data-stu-id="30588-310">Designate an unused on-premises AD attribute (such as extensionAttribute1) to be used as the source attribute.</span></span> <span data-ttu-id="30588-311">The designated on-premises AD attribute should be of the type **string**, be single-valued, and contain the value **Member** or **Guest**.</span><span class="sxs-lookup"><span data-stu-id="30588-311">The designated on-premises AD attribute should be of the type **string**, be single-valued, and contain the value **Member** or **Guest**.</span></span> 

    <span data-ttu-id="30588-312">If you choose this approach, you must ensure that the designated attribute is populated with the correct value for all existing user objects in on-premises Active Directory that are synchronized to Azure AD before enabling synchronization of the UserType attribute.</span><span class="sxs-lookup"><span data-stu-id="30588-312">If you choose this approach, you must ensure that the designated attribute is populated with the correct value for all existing user objects in on-premises Active Directory that are synchronized to Azure AD before enabling synchronization of the UserType attribute.</span></span>

- <span data-ttu-id="30588-313">Alternatively, you can derive the value for the UserType attribute from other properties.</span><span class="sxs-lookup"><span data-stu-id="30588-313">Alternatively, you can derive the value for the UserType attribute from other properties.</span></span> <span data-ttu-id="30588-314">For example, you want to synchronize all users as **Guest** if their on-premises AD userPrincipalName attribute ends with domain part *@partners.fabrikam123.org*.</span><span class="sxs-lookup"><span data-stu-id="30588-314">For example, you want to synchronize all users as **Guest** if their on-premises AD userPrincipalName attribute ends with domain part *@partners.fabrikam123.org*.</span></span> 

    <span data-ttu-id="30588-315">As mentioned previously, Azure AD Connect does not permit the UserType attribute on existing Azure AD users to be changed by Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="30588-315">As mentioned previously, Azure AD Connect does not permit the UserType attribute on existing Azure AD users to be changed by Azure AD Connect.</span></span> <span data-ttu-id="30588-316">Therefore, you must ensure that the logic you have decided is consistent with how the UserType attribute is already configured for all existing Azure AD users in your tenant.</span><span class="sxs-lookup"><span data-stu-id="30588-316">Therefore, you must ensure that the logic you have decided is consistent with how the UserType attribute is already configured for all existing Azure AD users in your tenant.</span></span>

<span data-ttu-id="30588-317">The steps to enable synchronization of the UserType attribute can be summarized as:</span><span class="sxs-lookup"><span data-stu-id="30588-317">The steps to enable synchronization of the UserType attribute can be summarized as:</span></span>

1.  <span data-ttu-id="30588-318">Disable the sync scheduler and verify there is no synchronization in progress.</span><span class="sxs-lookup"><span data-stu-id="30588-318">Disable the sync scheduler and verify there is no synchronization in progress.</span></span>
2.  <span data-ttu-id="30588-319">Add the source attribute to the on-premises AD Connector schema.</span><span class="sxs-lookup"><span data-stu-id="30588-319">Add the source attribute to the on-premises AD Connector schema.</span></span>
3.  <span data-ttu-id="30588-320">Add the UserType to the Azure AD Connector schema.</span><span class="sxs-lookup"><span data-stu-id="30588-320">Add the UserType to the Azure AD Connector schema.</span></span>
4.  <span data-ttu-id="30588-321">Create an inbound synchronization rule to flow the attribute value from on-premises Active Directory.</span><span class="sxs-lookup"><span data-stu-id="30588-321">Create an inbound synchronization rule to flow the attribute value from on-premises Active Directory.</span></span>
5.  <span data-ttu-id="30588-322">Create an outbound synchronization rule to flow the attribute value to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="30588-322">Create an outbound synchronization rule to flow the attribute value to Azure AD.</span></span>
6.  <span data-ttu-id="30588-323">Run a full synchronization cycle.</span><span class="sxs-lookup"><span data-stu-id="30588-323">Run a full synchronization cycle.</span></span>
7.  <span data-ttu-id="30588-324">Enable the sync scheduler.</span><span class="sxs-lookup"><span data-stu-id="30588-324">Enable the sync scheduler.</span></span>

>[!NOTE]
> <span data-ttu-id="30588-325">The rest of this section covers these steps.</span><span class="sxs-lookup"><span data-stu-id="30588-325">The rest of this section covers these steps.</span></span> <span data-ttu-id="30588-326">They are described in the context of an Azure AD deployment with single-forest topology and without custom synchronization rules.</span><span class="sxs-lookup"><span data-stu-id="30588-326">They are described in the context of an Azure AD deployment with single-forest topology and without custom synchronization rules.</span></span> <span data-ttu-id="30588-327">If you have multi-forest topology, custom synchronization rules configured, or have a staging server, you need to adjust the steps accordingly.</span><span class="sxs-lookup"><span data-stu-id="30588-327">If you have multi-forest topology, custom synchronization rules configured, or have a staging server, you need to adjust the steps accordingly.</span></span>

### <a name="step-1-disable-the-sync-scheduler-and-verify-there-is-no-synchronization-in-progress"></a><span data-ttu-id="30588-328">Step 1: Disable the sync scheduler and verify there is no synchronization in progress</span><span class="sxs-lookup"><span data-stu-id="30588-328">Step 1: Disable the sync scheduler and verify there is no synchronization in progress</span></span>
<span data-ttu-id="30588-329">To avoid exporting unintended changes to Azure AD, ensure that no synchronization takes place while you are in the middle of updating synchronization rules.</span><span class="sxs-lookup"><span data-stu-id="30588-329">To avoid exporting unintended changes to Azure AD, ensure that no synchronization takes place while you are in the middle of updating synchronization rules.</span></span> <span data-ttu-id="30588-330">To disable the built-in sync scheduler:</span><span class="sxs-lookup"><span data-stu-id="30588-330">To disable the built-in sync scheduler:</span></span>

 1. <span data-ttu-id="30588-331">Start a PowerShell session on the Azure AD Connect server.</span><span class="sxs-lookup"><span data-stu-id="30588-331">Start a PowerShell session on the Azure AD Connect server.</span></span>
 2. <span data-ttu-id="30588-332">Disable scheduled synchronization by running the cmdlet `Set-ADSyncScheduler -SyncCycleEnabled $false`.</span><span class="sxs-lookup"><span data-stu-id="30588-332">Disable scheduled synchronization by running the cmdlet `Set-ADSyncScheduler -SyncCycleEnabled $false`.</span></span>
 3. <span data-ttu-id="30588-333">Open the Synchronization Service Manager by going to **Start** > **Synchronization Service**.</span><span class="sxs-lookup"><span data-stu-id="30588-333">Open the Synchronization Service Manager by going to **Start** > **Synchronization Service**.</span></span>
 4. <span data-ttu-id="30588-334">Go to the **Operations** tab and confirm there is no operation with a status of *in progress*.</span><span class="sxs-lookup"><span data-stu-id="30588-334">Go to the **Operations** tab and confirm there is no operation with a status of *in progress*.</span></span>

### <a name="step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema"></a><span data-ttu-id="30588-335">Step 2: Add the source attribute to the on-premises AD Connector schema</span><span class="sxs-lookup"><span data-stu-id="30588-335">Step 2: Add the source attribute to the on-premises AD Connector schema</span></span>
<span data-ttu-id="30588-336">Not all Azure AD attributes are imported into the on-premises AD Connector Space.</span><span class="sxs-lookup"><span data-stu-id="30588-336">Not all Azure AD attributes are imported into the on-premises AD Connector Space.</span></span> <span data-ttu-id="30588-337">To add the source attribute to the list of the imported attributes:</span><span class="sxs-lookup"><span data-stu-id="30588-337">To add the source attribute to the list of the imported attributes:</span></span>

 1. <span data-ttu-id="30588-338">Go to the **Connectors** tab in the Synchronization Service Manager.</span><span class="sxs-lookup"><span data-stu-id="30588-338">Go to the **Connectors** tab in the Synchronization Service Manager.</span></span>
 2. <span data-ttu-id="30588-339">Right-click the on-premises AD Connector and select **Properties**.</span><span class="sxs-lookup"><span data-stu-id="30588-339">Right-click the on-premises AD Connector and select **Properties**.</span></span>
 3. <span data-ttu-id="30588-340">In the pop-up dialog box, go to the **Select Attributes** tab.</span><span class="sxs-lookup"><span data-stu-id="30588-340">In the pop-up dialog box, go to the **Select Attributes** tab.</span></span>
 4. <span data-ttu-id="30588-341">Make sure the source attribute is checked in the attribute list.</span><span class="sxs-lookup"><span data-stu-id="30588-341">Make sure the source attribute is checked in the attribute list.</span></span>
 5. <span data-ttu-id="30588-342">Click **OK** to save.</span><span class="sxs-lookup"><span data-stu-id="30588-342">Click **OK** to save.</span></span>
<span data-ttu-id="30588-343">![Add source attribute to on-premises AD Connector schema](./media/active-directory-aadconnectsync-change-the-configuration/usertype1.png)</span><span class="sxs-lookup"><span data-stu-id="30588-343">![Add source attribute to on-premises AD Connector schema](./media/active-directory-aadconnectsync-change-the-configuration/usertype1.png)</span></span>

### <a name="step-3-add-the-usertype-to-the-azure-ad-connector-schema"></a><span data-ttu-id="30588-344">Step 3: Add the UserType to the Azure AD Connector schema</span><span class="sxs-lookup"><span data-stu-id="30588-344">Step 3: Add the UserType to the Azure AD Connector schema</span></span>
<span data-ttu-id="30588-345">By default, the UserType attribute is not imported into the Azure AD Connect Space.</span><span class="sxs-lookup"><span data-stu-id="30588-345">By default, the UserType attribute is not imported into the Azure AD Connect Space.</span></span> <span data-ttu-id="30588-346">To add the UserType attribute to the list of imported attributes:</span><span class="sxs-lookup"><span data-stu-id="30588-346">To add the UserType attribute to the list of imported attributes:</span></span>

 1. <span data-ttu-id="30588-347">Go to the **Connectors** tab in the Synchronization Service Manager.</span><span class="sxs-lookup"><span data-stu-id="30588-347">Go to the **Connectors** tab in the Synchronization Service Manager.</span></span>
 2. <span data-ttu-id="30588-348">Right-click the **Azure AD Connector** and select **Properties**.</span><span class="sxs-lookup"><span data-stu-id="30588-348">Right-click the **Azure AD Connector** and select **Properties**.</span></span>
 3. <span data-ttu-id="30588-349">In the pop-up dialog box, go to the **Select Attributes** tab.</span><span class="sxs-lookup"><span data-stu-id="30588-349">In the pop-up dialog box, go to the **Select Attributes** tab.</span></span>
 4. <span data-ttu-id="30588-350">Make sure the UserType attribute is checked in the attribute list.</span><span class="sxs-lookup"><span data-stu-id="30588-350">Make sure the UserType attribute is checked in the attribute list.</span></span>
 5. <span data-ttu-id="30588-351">Click **OK** to save.</span><span class="sxs-lookup"><span data-stu-id="30588-351">Click **OK** to save.</span></span>

![Add source attribute to Azure AD Connector schema](./media/active-directory-aadconnectsync-change-the-configuration/usertype2.png)

### <a name="step-4-create-an-inbound-synchronization-rule-to-flow-the-attribute-value-from-on-premises-active-directory"></a><span data-ttu-id="30588-353">Step 4: Create an inbound synchronization rule to flow the attribute value from on-premises Active Directory</span><span class="sxs-lookup"><span data-stu-id="30588-353">Step 4: Create an inbound synchronization rule to flow the attribute value from on-premises Active Directory</span></span>
<span data-ttu-id="30588-354">The inbound synchronization rule permits the attribute value to flow from the source attribute from on-premises Active Directory to the metaverse:</span><span class="sxs-lookup"><span data-stu-id="30588-354">The inbound synchronization rule permits the attribute value to flow from the source attribute from on-premises Active Directory to the metaverse:</span></span>

1. <span data-ttu-id="30588-355">Open the Synchronization Rules Editor by going to **Start** > **Synchronization Rules Editor**.</span><span class="sxs-lookup"><span data-stu-id="30588-355">Open the Synchronization Rules Editor by going to **Start** > **Synchronization Rules Editor**.</span></span>
2. <span data-ttu-id="30588-356">Set the search filter **Direction** to be **Inbound**.</span><span class="sxs-lookup"><span data-stu-id="30588-356">Set the search filter **Direction** to be **Inbound**.</span></span>
3. <span data-ttu-id="30588-357">Click the **Add new rule** button to create a new inbound rule.</span><span class="sxs-lookup"><span data-stu-id="30588-357">Click the **Add new rule** button to create a new inbound rule.</span></span>
4. <span data-ttu-id="30588-358">Under the **Description** tab, provide the following configuration:</span><span class="sxs-lookup"><span data-stu-id="30588-358">Under the **Description** tab, provide the following configuration:</span></span>

    | <span data-ttu-id="30588-359">Attribute</span><span class="sxs-lookup"><span data-stu-id="30588-359">Attribute</span></span> | <span data-ttu-id="30588-360">Value</span><span class="sxs-lookup"><span data-stu-id="30588-360">Value</span></span> | <span data-ttu-id="30588-361">Details</span><span class="sxs-lookup"><span data-stu-id="30588-361">Details</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="30588-362">Name</span><span class="sxs-lookup"><span data-stu-id="30588-362">Name</span></span> | <span data-ttu-id="30588-363">*Provide a name*</span><span class="sxs-lookup"><span data-stu-id="30588-363">*Provide a name*</span></span> | <span data-ttu-id="30588-364">For example, *In from AD – User UserType*</span><span class="sxs-lookup"><span data-stu-id="30588-364">For example, *In from AD – User UserType*</span></span> |
    | <span data-ttu-id="30588-365">Description</span><span class="sxs-lookup"><span data-stu-id="30588-365">Description</span></span> | <span data-ttu-id="30588-366">*Provide a description*</span><span class="sxs-lookup"><span data-stu-id="30588-366">*Provide a description*</span></span> |  |
    | <span data-ttu-id="30588-367">Connected System</span><span class="sxs-lookup"><span data-stu-id="30588-367">Connected System</span></span> | <span data-ttu-id="30588-368">*Pick the on-premises AD connector*</span><span class="sxs-lookup"><span data-stu-id="30588-368">*Pick the on-premises AD connector*</span></span> |  |
    | <span data-ttu-id="30588-369">Connected System Object Type</span><span class="sxs-lookup"><span data-stu-id="30588-369">Connected System Object Type</span></span> | <span data-ttu-id="30588-370">**User**</span><span class="sxs-lookup"><span data-stu-id="30588-370">**User**</span></span> |  |
    | <span data-ttu-id="30588-371">Metaverse Object Type</span><span class="sxs-lookup"><span data-stu-id="30588-371">Metaverse Object Type</span></span> | <span data-ttu-id="30588-372">**Person**</span><span class="sxs-lookup"><span data-stu-id="30588-372">**Person**</span></span> |  |
    | <span data-ttu-id="30588-373">Link Type</span><span class="sxs-lookup"><span data-stu-id="30588-373">Link Type</span></span> | <span data-ttu-id="30588-374">**Join**</span><span class="sxs-lookup"><span data-stu-id="30588-374">**Join**</span></span> |  |
    | <span data-ttu-id="30588-375">Precedence</span><span class="sxs-lookup"><span data-stu-id="30588-375">Precedence</span></span> | <span data-ttu-id="30588-376">*Choose a number between 1–99*</span><span class="sxs-lookup"><span data-stu-id="30588-376">*Choose a number between 1–99*</span></span> | <span data-ttu-id="30588-377">1–99 is reserved for custom sync rules.</span><span class="sxs-lookup"><span data-stu-id="30588-377">1–99 is reserved for custom sync rules.</span></span> <span data-ttu-id="30588-378">Do not pick a value that is used by another synchronization rule.</span><span class="sxs-lookup"><span data-stu-id="30588-378">Do not pick a value that is used by another synchronization rule.</span></span> |

5. <span data-ttu-id="30588-379">Go to the **Scoping filter** tab and add a **single scoping filter group** with the following clause:</span><span class="sxs-lookup"><span data-stu-id="30588-379">Go to the **Scoping filter** tab and add a **single scoping filter group** with the following clause:</span></span>

    | <span data-ttu-id="30588-380">Attribute</span><span class="sxs-lookup"><span data-stu-id="30588-380">Attribute</span></span> | <span data-ttu-id="30588-381">Operator</span><span class="sxs-lookup"><span data-stu-id="30588-381">Operator</span></span> | <span data-ttu-id="30588-382">Value</span><span class="sxs-lookup"><span data-stu-id="30588-382">Value</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="30588-383">adminDescription</span><span class="sxs-lookup"><span data-stu-id="30588-383">adminDescription</span></span> | <span data-ttu-id="30588-384">NOTSTARTWITH</span><span class="sxs-lookup"><span data-stu-id="30588-384">NOTSTARTWITH</span></span> | <span data-ttu-id="30588-385">User\_</span><span class="sxs-lookup"><span data-stu-id="30588-385">User\_</span></span> |

    <span data-ttu-id="30588-386">The scoping filter determines to which on-premises AD objects this inbound synchronization rule is applied.</span><span class="sxs-lookup"><span data-stu-id="30588-386">The scoping filter determines to which on-premises AD objects this inbound synchronization rule is applied.</span></span> <span data-ttu-id="30588-387">In this example, we use the same scoping filter used in the *In from AD – User Common* out-of-box synchronization rule, which prevents the synchronization rule from being applied to User objects created through the Azure AD User writeback feature.</span><span class="sxs-lookup"><span data-stu-id="30588-387">In this example, we use the same scoping filter used in the *In from AD – User Common* out-of-box synchronization rule, which prevents the synchronization rule from being applied to User objects created through the Azure AD User writeback feature.</span></span> <span data-ttu-id="30588-388">You might need to tweak the scoping filter according to your Azure AD Connect deployment.</span><span class="sxs-lookup"><span data-stu-id="30588-388">You might need to tweak the scoping filter according to your Azure AD Connect deployment.</span></span>

6. <span data-ttu-id="30588-389">Go to the **Transformation** tab and implement the desired transformation rule.</span><span class="sxs-lookup"><span data-stu-id="30588-389">Go to the **Transformation** tab and implement the desired transformation rule.</span></span> <span data-ttu-id="30588-390">For example, if you have designated an unused on-premises AD attribute (such as extensionAttribute1) as the source attribute for the UserType, you can implement a direct attribute flow:</span><span class="sxs-lookup"><span data-stu-id="30588-390">For example, if you have designated an unused on-premises AD attribute (such as extensionAttribute1) as the source attribute for the UserType, you can implement a direct attribute flow:</span></span>

    | <span data-ttu-id="30588-391">Flow type</span><span class="sxs-lookup"><span data-stu-id="30588-391">Flow type</span></span> | <span data-ttu-id="30588-392">Target attribute</span><span class="sxs-lookup"><span data-stu-id="30588-392">Target attribute</span></span> | <span data-ttu-id="30588-393">Source</span><span class="sxs-lookup"><span data-stu-id="30588-393">Source</span></span> | <span data-ttu-id="30588-394">Apply once</span><span class="sxs-lookup"><span data-stu-id="30588-394">Apply once</span></span> | <span data-ttu-id="30588-395">Merge type</span><span class="sxs-lookup"><span data-stu-id="30588-395">Merge type</span></span> |
    | --- | --- | --- | --- | --- |
    | <span data-ttu-id="30588-396">Direct</span><span class="sxs-lookup"><span data-stu-id="30588-396">Direct</span></span> | <span data-ttu-id="30588-397">UserType</span><span class="sxs-lookup"><span data-stu-id="30588-397">UserType</span></span> | <span data-ttu-id="30588-398">extensionAttribute1</span><span class="sxs-lookup"><span data-stu-id="30588-398">extensionAttribute1</span></span> | <span data-ttu-id="30588-399">Unchecked</span><span class="sxs-lookup"><span data-stu-id="30588-399">Unchecked</span></span> | <span data-ttu-id="30588-400">Update</span><span class="sxs-lookup"><span data-stu-id="30588-400">Update</span></span> |

    <span data-ttu-id="30588-401">In another example, you want to derive the value for the UserType attribute from other properties.</span><span class="sxs-lookup"><span data-stu-id="30588-401">In another example, you want to derive the value for the UserType attribute from other properties.</span></span> <span data-ttu-id="30588-402">For example, you want to synchronize all users as Guest if their on-premises AD userPrincipalName attribute ends with domain part *@partners.fabrikam123.org*. You can implement an expression like this:</span><span class="sxs-lookup"><span data-stu-id="30588-402">For example, you want to synchronize all users as Guest if their on-premises AD userPrincipalName attribute ends with domain part *@partners.fabrikam123.org*. You can implement an expression like this:</span></span>

    | <span data-ttu-id="30588-403">Flow type</span><span class="sxs-lookup"><span data-stu-id="30588-403">Flow type</span></span> | <span data-ttu-id="30588-404">Target attribute</span><span class="sxs-lookup"><span data-stu-id="30588-404">Target attribute</span></span> | <span data-ttu-id="30588-405">Source</span><span class="sxs-lookup"><span data-stu-id="30588-405">Source</span></span> | <span data-ttu-id="30588-406">Apply once</span><span class="sxs-lookup"><span data-stu-id="30588-406">Apply once</span></span> | <span data-ttu-id="30588-407">Merge type</span><span class="sxs-lookup"><span data-stu-id="30588-407">Merge type</span></span> |
    | --- | --- | --- | --- | --- |
    | <span data-ttu-id="30588-408">Direct</span><span class="sxs-lookup"><span data-stu-id="30588-408">Direct</span></span> | <span data-ttu-id="30588-409">UserType</span><span class="sxs-lookup"><span data-stu-id="30588-409">UserType</span></span> | <span data-ttu-id="30588-410">IIF(IsPresent([userPrincipalName]),IIF(CBool(InStr(LCase([userPrincipalName]),"@partners.fabrikam123.org")=0),"Member","Guest"),Error("UserPrincipalName is not present to determine UserType"))</span><span class="sxs-lookup"><span data-stu-id="30588-410">IIF(IsPresent([userPrincipalName]),IIF(CBool(InStr(LCase([userPrincipalName]),"@partners.fabrikam123.org")=0),"Member","Guest"),Error("UserPrincipalName is not present to determine UserType"))</span></span> | <span data-ttu-id="30588-411">Unchecked</span><span class="sxs-lookup"><span data-stu-id="30588-411">Unchecked</span></span> | <span data-ttu-id="30588-412">Update</span><span class="sxs-lookup"><span data-stu-id="30588-412">Update</span></span> |

7. <span data-ttu-id="30588-413">Click **Add** to create the inbound rule.</span><span class="sxs-lookup"><span data-stu-id="30588-413">Click **Add** to create the inbound rule.</span></span>

![Create inbound synchronization rule](./media/active-directory-aadconnectsync-change-the-configuration/usertype3.png)

### <a name="step-5-create-an-outbound-synchronization-rule-to-flow-the-attribute-value-to-azure-ad"></a><span data-ttu-id="30588-415">Step 5: Create an outbound synchronization rule to flow the attribute value to Azure AD</span><span class="sxs-lookup"><span data-stu-id="30588-415">Step 5: Create an outbound synchronization rule to flow the attribute value to Azure AD</span></span>
<span data-ttu-id="30588-416">The outbound synchronization rule permits the attribute value to flow from the metaverse to the UserType attribute in Azure AD:</span><span class="sxs-lookup"><span data-stu-id="30588-416">The outbound synchronization rule permits the attribute value to flow from the metaverse to the UserType attribute in Azure AD:</span></span>

1. <span data-ttu-id="30588-417">Go to the Synchronization Rules Editor.</span><span class="sxs-lookup"><span data-stu-id="30588-417">Go to the Synchronization Rules Editor.</span></span>
2. <span data-ttu-id="30588-418">Set the search filter **Direction** to be **Outbound**.</span><span class="sxs-lookup"><span data-stu-id="30588-418">Set the search filter **Direction** to be **Outbound**.</span></span>
3. <span data-ttu-id="30588-419">Click the **Add new rule** button.</span><span class="sxs-lookup"><span data-stu-id="30588-419">Click the **Add new rule** button.</span></span>
4. <span data-ttu-id="30588-420">Under the **Description** tab, provide the following configuration:</span><span class="sxs-lookup"><span data-stu-id="30588-420">Under the **Description** tab, provide the following configuration:</span></span>

    | <span data-ttu-id="30588-421">Attribute</span><span class="sxs-lookup"><span data-stu-id="30588-421">Attribute</span></span> | <span data-ttu-id="30588-422">Value</span><span class="sxs-lookup"><span data-stu-id="30588-422">Value</span></span> | <span data-ttu-id="30588-423">Details</span><span class="sxs-lookup"><span data-stu-id="30588-423">Details</span></span> |
    | ----- | ------ | --- |
    | <span data-ttu-id="30588-424">Name</span><span class="sxs-lookup"><span data-stu-id="30588-424">Name</span></span> | <span data-ttu-id="30588-425">*Provide a name*</span><span class="sxs-lookup"><span data-stu-id="30588-425">*Provide a name*</span></span> | <span data-ttu-id="30588-426">For example, *Out to AAD – User UserType*</span><span class="sxs-lookup"><span data-stu-id="30588-426">For example, *Out to AAD – User UserType*</span></span> |
    | <span data-ttu-id="30588-427">Description</span><span class="sxs-lookup"><span data-stu-id="30588-427">Description</span></span> | <span data-ttu-id="30588-428">*Provide a description*</span><span class="sxs-lookup"><span data-stu-id="30588-428">*Provide a description*</span></span> ||
    | <span data-ttu-id="30588-429">Connected System</span><span class="sxs-lookup"><span data-stu-id="30588-429">Connected System</span></span> | <span data-ttu-id="30588-430">*Select the AAD connector*</span><span class="sxs-lookup"><span data-stu-id="30588-430">*Select the AAD connector*</span></span> ||
    | <span data-ttu-id="30588-431">Connected System Object Type</span><span class="sxs-lookup"><span data-stu-id="30588-431">Connected System Object Type</span></span> | <span data-ttu-id="30588-432">**User**</span><span class="sxs-lookup"><span data-stu-id="30588-432">**User**</span></span> ||
    | <span data-ttu-id="30588-433">Metaverse Object Type</span><span class="sxs-lookup"><span data-stu-id="30588-433">Metaverse Object Type</span></span> | <span data-ttu-id="30588-434">**Person**</span><span class="sxs-lookup"><span data-stu-id="30588-434">**Person**</span></span> ||
    | <span data-ttu-id="30588-435">Link Type</span><span class="sxs-lookup"><span data-stu-id="30588-435">Link Type</span></span> | <span data-ttu-id="30588-436">**Join**</span><span class="sxs-lookup"><span data-stu-id="30588-436">**Join**</span></span> ||
    | <span data-ttu-id="30588-437">Precedence</span><span class="sxs-lookup"><span data-stu-id="30588-437">Precedence</span></span> | <span data-ttu-id="30588-438">*Choose a number between 1–99*</span><span class="sxs-lookup"><span data-stu-id="30588-438">*Choose a number between 1–99*</span></span> | <span data-ttu-id="30588-439">1–99 is reserved for custom sync rules.</span><span class="sxs-lookup"><span data-stu-id="30588-439">1–99 is reserved for custom sync rules.</span></span> <span data-ttu-id="30588-440">Do not pick a value that is used by another synchronization rule.</span><span class="sxs-lookup"><span data-stu-id="30588-440">Do not pick a value that is used by another synchronization rule.</span></span> |

5. <span data-ttu-id="30588-441">Go to the **Scoping filter** tab and add a **single scoping filter group** with two clauses:</span><span class="sxs-lookup"><span data-stu-id="30588-441">Go to the **Scoping filter** tab and add a **single scoping filter group** with two clauses:</span></span>

    | <span data-ttu-id="30588-442">Attribute</span><span class="sxs-lookup"><span data-stu-id="30588-442">Attribute</span></span> | <span data-ttu-id="30588-443">Operator</span><span class="sxs-lookup"><span data-stu-id="30588-443">Operator</span></span> | <span data-ttu-id="30588-444">Value</span><span class="sxs-lookup"><span data-stu-id="30588-444">Value</span></span> |
    | --- | --- | --- |
    | <span data-ttu-id="30588-445">sourceObjectType</span><span class="sxs-lookup"><span data-stu-id="30588-445">sourceObjectType</span></span> | <span data-ttu-id="30588-446">EQUAL</span><span class="sxs-lookup"><span data-stu-id="30588-446">EQUAL</span></span> | <span data-ttu-id="30588-447">User</span><span class="sxs-lookup"><span data-stu-id="30588-447">User</span></span> |
    | <span data-ttu-id="30588-448">cloudMastered</span><span class="sxs-lookup"><span data-stu-id="30588-448">cloudMastered</span></span> | <span data-ttu-id="30588-449">NOTEQUAL</span><span class="sxs-lookup"><span data-stu-id="30588-449">NOTEQUAL</span></span> | <span data-ttu-id="30588-450">True</span><span class="sxs-lookup"><span data-stu-id="30588-450">True</span></span> |

    <span data-ttu-id="30588-451">The scoping filter determines to which Azure AD objects this outbound synchronization rule is applied.</span><span class="sxs-lookup"><span data-stu-id="30588-451">The scoping filter determines to which Azure AD objects this outbound synchronization rule is applied.</span></span> <span data-ttu-id="30588-452">In this example, we use the same scoping filter from the *Out to AD – User Identity* out-of-box synchronization rule.</span><span class="sxs-lookup"><span data-stu-id="30588-452">In this example, we use the same scoping filter from the *Out to AD – User Identity* out-of-box synchronization rule.</span></span> <span data-ttu-id="30588-453">It prevents the synchronization rule from being applied to User objects that are not synchronized from on-premises Active Directory.</span><span class="sxs-lookup"><span data-stu-id="30588-453">It prevents the synchronization rule from being applied to User objects that are not synchronized from on-premises Active Directory.</span></span> <span data-ttu-id="30588-454">You might need to tweak the scoping filter according to your Azure AD Connect deployment.</span><span class="sxs-lookup"><span data-stu-id="30588-454">You might need to tweak the scoping filter according to your Azure AD Connect deployment.</span></span>

6. <span data-ttu-id="30588-455">Go to the **Transformation** tab and implement the following transformation rule:</span><span class="sxs-lookup"><span data-stu-id="30588-455">Go to the **Transformation** tab and implement the following transformation rule:</span></span>

    | <span data-ttu-id="30588-456">Flow type</span><span class="sxs-lookup"><span data-stu-id="30588-456">Flow type</span></span> | <span data-ttu-id="30588-457">Target attribute</span><span class="sxs-lookup"><span data-stu-id="30588-457">Target attribute</span></span> | <span data-ttu-id="30588-458">Source</span><span class="sxs-lookup"><span data-stu-id="30588-458">Source</span></span> | <span data-ttu-id="30588-459">Apply once</span><span class="sxs-lookup"><span data-stu-id="30588-459">Apply once</span></span> | <span data-ttu-id="30588-460">Merge type</span><span class="sxs-lookup"><span data-stu-id="30588-460">Merge type</span></span> |
    | --- | --- | --- | --- | --- |
    | <span data-ttu-id="30588-461">Direct</span><span class="sxs-lookup"><span data-stu-id="30588-461">Direct</span></span> | <span data-ttu-id="30588-462">UserType</span><span class="sxs-lookup"><span data-stu-id="30588-462">UserType</span></span> | <span data-ttu-id="30588-463">UserType</span><span class="sxs-lookup"><span data-stu-id="30588-463">UserType</span></span> | <span data-ttu-id="30588-464">Unchecked</span><span class="sxs-lookup"><span data-stu-id="30588-464">Unchecked</span></span> | <span data-ttu-id="30588-465">Update</span><span class="sxs-lookup"><span data-stu-id="30588-465">Update</span></span> |

7. <span data-ttu-id="30588-466">Click **Add** to create the outbound rule.</span><span class="sxs-lookup"><span data-stu-id="30588-466">Click **Add** to create the outbound rule.</span></span>

![Create outbound synchronization rule](./media/active-directory-aadconnectsync-change-the-configuration/usertype4.png)

### <a name="step-6-run-a-full-synchronization-cycle"></a><span data-ttu-id="30588-468">Step 6: Run a full synchronization cycle</span><span class="sxs-lookup"><span data-stu-id="30588-468">Step 6: Run a full synchronization cycle</span></span>
<span data-ttu-id="30588-469">In general, a full synchronization cycle is required because we have added new attributes to both the Active Directory and Azure AD Connector schemas, and introduced custom synchronization rules.</span><span class="sxs-lookup"><span data-stu-id="30588-469">In general, a full synchronization cycle is required because we have added new attributes to both the Active Directory and Azure AD Connector schemas, and introduced custom synchronization rules.</span></span> <span data-ttu-id="30588-470">You want to verify the changes before exporting them to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="30588-470">You want to verify the changes before exporting them to Azure AD.</span></span> 

<span data-ttu-id="30588-471">You can use the following steps to verify the changes while manually running the steps that make up a full synchronization cycle.</span><span class="sxs-lookup"><span data-stu-id="30588-471">You can use the following steps to verify the changes while manually running the steps that make up a full synchronization cycle.</span></span>

1. <span data-ttu-id="30588-472">Run a **Full import** on the **on-premises AD Connector**:</span><span class="sxs-lookup"><span data-stu-id="30588-472">Run a **Full import** on the **on-premises AD Connector**:</span></span>

   1. <span data-ttu-id="30588-473">Go to the **Operations** tab in the Synchronization Service Manager.</span><span class="sxs-lookup"><span data-stu-id="30588-473">Go to the **Operations** tab in the Synchronization Service Manager.</span></span>
   2. <span data-ttu-id="30588-474">Right-click the **on-premises AD Connector** and select **Run**.</span><span class="sxs-lookup"><span data-stu-id="30588-474">Right-click the **on-premises AD Connector** and select **Run**.</span></span>
   3. <span data-ttu-id="30588-475">In the pop-up dialog box, select **Full Import** and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="30588-475">In the pop-up dialog box, select **Full Import** and then click **OK**.</span></span>
   4. <span data-ttu-id="30588-476">Wait for the operation to finish.</span><span class="sxs-lookup"><span data-stu-id="30588-476">Wait for the operation to finish.</span></span>

    > [!NOTE]
    > <span data-ttu-id="30588-477">You can skip a full import on the on-premises AD Connector if the source attribute is already included in the list of imported attributes.</span><span class="sxs-lookup"><span data-stu-id="30588-477">You can skip a full import on the on-premises AD Connector if the source attribute is already included in the list of imported attributes.</span></span> <span data-ttu-id="30588-478">In other words, you did not have to make any changes during [Step 2: Add the source attribute to the on-premises AD Connector schema](#step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema).</span><span class="sxs-lookup"><span data-stu-id="30588-478">In other words, you did not have to make any changes during [Step 2: Add the source attribute to the on-premises AD Connector schema](#step-2-add-the-source-attribute-to-the-on-premises-ad-connector-schema).</span></span>

2. <span data-ttu-id="30588-479">Run a **Full import** on the **Azure AD Connector**:</span><span class="sxs-lookup"><span data-stu-id="30588-479">Run a **Full import** on the **Azure AD Connector**:</span></span>

   1. <span data-ttu-id="30588-480">Right-click the **Azure AD Connector** and select **Run**.</span><span class="sxs-lookup"><span data-stu-id="30588-480">Right-click the **Azure AD Connector** and select **Run**.</span></span>
   2. <span data-ttu-id="30588-481">In the pop-up dialog box, select **Full Import** and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="30588-481">In the pop-up dialog box, select **Full Import** and then click **OK**.</span></span>
   3. <span data-ttu-id="30588-482">Wait for the operation to finish.</span><span class="sxs-lookup"><span data-stu-id="30588-482">Wait for the operation to finish.</span></span>

3. <span data-ttu-id="30588-483">Verify the synchronization rule changes on an existing User object:</span><span class="sxs-lookup"><span data-stu-id="30588-483">Verify the synchronization rule changes on an existing User object:</span></span>

    <span data-ttu-id="30588-484">The source attribute from on-premises Active Directory and the UserType from Azure AD have been imported into their respective Connector Spaces.</span><span class="sxs-lookup"><span data-stu-id="30588-484">The source attribute from on-premises Active Directory and the UserType from Azure AD have been imported into their respective Connector Spaces.</span></span> <span data-ttu-id="30588-485">Before proceeding with a full synchronization, do a **Preview** on an existing User object in the on-premises AD Connector Space.</span><span class="sxs-lookup"><span data-stu-id="30588-485">Before proceeding with a full synchronization, do a **Preview** on an existing User object in the on-premises AD Connector Space.</span></span> <span data-ttu-id="30588-486">The object you chose should have the source attribute populated.</span><span class="sxs-lookup"><span data-stu-id="30588-486">The object you chose should have the source attribute populated.</span></span>
    
    <span data-ttu-id="30588-487">A successful **Preview** with the UserType populated in the metaverse is a good indicator that you have configured the synchronization rules correctly.</span><span class="sxs-lookup"><span data-stu-id="30588-487">A successful **Preview** with the UserType populated in the metaverse is a good indicator that you have configured the synchronization rules correctly.</span></span> <span data-ttu-id="30588-488">For information about how to do a **Preview**, refer to the section [Verify the change](#verify-the-change).</span><span class="sxs-lookup"><span data-stu-id="30588-488">For information about how to do a **Preview**, refer to the section [Verify the change](#verify-the-change).</span></span>

4. <span data-ttu-id="30588-489">Run a **Full Synchronization** on the **on-premises AD Connector**:</span><span class="sxs-lookup"><span data-stu-id="30588-489">Run a **Full Synchronization** on the **on-premises AD Connector**:</span></span>

   1. <span data-ttu-id="30588-490">Right-click the **on-premises AD Connector** and select **Run**.</span><span class="sxs-lookup"><span data-stu-id="30588-490">Right-click the **on-premises AD Connector** and select **Run**.</span></span>
   2. <span data-ttu-id="30588-491">In the pop-up dialog box, select **Full Synchronization** and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="30588-491">In the pop-up dialog box, select **Full Synchronization** and then click **OK**.</span></span>
   3. <span data-ttu-id="30588-492">Wait for the operation to finish.</span><span class="sxs-lookup"><span data-stu-id="30588-492">Wait for the operation to finish.</span></span>

5. <span data-ttu-id="30588-493">Verify **Pending Exports** to Azure AD:</span><span class="sxs-lookup"><span data-stu-id="30588-493">Verify **Pending Exports** to Azure AD:</span></span>

   1. <span data-ttu-id="30588-494">Right-click the **Azure AD Connector** and select **Search Connector Space**.</span><span class="sxs-lookup"><span data-stu-id="30588-494">Right-click the **Azure AD Connector** and select **Search Connector Space**.</span></span>
   2. <span data-ttu-id="30588-495">In the **Search Connector Space** pop-up dialog box:</span><span class="sxs-lookup"><span data-stu-id="30588-495">In the **Search Connector Space** pop-up dialog box:</span></span>

      - <span data-ttu-id="30588-496">Set **Scope** to **Pending Export**.</span><span class="sxs-lookup"><span data-stu-id="30588-496">Set **Scope** to **Pending Export**.</span></span>
      - <span data-ttu-id="30588-497">Select all three check boxes: **Add**, **Modify**, and **Delete**.</span><span class="sxs-lookup"><span data-stu-id="30588-497">Select all three check boxes: **Add**, **Modify**, and **Delete**.</span></span>
      - <span data-ttu-id="30588-498">Click the **Search** button to get the list of objects with changes to be exported.</span><span class="sxs-lookup"><span data-stu-id="30588-498">Click the **Search** button to get the list of objects with changes to be exported.</span></span> <span data-ttu-id="30588-499">To examine the changes for a given object, double-click the object.</span><span class="sxs-lookup"><span data-stu-id="30588-499">To examine the changes for a given object, double-click the object.</span></span>
      - <span data-ttu-id="30588-500">Verify that the changes are expected.</span><span class="sxs-lookup"><span data-stu-id="30588-500">Verify that the changes are expected.</span></span>

6. <span data-ttu-id="30588-501">Run **Export** on the **Azure AD Connector**:</span><span class="sxs-lookup"><span data-stu-id="30588-501">Run **Export** on the **Azure AD Connector**:</span></span>

   1. <span data-ttu-id="30588-502">Right-click the **Azure AD Connector** and select **Run**.</span><span class="sxs-lookup"><span data-stu-id="30588-502">Right-click the **Azure AD Connector** and select **Run**.</span></span>
   2. <span data-ttu-id="30588-503">In the **Run Connector** pop-up dialog box, select **Export** and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="30588-503">In the **Run Connector** pop-up dialog box, select **Export** and then click **OK**.</span></span>
   3. <span data-ttu-id="30588-504">Wait for the export to Azure AD to finish.</span><span class="sxs-lookup"><span data-stu-id="30588-504">Wait for the export to Azure AD to finish.</span></span>

> [!NOTE]
> <span data-ttu-id="30588-505">These steps do not include the full synchronization and export steps on the Azure AD Connector.</span><span class="sxs-lookup"><span data-stu-id="30588-505">These steps do not include the full synchronization and export steps on the Azure AD Connector.</span></span> <span data-ttu-id="30588-506">These steps are not required because the attribute values are flowing from on-premises Active Directory to Azure AD only.</span><span class="sxs-lookup"><span data-stu-id="30588-506">These steps are not required because the attribute values are flowing from on-premises Active Directory to Azure AD only.</span></span>

### <a name="step-7-re-enable-the-sync-scheduler"></a><span data-ttu-id="30588-507">Step 7: Re-enable the sync scheduler</span><span class="sxs-lookup"><span data-stu-id="30588-507">Step 7: Re-enable the sync scheduler</span></span>
<span data-ttu-id="30588-508">Re-enable the built-in sync scheduler:</span><span class="sxs-lookup"><span data-stu-id="30588-508">Re-enable the built-in sync scheduler:</span></span>

1. <span data-ttu-id="30588-509">Start a PowerShell session.</span><span class="sxs-lookup"><span data-stu-id="30588-509">Start a PowerShell session.</span></span>
2. <span data-ttu-id="30588-510">Re-enable scheduled synchronization by running the cmdlet `Set-ADSyncScheduler -SyncCycleEnabled $true`.</span><span class="sxs-lookup"><span data-stu-id="30588-510">Re-enable scheduled synchronization by running the cmdlet `Set-ADSyncScheduler -SyncCycleEnabled $true`.</span></span>


## <a name="next-steps"></a><span data-ttu-id="30588-511">Next steps</span><span class="sxs-lookup"><span data-stu-id="30588-511">Next steps</span></span>
* <span data-ttu-id="30588-512">Read more about the configuration model in [Understanding Declarative Provisioning](active-directory-aadconnectsync-understanding-declarative-provisioning.md).</span><span class="sxs-lookup"><span data-stu-id="30588-512">Read more about the configuration model in [Understanding Declarative Provisioning](active-directory-aadconnectsync-understanding-declarative-provisioning.md).</span></span>
* <span data-ttu-id="30588-513">Read more about the expression language in [Understanding Declarative Provisioning Expressions](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="30588-513">Read more about the expression language in [Understanding Declarative Provisioning Expressions](active-directory-aadconnectsync-understanding-declarative-provisioning-expressions.md).</span></span>

<span data-ttu-id="30588-514">**Overview topics**</span><span class="sxs-lookup"><span data-stu-id="30588-514">**Overview topics**</span></span>

* [<span data-ttu-id="30588-515">Azure AD Connect sync: Understand and customize synchronization</span><span class="sxs-lookup"><span data-stu-id="30588-515">Azure AD Connect sync: Understand and customize synchronization</span></span>](active-directory-aadconnectsync-whatis.md)
* [<span data-ttu-id="30588-516">Integrating your on-premises identities with Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="30588-516">Integrating your on-premises identities with Azure Active Directory</span></span>](active-directory-aadconnect.md)
