---
title: Azure AD Connect - Manage AD FS trust with Azure AD using Azure AD Connect | Microsoft Docs
description: Operational details of Azure AD trust handling by Azure AD connect.
keywords: AD FS, ADFS, AD FS management, AAD Connect, Connect, Azure AD, trust, AAD, claim, claim, claim rules, issuance, transform, rules, backup, restore
services: active-directory
documentationcenter: ''
ms.reviewer: anandyadavmsft
manager: mtillman
ms.component: hybrid
ms.assetid: 2593b6c6-dc3f-46ef-8e02-a8e2dc4e9fb9
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/28/2018
ms.author: billmath
author: billmath
ms.custom: ''
ms.openlocfilehash: a037414f16c3986370557f389328d36788e2c292
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44867180"
---
# <a name="manage-ad-fs-trust-with-azure-ad-using-azure-ad-connect"></a><span data-ttu-id="35ce9-104">Manage AD FS trust with Azure AD using Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="35ce9-104">Manage AD FS trust with Azure AD using Azure AD Connect</span></span>

## <a name="overview"></a><span data-ttu-id="35ce9-105">Overview</span><span class="sxs-lookup"><span data-stu-id="35ce9-105">Overview</span></span>

<span data-ttu-id="35ce9-106">Azure AD Connect can manage federation between on-premises Active Directory Federation Service (AD FS) and Azure AD.</span><span class="sxs-lookup"><span data-stu-id="35ce9-106">Azure AD Connect can manage federation between on-premises Active Directory Federation Service (AD FS) and Azure AD.</span></span> <span data-ttu-id="35ce9-107">This article provides an overview of:</span><span class="sxs-lookup"><span data-stu-id="35ce9-107">This article provides an overview of:</span></span>

* <span data-ttu-id="35ce9-108">The various settings configured on the trust by Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="35ce9-108">The various settings configured on the trust by Azure AD Connect</span></span>
* <span data-ttu-id="35ce9-109">The issuance transform rules (claim rules) set by Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="35ce9-109">The issuance transform rules (claim rules) set by Azure AD Connect</span></span>
* <span data-ttu-id="35ce9-110">How to back-up and restore your claim rules between upgrades and configuration updates.</span><span class="sxs-lookup"><span data-stu-id="35ce9-110">How to back-up and restore your claim rules between upgrades and configuration updates.</span></span> 

## <a name="settings-controlled-by-azure-ad-connect"></a><span data-ttu-id="35ce9-111">Settings controlled by Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="35ce9-111">Settings controlled by Azure AD Connect</span></span>

<span data-ttu-id="35ce9-112">Azure AD Connect manages **only** settings related to Azure AD trust.</span><span class="sxs-lookup"><span data-stu-id="35ce9-112">Azure AD Connect manages **only** settings related to Azure AD trust.</span></span> <span data-ttu-id="35ce9-113">Azure AD Connect does not modify any settings on other relying party trusts in AD FS.</span><span class="sxs-lookup"><span data-stu-id="35ce9-113">Azure AD Connect does not modify any settings on other relying party trusts in AD FS.</span></span> <span data-ttu-id="35ce9-114">The following table indicates settings that are controlled by Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="35ce9-114">The following table indicates settings that are controlled by Azure AD Connect.</span></span>

| <span data-ttu-id="35ce9-115">Setting</span><span class="sxs-lookup"><span data-stu-id="35ce9-115">Setting</span></span> | <span data-ttu-id="35ce9-116">Description</span><span class="sxs-lookup"><span data-stu-id="35ce9-116">Description</span></span> |
| :--- | :--- |
| <span data-ttu-id="35ce9-117">Token signing certificate</span><span class="sxs-lookup"><span data-stu-id="35ce9-117">Token signing certificate</span></span> | <span data-ttu-id="35ce9-118">Azure AD Connect can be used to reset and recreate the trust with Azure AD.</span><span class="sxs-lookup"><span data-stu-id="35ce9-118">Azure AD Connect can be used to reset and recreate the trust with Azure AD.</span></span> <span data-ttu-id="35ce9-119">Azure AD Connect does a one-time immediate rollover of token signing certificates for AD FS and updates the Azure AD domain federation settings.</span><span class="sxs-lookup"><span data-stu-id="35ce9-119">Azure AD Connect does a one-time immediate rollover of token signing certificates for AD FS and updates the Azure AD domain federation settings.</span></span>|
| <span data-ttu-id="35ce9-120">Token signing algorithm</span><span class="sxs-lookup"><span data-stu-id="35ce9-120">Token signing algorithm</span></span> | <span data-ttu-id="35ce9-121">Microsoft recommends using SHA-256 as the token signing algorithm.</span><span class="sxs-lookup"><span data-stu-id="35ce9-121">Microsoft recommends using SHA-256 as the token signing algorithm.</span></span> <span data-ttu-id="35ce9-122">Azure AD Connect can detect if the token signing algorithm is set to a value less secure than SHA-256.</span><span class="sxs-lookup"><span data-stu-id="35ce9-122">Azure AD Connect can detect if the token signing algorithm is set to a value less secure than SHA-256.</span></span> <span data-ttu-id="35ce9-123">It will update the setting to SHA-256 in the next possible configuration operation.</span><span class="sxs-lookup"><span data-stu-id="35ce9-123">It will update the setting to SHA-256 in the next possible configuration operation.</span></span> |
| <span data-ttu-id="35ce9-124">Azure AD trust identifier</span><span class="sxs-lookup"><span data-stu-id="35ce9-124">Azure AD trust identifier</span></span> | <span data-ttu-id="35ce9-125">Azure AD Connect sets the correct identifier value for the Azure AD trust.</span><span class="sxs-lookup"><span data-stu-id="35ce9-125">Azure AD Connect sets the correct identifier value for the Azure AD trust.</span></span> <span data-ttu-id="35ce9-126">AD FS uniquely identifies the Azure AD trust using the identifier value.</span><span class="sxs-lookup"><span data-stu-id="35ce9-126">AD FS uniquely identifies the Azure AD trust using the identifier value.</span></span> |
| <span data-ttu-id="35ce9-127">Azure AD endpoints</span><span class="sxs-lookup"><span data-stu-id="35ce9-127">Azure AD endpoints</span></span> | <span data-ttu-id="35ce9-128">Azure AD Connect makes sure that the endpoints configured for the Azure AD trust are always as per the latest recommended values for resiliency and performance.</span><span class="sxs-lookup"><span data-stu-id="35ce9-128">Azure AD Connect makes sure that the endpoints configured for the Azure AD trust are always as per the latest recommended values for resiliency and performance.</span></span> |
| <span data-ttu-id="35ce9-129">Issuance transform rules</span><span class="sxs-lookup"><span data-stu-id="35ce9-129">Issuance transform rules</span></span> | <span data-ttu-id="35ce9-130">There are numbers of claim rules which are needed for optimal performance of features of Azure AD in a federated setting.</span><span class="sxs-lookup"><span data-stu-id="35ce9-130">There are numbers of claim rules which are needed for optimal performance of features of Azure AD in a federated setting.</span></span> <span data-ttu-id="35ce9-131">Azure AD Connect makes sure that the Azure AD trust is always configured with the right set of recommended claim rules.</span><span class="sxs-lookup"><span data-stu-id="35ce9-131">Azure AD Connect makes sure that the Azure AD trust is always configured with the right set of recommended claim rules.</span></span> |
| <span data-ttu-id="35ce9-132">Alternate-id</span><span class="sxs-lookup"><span data-stu-id="35ce9-132">Alternate-id</span></span> | <span data-ttu-id="35ce9-133">If sync is configured to use alternate-id, Azure AD Connect configures AD FS to perform authentication using alternate-id.</span><span class="sxs-lookup"><span data-stu-id="35ce9-133">If sync is configured to use alternate-id, Azure AD Connect configures AD FS to perform authentication using alternate-id.</span></span> |
| <span data-ttu-id="35ce9-134">Automatic metadata update</span><span class="sxs-lookup"><span data-stu-id="35ce9-134">Automatic metadata update</span></span> | <span data-ttu-id="35ce9-135">Trust with Azure AD is configured for automatic metadata update.</span><span class="sxs-lookup"><span data-stu-id="35ce9-135">Trust with Azure AD is configured for automatic metadata update.</span></span> <span data-ttu-id="35ce9-136">AD FS periodically checks the metadata of Azure AD trust and keeps it up-to-date in case it changes on the Azure AD side.</span><span class="sxs-lookup"><span data-stu-id="35ce9-136">AD FS periodically checks the metadata of Azure AD trust and keeps it up-to-date in case it changes on the Azure AD side.</span></span> |
| <span data-ttu-id="35ce9-137">Integrated Windows Authentication (IWA)</span><span class="sxs-lookup"><span data-stu-id="35ce9-137">Integrated Windows Authentication (IWA)</span></span> | <span data-ttu-id="35ce9-138">During Hybrid Azure AD join operation, IWA is enabled for device registration to facilitate Hybrid Azure AD join for downlevel devices</span><span class="sxs-lookup"><span data-stu-id="35ce9-138">During Hybrid Azure AD join operation, IWA is enabled for device registration to facilitate Hybrid Azure AD join for downlevel devices</span></span> |

## <a name="execution-flows-and-federation-settings-configured-by-azure-ad-connect"></a><span data-ttu-id="35ce9-139">Execution flows and federation settings configured by Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="35ce9-139">Execution flows and federation settings configured by Azure AD Connect</span></span>

<span data-ttu-id="35ce9-140">Azure AD connect does not update all settings for Azure AD trust during configuration flows.</span><span class="sxs-lookup"><span data-stu-id="35ce9-140">Azure AD connect does not update all settings for Azure AD trust during configuration flows.</span></span> <span data-ttu-id="35ce9-141">The settings modified depend on which task or execution flow is being executed.</span><span class="sxs-lookup"><span data-stu-id="35ce9-141">The settings modified depend on which task or execution flow is being executed.</span></span> <span data-ttu-id="35ce9-142">The following table lists the settings impacted in different execution flows.</span><span class="sxs-lookup"><span data-stu-id="35ce9-142">The following table lists the settings impacted in different execution flows.</span></span>

| <span data-ttu-id="35ce9-143">Execution flow</span><span class="sxs-lookup"><span data-stu-id="35ce9-143">Execution flow</span></span> | <span data-ttu-id="35ce9-144">Settings impacted</span><span class="sxs-lookup"><span data-stu-id="35ce9-144">Settings impacted</span></span> |
| :--- | :--- |
| <span data-ttu-id="35ce9-145">First pass installation (express)</span><span class="sxs-lookup"><span data-stu-id="35ce9-145">First pass installation (express)</span></span> | <span data-ttu-id="35ce9-146">None</span><span class="sxs-lookup"><span data-stu-id="35ce9-146">None</span></span> |
| <span data-ttu-id="35ce9-147">First pass installation (new AD FS farm)</span><span class="sxs-lookup"><span data-stu-id="35ce9-147">First pass installation (new AD FS farm)</span></span> | <span data-ttu-id="35ce9-148">A new AD FS farm is created and a trust with Azure AD is created from scratch.</span><span class="sxs-lookup"><span data-stu-id="35ce9-148">A new AD FS farm is created and a trust with Azure AD is created from scratch.</span></span> |
| <span data-ttu-id="35ce9-149">First pass installation (existing AD FS farm, existing Azure AD trust)</span><span class="sxs-lookup"><span data-stu-id="35ce9-149">First pass installation (existing AD FS farm, existing Azure AD trust)</span></span> | <span data-ttu-id="35ce9-150">Azure AD trust identifier, Issuance transform rules, Azure AD endpoints, Alternate-id (if necessary), automatic metadata update</span><span class="sxs-lookup"><span data-stu-id="35ce9-150">Azure AD trust identifier, Issuance transform rules, Azure AD endpoints, Alternate-id (if necessary), automatic metadata update</span></span> |
| <span data-ttu-id="35ce9-151">Reset Azure AD trust</span><span class="sxs-lookup"><span data-stu-id="35ce9-151">Reset Azure AD trust</span></span> | <span data-ttu-id="35ce9-152">Token signing certificate, Token signing algorithm, Azure AD trust identifier, Issuance transform rules, Azure AD endpoints, Alternate-id (if necessary), automatic metadata update</span><span class="sxs-lookup"><span data-stu-id="35ce9-152">Token signing certificate, Token signing algorithm, Azure AD trust identifier, Issuance transform rules, Azure AD endpoints, Alternate-id (if necessary), automatic metadata update</span></span> |
| <span data-ttu-id="35ce9-153">Add federation server</span><span class="sxs-lookup"><span data-stu-id="35ce9-153">Add federation server</span></span> | <span data-ttu-id="35ce9-154">None</span><span class="sxs-lookup"><span data-stu-id="35ce9-154">None</span></span> |
| <span data-ttu-id="35ce9-155">Add WAP server</span><span class="sxs-lookup"><span data-stu-id="35ce9-155">Add WAP server</span></span> | <span data-ttu-id="35ce9-156">None</span><span class="sxs-lookup"><span data-stu-id="35ce9-156">None</span></span> |
| <span data-ttu-id="35ce9-157">Device options</span><span class="sxs-lookup"><span data-stu-id="35ce9-157">Device options</span></span> | <span data-ttu-id="35ce9-158">Issuance transform rules, IWA for device registration</span><span class="sxs-lookup"><span data-stu-id="35ce9-158">Issuance transform rules, IWA for device registration</span></span> |
| <span data-ttu-id="35ce9-159">Add federated domain</span><span class="sxs-lookup"><span data-stu-id="35ce9-159">Add federated domain</span></span> | <span data-ttu-id="35ce9-160">If the domain is being added for the first time, that is, the setup is changing from single domain federation to multi-domain federation – Azure AD Connect will recreate the trust from scratch.</span><span class="sxs-lookup"><span data-stu-id="35ce9-160">If the domain is being added for the first time, that is, the setup is changing from single domain federation to multi-domain federation – Azure AD Connect will recreate the trust from scratch.</span></span> <span data-ttu-id="35ce9-161">If the trust with Azure AD is already configured for multiple domains, only Issuance transform rules are modified</span><span class="sxs-lookup"><span data-stu-id="35ce9-161">If the trust with Azure AD is already configured for multiple domains, only Issuance transform rules are modified</span></span> |
| <span data-ttu-id="35ce9-162">Update SSL</span><span class="sxs-lookup"><span data-stu-id="35ce9-162">Update SSL</span></span> | <span data-ttu-id="35ce9-163">None</span><span class="sxs-lookup"><span data-stu-id="35ce9-163">None</span></span> |

<span data-ttu-id="35ce9-164">During all operations, in which, any setting is modified, Azure AD Connect makes a backup of the current trust settings at **%ProgramData%\AADConnect\ADFS**</span><span class="sxs-lookup"><span data-stu-id="35ce9-164">During all operations, in which, any setting is modified, Azure AD Connect makes a backup of the current trust settings at **%ProgramData%\AADConnect\ADFS**</span></span>

![Azure AD Connect page showing message about existing Azure AD trust backup](media/active-directory-azure-ad-connect-azure-ad-trust/backup2.png)

> [!NOTE]
> <span data-ttu-id="35ce9-166">Prior to version 1.1.873.0, the backup consisted of only issuance transform rules and they were backed up in the wizard trace log file.</span><span class="sxs-lookup"><span data-stu-id="35ce9-166">Prior to version 1.1.873.0, the backup consisted of only issuance transform rules and they were backed up in the wizard trace log file.</span></span>

## <a name="issuance-transform-rules-set-by-azure-ad-connect"></a><span data-ttu-id="35ce9-167">Issuance transform rules set by Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="35ce9-167">Issuance transform rules set by Azure AD Connect</span></span>

<span data-ttu-id="35ce9-168">Azure AD Connect makes sure that the Azure AD trust is always configured with the right set of recommended claim rules.</span><span class="sxs-lookup"><span data-stu-id="35ce9-168">Azure AD Connect makes sure that the Azure AD trust is always configured with the right set of recommended claim rules.</span></span> <span data-ttu-id="35ce9-169">Microsoft recommends using Azure AD connect for managing your Azure AD trust.</span><span class="sxs-lookup"><span data-stu-id="35ce9-169">Microsoft recommends using Azure AD connect for managing your Azure AD trust.</span></span> <span data-ttu-id="35ce9-170">This section lists the issuance transform rules set and their description.</span><span class="sxs-lookup"><span data-stu-id="35ce9-170">This section lists the issuance transform rules set and their description.</span></span>

| <span data-ttu-id="35ce9-171">Rule name</span><span class="sxs-lookup"><span data-stu-id="35ce9-171">Rule name</span></span> | <span data-ttu-id="35ce9-172">Description</span><span class="sxs-lookup"><span data-stu-id="35ce9-172">Description</span></span> |
| --- | --- |
| <span data-ttu-id="35ce9-173">Issue UPN</span><span class="sxs-lookup"><span data-stu-id="35ce9-173">Issue UPN</span></span> | <span data-ttu-id="35ce9-174">This rule queries the value of userprincipalname as from the attribute configured in sync settings for userprincipalname.</span><span class="sxs-lookup"><span data-stu-id="35ce9-174">This rule queries the value of userprincipalname as from the attribute configured in sync settings for userprincipalname.</span></span>|
| <span data-ttu-id="35ce9-175">Query objectguid and msdsconsistencyguid for custom ImmutableId claim</span><span class="sxs-lookup"><span data-stu-id="35ce9-175">Query objectguid and msdsconsistencyguid for custom ImmutableId claim</span></span> | <span data-ttu-id="35ce9-176">This rule adds a temporary value in the pipeline for objectguid and msdsconsistencyguid value if it exists</span><span class="sxs-lookup"><span data-stu-id="35ce9-176">This rule adds a temporary value in the pipeline for objectguid and msdsconsistencyguid value if it exists</span></span> |
| <span data-ttu-id="35ce9-177">Check for the existence of msdsconsistencyguid</span><span class="sxs-lookup"><span data-stu-id="35ce9-177">Check for the existence of msdsconsistencyguid</span></span> | <span data-ttu-id="35ce9-178">Based on whether the value for msdsconsistencyguid exists or not, we set a temporary flag to direct what to use as ImmutableId</span><span class="sxs-lookup"><span data-stu-id="35ce9-178">Based on whether the value for msdsconsistencyguid exists or not, we set a temporary flag to direct what to use as ImmutableId</span></span> |
| <span data-ttu-id="35ce9-179">Issue msdsconsistencyguid as Immutable ID if it exists</span><span class="sxs-lookup"><span data-stu-id="35ce9-179">Issue msdsconsistencyguid as Immutable ID if it exists</span></span> | <span data-ttu-id="35ce9-180">Issue msdsconsistencyguid as ImmutableId if the value exists</span><span class="sxs-lookup"><span data-stu-id="35ce9-180">Issue msdsconsistencyguid as ImmutableId if the value exists</span></span> |
| <span data-ttu-id="35ce9-181">Issue objectGuidRule if msdsConsistencyGuid rule does not exist</span><span class="sxs-lookup"><span data-stu-id="35ce9-181">Issue objectGuidRule if msdsConsistencyGuid rule does not exist</span></span> | <span data-ttu-id="35ce9-182">If the value for msdsconsistencyguid does not exist, the value of objectguid will be issued as ImmutableId</span><span class="sxs-lookup"><span data-stu-id="35ce9-182">If the value for msdsconsistencyguid does not exist, the value of objectguid will be issued as ImmutableId</span></span> |
| <span data-ttu-id="35ce9-183">Issue nameidentifier</span><span class="sxs-lookup"><span data-stu-id="35ce9-183">Issue nameidentifier</span></span> | <span data-ttu-id="35ce9-184">This rule issues value for the nameidentifier claim.</span><span class="sxs-lookup"><span data-stu-id="35ce9-184">This rule issues value for the nameidentifier claim.</span></span>|
| <span data-ttu-id="35ce9-185">Issue accounttype for domain-joined computers</span><span class="sxs-lookup"><span data-stu-id="35ce9-185">Issue accounttype for domain-joined computers</span></span> | <span data-ttu-id="35ce9-186">If the entity being authenticated is a domain joined device, this rule issues the account type as DJ signifying a domain joined device</span><span class="sxs-lookup"><span data-stu-id="35ce9-186">If the entity being authenticated is a domain joined device, this rule issues the account type as DJ signifying a domain joined device</span></span> |
| <span data-ttu-id="35ce9-187">Issue AccountType with the value USER when it is not a computer account</span><span class="sxs-lookup"><span data-stu-id="35ce9-187">Issue AccountType with the value USER when it is not a computer account</span></span> | <span data-ttu-id="35ce9-188">If the entity being authenticated is a user, this rule issues the account type as User</span><span class="sxs-lookup"><span data-stu-id="35ce9-188">If the entity being authenticated is a user, this rule issues the account type as User</span></span> |
| <span data-ttu-id="35ce9-189">Issue issuerid when it is not a computer account</span><span class="sxs-lookup"><span data-stu-id="35ce9-189">Issue issuerid when it is not a computer account</span></span> | <span data-ttu-id="35ce9-190">This rule issues the issuerId value when the authenticating entity is not a device.</span><span class="sxs-lookup"><span data-stu-id="35ce9-190">This rule issues the issuerId value when the authenticating entity is not a device.</span></span> <span data-ttu-id="35ce9-191">The value is created via a regex, which is configured by Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="35ce9-191">The value is created via a regex, which is configured by Azure AD Connect.</span></span> <span data-ttu-id="35ce9-192">The regex is created after taking into consideration all the domains federated using Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="35ce9-192">The regex is created after taking into consideration all the domains federated using Azure AD Connect.</span></span> |
| <span data-ttu-id="35ce9-193">Issue issuerid for DJ computer auth</span><span class="sxs-lookup"><span data-stu-id="35ce9-193">Issue issuerid for DJ computer auth</span></span> | <span data-ttu-id="35ce9-194">This rule issues the issuerId value when the authenticating entity is a device</span><span class="sxs-lookup"><span data-stu-id="35ce9-194">This rule issues the issuerId value when the authenticating entity is a device</span></span> |
| <span data-ttu-id="35ce9-195">Issue onpremobjectguid for domain-joined computers</span><span class="sxs-lookup"><span data-stu-id="35ce9-195">Issue onpremobjectguid for domain-joined computers</span></span> | <span data-ttu-id="35ce9-196">If the entity being authenticated is a domain joined device, this rule issues the on-premises objectguid for the device</span><span class="sxs-lookup"><span data-stu-id="35ce9-196">If the entity being authenticated is a domain joined device, this rule issues the on-premises objectguid for the device</span></span> |
| <span data-ttu-id="35ce9-197">Pass through primary SID</span><span class="sxs-lookup"><span data-stu-id="35ce9-197">Pass through primary SID</span></span> | <span data-ttu-id="35ce9-198">This rule issues the primary SID of the authenticating entity</span><span class="sxs-lookup"><span data-stu-id="35ce9-198">This rule issues the primary SID of the authenticating entity</span></span> |
| <span data-ttu-id="35ce9-199">Pass through claim - insideCorporateNetwork</span><span class="sxs-lookup"><span data-stu-id="35ce9-199">Pass through claim - insideCorporateNetwork</span></span> | <span data-ttu-id="35ce9-200">This rule issues a claim that helps Azure AD know if the authentication is coming from inside corporate network or externally</span><span class="sxs-lookup"><span data-stu-id="35ce9-200">This rule issues a claim that helps Azure AD know if the authentication is coming from inside corporate network or externally</span></span> |
| <span data-ttu-id="35ce9-201">Pass Through Claim – Psso</span><span class="sxs-lookup"><span data-stu-id="35ce9-201">Pass Through Claim – Psso</span></span> |   |
| <span data-ttu-id="35ce9-202">Issue Password Expiry Claims</span><span class="sxs-lookup"><span data-stu-id="35ce9-202">Issue Password Expiry Claims</span></span> | <span data-ttu-id="35ce9-203">This rule issues three claims for password expiration time, number of days for the password to expire of the entity being authenticated and URL where to route for changing the password.</span><span class="sxs-lookup"><span data-stu-id="35ce9-203">This rule issues three claims for password expiration time, number of days for the password to expire of the entity being authenticated and URL where to route for changing the password.</span></span>|
| <span data-ttu-id="35ce9-204">Pass through claim – authnmethodsreferences</span><span class="sxs-lookup"><span data-stu-id="35ce9-204">Pass through claim – authnmethodsreferences</span></span> | <span data-ttu-id="35ce9-205">The value in the claim issued under this rule indicates what type of authentication was performed for the entity</span><span class="sxs-lookup"><span data-stu-id="35ce9-205">The value in the claim issued under this rule indicates what type of authentication was performed for the entity</span></span> |
| <span data-ttu-id="35ce9-206">Pass through claim - multifactorauthenticationinstant</span><span class="sxs-lookup"><span data-stu-id="35ce9-206">Pass through claim - multifactorauthenticationinstant</span></span> | <span data-ttu-id="35ce9-207">The value of this claim specifies the time, in UTC, when the user last performed multiple factor authentication.</span><span class="sxs-lookup"><span data-stu-id="35ce9-207">The value of this claim specifies the time, in UTC, when the user last performed multiple factor authentication.</span></span> |
| <span data-ttu-id="35ce9-208">Pass through claim - AlternateLoginID</span><span class="sxs-lookup"><span data-stu-id="35ce9-208">Pass through claim - AlternateLoginID</span></span> | <span data-ttu-id="35ce9-209">This rule issues the AlternateLoginID claim if the authentication was performed using alternate login ID.</span><span class="sxs-lookup"><span data-stu-id="35ce9-209">This rule issues the AlternateLoginID claim if the authentication was performed using alternate login ID.</span></span> |

> [!NOTE]
> <span data-ttu-id="35ce9-210">The claim rules for Issue UPN and ImmutableId will differ if you use non-default choice during Azure AD Connect configuration</span><span class="sxs-lookup"><span data-stu-id="35ce9-210">The claim rules for Issue UPN and ImmutableId will differ if you use non-default choice during Azure AD Connect configuration</span></span>

## <a name="restore-issuance-transform-rules"></a><span data-ttu-id="35ce9-211">Restore issuance transform rules</span><span class="sxs-lookup"><span data-stu-id="35ce9-211">Restore issuance transform rules</span></span>

<span data-ttu-id="35ce9-212">Azure AD Connect version 1.1.873.0 or later makes a backup of the Azure AD trust settings whenever an update is made to the Azure AD trust settings.</span><span class="sxs-lookup"><span data-stu-id="35ce9-212">Azure AD Connect version 1.1.873.0 or later makes a backup of the Azure AD trust settings whenever an update is made to the Azure AD trust settings.</span></span> <span data-ttu-id="35ce9-213">The Azure AD trust settings are backed up at **%ProgramData%\AADConnect\ADFS**.</span><span class="sxs-lookup"><span data-stu-id="35ce9-213">The Azure AD trust settings are backed up at **%ProgramData%\AADConnect\ADFS**.</span></span> <span data-ttu-id="35ce9-214">The file name is in the following format AadTrust-&lt;date&gt;-&lt;time&gt;.txt, for example - AadTrust-20180710-150216.txt</span><span class="sxs-lookup"><span data-stu-id="35ce9-214">The file name is in the following format AadTrust-&lt;date&gt;-&lt;time&gt;.txt, for example - AadTrust-20180710-150216.txt</span></span>

![A sanpshot of example back up of Azure AD trust](media/active-directory-azure-ad-connect-azure-ad-trust/backup.png)

<span data-ttu-id="35ce9-216">You can restore the issuance transform rules using the suggested steps below</span><span class="sxs-lookup"><span data-stu-id="35ce9-216">You can restore the issuance transform rules using the suggested steps below</span></span>

1. <span data-ttu-id="35ce9-217">Open the AD FS management UI in Server Manager</span><span class="sxs-lookup"><span data-stu-id="35ce9-217">Open the AD FS management UI in Server Manager</span></span>
2. <span data-ttu-id="35ce9-218">Open the Azure AD trust properties by going **AD FS &gt; Relying Party Trusts &gt; Microsoft Office 365 Identity Platform &gt; Edit Claims Issuance Policy**</span><span class="sxs-lookup"><span data-stu-id="35ce9-218">Open the Azure AD trust properties by going **AD FS &gt; Relying Party Trusts &gt; Microsoft Office 365 Identity Platform &gt; Edit Claims Issuance Policy**</span></span>
3. <span data-ttu-id="35ce9-219">Click on **Add rule**</span><span class="sxs-lookup"><span data-stu-id="35ce9-219">Click on **Add rule**</span></span>
4. <span data-ttu-id="35ce9-220">In the claim rule template, select Send Claims Using a Custom Rule and click **Next**</span><span class="sxs-lookup"><span data-stu-id="35ce9-220">In the claim rule template, select Send Claims Using a Custom Rule and click **Next**</span></span>
5. <span data-ttu-id="35ce9-221">Copy the name of the claim rule from backup file and paste it in the field **Claim rule name**</span><span class="sxs-lookup"><span data-stu-id="35ce9-221">Copy the name of the claim rule from backup file and paste it in the field **Claim rule name**</span></span>
6. <span data-ttu-id="35ce9-222">Copy the claim rule from backup file into the text field for **Custom rule** and click **Finish**</span><span class="sxs-lookup"><span data-stu-id="35ce9-222">Copy the claim rule from backup file into the text field for **Custom rule** and click **Finish**</span></span>

> [!NOTE]
> <span data-ttu-id="35ce9-223">Make sure that your additional rules do not conflict with the rules configured by Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="35ce9-223">Make sure that your additional rules do not conflict with the rules configured by Azure AD Connect.</span></span>

## <a name="next-steps"></a><span data-ttu-id="35ce9-224">Next steps</span><span class="sxs-lookup"><span data-stu-id="35ce9-224">Next steps</span></span>
* [<span data-ttu-id="35ce9-225">Manage and customize Active Directory Federation Services using Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="35ce9-225">Manage and customize Active Directory Federation Services using Azure AD Connect</span></span>](active-directory-aadconnect-federation-management.md)