---
title: 'Azure AD Connect: Pass-through authentication | Microsoft Docs'
description: This topic provides you with the information you need to know about how Azure AD pass-through authentications works with on-premises Active Directory (AD) to provide access to Azure Active Directory (Azure AD) and connected services.
services: active-directory
keywords: what is Azure AD Connect, install Active Directory, required components for Azure AD, SSO, Single Sign-on
documentationcenter: ''
author: billmath
manager: femila
ms.assetid: 9f994aca-6088-40f5-b2cc-c753a4f41da7
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/08/2017
ms.author: billmath
ms.openlocfilehash: 3cf8932e17cf3356497572b1837f799006bef4ad
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44550900"
---
# <a name="what-is-azure-ad-pass-through-authentication"></a><span data-ttu-id="d422b-104">What is Azure AD Pass-through Authentication</span><span class="sxs-lookup"><span data-stu-id="d422b-104">What is Azure AD Pass-through Authentication</span></span>
<span data-ttu-id="d422b-105">Using the same credential (username and password) to access your corporate resources and cloud based services ensures that users don’t have to remember different credentials.</span><span class="sxs-lookup"><span data-stu-id="d422b-105">Using the same credential (username and password) to access your corporate resources and cloud based services ensures that users don’t have to remember different credentials.</span></span> <span data-ttu-id="d422b-106">It reduces the chances that they forget how to sign in and has the benefit of reducing the involvement of help desk for password reset events.</span><span class="sxs-lookup"><span data-stu-id="d422b-106">It reduces the chances that they forget how to sign in and has the benefit of reducing the involvement of help desk for password reset events.</span></span>

<span data-ttu-id="d422b-107">While many organizations are comfortable with using Azure AD [Password synchronization](active-directory-aadconnectsync-implement-password-synchronization.md) to provide users with a single credential to access on-premises and cloud services, other organizations require that passwords, even in a hashed form, do not leave their internal organizational boundary.</span><span class="sxs-lookup"><span data-stu-id="d422b-107">While many organizations are comfortable with using Azure AD [Password synchronization](active-directory-aadconnectsync-implement-password-synchronization.md) to provide users with a single credential to access on-premises and cloud services, other organizations require that passwords, even in a hashed form, do not leave their internal organizational boundary.</span></span>

<span data-ttu-id="d422b-108">Azure AD pass-through authentication provides a simple solution for these customers.</span><span class="sxs-lookup"><span data-stu-id="d422b-108">Azure AD pass-through authentication provides a simple solution for these customers.</span></span> <span data-ttu-id="d422b-109">It ensures that password validation for Azure AD services is performed against their on-premises Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d422b-109">It ensures that password validation for Azure AD services is performed against their on-premises Active Directory.</span></span> <span data-ttu-id="d422b-110">Passwords can be validated without the need for complex network infrastructure or for the on-premises passwords to exist in the cloud in any form.</span><span class="sxs-lookup"><span data-stu-id="d422b-110">Passwords can be validated without the need for complex network infrastructure or for the on-premises passwords to exist in the cloud in any form.</span></span>

<span data-ttu-id="d422b-111">When combined with the [Single Sign on](active-directory-aadconnect-sso.md) option, users do not need to type their password to sign in to Azure AD or other cloud services.</span><span class="sxs-lookup"><span data-stu-id="d422b-111">When combined with the [Single Sign on](active-directory-aadconnect-sso.md) option, users do not need to type their password to sign in to Azure AD or other cloud services.</span></span> <span data-ttu-id="d422b-112">This feature provides these customers with a truly integrated experience on their corporate machines.</span><span class="sxs-lookup"><span data-stu-id="d422b-112">This feature provides these customers with a truly integrated experience on their corporate machines.</span></span>

![Pass-through Authentication](https://docstestmedia1.blob.core.windows.net/azure-media/articles/active-directory/connect/media/active-directory-aadconnect-pass-through-authentication/pta1.png)

<span data-ttu-id="d422b-114">Pass-through authentication can be configured with Azure AD Connect and utilizes a simple on-premises agent that listens for password validation requests.</span><span class="sxs-lookup"><span data-stu-id="d422b-114">Pass-through authentication can be configured with Azure AD Connect and utilizes a simple on-premises agent that listens for password validation requests.</span></span> <span data-ttu-id="d422b-115">The agent can be easily deployed to multiple machines to provide high availability and load balancing.</span><span class="sxs-lookup"><span data-stu-id="d422b-115">The agent can be easily deployed to multiple machines to provide high availability and load balancing.</span></span> <span data-ttu-id="d422b-116">Since all communications are outbound only, there is no requirement for a DMZ or for the connector to be installed in a DMZ.</span><span class="sxs-lookup"><span data-stu-id="d422b-116">Since all communications are outbound only, there is no requirement for a DMZ or for the connector to be installed in a DMZ.</span></span> <span data-ttu-id="d422b-117">The machine requirements for the connector are as follows:</span><span class="sxs-lookup"><span data-stu-id="d422b-117">The machine requirements for the connector are as follows:</span></span>

- <span data-ttu-id="d422b-118">Windows Server 2012 R2 or higher</span><span class="sxs-lookup"><span data-stu-id="d422b-118">Windows Server 2012 R2 or higher</span></span>
- <span data-ttu-id="d422b-119">Joined to a domain in the forest that users are validated in</span><span class="sxs-lookup"><span data-stu-id="d422b-119">Joined to a domain in the forest that users are validated in</span></span>

>[!NOTE]
><span data-ttu-id="d422b-120">Multi-forest environments can be supported if there are trusts between the forests and name suffix routing is correctly configured.</span><span class="sxs-lookup"><span data-stu-id="d422b-120">Multi-forest environments can be supported if there are trusts between the forests and name suffix routing is correctly configured.</span></span>

## <a name="supported-clients-in-the-preview"></a><span data-ttu-id="d422b-121">Supported Clients in the preview</span><span class="sxs-lookup"><span data-stu-id="d422b-121">Supported Clients in the preview</span></span>

<span data-ttu-id="d422b-122">Pass-through authentication is supported via web browser-based clients and Office clients that support [modern authentication](https://aka.ms/modernauthga).</span><span class="sxs-lookup"><span data-stu-id="d422b-122">Pass-through authentication is supported via web browser-based clients and Office clients that support [modern authentication](https://aka.ms/modernauthga).</span></span> <span data-ttu-id="d422b-123">For clients that are not supported, such as legacy Office clients and Exchange active sync (that is, native email clients on mobile devices), customers are encouraged to use the modern authentication equivalent.</span><span class="sxs-lookup"><span data-stu-id="d422b-123">For clients that are not supported, such as legacy Office clients and Exchange active sync (that is, native email clients on mobile devices), customers are encouraged to use the modern authentication equivalent.</span></span> <span data-ttu-id="d422b-124">These clients not only allow pass-through authentication, but also allow conditional access to be applied, such as multi-factor authentication.</span><span class="sxs-lookup"><span data-stu-id="d422b-124">These clients not only allow pass-through authentication, but also allow conditional access to be applied, such as multi-factor authentication.</span></span>

<span data-ttu-id="d422b-125">For customers using Windows 10 joined to Azure AD, pass-through authentication is not currently supported.</span><span class="sxs-lookup"><span data-stu-id="d422b-125">For customers using Windows 10 joined to Azure AD, pass-through authentication is not currently supported.</span></span> <span data-ttu-id="d422b-126">However, customers can utilize password sync as an automatic fallback for Windows 10 in addition for legacy clients.</span><span class="sxs-lookup"><span data-stu-id="d422b-126">However, customers can utilize password sync as an automatic fallback for Windows 10 in addition for legacy clients.</span></span>

>[!NOTE]
><span data-ttu-id="d422b-127">During the preview, Password synchronization is enabled by default when Pass-through authentication is selected as the sign-in option in Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="d422b-127">During the preview, Password synchronization is enabled by default when Pass-through authentication is selected as the sign-in option in Azure AD Connect.</span></span> <span data-ttu-id="d422b-128">This setting can be disabled on the Options page of Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="d422b-128">This setting can be disabled on the Options page of Azure AD Connect.</span></span>

## <a name="how-azure-ad-pass-through-authentication-works"></a><span data-ttu-id="d422b-129">How Azure AD Pass-through Authentication works</span><span class="sxs-lookup"><span data-stu-id="d422b-129">How Azure AD Pass-through Authentication works</span></span>
<span data-ttu-id="d422b-130">When a user enters their username and password into the Azure AD sign-in page, Azure AD places the username and password on the appropriate on-premises connector queue for validation.</span><span class="sxs-lookup"><span data-stu-id="d422b-130">When a user enters their username and password into the Azure AD sign-in page, Azure AD places the username and password on the appropriate on-premises connector queue for validation.</span></span> <span data-ttu-id="d422b-131">One of the available on-premises connectors then retrieves the username and password and validates it against Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d422b-131">One of the available on-premises connectors then retrieves the username and password and validates it against Active Directory.</span></span> <span data-ttu-id="d422b-132">The validation occurs over standard Windows APIs similar to how Active Directory Federation Services validates password.</span><span class="sxs-lookup"><span data-stu-id="d422b-132">The validation occurs over standard Windows APIs similar to how Active Directory Federation Services validates password.</span></span>

<span data-ttu-id="d422b-133">The on-premises Domain Controller then evaluates the request and returns a response to the connector, which in turn returns this response to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d422b-133">The on-premises Domain Controller then evaluates the request and returns a response to the connector, which in turn returns this response to Azure AD.</span></span> <span data-ttu-id="d422b-134">Azure AD then evaluates the response and responds to the user as appropriate, for example by issuing a token or asking for Multifactor Authentication.</span><span class="sxs-lookup"><span data-stu-id="d422b-134">Azure AD then evaluates the response and responds to the user as appropriate, for example by issuing a token or asking for Multifactor Authentication.</span></span> <span data-ttu-id="d422b-135">This diagram shows the various steps:</span><span class="sxs-lookup"><span data-stu-id="d422b-135">This diagram shows the various steps:</span></span>

![Pass-through Authentication](https://docstestmedia1.blob.core.windows.net/azure-media/articles/active-directory/connect/media/active-directory-aadconnect-pass-through-authentication/pta2.png)

## <a name="azure-ad-pass-through-prerequisites"></a><span data-ttu-id="d422b-137">Azure AD Pass-through prerequisites</span><span class="sxs-lookup"><span data-stu-id="d422b-137">Azure AD Pass-through prerequisites</span></span>
<span data-ttu-id="d422b-138">Before you can enable and use Azure AD pass-through authentication, you need to have:</span><span class="sxs-lookup"><span data-stu-id="d422b-138">Before you can enable and use Azure AD pass-through authentication, you need to have:</span></span>

- <span data-ttu-id="d422b-139">Azure AD Connect</span><span class="sxs-lookup"><span data-stu-id="d422b-139">Azure AD Connect</span></span>
- <span data-ttu-id="d422b-140">An Azure AD tenant for which you are a global administrator.</span><span class="sxs-lookup"><span data-stu-id="d422b-140">An Azure AD tenant for which you are a global administrator.</span></span>

>[!NOTE]
><span data-ttu-id="d422b-141">It is recommended that the account is a cloud-only admin account so that you can manage the configuration of your tenant should your on-premises services fail or be unavailable.</span><span class="sxs-lookup"><span data-stu-id="d422b-141">It is recommended that the account is a cloud-only admin account so that you can manage the configuration of your tenant should your on-premises services fail or be unavailable.</span></span>

- <span data-ttu-id="d422b-142">A server running Windows Server 2012 R2 or higher on which to run Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="d422b-142">A server running Windows Server 2012 R2 or higher on which to run Azure AD Connect.</span></span> <span data-ttu-id="d422b-143">This machine must be a member of the same forest as the users who are validated.</span><span class="sxs-lookup"><span data-stu-id="d422b-143">This machine must be a member of the same forest as the users who are validated.</span></span>
- <span data-ttu-id="d422b-144">If you have more than one forest containing users to be validated with Azure AD, the forests must have trusts between them.</span><span class="sxs-lookup"><span data-stu-id="d422b-144">If you have more than one forest containing users to be validated with Azure AD, the forests must have trusts between them.</span></span>
- <span data-ttu-id="d422b-145">On-premises UserPrincipalName must be used as the Azure AD username.</span><span class="sxs-lookup"><span data-stu-id="d422b-145">On-premises UserPrincipalName must be used as the Azure AD username.</span></span>
- <span data-ttu-id="d422b-146">A second server running Windows Server 2012 R2 or higher on which to run a second connector for high availability and load balancing.</span><span class="sxs-lookup"><span data-stu-id="d422b-146">A second server running Windows Server 2012 R2 or higher on which to run a second connector for high availability and load balancing.</span></span> <span data-ttu-id="d422b-147">Instructions are included below on how to deploy this connector.</span><span class="sxs-lookup"><span data-stu-id="d422b-147">Instructions are included below on how to deploy this connector.</span></span>
- <span data-ttu-id="d422b-148">If there is a firewall between the connector and Azure AD, make sure that:</span><span class="sxs-lookup"><span data-stu-id="d422b-148">If there is a firewall between the connector and Azure AD, make sure that:</span></span>
    - <span data-ttu-id="d422b-149">If URL filtering is enabled, ensure that the connector can communicate with the follow URLs:</span><span class="sxs-lookup"><span data-stu-id="d422b-149">If URL filtering is enabled, ensure that the connector can communicate with the follow URLs:</span></span>
        -  <span data-ttu-id="d422b-150">\*.msappproxy.net</span><span class="sxs-lookup"><span data-stu-id="d422b-150">\*.msappproxy.net</span></span>
        -  <span data-ttu-id="d422b-151">\*.servicebus.windows.net.</span><span class="sxs-lookup"><span data-stu-id="d422b-151">\*.servicebus.windows.net.</span></span>  
        -  <span data-ttu-id="d422b-152">The connector also makes connection on direct IP connections to the [Azure data center IP ranges](https://www.microsoft.com/en-us/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="d422b-152">The connector also makes connection on direct IP connections to the [Azure data center IP ranges](https://www.microsoft.com/en-us/download/details.aspx?id=41653).</span></span>
    - <span data-ttu-id="d422b-153">Ensure that the firewall does not perform SSL inspection as the connector uses client certificates to communicate with Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d422b-153">Ensure that the firewall does not perform SSL inspection as the connector uses client certificates to communicate with Azure AD.</span></span>
    - <span data-ttu-id="d422b-154">Ensure the connector can make HTTPS (TCP) requests to Azure AD on the ports below.</span><span class="sxs-lookup"><span data-stu-id="d422b-154">Ensure the connector can make HTTPS (TCP) requests to Azure AD on the ports below.</span></span>

|<span data-ttu-id="d422b-155">Port Number</span><span class="sxs-lookup"><span data-stu-id="d422b-155">Port Number</span></span>|<span data-ttu-id="d422b-156">Description</span><span class="sxs-lookup"><span data-stu-id="d422b-156">Description</span></span>
| --- | ---
|<span data-ttu-id="d422b-157">80</span><span class="sxs-lookup"><span data-stu-id="d422b-157">80</span></span>|<span data-ttu-id="d422b-158">Enables outbound HTTP traffic for security validation such as SSL certificate revocation lists.</span><span class="sxs-lookup"><span data-stu-id="d422b-158">Enables outbound HTTP traffic for security validation such as SSL certificate revocation lists.</span></span>
|<span data-ttu-id="d422b-159">443</span><span class="sxs-lookup"><span data-stu-id="d422b-159">443</span></span>|   <span data-ttu-id="d422b-160">Enables user authentication against Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d422b-160">Enables user authentication against Azure AD.</span></span>
|<span data-ttu-id="d422b-161">8080/443</span><span class="sxs-lookup"><span data-stu-id="d422b-161">8080/443</span></span>|  <span data-ttu-id="d422b-162">Enables the Connector bootstrap sequence and Connector automatic update.</span><span class="sxs-lookup"><span data-stu-id="d422b-162">Enables the Connector bootstrap sequence and Connector automatic update.</span></span>
|<span data-ttu-id="d422b-163">9090</span><span class="sxs-lookup"><span data-stu-id="d422b-163">9090</span></span>|  <span data-ttu-id="d422b-164">Enables Connector registration (required only for the Connector registration process).</span><span class="sxs-lookup"><span data-stu-id="d422b-164">Enables Connector registration (required only for the Connector registration process).</span></span>
|<span data-ttu-id="d422b-165">9091</span><span class="sxs-lookup"><span data-stu-id="d422b-165">9091</span></span>|  <span data-ttu-id="d422b-166">Enables Connector trust certificate automatic renewal.</span><span class="sxs-lookup"><span data-stu-id="d422b-166">Enables Connector trust certificate automatic renewal.</span></span>
|<span data-ttu-id="d422b-167">9352, 5671</span><span class="sxs-lookup"><span data-stu-id="d422b-167">9352, 5671</span></span>|    <span data-ttu-id="d422b-168">Enables communication between the Connector and the Azure AD service for incoming requests.</span><span class="sxs-lookup"><span data-stu-id="d422b-168">Enables communication between the Connector and the Azure AD service for incoming requests.</span></span>
|<span data-ttu-id="d422b-169">9350</span><span class="sxs-lookup"><span data-stu-id="d422b-169">9350</span></span>|  <span data-ttu-id="d422b-170">[Optional] Enables better performance for incoming requests.</span><span class="sxs-lookup"><span data-stu-id="d422b-170">[Optional] Enables better performance for incoming requests.</span></span>
|<span data-ttu-id="d422b-171">10100–10120</span><span class="sxs-lookup"><span data-stu-id="d422b-171">10100–10120</span></span>|   <span data-ttu-id="d422b-172">Enables responses from the connector back to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="d422b-172">Enables responses from the connector back to Azure AD.</span></span>

<span data-ttu-id="d422b-173">If your firewall enforces traffic according to originating users, open these ports for traffic coming from Windows services running as a Network Service.</span><span class="sxs-lookup"><span data-stu-id="d422b-173">If your firewall enforces traffic according to originating users, open these ports for traffic coming from Windows services running as a Network Service.</span></span> <span data-ttu-id="d422b-174">Also, make sure to enable port 8080 for NT Authority\System.</span><span class="sxs-lookup"><span data-stu-id="d422b-174">Also, make sure to enable port 8080 for NT Authority\System.</span></span>

## <a name="enabling-pass-through-authentication"></a><span data-ttu-id="d422b-175">Enabling Pass-through authentication</span><span class="sxs-lookup"><span data-stu-id="d422b-175">Enabling Pass-through authentication</span></span>
<span data-ttu-id="d422b-176">Azure AD pass-through authentication is enabled via Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="d422b-176">Azure AD pass-through authentication is enabled via Azure AD Connect.</span></span> <span data-ttu-id="d422b-177">Enabling pass-through authentication deploys the first connector on the same server as Azure AD connect.</span><span class="sxs-lookup"><span data-stu-id="d422b-177">Enabling pass-through authentication deploys the first connector on the same server as Azure AD connect.</span></span> <span data-ttu-id="d422b-178">When installing Azure AD Connect, select a custom installation and select Pass-through authentication on the sign-in options page.</span><span class="sxs-lookup"><span data-stu-id="d422b-178">When installing Azure AD Connect, select a custom installation and select Pass-through authentication on the sign-in options page.</span></span> <span data-ttu-id="d422b-179">For more information, see [Custom installation of Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span><span class="sxs-lookup"><span data-stu-id="d422b-179">For more information, see [Custom installation of Azure AD Connect](active-directory-aadconnect-get-started-custom.md).</span></span>

![Single sign-on](https://docstestmedia1.blob.core.windows.net/azure-media/articles/active-directory/connect/media/active-directory-aadconnect-sso/sso3.png)

<span data-ttu-id="d422b-181">By default, the first pass-through authentication connector is installed on the Azure AD Connect server.</span><span class="sxs-lookup"><span data-stu-id="d422b-181">By default, the first pass-through authentication connector is installed on the Azure AD Connect server.</span></span> <span data-ttu-id="d422b-182">You should deploy a second connector on another machine to ensure that you have high availability and load balancing of authentication requests.</span><span class="sxs-lookup"><span data-stu-id="d422b-182">You should deploy a second connector on another machine to ensure that you have high availability and load balancing of authentication requests.</span></span>

<span data-ttu-id="d422b-183">To deploy the second connector, follow the instructions below:</span><span class="sxs-lookup"><span data-stu-id="d422b-183">To deploy the second connector, follow the instructions below:</span></span>

### <a name="step-1-install-the-connector-without-registration"></a><span data-ttu-id="d422b-184">Step 1: Install the Connector without registration</span><span class="sxs-lookup"><span data-stu-id="d422b-184">Step 1: Install the Connector without registration</span></span>

1.  <span data-ttu-id="d422b-185">Download the latest [connector](https://go.microsoft.com/fwlink/?linkid=837580).</span><span class="sxs-lookup"><span data-stu-id="d422b-185">Download the latest [connector](https://go.microsoft.com/fwlink/?linkid=837580).</span></span>
2.  <span data-ttu-id="d422b-186">Open a command prompt as an administrator.</span><span class="sxs-lookup"><span data-stu-id="d422b-186">Open a command prompt as an administrator.</span></span>
3.  <span data-ttu-id="d422b-187">Run the following command in which /q means quiet installation - the installation does not prompt you to accept the End User License Agreement.</span><span class="sxs-lookup"><span data-stu-id="d422b-187">Run the following command in which /q means quiet installation - the installation does not prompt you to accept the End User License Agreement.</span></span>

```
AADApplicationProxyConnectorInstaller.exe REGISTERCONNECTOR="false" /q
```

### <a name="step-2-register-the-connector-with-azure-ad-for-pass-through-authentication"></a><span data-ttu-id="d422b-188">Step 2: Register the Connector with Azure AD for pass-through authentication</span><span class="sxs-lookup"><span data-stu-id="d422b-188">Step 2: Register the Connector with Azure AD for pass-through authentication</span></span>

1.  <span data-ttu-id="d422b-189">Open a PowerShell window as an administrator</span><span class="sxs-lookup"><span data-stu-id="d422b-189">Open a PowerShell window as an administrator</span></span>
2.  <span data-ttu-id="d422b-190">Navigate to **C:\Program Files\Microsoft AAD App Proxy Connector** and run the script.</span><span class="sxs-lookup"><span data-stu-id="d422b-190">Navigate to **C:\Program Files\Microsoft AAD App Proxy Connector** and run the script.</span></span>  
`.\RegisterConnector.ps1 -modulePath "C:\Program Files\Microsoft AAD App Proxy Connector\Modules\" -moduleName "AppProxyPSModule" -Feature PassthroughAuthentication`
3.  <span data-ttu-id="d422b-191">When prompted, enter the credentials of your Azure AD tenant Admin account.</span><span class="sxs-lookup"><span data-stu-id="d422b-191">When prompted, enter the credentials of your Azure AD tenant Admin account.</span></span>

## <a name="troubleshooting-pass-through-authentication"></a><span data-ttu-id="d422b-192">Troubleshooting Pass-through authentication</span><span class="sxs-lookup"><span data-stu-id="d422b-192">Troubleshooting Pass-through authentication</span></span>
<span data-ttu-id="d422b-193">When troubleshooting Pass-through authentication, there are a few different categories of problems that can occur.</span><span class="sxs-lookup"><span data-stu-id="d422b-193">When troubleshooting Pass-through authentication, there are a few different categories of problems that can occur.</span></span> <span data-ttu-id="d422b-194">Depending on the type of problem, you may need to look in different places.</span><span class="sxs-lookup"><span data-stu-id="d422b-194">Depending on the type of problem, you may need to look in different places.</span></span>

<span data-ttu-id="d422b-195">For errors that relate to the connector you can check the Event Log of the connector machine under **Application and Service Logs\Microsoft\AadApplicationProxy\Connector\Admin**. If needed, more detailed logs are available by viewing the analytics and debugging logs and enabling the connector session log.</span><span class="sxs-lookup"><span data-stu-id="d422b-195">For errors that relate to the connector you can check the Event Log of the connector machine under **Application and Service Logs\Microsoft\AadApplicationProxy\Connector\Admin**. If needed, more detailed logs are available by viewing the analytics and debugging logs and enabling the connector session log.</span></span> <span data-ttu-id="d422b-196">It is not recommended to run with this log enabled by default and the contents are only visible after the log is disabled.</span><span class="sxs-lookup"><span data-stu-id="d422b-196">It is not recommended to run with this log enabled by default and the contents are only visible after the log is disabled.</span></span>

<span data-ttu-id="d422b-197">Additional information can also be found in the trace logs for the connector in **C:\Programdata\Microsoft\Microsoft AAD Application Proxy Connector\Trace**.</span><span class="sxs-lookup"><span data-stu-id="d422b-197">Additional information can also be found in the trace logs for the connector in **C:\Programdata\Microsoft\Microsoft AAD Application Proxy Connector\Trace**.</span></span> <span data-ttu-id="d422b-198">These logs also include the reason that pass-through authentication failed for an individual user, such as the following entry below that includes the error code 1328:</span><span class="sxs-lookup"><span data-stu-id="d422b-198">These logs also include the reason that pass-through authentication failed for an individual user, such as the following entry below that includes the error code 1328:</span></span>

```
    ApplicationProxyConnectorService.exe Error: 0 : Passthrough Authentication request failed. RequestId: 'df63f4a4-68b9-44ae-8d81-6ad2d844d84e'. Reason: '1328'.
        ThreadId=5
        DateTime=xxxx-xx-xxTxx:xx:xx.xxxxxxZ
```

<span data-ttu-id="d422b-199">You can get the details of the error by starting a command prompt and running the following command: (Replace '1328' with the error number in the request.)</span><span class="sxs-lookup"><span data-stu-id="d422b-199">You can get the details of the error by starting a command prompt and running the following command: (Replace '1328' with the error number in the request.)</span></span>

`Net helpmsg 1328`

<span data-ttu-id="d422b-200">The result is similar to the following response:</span><span class="sxs-lookup"><span data-stu-id="d422b-200">The result is similar to the following response:</span></span>

![Pass-through Authentication](https://docstestmedia1.blob.core.windows.net/azure-media/articles/active-directory/connect/media/active-directory-aadconnect-pass-through-authentication/pta3.png)

<span data-ttu-id="d422b-202">If audit logging is enabled, then additional information can also be found in the security logs of the Domain Controllers.</span><span class="sxs-lookup"><span data-stu-id="d422b-202">If audit logging is enabled, then additional information can also be found in the security logs of the Domain Controllers.</span></span> <span data-ttu-id="d422b-203">A simple query for authentication requests by the connector would be as follows:</span><span class="sxs-lookup"><span data-stu-id="d422b-203">A simple query for authentication requests by the connector would be as follows:</span></span>

```
    <QueryList>
    <Query Id="0" Path="Security">
    <Select Path="Security">*[EventData[Data[@Name='ProcessName'] and (Data='C:\Program Files\Microsoft AAD App Proxy Connector\ApplicationProxyConnectorService.exe')]]</Select>
    </Query>
    </QueryList>
```

<span data-ttu-id="d422b-204">Other errors reported on the Azure AD sign-in screen are detailed below together with the appropriate resolution steps.</span><span class="sxs-lookup"><span data-stu-id="d422b-204">Other errors reported on the Azure AD sign-in screen are detailed below together with the appropriate resolution steps.</span></span>

|<span data-ttu-id="d422b-205">Error</span><span class="sxs-lookup"><span data-stu-id="d422b-205">Error</span></span>|<span data-ttu-id="d422b-206">Description</span><span class="sxs-lookup"><span data-stu-id="d422b-206">Description</span></span>|<span data-ttu-id="d422b-207">Resolution</span><span class="sxs-lookup"><span data-stu-id="d422b-207">Resolution</span></span>
| --- | --- | ---
|<span data-ttu-id="d422b-208">AADSTS80001</span><span class="sxs-lookup"><span data-stu-id="d422b-208">AADSTS80001</span></span>|<span data-ttu-id="d422b-209">Unable to connect to Active Directory</span><span class="sxs-lookup"><span data-stu-id="d422b-209">Unable to connect to Active Directory</span></span>|<span data-ttu-id="d422b-210">Ensure that the connector machines are domain joined and are able to connect to Active Directory.</span><span class="sxs-lookup"><span data-stu-id="d422b-210">Ensure that the connector machines are domain joined and are able to connect to Active Directory.</span></span>  
|<span data-ttu-id="d422b-211">AADSTS8002</span><span class="sxs-lookup"><span data-stu-id="d422b-211">AADSTS8002</span></span>|<span data-ttu-id="d422b-212">A timeout occurred connecting to Active Directory</span><span class="sxs-lookup"><span data-stu-id="d422b-212">A timeout occurred connecting to Active Directory</span></span>|<span data-ttu-id="d422b-213">Check to ensure that Active Directory is available and responding to requests from the connector.</span><span class="sxs-lookup"><span data-stu-id="d422b-213">Check to ensure that Active Directory is available and responding to requests from the connector.</span></span>
|<span data-ttu-id="d422b-214">AADSTS80004</span><span class="sxs-lookup"><span data-stu-id="d422b-214">AADSTS80004</span></span>|<span data-ttu-id="d422b-215">The username passed to the connector was not valid</span><span class="sxs-lookup"><span data-stu-id="d422b-215">The username passed to the connector was not valid</span></span>|<span data-ttu-id="d422b-216">Ensure the user is attempting to sign in with the right username.</span><span class="sxs-lookup"><span data-stu-id="d422b-216">Ensure the user is attempting to sign in with the right username.</span></span>
|<span data-ttu-id="d422b-217">AADSTS80005</span><span class="sxs-lookup"><span data-stu-id="d422b-217">AADSTS80005</span></span>|<span data-ttu-id="d422b-218">Validation encountered unpredictable WebException</span><span class="sxs-lookup"><span data-stu-id="d422b-218">Validation encountered unpredictable WebException</span></span>|<span data-ttu-id="d422b-219">This error is a transient problem.</span><span class="sxs-lookup"><span data-stu-id="d422b-219">This error is a transient problem.</span></span> <span data-ttu-id="d422b-220">Retry the request.</span><span class="sxs-lookup"><span data-stu-id="d422b-220">Retry the request.</span></span> <span data-ttu-id="d422b-221">Should it continue to fail, contact Microsoft support.</span><span class="sxs-lookup"><span data-stu-id="d422b-221">Should it continue to fail, contact Microsoft support.</span></span>
|<span data-ttu-id="d422b-222">AADSTS80007</span><span class="sxs-lookup"><span data-stu-id="d422b-222">AADSTS80007</span></span>|<span data-ttu-id="d422b-223">An error occurred communicating with Active Directory</span><span class="sxs-lookup"><span data-stu-id="d422b-223">An error occurred communicating with Active Directory</span></span>|<span data-ttu-id="d422b-224">Check the connector logs for more information and verify that Active Directory is operating as expected.</span><span class="sxs-lookup"><span data-stu-id="d422b-224">Check the connector logs for more information and verify that Active Directory is operating as expected.</span></span>




