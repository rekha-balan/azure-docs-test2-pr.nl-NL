---
title: On-premises password writeback integration with Azure AD SSPR
description: Get cloud passwords written back to on-premises AD infratstructure
services: active-directory
ms.service: active-directory
ms.component: authentication
ms.topic: conceptual
ms.date: 07/11/2018
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.reviewer: sahenry
ms.openlocfilehash: 4f4c2ada08c69b6602ff5a300a15c4ca57090a8e
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44868356"
---
# <a name="what-is-password-writeback"></a><span data-ttu-id="30cd8-103">What is password writeback?</span><span class="sxs-lookup"><span data-stu-id="30cd8-103">What is password writeback?</span></span>

<span data-ttu-id="30cd8-104">Having a cloud based password reset utility is great but most companies still have an on-premises directory where their users exist.</span><span class="sxs-lookup"><span data-stu-id="30cd8-104">Having a cloud based password reset utility is great but most companies still have an on-premises directory where their users exist.</span></span> <span data-ttu-id="30cd8-105">How does Microsoft support keeping traditional on-premises Active Directory (AD) in sync with password changes in the cloud?</span><span class="sxs-lookup"><span data-stu-id="30cd8-105">How does Microsoft support keeping traditional on-premises Active Directory (AD) in sync with password changes in the cloud?</span></span> <span data-ttu-id="30cd8-106">Password writeback is a feature enabled with [Azure AD Connect](./../connect/active-directory-aadconnect.md) that allows password changes in the cloud to be written back to an existing on-premises directory in real-time.</span><span class="sxs-lookup"><span data-stu-id="30cd8-106">Password writeback is a feature enabled with [Azure AD Connect](./../connect/active-directory-aadconnect.md) that allows password changes in the cloud to be written back to an existing on-premises directory in real-time.</span></span>

<span data-ttu-id="30cd8-107">Password writeback is supported in environments that use:</span><span class="sxs-lookup"><span data-stu-id="30cd8-107">Password writeback is supported in environments that use:</span></span>

* [<span data-ttu-id="30cd8-108">Active Directory Federation Services</span><span class="sxs-lookup"><span data-stu-id="30cd8-108">Active Directory Federation Services</span></span>](../connect/active-directory-aadconnect-federation-management.md)
* [<span data-ttu-id="30cd8-109">Password hash synchronization</span><span class="sxs-lookup"><span data-stu-id="30cd8-109">Password hash synchronization</span></span>](../connect/active-directory-aadconnectsync-implement-password-hash-synchronization.md)
* [<span data-ttu-id="30cd8-110">Pass-through authentication</span><span class="sxs-lookup"><span data-stu-id="30cd8-110">Pass-through authentication</span></span>](../connect/active-directory-aadconnect-pass-through-authentication.md)

<span data-ttu-id="30cd8-111">Password writeback provides:</span><span class="sxs-lookup"><span data-stu-id="30cd8-111">Password writeback provides:</span></span>

* <span data-ttu-id="30cd8-112">**Enforcement of on-premises Active Directory password policies**: When a user resets their password, it is checked to ensure it meets your on-premises Active Directory policy before committing it to that directory.</span><span class="sxs-lookup"><span data-stu-id="30cd8-112">**Enforcement of on-premises Active Directory password policies**: When a user resets their password, it is checked to ensure it meets your on-premises Active Directory policy before committing it to that directory.</span></span> <span data-ttu-id="30cd8-113">This review includes checking the history, complexity, age, password filters, and any other password restrictions that you have defined in local Active Directory.</span><span class="sxs-lookup"><span data-stu-id="30cd8-113">This review includes checking the history, complexity, age, password filters, and any other password restrictions that you have defined in local Active Directory.</span></span>
* <span data-ttu-id="30cd8-114">**Zero-delay feedback**: Password writeback is a synchronous operation.</span><span class="sxs-lookup"><span data-stu-id="30cd8-114">**Zero-delay feedback**: Password writeback is a synchronous operation.</span></span> <span data-ttu-id="30cd8-115">Your users are notified immediately if their password did not meet the policy or could not be reset or changed for any reason.</span><span class="sxs-lookup"><span data-stu-id="30cd8-115">Your users are notified immediately if their password did not meet the policy or could not be reset or changed for any reason.</span></span>
* <span data-ttu-id="30cd8-116">**Supports password changes from the access panel and Office 365**: When federated or password hash synchronized users come to change their expired or non-expired passwords, those passwords are written back to your local Active Directory environment.</span><span class="sxs-lookup"><span data-stu-id="30cd8-116">**Supports password changes from the access panel and Office 365**: When federated or password hash synchronized users come to change their expired or non-expired passwords, those passwords are written back to your local Active Directory environment.</span></span>
* <span data-ttu-id="30cd8-117">**Supports password writeback when an admin resets them from the Azure portal**: Whenever an admin resets a user’s password in the [Azure portal](https://portal.azure.com), if that user is federated or password hash synchronized, the password is written back to on-premises.</span><span class="sxs-lookup"><span data-stu-id="30cd8-117">**Supports password writeback when an admin resets them from the Azure portal**: Whenever an admin resets a user’s password in the [Azure portal](https://portal.azure.com), if that user is federated or password hash synchronized, the password is written back to on-premises.</span></span> <span data-ttu-id="30cd8-118">This functionality is currently not supported in the Office admin portal.</span><span class="sxs-lookup"><span data-stu-id="30cd8-118">This functionality is currently not supported in the Office admin portal.</span></span>
* <span data-ttu-id="30cd8-119">**Doesn’t require any inbound firewall rules**: Password writeback uses an Azure Service Bus relay as an underlying communication channel.</span><span class="sxs-lookup"><span data-stu-id="30cd8-119">**Doesn’t require any inbound firewall rules**: Password writeback uses an Azure Service Bus relay as an underlying communication channel.</span></span> <span data-ttu-id="30cd8-120">All communication is outbound over port 443.</span><span class="sxs-lookup"><span data-stu-id="30cd8-120">All communication is outbound over port 443.</span></span>

> [!Note]
> <span data-ttu-id="30cd8-121">User accounts that exist within protected groups in on-premises Active Directory cannot be used with password writeback.</span><span class="sxs-lookup"><span data-stu-id="30cd8-121">User accounts that exist within protected groups in on-premises Active Directory cannot be used with password writeback.</span></span> <span data-ttu-id="30cd8-122">For more information about protected groups, see [Protected accounts and groups in Active Directory](https://technet.microsoft.com/library/dn535499.aspx).</span><span class="sxs-lookup"><span data-stu-id="30cd8-122">For more information about protected groups, see [Protected accounts and groups in Active Directory](https://technet.microsoft.com/library/dn535499.aspx).</span></span>

## <a name="licensing-requirements-for-password-writeback"></a><span data-ttu-id="30cd8-123">Licensing requirements for password writeback</span><span class="sxs-lookup"><span data-stu-id="30cd8-123">Licensing requirements for password writeback</span></span>

<span data-ttu-id="30cd8-124">**Self-Service Password Reset/Change/Unlock with on-premises writeback is a premium feature of Azure AD**.</span><span class="sxs-lookup"><span data-stu-id="30cd8-124">**Self-Service Password Reset/Change/Unlock with on-premises writeback is a premium feature of Azure AD**.</span></span> <span data-ttu-id="30cd8-125">For more information about licensing, see the [Azure Active Directory pricing site](https://azure.microsoft.com/pricing/details/active-directory/).</span><span class="sxs-lookup"><span data-stu-id="30cd8-125">For more information about licensing, see the [Azure Active Directory pricing site](https://azure.microsoft.com/pricing/details/active-directory/).</span></span>

<span data-ttu-id="30cd8-126">To use password writeback, you must have one of the following licenses assigned on your tenant:</span><span class="sxs-lookup"><span data-stu-id="30cd8-126">To use password writeback, you must have one of the following licenses assigned on your tenant:</span></span>

* <span data-ttu-id="30cd8-127">Azure AD Premium P1</span><span class="sxs-lookup"><span data-stu-id="30cd8-127">Azure AD Premium P1</span></span>
* <span data-ttu-id="30cd8-128">Azure AD Premium P2</span><span class="sxs-lookup"><span data-stu-id="30cd8-128">Azure AD Premium P2</span></span>
* <span data-ttu-id="30cd8-129">Enterprise Mobility + Security E3 or A3</span><span class="sxs-lookup"><span data-stu-id="30cd8-129">Enterprise Mobility + Security E3 or A3</span></span>
* <span data-ttu-id="30cd8-130">Enterprise Mobility + Security E5 or A5</span><span class="sxs-lookup"><span data-stu-id="30cd8-130">Enterprise Mobility + Security E5 or A5</span></span>
* <span data-ttu-id="30cd8-131">Microsoft 365 E3 or A3</span><span class="sxs-lookup"><span data-stu-id="30cd8-131">Microsoft 365 E3 or A3</span></span>
* <span data-ttu-id="30cd8-132">Microsoft 365 E5 or A5</span><span class="sxs-lookup"><span data-stu-id="30cd8-132">Microsoft 365 E5 or A5</span></span>
* <span data-ttu-id="30cd8-133">Microsoft 365 F1</span><span class="sxs-lookup"><span data-stu-id="30cd8-133">Microsoft 365 F1</span></span>

> [!WARNING]
> <span data-ttu-id="30cd8-134">Standalone Office 365 licensing plans *don't support password writeback* and require that you have one of the preceding plans for this functionality to work.</span><span class="sxs-lookup"><span data-stu-id="30cd8-134">Standalone Office 365 licensing plans *don't support password writeback* and require that you have one of the preceding plans for this functionality to work.</span></span>
>

## <a name="how-password-writeback-works"></a><span data-ttu-id="30cd8-135">How password writeback works</span><span class="sxs-lookup"><span data-stu-id="30cd8-135">How password writeback works</span></span>

<span data-ttu-id="30cd8-136">When a federated or password hash synchronized user attempts to reset or change their password in the cloud, the following actions occur:</span><span class="sxs-lookup"><span data-stu-id="30cd8-136">When a federated or password hash synchronized user attempts to reset or change their password in the cloud, the following actions occur:</span></span>

1. <span data-ttu-id="30cd8-137">A check is performed to see what type of password the user has.</span><span class="sxs-lookup"><span data-stu-id="30cd8-137">A check is performed to see what type of password the user has.</span></span> <span data-ttu-id="30cd8-138">If the password is managed on-premises:</span><span class="sxs-lookup"><span data-stu-id="30cd8-138">If the password is managed on-premises:</span></span>
   * <span data-ttu-id="30cd8-139">A check is performed to see if the writeback service is up and running.</span><span class="sxs-lookup"><span data-stu-id="30cd8-139">A check is performed to see if the writeback service is up and running.</span></span> <span data-ttu-id="30cd8-140">If it is, the user can proceed.</span><span class="sxs-lookup"><span data-stu-id="30cd8-140">If it is, the user can proceed.</span></span>
   * <span data-ttu-id="30cd8-141">If the writeback service is down, the user is informed that their password can't be reset right now.</span><span class="sxs-lookup"><span data-stu-id="30cd8-141">If the writeback service is down, the user is informed that their password can't be reset right now.</span></span>
2. <span data-ttu-id="30cd8-142">Next, the user passes the appropriate authentication gates and reaches the **Reset password** page.</span><span class="sxs-lookup"><span data-stu-id="30cd8-142">Next, the user passes the appropriate authentication gates and reaches the **Reset password** page.</span></span>
3. <span data-ttu-id="30cd8-143">The user selects a new password and confirms it.</span><span class="sxs-lookup"><span data-stu-id="30cd8-143">The user selects a new password and confirms it.</span></span>
4. <span data-ttu-id="30cd8-144">When the user selects **Submit**, the plaintext password is encrypted with a symmetric key created during the writeback setup process.</span><span class="sxs-lookup"><span data-stu-id="30cd8-144">When the user selects **Submit**, the plaintext password is encrypted with a symmetric key created during the writeback setup process.</span></span>
5. <span data-ttu-id="30cd8-145">The encrypted password is included in a payload that gets sent over an HTTPS channel to your tenant-specific service bus relay (that is set up for you during the writeback setup process).</span><span class="sxs-lookup"><span data-stu-id="30cd8-145">The encrypted password is included in a payload that gets sent over an HTTPS channel to your tenant-specific service bus relay (that is set up for you during the writeback setup process).</span></span> <span data-ttu-id="30cd8-146">This relay is protected by a randomly generated password that only your on-premises installation knows.</span><span class="sxs-lookup"><span data-stu-id="30cd8-146">This relay is protected by a randomly generated password that only your on-premises installation knows.</span></span>
6. <span data-ttu-id="30cd8-147">After the message reaches the service bus, the password-reset endpoint automatically wakes up and sees that it has a reset request pending.</span><span class="sxs-lookup"><span data-stu-id="30cd8-147">After the message reaches the service bus, the password-reset endpoint automatically wakes up and sees that it has a reset request pending.</span></span>
7. <span data-ttu-id="30cd8-148">The service then looks for the user by using the cloud anchor attribute.</span><span class="sxs-lookup"><span data-stu-id="30cd8-148">The service then looks for the user by using the cloud anchor attribute.</span></span> <span data-ttu-id="30cd8-149">For this lookup to succeed:</span><span class="sxs-lookup"><span data-stu-id="30cd8-149">For this lookup to succeed:</span></span>

   * <span data-ttu-id="30cd8-150">The user object must exist in the Active Directory connector space.</span><span class="sxs-lookup"><span data-stu-id="30cd8-150">The user object must exist in the Active Directory connector space.</span></span>
   * <span data-ttu-id="30cd8-151">The user object must be linked to the corresponding metaverse (MV) object.</span><span class="sxs-lookup"><span data-stu-id="30cd8-151">The user object must be linked to the corresponding metaverse (MV) object.</span></span>
   * <span data-ttu-id="30cd8-152">The user object must be linked to the corresponding Azure Active Directory connector object.</span><span class="sxs-lookup"><span data-stu-id="30cd8-152">The user object must be linked to the corresponding Azure Active Directory connector object.</span></span>
   * <span data-ttu-id="30cd8-153">The link from the Active Directory connector object to the MV must have the synchronization rule `Microsoft.InfromADUserAccountEnabled.xxx` on the link.</span><span class="sxs-lookup"><span data-stu-id="30cd8-153">The link from the Active Directory connector object to the MV must have the synchronization rule `Microsoft.InfromADUserAccountEnabled.xxx` on the link.</span></span> <br> <br>
   <span data-ttu-id="30cd8-154">When the call comes in from the cloud, the synchronization engine uses the **cloudAnchor** attribute to look up the Azure Active Directory connector space object.</span><span class="sxs-lookup"><span data-stu-id="30cd8-154">When the call comes in from the cloud, the synchronization engine uses the **cloudAnchor** attribute to look up the Azure Active Directory connector space object.</span></span> <span data-ttu-id="30cd8-155">It then follows the link back to the MV object, and then follows the link back to the Active Directory object.</span><span class="sxs-lookup"><span data-stu-id="30cd8-155">It then follows the link back to the MV object, and then follows the link back to the Active Directory object.</span></span> <span data-ttu-id="30cd8-156">Because there can be multiple Active Directory objects (multi-forest) for the same user, the sync engine relies on the `Microsoft.InfromADUserAccountEnabled.xxx` link to pick the correct one.</span><span class="sxs-lookup"><span data-stu-id="30cd8-156">Because there can be multiple Active Directory objects (multi-forest) for the same user, the sync engine relies on the `Microsoft.InfromADUserAccountEnabled.xxx` link to pick the correct one.</span></span>

   > [!Note]
   > <span data-ttu-id="30cd8-157">As a result of this logic, for password writeback to work Azure AD Connect must be able to communicate with the primary domain controller (PDC) emulator.</span><span class="sxs-lookup"><span data-stu-id="30cd8-157">As a result of this logic, for password writeback to work Azure AD Connect must be able to communicate with the primary domain controller (PDC) emulator.</span></span> <span data-ttu-id="30cd8-158">If you need to enable this manually, you can connect Azure AD Connect to the PDC emulator.</span><span class="sxs-lookup"><span data-stu-id="30cd8-158">If you need to enable this manually, you can connect Azure AD Connect to the PDC emulator.</span></span> <span data-ttu-id="30cd8-159">Right-click the **properties** of the Active Directory synchronization connector, then select **configure directory partitions**.</span><span class="sxs-lookup"><span data-stu-id="30cd8-159">Right-click the **properties** of the Active Directory synchronization connector, then select **configure directory partitions**.</span></span> <span data-ttu-id="30cd8-160">From there, look for the **domain controller connection settings** section and select the box titled **only use preferred domain controllers**.</span><span class="sxs-lookup"><span data-stu-id="30cd8-160">From there, look for the **domain controller connection settings** section and select the box titled **only use preferred domain controllers**.</span></span> <span data-ttu-id="30cd8-161">Even if the preferred domain controller is not a PDC emulator, Azure AD Connect attempts to connect to the PDC for password writeback.</span><span class="sxs-lookup"><span data-stu-id="30cd8-161">Even if the preferred domain controller is not a PDC emulator, Azure AD Connect attempts to connect to the PDC for password writeback.</span></span>

8. <span data-ttu-id="30cd8-162">After the user account is found, an attempt to reset the password directly in the appropriate Active Directory forest is made.</span><span class="sxs-lookup"><span data-stu-id="30cd8-162">After the user account is found, an attempt to reset the password directly in the appropriate Active Directory forest is made.</span></span>
9. <span data-ttu-id="30cd8-163">If the password set operation is successful, the user is told their password has been changed.</span><span class="sxs-lookup"><span data-stu-id="30cd8-163">If the password set operation is successful, the user is told their password has been changed.</span></span>
   > [!NOTE]
   > <span data-ttu-id="30cd8-164">If the user's password hash is synchronized to Azure AD by using password hash synchronization, there is a chance that the on-premises password policy is weaker than the cloud password policy.</span><span class="sxs-lookup"><span data-stu-id="30cd8-164">If the user's password hash is synchronized to Azure AD by using password hash synchronization, there is a chance that the on-premises password policy is weaker than the cloud password policy.</span></span> <span data-ttu-id="30cd8-165">In this case, the on-premises policy is enforced.</span><span class="sxs-lookup"><span data-stu-id="30cd8-165">In this case, the on-premises policy is enforced.</span></span> <span data-ttu-id="30cd8-166">This policy ensures that your on-premises policy is enforced in the cloud, no matter if you use password hash synchronization or federation to provide single sign-on.</span><span class="sxs-lookup"><span data-stu-id="30cd8-166">This policy ensures that your on-premises policy is enforced in the cloud, no matter if you use password hash synchronization or federation to provide single sign-on.</span></span>

10. <span data-ttu-id="30cd8-167">If the password set operation fails, an error prompts the user to try again.</span><span class="sxs-lookup"><span data-stu-id="30cd8-167">If the password set operation fails, an error prompts the user to try again.</span></span> <span data-ttu-id="30cd8-168">The operation might fail because:</span><span class="sxs-lookup"><span data-stu-id="30cd8-168">The operation might fail because:</span></span>
   * <span data-ttu-id="30cd8-169">The service was down.</span><span class="sxs-lookup"><span data-stu-id="30cd8-169">The service was down.</span></span>
   * <span data-ttu-id="30cd8-170">The password they selected did not meet the organization's policies.</span><span class="sxs-lookup"><span data-stu-id="30cd8-170">The password they selected did not meet the organization's policies.</span></span>
   * <span data-ttu-id="30cd8-171">Unable to find the user in local Active Directory.</span><span class="sxs-lookup"><span data-stu-id="30cd8-171">Unable to find the user in local Active Directory.</span></span>

    <span data-ttu-id="30cd8-172">The error messages provide guidance to users so they can attempt to resolve without administrator intervention.</span><span class="sxs-lookup"><span data-stu-id="30cd8-172">The error messages provide guidance to users so they can attempt to resolve without administrator intervention.</span></span>

## <a name="password-writeback-security"></a><span data-ttu-id="30cd8-173">Password writeback security</span><span class="sxs-lookup"><span data-stu-id="30cd8-173">Password writeback security</span></span>

<span data-ttu-id="30cd8-174">Password writeback is a highly secure service.</span><span class="sxs-lookup"><span data-stu-id="30cd8-174">Password writeback is a highly secure service.</span></span> <span data-ttu-id="30cd8-175">To ensure your information is protected, a four-tiered security model is enabled as the following describes:</span><span class="sxs-lookup"><span data-stu-id="30cd8-175">To ensure your information is protected, a four-tiered security model is enabled as the following describes:</span></span>

* <span data-ttu-id="30cd8-176">**Tenant-specific service-bus relay**</span><span class="sxs-lookup"><span data-stu-id="30cd8-176">**Tenant-specific service-bus relay**</span></span>
   * <span data-ttu-id="30cd8-177">When you set up the service, a tenant-specific service bus relay is set up that's protected by a randomly generated strong password that Microsoft never has access to.</span><span class="sxs-lookup"><span data-stu-id="30cd8-177">When you set up the service, a tenant-specific service bus relay is set up that's protected by a randomly generated strong password that Microsoft never has access to.</span></span>
* <span data-ttu-id="30cd8-178">**Locked down, cryptographically strong, password encryption key**</span><span class="sxs-lookup"><span data-stu-id="30cd8-178">**Locked down, cryptographically strong, password encryption key**</span></span>
   * <span data-ttu-id="30cd8-179">After the service bus relay is created, a strong symmetric key is created that is used to encrypt the password as it comes over the wire.</span><span class="sxs-lookup"><span data-stu-id="30cd8-179">After the service bus relay is created, a strong symmetric key is created that is used to encrypt the password as it comes over the wire.</span></span> <span data-ttu-id="30cd8-180">This key only lives in your company's secret store in the cloud, which is heavily locked down and audited, just like any other password in the directory.</span><span class="sxs-lookup"><span data-stu-id="30cd8-180">This key only lives in your company's secret store in the cloud, which is heavily locked down and audited, just like any other password in the directory.</span></span>
* <span data-ttu-id="30cd8-181">**Industry standard Transport Layer Security (TLS)**</span><span class="sxs-lookup"><span data-stu-id="30cd8-181">**Industry standard Transport Layer Security (TLS)**</span></span>
   1. <span data-ttu-id="30cd8-182">When a password reset or change operation occurs in the cloud, the plaintext password is encrypted with your public key.</span><span class="sxs-lookup"><span data-stu-id="30cd8-182">When a password reset or change operation occurs in the cloud, the plaintext password is encrypted with your public key.</span></span>
   2. <span data-ttu-id="30cd8-183">The encrypted password is placed into an HTTPS message that is sent over an encrypted channel by using Microsoft SSL certs to your service bus relay.</span><span class="sxs-lookup"><span data-stu-id="30cd8-183">The encrypted password is placed into an HTTPS message that is sent over an encrypted channel by using Microsoft SSL certs to your service bus relay.</span></span>
   3. <span data-ttu-id="30cd8-184">After the message arrives in the service bus, your on-premises agent wakes up and authenticates to the service bus by using the strong password that was previously generated.</span><span class="sxs-lookup"><span data-stu-id="30cd8-184">After the message arrives in the service bus, your on-premises agent wakes up and authenticates to the service bus by using the strong password that was previously generated.</span></span>
   4. <span data-ttu-id="30cd8-185">The on-premises agent picks up the encrypted message and decrypts it by using the private key.</span><span class="sxs-lookup"><span data-stu-id="30cd8-185">The on-premises agent picks up the encrypted message and decrypts it by using the private key.</span></span>
   5. <span data-ttu-id="30cd8-186">The on-premises agent attempts to set the password through the AD DS SetPassword API.</span><span class="sxs-lookup"><span data-stu-id="30cd8-186">The on-premises agent attempts to set the password through the AD DS SetPassword API.</span></span> <span data-ttu-id="30cd8-187">This step is what allows enforcement of your Active Directory on-premises password policy (such as the complexity, age, history, and filters) in the cloud.</span><span class="sxs-lookup"><span data-stu-id="30cd8-187">This step is what allows enforcement of your Active Directory on-premises password policy (such as the complexity, age, history, and filters) in the cloud.</span></span>
* <span data-ttu-id="30cd8-188">**Message expiration policies**</span><span class="sxs-lookup"><span data-stu-id="30cd8-188">**Message expiration policies**</span></span>
   * <span data-ttu-id="30cd8-189">If the message sits in service bus because your on-premises service is down, it times out and is removed after several minutes.</span><span class="sxs-lookup"><span data-stu-id="30cd8-189">If the message sits in service bus because your on-premises service is down, it times out and is removed after several minutes.</span></span> <span data-ttu-id="30cd8-190">The time-out and removal of the message increases security even further.</span><span class="sxs-lookup"><span data-stu-id="30cd8-190">The time-out and removal of the message increases security even further.</span></span>

### <a name="password-writeback-encryption-details"></a><span data-ttu-id="30cd8-191">Password writeback encryption details</span><span class="sxs-lookup"><span data-stu-id="30cd8-191">Password writeback encryption details</span></span>

<span data-ttu-id="30cd8-192">After a user submits a password reset, the reset request goes through several encryption steps before it arrives in your on-premises environment.</span><span class="sxs-lookup"><span data-stu-id="30cd8-192">After a user submits a password reset, the reset request goes through several encryption steps before it arrives in your on-premises environment.</span></span> <span data-ttu-id="30cd8-193">These encryption steps ensure maximum service reliability and security.</span><span class="sxs-lookup"><span data-stu-id="30cd8-193">These encryption steps ensure maximum service reliability and security.</span></span> <span data-ttu-id="30cd8-194">They are described as follows:</span><span class="sxs-lookup"><span data-stu-id="30cd8-194">They are described as follows:</span></span>

* <span data-ttu-id="30cd8-195">**Step 1: Password encryption with 2048-bit RSA Key**: After a user submits a password to be written back to on-premises, the submitted password itself is encrypted with a 2048-bit RSA key.</span><span class="sxs-lookup"><span data-stu-id="30cd8-195">**Step 1: Password encryption with 2048-bit RSA Key**: After a user submits a password to be written back to on-premises, the submitted password itself is encrypted with a 2048-bit RSA key.</span></span>
* <span data-ttu-id="30cd8-196">**Step 2: Package-level encryption with AES-GCM**: The entire package, the password plus the required metadata, is encrypted by using AES-GCM.</span><span class="sxs-lookup"><span data-stu-id="30cd8-196">**Step 2: Package-level encryption with AES-GCM**: The entire package, the password plus the required metadata, is encrypted by using AES-GCM.</span></span> <span data-ttu-id="30cd8-197">This encryption prevents anyone with direct access to the underlying ServiceBus channel from viewing or tampering with the contents.</span><span class="sxs-lookup"><span data-stu-id="30cd8-197">This encryption prevents anyone with direct access to the underlying ServiceBus channel from viewing or tampering with the contents.</span></span>
* <span data-ttu-id="30cd8-198">**Step 3: All communication occurs over TLS/SSL**: All the communication with ServiceBus happens in an SSL/TLS channel.</span><span class="sxs-lookup"><span data-stu-id="30cd8-198">**Step 3: All communication occurs over TLS/SSL**: All the communication with ServiceBus happens in an SSL/TLS channel.</span></span> <span data-ttu-id="30cd8-199">This encryption secures the contents from unauthorized third parties.</span><span class="sxs-lookup"><span data-stu-id="30cd8-199">This encryption secures the contents from unauthorized third parties.</span></span>
* <span data-ttu-id="30cd8-200">**Automatic key roll over every six months**: All keys roll over every six months, or every time password writeback is disabled and then re-enabled on Azure AD Connect, to ensure maximum service security and safety.</span><span class="sxs-lookup"><span data-stu-id="30cd8-200">**Automatic key roll over every six months**: All keys roll over every six months, or every time password writeback is disabled and then re-enabled on Azure AD Connect, to ensure maximum service security and safety.</span></span>

### <a name="password-writeback-bandwidth-usage"></a><span data-ttu-id="30cd8-201">Password writeback bandwidth usage</span><span class="sxs-lookup"><span data-stu-id="30cd8-201">Password writeback bandwidth usage</span></span>

<span data-ttu-id="30cd8-202">Password writeback is a low-bandwidth service that only sends requests back to the on-premises agent under the following circumstances:</span><span class="sxs-lookup"><span data-stu-id="30cd8-202">Password writeback is a low-bandwidth service that only sends requests back to the on-premises agent under the following circumstances:</span></span>

* <span data-ttu-id="30cd8-203">Two messages are sent when the feature is enabled or disabled through Azure AD Connect.</span><span class="sxs-lookup"><span data-stu-id="30cd8-203">Two messages are sent when the feature is enabled or disabled through Azure AD Connect.</span></span>
* <span data-ttu-id="30cd8-204">One message is sent once every five minutes as a service heartbeat for as long as the service is running.</span><span class="sxs-lookup"><span data-stu-id="30cd8-204">One message is sent once every five minutes as a service heartbeat for as long as the service is running.</span></span>
* <span data-ttu-id="30cd8-205">Two messages are sent each time a new password is submitted:</span><span class="sxs-lookup"><span data-stu-id="30cd8-205">Two messages are sent each time a new password is submitted:</span></span>
   * <span data-ttu-id="30cd8-206">The first message is a request to perform the operation.</span><span class="sxs-lookup"><span data-stu-id="30cd8-206">The first message is a request to perform the operation.</span></span>
   * <span data-ttu-id="30cd8-207">The second message contains the result of the operation, and is sent in the following circumstances:</span><span class="sxs-lookup"><span data-stu-id="30cd8-207">The second message contains the result of the operation, and is sent in the following circumstances:</span></span>
      * <span data-ttu-id="30cd8-208">Each time a new password is submitted during a user self-service password reset.</span><span class="sxs-lookup"><span data-stu-id="30cd8-208">Each time a new password is submitted during a user self-service password reset.</span></span>
      * <span data-ttu-id="30cd8-209">Each time a new password is submitted during a user password change operation.</span><span class="sxs-lookup"><span data-stu-id="30cd8-209">Each time a new password is submitted during a user password change operation.</span></span>
      * <span data-ttu-id="30cd8-210">Each time a new password is submitted during an admin-initiated user password reset (only from the Azure admin portals).</span><span class="sxs-lookup"><span data-stu-id="30cd8-210">Each time a new password is submitted during an admin-initiated user password reset (only from the Azure admin portals).</span></span>

#### <a name="message-size-and-bandwidth-considerations"></a><span data-ttu-id="30cd8-211">Message size and bandwidth considerations</span><span class="sxs-lookup"><span data-stu-id="30cd8-211">Message size and bandwidth considerations</span></span>

<span data-ttu-id="30cd8-212">The size of each of the message described previously is typically under 1 KB.</span><span class="sxs-lookup"><span data-stu-id="30cd8-212">The size of each of the message described previously is typically under 1 KB.</span></span> <span data-ttu-id="30cd8-213">Even under extreme loads, the password writeback service itself is consuming a few kilobits per second of bandwidth.</span><span class="sxs-lookup"><span data-stu-id="30cd8-213">Even under extreme loads, the password writeback service itself is consuming a few kilobits per second of bandwidth.</span></span> <span data-ttu-id="30cd8-214">Because each message is sent in real time, only when required by a password update operation, and because the message size is so small, the bandwidth usage of the writeback capability is too small to have a measurable impact.</span><span class="sxs-lookup"><span data-stu-id="30cd8-214">Because each message is sent in real time, only when required by a password update operation, and because the message size is so small, the bandwidth usage of the writeback capability is too small to have a measurable impact.</span></span>

## <a name="supported-writeback-operations"></a><span data-ttu-id="30cd8-215">Supported writeback operations</span><span class="sxs-lookup"><span data-stu-id="30cd8-215">Supported writeback operations</span></span>

<span data-ttu-id="30cd8-216">Passwords are written back in all the following situations:</span><span class="sxs-lookup"><span data-stu-id="30cd8-216">Passwords are written back in all the following situations:</span></span>

* <span data-ttu-id="30cd8-217">**Supported end-user operations**</span><span class="sxs-lookup"><span data-stu-id="30cd8-217">**Supported end-user operations**</span></span>
   * <span data-ttu-id="30cd8-218">Any end-user self-service voluntary change password operation</span><span class="sxs-lookup"><span data-stu-id="30cd8-218">Any end-user self-service voluntary change password operation</span></span>
   * <span data-ttu-id="30cd8-219">Any end-user self-service force change password operation, for example, password expiration</span><span class="sxs-lookup"><span data-stu-id="30cd8-219">Any end-user self-service force change password operation, for example, password expiration</span></span>
   * <span data-ttu-id="30cd8-220">Any end-user self-service password reset that originates from the [password reset portal](https://passwordreset.microsoftonline.com)</span><span class="sxs-lookup"><span data-stu-id="30cd8-220">Any end-user self-service password reset that originates from the [password reset portal](https://passwordreset.microsoftonline.com)</span></span>
* <span data-ttu-id="30cd8-221">**Supported administrator operations**</span><span class="sxs-lookup"><span data-stu-id="30cd8-221">**Supported administrator operations**</span></span>
   * <span data-ttu-id="30cd8-222">Any administrator self-service voluntary change password operation</span><span class="sxs-lookup"><span data-stu-id="30cd8-222">Any administrator self-service voluntary change password operation</span></span>
   * <span data-ttu-id="30cd8-223">Any administrator self-service force change password operation, for example, password expiration</span><span class="sxs-lookup"><span data-stu-id="30cd8-223">Any administrator self-service force change password operation, for example, password expiration</span></span>
   * <span data-ttu-id="30cd8-224">Any administrator self-service password reset that originates from the [password reset portal](https://passwordreset.microsoftonline.com)</span><span class="sxs-lookup"><span data-stu-id="30cd8-224">Any administrator self-service password reset that originates from the [password reset portal](https://passwordreset.microsoftonline.com)</span></span>
   * <span data-ttu-id="30cd8-225">Any administrator-initiated end-user password reset from the [Azure portal](https://portal.azure.com)</span><span class="sxs-lookup"><span data-stu-id="30cd8-225">Any administrator-initiated end-user password reset from the [Azure portal](https://portal.azure.com)</span></span>

## <a name="unsupported-writeback-operations"></a><span data-ttu-id="30cd8-226">Unsupported writeback operations</span><span class="sxs-lookup"><span data-stu-id="30cd8-226">Unsupported writeback operations</span></span>

<span data-ttu-id="30cd8-227">Passwords are *not* written back in any of the following situations:</span><span class="sxs-lookup"><span data-stu-id="30cd8-227">Passwords are *not* written back in any of the following situations:</span></span>

* <span data-ttu-id="30cd8-228">**Unsupported end-user operations**</span><span class="sxs-lookup"><span data-stu-id="30cd8-228">**Unsupported end-user operations**</span></span>
   * <span data-ttu-id="30cd8-229">Any end user resetting their own password by using PowerShell version 1, version 2, or the Azure AD Graph API</span><span class="sxs-lookup"><span data-stu-id="30cd8-229">Any end user resetting their own password by using PowerShell version 1, version 2, or the Azure AD Graph API</span></span>
* <span data-ttu-id="30cd8-230">**Unsupported administrator operations**</span><span class="sxs-lookup"><span data-stu-id="30cd8-230">**Unsupported administrator operations**</span></span>
   * <span data-ttu-id="30cd8-231">Any administrator-initiated end-user password reset from the [Office management portal](https://portal.office.com)</span><span class="sxs-lookup"><span data-stu-id="30cd8-231">Any administrator-initiated end-user password reset from the [Office management portal](https://portal.office.com)</span></span>
   * <span data-ttu-id="30cd8-232">Any administrator-initiated end-user password reset from PowerShell version 1, version 2, or the Azure AD Graph API</span><span class="sxs-lookup"><span data-stu-id="30cd8-232">Any administrator-initiated end-user password reset from PowerShell version 1, version 2, or the Azure AD Graph API</span></span>

## <a name="next-steps"></a><span data-ttu-id="30cd8-233">Next steps</span><span class="sxs-lookup"><span data-stu-id="30cd8-233">Next steps</span></span>

<span data-ttu-id="30cd8-234">Enable password writeback using the Tutorial: [Enabling password writeback](tutorial-enable-writeback.md)</span><span class="sxs-lookup"><span data-stu-id="30cd8-234">Enable password writeback using the Tutorial: [Enabling password writeback](tutorial-enable-writeback.md)</span></span>
