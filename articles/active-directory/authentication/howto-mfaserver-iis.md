---
title: IIS Authentication and Azure MFA Server | Microsoft Docs
description: Deploying IIS Authentication and Azure Multi-Factor Authentication Server.
services: multi-factor-authentication
ms.service: active-directory
ms.component: authentication
ms.topic: conceptual
ms.date: 07/11/2018
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.reviewer: michmcla
ms.openlocfilehash: 6fa0f7250b0714921c631b7f77b3bc9e826b9ba4
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44968313"
---
# <a name="configure-azure-multi-factor-authentication-server-for-iis-web-apps"></a><span data-ttu-id="916b2-103">Configure Azure Multi-Factor Authentication Server for IIS web apps</span><span class="sxs-lookup"><span data-stu-id="916b2-103">Configure Azure Multi-Factor Authentication Server for IIS web apps</span></span>

<span data-ttu-id="916b2-104">Use the IIS Authentication section of the Azure Multi-Factor Authentication (MFA) Server to enable and configure IIS authentication for integration with Microsoft IIS web applications.</span><span class="sxs-lookup"><span data-stu-id="916b2-104">Use the IIS Authentication section of the Azure Multi-Factor Authentication (MFA) Server to enable and configure IIS authentication for integration with Microsoft IIS web applications.</span></span> <span data-ttu-id="916b2-105">The Azure MFA Server installs a plug-in that can filter requests being made to the IIS web server to add Azure Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="916b2-105">The Azure MFA Server installs a plug-in that can filter requests being made to the IIS web server to add Azure Multi-Factor Authentication.</span></span> <span data-ttu-id="916b2-106">The IIS plug-in provides support for Form-Based Authentication and Integrated Windows HTTP Authentication.</span><span class="sxs-lookup"><span data-stu-id="916b2-106">The IIS plug-in provides support for Form-Based Authentication and Integrated Windows HTTP Authentication.</span></span> <span data-ttu-id="916b2-107">Trusted IPs can also be configured to exempt internal IP addresses from two-factor authentication.</span><span class="sxs-lookup"><span data-stu-id="916b2-107">Trusted IPs can also be configured to exempt internal IP addresses from two-factor authentication.</span></span>

![IIS Authentication](./media/howto-mfaserver-iis/iis.png)

## <a name="using-form-based-iis-authentication-with-azure-multi-factor-authentication-server"></a><span data-ttu-id="916b2-109">Using Form-Based IIS Authentication with Azure Multi-Factor Authentication Server</span><span class="sxs-lookup"><span data-stu-id="916b2-109">Using Form-Based IIS Authentication with Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="916b2-110">To secure an IIS web application that uses form-based authentication, install the Azure Multi-Factor Authentication Server on the IIS web server and configure the Server per the following procedure:</span><span class="sxs-lookup"><span data-stu-id="916b2-110">To secure an IIS web application that uses form-based authentication, install the Azure Multi-Factor Authentication Server on the IIS web server and configure the Server per the following procedure:</span></span>

1. <span data-ttu-id="916b2-111">In the Azure Multi-Factor Authentication Server, click the IIS Authentication icon in the left menu.</span><span class="sxs-lookup"><span data-stu-id="916b2-111">In the Azure Multi-Factor Authentication Server, click the IIS Authentication icon in the left menu.</span></span>
2. <span data-ttu-id="916b2-112">Click the **Form-Based** tab.</span><span class="sxs-lookup"><span data-stu-id="916b2-112">Click the **Form-Based** tab.</span></span>
3. <span data-ttu-id="916b2-113">Click **Add**.</span><span class="sxs-lookup"><span data-stu-id="916b2-113">Click **Add**.</span></span>
4. <span data-ttu-id="916b2-114">To detect username, password and domain variables automatically, enter the Login URL (like https://localhost/contoso/auth/login.aspx) within the Auto-Configure Form-Based Website dialog box and click **OK**.</span><span class="sxs-lookup"><span data-stu-id="916b2-114">To detect username, password and domain variables automatically, enter the Login URL (like https://localhost/contoso/auth/login.aspx) within the Auto-Configure Form-Based Website dialog box and click **OK**.</span></span>
5. <span data-ttu-id="916b2-115">Check the **Require Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span><span class="sxs-lookup"><span data-stu-id="916b2-115">Check the **Require Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span></span> <span data-ttu-id="916b2-116">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span><span class="sxs-lookup"><span data-stu-id="916b2-116">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span></span>
6. <span data-ttu-id="916b2-117">If the page variables cannot be detected automatically, click **Specify Manually** in the Auto-Configure Form-Based Website dialog box.</span><span class="sxs-lookup"><span data-stu-id="916b2-117">If the page variables cannot be detected automatically, click **Specify Manually** in the Auto-Configure Form-Based Website dialog box.</span></span>
7. <span data-ttu-id="916b2-118">In the Add Form-Based Website dialog box, enter the URL to the login page in the Submit URL field and enter an Application name (optional).</span><span class="sxs-lookup"><span data-stu-id="916b2-118">In the Add Form-Based Website dialog box, enter the URL to the login page in the Submit URL field and enter an Application name (optional).</span></span> <span data-ttu-id="916b2-119">The Application name appears in Azure Multi-Factor Authentication reports and may be displayed within SMS or Mobile App authentication messages.</span><span class="sxs-lookup"><span data-stu-id="916b2-119">The Application name appears in Azure Multi-Factor Authentication reports and may be displayed within SMS or Mobile App authentication messages.</span></span>
8. <span data-ttu-id="916b2-120">Select the correct Request format.</span><span class="sxs-lookup"><span data-stu-id="916b2-120">Select the correct Request format.</span></span> <span data-ttu-id="916b2-121">This is set to **POST or GET** for most web applications.</span><span class="sxs-lookup"><span data-stu-id="916b2-121">This is set to **POST or GET** for most web applications.</span></span>
9. <span data-ttu-id="916b2-122">Enter the Username variable, Password variable, and Domain variable (if it appears on the login page).</span><span class="sxs-lookup"><span data-stu-id="916b2-122">Enter the Username variable, Password variable, and Domain variable (if it appears on the login page).</span></span> <span data-ttu-id="916b2-123">To find the names of the input boxes, navigate to the login page in a web browser, right-click on the page, and select **View Source**.</span><span class="sxs-lookup"><span data-stu-id="916b2-123">To find the names of the input boxes, navigate to the login page in a web browser, right-click on the page, and select **View Source**.</span></span>
10. <span data-ttu-id="916b2-124">Check the **Require Azure Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span><span class="sxs-lookup"><span data-stu-id="916b2-124">Check the **Require Azure Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span></span> <span data-ttu-id="916b2-125">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span><span class="sxs-lookup"><span data-stu-id="916b2-125">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span></span>
11. <span data-ttu-id="916b2-126">Click **Advanced** to review advanced settings, including:</span><span class="sxs-lookup"><span data-stu-id="916b2-126">Click **Advanced** to review advanced settings, including:</span></span>

  - <span data-ttu-id="916b2-127">Select a custom denial page file</span><span class="sxs-lookup"><span data-stu-id="916b2-127">Select a custom denial page file</span></span>
  - <span data-ttu-id="916b2-128">Cache successful authentications to the website for a period of time using cookies</span><span class="sxs-lookup"><span data-stu-id="916b2-128">Cache successful authentications to the website for a period of time using cookies</span></span>
  - <span data-ttu-id="916b2-129">Select whether to authenticate the primary credentials against a Windows Domain, LDAP directory.</span><span class="sxs-lookup"><span data-stu-id="916b2-129">Select whether to authenticate the primary credentials against a Windows Domain, LDAP directory.</span></span> <span data-ttu-id="916b2-130">or RADIUS server.</span><span class="sxs-lookup"><span data-stu-id="916b2-130">or RADIUS server.</span></span>

12. <span data-ttu-id="916b2-131">Click **OK** to return to the Add Form-Based Website dialog box.</span><span class="sxs-lookup"><span data-stu-id="916b2-131">Click **OK** to return to the Add Form-Based Website dialog box.</span></span>
13. <span data-ttu-id="916b2-132">Click **OK**.</span><span class="sxs-lookup"><span data-stu-id="916b2-132">Click **OK**.</span></span>
14. <span data-ttu-id="916b2-133">Once the URL and page variables have been detected or entered, the website data displays in the Form-Based panel.</span><span class="sxs-lookup"><span data-stu-id="916b2-133">Once the URL and page variables have been detected or entered, the website data displays in the Form-Based panel.</span></span>

## <a name="using-integrated-windows-authentication-with-azure-multi-factor-authentication-server"></a><span data-ttu-id="916b2-134">Using Integrated Windows Authentication with Azure Multi-Factor Authentication Server</span><span class="sxs-lookup"><span data-stu-id="916b2-134">Using Integrated Windows Authentication with Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="916b2-135">To secure an IIS web application that uses Integrated Windows HTTP authentication, install the Azure MFA Server on the IIS web server, then configure the Server with the following steps:</span><span class="sxs-lookup"><span data-stu-id="916b2-135">To secure an IIS web application that uses Integrated Windows HTTP authentication, install the Azure MFA Server on the IIS web server, then configure the Server with the following steps:</span></span>

1. <span data-ttu-id="916b2-136">In the Azure Multi-Factor Authentication Server, click the IIS Authentication icon in the left menu.</span><span class="sxs-lookup"><span data-stu-id="916b2-136">In the Azure Multi-Factor Authentication Server, click the IIS Authentication icon in the left menu.</span></span>
2. <span data-ttu-id="916b2-137">Click the **HTTP** tab.</span><span class="sxs-lookup"><span data-stu-id="916b2-137">Click the **HTTP** tab.</span></span>
3. <span data-ttu-id="916b2-138">Click **Add**.</span><span class="sxs-lookup"><span data-stu-id="916b2-138">Click **Add**.</span></span>
4. <span data-ttu-id="916b2-139">In the Add Base URL dialogue box, enter the URL for the website where HTTP authentication is performed (like http://localhost/owa) and provide an Application name (optional).</span><span class="sxs-lookup"><span data-stu-id="916b2-139">In the Add Base URL dialogue box, enter the URL for the website where HTTP authentication is performed (like http://localhost/owa) and provide an Application name (optional).</span></span> <span data-ttu-id="916b2-140">The Application name appears in Azure Multi-Factor Authentication reports and may be displayed within SMS or Mobile App authentication messages.</span><span class="sxs-lookup"><span data-stu-id="916b2-140">The Application name appears in Azure Multi-Factor Authentication reports and may be displayed within SMS or Mobile App authentication messages.</span></span>
5. <span data-ttu-id="916b2-141">Adjust the Idle timeout and Maximum session times if the default is not sufficient.</span><span class="sxs-lookup"><span data-stu-id="916b2-141">Adjust the Idle timeout and Maximum session times if the default is not sufficient.</span></span>
6. <span data-ttu-id="916b2-142">Check the **Require Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span><span class="sxs-lookup"><span data-stu-id="916b2-142">Check the **Require Multi-Factor Authentication user match** box if all users have been or will be imported into the Server and subject to multi-factor authentication.</span></span> <span data-ttu-id="916b2-143">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span><span class="sxs-lookup"><span data-stu-id="916b2-143">If a significant number of users have not yet been imported into the Server and/or will be exempt from multi-factor authentication, leave the box unchecked.</span></span>
7. <span data-ttu-id="916b2-144">Check the **Cookie cache** box if desired.</span><span class="sxs-lookup"><span data-stu-id="916b2-144">Check the **Cookie cache** box if desired.</span></span>
8. <span data-ttu-id="916b2-145">Click **OK**.</span><span class="sxs-lookup"><span data-stu-id="916b2-145">Click **OK**.</span></span>

## <a name="enable-iis-plug-ins-for-azure-multi-factor-authentication-server"></a><span data-ttu-id="916b2-146">Enable IIS Plug-ins for Azure Multi-Factor Authentication Server</span><span class="sxs-lookup"><span data-stu-id="916b2-146">Enable IIS Plug-ins for Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="916b2-147">After configuring the Form-Based or HTTP authentication URLs and settings, select the locations where the Azure Multi-Factor Authentication IIS plug-ins should be loaded and enabled in IIS.</span><span class="sxs-lookup"><span data-stu-id="916b2-147">After configuring the Form-Based or HTTP authentication URLs and settings, select the locations where the Azure Multi-Factor Authentication IIS plug-ins should be loaded and enabled in IIS.</span></span> <span data-ttu-id="916b2-148">Use the following procedure:</span><span class="sxs-lookup"><span data-stu-id="916b2-148">Use the following procedure:</span></span>

1. <span data-ttu-id="916b2-149">If running on IIS 6, click the **ISAPI** tab. Select the website that the web application is running under (e.g. Default Web Site) to enable the Azure Multi-Factor Authentication ISAPI filter plug-in for that site.</span><span class="sxs-lookup"><span data-stu-id="916b2-149">If running on IIS 6, click the **ISAPI** tab. Select the website that the web application is running under (e.g. Default Web Site) to enable the Azure Multi-Factor Authentication ISAPI filter plug-in for that site.</span></span>
2. <span data-ttu-id="916b2-150">If running on IIS 7 or higher, click the **Native Module** tab. Select the server, websites, or applications to enable the IIS plug-in at the desired levels.</span><span class="sxs-lookup"><span data-stu-id="916b2-150">If running on IIS 7 or higher, click the **Native Module** tab. Select the server, websites, or applications to enable the IIS plug-in at the desired levels.</span></span>
3. <span data-ttu-id="916b2-151">Click the **Enable IIS authentication** box at the top of the screen.</span><span class="sxs-lookup"><span data-stu-id="916b2-151">Click the **Enable IIS authentication** box at the top of the screen.</span></span> <span data-ttu-id="916b2-152">Azure Multi-Factor Authentication is now securing the selected IIS application.</span><span class="sxs-lookup"><span data-stu-id="916b2-152">Azure Multi-Factor Authentication is now securing the selected IIS application.</span></span> <span data-ttu-id="916b2-153">Ensure that users have been imported into the Server.</span><span class="sxs-lookup"><span data-stu-id="916b2-153">Ensure that users have been imported into the Server.</span></span>

## <a name="trusted-ips"></a><span data-ttu-id="916b2-154">Trusted IPs</span><span class="sxs-lookup"><span data-stu-id="916b2-154">Trusted IPs</span></span>
<span data-ttu-id="916b2-155">The Trusted IPs allows users to bypass Azure Multi-Factor Authentication for website requests originating from specific IP addresses or subnets.</span><span class="sxs-lookup"><span data-stu-id="916b2-155">The Trusted IPs allows users to bypass Azure Multi-Factor Authentication for website requests originating from specific IP addresses or subnets.</span></span> <span data-ttu-id="916b2-156">For example, you may want to exempt users from Azure Multi-Factor Authentication while logging in from the office.</span><span class="sxs-lookup"><span data-stu-id="916b2-156">For example, you may want to exempt users from Azure Multi-Factor Authentication while logging in from the office.</span></span> <span data-ttu-id="916b2-157">For this, you would specify the office subnet as a Trusted IPs entry.</span><span class="sxs-lookup"><span data-stu-id="916b2-157">For this, you would specify the office subnet as a Trusted IPs entry.</span></span> <span data-ttu-id="916b2-158">To configure Trusted IPs, use the following procedure:</span><span class="sxs-lookup"><span data-stu-id="916b2-158">To configure Trusted IPs, use the following procedure:</span></span>

1. <span data-ttu-id="916b2-159">In the IIS Authentication section, click the **Trusted IPs** tab.</span><span class="sxs-lookup"><span data-stu-id="916b2-159">In the IIS Authentication section, click the **Trusted IPs** tab.</span></span>
2. <span data-ttu-id="916b2-160">Click **Add**.</span><span class="sxs-lookup"><span data-stu-id="916b2-160">Click **Add**.</span></span>
3. <span data-ttu-id="916b2-161">When the Add Trusted IPs dialog box appears, select the **Single IP**, **IP range**, or **Subnet** radio button.</span><span class="sxs-lookup"><span data-stu-id="916b2-161">When the Add Trusted IPs dialog box appears, select the **Single IP**, **IP range**, or **Subnet** radio button.</span></span>
4. <span data-ttu-id="916b2-162">Enter the IP address, range of IP addresses or subnet that should be whitelisted.</span><span class="sxs-lookup"><span data-stu-id="916b2-162">Enter the IP address, range of IP addresses or subnet that should be whitelisted.</span></span> <span data-ttu-id="916b2-163">If entering a subnet, select the appropriate Netmask and click **OK**.</span><span class="sxs-lookup"><span data-stu-id="916b2-163">If entering a subnet, select the appropriate Netmask and click **OK**.</span></span> <span data-ttu-id="916b2-164">The whitelist has now been added.</span><span class="sxs-lookup"><span data-stu-id="916b2-164">The whitelist has now been added.</span></span>
