---
title: Upgrade PhoneFactor to Azure MFA Server | Microsoft Docs
description: Get started with Azure MFA Server when you upgrade from the older phonefactor agent.
services: multi-factor-authentication
ms.service: active-directory
ms.component: authentication
ms.topic: conceptual
ms.date: 07/11/2018
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.reviewer: michmcla
ms.openlocfilehash: f9e67a34ec1237eab0d1c567720cf905acda5def
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44868757"
---
# <a name="upgrade-the-phonefactor-agent-to-azure-multi-factor-authentication-server"></a><span data-ttu-id="38d08-103">Upgrade the PhoneFactor Agent to Azure Multi-Factor Authentication Server</span><span class="sxs-lookup"><span data-stu-id="38d08-103">Upgrade the PhoneFactor Agent to Azure Multi-Factor Authentication Server</span></span>

<span data-ttu-id="38d08-104">To upgrade the PhoneFactor Agent v5.x or older to Azure Multi-Factor Authentication Server, uninstall the PhoneFactor Agent and affiliated components first.</span><span class="sxs-lookup"><span data-stu-id="38d08-104">To upgrade the PhoneFactor Agent v5.x or older to Azure Multi-Factor Authentication Server, uninstall the PhoneFactor Agent and affiliated components first.</span></span> <span data-ttu-id="38d08-105">Then the Multi-Factor Authentication Server and its affiliated components can be installed.</span><span class="sxs-lookup"><span data-stu-id="38d08-105">Then the Multi-Factor Authentication Server and its affiliated components can be installed.</span></span>

## <a name="uninstall-the-phonefactor-agent"></a><span data-ttu-id="38d08-106">Uninstall the PhoneFactor Agent</span><span class="sxs-lookup"><span data-stu-id="38d08-106">Uninstall the PhoneFactor Agent</span></span>

1. <span data-ttu-id="38d08-107">First, back up the PhoneFactor data file.</span><span class="sxs-lookup"><span data-stu-id="38d08-107">First, back up the PhoneFactor data file.</span></span> <span data-ttu-id="38d08-108">The default installation location is C:\Program Files\PhoneFactor\Data\Phonefactor.pfdata.</span><span class="sxs-lookup"><span data-stu-id="38d08-108">The default installation location is C:\Program Files\PhoneFactor\Data\Phonefactor.pfdata.</span></span>

2. <span data-ttu-id="38d08-109">If the User Portal is installed:</span><span class="sxs-lookup"><span data-stu-id="38d08-109">If the User Portal is installed:</span></span>
  1. <span data-ttu-id="38d08-110">Navigate to the install folder and back up the web.config file.</span><span class="sxs-lookup"><span data-stu-id="38d08-110">Navigate to the install folder and back up the web.config file.</span></span> <span data-ttu-id="38d08-111">The default installation location is C:\inetpub\wwwroot\PhoneFactor.</span><span class="sxs-lookup"><span data-stu-id="38d08-111">The default installation location is C:\inetpub\wwwroot\PhoneFactor.</span></span>

  2. <span data-ttu-id="38d08-112">If you have added custom themes to the portal, back up your custom folder below the C:\inetpub\wwwroot\PhoneFactor\App_Themes directory.</span><span class="sxs-lookup"><span data-stu-id="38d08-112">If you have added custom themes to the portal, back up your custom folder below the C:\inetpub\wwwroot\PhoneFactor\App_Themes directory.</span></span>

  3. <span data-ttu-id="38d08-113">Uninstall the User Portal either through the PhoneFactor Agent (only available if installed on the same server as the PhoneFactor Agent) or through Windows Programs and Features.</span><span class="sxs-lookup"><span data-stu-id="38d08-113">Uninstall the User Portal either through the PhoneFactor Agent (only available if installed on the same server as the PhoneFactor Agent) or through Windows Programs and Features.</span></span>

3. <span data-ttu-id="38d08-114">If the Mobile App Web Service is installed:</span><span class="sxs-lookup"><span data-stu-id="38d08-114">If the Mobile App Web Service is installed:</span></span>

  1. <span data-ttu-id="38d08-115">Go to the install folder and back up the web.config file.</span><span class="sxs-lookup"><span data-stu-id="38d08-115">Go to the install folder and back up the web.config file.</span></span> <span data-ttu-id="38d08-116">The default installation location is C:\inetpub\wwwroot\PhoneFactorPhoneAppWebService.</span><span class="sxs-lookup"><span data-stu-id="38d08-116">The default installation location is C:\inetpub\wwwroot\PhoneFactorPhoneAppWebService.</span></span>

  2. <span data-ttu-id="38d08-117">Uninstall the Mobile App Web Service through Windows Programs and Features.</span><span class="sxs-lookup"><span data-stu-id="38d08-117">Uninstall the Mobile App Web Service through Windows Programs and Features.</span></span>

4. <span data-ttu-id="38d08-118">If the Web Service SDK is installed, uninstall it either through the PhoneFactor Agent or through Windows Programs and Features.</span><span class="sxs-lookup"><span data-stu-id="38d08-118">If the Web Service SDK is installed, uninstall it either through the PhoneFactor Agent or through Windows Programs and Features.</span></span>

5. <span data-ttu-id="38d08-119">Uninstall the PhoneFactor Agent through Windows Programs and Features.</span><span class="sxs-lookup"><span data-stu-id="38d08-119">Uninstall the PhoneFactor Agent through Windows Programs and Features.</span></span>

## <a name="install-the-multi-factor-authentication-server"></a><span data-ttu-id="38d08-120">Install the Multi-Factor Authentication Server</span><span class="sxs-lookup"><span data-stu-id="38d08-120">Install the Multi-Factor Authentication Server</span></span>

<span data-ttu-id="38d08-121">The installation path is picked up from the registry from the previous PhoneFactor Agent installation, so it should install in the same location (for example, C:\Program Files\PhoneFactor).</span><span class="sxs-lookup"><span data-stu-id="38d08-121">The installation path is picked up from the registry from the previous PhoneFactor Agent installation, so it should install in the same location (for example, C:\Program Files\PhoneFactor).</span></span> <span data-ttu-id="38d08-122">New installations have a different default install path (for example, C:\Program Files\Multi-Factor Authentication Server).</span><span class="sxs-lookup"><span data-stu-id="38d08-122">New installations have a different default install path (for example, C:\Program Files\Multi-Factor Authentication Server).</span></span> <span data-ttu-id="38d08-123">The data file left by the previous PhoneFactor Agent should be upgraded during installation, so your users and settings should still be there after installing the new Multi-Factor Authentication Server.</span><span class="sxs-lookup"><span data-stu-id="38d08-123">The data file left by the previous PhoneFactor Agent should be upgraded during installation, so your users and settings should still be there after installing the new Multi-Factor Authentication Server.</span></span>

1. <span data-ttu-id="38d08-124">If prompted, activate the Multi-Factor Authentication Server and ensure it is assigned to the correct replication group.</span><span class="sxs-lookup"><span data-stu-id="38d08-124">If prompted, activate the Multi-Factor Authentication Server and ensure it is assigned to the correct replication group.</span></span>

2. <span data-ttu-id="38d08-125">If the Web Service SDK was previously installed, install the new Web Service SDK through the Multi-Factor Authentication Server User Interface.</span><span class="sxs-lookup"><span data-stu-id="38d08-125">If the Web Service SDK was previously installed, install the new Web Service SDK through the Multi-Factor Authentication Server User Interface.</span></span>

  <span data-ttu-id="38d08-126">The default virtual directory name is now **MultiFactorAuthWebServiceSdk** instead of **PhoneFactorWebServiceSdk**.</span><span class="sxs-lookup"><span data-stu-id="38d08-126">The default virtual directory name is now **MultiFactorAuthWebServiceSdk** instead of **PhoneFactorWebServiceSdk**.</span></span> <span data-ttu-id="38d08-127">If you want to use the previous name, you must change the name of the virtual directory during installation.</span><span class="sxs-lookup"><span data-stu-id="38d08-127">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="38d08-128">Otherwise, if you allow the install to use the new default name, you have to change the URL in any applications that reference the Web Service SDK (like the User Portal and Mobile App Web Service) to point at the correct location.</span><span class="sxs-lookup"><span data-stu-id="38d08-128">Otherwise, if you allow the install to use the new default name, you have to change the URL in any applications that reference the Web Service SDK (like the User Portal and Mobile App Web Service) to point at the correct location.</span></span>

3. <span data-ttu-id="38d08-129">If the User Portal was previously installed on the PhoneFactor Agent Server, install the new Multi-Factor Authentication User Portal through the Multi-Factor Authentication Server User Interface.</span><span class="sxs-lookup"><span data-stu-id="38d08-129">If the User Portal was previously installed on the PhoneFactor Agent Server, install the new Multi-Factor Authentication User Portal through the Multi-Factor Authentication Server User Interface.</span></span>

  <span data-ttu-id="38d08-130">The default virtual directory name is now **MultiFactorAuth** instead of **PhoneFactor**.</span><span class="sxs-lookup"><span data-stu-id="38d08-130">The default virtual directory name is now **MultiFactorAuth** instead of **PhoneFactor**.</span></span> <span data-ttu-id="38d08-131">If you want to use the previous name, you must change the name of the virtual directory during installation.</span><span class="sxs-lookup"><span data-stu-id="38d08-131">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="38d08-132">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab.</span><span class="sxs-lookup"><span data-stu-id="38d08-132">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab.</span></span>

4. <span data-ttu-id="38d08-133">If the User Portal and/or Mobile App Web Service was previously installed on a different server from the PhoneFactor Agent:</span><span class="sxs-lookup"><span data-stu-id="38d08-133">If the User Portal and/or Mobile App Web Service was previously installed on a different server from the PhoneFactor Agent:</span></span>

  1. <span data-ttu-id="38d08-134">Go to the install location (for example, C:\Program Files\PhoneFactor) and copy one or more installers to the other server.</span><span class="sxs-lookup"><span data-stu-id="38d08-134">Go to the install location (for example, C:\Program Files\PhoneFactor) and copy one or more installers to the other server.</span></span> <span data-ttu-id="38d08-135">There are 32-bit and 64-bit installers for both the User Portal and Mobile App Web Service.</span><span class="sxs-lookup"><span data-stu-id="38d08-135">There are 32-bit and 64-bit installers for both the User Portal and Mobile App Web Service.</span></span> <span data-ttu-id="38d08-136">They are called MultiFactorAuthenticationUserPortalSetupXX.msi and MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="38d08-136">They are called MultiFactorAuthenticationUserPortalSetupXX.msi and MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span></span>

  2. <span data-ttu-id="38d08-137">To install the User Portal on the web server, open a command prompt as an administrator and run MultiFactorAuthenticationUserPortalSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="38d08-137">To install the User Portal on the web server, open a command prompt as an administrator and run MultiFactorAuthenticationUserPortalSetupXX.msi.</span></span>

    <span data-ttu-id="38d08-138">The default virtual directory name is now **MultiFactorAuth** instead of **PhoneFactor**.</span><span class="sxs-lookup"><span data-stu-id="38d08-138">The default virtual directory name is now **MultiFactorAuth** instead of **PhoneFactor**.</span></span> <span data-ttu-id="38d08-139">If you want to use the previous name, you must change the name of the virtual directory during installation.</span><span class="sxs-lookup"><span data-stu-id="38d08-139">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="38d08-140">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab. Existing users need to be informed of the new URL.</span><span class="sxs-lookup"><span data-stu-id="38d08-140">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab. Existing users need to be informed of the new URL.</span></span>

  3. <span data-ttu-id="38d08-141">Go to the User Portal install location (for example, C:\inetpub\wwwroot\MultiFactorAuth) and edit the web.config file.</span><span class="sxs-lookup"><span data-stu-id="38d08-141">Go to the User Portal install location (for example, C:\inetpub\wwwroot\MultiFactorAuth) and edit the web.config file.</span></span> <span data-ttu-id="38d08-142">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up before the upgrade into the new web.config file.</span><span class="sxs-lookup"><span data-stu-id="38d08-142">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up before the upgrade into the new web.config file.</span></span> <span data-ttu-id="38d08-143">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span><span class="sxs-lookup"><span data-stu-id="38d08-143">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span></span> <span data-ttu-id="38d08-144">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span><span class="sxs-lookup"><span data-stu-id="38d08-144">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span></span>

> [!NOTE]
> <span data-ttu-id="38d08-145">When upgrading from a version of Azure MFA Server older than 8.0 to 8.0+ that the mobile app web service can be uninstalled after the upgrade</span><span class="sxs-lookup"><span data-stu-id="38d08-145">When upgrading from a version of Azure MFA Server older than 8.0 to 8.0+ that the mobile app web service can be uninstalled after the upgrade</span></span>

## <a name="next-steps"></a><span data-ttu-id="38d08-146">Next steps</span><span class="sxs-lookup"><span data-stu-id="38d08-146">Next steps</span></span>

- <span data-ttu-id="38d08-147">[Install the users portal](howto-mfaserver-deploy-userportal.md) for the Azure Multi-Factor Authentication Server.</span><span class="sxs-lookup"><span data-stu-id="38d08-147">[Install the users portal](howto-mfaserver-deploy-userportal.md) for the Azure Multi-Factor Authentication Server.</span></span>

- <span data-ttu-id="38d08-148">[Configure Windows Authentication](howto-mfaserver-windows.md) for your applications.</span><span class="sxs-lookup"><span data-stu-id="38d08-148">[Configure Windows Authentication](howto-mfaserver-windows.md) for your applications.</span></span> 
