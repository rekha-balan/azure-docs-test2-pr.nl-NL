---
title: Remote Desktop Gateway integration with Azure MFA NPS extension | Microsoft Docs
description: Integrate your Remote Desktop Gateway infrastructure with Azure MFA using the Network Policy Server extension for Microsoft Azure
services: multi-factor-authentication
ms.service: active-directory
ms.component: authentication
ms.topic: conceptual
ms.date: 07/11/2018
ms.author: joflore
author: MicrosoftGuyJFlo
manager: mtillman
ms.reviewer: michmcla
ms.openlocfilehash: 6348a6d003aa3efcd1b9c45e61438e0ac4b4c8d5
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44856783"
---
# <a name="integrate-your-remote-desktop-gateway-infrastructure-using-the-network-policy-server-nps-extension-and-azure-ad"></a><span data-ttu-id="42e7e-103">Integrate your Remote Desktop Gateway infrastructure using the Network Policy Server (NPS) extension and Azure AD</span><span class="sxs-lookup"><span data-stu-id="42e7e-103">Integrate your Remote Desktop Gateway infrastructure using the Network Policy Server (NPS) extension and Azure AD</span></span>

<span data-ttu-id="42e7e-104">This article provides details for integrating your Remote Desktop Gateway infrastructure with Azure Multi-Factor Authentication (MFA) using the Network Policy Server (NPS) extension for Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="42e7e-104">This article provides details for integrating your Remote Desktop Gateway infrastructure with Azure Multi-Factor Authentication (MFA) using the Network Policy Server (NPS) extension for Microsoft Azure.</span></span> 

<span data-ttu-id="42e7e-105">The Network Policy Server (NPS) extension for Azure allows customers to safeguard Remote Authentication Dial-In User Service (RADIUS) client authentication using Azure’s cloud-based [Multi-Factor Authentication (MFA)](multi-factor-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="42e7e-105">The Network Policy Server (NPS) extension for Azure allows customers to safeguard Remote Authentication Dial-In User Service (RADIUS) client authentication using Azure’s cloud-based [Multi-Factor Authentication (MFA)](multi-factor-authentication.md).</span></span> <span data-ttu-id="42e7e-106">This solution provides two-step verification for adding a second layer of security to user sign-ins and transactions.</span><span class="sxs-lookup"><span data-stu-id="42e7e-106">This solution provides two-step verification for adding a second layer of security to user sign-ins and transactions.</span></span>

<span data-ttu-id="42e7e-107">This article provides step-by-step instructions for integrating the NPS infrastructure with Azure MFA using the NPS extension for Azure.</span><span class="sxs-lookup"><span data-stu-id="42e7e-107">This article provides step-by-step instructions for integrating the NPS infrastructure with Azure MFA using the NPS extension for Azure.</span></span> <span data-ttu-id="42e7e-108">This enables secure verification for users attempting to sign in to a Remote Desktop Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-108">This enables secure verification for users attempting to sign in to a Remote Desktop Gateway.</span></span> 

<span data-ttu-id="42e7e-109">The Network Policy and Access Services (NPS) gives organizations the ability to do the following:</span><span class="sxs-lookup"><span data-stu-id="42e7e-109">The Network Policy and Access Services (NPS) gives organizations the ability to do the following:</span></span>
* <span data-ttu-id="42e7e-110">Define central locations for the management and control of network requests by specifying who can connect, what times of day connections are allowed, the duration of connections, and the level of security that clients must use to connect, and so on.</span><span class="sxs-lookup"><span data-stu-id="42e7e-110">Define central locations for the management and control of network requests by specifying who can connect, what times of day connections are allowed, the duration of connections, and the level of security that clients must use to connect, and so on.</span></span> <span data-ttu-id="42e7e-111">Rather than specifying these policies on each VPN or Remote Desktop (RD) Gateway server, these policies can be specified once in a central location.</span><span class="sxs-lookup"><span data-stu-id="42e7e-111">Rather than specifying these policies on each VPN or Remote Desktop (RD) Gateway server, these policies can be specified once in a central location.</span></span> <span data-ttu-id="42e7e-112">The RADIUS protocol provides the centralized Authentication, Authorization, and Accounting (AAA).</span><span class="sxs-lookup"><span data-stu-id="42e7e-112">The RADIUS protocol provides the centralized Authentication, Authorization, and Accounting (AAA).</span></span> 
* <span data-ttu-id="42e7e-113">Establish and enforce Network Access Protection (NAP) client health policies that determine whether devices are granted unrestricted or restricted access to network resources.</span><span class="sxs-lookup"><span data-stu-id="42e7e-113">Establish and enforce Network Access Protection (NAP) client health policies that determine whether devices are granted unrestricted or restricted access to network resources.</span></span>
* <span data-ttu-id="42e7e-114">Provide a means to enforce authentication and authorization for access to 802.1x-capable wireless access points and Ethernet switches.</span><span class="sxs-lookup"><span data-stu-id="42e7e-114">Provide a means to enforce authentication and authorization for access to 802.1x-capable wireless access points and Ethernet switches.</span></span>    

<span data-ttu-id="42e7e-115">Typically, organizations use NPS (RADIUS) to simplify and centralize the management of VPN polices.</span><span class="sxs-lookup"><span data-stu-id="42e7e-115">Typically, organizations use NPS (RADIUS) to simplify and centralize the management of VPN polices.</span></span> <span data-ttu-id="42e7e-116">However, many organizations also use NPS to simplify and centralize the management of RD Desktop Connection Authorization Policies (RD CAPs).</span><span class="sxs-lookup"><span data-stu-id="42e7e-116">However, many organizations also use NPS to simplify and centralize the management of RD Desktop Connection Authorization Policies (RD CAPs).</span></span> 

<span data-ttu-id="42e7e-117">Organizations can also integrate NPS with Azure MFA to enhance security and provide a high level of compliance.</span><span class="sxs-lookup"><span data-stu-id="42e7e-117">Organizations can also integrate NPS with Azure MFA to enhance security and provide a high level of compliance.</span></span> <span data-ttu-id="42e7e-118">This helps ensure that users establish two-step verification to sign in to the Remote Desktop Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-118">This helps ensure that users establish two-step verification to sign in to the Remote Desktop Gateway.</span></span> <span data-ttu-id="42e7e-119">For users to be granted access, they must provide their username/password combination along with information that the user has in their control.</span><span class="sxs-lookup"><span data-stu-id="42e7e-119">For users to be granted access, they must provide their username/password combination along with information that the user has in their control.</span></span> <span data-ttu-id="42e7e-120">This information must be trusted and not easily duplicated, such as a cell phone number, landline number, application on a mobile device, and so on.</span><span class="sxs-lookup"><span data-stu-id="42e7e-120">This information must be trusted and not easily duplicated, such as a cell phone number, landline number, application on a mobile device, and so on.</span></span>

<span data-ttu-id="42e7e-121">Prior to the availability of the NPS extension for Azure, customers who wished to implement two-step verification for integrated NPS and Azure MFA environments had to configure and maintain a separate MFA Server in the on-premises environment as documented in [Remote Desktop Gateway and Azure Multi-Factor Authentication Server using RADIUS](howto-mfaserver-nps-rdg.md).</span><span class="sxs-lookup"><span data-stu-id="42e7e-121">Prior to the availability of the NPS extension for Azure, customers who wished to implement two-step verification for integrated NPS and Azure MFA environments had to configure and maintain a separate MFA Server in the on-premises environment as documented in [Remote Desktop Gateway and Azure Multi-Factor Authentication Server using RADIUS](howto-mfaserver-nps-rdg.md).</span></span>

<span data-ttu-id="42e7e-122">The availability of the NPS extension for Azure now gives organizations the choice to deploy either an on-premises based MFA solution or a cloud-based MFA solution to secure RADIUS client authentication.</span><span class="sxs-lookup"><span data-stu-id="42e7e-122">The availability of the NPS extension for Azure now gives organizations the choice to deploy either an on-premises based MFA solution or a cloud-based MFA solution to secure RADIUS client authentication.</span></span>

## <a name="authentication-flow"></a><span data-ttu-id="42e7e-123">Authentication Flow</span><span class="sxs-lookup"><span data-stu-id="42e7e-123">Authentication Flow</span></span>

<span data-ttu-id="42e7e-124">For users to be granted access to network resources through a Remote Desktop Gateway, they must meet the conditions specified in one RD Connection Authorization Policy (RD CAP) and one RD Resource Authorization Policy (RD RAP).</span><span class="sxs-lookup"><span data-stu-id="42e7e-124">For users to be granted access to network resources through a Remote Desktop Gateway, they must meet the conditions specified in one RD Connection Authorization Policy (RD CAP) and one RD Resource Authorization Policy (RD RAP).</span></span> <span data-ttu-id="42e7e-125">RD CAPs specify who is authorized to connect to RD Gateways.</span><span class="sxs-lookup"><span data-stu-id="42e7e-125">RD CAPs specify who is authorized to connect to RD Gateways.</span></span> <span data-ttu-id="42e7e-126">RD RAPs specify the network resources, such as remote desktops or remote apps, that the user is allowed to connect to through the RD Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-126">RD RAPs specify the network resources, such as remote desktops or remote apps, that the user is allowed to connect to through the RD Gateway.</span></span> 

<span data-ttu-id="42e7e-127">An RD Gateway can be configured to use a central policy store for RD CAPs.</span><span class="sxs-lookup"><span data-stu-id="42e7e-127">An RD Gateway can be configured to use a central policy store for RD CAPs.</span></span> <span data-ttu-id="42e7e-128">RD RAPs cannot use a central policy, as they are processed on the RD Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-128">RD RAPs cannot use a central policy, as they are processed on the RD Gateway.</span></span> <span data-ttu-id="42e7e-129">An example of an RD Gateway configured to use a central policy store for RD CAPs is a RADIUS client to another NPS server that serves as the central policy store.</span><span class="sxs-lookup"><span data-stu-id="42e7e-129">An example of an RD Gateway configured to use a central policy store for RD CAPs is a RADIUS client to another NPS server that serves as the central policy store.</span></span>

<span data-ttu-id="42e7e-130">When the NPS extension for Azure is integrated with the NPS and Remote Desktop Gateway, the successful authentication flow is as follows:</span><span class="sxs-lookup"><span data-stu-id="42e7e-130">When the NPS extension for Azure is integrated with the NPS and Remote Desktop Gateway, the successful authentication flow is as follows:</span></span>

1. <span data-ttu-id="42e7e-131">The Remote Desktop Gateway server receives an authentication request from a remote desktop user to connect to a resource, such as a Remote Desktop session.</span><span class="sxs-lookup"><span data-stu-id="42e7e-131">The Remote Desktop Gateway server receives an authentication request from a remote desktop user to connect to a resource, such as a Remote Desktop session.</span></span> <span data-ttu-id="42e7e-132">Acting as a RADIUS client, the Remote Desktop Gateway server converts the request to a RADIUS Access-Request message and sends the message to the RADIUS (NPS) server where the NPS extension is installed.</span><span class="sxs-lookup"><span data-stu-id="42e7e-132">Acting as a RADIUS client, the Remote Desktop Gateway server converts the request to a RADIUS Access-Request message and sends the message to the RADIUS (NPS) server where the NPS extension is installed.</span></span> 
2. <span data-ttu-id="42e7e-133">The username and password combination is verified in Active Directory and the user is authenticated.</span><span class="sxs-lookup"><span data-stu-id="42e7e-133">The username and password combination is verified in Active Directory and the user is authenticated.</span></span>
3. <span data-ttu-id="42e7e-134">If all the conditions as specified in the NPS Connection Request and the Network Policies are met (for example, time of day or group membership restrictions), the NPS extension triggers a request for secondary authentication with Azure MFA.</span><span class="sxs-lookup"><span data-stu-id="42e7e-134">If all the conditions as specified in the NPS Connection Request and the Network Policies are met (for example, time of day or group membership restrictions), the NPS extension triggers a request for secondary authentication with Azure MFA.</span></span> 
4. <span data-ttu-id="42e7e-135">Azure MFA communicates with Azure AD, retrieves the user’s details, and performs the secondary authentication using the method configured by the user (text message, mobile app, and so on).</span><span class="sxs-lookup"><span data-stu-id="42e7e-135">Azure MFA communicates with Azure AD, retrieves the user’s details, and performs the secondary authentication using the method configured by the user (text message, mobile app, and so on).</span></span> 
5. <span data-ttu-id="42e7e-136">Upon success of the MFA challenge, Azure MFA communicates the result to the NPS extension.</span><span class="sxs-lookup"><span data-stu-id="42e7e-136">Upon success of the MFA challenge, Azure MFA communicates the result to the NPS extension.</span></span>
6. <span data-ttu-id="42e7e-137">The NPS server, where the extension is installed, sends a RADIUS Access-Accept message for the RD CAP policy to the Remote Desktop Gateway server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-137">The NPS server, where the extension is installed, sends a RADIUS Access-Accept message for the RD CAP policy to the Remote Desktop Gateway server.</span></span>
7. <span data-ttu-id="42e7e-138">The user is granted access to the requested network resource through the RD Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-138">The user is granted access to the requested network resource through the RD Gateway.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="42e7e-139">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="42e7e-139">Prerequisites</span></span>
<span data-ttu-id="42e7e-140">This section details the prerequisites necessary before integrating Azure MFA with the Remote Desktop Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-140">This section details the prerequisites necessary before integrating Azure MFA with the Remote Desktop Gateway.</span></span> <span data-ttu-id="42e7e-141">Before you begin, you must have the following prerequisites in place.</span><span class="sxs-lookup"><span data-stu-id="42e7e-141">Before you begin, you must have the following prerequisites in place.</span></span>  

* <span data-ttu-id="42e7e-142">Remote Desktop Services (RDS) infrastructure</span><span class="sxs-lookup"><span data-stu-id="42e7e-142">Remote Desktop Services (RDS) infrastructure</span></span>
* <span data-ttu-id="42e7e-143">Azure MFA License</span><span class="sxs-lookup"><span data-stu-id="42e7e-143">Azure MFA License</span></span>
* <span data-ttu-id="42e7e-144">Windows Server software</span><span class="sxs-lookup"><span data-stu-id="42e7e-144">Windows Server software</span></span>
* <span data-ttu-id="42e7e-145">Network Policy and Access Services (NPS) role</span><span class="sxs-lookup"><span data-stu-id="42e7e-145">Network Policy and Access Services (NPS) role</span></span>
* <span data-ttu-id="42e7e-146">Azure Active Directory synched with on-premises Active Directory</span><span class="sxs-lookup"><span data-stu-id="42e7e-146">Azure Active Directory synched with on-premises Active Directory</span></span>
* <span data-ttu-id="42e7e-147">Azure Active Directory GUID ID</span><span class="sxs-lookup"><span data-stu-id="42e7e-147">Azure Active Directory GUID ID</span></span>

### <a name="remote-desktop-services-rds-infrastructure"></a><span data-ttu-id="42e7e-148">Remote Desktop Services (RDS) infrastructure</span><span class="sxs-lookup"><span data-stu-id="42e7e-148">Remote Desktop Services (RDS) infrastructure</span></span>
<span data-ttu-id="42e7e-149">You must have a working Remote Desktop Services (RDS) infrastructure in place.</span><span class="sxs-lookup"><span data-stu-id="42e7e-149">You must have a working Remote Desktop Services (RDS) infrastructure in place.</span></span> <span data-ttu-id="42e7e-150">If you do not, then you can quickly create this infrastructure in Azure using the following quick start template: [Create Remote Desktop Session Collection deployment](https://github.com/Azure/azure-quickstart-templates/tree/ad20c78b36d8e1246f96bb0e7a8741db481f957f/rds-deployment).</span><span class="sxs-lookup"><span data-stu-id="42e7e-150">If you do not, then you can quickly create this infrastructure in Azure using the following quick start template: [Create Remote Desktop Session Collection deployment](https://github.com/Azure/azure-quickstart-templates/tree/ad20c78b36d8e1246f96bb0e7a8741db481f957f/rds-deployment).</span></span> 

<span data-ttu-id="42e7e-151">If you wish to manually create an on-premises RDS infrastructure quickly for testing purposes, follow the steps to deploy one.</span><span class="sxs-lookup"><span data-stu-id="42e7e-151">If you wish to manually create an on-premises RDS infrastructure quickly for testing purposes, follow the steps to deploy one.</span></span> 
<span data-ttu-id="42e7e-152">**Learn more**: [Deploy RDS with Azure quick start](https://docs.microsoft.com/windows-server/remote/remote-desktop-services/rds-in-azure) and [Basic RDS infrastructure deployment](https://docs.microsoft.com/windows-server/remote/remote-desktop-services/rds-deploy-infrastructure).</span><span class="sxs-lookup"><span data-stu-id="42e7e-152">**Learn more**: [Deploy RDS with Azure quick start](https://docs.microsoft.com/windows-server/remote/remote-desktop-services/rds-in-azure) and [Basic RDS infrastructure deployment](https://docs.microsoft.com/windows-server/remote/remote-desktop-services/rds-deploy-infrastructure).</span></span> 

### <a name="azure-mfa-license"></a><span data-ttu-id="42e7e-153">Azure MFA License</span><span class="sxs-lookup"><span data-stu-id="42e7e-153">Azure MFA License</span></span>
<span data-ttu-id="42e7e-154">Required is a license for Azure MFA, which is available through an Azure AD Premium, Enterprise Mobility plus Security (EMS), or an MFA subscription.</span><span class="sxs-lookup"><span data-stu-id="42e7e-154">Required is a license for Azure MFA, which is available through an Azure AD Premium, Enterprise Mobility plus Security (EMS), or an MFA subscription.</span></span> <span data-ttu-id="42e7e-155">Consumption-based licenses for Azure MFA, such as per user or per authentication licenses, are not compatible with the NPS extension.</span><span class="sxs-lookup"><span data-stu-id="42e7e-155">Consumption-based licenses for Azure MFA, such as per user or per authentication licenses, are not compatible with the NPS extension.</span></span> <span data-ttu-id="42e7e-156">For more information, see [How to get Azure Multi-Factor Authentication](concept-mfa-licensing.md).</span><span class="sxs-lookup"><span data-stu-id="42e7e-156">For more information, see [How to get Azure Multi-Factor Authentication](concept-mfa-licensing.md).</span></span> <span data-ttu-id="42e7e-157">For testing purposes, you can use a trial subscription.</span><span class="sxs-lookup"><span data-stu-id="42e7e-157">For testing purposes, you can use a trial subscription.</span></span> 

### <a name="windows-server-software"></a><span data-ttu-id="42e7e-158">Windows Server software</span><span class="sxs-lookup"><span data-stu-id="42e7e-158">Windows Server software</span></span>
<span data-ttu-id="42e7e-159">The NPS extension requires Windows Server 2008 R2 SP1 or above with the NPS role service installed.</span><span class="sxs-lookup"><span data-stu-id="42e7e-159">The NPS extension requires Windows Server 2008 R2 SP1 or above with the NPS role service installed.</span></span> <span data-ttu-id="42e7e-160">All the steps in this section were performed using Windows Server 2016.</span><span class="sxs-lookup"><span data-stu-id="42e7e-160">All the steps in this section were performed using Windows Server 2016.</span></span>

### <a name="network-policy-and-access-services-nps-role"></a><span data-ttu-id="42e7e-161">Network Policy and Access Services (NPS) role</span><span class="sxs-lookup"><span data-stu-id="42e7e-161">Network Policy and Access Services (NPS) role</span></span>
<span data-ttu-id="42e7e-162">The NPS role service provides the RADIUS server and client functionality as well as Network Access Policy health service.</span><span class="sxs-lookup"><span data-stu-id="42e7e-162">The NPS role service provides the RADIUS server and client functionality as well as Network Access Policy health service.</span></span> <span data-ttu-id="42e7e-163">This role must be installed on at least two computers in your infrastructure: The Remote Desktop Gateway and another member server or domain controller.</span><span class="sxs-lookup"><span data-stu-id="42e7e-163">This role must be installed on at least two computers in your infrastructure: The Remote Desktop Gateway and another member server or domain controller.</span></span> <span data-ttu-id="42e7e-164">By default, the role is already present on the computer configured as the Remote Desktop Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-164">By default, the role is already present on the computer configured as the Remote Desktop Gateway.</span></span>  <span data-ttu-id="42e7e-165">You must also install the NPS role on at least on another computer, such as a domain controller or member server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-165">You must also install the NPS role on at least on another computer, such as a domain controller or member server.</span></span>

<span data-ttu-id="42e7e-166">For information on installing the NPS role service Windows Server 2012 or older, see [Install a NAP Health Policy Server](https://technet.microsoft.com/library/dd296890.aspx).</span><span class="sxs-lookup"><span data-stu-id="42e7e-166">For information on installing the NPS role service Windows Server 2012 or older, see [Install a NAP Health Policy Server](https://technet.microsoft.com/library/dd296890.aspx).</span></span> <span data-ttu-id="42e7e-167">For a description of best practices for NPS, including the recommendation to install NPS on a domain controller, see [Best Practices for NPS](https://technet.microsoft.com/library/cc771746).</span><span class="sxs-lookup"><span data-stu-id="42e7e-167">For a description of best practices for NPS, including the recommendation to install NPS on a domain controller, see [Best Practices for NPS](https://technet.microsoft.com/library/cc771746).</span></span>

### <a name="azure-active-directory-synched-with-on-premises-active-directory"></a><span data-ttu-id="42e7e-168">Azure Active Directory synched with on-premises Active Directory</span><span class="sxs-lookup"><span data-stu-id="42e7e-168">Azure Active Directory synched with on-premises Active Directory</span></span>
<span data-ttu-id="42e7e-169">To use the NPS extension, on-premises users must be synced with Azure AD and enabled for MFA.</span><span class="sxs-lookup"><span data-stu-id="42e7e-169">To use the NPS extension, on-premises users must be synced with Azure AD and enabled for MFA.</span></span> <span data-ttu-id="42e7e-170">This section assumes that on-premises users are synched with Azure AD using AD Connect.</span><span class="sxs-lookup"><span data-stu-id="42e7e-170">This section assumes that on-premises users are synched with Azure AD using AD Connect.</span></span> <span data-ttu-id="42e7e-171">For information on Azure AD connect, see [Integrate your on-premises directories with Azure Active Directory](../connect/active-directory-aadconnect.md).</span><span class="sxs-lookup"><span data-stu-id="42e7e-171">For information on Azure AD connect, see [Integrate your on-premises directories with Azure Active Directory](../connect/active-directory-aadconnect.md).</span></span> 

### <a name="azure-active-directory-guid-id"></a><span data-ttu-id="42e7e-172">Azure Active Directory GUID ID</span><span class="sxs-lookup"><span data-stu-id="42e7e-172">Azure Active Directory GUID ID</span></span>
<span data-ttu-id="42e7e-173">To install NPS extension, you need to know the GUID of the Azure AD.</span><span class="sxs-lookup"><span data-stu-id="42e7e-173">To install NPS extension, you need to know the GUID of the Azure AD.</span></span> <span data-ttu-id="42e7e-174">Instructions for finding the GUID of the Azure AD are provided below.</span><span class="sxs-lookup"><span data-stu-id="42e7e-174">Instructions for finding the GUID of the Azure AD are provided below.</span></span>

## <a name="configure-multi-factor-authentication"></a><span data-ttu-id="42e7e-175">Configure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="42e7e-175">Configure Multi-Factor Authentication</span></span> 
<span data-ttu-id="42e7e-176">This section provides instructions for integrating Azure MFA with the Remote Desktop Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-176">This section provides instructions for integrating Azure MFA with the Remote Desktop Gateway.</span></span> <span data-ttu-id="42e7e-177">As an administrator, you must configure the Azure MFA service before users can self-register their multi-factor devices or applications.</span><span class="sxs-lookup"><span data-stu-id="42e7e-177">As an administrator, you must configure the Azure MFA service before users can self-register their multi-factor devices or applications.</span></span>

<span data-ttu-id="42e7e-178">Follow the steps in [Getting started with Azure Multi-Factor Authentication in the cloud](howto-mfa-getstarted.md) to enable MFA for your Azure AD users.</span><span class="sxs-lookup"><span data-stu-id="42e7e-178">Follow the steps in [Getting started with Azure Multi-Factor Authentication in the cloud](howto-mfa-getstarted.md) to enable MFA for your Azure AD users.</span></span> 

### <a name="configure-accounts-for-two-step-verification"></a><span data-ttu-id="42e7e-179">Configure accounts for two-step verification</span><span class="sxs-lookup"><span data-stu-id="42e7e-179">Configure accounts for two-step verification</span></span>
<span data-ttu-id="42e7e-180">Once an account has been enabled for MFA, you cannot sign in to resources governed by the MFA policy until you have successfully configured a trusted device to use for the second authentication factor and have authenticated using two-step verification.</span><span class="sxs-lookup"><span data-stu-id="42e7e-180">Once an account has been enabled for MFA, you cannot sign in to resources governed by the MFA policy until you have successfully configured a trusted device to use for the second authentication factor and have authenticated using two-step verification.</span></span>

<span data-ttu-id="42e7e-181">Follow the steps in [What does Azure Multi-Factor Authentication mean for me?](../user-help/multi-factor-authentication-end-user.md) to understand and properly configure your devices for MFA with your user account.</span><span class="sxs-lookup"><span data-stu-id="42e7e-181">Follow the steps in [What does Azure Multi-Factor Authentication mean for me?](../user-help/multi-factor-authentication-end-user.md) to understand and properly configure your devices for MFA with your user account.</span></span>

## <a name="install-and-configure-nps-extension"></a><span data-ttu-id="42e7e-182">Install and configure NPS extension</span><span class="sxs-lookup"><span data-stu-id="42e7e-182">Install and configure NPS extension</span></span>
<span data-ttu-id="42e7e-183">This section provides instructions for configuring RDS infrastructure to use Azure MFA for client authentication with the Remote Desktop Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-183">This section provides instructions for configuring RDS infrastructure to use Azure MFA for client authentication with the Remote Desktop Gateway.</span></span>

### <a name="acquire-azure-active-directory-guid-id"></a><span data-ttu-id="42e7e-184">Acquire Azure Active Directory GUID ID</span><span class="sxs-lookup"><span data-stu-id="42e7e-184">Acquire Azure Active Directory GUID ID</span></span>

<span data-ttu-id="42e7e-185">As part of the configuration of the NPS extension, you need to supply admin credentials and the Azure AD ID for your Azure AD tenant.</span><span class="sxs-lookup"><span data-stu-id="42e7e-185">As part of the configuration of the NPS extension, you need to supply admin credentials and the Azure AD ID for your Azure AD tenant.</span></span> <span data-ttu-id="42e7e-186">The following steps show you how to get the tenant ID.</span><span class="sxs-lookup"><span data-stu-id="42e7e-186">The following steps show you how to get the tenant ID.</span></span>

1. <span data-ttu-id="42e7e-187">Sign in to the [Azure portal](https://portal.azure.com) as the global administrator of the Azure tenant.</span><span class="sxs-lookup"><span data-stu-id="42e7e-187">Sign in to the [Azure portal](https://portal.azure.com) as the global administrator of the Azure tenant.</span></span>
2. <span data-ttu-id="42e7e-188">In the left navigation, select the **Azure Active Directory** icon.</span><span class="sxs-lookup"><span data-stu-id="42e7e-188">In the left navigation, select the **Azure Active Directory** icon.</span></span>
3. <span data-ttu-id="42e7e-189">Select **Properties**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-189">Select **Properties**.</span></span>
4. <span data-ttu-id="42e7e-190">In the Properties blade, beside the Directory ID, click the **Copy** icon, as shown below, to copy the ID to clipboard.</span><span class="sxs-lookup"><span data-stu-id="42e7e-190">In the Properties blade, beside the Directory ID, click the **Copy** icon, as shown below, to copy the ID to clipboard.</span></span>

 ![Properties](./media/howto-mfa-nps-extension-rdg/image1.png)

### <a name="install-the-nps-extension"></a><span data-ttu-id="42e7e-192">Install the NPS extension</span><span class="sxs-lookup"><span data-stu-id="42e7e-192">Install the NPS extension</span></span>
<span data-ttu-id="42e7e-193">Install the NPS extension on a server that has the Network Policy and Access Services (NPS) role installed.</span><span class="sxs-lookup"><span data-stu-id="42e7e-193">Install the NPS extension on a server that has the Network Policy and Access Services (NPS) role installed.</span></span> <span data-ttu-id="42e7e-194">This functions as the RADIUS server for your design.</span><span class="sxs-lookup"><span data-stu-id="42e7e-194">This functions as the RADIUS server for your design.</span></span> 

>[!Important]
> <span data-ttu-id="42e7e-195">Be sure you do not install the NPS extension on your Remote Desktop Gateway server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-195">Be sure you do not install the NPS extension on your Remote Desktop Gateway server.</span></span>
> 

1. <span data-ttu-id="42e7e-196">Download the [NPS extension](https://aka.ms/npsmfa).</span><span class="sxs-lookup"><span data-stu-id="42e7e-196">Download the [NPS extension](https://aka.ms/npsmfa).</span></span> 
2. <span data-ttu-id="42e7e-197">Copy the setup executable file (NpsExtnForAzureMfaInstaller.exe) to the NPS server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-197">Copy the setup executable file (NpsExtnForAzureMfaInstaller.exe) to the NPS server.</span></span>
3. <span data-ttu-id="42e7e-198">On the NPS server, double-click **NpsExtnForAzureMfaInstaller.exe**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-198">On the NPS server, double-click **NpsExtnForAzureMfaInstaller.exe**.</span></span> <span data-ttu-id="42e7e-199">If prompted, click **Run**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-199">If prompted, click **Run**.</span></span>
4. <span data-ttu-id="42e7e-200">In the NPS Extension For Azure MFA Setup dialog box, review the software license terms, check **I agree to the license terms and conditions**, and click **Install**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-200">In the NPS Extension For Azure MFA Setup dialog box, review the software license terms, check **I agree to the license terms and conditions**, and click **Install**.</span></span>
 
  ![Azure MFA Setup](./media/howto-mfa-nps-extension-rdg/image2.png)

5. <span data-ttu-id="42e7e-202">In the NPS Extension For Azure MFA Setup dialog box, click **Close**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-202">In the NPS Extension For Azure MFA Setup dialog box, click **Close**.</span></span> 

  ![NPS Extension for Azure MFA](./media/howto-mfa-nps-extension-rdg/image3.png)

### <a name="configure-certificates-for-use-with-the-nps-extension-using-a-powershell-script"></a><span data-ttu-id="42e7e-204">Configure certificates for use with the NPS extension using a PowerShell script</span><span class="sxs-lookup"><span data-stu-id="42e7e-204">Configure certificates for use with the NPS extension using a PowerShell script</span></span>
<span data-ttu-id="42e7e-205">Next, you need to configure certificates for use by the NPS extension to ensure secure communications and assurance.</span><span class="sxs-lookup"><span data-stu-id="42e7e-205">Next, you need to configure certificates for use by the NPS extension to ensure secure communications and assurance.</span></span> <span data-ttu-id="42e7e-206">The NPS components include a Windows PowerShell script that configures a self-signed certificate for use with NPS.</span><span class="sxs-lookup"><span data-stu-id="42e7e-206">The NPS components include a Windows PowerShell script that configures a self-signed certificate for use with NPS.</span></span> 

<span data-ttu-id="42e7e-207">The script performs the following actions:</span><span class="sxs-lookup"><span data-stu-id="42e7e-207">The script performs the following actions:</span></span>

* <span data-ttu-id="42e7e-208">Creates a self-signed certificate</span><span class="sxs-lookup"><span data-stu-id="42e7e-208">Creates a self-signed certificate</span></span>
* <span data-ttu-id="42e7e-209">Associates public key of certificate to service principal on Azure AD</span><span class="sxs-lookup"><span data-stu-id="42e7e-209">Associates public key of certificate to service principal on Azure AD</span></span>
* <span data-ttu-id="42e7e-210">Stores the cert in the local machine store</span><span class="sxs-lookup"><span data-stu-id="42e7e-210">Stores the cert in the local machine store</span></span>
* <span data-ttu-id="42e7e-211">Grants access to the certificate’s private key to the network user</span><span class="sxs-lookup"><span data-stu-id="42e7e-211">Grants access to the certificate’s private key to the network user</span></span>
* <span data-ttu-id="42e7e-212">Restarts Network Policy Server service</span><span class="sxs-lookup"><span data-stu-id="42e7e-212">Restarts Network Policy Server service</span></span>

<span data-ttu-id="42e7e-213">If you want to use your own certificates, you need to associate the public key of your certificate to the service principal on Azure AD, and so on.</span><span class="sxs-lookup"><span data-stu-id="42e7e-213">If you want to use your own certificates, you need to associate the public key of your certificate to the service principal on Azure AD, and so on.</span></span>

<span data-ttu-id="42e7e-214">To use the script, provide the extension with your Azure AD Admin credentials and the Azure AD tenant ID that you copied earlier.</span><span class="sxs-lookup"><span data-stu-id="42e7e-214">To use the script, provide the extension with your Azure AD Admin credentials and the Azure AD tenant ID that you copied earlier.</span></span> <span data-ttu-id="42e7e-215">Run the script on each NPS server where you installed the NPS extension.</span><span class="sxs-lookup"><span data-stu-id="42e7e-215">Run the script on each NPS server where you installed the NPS extension.</span></span> <span data-ttu-id="42e7e-216">Then do the following:</span><span class="sxs-lookup"><span data-stu-id="42e7e-216">Then do the following:</span></span>

1. <span data-ttu-id="42e7e-217">Open an administrative Windows PowerShell prompt.</span><span class="sxs-lookup"><span data-stu-id="42e7e-217">Open an administrative Windows PowerShell prompt.</span></span>
2. <span data-ttu-id="42e7e-218">At the PowerShell prompt, type `cd ‘c:\Program Files\Microsoft\AzureMfa\Config’`, and press **ENTER**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-218">At the PowerShell prompt, type `cd ‘c:\Program Files\Microsoft\AzureMfa\Config’`, and press **ENTER**.</span></span>
3. <span data-ttu-id="42e7e-219">Type `.\AzureMfsNpsExtnConfigSetup.ps1`, and press **ENTER**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-219">Type `.\AzureMfsNpsExtnConfigSetup.ps1`, and press **ENTER**.</span></span> <span data-ttu-id="42e7e-220">The script checks to see if the Azure Active Directory PowerShell module is installed.</span><span class="sxs-lookup"><span data-stu-id="42e7e-220">The script checks to see if the Azure Active Directory PowerShell module is installed.</span></span> <span data-ttu-id="42e7e-221">If not installed, the script installs the module for you.</span><span class="sxs-lookup"><span data-stu-id="42e7e-221">If not installed, the script installs the module for you.</span></span>

  ![Azure AD PowerShell](./media/howto-mfa-nps-extension-rdg/image4.png)
  
4. <span data-ttu-id="42e7e-223">After the script verifies the installation of the PowerShell module, it displays the Azure Active Directory PowerShell module dialog box.</span><span class="sxs-lookup"><span data-stu-id="42e7e-223">After the script verifies the installation of the PowerShell module, it displays the Azure Active Directory PowerShell module dialog box.</span></span> <span data-ttu-id="42e7e-224">In the dialog box, enter your Azure AD admin credentials and password, and click **Sign In**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-224">In the dialog box, enter your Azure AD admin credentials and password, and click **Sign In**.</span></span>

  ![Open Powershell account](./media/howto-mfa-nps-extension-rdg/image5.png)

5. <span data-ttu-id="42e7e-226">When prompted, paste the tenant ID you copied to the clipboard earlier, and press **ENTER**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-226">When prompted, paste the tenant ID you copied to the clipboard earlier, and press **ENTER**.</span></span>

  ![Enter Tenant ID](./media/howto-mfa-nps-extension-rdg/image6.png)

6. <span data-ttu-id="42e7e-228">The script creates a self-signed certificate and performs other configuration changes.</span><span class="sxs-lookup"><span data-stu-id="42e7e-228">The script creates a self-signed certificate and performs other configuration changes.</span></span> <span data-ttu-id="42e7e-229">The output should be like the image shown below.</span><span class="sxs-lookup"><span data-stu-id="42e7e-229">The output should be like the image shown below.</span></span>

  ![Self signed certificate](./media/howto-mfa-nps-extension-rdg/image7.png)

## <a name="configure-nps-components-on-remote-desktop-gateway"></a><span data-ttu-id="42e7e-231">Configure NPS components on Remote Desktop Gateway</span><span class="sxs-lookup"><span data-stu-id="42e7e-231">Configure NPS components on Remote Desktop Gateway</span></span>
<span data-ttu-id="42e7e-232">In this section, you configure the Remote Desktop Gateway connection authorization policies and other RADIUS settings.</span><span class="sxs-lookup"><span data-stu-id="42e7e-232">In this section, you configure the Remote Desktop Gateway connection authorization policies and other RADIUS settings.</span></span>

<span data-ttu-id="42e7e-233">The authentication flow requires that RADIUS messages be exchanged between the Remote Desktop Gateway and the NPS server where the NPS Server is installed.</span><span class="sxs-lookup"><span data-stu-id="42e7e-233">The authentication flow requires that RADIUS messages be exchanged between the Remote Desktop Gateway and the NPS server where the NPS Server is installed.</span></span> <span data-ttu-id="42e7e-234">This means that you must configure RADIUS client settings on both Remote Desktop Gateway and the NPS server where the NPS extension is installed.</span><span class="sxs-lookup"><span data-stu-id="42e7e-234">This means that you must configure RADIUS client settings on both Remote Desktop Gateway and the NPS server where the NPS extension is installed.</span></span> 

### <a name="configure-remote-desktop-gateway-connection-authorization-policies-to-use-central-store"></a><span data-ttu-id="42e7e-235">Configure Remote Desktop Gateway connection authorization policies to use central store</span><span class="sxs-lookup"><span data-stu-id="42e7e-235">Configure Remote Desktop Gateway connection authorization policies to use central store</span></span>
<span data-ttu-id="42e7e-236">Remote Desktop connection authorization policies (RD CAPs) specify the requirements for connecting to a Remote Desktop Gateway server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-236">Remote Desktop connection authorization policies (RD CAPs) specify the requirements for connecting to a Remote Desktop Gateway server.</span></span> <span data-ttu-id="42e7e-237">RD CAPs can be stored locally (default) or they can be stored in a central RD CAP store that is running NPS.</span><span class="sxs-lookup"><span data-stu-id="42e7e-237">RD CAPs can be stored locally (default) or they can be stored in a central RD CAP store that is running NPS.</span></span> <span data-ttu-id="42e7e-238">To configure integration of Azure MFA with RDS, you need to specify the use of a central store.</span><span class="sxs-lookup"><span data-stu-id="42e7e-238">To configure integration of Azure MFA with RDS, you need to specify the use of a central store.</span></span>

1. <span data-ttu-id="42e7e-239">On the RD Gateway server, open **Server Manager**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-239">On the RD Gateway server, open **Server Manager**.</span></span> 
2. <span data-ttu-id="42e7e-240">On the menu, click **Tools**, point to **Remote Desktop Services**, and then click **Remote Desktop Gateway Manager**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-240">On the menu, click **Tools**, point to **Remote Desktop Services**, and then click **Remote Desktop Gateway Manager**.</span></span>

  ![Remote Desktop Services](./media/howto-mfa-nps-extension-rdg/image8.png)

3. <span data-ttu-id="42e7e-242">In the RD Gateway Manager, right-click **\[Server Name\] (Local)**, and click **Properties**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-242">In the RD Gateway Manager, right-click **\[Server Name\] (Local)**, and click **Properties**.</span></span>

  ![Server Name](./media/howto-mfa-nps-extension-rdg/image9.png)

4. <span data-ttu-id="42e7e-244">In the Properties dialog box, select the **RD CAP Store** tab.</span><span class="sxs-lookup"><span data-stu-id="42e7e-244">In the Properties dialog box, select the **RD CAP Store** tab.</span></span>
5. <span data-ttu-id="42e7e-245">On the RD CAP Store tab, select **Central server running NPS**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-245">On the RD CAP Store tab, select **Central server running NPS**.</span></span> 
6. <span data-ttu-id="42e7e-246">In the **Enter a name or IP address for the server running NPS** field, type the IP address or server name of the server where you installed the NPS extension.</span><span class="sxs-lookup"><span data-stu-id="42e7e-246">In the **Enter a name or IP address for the server running NPS** field, type the IP address or server name of the server where you installed the NPS extension.</span></span>

  ![Enter Name or IP Address](./media/howto-mfa-nps-extension-rdg/image10.png)
  
7. <span data-ttu-id="42e7e-248">Click **Add**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-248">Click **Add**.</span></span>
8. <span data-ttu-id="42e7e-249">In the **Shared Secret** dialog box, enter a shared secret, and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-249">In the **Shared Secret** dialog box, enter a shared secret, and then click **OK**.</span></span> <span data-ttu-id="42e7e-250">Ensure you record this shared secret and store the record securely.</span><span class="sxs-lookup"><span data-stu-id="42e7e-250">Ensure you record this shared secret and store the record securely.</span></span>

 >[!NOTE]
 ><span data-ttu-id="42e7e-251">Shared secret is used to establish trust between the RADIUS servers and clients.</span><span class="sxs-lookup"><span data-stu-id="42e7e-251">Shared secret is used to establish trust between the RADIUS servers and clients.</span></span> <span data-ttu-id="42e7e-252">Create a long and complex secret.</span><span class="sxs-lookup"><span data-stu-id="42e7e-252">Create a long and complex secret.</span></span>
 >

 ![Shared Secret](./media/howto-mfa-nps-extension-rdg/image11.png)

9. <span data-ttu-id="42e7e-254">Click **OK** to close the dialog box.</span><span class="sxs-lookup"><span data-stu-id="42e7e-254">Click **OK** to close the dialog box.</span></span>

### <a name="configure-radius-timeout-value-on-remote-desktop-gateway-nps"></a><span data-ttu-id="42e7e-255">Configure RADIUS timeout value on Remote Desktop Gateway NPS</span><span class="sxs-lookup"><span data-stu-id="42e7e-255">Configure RADIUS timeout value on Remote Desktop Gateway NPS</span></span>
<span data-ttu-id="42e7e-256">To ensure there is time to validate users’ credentials, perform two-step verification, receive responses, and respond to RADIUS messages, it is necessary to adjust the RADIUS timeout value.</span><span class="sxs-lookup"><span data-stu-id="42e7e-256">To ensure there is time to validate users’ credentials, perform two-step verification, receive responses, and respond to RADIUS messages, it is necessary to adjust the RADIUS timeout value.</span></span>

1. <span data-ttu-id="42e7e-257">On the RD Gateway server, open Server Manager.</span><span class="sxs-lookup"><span data-stu-id="42e7e-257">On the RD Gateway server, open Server Manager.</span></span> <span data-ttu-id="42e7e-258">On the menu, click **Tools**, and then click **Network Policy Server**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-258">On the menu, click **Tools**, and then click **Network Policy Server**.</span></span> 
2. <span data-ttu-id="42e7e-259">In the **NPS (Local)** console, expand **RADIUS Clients and Servers**, and select **Remote RADIUS Server**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-259">In the **NPS (Local)** console, expand **RADIUS Clients and Servers**, and select **Remote RADIUS Server**.</span></span>

 ![Remote RADIUS Server](./media/howto-mfa-nps-extension-rdg/image12.png)

3. <span data-ttu-id="42e7e-261">In the details pane, double-click **TS GATEWAY SERVER GROUP**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-261">In the details pane, double-click **TS GATEWAY SERVER GROUP**.</span></span>

 >[!NOTE]
 ><span data-ttu-id="42e7e-262">This RADIUS Server Group was created when you configured the central server for NPS policies.</span><span class="sxs-lookup"><span data-stu-id="42e7e-262">This RADIUS Server Group was created when you configured the central server for NPS policies.</span></span> <span data-ttu-id="42e7e-263">The RD Gateway forwards RADIUS messages to this server or group of servers, if more than one in the group.</span><span class="sxs-lookup"><span data-stu-id="42e7e-263">The RD Gateway forwards RADIUS messages to this server or group of servers, if more than one in the group.</span></span>
 >

4. <span data-ttu-id="42e7e-264">In the **TS GATEWAY SERVER GROUP Properties** dialog box, select the IP address or name of the NPS server you configured to store RD CAPs, and then click **Edit**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-264">In the **TS GATEWAY SERVER GROUP Properties** dialog box, select the IP address or name of the NPS server you configured to store RD CAPs, and then click **Edit**.</span></span> 

 ![TS Gateway Server Group](./media/howto-mfa-nps-extension-rdg/image13.png)

5. <span data-ttu-id="42e7e-266">In the **Edit RADIUS Server** dialog box, select the **Load Balancing** tab.</span><span class="sxs-lookup"><span data-stu-id="42e7e-266">In the **Edit RADIUS Server** dialog box, select the **Load Balancing** tab.</span></span>
6. <span data-ttu-id="42e7e-267">In the **Load Balancing** tab, in the **Number of seconds without response before request is considered dropped** field, change the default value from 3 to a value between 30 and 60 seconds.</span><span class="sxs-lookup"><span data-stu-id="42e7e-267">In the **Load Balancing** tab, in the **Number of seconds without response before request is considered dropped** field, change the default value from 3 to a value between 30 and 60 seconds.</span></span>
7. <span data-ttu-id="42e7e-268">In the **Number of seconds between requests when server is identified as unavailable** field, change the default value of 30 seconds to a value that is equal to or greater than the value you specified in the previous step.</span><span class="sxs-lookup"><span data-stu-id="42e7e-268">In the **Number of seconds between requests when server is identified as unavailable** field, change the default value of 30 seconds to a value that is equal to or greater than the value you specified in the previous step.</span></span>

 ![Edit Radius Server](./media/howto-mfa-nps-extension-rdg/image14.png)

8.  <span data-ttu-id="42e7e-270">Click **OK** two times to close the dialog boxes.</span><span class="sxs-lookup"><span data-stu-id="42e7e-270">Click **OK** two times to close the dialog boxes.</span></span>

### <a name="verify-connection-request-policies"></a><span data-ttu-id="42e7e-271">Verify Connection Request Policies</span><span class="sxs-lookup"><span data-stu-id="42e7e-271">Verify Connection Request Policies</span></span> 
<span data-ttu-id="42e7e-272">By default, when you configure the RD Gateway to use a central policy store for connection authorization policies, the RD Gateway is configured to forward CAP requests to the NPS server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-272">By default, when you configure the RD Gateway to use a central policy store for connection authorization policies, the RD Gateway is configured to forward CAP requests to the NPS server.</span></span> <span data-ttu-id="42e7e-273">The NPS server with the Azure MFA extension installed, processes the RADIUS access request.</span><span class="sxs-lookup"><span data-stu-id="42e7e-273">The NPS server with the Azure MFA extension installed, processes the RADIUS access request.</span></span> <span data-ttu-id="42e7e-274">The following steps show you how to verify the default connection request policy.</span><span class="sxs-lookup"><span data-stu-id="42e7e-274">The following steps show you how to verify the default connection request policy.</span></span> 

1. <span data-ttu-id="42e7e-275">On the RD Gateway, in the NPS (Local) console, expand **Policies**, and select **Connection Request Policies**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-275">On the RD Gateway, in the NPS (Local) console, expand **Policies**, and select **Connection Request Policies**.</span></span>
2. <span data-ttu-id="42e7e-276">Double-click **TS GATEWAY AUTHORIZATION POLICY**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-276">Double-click **TS GATEWAY AUTHORIZATION POLICY**.</span></span>
3. <span data-ttu-id="42e7e-277">In the **TS GATEWAY AUTHORIZATION POLICY properties** dialog box, click the **Settings** tab.</span><span class="sxs-lookup"><span data-stu-id="42e7e-277">In the **TS GATEWAY AUTHORIZATION POLICY properties** dialog box, click the **Settings** tab.</span></span>
4. <span data-ttu-id="42e7e-278">On **Settings** tab, under Forwarding Connection Request, click **Authentication**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-278">On **Settings** tab, under Forwarding Connection Request, click **Authentication**.</span></span> <span data-ttu-id="42e7e-279">RADIUS client is configured to forward requests for authentication.</span><span class="sxs-lookup"><span data-stu-id="42e7e-279">RADIUS client is configured to forward requests for authentication.</span></span>

 ![Authentication Settings](./media/howto-mfa-nps-extension-rdg/image15.png)
 
5. <span data-ttu-id="42e7e-281">Click **Cancel**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-281">Click **Cancel**.</span></span> 

## <a name="configure-nps-on-the-server-where-the-nps-extension-is-installed"></a><span data-ttu-id="42e7e-282">Configure NPS on the server where the NPS extension is installed</span><span class="sxs-lookup"><span data-stu-id="42e7e-282">Configure NPS on the server where the NPS extension is installed</span></span>
<span data-ttu-id="42e7e-283">The NPS server where the NPS extension is installed needs to be able to exchange RADIUS messages with the NPS server on the Remote Desktop Gateway.</span><span class="sxs-lookup"><span data-stu-id="42e7e-283">The NPS server where the NPS extension is installed needs to be able to exchange RADIUS messages with the NPS server on the Remote Desktop Gateway.</span></span> <span data-ttu-id="42e7e-284">To enable this message exchange, you need to configure the NPS components on the server where the NPS extension service is installed.</span><span class="sxs-lookup"><span data-stu-id="42e7e-284">To enable this message exchange, you need to configure the NPS components on the server where the NPS extension service is installed.</span></span> 

### <a name="register-server-in-active-directory"></a><span data-ttu-id="42e7e-285">Register Server in Active Directory</span><span class="sxs-lookup"><span data-stu-id="42e7e-285">Register Server in Active Directory</span></span>
<span data-ttu-id="42e7e-286">To function properly in this scenario, the NPS server needs to be registered in Active Directory.</span><span class="sxs-lookup"><span data-stu-id="42e7e-286">To function properly in this scenario, the NPS server needs to be registered in Active Directory.</span></span>

1. <span data-ttu-id="42e7e-287">On the NPS server, open **Server Manager**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-287">On the NPS server, open **Server Manager**.</span></span>
2. <span data-ttu-id="42e7e-288">In Server Manager, click **Tools**, and then click **Network Policy Server**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-288">In Server Manager, click **Tools**, and then click **Network Policy Server**.</span></span> 
3. <span data-ttu-id="42e7e-289">In the Network Policy Server console, right-click **NPS (Local)**, and then click **Register server in Active Directory**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-289">In the Network Policy Server console, right-click **NPS (Local)**, and then click **Register server in Active Directory**.</span></span> 
4. <span data-ttu-id="42e7e-290">Click **OK** two times.</span><span class="sxs-lookup"><span data-stu-id="42e7e-290">Click **OK** two times.</span></span>

 ![Register server in AD](./media/howto-mfa-nps-extension-rdg/image16.png)

5. <span data-ttu-id="42e7e-292">Leave the console open for the next procedure.</span><span class="sxs-lookup"><span data-stu-id="42e7e-292">Leave the console open for the next procedure.</span></span>

### <a name="create-and-configure-radius-client"></a><span data-ttu-id="42e7e-293">Create and configure RADIUS client</span><span class="sxs-lookup"><span data-stu-id="42e7e-293">Create and configure RADIUS client</span></span> 
<span data-ttu-id="42e7e-294">The Remote Desktop Gateway needs to be configured as a RADIUS client to the NPS server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-294">The Remote Desktop Gateway needs to be configured as a RADIUS client to the NPS server.</span></span> 

1. <span data-ttu-id="42e7e-295">On the NPS server where the NPS extension is installed, in the **NPS (Local)** console, right-click **RADIUS Clients** and click **New**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-295">On the NPS server where the NPS extension is installed, in the **NPS (Local)** console, right-click **RADIUS Clients** and click **New**.</span></span>

 ![New RADIUS Clients](./media/howto-mfa-nps-extension-rdg/image17.png)

2. <span data-ttu-id="42e7e-297">In the **New RADIUS Client** dialog box, provide a friendly name, such as _Gateway_, and the IP address or DNS name of the Remote Desktop Gateway server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-297">In the **New RADIUS Client** dialog box, provide a friendly name, such as _Gateway_, and the IP address or DNS name of the Remote Desktop Gateway server.</span></span> 
3. <span data-ttu-id="42e7e-298">In the **Shared secret** and the **Confirm shared secret** fields, enter the same secret that you used before.</span><span class="sxs-lookup"><span data-stu-id="42e7e-298">In the **Shared secret** and the **Confirm shared secret** fields, enter the same secret that you used before.</span></span>

 ![Name and Address](./media/howto-mfa-nps-extension-rdg/image18.png)

4. <span data-ttu-id="42e7e-300">Click **OK** to close the New RADIUS Client dialog box.</span><span class="sxs-lookup"><span data-stu-id="42e7e-300">Click **OK** to close the New RADIUS Client dialog box.</span></span>

### <a name="configure-network-policy"></a><span data-ttu-id="42e7e-301">Configure Network Policy</span><span class="sxs-lookup"><span data-stu-id="42e7e-301">Configure Network Policy</span></span>
<span data-ttu-id="42e7e-302">Recall that the NPS server with the Azure MFA extension is the designated central policy store for the Connection Authorization Policy (CAP).</span><span class="sxs-lookup"><span data-stu-id="42e7e-302">Recall that the NPS server with the Azure MFA extension is the designated central policy store for the Connection Authorization Policy (CAP).</span></span> <span data-ttu-id="42e7e-303">Therefore, you need to implement a CAP on the NPS server to authorize valid connections requests.</span><span class="sxs-lookup"><span data-stu-id="42e7e-303">Therefore, you need to implement a CAP on the NPS server to authorize valid connections requests.</span></span>  

1. <span data-ttu-id="42e7e-304">On the NPS Server, open the NPS (Local) console, expand **Policies**, and click **Network Policies**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-304">On the NPS Server, open the NPS (Local) console, expand **Policies**, and click **Network Policies**.</span></span>
2. <span data-ttu-id="42e7e-305">Right-click **Connections to other access servers**, and click **Duplicate Policy**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-305">Right-click **Connections to other access servers**, and click **Duplicate Policy**.</span></span> 

 ![Duplicate Policy](./media/howto-mfa-nps-extension-rdg/image19.png)

3. <span data-ttu-id="42e7e-307">Right-click **Copy of Connections to other access servers**, and click **Properties**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-307">Right-click **Copy of Connections to other access servers**, and click **Properties**.</span></span>

 ![Network Properties](./media/howto-mfa-nps-extension-rdg/image20.png)

4. <span data-ttu-id="42e7e-309">In the **Copy of Connections to other access servers** dialog box, in **Policy name**, enter a suitable name, such as _RDG_CAP_.</span><span class="sxs-lookup"><span data-stu-id="42e7e-309">In the **Copy of Connections to other access servers** dialog box, in **Policy name**, enter a suitable name, such as _RDG_CAP_.</span></span> <span data-ttu-id="42e7e-310">Check **Policy enabled**, and select **Grant access**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-310">Check **Policy enabled**, and select **Grant access**.</span></span> <span data-ttu-id="42e7e-311">Optionally, in **Type of network access server**, select **Remote Desktop Gateway**, or you can leave it as **Unspecified**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-311">Optionally, in **Type of network access server**, select **Remote Desktop Gateway**, or you can leave it as **Unspecified**.</span></span>

 ![Copy of Connections](./media/howto-mfa-nps-extension-rdg/image21.png)

5.  <span data-ttu-id="42e7e-313">Click the **Constraints** tab, and check **Allow clients to connect without negotiating an authentication method**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-313">Click the **Constraints** tab, and check **Allow clients to connect without negotiating an authentication method**.</span></span>

 ![Allow clients to connect](./media/howto-mfa-nps-extension-rdg/image22.png)

6. <span data-ttu-id="42e7e-315">Optionally, click the **Conditions** tab and add conditions that must be met for the connection to be authorized, for example, membership in a specific Windows group.</span><span class="sxs-lookup"><span data-stu-id="42e7e-315">Optionally, click the **Conditions** tab and add conditions that must be met for the connection to be authorized, for example, membership in a specific Windows group.</span></span>

 ![Conditions](./media/howto-mfa-nps-extension-rdg/image23.png)

7. <span data-ttu-id="42e7e-317">Click **OK**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-317">Click **OK**.</span></span> <span data-ttu-id="42e7e-318">When prompted to view the corresponding Help topic, click **No**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-318">When prompted to view the corresponding Help topic, click **No**.</span></span>
8. <span data-ttu-id="42e7e-319">Ensure that your new policy is at the top of the list, that the policy is enabled, and that it grants access.</span><span class="sxs-lookup"><span data-stu-id="42e7e-319">Ensure that your new policy is at the top of the list, that the policy is enabled, and that it grants access.</span></span>

 ![Network Policies](./media/howto-mfa-nps-extension-rdg/image24.png)

## <a name="verify-configuration"></a><span data-ttu-id="42e7e-321">Verify configuration</span><span class="sxs-lookup"><span data-stu-id="42e7e-321">Verify configuration</span></span>
<span data-ttu-id="42e7e-322">To verify the configuration, you need to sign in to the Remote Desktop Gateway with a suitable RDP client.</span><span class="sxs-lookup"><span data-stu-id="42e7e-322">To verify the configuration, you need to sign in to the Remote Desktop Gateway with a suitable RDP client.</span></span> <span data-ttu-id="42e7e-323">Be sure to use an account that is allowed by your Connection Authorization Policies and is enabled for Azure MFA.</span><span class="sxs-lookup"><span data-stu-id="42e7e-323">Be sure to use an account that is allowed by your Connection Authorization Policies and is enabled for Azure MFA.</span></span> 

<span data-ttu-id="42e7e-324">As show in the image below, you can use the **Remote Desktop Web Access** page.</span><span class="sxs-lookup"><span data-stu-id="42e7e-324">As show in the image below, you can use the **Remote Desktop Web Access** page.</span></span>

![Remote Desktop Web Access](./media/howto-mfa-nps-extension-rdg/image25.png)

<span data-ttu-id="42e7e-326">Upon successfully entering your credentials for primary authentication, the Remote Desktop Connect dialog box shows a status of Initiating remote connection, as shown below.</span><span class="sxs-lookup"><span data-stu-id="42e7e-326">Upon successfully entering your credentials for primary authentication, the Remote Desktop Connect dialog box shows a status of Initiating remote connection, as shown below.</span></span> 

<span data-ttu-id="42e7e-327">If you successfully authenticate with the secondary authentication method you previously configured in Azure MFA, you are connected to the resource.</span><span class="sxs-lookup"><span data-stu-id="42e7e-327">If you successfully authenticate with the secondary authentication method you previously configured in Azure MFA, you are connected to the resource.</span></span> <span data-ttu-id="42e7e-328">However, if the secondary authentication is not successful, you are denied access to the resource.</span><span class="sxs-lookup"><span data-stu-id="42e7e-328">However, if the secondary authentication is not successful, you are denied access to the resource.</span></span> 

![Initiate remote connection](./media/howto-mfa-nps-extension-rdg/image26.png)

<span data-ttu-id="42e7e-330">In the example below, the Authenticator app on a Windows phone is used to provide the secondary authentication.</span><span class="sxs-lookup"><span data-stu-id="42e7e-330">In the example below, the Authenticator app on a Windows phone is used to provide the secondary authentication.</span></span>

![Accounts](./media/howto-mfa-nps-extension-rdg/image27.png)

<span data-ttu-id="42e7e-332">Once you have successfully authenticated using the secondary authentication method, you are logged into the Remote Desktop Gateway as normal.</span><span class="sxs-lookup"><span data-stu-id="42e7e-332">Once you have successfully authenticated using the secondary authentication method, you are logged into the Remote Desktop Gateway as normal.</span></span> <span data-ttu-id="42e7e-333">However, because you are required to use a secondary authentication method using a mobile app on a trusted device, the log-in process is more secure than it would be otherwise.</span><span class="sxs-lookup"><span data-stu-id="42e7e-333">However, because you are required to use a secondary authentication method using a mobile app on a trusted device, the log-in process is more secure than it would be otherwise.</span></span>

### <a name="view-event-viewer-logs-for-successful-logon-events"></a><span data-ttu-id="42e7e-334">View Event Viewer logs for successful logon events</span><span class="sxs-lookup"><span data-stu-id="42e7e-334">View Event Viewer logs for successful logon events</span></span>
<span data-ttu-id="42e7e-335">To view the successful sign-in events in the Windows Event Viewer logs, you can issue the following Windows PowerShell command to query the Windows Terminal Services and Windows Security logs.</span><span class="sxs-lookup"><span data-stu-id="42e7e-335">To view the successful sign-in events in the Windows Event Viewer logs, you can issue the following Windows PowerShell command to query the Windows Terminal Services and Windows Security logs.</span></span>

<span data-ttu-id="42e7e-336">To query successful sign-in events in the Gateway operational logs _(Event Viewer\Applications and Services Logs\Microsoft\Windows\TerminalServices-Gateway\Operational)_, use the following PowerShell commands:</span><span class="sxs-lookup"><span data-stu-id="42e7e-336">To query successful sign-in events in the Gateway operational logs _(Event Viewer\Applications and Services Logs\Microsoft\Windows\TerminalServices-Gateway\Operational)_, use the following PowerShell commands:</span></span>

* <span data-ttu-id="42e7e-337">_Get-WinEvent -Logname Microsoft-Windows-TerminalServices-Gateway/Operational_ | where {$_.ID -eq '300'} | FL</span><span class="sxs-lookup"><span data-stu-id="42e7e-337">_Get-WinEvent -Logname Microsoft-Windows-TerminalServices-Gateway/Operational_ | where {$_.ID -eq '300'} | FL</span></span> 
* <span data-ttu-id="42e7e-338">This command displays Windows events that show the user met resource authorization policy requirements (RD RAP) and was granted access.</span><span class="sxs-lookup"><span data-stu-id="42e7e-338">This command displays Windows events that show the user met resource authorization policy requirements (RD RAP) and was granted access.</span></span>

![View Event Viewer](./media/howto-mfa-nps-extension-rdg/image28.png)

* <span data-ttu-id="42e7e-340">_Get-WinEvent -Logname Microsoft-Windows-TerminalServices-Gateway/Operational_ | where {$_.ID -eq '200'} | FL</span><span class="sxs-lookup"><span data-stu-id="42e7e-340">_Get-WinEvent -Logname Microsoft-Windows-TerminalServices-Gateway/Operational_ | where {$_.ID -eq '200'} | FL</span></span>
* <span data-ttu-id="42e7e-341">This command displays the events that show when user met connection authorization policy requirements.</span><span class="sxs-lookup"><span data-stu-id="42e7e-341">This command displays the events that show when user met connection authorization policy requirements.</span></span>

![Connection authorization](./media/howto-mfa-nps-extension-rdg/image29.png)

<span data-ttu-id="42e7e-343">You can also view this log and filter on event IDs, 300 and 200.</span><span class="sxs-lookup"><span data-stu-id="42e7e-343">You can also view this log and filter on event IDs, 300 and 200.</span></span> <span data-ttu-id="42e7e-344">To query successful logon events in the Security event viewer logs, use the following command:</span><span class="sxs-lookup"><span data-stu-id="42e7e-344">To query successful logon events in the Security event viewer logs, use the following command:</span></span>

* <span data-ttu-id="42e7e-345">_Get-WinEvent -Logname Security_ | where {$_.ID -eq '6272'} | FL</span><span class="sxs-lookup"><span data-stu-id="42e7e-345">_Get-WinEvent -Logname Security_ | where {$_.ID -eq '6272'} | FL</span></span> 
* <span data-ttu-id="42e7e-346">This command can be run on either the central NPS or the RD Gateway Server.</span><span class="sxs-lookup"><span data-stu-id="42e7e-346">This command can be run on either the central NPS or the RD Gateway Server.</span></span> 

![Successful logon events](./media/howto-mfa-nps-extension-rdg/image30.png)

<span data-ttu-id="42e7e-348">You can also view the Security log or the Network Policy and Access Services custom view, as shown below:</span><span class="sxs-lookup"><span data-stu-id="42e7e-348">You can also view the Security log or the Network Policy and Access Services custom view, as shown below:</span></span>

![Network Policy and Access Services](./media/howto-mfa-nps-extension-rdg/image31.png)

<span data-ttu-id="42e7e-350">On the server where you installed the NPS extension for Azure MFA, you can find Event Viewer application logs specific to the extension at _Application and Services Logs\Microsoft\AzureMfa_.</span><span class="sxs-lookup"><span data-stu-id="42e7e-350">On the server where you installed the NPS extension for Azure MFA, you can find Event Viewer application logs specific to the extension at _Application and Services Logs\Microsoft\AzureMfa_.</span></span> 

![Event Viewer application logs](./media/howto-mfa-nps-extension-rdg/image32.png)

## <a name="troubleshoot-guide"></a><span data-ttu-id="42e7e-352">Troubleshoot Guide</span><span class="sxs-lookup"><span data-stu-id="42e7e-352">Troubleshoot Guide</span></span>

<span data-ttu-id="42e7e-353">If the configuration is not working as expected, the first place to start to troubleshoot is to verify that the user is configured to use Azure MFA.</span><span class="sxs-lookup"><span data-stu-id="42e7e-353">If the configuration is not working as expected, the first place to start to troubleshoot is to verify that the user is configured to use Azure MFA.</span></span> <span data-ttu-id="42e7e-354">Have the user connect to the [Azure portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="42e7e-354">Have the user connect to the [Azure portal](https://portal.azure.com).</span></span> <span data-ttu-id="42e7e-355">If users are prompted for secondary verification and can successfully authenticate, you can eliminate an incorrect configuration of Azure MFA.</span><span class="sxs-lookup"><span data-stu-id="42e7e-355">If users are prompted for secondary verification and can successfully authenticate, you can eliminate an incorrect configuration of Azure MFA.</span></span>

<span data-ttu-id="42e7e-356">If Azure MFA is working for the user(s), you should review the relevant Event logs.</span><span class="sxs-lookup"><span data-stu-id="42e7e-356">If Azure MFA is working for the user(s), you should review the relevant Event logs.</span></span> <span data-ttu-id="42e7e-357">These include the Security Event, Gateway operational, and Azure MFA logs that are discussed in the previous section.</span><span class="sxs-lookup"><span data-stu-id="42e7e-357">These include the Security Event, Gateway operational, and Azure MFA logs that are discussed in the previous section.</span></span> 

<span data-ttu-id="42e7e-358">Below is an example output of Security log showing a failed logon event (Event ID 6273).</span><span class="sxs-lookup"><span data-stu-id="42e7e-358">Below is an example output of Security log showing a failed logon event (Event ID 6273).</span></span>

![Failed logon event](./media/howto-mfa-nps-extension-rdg/image33.png)

<span data-ttu-id="42e7e-360">Below is a related event from the AzureMFA logs:</span><span class="sxs-lookup"><span data-stu-id="42e7e-360">Below is a related event from the AzureMFA logs:</span></span>

![Azure MFA log](./media/howto-mfa-nps-extension-rdg/image34.png)

<span data-ttu-id="42e7e-362">To perform advanced troubleshoot options, consult the NPS database format log files where the NPS service is installed.</span><span class="sxs-lookup"><span data-stu-id="42e7e-362">To perform advanced troubleshoot options, consult the NPS database format log files where the NPS service is installed.</span></span> <span data-ttu-id="42e7e-363">These log files are created in _%SystemRoot%\System32\Logs_ folder as comma-delimited text files.</span><span class="sxs-lookup"><span data-stu-id="42e7e-363">These log files are created in _%SystemRoot%\System32\Logs_ folder as comma-delimited text files.</span></span> 

<span data-ttu-id="42e7e-364">For a description of these log files, see [Interpret NPS Database Format Log Files](https://technet.microsoft.com/library/cc771748.aspx).</span><span class="sxs-lookup"><span data-stu-id="42e7e-364">For a description of these log files, see [Interpret NPS Database Format Log Files](https://technet.microsoft.com/library/cc771748.aspx).</span></span> <span data-ttu-id="42e7e-365">The entries in these log files can be difficult to interpret without importing them into a spreadsheet or a database.</span><span class="sxs-lookup"><span data-stu-id="42e7e-365">The entries in these log files can be difficult to interpret without importing them into a spreadsheet or a database.</span></span> <span data-ttu-id="42e7e-366">You can find several IAS parsers online to assist you in interpreting the log files.</span><span class="sxs-lookup"><span data-stu-id="42e7e-366">You can find several IAS parsers online to assist you in interpreting the log files.</span></span> 

<span data-ttu-id="42e7e-367">The image below shows the output of one such downloadable [shareware application](http://www.deepsoftware.com/iasviewer).</span><span class="sxs-lookup"><span data-stu-id="42e7e-367">The image below shows the output of one such downloadable [shareware application](http://www.deepsoftware.com/iasviewer).</span></span> 

![Shareware app](./media/howto-mfa-nps-extension-rdg/image35.png)

<span data-ttu-id="42e7e-369">Finally, for additional troubleshoot options, you can use a protocol analyzer, such [Microsoft Message Analyzer](https://technet.microsoft.com/library/jj649776.aspx).</span><span class="sxs-lookup"><span data-stu-id="42e7e-369">Finally, for additional troubleshoot options, you can use a protocol analyzer, such [Microsoft Message Analyzer](https://technet.microsoft.com/library/jj649776.aspx).</span></span> 

<span data-ttu-id="42e7e-370">The image below from Microsoft Message Analyzer shows network traffic filtered on RADIUS protocol that contains the user name **Contoso\AliceC**.</span><span class="sxs-lookup"><span data-stu-id="42e7e-370">The image below from Microsoft Message Analyzer shows network traffic filtered on RADIUS protocol that contains the user name **Contoso\AliceC**.</span></span>

![Microsoft Message Analyzer](./media/howto-mfa-nps-extension-rdg/image36.png)

## <a name="next-steps"></a><span data-ttu-id="42e7e-372">Next steps</span><span class="sxs-lookup"><span data-stu-id="42e7e-372">Next steps</span></span>
[<span data-ttu-id="42e7e-373">How to get Azure Multi-Factor Authentication</span><span class="sxs-lookup"><span data-stu-id="42e7e-373">How to get Azure Multi-Factor Authentication</span></span>](concept-mfa-licensing.md)

[<span data-ttu-id="42e7e-374">Remote Desktop Gateway and Azure Multi-Factor Authentication Server using RADIUS</span><span class="sxs-lookup"><span data-stu-id="42e7e-374">Remote Desktop Gateway and Azure Multi-Factor Authentication Server using RADIUS</span></span>](howto-mfaserver-nps-rdg.md)

[<span data-ttu-id="42e7e-375">Integrate your on-premises directories with Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="42e7e-375">Integrate your on-premises directories with Azure Active Directory</span></span>](../connect/active-directory-aadconnect.md)
