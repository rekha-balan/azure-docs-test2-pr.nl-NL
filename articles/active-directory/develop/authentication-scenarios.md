---
title: Authentication scenarios for Azure AD | Microsoft Docs
description: Provides an overview of the five most common authentication scenarios for Azure Active Directory (Azure AD)
services: active-directory
documentationcenter: dev-center-name
author: CelesteDG
manager: mtillman
editor: ''
ms.assetid: 0c84e7d0-16aa-4897-82f2-f53c6c990fd9
ms.service: active-directory
ms.component: develop
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: identity
ms.date: 07/26/2018
ms.author: celested
ms.reviewer: jmprieur, andret, nacanuma, hirsin
ms.custom: aaddev
ms.openlocfilehash: fc6c97906525b2f575a18ce5357eb3e10bfb4887
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44871157"
---
# <a name="authentication-scenarios-for-azure-ad"></a><span data-ttu-id="6f43b-103">Authentication scenarios for Azure AD</span><span class="sxs-lookup"><span data-stu-id="6f43b-103">Authentication scenarios for Azure AD</span></span>

<span data-ttu-id="6f43b-104">Azure Active Directory (Azure AD) simplifies authentication for developers by providing identity as a service, with support for industry-standard protocols such as OAuth 2.0 and OpenID Connect, as well as open-source libraries for different platforms to help you start coding quickly.</span><span class="sxs-lookup"><span data-stu-id="6f43b-104">Azure Active Directory (Azure AD) simplifies authentication for developers by providing identity as a service, with support for industry-standard protocols such as OAuth 2.0 and OpenID Connect, as well as open-source libraries for different platforms to help you start coding quickly.</span></span> <span data-ttu-id="6f43b-105">This article will help you understand the various scenarios Azure AD supports and show you how to get started.</span><span class="sxs-lookup"><span data-stu-id="6f43b-105">This article will help you understand the various scenarios Azure AD supports and show you how to get started.</span></span> <span data-ttu-id="6f43b-106">It’s divided into the following sections:</span><span class="sxs-lookup"><span data-stu-id="6f43b-106">It’s divided into the following sections:</span></span>

* [<span data-ttu-id="6f43b-107">Basics of authentication in Azure AD</span><span class="sxs-lookup"><span data-stu-id="6f43b-107">Basics of authentication in Azure AD</span></span>](#basics-of-authentication-in-azure-ad)
* [<span data-ttu-id="6f43b-108">Claims in Azure AD security tokens</span><span class="sxs-lookup"><span data-stu-id="6f43b-108">Claims in Azure AD security tokens</span></span>](#claims-in-azure-ad-security-tokens)
* [<span data-ttu-id="6f43b-109">Basics of registering an application in Azure AD</span><span class="sxs-lookup"><span data-stu-id="6f43b-109">Basics of registering an application in Azure AD</span></span>](#basics-of-registering-an-application-in-azure-ad)
* [<span data-ttu-id="6f43b-110">Application types and scenarios</span><span class="sxs-lookup"><span data-stu-id="6f43b-110">Application types and scenarios</span></span>](#application-types-and-scenarios)

  * [<span data-ttu-id="6f43b-111">Web browser to web application</span><span class="sxs-lookup"><span data-stu-id="6f43b-111">Web browser to web application</span></span>](#web-browser-to-web-application)
  * [<span data-ttu-id="6f43b-112">Single Page Application (SPA)</span><span class="sxs-lookup"><span data-stu-id="6f43b-112">Single Page Application (SPA)</span></span>](#single-page-application-spa)
  * [<span data-ttu-id="6f43b-113">Native application to web API</span><span class="sxs-lookup"><span data-stu-id="6f43b-113">Native application to web API</span></span>](#native-application-to-web-api)
  * [<span data-ttu-id="6f43b-114">Web application to web API</span><span class="sxs-lookup"><span data-stu-id="6f43b-114">Web application to web API</span></span>](#web-application-to-web-api)
  * [<span data-ttu-id="6f43b-115">Daemon or server application to web API</span><span class="sxs-lookup"><span data-stu-id="6f43b-115">Daemon or server application to web API</span></span>](#daemon-or-server-application-to-web-api)

## <a name="basics-of-authentication-in-azure-ad"></a><span data-ttu-id="6f43b-116">Basics of authentication in Azure AD</span><span class="sxs-lookup"><span data-stu-id="6f43b-116">Basics of authentication in Azure AD</span></span>

<span data-ttu-id="6f43b-117">If you are unfamiliar with basic concepts of authentication in Azure AD, read this section.</span><span class="sxs-lookup"><span data-stu-id="6f43b-117">If you are unfamiliar with basic concepts of authentication in Azure AD, read this section.</span></span> <span data-ttu-id="6f43b-118">Otherwise, you may want to skip down to [Application types and scenarios](#application-types-and-scenarios).</span><span class="sxs-lookup"><span data-stu-id="6f43b-118">Otherwise, you may want to skip down to [Application types and scenarios](#application-types-and-scenarios).</span></span>

<span data-ttu-id="6f43b-119">Let’s consider the most basic scenario where identity is required: a user in a web browser needs to authenticate to a web application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-119">Let’s consider the most basic scenario where identity is required: a user in a web browser needs to authenticate to a web application.</span></span> <span data-ttu-id="6f43b-120">This scenario is described in greater detail in the [Web browser to web application](#web-browser-to-web-application) section, but it’s a useful starting point to illustrate the capabilities of Azure AD and conceptualize how the scenario works.</span><span class="sxs-lookup"><span data-stu-id="6f43b-120">This scenario is described in greater detail in the [Web browser to web application](#web-browser-to-web-application) section, but it’s a useful starting point to illustrate the capabilities of Azure AD and conceptualize how the scenario works.</span></span> <span data-ttu-id="6f43b-121">Consider the following diagram for this scenario:</span><span class="sxs-lookup"><span data-stu-id="6f43b-121">Consider the following diagram for this scenario:</span></span>

![Overview of sign-on to web application](./media/authentication-scenarios/basics_of_auth_in_aad.png)

<span data-ttu-id="6f43b-123">With the diagram above in mind, here’s what you need to know about its various components:</span><span class="sxs-lookup"><span data-stu-id="6f43b-123">With the diagram above in mind, here’s what you need to know about its various components:</span></span>

* <span data-ttu-id="6f43b-124">Azure AD is the identity provider, responsible for verifying the identity of users and applications that exist in an organization’s directory, and ultimately issuing security tokens upon successful authentication of those users and applications.</span><span class="sxs-lookup"><span data-stu-id="6f43b-124">Azure AD is the identity provider, responsible for verifying the identity of users and applications that exist in an organization’s directory, and ultimately issuing security tokens upon successful authentication of those users and applications.</span></span>
* <span data-ttu-id="6f43b-125">An application that wants to outsource authentication to Azure AD must be registered in Azure AD, which registers and uniquely identifies the app in the directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-125">An application that wants to outsource authentication to Azure AD must be registered in Azure AD, which registers and uniquely identifies the app in the directory.</span></span>
* <span data-ttu-id="6f43b-126">Developers can use the open-source Azure AD authentication libraries to make authentication easy by handling the protocol details for you.</span><span class="sxs-lookup"><span data-stu-id="6f43b-126">Developers can use the open-source Azure AD authentication libraries to make authentication easy by handling the protocol details for you.</span></span> <span data-ttu-id="6f43b-127">For more information, see [Azure Active Directory Authentication Libraries](active-directory-authentication-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="6f43b-127">For more information, see [Azure Active Directory Authentication Libraries](active-directory-authentication-libraries.md).</span></span>
* <span data-ttu-id="6f43b-128">Once a user has been authenticated, the application must validate the user’s security token to ensure that authentication was successful.</span><span class="sxs-lookup"><span data-stu-id="6f43b-128">Once a user has been authenticated, the application must validate the user’s security token to ensure that authentication was successful.</span></span> <span data-ttu-id="6f43b-129">We have samples of what the application must do in a variety of languages and frameworks on [GitHub](https://github.com/Azure-Samples?q=active-directory).</span><span class="sxs-lookup"><span data-stu-id="6f43b-129">We have samples of what the application must do in a variety of languages and frameworks on [GitHub](https://github.com/Azure-Samples?q=active-directory).</span></span> <span data-ttu-id="6f43b-130">If you're building a web app in ASP.NET, see the [add sign-in for an ASP.NET web app guide](https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-aspnetwebapp).</span><span class="sxs-lookup"><span data-stu-id="6f43b-130">If you're building a web app in ASP.NET, see the [add sign-in for an ASP.NET web app guide](https://docs.microsoft.com/azure/active-directory/develop/guidedsetups/active-directory-aspnetwebapp).</span></span> <span data-ttu-id="6f43b-131">If you’re building a web API resource in ASP.NET, see the [web API getting started guide](https://docs.microsoft.com/azure/active-directory/develop/active-directory-devquickstarts-webapi-dotnet).</span><span class="sxs-lookup"><span data-stu-id="6f43b-131">If you’re building a web API resource in ASP.NET, see the [web API getting started guide](https://docs.microsoft.com/azure/active-directory/develop/active-directory-devquickstarts-webapi-dotnet).</span></span>
* <span data-ttu-id="6f43b-132">The flow of requests and responses for the authentication process is determined by the authentication protocol that was used, such as OAuth 2.0, OpenID Connect, WS-Federation, or SAML 2.0.</span><span class="sxs-lookup"><span data-stu-id="6f43b-132">The flow of requests and responses for the authentication process is determined by the authentication protocol that was used, such as OAuth 2.0, OpenID Connect, WS-Federation, or SAML 2.0.</span></span> <span data-ttu-id="6f43b-133">These protocols are discussed in more detail in the [Azure Active Directory authentication protocols](active-directory-authentication-protocols.md) article and in the sections below.</span><span class="sxs-lookup"><span data-stu-id="6f43b-133">These protocols are discussed in more detail in the [Azure Active Directory authentication protocols](active-directory-authentication-protocols.md) article and in the sections below.</span></span>

> [!NOTE]
> <span data-ttu-id="6f43b-134">Azure AD supports the OAuth 2.0 and OpenID Connect standards that make extensive use of bearer tokens, including bearer tokens represented as JWTs.</span><span class="sxs-lookup"><span data-stu-id="6f43b-134">Azure AD supports the OAuth 2.0 and OpenID Connect standards that make extensive use of bearer tokens, including bearer tokens represented as JWTs.</span></span> <span data-ttu-id="6f43b-135">A *bearer token* is a lightweight security token that grants the “bearer” access to a protected resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-135">A *bearer token* is a lightweight security token that grants the “bearer” access to a protected resource.</span></span> <span data-ttu-id="6f43b-136">In this sense, the “bearer” is any party that can present the token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-136">In this sense, the “bearer” is any party that can present the token.</span></span> <span data-ttu-id="6f43b-137">Though a party must first authenticate with Azure AD to receive the bearer token, if the required steps are not taken to secure the token in transmission and storage, it can be intercepted and used by an unintended party.</span><span class="sxs-lookup"><span data-stu-id="6f43b-137">Though a party must first authenticate with Azure AD to receive the bearer token, if the required steps are not taken to secure the token in transmission and storage, it can be intercepted and used by an unintended party.</span></span> <span data-ttu-id="6f43b-138">While some security tokens have a built-in mechanism for preventing unauthorized parties from using them, bearer tokens do not have this mechanism and must be transported in a secure channel such as transport layer security (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="6f43b-138">While some security tokens have a built-in mechanism for preventing unauthorized parties from using them, bearer tokens do not have this mechanism and must be transported in a secure channel such as transport layer security (HTTPS).</span></span> <span data-ttu-id="6f43b-139">If a bearer token is transmitted in the clear, a man-in-the-middle attack can be used by a malicious party to acquire the token and use it for an unauthorized access to a protected resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-139">If a bearer token is transmitted in the clear, a man-in-the-middle attack can be used by a malicious party to acquire the token and use it for an unauthorized access to a protected resource.</span></span> <span data-ttu-id="6f43b-140">The same security principles apply when storing or caching bearer tokens for later use.</span><span class="sxs-lookup"><span data-stu-id="6f43b-140">The same security principles apply when storing or caching bearer tokens for later use.</span></span> <span data-ttu-id="6f43b-141">Always ensure that your application transmits and stores bearer tokens in a secure manner.</span><span class="sxs-lookup"><span data-stu-id="6f43b-141">Always ensure that your application transmits and stores bearer tokens in a secure manner.</span></span> <span data-ttu-id="6f43b-142">For more security considerations on bearer tokens, see [RFC 6750 Section 5](http://tools.ietf.org/html/rfc6750).</span><span class="sxs-lookup"><span data-stu-id="6f43b-142">For more security considerations on bearer tokens, see [RFC 6750 Section 5](http://tools.ietf.org/html/rfc6750).</span></span>

<span data-ttu-id="6f43b-143">Now that you have an overview of the basics, read the sections below to understand how provisioning works in Azure AD and the common scenarios that Azure AD supports.</span><span class="sxs-lookup"><span data-stu-id="6f43b-143">Now that you have an overview of the basics, read the sections below to understand how provisioning works in Azure AD and the common scenarios that Azure AD supports.</span></span>

## <a name="claims-in-azure-ad-security-tokens"></a><span data-ttu-id="6f43b-144">Claims in Azure AD security tokens</span><span class="sxs-lookup"><span data-stu-id="6f43b-144">Claims in Azure AD security tokens</span></span>

<span data-ttu-id="6f43b-145">Security tokens (access and ID tokens) issued by Azure AD contain claims, or assertions of information about the subject that has been authenticated.</span><span class="sxs-lookup"><span data-stu-id="6f43b-145">Security tokens (access and ID tokens) issued by Azure AD contain claims, or assertions of information about the subject that has been authenticated.</span></span> <span data-ttu-id="6f43b-146">These claims can be used by the application for various tasks.</span><span class="sxs-lookup"><span data-stu-id="6f43b-146">These claims can be used by the application for various tasks.</span></span> <span data-ttu-id="6f43b-147">For example, applications can use claims to validate the token, identify the subject's directory tenant, display user information, determine the subject's authorization, and so on.</span><span class="sxs-lookup"><span data-stu-id="6f43b-147">For example, applications can use claims to validate the token, identify the subject's directory tenant, display user information, determine the subject's authorization, and so on.</span></span> <span data-ttu-id="6f43b-148">The claims present in any given security token are dependent upon the type of token, the type of credential used to authenticate the user, and the application configuration.</span><span class="sxs-lookup"><span data-stu-id="6f43b-148">The claims present in any given security token are dependent upon the type of token, the type of credential used to authenticate the user, and the application configuration.</span></span> <span data-ttu-id="6f43b-149">A brief description of each type of claim emitted by Azure AD is provided in the table below.</span><span class="sxs-lookup"><span data-stu-id="6f43b-149">A brief description of each type of claim emitted by Azure AD is provided in the table below.</span></span> <span data-ttu-id="6f43b-150">For more information, refer to [Supported token and claim types](v1-id-and-access-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="6f43b-150">For more information, refer to [Supported token and claim types](v1-id-and-access-tokens.md).</span></span>

| <span data-ttu-id="6f43b-151">Claim</span><span class="sxs-lookup"><span data-stu-id="6f43b-151">Claim</span></span> | <span data-ttu-id="6f43b-152">Description</span><span class="sxs-lookup"><span data-stu-id="6f43b-152">Description</span></span> |
| --- | --- |
| <span data-ttu-id="6f43b-153">Application ID</span><span class="sxs-lookup"><span data-stu-id="6f43b-153">Application ID</span></span> | <span data-ttu-id="6f43b-154">Identifies the application that is using the token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-154">Identifies the application that is using the token.</span></span> |
| <span data-ttu-id="6f43b-155">Audience</span><span class="sxs-lookup"><span data-stu-id="6f43b-155">Audience</span></span> | <span data-ttu-id="6f43b-156">Identifies the recipient resource the token is intended for.</span><span class="sxs-lookup"><span data-stu-id="6f43b-156">Identifies the recipient resource the token is intended for.</span></span> |
| <span data-ttu-id="6f43b-157">Application Authentication Context Class Reference</span><span class="sxs-lookup"><span data-stu-id="6f43b-157">Application Authentication Context Class Reference</span></span> | <span data-ttu-id="6f43b-158">Indicates how the client was authenticated (public client vs. confidential client).</span><span class="sxs-lookup"><span data-stu-id="6f43b-158">Indicates how the client was authenticated (public client vs. confidential client).</span></span> |
| <span data-ttu-id="6f43b-159">Authentication Instant</span><span class="sxs-lookup"><span data-stu-id="6f43b-159">Authentication Instant</span></span> | <span data-ttu-id="6f43b-160">Records the date and time when the authentication occurred.</span><span class="sxs-lookup"><span data-stu-id="6f43b-160">Records the date and time when the authentication occurred.</span></span> |
| <span data-ttu-id="6f43b-161">Authentication Method</span><span class="sxs-lookup"><span data-stu-id="6f43b-161">Authentication Method</span></span> | <span data-ttu-id="6f43b-162">Indicates how the subject of the token was authenticated (password, certificate, etc.).</span><span class="sxs-lookup"><span data-stu-id="6f43b-162">Indicates how the subject of the token was authenticated (password, certificate, etc.).</span></span> |
| <span data-ttu-id="6f43b-163">First Name</span><span class="sxs-lookup"><span data-stu-id="6f43b-163">First Name</span></span> | <span data-ttu-id="6f43b-164">Provides the given name of the user as set in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-164">Provides the given name of the user as set in Azure AD.</span></span> |
| <span data-ttu-id="6f43b-165">Groups</span><span class="sxs-lookup"><span data-stu-id="6f43b-165">Groups</span></span> | <span data-ttu-id="6f43b-166">Contains object IDs of Azure AD groups that the user is a member of.</span><span class="sxs-lookup"><span data-stu-id="6f43b-166">Contains object IDs of Azure AD groups that the user is a member of.</span></span> |
| <span data-ttu-id="6f43b-167">Identity Provider</span><span class="sxs-lookup"><span data-stu-id="6f43b-167">Identity Provider</span></span> | <span data-ttu-id="6f43b-168">Records the identity provider that authenticated the subject of the token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-168">Records the identity provider that authenticated the subject of the token.</span></span> |
| <span data-ttu-id="6f43b-169">Issued At</span><span class="sxs-lookup"><span data-stu-id="6f43b-169">Issued At</span></span> | <span data-ttu-id="6f43b-170">Records the time at which the token was issued, often used for token freshness.</span><span class="sxs-lookup"><span data-stu-id="6f43b-170">Records the time at which the token was issued, often used for token freshness.</span></span> |
| <span data-ttu-id="6f43b-171">Issuer</span><span class="sxs-lookup"><span data-stu-id="6f43b-171">Issuer</span></span> | <span data-ttu-id="6f43b-172">Identifies the STS that emitted the token as well as the Azure AD tenant.</span><span class="sxs-lookup"><span data-stu-id="6f43b-172">Identifies the STS that emitted the token as well as the Azure AD tenant.</span></span> |
| <span data-ttu-id="6f43b-173">Last Name</span><span class="sxs-lookup"><span data-stu-id="6f43b-173">Last Name</span></span> | <span data-ttu-id="6f43b-174">Provides the surname of the user as set in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-174">Provides the surname of the user as set in Azure AD.</span></span> |
| <span data-ttu-id="6f43b-175">Name</span><span class="sxs-lookup"><span data-stu-id="6f43b-175">Name</span></span> | <span data-ttu-id="6f43b-176">Provides a human readable value that identifies the subject of the token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-176">Provides a human readable value that identifies the subject of the token.</span></span> |
| <span data-ttu-id="6f43b-177">Object ID</span><span class="sxs-lookup"><span data-stu-id="6f43b-177">Object ID</span></span> | <span data-ttu-id="6f43b-178">Contains an immutable, unique identifier of the subject in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-178">Contains an immutable, unique identifier of the subject in Azure AD.</span></span> |
| <span data-ttu-id="6f43b-179">Roles</span><span class="sxs-lookup"><span data-stu-id="6f43b-179">Roles</span></span> | <span data-ttu-id="6f43b-180">Contains friendly names of Azure AD Application Roles that the user has been granted.</span><span class="sxs-lookup"><span data-stu-id="6f43b-180">Contains friendly names of Azure AD Application Roles that the user has been granted.</span></span> |
| <span data-ttu-id="6f43b-181">Scope</span><span class="sxs-lookup"><span data-stu-id="6f43b-181">Scope</span></span> | <span data-ttu-id="6f43b-182">Indicates the permissions granted to the client application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-182">Indicates the permissions granted to the client application.</span></span> |
| <span data-ttu-id="6f43b-183">Subject</span><span class="sxs-lookup"><span data-stu-id="6f43b-183">Subject</span></span> | <span data-ttu-id="6f43b-184">Indicates the principal about which the token asserts information.</span><span class="sxs-lookup"><span data-stu-id="6f43b-184">Indicates the principal about which the token asserts information.</span></span> |
| <span data-ttu-id="6f43b-185">Tenant ID</span><span class="sxs-lookup"><span data-stu-id="6f43b-185">Tenant ID</span></span> | <span data-ttu-id="6f43b-186">Contains an immutable, unique identifier of the directory tenant that issued the token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-186">Contains an immutable, unique identifier of the directory tenant that issued the token.</span></span> |
| <span data-ttu-id="6f43b-187">Token Lifetime</span><span class="sxs-lookup"><span data-stu-id="6f43b-187">Token Lifetime</span></span> | <span data-ttu-id="6f43b-188">Defines the time interval within which a token is valid.</span><span class="sxs-lookup"><span data-stu-id="6f43b-188">Defines the time interval within which a token is valid.</span></span> |
| <span data-ttu-id="6f43b-189">User Principal Name</span><span class="sxs-lookup"><span data-stu-id="6f43b-189">User Principal Name</span></span> | <span data-ttu-id="6f43b-190">Contains the user principal name of the subject.</span><span class="sxs-lookup"><span data-stu-id="6f43b-190">Contains the user principal name of the subject.</span></span> |
| <span data-ttu-id="6f43b-191">Version</span><span class="sxs-lookup"><span data-stu-id="6f43b-191">Version</span></span> | <span data-ttu-id="6f43b-192">Contains the version number of the token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-192">Contains the version number of the token.</span></span> |

## <a name="basics-of-registering-an-application-in-azure-ad"></a><span data-ttu-id="6f43b-193">Basics of registering an application in Azure AD</span><span class="sxs-lookup"><span data-stu-id="6f43b-193">Basics of registering an application in Azure AD</span></span>

<span data-ttu-id="6f43b-194">Any application that outsources authentication to Azure AD must be registered in a directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-194">Any application that outsources authentication to Azure AD must be registered in a directory.</span></span> <span data-ttu-id="6f43b-195">This step involves telling Azure AD about your application, including the URL where it’s located, the URL to send replies after authentication, the URI to identify your application, and more.</span><span class="sxs-lookup"><span data-stu-id="6f43b-195">This step involves telling Azure AD about your application, including the URL where it’s located, the URL to send replies after authentication, the URI to identify your application, and more.</span></span> <span data-ttu-id="6f43b-196">This information is required for a few key reasons:</span><span class="sxs-lookup"><span data-stu-id="6f43b-196">This information is required for a few key reasons:</span></span>

* <span data-ttu-id="6f43b-197">Azure AD needs to communicate with the application when handling sign-on or exchanging tokens.</span><span class="sxs-lookup"><span data-stu-id="6f43b-197">Azure AD needs to communicate with the application when handling sign-on or exchanging tokens.</span></span> <span data-ttu-id="6f43b-198">The information passed between Azure AD and the application includes the following:</span><span class="sxs-lookup"><span data-stu-id="6f43b-198">The information passed between Azure AD and the application includes the following:</span></span>
  
  * <span data-ttu-id="6f43b-199">**Application ID URI** - The identifier for an application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-199">**Application ID URI** - The identifier for an application.</span></span> <span data-ttu-id="6f43b-200">This value is sent to Azure AD during authentication to indicate which application the caller wants a token for.</span><span class="sxs-lookup"><span data-stu-id="6f43b-200">This value is sent to Azure AD during authentication to indicate which application the caller wants a token for.</span></span> <span data-ttu-id="6f43b-201">Additionally, this value is included in the token so that the application knows it was the intended target.</span><span class="sxs-lookup"><span data-stu-id="6f43b-201">Additionally, this value is included in the token so that the application knows it was the intended target.</span></span>
  * <span data-ttu-id="6f43b-202">**Reply URL** and **Redirect URI** - For a web API or web application, the Reply URL is the location where Azure AD will send the authentication response, including a token if authentication was successful.</span><span class="sxs-lookup"><span data-stu-id="6f43b-202">**Reply URL** and **Redirect URI** - For a web API or web application, the Reply URL is the location where Azure AD will send the authentication response, including a token if authentication was successful.</span></span> <span data-ttu-id="6f43b-203">For a native application, the Redirect URI is a unique identifier to which Azure AD will redirect the user-agent in an OAuth 2.0 request.</span><span class="sxs-lookup"><span data-stu-id="6f43b-203">For a native application, the Redirect URI is a unique identifier to which Azure AD will redirect the user-agent in an OAuth 2.0 request.</span></span>
  * <span data-ttu-id="6f43b-204">**Application ID** - The ID for an application, which is generated by Azure AD when the application is registered.</span><span class="sxs-lookup"><span data-stu-id="6f43b-204">**Application ID** - The ID for an application, which is generated by Azure AD when the application is registered.</span></span> <span data-ttu-id="6f43b-205">When requesting an authorization code or token, the Application ID and Key are sent to Azure AD during authentication.</span><span class="sxs-lookup"><span data-stu-id="6f43b-205">When requesting an authorization code or token, the Application ID and Key are sent to Azure AD during authentication.</span></span>
  * <span data-ttu-id="6f43b-206">**Key** - The key that is sent along with an Application ID when authenticating to Azure AD to call a web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-206">**Key** - The key that is sent along with an Application ID when authenticating to Azure AD to call a web API.</span></span>
* <span data-ttu-id="6f43b-207">Azure AD needs to ensure the application has the required permissions to access your directory data, other applications in your organization, and so on.</span><span class="sxs-lookup"><span data-stu-id="6f43b-207">Azure AD needs to ensure the application has the required permissions to access your directory data, other applications in your organization, and so on.</span></span>

<span data-ttu-id="6f43b-208">Provisioning becomes clearer when you understand that there are two categories of applications that can be developed and integrated with Azure AD:</span><span class="sxs-lookup"><span data-stu-id="6f43b-208">Provisioning becomes clearer when you understand that there are two categories of applications that can be developed and integrated with Azure AD:</span></span>

* <span data-ttu-id="6f43b-209">**Single tenant application** - A single tenant application is intended for use in one organization.</span><span class="sxs-lookup"><span data-stu-id="6f43b-209">**Single tenant application** - A single tenant application is intended for use in one organization.</span></span> <span data-ttu-id="6f43b-210">These are typically line-of-business (LoB) applications written by an enterprise developer.</span><span class="sxs-lookup"><span data-stu-id="6f43b-210">These are typically line-of-business (LoB) applications written by an enterprise developer.</span></span> <span data-ttu-id="6f43b-211">A single tenant application only needs to be accessed by users in one directory, and as a result, it only needs to be provisioned in one directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-211">A single tenant application only needs to be accessed by users in one directory, and as a result, it only needs to be provisioned in one directory.</span></span> <span data-ttu-id="6f43b-212">These applications are typically registered by a developer in the organization.</span><span class="sxs-lookup"><span data-stu-id="6f43b-212">These applications are typically registered by a developer in the organization.</span></span>
* <span data-ttu-id="6f43b-213">**Multi-tenant application** - A multi-tenant application is intended for use in many organizations, not just one organization.</span><span class="sxs-lookup"><span data-stu-id="6f43b-213">**Multi-tenant application** - A multi-tenant application is intended for use in many organizations, not just one organization.</span></span> <span data-ttu-id="6f43b-214">These are typically software-as-a-service (SaaS) applications written by an independent software vendor (ISV).</span><span class="sxs-lookup"><span data-stu-id="6f43b-214">These are typically software-as-a-service (SaaS) applications written by an independent software vendor (ISV).</span></span> <span data-ttu-id="6f43b-215">Multi-tenant applications need to be provisioned in each directory where they will be used, which requires user or administrator consent to register them.</span><span class="sxs-lookup"><span data-stu-id="6f43b-215">Multi-tenant applications need to be provisioned in each directory where they will be used, which requires user or administrator consent to register them.</span></span> <span data-ttu-id="6f43b-216">This consent process starts when an application has been registered in the directory and is given access to the Graph API or perhaps another web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-216">This consent process starts when an application has been registered in the directory and is given access to the Graph API or perhaps another web API.</span></span> <span data-ttu-id="6f43b-217">When a user or administrator from a different organization signs up to use the application, they are presented with a dialog that displays the permissions the application requires.</span><span class="sxs-lookup"><span data-stu-id="6f43b-217">When a user or administrator from a different organization signs up to use the application, they are presented with a dialog that displays the permissions the application requires.</span></span> <span data-ttu-id="6f43b-218">The user or administrator can then consent to the application, which gives the application access to the stated data, and finally registers the application in their directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-218">The user or administrator can then consent to the application, which gives the application access to the stated data, and finally registers the application in their directory.</span></span> <span data-ttu-id="6f43b-219">For more information, see [Overview of the Consent Framework](quickstart-v1-integrate-apps-with-azure-ad.md#overview-of-the-consent-framework).</span><span class="sxs-lookup"><span data-stu-id="6f43b-219">For more information, see [Overview of the Consent Framework](quickstart-v1-integrate-apps-with-azure-ad.md#overview-of-the-consent-framework).</span></span>

### <a name="additional-considerations-when-developing-single-tenant-or-multi-tenant-apps"></a><span data-ttu-id="6f43b-220">Additional considerations when developing single tenant or multi-tenant apps</span><span class="sxs-lookup"><span data-stu-id="6f43b-220">Additional considerations when developing single tenant or multi-tenant apps</span></span>
<span data-ttu-id="6f43b-221">Some additional considerations arise when developing a multi-tenant application instead of a single tenant application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-221">Some additional considerations arise when developing a multi-tenant application instead of a single tenant application.</span></span> <span data-ttu-id="6f43b-222">For example, if you are making your application available to users in multiple directories, you need a mechanism to determine which tenant they’re in.</span><span class="sxs-lookup"><span data-stu-id="6f43b-222">For example, if you are making your application available to users in multiple directories, you need a mechanism to determine which tenant they’re in.</span></span> <span data-ttu-id="6f43b-223">A single tenant application only needs to look in its own directory for a user, while a multi-tenant application needs to identify a specific user from all the directories in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-223">A single tenant application only needs to look in its own directory for a user, while a multi-tenant application needs to identify a specific user from all the directories in Azure AD.</span></span> <span data-ttu-id="6f43b-224">To accomplish this task, Azure AD provides a common authentication endpoint where any multi-tenant application can direct sign-in requests, instead of a tenant-specific endpoint.</span><span class="sxs-lookup"><span data-stu-id="6f43b-224">To accomplish this task, Azure AD provides a common authentication endpoint where any multi-tenant application can direct sign-in requests, instead of a tenant-specific endpoint.</span></span> <span data-ttu-id="6f43b-225">This endpoint is https://login.microsoftonline.com/common for all directories in Azure AD, whereas a tenant-specific endpoint might be https://login.microsoftonline.com/contoso.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="6f43b-225">This endpoint is https://login.microsoftonline.com/common for all directories in Azure AD, whereas a tenant-specific endpoint might be https://login.microsoftonline.com/contoso.onmicrosoft.com.</span></span> <span data-ttu-id="6f43b-226">The common endpoint is especially important to consider when developing your application because you’ll need the necessary logic to handle multiple tenants during sign-in, sign-out, and token validation.</span><span class="sxs-lookup"><span data-stu-id="6f43b-226">The common endpoint is especially important to consider when developing your application because you’ll need the necessary logic to handle multiple tenants during sign-in, sign-out, and token validation.</span></span>

<span data-ttu-id="6f43b-227">If you are currently developing a single tenant application but want to make it available to many organizations, you can easily make changes to the application and its configuration in Azure AD to make it multi-tenant capable.</span><span class="sxs-lookup"><span data-stu-id="6f43b-227">If you are currently developing a single tenant application but want to make it available to many organizations, you can easily make changes to the application and its configuration in Azure AD to make it multi-tenant capable.</span></span> <span data-ttu-id="6f43b-228">In addition, Azure AD uses the same signing key for all tokens in all directories, whether you are providing authentication in a single tenant or multi-tenant application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-228">In addition, Azure AD uses the same signing key for all tokens in all directories, whether you are providing authentication in a single tenant or multi-tenant application.</span></span>

<span data-ttu-id="6f43b-229">Each scenario listed in this document includes a subsection that describes its provisioning requirements.</span><span class="sxs-lookup"><span data-stu-id="6f43b-229">Each scenario listed in this document includes a subsection that describes its provisioning requirements.</span></span> <span data-ttu-id="6f43b-230">For more in-depth information about provisioning an application in Azure AD and the differences between single and multi-tenant applications, see [Integrating applications with Azure Active Directory](quickstart-v1-integrate-apps-with-azure-ad.md) for more information.</span><span class="sxs-lookup"><span data-stu-id="6f43b-230">For more in-depth information about provisioning an application in Azure AD and the differences between single and multi-tenant applications, see [Integrating applications with Azure Active Directory](quickstart-v1-integrate-apps-with-azure-ad.md) for more information.</span></span> <span data-ttu-id="6f43b-231">Continue reading to understand the common application scenarios in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-231">Continue reading to understand the common application scenarios in Azure AD.</span></span>

## <a name="application-types-and-scenarios"></a><span data-ttu-id="6f43b-232">Application Types and Scenarios</span><span class="sxs-lookup"><span data-stu-id="6f43b-232">Application Types and Scenarios</span></span>

<span data-ttu-id="6f43b-233">Each of the scenarios described here can be developed using various languages and platforms.</span><span class="sxs-lookup"><span data-stu-id="6f43b-233">Each of the scenarios described here can be developed using various languages and platforms.</span></span> <span data-ttu-id="6f43b-234">They are all backed by complete code samples available in the [Code Samples guide](sample-v1-code.md), or directly from the corresponding [GitHub sample repositories](https://github.com/Azure-Samples?q=active-directory).</span><span class="sxs-lookup"><span data-stu-id="6f43b-234">They are all backed by complete code samples available in the [Code Samples guide](sample-v1-code.md), or directly from the corresponding [GitHub sample repositories](https://github.com/Azure-Samples?q=active-directory).</span></span> <span data-ttu-id="6f43b-235">In addition, if your application needs a specific piece or segment of an end-to-end scenario, in most cases that functionality can be added independently.</span><span class="sxs-lookup"><span data-stu-id="6f43b-235">In addition, if your application needs a specific piece or segment of an end-to-end scenario, in most cases that functionality can be added independently.</span></span> <span data-ttu-id="6f43b-236">For example, if you have a native application that calls a web API, you can easily add a web application that also calls the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-236">For example, if you have a native application that calls a web API, you can easily add a web application that also calls the web API.</span></span> <span data-ttu-id="6f43b-237">The following diagram illustrates these scenarios and application types, and how different components can be added:</span><span class="sxs-lookup"><span data-stu-id="6f43b-237">The following diagram illustrates these scenarios and application types, and how different components can be added:</span></span>

![Application Types and scenarios](./media/authentication-scenarios/application_types_and_scenarios.png)

<span data-ttu-id="6f43b-239">These are the five primary application scenarios supported by Azure AD:</span><span class="sxs-lookup"><span data-stu-id="6f43b-239">These are the five primary application scenarios supported by Azure AD:</span></span>

* <span data-ttu-id="6f43b-240">[Web browser to web application](#web-browser-to-web-application): A user needs to sign in to a web application that is secured by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-240">[Web browser to web application](#web-browser-to-web-application): A user needs to sign in to a web application that is secured by Azure AD.</span></span>
* <span data-ttu-id="6f43b-241">[Single Page Application (SPA)](#single-page-application-spa): A user needs to sign in to a single page application that is secured by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-241">[Single Page Application (SPA)](#single-page-application-spa): A user needs to sign in to a single page application that is secured by Azure AD.</span></span>
* <span data-ttu-id="6f43b-242">[Native application to web API](#native-application-to-web-api): A native application that runs on a phone, tablet, or PC needs to authenticate a user to get resources from a web API that is secured by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-242">[Native application to web API](#native-application-to-web-api): A native application that runs on a phone, tablet, or PC needs to authenticate a user to get resources from a web API that is secured by Azure AD.</span></span>
* <span data-ttu-id="6f43b-243">[Web application to web API](#web-application-to-web-api): A web application needs to get resources from a web API secured by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-243">[Web application to web API](#web-application-to-web-api): A web application needs to get resources from a web API secured by Azure AD.</span></span>
* <span data-ttu-id="6f43b-244">[Daemon or server application to web API](#daemon-or-server-application-to-web-api): A daemon application or a server application with no web user interface needs to get resources from a web API secured by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-244">[Daemon or server application to web API](#daemon-or-server-application-to-web-api): A daemon application or a server application with no web user interface needs to get resources from a web API secured by Azure AD.</span></span>

### <a name="web-browser-to-web-application"></a><span data-ttu-id="6f43b-245">Web browser to web application</span><span class="sxs-lookup"><span data-stu-id="6f43b-245">Web browser to web application</span></span>

<span data-ttu-id="6f43b-246">This section describes an application that authenticates a user in a web browser to a web application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-246">This section describes an application that authenticates a user in a web browser to a web application.</span></span> <span data-ttu-id="6f43b-247">In this scenario, the web application directs the user’s browser to sign them in to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-247">In this scenario, the web application directs the user’s browser to sign them in to Azure AD.</span></span> <span data-ttu-id="6f43b-248">Azure AD returns a sign-in response through the user’s browser, which contains claims about the user in a security token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-248">Azure AD returns a sign-in response through the user’s browser, which contains claims about the user in a security token.</span></span> <span data-ttu-id="6f43b-249">This scenario supports sign-on using the WS-Federation, SAML 2.0, and OpenID Connect protocols.</span><span class="sxs-lookup"><span data-stu-id="6f43b-249">This scenario supports sign-on using the WS-Federation, SAML 2.0, and OpenID Connect protocols.</span></span>

#### <a name="diagram"></a><span data-ttu-id="6f43b-250">Diagram</span><span class="sxs-lookup"><span data-stu-id="6f43b-250">Diagram</span></span>

![Authentication flow for browser to web application](./media/authentication-scenarios/web_browser_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6f43b-252">Description of protocol flow</span><span class="sxs-lookup"><span data-stu-id="6f43b-252">Description of protocol flow</span></span>

1. <span data-ttu-id="6f43b-253">When a user visits the application and needs to sign in, they are redirected via a sign-in request to the authentication endpoint in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-253">When a user visits the application and needs to sign in, they are redirected via a sign-in request to the authentication endpoint in Azure AD.</span></span>
1. <span data-ttu-id="6f43b-254">The user signs in on the sign-in page.</span><span class="sxs-lookup"><span data-stu-id="6f43b-254">The user signs in on the sign-in page.</span></span>
1. <span data-ttu-id="6f43b-255">If authentication is successful, Azure AD creates an authentication token and returns a sign-in response to the application’s Reply URL that was configured in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="6f43b-255">If authentication is successful, Azure AD creates an authentication token and returns a sign-in response to the application’s Reply URL that was configured in the Azure portal.</span></span> <span data-ttu-id="6f43b-256">For a production application, this Reply URL should be HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6f43b-256">For a production application, this Reply URL should be HTTPS.</span></span> <span data-ttu-id="6f43b-257">The returned token includes claims about the user and Azure AD that are required by the application to validate the token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-257">The returned token includes claims about the user and Azure AD that are required by the application to validate the token.</span></span>
1. <span data-ttu-id="6f43b-258">The application validates the token by using a public signing key and issuer information available at the federation metadata document for Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-258">The application validates the token by using a public signing key and issuer information available at the federation metadata document for Azure AD.</span></span> <span data-ttu-id="6f43b-259">After the application validates the token, it starts a new session with the user.</span><span class="sxs-lookup"><span data-stu-id="6f43b-259">After the application validates the token, it starts a new session with the user.</span></span> <span data-ttu-id="6f43b-260">This session allows the user to access the application until it expires.</span><span class="sxs-lookup"><span data-stu-id="6f43b-260">This session allows the user to access the application until it expires.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="6f43b-261">Code samples</span><span class="sxs-lookup"><span data-stu-id="6f43b-261">Code samples</span></span>

<span data-ttu-id="6f43b-262">See the code samples for Web Browser to Web Application scenarios.</span><span class="sxs-lookup"><span data-stu-id="6f43b-262">See the code samples for Web Browser to Web Application scenarios.</span></span> <span data-ttu-id="6f43b-263">And, check back frequently -- new samples are added frequently.</span><span class="sxs-lookup"><span data-stu-id="6f43b-263">And, check back frequently -- new samples are added frequently.</span></span> <span data-ttu-id="6f43b-264">[Web Application](sample-v1-code.md#web-applications).</span><span class="sxs-lookup"><span data-stu-id="6f43b-264">[Web Application](sample-v1-code.md#web-applications).</span></span>

#### <a name="registering"></a><span data-ttu-id="6f43b-265">Registering</span><span class="sxs-lookup"><span data-stu-id="6f43b-265">Registering</span></span>

* <span data-ttu-id="6f43b-266">Single Tenant: If you are building an application just for your organization, it must be registered in your company’s directory by using the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="6f43b-266">Single Tenant: If you are building an application just for your organization, it must be registered in your company’s directory by using the Azure portal.</span></span>
* <span data-ttu-id="6f43b-267">Multi-Tenant: If you are building an application that can be used by users outside your organization, it must be registered in your company’s directory, but also must be registered in each organization’s directory that will be using the application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-267">Multi-Tenant: If you are building an application that can be used by users outside your organization, it must be registered in your company’s directory, but also must be registered in each organization’s directory that will be using the application.</span></span> <span data-ttu-id="6f43b-268">To make your application available in their directory, you can include a sign-up process for your customers that enables them to consent to your application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-268">To make your application available in their directory, you can include a sign-up process for your customers that enables them to consent to your application.</span></span> <span data-ttu-id="6f43b-269">When they sign up for your application, they will be presented with a dialog that shows the permissions the application requires, and then the option to consent.</span><span class="sxs-lookup"><span data-stu-id="6f43b-269">When they sign up for your application, they will be presented with a dialog that shows the permissions the application requires, and then the option to consent.</span></span> <span data-ttu-id="6f43b-270">Depending on the required permissions, an administrator in the other organization may be required to give consent.</span><span class="sxs-lookup"><span data-stu-id="6f43b-270">Depending on the required permissions, an administrator in the other organization may be required to give consent.</span></span> <span data-ttu-id="6f43b-271">When the user or administrator consents, the application is registered in their directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-271">When the user or administrator consents, the application is registered in their directory.</span></span> <span data-ttu-id="6f43b-272">For more information, see [Integrating Applications with Azure Active Directory](quickstart-v1-integrate-apps-with-azure-ad.md).</span><span class="sxs-lookup"><span data-stu-id="6f43b-272">For more information, see [Integrating Applications with Azure Active Directory](quickstart-v1-integrate-apps-with-azure-ad.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6f43b-273">Token expiration</span><span class="sxs-lookup"><span data-stu-id="6f43b-273">Token expiration</span></span>

<span data-ttu-id="6f43b-274">The user’s session expires when the lifetime of the token issued by Azure AD expires.</span><span class="sxs-lookup"><span data-stu-id="6f43b-274">The user’s session expires when the lifetime of the token issued by Azure AD expires.</span></span> <span data-ttu-id="6f43b-275">Your application can shorten this time period if desired, such as signing out users based on a period of inactivity.</span><span class="sxs-lookup"><span data-stu-id="6f43b-275">Your application can shorten this time period if desired, such as signing out users based on a period of inactivity.</span></span> <span data-ttu-id="6f43b-276">When the session expires, the user will be prompted to sign in again.</span><span class="sxs-lookup"><span data-stu-id="6f43b-276">When the session expires, the user will be prompted to sign in again.</span></span>

### <a name="single-page-application-spa"></a><span data-ttu-id="6f43b-277">Single Page Application (SPA)</span><span class="sxs-lookup"><span data-stu-id="6f43b-277">Single Page Application (SPA)</span></span>

<span data-ttu-id="6f43b-278">This section describes authentication for a Single Page Application, that uses Azure AD and the OAuth 2.0 implicit authorization grant to secure its web API back end.</span><span class="sxs-lookup"><span data-stu-id="6f43b-278">This section describes authentication for a Single Page Application, that uses Azure AD and the OAuth 2.0 implicit authorization grant to secure its web API back end.</span></span> <span data-ttu-id="6f43b-279">Single Page Applications are typically structured as a JavaScript presentation layer (front end) that runs in the browser and a Web API back end that runs on a server and implements the application’s business logic.</span><span class="sxs-lookup"><span data-stu-id="6f43b-279">Single Page Applications are typically structured as a JavaScript presentation layer (front end) that runs in the browser and a Web API back end that runs on a server and implements the application’s business logic.</span></span> <span data-ttu-id="6f43b-280">To learn more about the implicit authorization grant, and help you decide whether it's right for your application scenario, see [Understanding the OAuth2 implicit grant flow in Azure Active Directory](v1-oauth2-implicit-grant-flow.md).</span><span class="sxs-lookup"><span data-stu-id="6f43b-280">To learn more about the implicit authorization grant, and help you decide whether it's right for your application scenario, see [Understanding the OAuth2 implicit grant flow in Azure Active Directory](v1-oauth2-implicit-grant-flow.md).</span></span>

<span data-ttu-id="6f43b-281">In this scenario, when the user signs in, the JavaScript front end uses [Active Directory Authentication Library for JavaScript (ADAL.JS)](https://github.com/AzureAD/azure-activedirectory-library-for-js) and the implicit authorization grant to obtain an ID token (id_token) from Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-281">In this scenario, when the user signs in, the JavaScript front end uses [Active Directory Authentication Library for JavaScript (ADAL.JS)](https://github.com/AzureAD/azure-activedirectory-library-for-js) and the implicit authorization grant to obtain an ID token (id_token) from Azure AD.</span></span> <span data-ttu-id="6f43b-282">The token is cached and the client attaches it to the request as the bearer token when making calls to its Web API back end, which is secured using the OWIN middleware.</span><span class="sxs-lookup"><span data-stu-id="6f43b-282">The token is cached and the client attaches it to the request as the bearer token when making calls to its Web API back end, which is secured using the OWIN middleware.</span></span> 

#### <a name="diagram"></a><span data-ttu-id="6f43b-283">Diagram</span><span class="sxs-lookup"><span data-stu-id="6f43b-283">Diagram</span></span>

![Single Page Application diagram](./media/authentication-scenarios/single_page_app.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6f43b-285">Description of protocol flow</span><span class="sxs-lookup"><span data-stu-id="6f43b-285">Description of protocol flow</span></span>

1. <span data-ttu-id="6f43b-286">The user navigates to the web application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-286">The user navigates to the web application.</span></span>
1. <span data-ttu-id="6f43b-287">The application returns the JavaScript front end (presentation layer) to the browser.</span><span class="sxs-lookup"><span data-stu-id="6f43b-287">The application returns the JavaScript front end (presentation layer) to the browser.</span></span>
1. <span data-ttu-id="6f43b-288">The user initiates sign in, for example by clicking a sign-in link.</span><span class="sxs-lookup"><span data-stu-id="6f43b-288">The user initiates sign in, for example by clicking a sign-in link.</span></span> <span data-ttu-id="6f43b-289">The browser sends a GET to the Azure AD authorization endpoint to request an ID token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-289">The browser sends a GET to the Azure AD authorization endpoint to request an ID token.</span></span> <span data-ttu-id="6f43b-290">This request includes the application ID and reply URL in the query parameters.</span><span class="sxs-lookup"><span data-stu-id="6f43b-290">This request includes the application ID and reply URL in the query parameters.</span></span>
1. <span data-ttu-id="6f43b-291">Azure AD validates the Reply URL against the registered Reply URL that was configured in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="6f43b-291">Azure AD validates the Reply URL against the registered Reply URL that was configured in the Azure portal.</span></span>
1. <span data-ttu-id="6f43b-292">The user signs in on the sign-in page.</span><span class="sxs-lookup"><span data-stu-id="6f43b-292">The user signs in on the sign-in page.</span></span>
1. <span data-ttu-id="6f43b-293">If authentication is successful, Azure AD creates an ID token and returns it as a URL fragment (#) to the application’s Reply URL.</span><span class="sxs-lookup"><span data-stu-id="6f43b-293">If authentication is successful, Azure AD creates an ID token and returns it as a URL fragment (#) to the application’s Reply URL.</span></span> <span data-ttu-id="6f43b-294">For a production application, this Reply URL should be HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6f43b-294">For a production application, this Reply URL should be HTTPS.</span></span> <span data-ttu-id="6f43b-295">The returned token includes claims about the user and Azure AD that are required by the application to validate the token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-295">The returned token includes claims about the user and Azure AD that are required by the application to validate the token.</span></span>
1. <span data-ttu-id="6f43b-296">The JavaScript client code running in the browser extracts the token from the response to use in securing calls to the application’s web API back end.</span><span class="sxs-lookup"><span data-stu-id="6f43b-296">The JavaScript client code running in the browser extracts the token from the response to use in securing calls to the application’s web API back end.</span></span>
1. <span data-ttu-id="6f43b-297">The browser calls the application’s web API back end with the ID token in the authorization header.</span><span class="sxs-lookup"><span data-stu-id="6f43b-297">The browser calls the application’s web API back end with the ID token in the authorization header.</span></span> <span data-ttu-id="6f43b-298">The Azure AD authentication service issues an ID token that can be used as a bearer token if the resource is the same as the client ID (in this case, this is true as the web API is the app's own backend).</span><span class="sxs-lookup"><span data-stu-id="6f43b-298">The Azure AD authentication service issues an ID token that can be used as a bearer token if the resource is the same as the client ID (in this case, this is true as the web API is the app's own backend).</span></span> 

#### <a name="code-samples"></a><span data-ttu-id="6f43b-299">Code samples</span><span class="sxs-lookup"><span data-stu-id="6f43b-299">Code samples</span></span>

<span data-ttu-id="6f43b-300">See the code samples for Single Page Application (SPA) scenarios.</span><span class="sxs-lookup"><span data-stu-id="6f43b-300">See the code samples for Single Page Application (SPA) scenarios.</span></span> <span data-ttu-id="6f43b-301">Be sure to check back frequently -- new samples are added frequently.</span><span class="sxs-lookup"><span data-stu-id="6f43b-301">Be sure to check back frequently -- new samples are added frequently.</span></span> <span data-ttu-id="6f43b-302">[Single Page Application (SPA)](sample-v1-code.md#single-page-applications).</span><span class="sxs-lookup"><span data-stu-id="6f43b-302">[Single Page Application (SPA)](sample-v1-code.md#single-page-applications).</span></span>

#### <a name="registering"></a><span data-ttu-id="6f43b-303">Registering</span><span class="sxs-lookup"><span data-stu-id="6f43b-303">Registering</span></span>

* <span data-ttu-id="6f43b-304">Single Tenant: If you are building an application just for your organization, it must be registered in your company’s directory by using the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="6f43b-304">Single Tenant: If you are building an application just for your organization, it must be registered in your company’s directory by using the Azure portal.</span></span>
* <span data-ttu-id="6f43b-305">Multi-Tenant: If you are building an application that can be used by users outside your organization, it must be registered in your company’s directory, but also must be registered in each organization’s directory that will be using the application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-305">Multi-Tenant: If you are building an application that can be used by users outside your organization, it must be registered in your company’s directory, but also must be registered in each organization’s directory that will be using the application.</span></span> <span data-ttu-id="6f43b-306">To make your application available in their directory, you can include a sign-up process for your customers that enables them to consent to your application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-306">To make your application available in their directory, you can include a sign-up process for your customers that enables them to consent to your application.</span></span> <span data-ttu-id="6f43b-307">When they sign up for your application, they will be presented with a dialog that shows the permissions the application requires, and then the option to consent.</span><span class="sxs-lookup"><span data-stu-id="6f43b-307">When they sign up for your application, they will be presented with a dialog that shows the permissions the application requires, and then the option to consent.</span></span> <span data-ttu-id="6f43b-308">Depending on the required permissions, an administrator in the other organization may be required to give consent.</span><span class="sxs-lookup"><span data-stu-id="6f43b-308">Depending on the required permissions, an administrator in the other organization may be required to give consent.</span></span> <span data-ttu-id="6f43b-309">When the user or administrator consents, the application is registered in their directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-309">When the user or administrator consents, the application is registered in their directory.</span></span> <span data-ttu-id="6f43b-310">For more information, see [Integrating Applications with Azure Active Directory](quickstart-v1-integrate-apps-with-azure-ad.md).</span><span class="sxs-lookup"><span data-stu-id="6f43b-310">For more information, see [Integrating Applications with Azure Active Directory](quickstart-v1-integrate-apps-with-azure-ad.md).</span></span>

<span data-ttu-id="6f43b-311">After registering the application, it must be configured to use OAuth 2.0 Implicit Grant protocol.</span><span class="sxs-lookup"><span data-stu-id="6f43b-311">After registering the application, it must be configured to use OAuth 2.0 Implicit Grant protocol.</span></span> <span data-ttu-id="6f43b-312">By default, this protocol is disabled for applications.</span><span class="sxs-lookup"><span data-stu-id="6f43b-312">By default, this protocol is disabled for applications.</span></span> <span data-ttu-id="6f43b-313">To enable the OAuth2 Implicit Grant protocol for your application, edit its application manifest from the Azure portal and set the “oauth2AllowImplicitFlow” value to true.</span><span class="sxs-lookup"><span data-stu-id="6f43b-313">To enable the OAuth2 Implicit Grant protocol for your application, edit its application manifest from the Azure portal and set the “oauth2AllowImplicitFlow” value to true.</span></span> <span data-ttu-id="6f43b-314">For detailed instructions, see [Enabling OAuth 2.0 Implicit Grant for Single Page Applications](quickstart-v1-integrate-apps-with-azure-ad.md).</span><span class="sxs-lookup"><span data-stu-id="6f43b-314">For detailed instructions, see [Enabling OAuth 2.0 Implicit Grant for Single Page Applications](quickstart-v1-integrate-apps-with-azure-ad.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6f43b-315">Token expiration</span><span class="sxs-lookup"><span data-stu-id="6f43b-315">Token expiration</span></span>

<span data-ttu-id="6f43b-316">Using ADAL.js helps with:</span><span class="sxs-lookup"><span data-stu-id="6f43b-316">Using ADAL.js helps with:</span></span>

* <span data-ttu-id="6f43b-317">refreshing an expired token</span><span class="sxs-lookup"><span data-stu-id="6f43b-317">refreshing an expired token</span></span>
* <span data-ttu-id="6f43b-318">requesting an access token to call a web API resource</span><span class="sxs-lookup"><span data-stu-id="6f43b-318">requesting an access token to call a web API resource</span></span>

<span data-ttu-id="6f43b-319">After a successful authentication, Azure AD writes a cookie in the user's browser to establish a session.</span><span class="sxs-lookup"><span data-stu-id="6f43b-319">After a successful authentication, Azure AD writes a cookie in the user's browser to establish a session.</span></span> <span data-ttu-id="6f43b-320">Note the session exists between the user and Azure AD (not between the user and the web application).</span><span class="sxs-lookup"><span data-stu-id="6f43b-320">Note the session exists between the user and Azure AD (not between the user and the web application).</span></span> <span data-ttu-id="6f43b-321">When a token expires, ADAL.js uses this session to silently obtain another token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-321">When a token expires, ADAL.js uses this session to silently obtain another token.</span></span> <span data-ttu-id="6f43b-322">ADAL.js uses a hidden iFrame to send and receive the request using the OAuth Implicit Grant protocol.</span><span class="sxs-lookup"><span data-stu-id="6f43b-322">ADAL.js uses a hidden iFrame to send and receive the request using the OAuth Implicit Grant protocol.</span></span> <span data-ttu-id="6f43b-323">ADAL.js can also use this same mechanism to silently obtain access tokens for other web API resources the application calls as long as these resources support cross-origin resource sharing (CORS), are registered in the user’s directory, and any required consent was given by the user during sign-in.</span><span class="sxs-lookup"><span data-stu-id="6f43b-323">ADAL.js can also use this same mechanism to silently obtain access tokens for other web API resources the application calls as long as these resources support cross-origin resource sharing (CORS), are registered in the user’s directory, and any required consent was given by the user during sign-in.</span></span>

### <a name="native-application-to-web-api"></a><span data-ttu-id="6f43b-324">Native application to web API</span><span class="sxs-lookup"><span data-stu-id="6f43b-324">Native application to web API</span></span>

<span data-ttu-id="6f43b-325">This section describes a native application that calls a web API on behalf of a user.</span><span class="sxs-lookup"><span data-stu-id="6f43b-325">This section describes a native application that calls a web API on behalf of a user.</span></span> <span data-ttu-id="6f43b-326">This scenario is built on the OAuth 2.0 authorization code grant type with a public client, as described in section 4.1 of the [OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="6f43b-326">This scenario is built on the OAuth 2.0 authorization code grant type with a public client, as described in section 4.1 of the [OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span></span> <span data-ttu-id="6f43b-327">The native application obtains an access token for the user by using the OAuth 2.0 protocol.</span><span class="sxs-lookup"><span data-stu-id="6f43b-327">The native application obtains an access token for the user by using the OAuth 2.0 protocol.</span></span> <span data-ttu-id="6f43b-328">This access token is then sent in the request to the web API, which authorizes the user and returns the desired resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-328">This access token is then sent in the request to the web API, which authorizes the user and returns the desired resource.</span></span>

#### <a name="diagram"></a><span data-ttu-id="6f43b-329">Diagram</span><span class="sxs-lookup"><span data-stu-id="6f43b-329">Diagram</span></span>

![Native Application to Web API Diagram](./media/authentication-scenarios/native_app_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6f43b-331">Description of protocol flow</span><span class="sxs-lookup"><span data-stu-id="6f43b-331">Description of protocol flow</span></span>

<span data-ttu-id="6f43b-332">If you are using the AD Authentication Libraries, most of the protocol details described below are handled for you, such as the browser pop-up, token caching, and handling of refresh tokens.</span><span class="sxs-lookup"><span data-stu-id="6f43b-332">If you are using the AD Authentication Libraries, most of the protocol details described below are handled for you, such as the browser pop-up, token caching, and handling of refresh tokens.</span></span>

1. <span data-ttu-id="6f43b-333">Using a browser pop-up, the native application makes a request to the authorization endpoint in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-333">Using a browser pop-up, the native application makes a request to the authorization endpoint in Azure AD.</span></span> <span data-ttu-id="6f43b-334">This request includes the Application ID and the redirect URI of the native application as shown in the Azure portal, and the application ID URI for the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-334">This request includes the Application ID and the redirect URI of the native application as shown in the Azure portal, and the application ID URI for the web API.</span></span> <span data-ttu-id="6f43b-335">If the user hasn’t already signed in, they are prompted to sign in again</span><span class="sxs-lookup"><span data-stu-id="6f43b-335">If the user hasn’t already signed in, they are prompted to sign in again</span></span>
1. <span data-ttu-id="6f43b-336">Azure AD authenticates the user.</span><span class="sxs-lookup"><span data-stu-id="6f43b-336">Azure AD authenticates the user.</span></span> <span data-ttu-id="6f43b-337">If it is a multi-tenant application and consent is required to use the application, the user will be required to consent if they haven’t already done so.</span><span class="sxs-lookup"><span data-stu-id="6f43b-337">If it is a multi-tenant application and consent is required to use the application, the user will be required to consent if they haven’t already done so.</span></span> <span data-ttu-id="6f43b-338">After granting consent and upon successful authentication, Azure AD issues an authorization code response back to the client application’s redirect URI.</span><span class="sxs-lookup"><span data-stu-id="6f43b-338">After granting consent and upon successful authentication, Azure AD issues an authorization code response back to the client application’s redirect URI.</span></span>
1. <span data-ttu-id="6f43b-339">When Azure AD issues an authorization code response back to the redirect URI, the client application stops browser interaction and extracts the authorization code from the response.</span><span class="sxs-lookup"><span data-stu-id="6f43b-339">When Azure AD issues an authorization code response back to the redirect URI, the client application stops browser interaction and extracts the authorization code from the response.</span></span> <span data-ttu-id="6f43b-340">Using this authorization code, the client application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span><span class="sxs-lookup"><span data-stu-id="6f43b-340">Using this authorization code, the client application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span></span>
1. <span data-ttu-id="6f43b-341">The authorization code and information about the client application and web API are validated by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-341">The authorization code and information about the client application and web API are validated by Azure AD.</span></span> <span data-ttu-id="6f43b-342">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-342">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span> <span data-ttu-id="6f43b-343">In addition, Azure AD returns basic information about the user, such as their display name and tenant ID.</span><span class="sxs-lookup"><span data-stu-id="6f43b-343">In addition, Azure AD returns basic information about the user, such as their display name and tenant ID.</span></span>
1. <span data-ttu-id="6f43b-344">Over HTTPS, the client application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-344">Over HTTPS, the client application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="6f43b-345">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-345">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>
1. <span data-ttu-id="6f43b-346">When the access token expires, the client application will receive an error that indicates the user needs to authenticate again.</span><span class="sxs-lookup"><span data-stu-id="6f43b-346">When the access token expires, the client application will receive an error that indicates the user needs to authenticate again.</span></span> <span data-ttu-id="6f43b-347">If the application has a valid refresh token, it can be used to acquire a new access token without prompting the user to sign in again.</span><span class="sxs-lookup"><span data-stu-id="6f43b-347">If the application has a valid refresh token, it can be used to acquire a new access token without prompting the user to sign in again.</span></span> <span data-ttu-id="6f43b-348">If the refresh token expires, the application will need to interactively authenticate the user once again.</span><span class="sxs-lookup"><span data-stu-id="6f43b-348">If the refresh token expires, the application will need to interactively authenticate the user once again.</span></span>

> [!NOTE]
> <span data-ttu-id="6f43b-349">The refresh token issued by Azure AD can be used to access multiple resources.</span><span class="sxs-lookup"><span data-stu-id="6f43b-349">The refresh token issued by Azure AD can be used to access multiple resources.</span></span> <span data-ttu-id="6f43b-350">For example, if you have a client application that has permission to call two web APIs, the refresh token can be used to get an access token to the other web API as well.</span><span class="sxs-lookup"><span data-stu-id="6f43b-350">For example, if you have a client application that has permission to call two web APIs, the refresh token can be used to get an access token to the other web API as well.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="6f43b-351">Code samples</span><span class="sxs-lookup"><span data-stu-id="6f43b-351">Code samples</span></span>

<span data-ttu-id="6f43b-352">See the code samples for Native Application to Web API scenarios.</span><span class="sxs-lookup"><span data-stu-id="6f43b-352">See the code samples for Native Application to Web API scenarios.</span></span> <span data-ttu-id="6f43b-353">And, check back frequently -- we add new samples frequently.</span><span class="sxs-lookup"><span data-stu-id="6f43b-353">And, check back frequently -- we add new samples frequently.</span></span> <span data-ttu-id="6f43b-354">[Native Application to Web API](sample-v1-code.md#desktop-and-mobile-public-client-applications-calling-microsoft-graph-or-a-web-api).</span><span class="sxs-lookup"><span data-stu-id="6f43b-354">[Native Application to Web API](sample-v1-code.md#desktop-and-mobile-public-client-applications-calling-microsoft-graph-or-a-web-api).</span></span>

#### <a name="registering"></a><span data-ttu-id="6f43b-355">Registering</span><span class="sxs-lookup"><span data-stu-id="6f43b-355">Registering</span></span>

* <span data-ttu-id="6f43b-356">Single Tenant: Both the native application and the web API must be registered in the same directory in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-356">Single Tenant: Both the native application and the web API must be registered in the same directory in Azure AD.</span></span> <span data-ttu-id="6f43b-357">The web API can be configured to expose a set of permissions, which are used to limit the native application’s access to its resources.</span><span class="sxs-lookup"><span data-stu-id="6f43b-357">The web API can be configured to expose a set of permissions, which are used to limit the native application’s access to its resources.</span></span> <span data-ttu-id="6f43b-358">The client application then selects the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="6f43b-358">The client application then selects the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure portal.</span></span>
* <span data-ttu-id="6f43b-359">Multi-Tenant: First, the native application only ever registered in the developer or publisher’s directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-359">Multi-Tenant: First, the native application only ever registered in the developer or publisher’s directory.</span></span> <span data-ttu-id="6f43b-360">Second, the native application is configured to indicate the permissions it requires to be functional.</span><span class="sxs-lookup"><span data-stu-id="6f43b-360">Second, the native application is configured to indicate the permissions it requires to be functional.</span></span> <span data-ttu-id="6f43b-361">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span><span class="sxs-lookup"><span data-stu-id="6f43b-361">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span></span> <span data-ttu-id="6f43b-362">Some applications only require user-level permissions, which any user in the organization can consent to.</span><span class="sxs-lookup"><span data-stu-id="6f43b-362">Some applications only require user-level permissions, which any user in the organization can consent to.</span></span> <span data-ttu-id="6f43b-363">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span><span class="sxs-lookup"><span data-stu-id="6f43b-363">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span></span> <span data-ttu-id="6f43b-364">Only a directory administrator can give consent to applications that require this level of permissions.</span><span class="sxs-lookup"><span data-stu-id="6f43b-364">Only a directory administrator can give consent to applications that require this level of permissions.</span></span> <span data-ttu-id="6f43b-365">When the user or administrator consents, only the web API is registered in their directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-365">When the user or administrator consents, only the web API is registered in their directory.</span></span> <span data-ttu-id="6f43b-366">For more information, see [Integrating Applications with Azure Active Directory](quickstart-v1-integrate-apps-with-azure-ad.md).</span><span class="sxs-lookup"><span data-stu-id="6f43b-366">For more information, see [Integrating Applications with Azure Active Directory](quickstart-v1-integrate-apps-with-azure-ad.md).</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6f43b-367">Token expiration</span><span class="sxs-lookup"><span data-stu-id="6f43b-367">Token expiration</span></span>

<span data-ttu-id="6f43b-368">When the native application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-368">When the native application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="6f43b-369">When the access token expires, the refresh token can be used to re-authenticate the user without requiring them to sign in again.</span><span class="sxs-lookup"><span data-stu-id="6f43b-369">When the access token expires, the refresh token can be used to re-authenticate the user without requiring them to sign in again.</span></span> <span data-ttu-id="6f43b-370">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-370">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span></span>

### <a name="web-application-to-web-api"></a><span data-ttu-id="6f43b-371">Web application to web API</span><span class="sxs-lookup"><span data-stu-id="6f43b-371">Web application to web API</span></span>

<span data-ttu-id="6f43b-372">This section describes a web application that needs to get resources from a web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-372">This section describes a web application that needs to get resources from a web API.</span></span> <span data-ttu-id="6f43b-373">In this scenario, there are two identity types that the web application can use to authenticate and call the web API: an application identity, or a delegated user identity.</span><span class="sxs-lookup"><span data-stu-id="6f43b-373">In this scenario, there are two identity types that the web application can use to authenticate and call the web API: an application identity, or a delegated user identity.</span></span>

<span data-ttu-id="6f43b-374">*Application identity:* This scenario uses OAuth 2.0 client credentials grant to authenticate as the application and access the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-374">*Application identity:* This scenario uses OAuth 2.0 client credentials grant to authenticate as the application and access the web API.</span></span> <span data-ttu-id="6f43b-375">When using an application identity, the web API can only detect that the web application is calling it, as the web API does not receive any information about the user.</span><span class="sxs-lookup"><span data-stu-id="6f43b-375">When using an application identity, the web API can only detect that the web application is calling it, as the web API does not receive any information about the user.</span></span> <span data-ttu-id="6f43b-376">If the application receives information about the user, it will be sent via the application protocol, and it is not signed by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-376">If the application receives information about the user, it will be sent via the application protocol, and it is not signed by Azure AD.</span></span> <span data-ttu-id="6f43b-377">The web API trusts that the web application authenticated the user.</span><span class="sxs-lookup"><span data-stu-id="6f43b-377">The web API trusts that the web application authenticated the user.</span></span> <span data-ttu-id="6f43b-378">For this reason, this pattern is called a trusted subsystem.</span><span class="sxs-lookup"><span data-stu-id="6f43b-378">For this reason, this pattern is called a trusted subsystem.</span></span>

<span data-ttu-id="6f43b-379">*Delegated user identity:* This scenario can be accomplished in two ways: OpenID Connect, and OAuth 2.0 authorization code grant with a confidential client.</span><span class="sxs-lookup"><span data-stu-id="6f43b-379">*Delegated user identity:* This scenario can be accomplished in two ways: OpenID Connect, and OAuth 2.0 authorization code grant with a confidential client.</span></span> <span data-ttu-id="6f43b-380">The web application obtains an access token for the user, which proves to the web API that the user successfully authenticated to the web application and that the web application was able to obtain a delegated user identity to call the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-380">The web application obtains an access token for the user, which proves to the web API that the user successfully authenticated to the web application and that the web application was able to obtain a delegated user identity to call the web API.</span></span> <span data-ttu-id="6f43b-381">This access token is sent in the request to the web API, which authorizes the user and returns the desired resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-381">This access token is sent in the request to the web API, which authorizes the user and returns the desired resource.</span></span>

#### <a name="diagram"></a><span data-ttu-id="6f43b-382">Diagram</span><span class="sxs-lookup"><span data-stu-id="6f43b-382">Diagram</span></span>

![Web Application to Web API diagram](./media/authentication-scenarios/web_app_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6f43b-384">Description of protocol flow</span><span class="sxs-lookup"><span data-stu-id="6f43b-384">Description of protocol flow</span></span>

<span data-ttu-id="6f43b-385">Both the application identity and delegated user identity types are discussed in the flow below.</span><span class="sxs-lookup"><span data-stu-id="6f43b-385">Both the application identity and delegated user identity types are discussed in the flow below.</span></span> <span data-ttu-id="6f43b-386">The key difference between them is that the delegated user identity must first acquire an authorization code before the user can sign in and gain access to the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-386">The key difference between them is that the delegated user identity must first acquire an authorization code before the user can sign in and gain access to the web API.</span></span>

##### <a name="application-identity-with-oauth-20-client-credentials-grant"></a><span data-ttu-id="6f43b-387">Application identity with OAuth 2.0 client credentials grant</span><span class="sxs-lookup"><span data-stu-id="6f43b-387">Application identity with OAuth 2.0 client credentials grant</span></span>

1. <span data-ttu-id="6f43b-388">A user is signed in to Azure AD in the web application (see the [Web Browser to Web Application](#web-browser-to-web-application) above).</span><span class="sxs-lookup"><span data-stu-id="6f43b-388">A user is signed in to Azure AD in the web application (see the [Web Browser to Web Application](#web-browser-to-web-application) above).</span></span>
1. <span data-ttu-id="6f43b-389">The web application needs to acquire an access token so that it can authenticate to the web API and retrieve the desired resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-389">The web application needs to acquire an access token so that it can authenticate to the web API and retrieve the desired resource.</span></span> <span data-ttu-id="6f43b-390">It makes a request to Azure AD’s token endpoint, providing the credential, Application ID, and web API’s application ID URI.</span><span class="sxs-lookup"><span data-stu-id="6f43b-390">It makes a request to Azure AD’s token endpoint, providing the credential, Application ID, and web API’s application ID URI.</span></span>
1. <span data-ttu-id="6f43b-391">Azure AD authenticates the application and returns a JWT access token that is used to call the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-391">Azure AD authenticates the application and returns a JWT access token that is used to call the web API.</span></span>
1. <span data-ttu-id="6f43b-392">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-392">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="6f43b-393">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-393">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>

##### <a name="delegated-user-identity-with-openid-connect"></a><span data-ttu-id="6f43b-394">Delegated user identity with OpenID Connect</span><span class="sxs-lookup"><span data-stu-id="6f43b-394">Delegated user identity with OpenID Connect</span></span>

1. <span data-ttu-id="6f43b-395">A user is signed in to a web application using Azure AD (see the [Web Browser to Web Application](#web-browser-to-web-application) section above).</span><span class="sxs-lookup"><span data-stu-id="6f43b-395">A user is signed in to a web application using Azure AD (see the [Web Browser to Web Application](#web-browser-to-web-application) section above).</span></span> <span data-ttu-id="6f43b-396">If the user of the web application has not yet consented to allowing the web application to call the web API on its behalf, the user will need to consent.</span><span class="sxs-lookup"><span data-stu-id="6f43b-396">If the user of the web application has not yet consented to allowing the web application to call the web API on its behalf, the user will need to consent.</span></span> <span data-ttu-id="6f43b-397">The application will display the permissions it requires, and if any of these are administrator-level permissions, a normal user in the directory will not be able to consent.</span><span class="sxs-lookup"><span data-stu-id="6f43b-397">The application will display the permissions it requires, and if any of these are administrator-level permissions, a normal user in the directory will not be able to consent.</span></span> <span data-ttu-id="6f43b-398">This consent process only applies to multi-tenant applications, not single tenant applications, as the application will already have the necessary permissions.</span><span class="sxs-lookup"><span data-stu-id="6f43b-398">This consent process only applies to multi-tenant applications, not single tenant applications, as the application will already have the necessary permissions.</span></span> <span data-ttu-id="6f43b-399">When the user signed in, the web application received an ID token with information about the user, as well as an authorization code.</span><span class="sxs-lookup"><span data-stu-id="6f43b-399">When the user signed in, the web application received an ID token with information about the user, as well as an authorization code.</span></span>
1. <span data-ttu-id="6f43b-400">Using the authorization code issued by Azure AD, the web application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span><span class="sxs-lookup"><span data-stu-id="6f43b-400">Using the authorization code issued by Azure AD, the web application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span></span>
1. <span data-ttu-id="6f43b-401">The authorization code and information about the web application and web API are validated by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-401">The authorization code and information about the web application and web API are validated by Azure AD.</span></span> <span data-ttu-id="6f43b-402">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-402">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span>
1. <span data-ttu-id="6f43b-403">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-403">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="6f43b-404">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-404">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>

##### <a name="delegated-user-identity-with-oauth-20-authorization-code-grant"></a><span data-ttu-id="6f43b-405">Delegated user identity with OAuth 2.0 authorization code grant</span><span class="sxs-lookup"><span data-stu-id="6f43b-405">Delegated user identity with OAuth 2.0 authorization code grant</span></span>

1. <span data-ttu-id="6f43b-406">A user is already signed in to a web application, whose authentication mechanism is independent of Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-406">A user is already signed in to a web application, whose authentication mechanism is independent of Azure AD.</span></span>
1. <span data-ttu-id="6f43b-407">The web application requires an authorization code to acquire an access token, so it issues a request through the browser to Azure AD’s authorization endpoint, providing the Application ID and redirect URI for the web application after successful authentication.</span><span class="sxs-lookup"><span data-stu-id="6f43b-407">The web application requires an authorization code to acquire an access token, so it issues a request through the browser to Azure AD’s authorization endpoint, providing the Application ID and redirect URI for the web application after successful authentication.</span></span> <span data-ttu-id="6f43b-408">The user signs in to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-408">The user signs in to Azure AD.</span></span>
1. <span data-ttu-id="6f43b-409">If the user of the web application has not yet consented to allowing the web application to call the web API on its behalf, the user will need to consent.</span><span class="sxs-lookup"><span data-stu-id="6f43b-409">If the user of the web application has not yet consented to allowing the web application to call the web API on its behalf, the user will need to consent.</span></span> <span data-ttu-id="6f43b-410">The application will display the permissions it requires, and if any of these are administrator-level permissions, a normal user in the directory will not be able to consent.</span><span class="sxs-lookup"><span data-stu-id="6f43b-410">The application will display the permissions it requires, and if any of these are administrator-level permissions, a normal user in the directory will not be able to consent.</span></span> <span data-ttu-id="6f43b-411">This consent applies to both single and multi-tenant application.</span><span class="sxs-lookup"><span data-stu-id="6f43b-411">This consent applies to both single and multi-tenant application.</span></span> <span data-ttu-id="6f43b-412">In the single tenant case, an admin can perform admin consent to consent on behalf of their users.</span><span class="sxs-lookup"><span data-stu-id="6f43b-412">In the single tenant case, an admin can perform admin consent to consent on behalf of their users.</span></span> <span data-ttu-id="6f43b-413">This can be done using the `Grant Permissions` button in the [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="6f43b-413">This can be done using the `Grant Permissions` button in the [Azure Portal](https://portal.azure.com).</span></span> 
1. <span data-ttu-id="6f43b-414">After the user has consented, the web application receives the authorization code that it needs to acquire an access token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-414">After the user has consented, the web application receives the authorization code that it needs to acquire an access token.</span></span>
1. <span data-ttu-id="6f43b-415">Using the authorization code issued by Azure AD, the web application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span><span class="sxs-lookup"><span data-stu-id="6f43b-415">Using the authorization code issued by Azure AD, the web application sends a request to Azure AD’s token endpoint that includes the authorization code, details about the client application (Application ID and redirect URI), and the desired resource (application ID URI for the web API).</span></span>
1. <span data-ttu-id="6f43b-416">The authorization code and information about the web application and web API are validated by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-416">The authorization code and information about the web application and web API are validated by Azure AD.</span></span> <span data-ttu-id="6f43b-417">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-417">Upon successful validation, Azure AD returns two tokens: a JWT access token and a JWT refresh token.</span></span>
1. <span data-ttu-id="6f43b-418">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-418">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="6f43b-419">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-419">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="6f43b-420">Code samples</span><span class="sxs-lookup"><span data-stu-id="6f43b-420">Code samples</span></span>

<span data-ttu-id="6f43b-421">See the code samples for Web Application to Web API scenarios.</span><span class="sxs-lookup"><span data-stu-id="6f43b-421">See the code samples for Web Application to Web API scenarios.</span></span> <span data-ttu-id="6f43b-422">And, check back frequently -- new samples are added frequently.</span><span class="sxs-lookup"><span data-stu-id="6f43b-422">And, check back frequently -- new samples are added frequently.</span></span> <span data-ttu-id="6f43b-423">Web [Application to Web API](sample-v1-code.md#web-applications-signing-in-users-calling-microsoft-graph-or-a-web-api-with-the-users-identity).</span><span class="sxs-lookup"><span data-stu-id="6f43b-423">Web [Application to Web API](sample-v1-code.md#web-applications-signing-in-users-calling-microsoft-graph-or-a-web-api-with-the-users-identity).</span></span>

#### <a name="registering"></a><span data-ttu-id="6f43b-424">Registering</span><span class="sxs-lookup"><span data-stu-id="6f43b-424">Registering</span></span>

* <span data-ttu-id="6f43b-425">Single Tenant: For both the application identity and delegated user identity cases, the web application and the web API must be registered in the same directory in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-425">Single Tenant: For both the application identity and delegated user identity cases, the web application and the web API must be registered in the same directory in Azure AD.</span></span> <span data-ttu-id="6f43b-426">The web API can be configured to expose a set of permissions, which are used to limit the web application’s access to its resources.</span><span class="sxs-lookup"><span data-stu-id="6f43b-426">The web API can be configured to expose a set of permissions, which are used to limit the web application’s access to its resources.</span></span> <span data-ttu-id="6f43b-427">If a delegated user identity type is being used, the web application needs to select the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="6f43b-427">If a delegated user identity type is being used, the web application needs to select the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure portal.</span></span> <span data-ttu-id="6f43b-428">This step is not required if the application identity type is being used.</span><span class="sxs-lookup"><span data-stu-id="6f43b-428">This step is not required if the application identity type is being used.</span></span>
* <span data-ttu-id="6f43b-429">Multi-Tenant: First, the web application is configured to indicate the permissions it requires to be functional.</span><span class="sxs-lookup"><span data-stu-id="6f43b-429">Multi-Tenant: First, the web application is configured to indicate the permissions it requires to be functional.</span></span> <span data-ttu-id="6f43b-430">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span><span class="sxs-lookup"><span data-stu-id="6f43b-430">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span></span> <span data-ttu-id="6f43b-431">Some applications only require user-level permissions, which any user in the organization can consent to.</span><span class="sxs-lookup"><span data-stu-id="6f43b-431">Some applications only require user-level permissions, which any user in the organization can consent to.</span></span> <span data-ttu-id="6f43b-432">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span><span class="sxs-lookup"><span data-stu-id="6f43b-432">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span></span> <span data-ttu-id="6f43b-433">Only a directory administrator can give consent to applications that require this level of permissions.</span><span class="sxs-lookup"><span data-stu-id="6f43b-433">Only a directory administrator can give consent to applications that require this level of permissions.</span></span> <span data-ttu-id="6f43b-434">When the user or administrator consents, the web application and the web API are both registered in their directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-434">When the user or administrator consents, the web application and the web API are both registered in their directory.</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6f43b-435">Token expiration</span><span class="sxs-lookup"><span data-stu-id="6f43b-435">Token expiration</span></span>

<span data-ttu-id="6f43b-436">When the web application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-436">When the web application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="6f43b-437">When the access token expires, the refresh token can be used to re-authenticate the user without requiring them to sign in again.</span><span class="sxs-lookup"><span data-stu-id="6f43b-437">When the access token expires, the refresh token can be used to re-authenticate the user without requiring them to sign in again.</span></span> <span data-ttu-id="6f43b-438">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-438">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span></span>

### <a name="daemon-or-server-application-to-web-api"></a><span data-ttu-id="6f43b-439">Daemon or server application to web API</span><span class="sxs-lookup"><span data-stu-id="6f43b-439">Daemon or server application to web API</span></span>

<span data-ttu-id="6f43b-440">This section describes a daemon or server application that needs to get resources from a web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-440">This section describes a daemon or server application that needs to get resources from a web API.</span></span> <span data-ttu-id="6f43b-441">There are two sub-scenarios that apply to this section: A daemon that needs to call a web API, built on OAuth 2.0 client credentials grant type; and a server application (such as a web API) that needs to call a web API, built on OAuth 2.0 On-Behalf-Of draft specification.</span><span class="sxs-lookup"><span data-stu-id="6f43b-441">There are two sub-scenarios that apply to this section: A daemon that needs to call a web API, built on OAuth 2.0 client credentials grant type; and a server application (such as a web API) that needs to call a web API, built on OAuth 2.0 On-Behalf-Of draft specification.</span></span>

<span data-ttu-id="6f43b-442">For the scenario when a daemon application needs to call a web API, it’s important to understand a few things.</span><span class="sxs-lookup"><span data-stu-id="6f43b-442">For the scenario when a daemon application needs to call a web API, it’s important to understand a few things.</span></span> <span data-ttu-id="6f43b-443">First, user interaction is not possible with a daemon application, which requires the application to have its own identity.</span><span class="sxs-lookup"><span data-stu-id="6f43b-443">First, user interaction is not possible with a daemon application, which requires the application to have its own identity.</span></span> <span data-ttu-id="6f43b-444">An example of a daemon application is a batch job, or an operating system service running in the background.</span><span class="sxs-lookup"><span data-stu-id="6f43b-444">An example of a daemon application is a batch job, or an operating system service running in the background.</span></span> <span data-ttu-id="6f43b-445">This type of application requests an access token by using its application identity and presenting its Application ID, credential (password or certificate), and application ID URI to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-445">This type of application requests an access token by using its application identity and presenting its Application ID, credential (password or certificate), and application ID URI to Azure AD.</span></span> <span data-ttu-id="6f43b-446">After successful authentication, the daemon receives an access token from Azure AD, which is then used to call the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-446">After successful authentication, the daemon receives an access token from Azure AD, which is then used to call the web API.</span></span>

<span data-ttu-id="6f43b-447">For the scenario when a server application needs to call a web API, it’s helpful to use an example.</span><span class="sxs-lookup"><span data-stu-id="6f43b-447">For the scenario when a server application needs to call a web API, it’s helpful to use an example.</span></span> <span data-ttu-id="6f43b-448">Imagine that a user has authenticated on a native application, and this native application needs to call a web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-448">Imagine that a user has authenticated on a native application, and this native application needs to call a web API.</span></span> <span data-ttu-id="6f43b-449">Azure AD issues a JWT access token to call the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-449">Azure AD issues a JWT access token to call the web API.</span></span> <span data-ttu-id="6f43b-450">If the web API needs to call another downstream web API, it can use the on-behalf-of flow to delegate the user’s identity and authenticate to the second-tier web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-450">If the web API needs to call another downstream web API, it can use the on-behalf-of flow to delegate the user’s identity and authenticate to the second-tier web API.</span></span>

#### <a name="diagram"></a><span data-ttu-id="6f43b-451">Diagram</span><span class="sxs-lookup"><span data-stu-id="6f43b-451">Diagram</span></span>

![Daemon or Server Application to Web API diagram](./media/authentication-scenarios/daemon_server_app_to_web_api.png)

#### <a name="description-of-protocol-flow"></a><span data-ttu-id="6f43b-453">Description of protocol flow</span><span class="sxs-lookup"><span data-stu-id="6f43b-453">Description of protocol flow</span></span>

##### <a name="application-identity-with-oauth-20-client-credentials-grant"></a><span data-ttu-id="6f43b-454">Application identity with OAuth 2.0 client credentials grant</span><span class="sxs-lookup"><span data-stu-id="6f43b-454">Application identity with OAuth 2.0 client credentials grant</span></span>

1. <span data-ttu-id="6f43b-455">First, the server application needs to authenticate with Azure AD as itself, without any human interaction such as an interactive sign-on dialog.</span><span class="sxs-lookup"><span data-stu-id="6f43b-455">First, the server application needs to authenticate with Azure AD as itself, without any human interaction such as an interactive sign-on dialog.</span></span> <span data-ttu-id="6f43b-456">It makes a request to Azure AD’s token endpoint, providing the credential, Application ID, and application ID URI.</span><span class="sxs-lookup"><span data-stu-id="6f43b-456">It makes a request to Azure AD’s token endpoint, providing the credential, Application ID, and application ID URI.</span></span>
1. <span data-ttu-id="6f43b-457">Azure AD authenticates the application and returns a JWT access token that is used to call the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-457">Azure AD authenticates the application and returns a JWT access token that is used to call the web API.</span></span>
1. <span data-ttu-id="6f43b-458">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-458">Over HTTPS, the web application uses the returned JWT access token to add the JWT string with a “Bearer” designation in the Authorization header of the request to the web API.</span></span> <span data-ttu-id="6f43b-459">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span><span class="sxs-lookup"><span data-stu-id="6f43b-459">The web API then validates the JWT token, and if validation is successful, returns the desired resource.</span></span>

##### <a name="delegated-user-identity-with-oauth-20-on-behalf-of-draft-specification"></a><span data-ttu-id="6f43b-460">Delegated user identity with OAuth 2.0 On-Behalf-Of Draft Specification</span><span class="sxs-lookup"><span data-stu-id="6f43b-460">Delegated user identity with OAuth 2.0 On-Behalf-Of Draft Specification</span></span>

<span data-ttu-id="6f43b-461">The flow discussed below assumes that a user has been authenticated on another application (such as a native application), and their user identity has been used to acquire an access token to the first-tier web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-461">The flow discussed below assumes that a user has been authenticated on another application (such as a native application), and their user identity has been used to acquire an access token to the first-tier web API.</span></span>

1. <span data-ttu-id="6f43b-462">The native application sends the access token to the first-tier web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-462">The native application sends the access token to the first-tier web API.</span></span>
1. <span data-ttu-id="6f43b-463">The first-tier web API sends a request to Azure AD’s token endpoint, providing its Application ID and credentials, as well as the user’s access token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-463">The first-tier web API sends a request to Azure AD’s token endpoint, providing its Application ID and credentials, as well as the user’s access token.</span></span> <span data-ttu-id="6f43b-464">In addition, the request is sent with an on_behalf_of parameter that indicates the web API is requesting new tokens to call a downstream web API on behalf of the original user.</span><span class="sxs-lookup"><span data-stu-id="6f43b-464">In addition, the request is sent with an on_behalf_of parameter that indicates the web API is requesting new tokens to call a downstream web API on behalf of the original user.</span></span>
1. <span data-ttu-id="6f43b-465">Azure AD verifies that the first-tier web API has permissions to access the second-tier web API and validates the request, returning a JWT access token and a JWT refresh token to the first-tier web API.</span><span class="sxs-lookup"><span data-stu-id="6f43b-465">Azure AD verifies that the first-tier web API has permissions to access the second-tier web API and validates the request, returning a JWT access token and a JWT refresh token to the first-tier web API.</span></span>
1. <span data-ttu-id="6f43b-466">Over HTTPS, the first-tier web API then calls the second-tier web API by appending the token string in the Authorization header in the request.</span><span class="sxs-lookup"><span data-stu-id="6f43b-466">Over HTTPS, the first-tier web API then calls the second-tier web API by appending the token string in the Authorization header in the request.</span></span> <span data-ttu-id="6f43b-467">The first-tier web API can continue to call the second-tier web API as long as the access token and refresh tokens are valid.</span><span class="sxs-lookup"><span data-stu-id="6f43b-467">The first-tier web API can continue to call the second-tier web API as long as the access token and refresh tokens are valid.</span></span>

#### <a name="code-samples"></a><span data-ttu-id="6f43b-468">Code samples</span><span class="sxs-lookup"><span data-stu-id="6f43b-468">Code samples</span></span>

<span data-ttu-id="6f43b-469">See the code samples for Daemon or Server Application to Web API scenarios.</span><span class="sxs-lookup"><span data-stu-id="6f43b-469">See the code samples for Daemon or Server Application to Web API scenarios.</span></span> <span data-ttu-id="6f43b-470">And, check back frequently -- new samples are added frequently.</span><span class="sxs-lookup"><span data-stu-id="6f43b-470">And, check back frequently -- new samples are added frequently.</span></span> [<span data-ttu-id="6f43b-471">Server or Daemon Application to Web API</span><span class="sxs-lookup"><span data-stu-id="6f43b-471">Server or Daemon Application to Web API</span></span>](sample-v1-code.md#daemon-applications-accessing-web-apis-with-the-applications-identity)

#### <a name="registering"></a><span data-ttu-id="6f43b-472">Registering</span><span class="sxs-lookup"><span data-stu-id="6f43b-472">Registering</span></span>

* <span data-ttu-id="6f43b-473">Single Tenant: For both the application identity and delegated user identity cases, the daemon or server application must be registered in the same directory in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="6f43b-473">Single Tenant: For both the application identity and delegated user identity cases, the daemon or server application must be registered in the same directory in Azure AD.</span></span> <span data-ttu-id="6f43b-474">The web API can be configured to expose a set of permissions, which are used to limit the daemon or server’s access to its resources.</span><span class="sxs-lookup"><span data-stu-id="6f43b-474">The web API can be configured to expose a set of permissions, which are used to limit the daemon or server’s access to its resources.</span></span> <span data-ttu-id="6f43b-475">If a delegated user identity type is being used, the server application needs to select the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="6f43b-475">If a delegated user identity type is being used, the server application needs to select the desired permissions from the “Permissions to Other Applications” drop-down menu in the Azure portal.</span></span> <span data-ttu-id="6f43b-476">This step is not required if the application identity type is being used.</span><span class="sxs-lookup"><span data-stu-id="6f43b-476">This step is not required if the application identity type is being used.</span></span>
* <span data-ttu-id="6f43b-477">Multi-Tenant: First, the daemon or server application is configured to indicate the permissions it requires to be functional.</span><span class="sxs-lookup"><span data-stu-id="6f43b-477">Multi-Tenant: First, the daemon or server application is configured to indicate the permissions it requires to be functional.</span></span> <span data-ttu-id="6f43b-478">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span><span class="sxs-lookup"><span data-stu-id="6f43b-478">This list of required permissions is shown in a dialog when a user or administrator in the destination directory gives consent to the application, which makes it available to their organization.</span></span> <span data-ttu-id="6f43b-479">Some applications only require user-level permissions, which any user in the organization can consent to.</span><span class="sxs-lookup"><span data-stu-id="6f43b-479">Some applications only require user-level permissions, which any user in the organization can consent to.</span></span> <span data-ttu-id="6f43b-480">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span><span class="sxs-lookup"><span data-stu-id="6f43b-480">Other applications require administrator-level permissions, which a user in the organization cannot consent to.</span></span> <span data-ttu-id="6f43b-481">Only a directory administrator can give consent to applications that require this level of permissions.</span><span class="sxs-lookup"><span data-stu-id="6f43b-481">Only a directory administrator can give consent to applications that require this level of permissions.</span></span> <span data-ttu-id="6f43b-482">When the user or administrator consents, both of the web APIs are registered in their directory.</span><span class="sxs-lookup"><span data-stu-id="6f43b-482">When the user or administrator consents, both of the web APIs are registered in their directory.</span></span>

#### <a name="token-expiration"></a><span data-ttu-id="6f43b-483">Token expiration</span><span class="sxs-lookup"><span data-stu-id="6f43b-483">Token expiration</span></span>

<span data-ttu-id="6f43b-484">When the first application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-484">When the first application uses its authorization code to get a JWT access token, it also receives a JWT refresh token.</span></span> <span data-ttu-id="6f43b-485">When the access token expires, the refresh token can be used to re-authenticate the user without prompting for credentials.</span><span class="sxs-lookup"><span data-stu-id="6f43b-485">When the access token expires, the refresh token can be used to re-authenticate the user without prompting for credentials.</span></span> <span data-ttu-id="6f43b-486">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span><span class="sxs-lookup"><span data-stu-id="6f43b-486">This refresh token is then used to authenticate the user, which results in a new access token and refresh token.</span></span>

## <a name="see-also"></a><span data-ttu-id="6f43b-487">See Also</span><span class="sxs-lookup"><span data-stu-id="6f43b-487">See Also</span></span>

[<span data-ttu-id="6f43b-488">Azure Active Directory Developer's Guide</span><span class="sxs-lookup"><span data-stu-id="6f43b-488">Azure Active Directory Developer's Guide</span></span>](azure-ad-developers-guide.md)

[<span data-ttu-id="6f43b-489">Azure Active Directory Code Samples</span><span class="sxs-lookup"><span data-stu-id="6f43b-489">Azure Active Directory Code Samples</span></span>](sample-v1-code.md)

[<span data-ttu-id="6f43b-490">Important Information About Signing Key Rollover in Azure AD</span><span class="sxs-lookup"><span data-stu-id="6f43b-490">Important Information About Signing Key Rollover in Azure AD</span></span>](active-directory-signing-key-rollover.md)

[<span data-ttu-id="6f43b-491">OAuth 2.0 in Azure AD</span><span class="sxs-lookup"><span data-stu-id="6f43b-491">OAuth 2.0 in Azure AD</span></span>](https://msdn.microsoft.com/library/azure/dn645545.aspx)
