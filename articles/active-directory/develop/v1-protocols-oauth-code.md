---
title: Understand the OAuth 2.0 authorization code flow in Azure AD
description: This article describes how to use HTTP messages to authorize access to web applications and web APIs in your tenant using Azure Active Directory and OAuth 2.0.
services: active-directory
documentationcenter: .net
author: CelesteDG
manager: mtillman
editor: ''
ms.service: active-directory
ms.component: develop
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/23/2018
ms.author: celested
ms.reviewer: hirsin
ms.custom: aaddev
ms.openlocfilehash: 6dc156e94ee8b30bef8c25b3dcaa1d70f76e26e5
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44866399"
---
# <a name="authorize-access-to-azure-active-directory-web-applications-using-the-oauth-20-code-grant-flow"></a><span data-ttu-id="45541-103">Authorize access to Azure Active Directory web applications using the OAuth 2.0 code grant flow</span><span class="sxs-lookup"><span data-stu-id="45541-103">Authorize access to Azure Active Directory web applications using the OAuth 2.0 code grant flow</span></span>
<span data-ttu-id="45541-104">Azure Active Directory (Azure AD) uses OAuth 2.0 to enable you to authorize access to web applications and web APIs in your Azure AD tenant.</span><span class="sxs-lookup"><span data-stu-id="45541-104">Azure Active Directory (Azure AD) uses OAuth 2.0 to enable you to authorize access to web applications and web APIs in your Azure AD tenant.</span></span> <span data-ttu-id="45541-105">This guide is language independent, and describes how to send and receive HTTP messages without using any of our [open-source libraries](active-directory-authentication-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="45541-105">This guide is language independent, and describes how to send and receive HTTP messages without using any of our [open-source libraries](active-directory-authentication-libraries.md).</span></span>

<span data-ttu-id="45541-106">The OAuth 2.0 authorization code flow is described in [section 4.1 of the OAuth 2.0 specification](https://tools.ietf.org/html/rfc6749#section-4.1).</span><span class="sxs-lookup"><span data-stu-id="45541-106">The OAuth 2.0 authorization code flow is described in [section 4.1 of the OAuth 2.0 specification](https://tools.ietf.org/html/rfc6749#section-4.1).</span></span> <span data-ttu-id="45541-107">It is used to perform authentication and authorization in most application types, including web apps and natively installed apps.</span><span class="sxs-lookup"><span data-stu-id="45541-107">It is used to perform authentication and authorization in most application types, including web apps and natively installed apps.</span></span>

[!INCLUDE [active-directory-protocols-getting-started](../../../includes/active-directory-protocols-getting-started.md)]

## <a name="oauth-20-authorization-flow"></a><span data-ttu-id="45541-108">OAuth 2.0 authorization flow</span><span class="sxs-lookup"><span data-stu-id="45541-108">OAuth 2.0 authorization flow</span></span>
<span data-ttu-id="45541-109">At a high level, the entire authorization flow for an application looks a bit like this:</span><span class="sxs-lookup"><span data-stu-id="45541-109">At a high level, the entire authorization flow for an application looks a bit like this:</span></span>

![OAuth Auth Code Flow](./media/v1-protocols-oauth-code/active-directory-oauth-code-flow-native-app.png)

## <a name="request-an-authorization-code"></a><span data-ttu-id="45541-111">Request an authorization code</span><span class="sxs-lookup"><span data-stu-id="45541-111">Request an authorization code</span></span>
<span data-ttu-id="45541-112">The authorization code flow begins with the client directing the user to the `/authorize` endpoint.</span><span class="sxs-lookup"><span data-stu-id="45541-112">The authorization code flow begins with the client directing the user to the `/authorize` endpoint.</span></span> <span data-ttu-id="45541-113">In this request, the client indicates the permissions it needs to acquire from the user.</span><span class="sxs-lookup"><span data-stu-id="45541-113">In this request, the client indicates the permissions it needs to acquire from the user.</span></span> <span data-ttu-id="45541-114">You can get the OAuth 2.0 authorization endpoint for your tenant by selecting **App registrations > Endpoints** in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="45541-114">You can get the OAuth 2.0 authorization endpoint for your tenant by selecting **App registrations > Endpoints** in the Azure portal.</span></span>

```
// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=code
&redirect_uri=http%3A%2F%2Flocalhost%3A12345
&response_mode=query
&resource=https%3A%2F%2Fservice.contoso.com%2F
&state=12345
```

| <span data-ttu-id="45541-115">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-115">Parameter</span></span> |  | <span data-ttu-id="45541-116">Description</span><span class="sxs-lookup"><span data-stu-id="45541-116">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="45541-117">tenant</span><span class="sxs-lookup"><span data-stu-id="45541-117">tenant</span></span> |<span data-ttu-id="45541-118">required</span><span class="sxs-lookup"><span data-stu-id="45541-118">required</span></span> |<span data-ttu-id="45541-119">The `{tenant}` value in the path of the request can be used to control who can sign into the application.</span><span class="sxs-lookup"><span data-stu-id="45541-119">The `{tenant}` value in the path of the request can be used to control who can sign into the application.</span></span> <span data-ttu-id="45541-120">The allowed values are tenant identifiers, for example, `8eaef023-2b34-4da1-9baa-8bc8c9d6a490` or `contoso.onmicrosoft.com` or `common` for tenant-independent tokens</span><span class="sxs-lookup"><span data-stu-id="45541-120">The allowed values are tenant identifiers, for example, `8eaef023-2b34-4da1-9baa-8bc8c9d6a490` or `contoso.onmicrosoft.com` or `common` for tenant-independent tokens</span></span> |
| <span data-ttu-id="45541-121">client_id</span><span class="sxs-lookup"><span data-stu-id="45541-121">client_id</span></span> |<span data-ttu-id="45541-122">required</span><span class="sxs-lookup"><span data-stu-id="45541-122">required</span></span> |<span data-ttu-id="45541-123">The Application ID assigned to your app when you registered it with Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-123">The Application ID assigned to your app when you registered it with Azure AD.</span></span> <span data-ttu-id="45541-124">You can find this in the Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="45541-124">You can find this in the Azure Portal.</span></span> <span data-ttu-id="45541-125">Click **Azure Active Directory** in the services sidebar, click **App registrations**, and choose the application.</span><span class="sxs-lookup"><span data-stu-id="45541-125">Click **Azure Active Directory** in the services sidebar, click **App registrations**, and choose the application.</span></span> |
| <span data-ttu-id="45541-126">response_type</span><span class="sxs-lookup"><span data-stu-id="45541-126">response_type</span></span> |<span data-ttu-id="45541-127">required</span><span class="sxs-lookup"><span data-stu-id="45541-127">required</span></span> |<span data-ttu-id="45541-128">Must include `code` for the authorization code flow.</span><span class="sxs-lookup"><span data-stu-id="45541-128">Must include `code` for the authorization code flow.</span></span> |
| <span data-ttu-id="45541-129">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="45541-129">redirect_uri</span></span> |<span data-ttu-id="45541-130">recommended</span><span class="sxs-lookup"><span data-stu-id="45541-130">recommended</span></span> |<span data-ttu-id="45541-131">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span><span class="sxs-lookup"><span data-stu-id="45541-131">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span></span> <span data-ttu-id="45541-132">It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded.</span><span class="sxs-lookup"><span data-stu-id="45541-132">It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded.</span></span> <span data-ttu-id="45541-133">For native & mobile apps, you should use the default value of `urn:ietf:wg:oauth:2.0:oob`.</span><span class="sxs-lookup"><span data-stu-id="45541-133">For native & mobile apps, you should use the default value of `urn:ietf:wg:oauth:2.0:oob`.</span></span> |
| <span data-ttu-id="45541-134">response_mode</span><span class="sxs-lookup"><span data-stu-id="45541-134">response_mode</span></span> |<span data-ttu-id="45541-135">recommended</span><span class="sxs-lookup"><span data-stu-id="45541-135">recommended</span></span> |<span data-ttu-id="45541-136">Specifies the method that should be used to send the resulting token back to your app.</span><span class="sxs-lookup"><span data-stu-id="45541-136">Specifies the method that should be used to send the resulting token back to your app.</span></span> <span data-ttu-id="45541-137">Can be `query`, `fragment`, or `form_post`.</span><span class="sxs-lookup"><span data-stu-id="45541-137">Can be `query`, `fragment`, or `form_post`.</span></span> <span data-ttu-id="45541-138">`query` provides the code as a query string parameter on your redirect URI.</span><span class="sxs-lookup"><span data-stu-id="45541-138">`query` provides the code as a query string parameter on your redirect URI.</span></span> <span data-ttu-id="45541-139">If you're requesting an ID token using the implicit flow, you cannot use `query` as specified in the [OpenID spec](https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html#Combinations). If you're requesting just the code, you can use `query`, `fragment`, or `form_post`.</span><span class="sxs-lookup"><span data-stu-id="45541-139">If you're requesting an ID token using the implicit flow, you cannot use `query` as specified in the [OpenID spec](https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html#Combinations). If you're requesting just the code, you can use `query`, `fragment`, or `form_post`.</span></span> <span data-ttu-id="45541-140">`form_post` executes a POST containing the code to your redirect URI.</span><span class="sxs-lookup"><span data-stu-id="45541-140">`form_post` executes a POST containing the code to your redirect URI.</span></span> |
| <span data-ttu-id="45541-141">state</span><span class="sxs-lookup"><span data-stu-id="45541-141">state</span></span> |<span data-ttu-id="45541-142">recommended</span><span class="sxs-lookup"><span data-stu-id="45541-142">recommended</span></span> |<span data-ttu-id="45541-143">A value included in the request that is also returned in the token response.</span><span class="sxs-lookup"><span data-stu-id="45541-143">A value included in the request that is also returned in the token response.</span></span> <span data-ttu-id="45541-144">A randomly generated unique value is typically used for [preventing cross-site request forgery attacks](http://tools.ietf.org/html/rfc6749#section-10.12).</span><span class="sxs-lookup"><span data-stu-id="45541-144">A randomly generated unique value is typically used for [preventing cross-site request forgery attacks](http://tools.ietf.org/html/rfc6749#section-10.12).</span></span> <span data-ttu-id="45541-145">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span><span class="sxs-lookup"><span data-stu-id="45541-145">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |
| <span data-ttu-id="45541-146">resource</span><span class="sxs-lookup"><span data-stu-id="45541-146">resource</span></span> | <span data-ttu-id="45541-147">recommended</span><span class="sxs-lookup"><span data-stu-id="45541-147">recommended</span></span> |<span data-ttu-id="45541-148">The App ID URI of the target web API (secured resource).</span><span class="sxs-lookup"><span data-stu-id="45541-148">The App ID URI of the target web API (secured resource).</span></span> <span data-ttu-id="45541-149">To find the App ID URI, in the Azure Portal, click **Azure Active Directory**, click **Application registrations**, open the application's **Settings** page, then click **Properties**.</span><span class="sxs-lookup"><span data-stu-id="45541-149">To find the App ID URI, in the Azure Portal, click **Azure Active Directory**, click **Application registrations**, open the application's **Settings** page, then click **Properties**.</span></span> <span data-ttu-id="45541-150">It may also be an external resource like `https://graph.microsoft.com`.</span><span class="sxs-lookup"><span data-stu-id="45541-150">It may also be an external resource like `https://graph.microsoft.com`.</span></span> <span data-ttu-id="45541-151">This is required in one of either the authorization or token requests.</span><span class="sxs-lookup"><span data-stu-id="45541-151">This is required in one of either the authorization or token requests.</span></span> <span data-ttu-id="45541-152">To ensure fewer authentication prompts place it in the authorization request to ensure consent is received from the user.</span><span class="sxs-lookup"><span data-stu-id="45541-152">To ensure fewer authentication prompts place it in the authorization request to ensure consent is received from the user.</span></span> |
| <span data-ttu-id="45541-153">scope</span><span class="sxs-lookup"><span data-stu-id="45541-153">scope</span></span> | <span data-ttu-id="45541-154">**ignored**</span><span class="sxs-lookup"><span data-stu-id="45541-154">**ignored**</span></span> | <span data-ttu-id="45541-155">For v1 Azure AD apps, scopes must be statically configured in the Azure Portal under the applications **Settings**, **Required Permissions**.</span><span class="sxs-lookup"><span data-stu-id="45541-155">For v1 Azure AD apps, scopes must be statically configured in the Azure Portal under the applications **Settings**, **Required Permissions**.</span></span> |
| <span data-ttu-id="45541-156">prompt</span><span class="sxs-lookup"><span data-stu-id="45541-156">prompt</span></span> |<span data-ttu-id="45541-157">optional</span><span class="sxs-lookup"><span data-stu-id="45541-157">optional</span></span> |<span data-ttu-id="45541-158">Indicate the type of user interaction that is required.</span><span class="sxs-lookup"><span data-stu-id="45541-158">Indicate the type of user interaction that is required.</span></span><p> <span data-ttu-id="45541-159">Valid values are:</span><span class="sxs-lookup"><span data-stu-id="45541-159">Valid values are:</span></span> <p> <span data-ttu-id="45541-160">*login*: The user should be prompted to reauthenticate.</span><span class="sxs-lookup"><span data-stu-id="45541-160">*login*: The user should be prompted to reauthenticate.</span></span> <p> <span data-ttu-id="45541-161">*select_account*: The user is prompted to select an account, interrupting single sign on.</span><span class="sxs-lookup"><span data-stu-id="45541-161">*select_account*: The user is prompted to select an account, interrupting single sign on.</span></span> <span data-ttu-id="45541-162">The user may select an existing signed-in account, enter their credentials for a remembered account, or choose to use a different account altogether.</span><span class="sxs-lookup"><span data-stu-id="45541-162">The user may select an existing signed-in account, enter their credentials for a remembered account, or choose to use a different account altogether.</span></span> <p> <span data-ttu-id="45541-163">*consent*: User consent has been granted, but needs to be updated.</span><span class="sxs-lookup"><span data-stu-id="45541-163">*consent*: User consent has been granted, but needs to be updated.</span></span> <span data-ttu-id="45541-164">The user should be prompted to consent.</span><span class="sxs-lookup"><span data-stu-id="45541-164">The user should be prompted to consent.</span></span> <p> <span data-ttu-id="45541-165">*admin_consent*: An administrator should be prompted to consent on behalf of all users in their organization</span><span class="sxs-lookup"><span data-stu-id="45541-165">*admin_consent*: An administrator should be prompted to consent on behalf of all users in their organization</span></span> |
| <span data-ttu-id="45541-166">login_hint</span><span class="sxs-lookup"><span data-stu-id="45541-166">login_hint</span></span> |<span data-ttu-id="45541-167">optional</span><span class="sxs-lookup"><span data-stu-id="45541-167">optional</span></span> |<span data-ttu-id="45541-168">Can be used to pre-fill the username/email address field of the sign-in page for the user, if you know their username ahead of time.</span><span class="sxs-lookup"><span data-stu-id="45541-168">Can be used to pre-fill the username/email address field of the sign-in page for the user, if you know their username ahead of time.</span></span> <span data-ttu-id="45541-169">Often apps use this parameter during reauthentication, having already extracted the username from a previous sign-in using the `preferred_username` claim.</span><span class="sxs-lookup"><span data-stu-id="45541-169">Often apps use this parameter during reauthentication, having already extracted the username from a previous sign-in using the `preferred_username` claim.</span></span> |
| <span data-ttu-id="45541-170">domain_hint</span><span class="sxs-lookup"><span data-stu-id="45541-170">domain_hint</span></span> |<span data-ttu-id="45541-171">optional</span><span class="sxs-lookup"><span data-stu-id="45541-171">optional</span></span> |<span data-ttu-id="45541-172">Provides a hint about the tenant or domain that the user should use to sign in.</span><span class="sxs-lookup"><span data-stu-id="45541-172">Provides a hint about the tenant or domain that the user should use to sign in.</span></span> <span data-ttu-id="45541-173">The value of the domain_hint is a registered domain for the tenant.</span><span class="sxs-lookup"><span data-stu-id="45541-173">The value of the domain_hint is a registered domain for the tenant.</span></span> <span data-ttu-id="45541-174">If the tenant is federated to an on-premises directory, AAD redirects to the specified tenant federation server.</span><span class="sxs-lookup"><span data-stu-id="45541-174">If the tenant is federated to an on-premises directory, AAD redirects to the specified tenant federation server.</span></span> |
| <span data-ttu-id="45541-175">code_challenge_method</span><span class="sxs-lookup"><span data-stu-id="45541-175">code_challenge_method</span></span> | <span data-ttu-id="45541-176">optional</span><span class="sxs-lookup"><span data-stu-id="45541-176">optional</span></span>    | <span data-ttu-id="45541-177">The method used to encode the `code_verifier` for the `code_challenge` parameter.</span><span class="sxs-lookup"><span data-stu-id="45541-177">The method used to encode the `code_verifier` for the `code_challenge` parameter.</span></span> <span data-ttu-id="45541-178">Can be one of `plain` or `S256`.</span><span class="sxs-lookup"><span data-stu-id="45541-178">Can be one of `plain` or `S256`.</span></span> <span data-ttu-id="45541-179">If excluded, `code_challenge` is assumed to be plaintext if `code_challenge` is included.</span><span class="sxs-lookup"><span data-stu-id="45541-179">If excluded, `code_challenge` is assumed to be plaintext if `code_challenge` is included.</span></span> <span data-ttu-id="45541-180">Azure AAD v1.0 supports both `plain` and `S256`.</span><span class="sxs-lookup"><span data-stu-id="45541-180">Azure AAD v1.0 supports both `plain` and `S256`.</span></span> <span data-ttu-id="45541-181">For more information, see the [PKCE RFC](https://tools.ietf.org/html/rfc7636).</span><span class="sxs-lookup"><span data-stu-id="45541-181">For more information, see the [PKCE RFC](https://tools.ietf.org/html/rfc7636).</span></span> |
| <span data-ttu-id="45541-182">code_challenge</span><span class="sxs-lookup"><span data-stu-id="45541-182">code_challenge</span></span>        | <span data-ttu-id="45541-183">optional</span><span class="sxs-lookup"><span data-stu-id="45541-183">optional</span></span>    | <span data-ttu-id="45541-184">Used to secure authorization code grants via Proof Key for Code Exchange (PKCE) from a native or public client.</span><span class="sxs-lookup"><span data-stu-id="45541-184">Used to secure authorization code grants via Proof Key for Code Exchange (PKCE) from a native or public client.</span></span> <span data-ttu-id="45541-185">Required if `code_challenge_method` is included.</span><span class="sxs-lookup"><span data-stu-id="45541-185">Required if `code_challenge_method` is included.</span></span> <span data-ttu-id="45541-186">For more information, see the [PKCE RFC](https://tools.ietf.org/html/rfc7636).</span><span class="sxs-lookup"><span data-stu-id="45541-186">For more information, see the [PKCE RFC](https://tools.ietf.org/html/rfc7636).</span></span> |

> [!NOTE]
> <span data-ttu-id="45541-187">If the user is part of an organization, an administrator of the organization can consent or decline on the user's behalf, or permit the user to consent.</span><span class="sxs-lookup"><span data-stu-id="45541-187">If the user is part of an organization, an administrator of the organization can consent or decline on the user's behalf, or permit the user to consent.</span></span> <span data-ttu-id="45541-188">The user is given the option to consent only when the administrator permits it.</span><span class="sxs-lookup"><span data-stu-id="45541-188">The user is given the option to consent only when the administrator permits it.</span></span>
>
>

<span data-ttu-id="45541-189">At this point, the user is asked to enter their credentials and consent to the permissions requested by the app in the Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="45541-189">At this point, the user is asked to enter their credentials and consent to the permissions requested by the app in the Azure Portal.</span></span> <span data-ttu-id="45541-190">Once the user authenticates and grants consent, Azure AD sends a response to your app at the `redirect_uri` address in your request with the code.</span><span class="sxs-lookup"><span data-stu-id="45541-190">Once the user authenticates and grants consent, Azure AD sends a response to your app at the `redirect_uri` address in your request with the code.</span></span>

### <a name="successful-response"></a><span data-ttu-id="45541-191">Successful response</span><span class="sxs-lookup"><span data-stu-id="45541-191">Successful response</span></span>
<span data-ttu-id="45541-192">A successful response could look like this:</span><span class="sxs-lookup"><span data-stu-id="45541-192">A successful response could look like this:</span></span>

```
GET  HTTP/1.1 302 Found
Location: http://localhost:12345/?code= AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrqqf_ZT_p5uEAEJJ_nZ3UmphWygRNy2C3jJ239gV_DBnZ2syeg95Ki-374WHUP-i3yIhv5i-7KU2CEoPXwURQp6IVYMw-DjAOzn7C3JCu5wpngXmbZKtJdWmiBzHpcO2aICJPu1KvJrDLDP20chJBXzVYJtkfjviLNNW7l7Y3ydcHDsBRKZc3GuMQanmcghXPyoDg41g8XbwPudVh7uCmUponBQpIhbuffFP_tbV8SNzsPoFz9CLpBCZagJVXeqWoYMPe2dSsPiLO9Alf_YIe5zpi-zY4C3aLw5g9at35eZTfNd0gBRpR5ojkMIcZZ6IgAA&session_state=7B29111D-C220-4263-99AB-6F6E135D75EF&state=D79E5777-702E-4260-9A62-37F75FF22CCE
```

| <span data-ttu-id="45541-193">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-193">Parameter</span></span> | <span data-ttu-id="45541-194">Description</span><span class="sxs-lookup"><span data-stu-id="45541-194">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-195">admin_consent</span><span class="sxs-lookup"><span data-stu-id="45541-195">admin_consent</span></span> |<span data-ttu-id="45541-196">The value is True if an administrator consented to a consent request prompt.</span><span class="sxs-lookup"><span data-stu-id="45541-196">The value is True if an administrator consented to a consent request prompt.</span></span> |
| <span data-ttu-id="45541-197">code</span><span class="sxs-lookup"><span data-stu-id="45541-197">code</span></span> |<span data-ttu-id="45541-198">The authorization code that the application requested.</span><span class="sxs-lookup"><span data-stu-id="45541-198">The authorization code that the application requested.</span></span> <span data-ttu-id="45541-199">The application can use the authorization code to request an access token for the target resource.</span><span class="sxs-lookup"><span data-stu-id="45541-199">The application can use the authorization code to request an access token for the target resource.</span></span> |
| <span data-ttu-id="45541-200">session_state</span><span class="sxs-lookup"><span data-stu-id="45541-200">session_state</span></span> |<span data-ttu-id="45541-201">A unique value that identifies the current user session.</span><span class="sxs-lookup"><span data-stu-id="45541-201">A unique value that identifies the current user session.</span></span> <span data-ttu-id="45541-202">This value is a GUID, but should be treated as an opaque value that is passed without examination.</span><span class="sxs-lookup"><span data-stu-id="45541-202">This value is a GUID, but should be treated as an opaque value that is passed without examination.</span></span> |
| <span data-ttu-id="45541-203">state</span><span class="sxs-lookup"><span data-stu-id="45541-203">state</span></span> |<span data-ttu-id="45541-204">If a state parameter is included in the request, the same value should appear in the response.</span><span class="sxs-lookup"><span data-stu-id="45541-204">If a state parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="45541-205">It's a good practice for the application to verify that the state values in the request and response are identical before using the response.</span><span class="sxs-lookup"><span data-stu-id="45541-205">It's a good practice for the application to verify that the state values in the request and response are identical before using the response.</span></span> <span data-ttu-id="45541-206">This helps to detect [Cross-Site Request Forgery (CSRF) attacks](https://tools.ietf.org/html/rfc6749#section-10.12) against the client.</span><span class="sxs-lookup"><span data-stu-id="45541-206">This helps to detect [Cross-Site Request Forgery (CSRF) attacks](https://tools.ietf.org/html/rfc6749#section-10.12) against the client.</span></span> |

### <a name="error-response"></a><span data-ttu-id="45541-207">Error response</span><span class="sxs-lookup"><span data-stu-id="45541-207">Error response</span></span>
<span data-ttu-id="45541-208">Error responses may also be sent to the `redirect_uri` so that the application can handle them appropriately.</span><span class="sxs-lookup"><span data-stu-id="45541-208">Error responses may also be sent to the `redirect_uri` so that the application can handle them appropriately.</span></span>

```
GET http://localhost:12345/?
error=access_denied
&error_description=the+user+canceled+the+authentication
```

| <span data-ttu-id="45541-209">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-209">Parameter</span></span> | <span data-ttu-id="45541-210">Description</span><span class="sxs-lookup"><span data-stu-id="45541-210">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-211">error</span><span class="sxs-lookup"><span data-stu-id="45541-211">error</span></span> |<span data-ttu-id="45541-212">An error code value defined in Section 5.2 of the [OAuth 2.0 Authorization Framework](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="45541-212">An error code value defined in Section 5.2 of the [OAuth 2.0 Authorization Framework](http://tools.ietf.org/html/rfc6749).</span></span> <span data-ttu-id="45541-213">The next table describes the error codes that Azure AD returns.</span><span class="sxs-lookup"><span data-stu-id="45541-213">The next table describes the error codes that Azure AD returns.</span></span> |
| <span data-ttu-id="45541-214">error_description</span><span class="sxs-lookup"><span data-stu-id="45541-214">error_description</span></span> |<span data-ttu-id="45541-215">A more detailed description of the error.</span><span class="sxs-lookup"><span data-stu-id="45541-215">A more detailed description of the error.</span></span> <span data-ttu-id="45541-216">This message is not intended to be end-user friendly.</span><span class="sxs-lookup"><span data-stu-id="45541-216">This message is not intended to be end-user friendly.</span></span> |
| <span data-ttu-id="45541-217">state</span><span class="sxs-lookup"><span data-stu-id="45541-217">state</span></span> |<span data-ttu-id="45541-218">The state value is a randomly generated non-reused value that is sent in the request and returned in the response to prevent cross-site request forgery (CSRF) attacks.</span><span class="sxs-lookup"><span data-stu-id="45541-218">The state value is a randomly generated non-reused value that is sent in the request and returned in the response to prevent cross-site request forgery (CSRF) attacks.</span></span> |

#### <a name="error-codes-for-authorization-endpoint-errors"></a><span data-ttu-id="45541-219">Error codes for authorization endpoint errors</span><span class="sxs-lookup"><span data-stu-id="45541-219">Error codes for authorization endpoint errors</span></span>
<span data-ttu-id="45541-220">The following table describes the various error codes that can be returned in the `error` parameter of the error response.</span><span class="sxs-lookup"><span data-stu-id="45541-220">The following table describes the various error codes that can be returned in the `error` parameter of the error response.</span></span>

| <span data-ttu-id="45541-221">Error Code</span><span class="sxs-lookup"><span data-stu-id="45541-221">Error Code</span></span> | <span data-ttu-id="45541-222">Description</span><span class="sxs-lookup"><span data-stu-id="45541-222">Description</span></span> | <span data-ttu-id="45541-223">Client Action</span><span class="sxs-lookup"><span data-stu-id="45541-223">Client Action</span></span> |
| --- | --- | --- |
| <span data-ttu-id="45541-224">invalid_request</span><span class="sxs-lookup"><span data-stu-id="45541-224">invalid_request</span></span> |<span data-ttu-id="45541-225">Protocol error, such as a missing required parameter.</span><span class="sxs-lookup"><span data-stu-id="45541-225">Protocol error, such as a missing required parameter.</span></span> |<span data-ttu-id="45541-226">Fix and resubmit the request.</span><span class="sxs-lookup"><span data-stu-id="45541-226">Fix and resubmit the request.</span></span> <span data-ttu-id="45541-227">This is a development error, and is typically caught during initial testing.</span><span class="sxs-lookup"><span data-stu-id="45541-227">This is a development error, and is typically caught during initial testing.</span></span> |
| <span data-ttu-id="45541-228">unauthorized_client</span><span class="sxs-lookup"><span data-stu-id="45541-228">unauthorized_client</span></span> |<span data-ttu-id="45541-229">The client application is not permitted to request an authorization code.</span><span class="sxs-lookup"><span data-stu-id="45541-229">The client application is not permitted to request an authorization code.</span></span> |<span data-ttu-id="45541-230">This usually occurs when the client application is not registered in Azure AD or is not added to the user's Azure AD tenant.</span><span class="sxs-lookup"><span data-stu-id="45541-230">This usually occurs when the client application is not registered in Azure AD or is not added to the user's Azure AD tenant.</span></span> <span data-ttu-id="45541-231">The application can prompt the user with instruction for installing the application and adding it to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-231">The application can prompt the user with instruction for installing the application and adding it to Azure AD.</span></span> |
| <span data-ttu-id="45541-232">access_denied</span><span class="sxs-lookup"><span data-stu-id="45541-232">access_denied</span></span> |<span data-ttu-id="45541-233">Resource owner denied consent</span><span class="sxs-lookup"><span data-stu-id="45541-233">Resource owner denied consent</span></span> |<span data-ttu-id="45541-234">The client application can notify the user that it cannot proceed unless the user consents.</span><span class="sxs-lookup"><span data-stu-id="45541-234">The client application can notify the user that it cannot proceed unless the user consents.</span></span> |
| <span data-ttu-id="45541-235">unsupported_response_type</span><span class="sxs-lookup"><span data-stu-id="45541-235">unsupported_response_type</span></span> |<span data-ttu-id="45541-236">The authorization server does not support the response type in the request.</span><span class="sxs-lookup"><span data-stu-id="45541-236">The authorization server does not support the response type in the request.</span></span> |<span data-ttu-id="45541-237">Fix and resubmit the request.</span><span class="sxs-lookup"><span data-stu-id="45541-237">Fix and resubmit the request.</span></span> <span data-ttu-id="45541-238">This is a development error, and is typically caught during initial testing.</span><span class="sxs-lookup"><span data-stu-id="45541-238">This is a development error, and is typically caught during initial testing.</span></span> |
| <span data-ttu-id="45541-239">server_error</span><span class="sxs-lookup"><span data-stu-id="45541-239">server_error</span></span> |<span data-ttu-id="45541-240">The server encountered an unexpected error.</span><span class="sxs-lookup"><span data-stu-id="45541-240">The server encountered an unexpected error.</span></span> |<span data-ttu-id="45541-241">Retry the request.</span><span class="sxs-lookup"><span data-stu-id="45541-241">Retry the request.</span></span> <span data-ttu-id="45541-242">These errors can result from temporary conditions.</span><span class="sxs-lookup"><span data-stu-id="45541-242">These errors can result from temporary conditions.</span></span> <span data-ttu-id="45541-243">The client application might explain to the user that its response is delayed due to a temporary error.</span><span class="sxs-lookup"><span data-stu-id="45541-243">The client application might explain to the user that its response is delayed due to a temporary error.</span></span> |
| <span data-ttu-id="45541-244">temporarily_unavailable</span><span class="sxs-lookup"><span data-stu-id="45541-244">temporarily_unavailable</span></span> |<span data-ttu-id="45541-245">The server is temporarily too busy to handle the request.</span><span class="sxs-lookup"><span data-stu-id="45541-245">The server is temporarily too busy to handle the request.</span></span> |<span data-ttu-id="45541-246">Retry the request.</span><span class="sxs-lookup"><span data-stu-id="45541-246">Retry the request.</span></span> <span data-ttu-id="45541-247">The client application might explain to the user that its response is delayed due to a temporary condition.</span><span class="sxs-lookup"><span data-stu-id="45541-247">The client application might explain to the user that its response is delayed due to a temporary condition.</span></span> |
| <span data-ttu-id="45541-248">invalid_resource</span><span class="sxs-lookup"><span data-stu-id="45541-248">invalid_resource</span></span> |<span data-ttu-id="45541-249">The target resource is invalid because it does not exist, Azure AD cannot find it, or it is not correctly configured.</span><span class="sxs-lookup"><span data-stu-id="45541-249">The target resource is invalid because it does not exist, Azure AD cannot find it, or it is not correctly configured.</span></span> |<span data-ttu-id="45541-250">This indicates the resource, if it exists, has not been configured in the tenant.</span><span class="sxs-lookup"><span data-stu-id="45541-250">This indicates the resource, if it exists, has not been configured in the tenant.</span></span> <span data-ttu-id="45541-251">The application can prompt the user with instruction for installing the application and adding it to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-251">The application can prompt the user with instruction for installing the application and adding it to Azure AD.</span></span> |

## <a name="use-the-authorization-code-to-request-an-access-token"></a><span data-ttu-id="45541-252">Use the authorization code to request an access token</span><span class="sxs-lookup"><span data-stu-id="45541-252">Use the authorization code to request an access token</span></span>
<span data-ttu-id="45541-253">Now that you've acquired an authorization code and have been granted permission by the user, you can redeem the code for an access token to the desired resource, by sending a POST request to the `/token` endpoint:</span><span class="sxs-lookup"><span data-stu-id="45541-253">Now that you've acquired an authorization code and have been granted permission by the user, you can redeem the code for an access token to the desired resource, by sending a POST request to the `/token` endpoint:</span></span>

```
// Line breaks for legibility only

POST /{tenant}/oauth2/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded
grant_type=authorization_code
&client_id=2d4d11a2-f814-46a7-890a-274a72a7309e
&code=AwABAAAAvPM1KaPlrEqdFSBzjqfTGBCmLdgfSTLEMPGYuNHSUYBrqqf_ZT_p5uEAEJJ_nZ3UmphWygRNy2C3jJ239gV_DBnZ2syeg95Ki-374WHUP-i3yIhv5i-7KU2CEoPXwURQp6IVYMw-DjAOzn7C3JCu5wpngXmbZKtJdWmiBzHpcO2aICJPu1KvJrDLDP20chJBXzVYJtkfjviLNNW7l7Y3ydcHDsBRKZc3GuMQanmcghXPyoDg41g8XbwPudVh7uCmUponBQpIhbuffFP_tbV8SNzsPoFz9CLpBCZagJVXeqWoYMPe2dSsPiLO9Alf_YIe5zpi-zY4C3aLw5g9at35eZTfNd0gBRpR5ojkMIcZZ6IgAA
&redirect_uri=https%3A%2F%2Flocalhost%3A12345
&resource=https%3A%2F%2Fservice.contoso.com%2F
&client_secret=p@ssw0rd

//NOTE: client_secret only required for web apps
```

| <span data-ttu-id="45541-254">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-254">Parameter</span></span> |  | <span data-ttu-id="45541-255">Description</span><span class="sxs-lookup"><span data-stu-id="45541-255">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="45541-256">tenant</span><span class="sxs-lookup"><span data-stu-id="45541-256">tenant</span></span> |<span data-ttu-id="45541-257">required</span><span class="sxs-lookup"><span data-stu-id="45541-257">required</span></span> |<span data-ttu-id="45541-258">The `{tenant}` value in the path of the request can be used to control who can sign into the application.</span><span class="sxs-lookup"><span data-stu-id="45541-258">The `{tenant}` value in the path of the request can be used to control who can sign into the application.</span></span> <span data-ttu-id="45541-259">The allowed values are tenant identifiers, for example, `8eaef023-2b34-4da1-9baa-8bc8c9d6a490` or `contoso.onmicrosoft.com` or `common` for tenant-independent tokens</span><span class="sxs-lookup"><span data-stu-id="45541-259">The allowed values are tenant identifiers, for example, `8eaef023-2b34-4da1-9baa-8bc8c9d6a490` or `contoso.onmicrosoft.com` or `common` for tenant-independent tokens</span></span> |
| <span data-ttu-id="45541-260">client_id</span><span class="sxs-lookup"><span data-stu-id="45541-260">client_id</span></span> |<span data-ttu-id="45541-261">required</span><span class="sxs-lookup"><span data-stu-id="45541-261">required</span></span> |<span data-ttu-id="45541-262">The Application Id assigned to your app when you registered it with Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-262">The Application Id assigned to your app when you registered it with Azure AD.</span></span> <span data-ttu-id="45541-263">You can find this in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="45541-263">You can find this in the Azure portal.</span></span> <span data-ttu-id="45541-264">The Application Id is displayed in the settings of the app registration.</span><span class="sxs-lookup"><span data-stu-id="45541-264">The Application Id is displayed in the settings of the app registration.</span></span> |
| <span data-ttu-id="45541-265">grant_type</span><span class="sxs-lookup"><span data-stu-id="45541-265">grant_type</span></span> |<span data-ttu-id="45541-266">required</span><span class="sxs-lookup"><span data-stu-id="45541-266">required</span></span> |<span data-ttu-id="45541-267">Must be `authorization_code` for the authorization code flow.</span><span class="sxs-lookup"><span data-stu-id="45541-267">Must be `authorization_code` for the authorization code flow.</span></span> |
| <span data-ttu-id="45541-268">code</span><span class="sxs-lookup"><span data-stu-id="45541-268">code</span></span> |<span data-ttu-id="45541-269">required</span><span class="sxs-lookup"><span data-stu-id="45541-269">required</span></span> |<span data-ttu-id="45541-270">The `authorization_code` that you acquired in the previous section</span><span class="sxs-lookup"><span data-stu-id="45541-270">The `authorization_code` that you acquired in the previous section</span></span> |
| <span data-ttu-id="45541-271">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="45541-271">redirect_uri</span></span> |<span data-ttu-id="45541-272">required</span><span class="sxs-lookup"><span data-stu-id="45541-272">required</span></span> |<span data-ttu-id="45541-273">The same `redirect_uri` value that was used to acquire the `authorization_code`.</span><span class="sxs-lookup"><span data-stu-id="45541-273">The same `redirect_uri` value that was used to acquire the `authorization_code`.</span></span> |
| <span data-ttu-id="45541-274">client_secret</span><span class="sxs-lookup"><span data-stu-id="45541-274">client_secret</span></span> |<span data-ttu-id="45541-275">required for web apps, not allowed for public clients</span><span class="sxs-lookup"><span data-stu-id="45541-275">required for web apps, not allowed for public clients</span></span> |<span data-ttu-id="45541-276">The application secret that you created in the Azure Portal for your app under **Keys**.</span><span class="sxs-lookup"><span data-stu-id="45541-276">The application secret that you created in the Azure Portal for your app under **Keys**.</span></span> <span data-ttu-id="45541-277">It cannot be used in a native app (public client), because client_secrets cannot be reliably stored on devices.</span><span class="sxs-lookup"><span data-stu-id="45541-277">It cannot be used in a native app (public client), because client_secrets cannot be reliably stored on devices.</span></span> <span data-ttu-id="45541-278">It is required for web apps and web APIs (all confidential clients), which have the ability to store the `client_secret` securely on the server side.</span><span class="sxs-lookup"><span data-stu-id="45541-278">It is required for web apps and web APIs (all confidential clients), which have the ability to store the `client_secret` securely on the server side.</span></span> <span data-ttu-id="45541-279">The client_secret should be URL-encoded before being sent.</span><span class="sxs-lookup"><span data-stu-id="45541-279">The client_secret should be URL-encoded before being sent.</span></span> |
| <span data-ttu-id="45541-280">resource</span><span class="sxs-lookup"><span data-stu-id="45541-280">resource</span></span> | <span data-ttu-id="45541-281">recommended</span><span class="sxs-lookup"><span data-stu-id="45541-281">recommended</span></span> |<span data-ttu-id="45541-282">The App ID URI of the target web API (secured resource).</span><span class="sxs-lookup"><span data-stu-id="45541-282">The App ID URI of the target web API (secured resource).</span></span> <span data-ttu-id="45541-283">To find the App ID URI, in the Azure Portal, click **Azure Active Directory**, click **Application registrations**, open the application's **Settings** page, then click **Properties**.</span><span class="sxs-lookup"><span data-stu-id="45541-283">To find the App ID URI, in the Azure Portal, click **Azure Active Directory**, click **Application registrations**, open the application's **Settings** page, then click **Properties**.</span></span> <span data-ttu-id="45541-284">It may also be an external resource like `https://graph.microsoft.com`.</span><span class="sxs-lookup"><span data-stu-id="45541-284">It may also be an external resource like `https://graph.microsoft.com`.</span></span> <span data-ttu-id="45541-285">This is required in one of either the authorization or token requests.</span><span class="sxs-lookup"><span data-stu-id="45541-285">This is required in one of either the authorization or token requests.</span></span> <span data-ttu-id="45541-286">To ensure fewer authentication prompts place it in the authorization request to ensure consent is received from the user.</span><span class="sxs-lookup"><span data-stu-id="45541-286">To ensure fewer authentication prompts place it in the authorization request to ensure consent is received from the user.</span></span> <span data-ttu-id="45541-287">If in both the authorization request and the token request, the     resource\` parameters must match.</span><span class="sxs-lookup"><span data-stu-id="45541-287">If in both the authorization request and the token request, the     resource\` parameters must match.</span></span> | 
| <span data-ttu-id="45541-288">code_verifier</span><span class="sxs-lookup"><span data-stu-id="45541-288">code_verifier</span></span> | <span data-ttu-id="45541-289">optional</span><span class="sxs-lookup"><span data-stu-id="45541-289">optional</span></span> | <span data-ttu-id="45541-290">The same code_verifier that was used to obtain the authorization_code.</span><span class="sxs-lookup"><span data-stu-id="45541-290">The same code_verifier that was used to obtain the authorization_code.</span></span> <span data-ttu-id="45541-291">Required if PKCE was used in the authorization code grant request.</span><span class="sxs-lookup"><span data-stu-id="45541-291">Required if PKCE was used in the authorization code grant request.</span></span> <span data-ttu-id="45541-292">For more information, see the [PKCE RFC](https://tools.ietf.org/html/rfc7636)</span><span class="sxs-lookup"><span data-stu-id="45541-292">For more information, see the [PKCE RFC](https://tools.ietf.org/html/rfc7636)</span></span>   |

<span data-ttu-id="45541-293">To find the App ID URI, in the Azure Portal, click **Azure Active Directory**, click **Application registrations**, open the application's **Settings** page, then click **Properties**.</span><span class="sxs-lookup"><span data-stu-id="45541-293">To find the App ID URI, in the Azure Portal, click **Azure Active Directory**, click **Application registrations**, open the application's **Settings** page, then click **Properties**.</span></span>

### <a name="successful-response"></a><span data-ttu-id="45541-294">Successful response</span><span class="sxs-lookup"><span data-stu-id="45541-294">Successful response</span></span>
<span data-ttu-id="45541-295">Azure AD returns an access token upon a successful response.</span><span class="sxs-lookup"><span data-stu-id="45541-295">Azure AD returns an access token upon a successful response.</span></span> <span data-ttu-id="45541-296">To minimize network calls from the client application and their associated latency, the client application should cache access tokens for the token lifetime that is specified in the OAuth 2.0 response.</span><span class="sxs-lookup"><span data-stu-id="45541-296">To minimize network calls from the client application and their associated latency, the client application should cache access tokens for the token lifetime that is specified in the OAuth 2.0 response.</span></span> <span data-ttu-id="45541-297">To determine the token lifetime, use either the `expires_in` or `expires_on` parameter values.</span><span class="sxs-lookup"><span data-stu-id="45541-297">To determine the token lifetime, use either the `expires_in` or `expires_on` parameter values.</span></span>

<span data-ttu-id="45541-298">If a web API resource returns an `invalid_token` error code, this might indicate that the resource has determined that the token is expired.</span><span class="sxs-lookup"><span data-stu-id="45541-298">If a web API resource returns an `invalid_token` error code, this might indicate that the resource has determined that the token is expired.</span></span> <span data-ttu-id="45541-299">If the client and resource clock times are different (known as a "time skew"), the resource might consider the token to be expired before the token is cleared from the client cache.</span><span class="sxs-lookup"><span data-stu-id="45541-299">If the client and resource clock times are different (known as a "time skew"), the resource might consider the token to be expired before the token is cleared from the client cache.</span></span> <span data-ttu-id="45541-300">If this occurs, clear the token from the cache, even if it is still within its calculated lifetime.</span><span class="sxs-lookup"><span data-stu-id="45541-300">If this occurs, clear the token from the cache, even if it is still within its calculated lifetime.</span></span>

<span data-ttu-id="45541-301">A successful response could look like this:</span><span class="sxs-lookup"><span data-stu-id="45541-301">A successful response could look like this:</span></span>

```
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1THdqcHdBSk9NOW4tQSJ9.eyJhdWQiOiJodHRwczovL3NlcnZpY2UuY29udG9zby5jb20vIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvN2ZlODE0NDctZGE1Ny00Mzg1LWJlY2ItNmRlNTdmMjE0NzdlLyIsImlhdCI6MTM4ODQ0MDg2MywibmJmIjoxMzg4NDQwODYzLCJleHAiOjEzODg0NDQ3NjMsInZlciI6IjEuMCIsInRpZCI6IjdmZTgxNDQ3LWRhNTctNDM4NS1iZWNiLTZkZTU3ZjIxNDc3ZSIsIm9pZCI6IjY4Mzg5YWUyLTYyZmEtNGIxOC05MWZlLTUzZGQxMDlkNzRmNSIsInVwbiI6ImZyYW5rbUBjb250b3NvLmNvbSIsInVuaXF1ZV9uYW1lIjoiZnJhbmttQGNvbnRvc28uY29tIiwic3ViIjoiZGVOcUlqOUlPRTlQV0pXYkhzZnRYdDJFYWJQVmwwQ2o4UUFtZWZSTFY5OCIsImZhbWlseV9uYW1lIjoiTWlsbGVyIiwiZ2l2ZW5fbmFtZSI6IkZyYW5rIiwiYXBwaWQiOiIyZDRkMTFhMi1mODE0LTQ2YTctODkwYS0yNzRhNzJhNzMwOWUiLCJhcHBpZGFjciI6IjAiLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJhY3IiOiIxIn0.JZw8jC0gptZxVC-7l5sFkdnJgP3_tRjeQEPgUn28XctVe3QqmheLZw7QVZDPCyGycDWBaqy7FLpSekET_BftDkewRhyHk9FW_KeEz0ch2c3i08NGNDbr6XYGVayNuSesYk5Aw_p3ICRlUV1bqEwk-Jkzs9EEkQg4hbefqJS6yS1HoV_2EsEhpd_wCQpxK89WPs3hLYZETRJtG5kvCCEOvSHXmDE6eTHGTnEgsIk--UlPe275Dvou4gEAwLofhLDQbMSjnlV5VLsjimNBVcSRFShoxmQwBJR_b2011Y5IuD6St5zPnzruBbZYkGNurQK63TJPWmRd3mbJsGM0mf3CUQ",
  "token_type": "Bearer",
  "expires_in": "3600",
  "expires_on": "1388444763",
  "resource": "https://service.contoso.com/",
  "refresh_token": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4rTfgV29ghDOHRc2B-C_hHeJaJICqjZ3mY2b_YNqmf9SoAylD1PycGCB90xzZeEDg6oBzOIPfYsbDWNf621pKo2Q3GGTHYlmNfwoc-OlrxK69hkha2CF12azM_NYhgO668yfcUl4VBbiSHZyd1NVZG5QTIOcbObu3qnLutbpadZGAxqjIbMkQ2bQS09fTrjMBtDE3D6kSMIodpCecoANon9b0LATkpitimVCrl-NyfN3oyG4ZCWu18M9-vEou4Sq-1oMDzExgAf61noxzkNiaTecM-Ve5cq6wHqYQjfV9DOz4lbceuYCAA",
  "scope": "https%3A%2F%2Fgraph.microsoft.com%2Fmail.read",
  "id_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJub25lIn0.eyJhdWQiOiIyZDRkMTFhMi1mODE0LTQ2YTctODkwYS0yNzRhNzJhNzMwOWUiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC83ZmU4MTQ0Ny1kYTU3LTQzODUtYmVjYi02ZGU1N2YyMTQ3N2UvIiwiaWF0IjoxMzg4NDQwODYzLCJuYmYiOjEzODg0NDA4NjMsImV4cCI6MTM4ODQ0NDc2MywidmVyIjoiMS4wIiwidGlkIjoiN2ZlODE0NDctZGE1Ny00Mzg1LWJlY2ItNmRlNTdmMjE0NzdlIiwib2lkIjoiNjgzODlhZTItNjJmYS00YjE4LTkxZmUtNTNkZDEwOWQ3NGY1IiwidXBuIjoiZnJhbmttQGNvbnRvc28uY29tIiwidW5pcXVlX25hbWUiOiJmcmFua21AY29udG9zby5jb20iLCJzdWIiOiJKV3ZZZENXUGhobHBTMVpzZjd5WVV4U2hVd3RVbTV5elBtd18talgzZkhZIiwiZmFtaWx5X25hbWUiOiJNaWxsZXIiLCJnaXZlbl9uYW1lIjoiRnJhbmsifQ."
}

```

| <span data-ttu-id="45541-302">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-302">Parameter</span></span> | <span data-ttu-id="45541-303">Description</span><span class="sxs-lookup"><span data-stu-id="45541-303">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-304">access_token</span><span class="sxs-lookup"><span data-stu-id="45541-304">access_token</span></span> |<span data-ttu-id="45541-305">The requested access token as a signed JSON Web Token (JWT).</span><span class="sxs-lookup"><span data-stu-id="45541-305">The requested access token as a signed JSON Web Token (JWT).</span></span> <span data-ttu-id="45541-306">The app can use this token to authenticate to the secured resource, such as a web API.</span><span class="sxs-lookup"><span data-stu-id="45541-306">The app can use this token to authenticate to the secured resource, such as a web API.</span></span> |
| <span data-ttu-id="45541-307">token_type</span><span class="sxs-lookup"><span data-stu-id="45541-307">token_type</span></span> |<span data-ttu-id="45541-308">Indicates the token type value.</span><span class="sxs-lookup"><span data-stu-id="45541-308">Indicates the token type value.</span></span> <span data-ttu-id="45541-309">The only type that Azure AD supports is Bearer.</span><span class="sxs-lookup"><span data-stu-id="45541-309">The only type that Azure AD supports is Bearer.</span></span> <span data-ttu-id="45541-310">For more information about Bearer tokens, see [OAuth2.0 Authorization Framework: Bearer Token Usage (RFC 6750)](http://www.rfc-editor.org/rfc/rfc6750.txt)</span><span class="sxs-lookup"><span data-stu-id="45541-310">For more information about Bearer tokens, see [OAuth2.0 Authorization Framework: Bearer Token Usage (RFC 6750)](http://www.rfc-editor.org/rfc/rfc6750.txt)</span></span> |
| <span data-ttu-id="45541-311">expires_in</span><span class="sxs-lookup"><span data-stu-id="45541-311">expires_in</span></span> |<span data-ttu-id="45541-312">How long the access token is valid (in seconds).</span><span class="sxs-lookup"><span data-stu-id="45541-312">How long the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="45541-313">expires_on</span><span class="sxs-lookup"><span data-stu-id="45541-313">expires_on</span></span> |<span data-ttu-id="45541-314">The time when the access token expires.</span><span class="sxs-lookup"><span data-stu-id="45541-314">The time when the access token expires.</span></span> <span data-ttu-id="45541-315">The date is represented as the number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.</span><span class="sxs-lookup"><span data-stu-id="45541-315">The date is represented as the number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.</span></span> <span data-ttu-id="45541-316">This value is used to determine the lifetime of cached tokens.</span><span class="sxs-lookup"><span data-stu-id="45541-316">This value is used to determine the lifetime of cached tokens.</span></span> |
| <span data-ttu-id="45541-317">resource</span><span class="sxs-lookup"><span data-stu-id="45541-317">resource</span></span> |<span data-ttu-id="45541-318">The App ID URI of the web API (secured resource).</span><span class="sxs-lookup"><span data-stu-id="45541-318">The App ID URI of the web API (secured resource).</span></span> |
| <span data-ttu-id="45541-319">scope</span><span class="sxs-lookup"><span data-stu-id="45541-319">scope</span></span> |<span data-ttu-id="45541-320">Impersonation permissions granted to the client application.</span><span class="sxs-lookup"><span data-stu-id="45541-320">Impersonation permissions granted to the client application.</span></span> <span data-ttu-id="45541-321">The default permission is `user_impersonation`.</span><span class="sxs-lookup"><span data-stu-id="45541-321">The default permission is `user_impersonation`.</span></span> <span data-ttu-id="45541-322">The owner of the secured resource can register additional values in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-322">The owner of the secured resource can register additional values in Azure AD.</span></span> |
| <span data-ttu-id="45541-323">refresh_token</span><span class="sxs-lookup"><span data-stu-id="45541-323">refresh_token</span></span> |<span data-ttu-id="45541-324">An OAuth 2.0 refresh token.</span><span class="sxs-lookup"><span data-stu-id="45541-324">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="45541-325">The app can use this token to acquire additional access tokens after the current access token expires.</span><span class="sxs-lookup"><span data-stu-id="45541-325">The app can use this token to acquire additional access tokens after the current access token expires.</span></span> <span data-ttu-id="45541-326">Refresh tokens are long-lived, and can be used to retain access to resources for extended periods of time.</span><span class="sxs-lookup"><span data-stu-id="45541-326">Refresh tokens are long-lived, and can be used to retain access to resources for extended periods of time.</span></span> |
| <span data-ttu-id="45541-327">id_token</span><span class="sxs-lookup"><span data-stu-id="45541-327">id_token</span></span> |<span data-ttu-id="45541-328">An unsigned JSON Web Token (JWT).</span><span class="sxs-lookup"><span data-stu-id="45541-328">An unsigned JSON Web Token (JWT).</span></span> <span data-ttu-id="45541-329">The app can base64Url decode the segments of this token to request information about the user who signed in.</span><span class="sxs-lookup"><span data-stu-id="45541-329">The app can base64Url decode the segments of this token to request information about the user who signed in.</span></span> <span data-ttu-id="45541-330">The app can cache the values and display them, but it should not rely on them for any authorization or security boundaries.</span><span class="sxs-lookup"><span data-stu-id="45541-330">The app can cache the values and display them, but it should not rely on them for any authorization or security boundaries.</span></span> |

### <a name="jwt-token-claims"></a><span data-ttu-id="45541-331">JWT Token Claims</span><span class="sxs-lookup"><span data-stu-id="45541-331">JWT Token Claims</span></span>
<span data-ttu-id="45541-332">The JWT token in the value of the `id_token` parameter can be decoded into the following claims:</span><span class="sxs-lookup"><span data-stu-id="45541-332">The JWT token in the value of the `id_token` parameter can be decoded into the following claims:</span></span>

```
{
 "typ": "JWT",
 "alg": "none"
}.
{
 "aud": "2d4d11a2-f814-46a7-890a-274a72a7309e",
 "iss": "https://sts.windows.net/7fe81447-da57-4385-becb-6de57f21477e/",
 "iat": 1388440863,
 "nbf": 1388440863,
 "exp": 1388444763,
 "ver": "1.0",
 "tid": "7fe81447-da57-4385-becb-6de57f21477e",
 "oid": "68389ae2-62fa-4b18-91fe-53dd109d74f5",
 "upn": "frank@contoso.com",
 "unique_name": "frank@contoso.com",
 "sub": "JWvYdCWPhhlpS1Zsf7yYUxShUwtUm5yzPmw_-jX3fHY",
 "family_name": "Miller",
 "given_name": "Frank"
}.
```

<span data-ttu-id="45541-333">For more information about JSON web tokens, see the [JWT IETF draft specification](http://go.microsoft.com/fwlink/?LinkId=392344).</span><span class="sxs-lookup"><span data-stu-id="45541-333">For more information about JSON web tokens, see the [JWT IETF draft specification](http://go.microsoft.com/fwlink/?LinkId=392344).</span></span> <span data-ttu-id="45541-334">For more information about the token types and claims, read [Supported Token and Claim Types](v1-id-and-access-tokens.md)</span><span class="sxs-lookup"><span data-stu-id="45541-334">For more information about the token types and claims, read [Supported Token and Claim Types](v1-id-and-access-tokens.md)</span></span>

<span data-ttu-id="45541-335">The `id_token` parameter includes the following claim types:</span><span class="sxs-lookup"><span data-stu-id="45541-335">The `id_token` parameter includes the following claim types:</span></span>

| <span data-ttu-id="45541-336">Claim type</span><span class="sxs-lookup"><span data-stu-id="45541-336">Claim type</span></span> | <span data-ttu-id="45541-337">Description</span><span class="sxs-lookup"><span data-stu-id="45541-337">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-338">aud</span><span class="sxs-lookup"><span data-stu-id="45541-338">aud</span></span> |<span data-ttu-id="45541-339">Audience of the token.</span><span class="sxs-lookup"><span data-stu-id="45541-339">Audience of the token.</span></span> <span data-ttu-id="45541-340">When the token is issued to a client application, the audience is the `client_id` of the client.</span><span class="sxs-lookup"><span data-stu-id="45541-340">When the token is issued to a client application, the audience is the `client_id` of the client.</span></span> |
| <span data-ttu-id="45541-341">exp</span><span class="sxs-lookup"><span data-stu-id="45541-341">exp</span></span> |<span data-ttu-id="45541-342">Expiration time.</span><span class="sxs-lookup"><span data-stu-id="45541-342">Expiration time.</span></span> <span data-ttu-id="45541-343">The time when the token expires.</span><span class="sxs-lookup"><span data-stu-id="45541-343">The time when the token expires.</span></span> <span data-ttu-id="45541-344">For the token to be valid, the current date/time must be less than or equal to the `exp` value.</span><span class="sxs-lookup"><span data-stu-id="45541-344">For the token to be valid, the current date/time must be less than or equal to the `exp` value.</span></span> <span data-ttu-id="45541-345">The time is represented as the number of seconds from January 1, 1970 (1970-01-01T0:0:0Z) UTC until the time the token validity expires.</span><span class="sxs-lookup"><span data-stu-id="45541-345">The time is represented as the number of seconds from January 1, 1970 (1970-01-01T0:0:0Z) UTC until the time the token validity expires.</span></span>|
| <span data-ttu-id="45541-346">family_name</span><span class="sxs-lookup"><span data-stu-id="45541-346">family_name</span></span> |<span data-ttu-id="45541-347">Users last name or surname.</span><span class="sxs-lookup"><span data-stu-id="45541-347">Users last name or surname.</span></span> <span data-ttu-id="45541-348">The application can display this value.</span><span class="sxs-lookup"><span data-stu-id="45541-348">The application can display this value.</span></span> |
| <span data-ttu-id="45541-349">given_name</span><span class="sxs-lookup"><span data-stu-id="45541-349">given_name</span></span> |<span data-ttu-id="45541-350">Users first name.</span><span class="sxs-lookup"><span data-stu-id="45541-350">Users first name.</span></span> <span data-ttu-id="45541-351">The application can display this value.</span><span class="sxs-lookup"><span data-stu-id="45541-351">The application can display this value.</span></span> |
| <span data-ttu-id="45541-352">iat</span><span class="sxs-lookup"><span data-stu-id="45541-352">iat</span></span> |<span data-ttu-id="45541-353">Issued at time.</span><span class="sxs-lookup"><span data-stu-id="45541-353">Issued at time.</span></span> <span data-ttu-id="45541-354">The time when the JWT was issued.</span><span class="sxs-lookup"><span data-stu-id="45541-354">The time when the JWT was issued.</span></span> <span data-ttu-id="45541-355">The time is represented as the number of seconds from January 1, 1970 (1970-01-01T0:0:0Z) UTC until the time the token was issued.</span><span class="sxs-lookup"><span data-stu-id="45541-355">The time is represented as the number of seconds from January 1, 1970 (1970-01-01T0:0:0Z) UTC until the time the token was issued.</span></span> |
| <span data-ttu-id="45541-356">iss</span><span class="sxs-lookup"><span data-stu-id="45541-356">iss</span></span> |<span data-ttu-id="45541-357">Identifies the token issuer</span><span class="sxs-lookup"><span data-stu-id="45541-357">Identifies the token issuer</span></span> |
| <span data-ttu-id="45541-358">nbf</span><span class="sxs-lookup"><span data-stu-id="45541-358">nbf</span></span> |<span data-ttu-id="45541-359">Not before time.</span><span class="sxs-lookup"><span data-stu-id="45541-359">Not before time.</span></span> <span data-ttu-id="45541-360">The time when the token becomes effective.</span><span class="sxs-lookup"><span data-stu-id="45541-360">The time when the token becomes effective.</span></span> <span data-ttu-id="45541-361">For the token to be valid, the current date/time must be greater than or equal to the Nbf value.</span><span class="sxs-lookup"><span data-stu-id="45541-361">For the token to be valid, the current date/time must be greater than or equal to the Nbf value.</span></span> <span data-ttu-id="45541-362">The time is represented as the number of seconds from January 1, 1970 (1970-01-01T0:0:0Z) UTC until the time the token was issued.</span><span class="sxs-lookup"><span data-stu-id="45541-362">The time is represented as the number of seconds from January 1, 1970 (1970-01-01T0:0:0Z) UTC until the time the token was issued.</span></span> |
| <span data-ttu-id="45541-363">oid</span><span class="sxs-lookup"><span data-stu-id="45541-363">oid</span></span> |<span data-ttu-id="45541-364">Object identifier (ID) of the user object in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-364">Object identifier (ID) of the user object in Azure AD.</span></span> |
| <span data-ttu-id="45541-365">sub</span><span class="sxs-lookup"><span data-stu-id="45541-365">sub</span></span> |<span data-ttu-id="45541-366">Token subject identifier.</span><span class="sxs-lookup"><span data-stu-id="45541-366">Token subject identifier.</span></span> <span data-ttu-id="45541-367">This is a persistent and immutable identifier for the user that the token describes.</span><span class="sxs-lookup"><span data-stu-id="45541-367">This is a persistent and immutable identifier for the user that the token describes.</span></span> <span data-ttu-id="45541-368">Use this value in caching logic.</span><span class="sxs-lookup"><span data-stu-id="45541-368">Use this value in caching logic.</span></span> |
| <span data-ttu-id="45541-369">tid</span><span class="sxs-lookup"><span data-stu-id="45541-369">tid</span></span> |<span data-ttu-id="45541-370">Tenant identifier (ID) of the Azure AD tenant that issued the token.</span><span class="sxs-lookup"><span data-stu-id="45541-370">Tenant identifier (ID) of the Azure AD tenant that issued the token.</span></span> |
| <span data-ttu-id="45541-371">unique_name</span><span class="sxs-lookup"><span data-stu-id="45541-371">unique_name</span></span> |<span data-ttu-id="45541-372">A unique identifier for that can be displayed to the user.</span><span class="sxs-lookup"><span data-stu-id="45541-372">A unique identifier for that can be displayed to the user.</span></span> <span data-ttu-id="45541-373">This is usually a user principal name (UPN).</span><span class="sxs-lookup"><span data-stu-id="45541-373">This is usually a user principal name (UPN).</span></span> |
| <span data-ttu-id="45541-374">upn</span><span class="sxs-lookup"><span data-stu-id="45541-374">upn</span></span> |<span data-ttu-id="45541-375">User principal name of the user.</span><span class="sxs-lookup"><span data-stu-id="45541-375">User principal name of the user.</span></span> |
| <span data-ttu-id="45541-376">ver</span><span class="sxs-lookup"><span data-stu-id="45541-376">ver</span></span> |<span data-ttu-id="45541-377">Version.</span><span class="sxs-lookup"><span data-stu-id="45541-377">Version.</span></span> <span data-ttu-id="45541-378">The version of the JWT token, typically 1.0.</span><span class="sxs-lookup"><span data-stu-id="45541-378">The version of the JWT token, typically 1.0.</span></span> |

### <a name="error-response"></a><span data-ttu-id="45541-379">Error response</span><span class="sxs-lookup"><span data-stu-id="45541-379">Error response</span></span>
<span data-ttu-id="45541-380">The token issuance endpoint errors are HTTP error codes, because the client calls the token issuance endpoint directly.</span><span class="sxs-lookup"><span data-stu-id="45541-380">The token issuance endpoint errors are HTTP error codes, because the client calls the token issuance endpoint directly.</span></span> <span data-ttu-id="45541-381">In addition to the HTTP status code, the Azure AD token issuance endpoint also returns a JSON document with objects that describe the error.</span><span class="sxs-lookup"><span data-stu-id="45541-381">In addition to the HTTP status code, the Azure AD token issuance endpoint also returns a JSON document with objects that describe the error.</span></span>

<span data-ttu-id="45541-382">A sample error response could look like this:</span><span class="sxs-lookup"><span data-stu-id="45541-382">A sample error response could look like this:</span></span>

```
{
  "error": "invalid_grant",
  "error_description": "AADSTS70002: Error validating credentials. AADSTS70008: The provided authorization code or refresh token is expired. Send a new interactive authorization request for this user and resource.\r\nTrace ID: 3939d04c-d7ba-42bf-9cb7-1e5854cdce9e\r\nCorrelation ID: a8125194-2dc8-4078-90ba-7b6592a7f231\r\nTimestamp: 2016-04-11 18:00:12Z",
  "error_codes": [
    70002,
    70008
  ],
  "timestamp": "2016-04-11 18:00:12Z",
  "trace_id": "3939d04c-d7ba-42bf-9cb7-1e5854cdce9e",
  "correlation_id": "a8125194-2dc8-4078-90ba-7b6592a7f231"
}
```
| <span data-ttu-id="45541-383">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-383">Parameter</span></span> | <span data-ttu-id="45541-384">Description</span><span class="sxs-lookup"><span data-stu-id="45541-384">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-385">error</span><span class="sxs-lookup"><span data-stu-id="45541-385">error</span></span> |<span data-ttu-id="45541-386">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span><span class="sxs-lookup"><span data-stu-id="45541-386">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span></span> |
| <span data-ttu-id="45541-387">error_description</span><span class="sxs-lookup"><span data-stu-id="45541-387">error_description</span></span> |<span data-ttu-id="45541-388">A specific error message that can help a developer identify the root cause of an authentication error.</span><span class="sxs-lookup"><span data-stu-id="45541-388">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |
| <span data-ttu-id="45541-389">error_codes</span><span class="sxs-lookup"><span data-stu-id="45541-389">error_codes</span></span> |<span data-ttu-id="45541-390">A list of STS-specific error codes that can help in diagnostics.</span><span class="sxs-lookup"><span data-stu-id="45541-390">A list of STS-specific error codes that can help in diagnostics.</span></span> |
| <span data-ttu-id="45541-391">timestamp</span><span class="sxs-lookup"><span data-stu-id="45541-391">timestamp</span></span> |<span data-ttu-id="45541-392">The time at which the error occurred.</span><span class="sxs-lookup"><span data-stu-id="45541-392">The time at which the error occurred.</span></span> |
| <span data-ttu-id="45541-393">trace_id</span><span class="sxs-lookup"><span data-stu-id="45541-393">trace_id</span></span> |<span data-ttu-id="45541-394">A unique identifier for the request that can help in diagnostics.</span><span class="sxs-lookup"><span data-stu-id="45541-394">A unique identifier for the request that can help in diagnostics.</span></span> |
| <span data-ttu-id="45541-395">correlation_id</span><span class="sxs-lookup"><span data-stu-id="45541-395">correlation_id</span></span> |<span data-ttu-id="45541-396">A unique identifier for the request that can help in diagnostics across components.</span><span class="sxs-lookup"><span data-stu-id="45541-396">A unique identifier for the request that can help in diagnostics across components.</span></span> |

#### <a name="http-status-codes"></a><span data-ttu-id="45541-397">HTTP status codes</span><span class="sxs-lookup"><span data-stu-id="45541-397">HTTP status codes</span></span>
<span data-ttu-id="45541-398">The following table lists the HTTP status codes that the token issuance endpoint returns.</span><span class="sxs-lookup"><span data-stu-id="45541-398">The following table lists the HTTP status codes that the token issuance endpoint returns.</span></span> <span data-ttu-id="45541-399">In some cases, the error code is sufficient to describe the response, but if there are errors, you need to parse the accompanying JSON document and examine its error code.</span><span class="sxs-lookup"><span data-stu-id="45541-399">In some cases, the error code is sufficient to describe the response, but if there are errors, you need to parse the accompanying JSON document and examine its error code.</span></span>

| <span data-ttu-id="45541-400">HTTP Code</span><span class="sxs-lookup"><span data-stu-id="45541-400">HTTP Code</span></span> | <span data-ttu-id="45541-401">Description</span><span class="sxs-lookup"><span data-stu-id="45541-401">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-402">400</span><span class="sxs-lookup"><span data-stu-id="45541-402">400</span></span> |<span data-ttu-id="45541-403">Default HTTP code.</span><span class="sxs-lookup"><span data-stu-id="45541-403">Default HTTP code.</span></span> <span data-ttu-id="45541-404">Used in most cases and is typically due to a malformed request.</span><span class="sxs-lookup"><span data-stu-id="45541-404">Used in most cases and is typically due to a malformed request.</span></span> <span data-ttu-id="45541-405">Fix and resubmit the request.</span><span class="sxs-lookup"><span data-stu-id="45541-405">Fix and resubmit the request.</span></span> |
| <span data-ttu-id="45541-406">401</span><span class="sxs-lookup"><span data-stu-id="45541-406">401</span></span> |<span data-ttu-id="45541-407">Authentication failed.</span><span class="sxs-lookup"><span data-stu-id="45541-407">Authentication failed.</span></span> <span data-ttu-id="45541-408">For example, the request is missing the client_secret parameter.</span><span class="sxs-lookup"><span data-stu-id="45541-408">For example, the request is missing the client_secret parameter.</span></span> |
| <span data-ttu-id="45541-409">403</span><span class="sxs-lookup"><span data-stu-id="45541-409">403</span></span> |<span data-ttu-id="45541-410">Authorization failed.</span><span class="sxs-lookup"><span data-stu-id="45541-410">Authorization failed.</span></span> <span data-ttu-id="45541-411">For example, the user does not have permission to access the resource.</span><span class="sxs-lookup"><span data-stu-id="45541-411">For example, the user does not have permission to access the resource.</span></span> |
| <span data-ttu-id="45541-412">500</span><span class="sxs-lookup"><span data-stu-id="45541-412">500</span></span> |<span data-ttu-id="45541-413">An internal error has occurred at the service.</span><span class="sxs-lookup"><span data-stu-id="45541-413">An internal error has occurred at the service.</span></span> <span data-ttu-id="45541-414">Retry the request.</span><span class="sxs-lookup"><span data-stu-id="45541-414">Retry the request.</span></span> |

#### <a name="error-codes-for-token-endpoint-errors"></a><span data-ttu-id="45541-415">Error codes for token endpoint errors</span><span class="sxs-lookup"><span data-stu-id="45541-415">Error codes for token endpoint errors</span></span>
| <span data-ttu-id="45541-416">Error Code</span><span class="sxs-lookup"><span data-stu-id="45541-416">Error Code</span></span> | <span data-ttu-id="45541-417">Description</span><span class="sxs-lookup"><span data-stu-id="45541-417">Description</span></span> | <span data-ttu-id="45541-418">Client Action</span><span class="sxs-lookup"><span data-stu-id="45541-418">Client Action</span></span> |
| --- | --- | --- |
| <span data-ttu-id="45541-419">invalid_request</span><span class="sxs-lookup"><span data-stu-id="45541-419">invalid_request</span></span> |<span data-ttu-id="45541-420">Protocol error, such as a missing required parameter.</span><span class="sxs-lookup"><span data-stu-id="45541-420">Protocol error, such as a missing required parameter.</span></span> |<span data-ttu-id="45541-421">Fix and resubmit the request</span><span class="sxs-lookup"><span data-stu-id="45541-421">Fix and resubmit the request</span></span> |
| <span data-ttu-id="45541-422">invalid_grant</span><span class="sxs-lookup"><span data-stu-id="45541-422">invalid_grant</span></span> |<span data-ttu-id="45541-423">The authorization code is invalid or has expired.</span><span class="sxs-lookup"><span data-stu-id="45541-423">The authorization code is invalid or has expired.</span></span> |<span data-ttu-id="45541-424">Try a new request to the `/authorize` endpoint</span><span class="sxs-lookup"><span data-stu-id="45541-424">Try a new request to the `/authorize` endpoint</span></span> |
| <span data-ttu-id="45541-425">unauthorized_client</span><span class="sxs-lookup"><span data-stu-id="45541-425">unauthorized_client</span></span> |<span data-ttu-id="45541-426">The authenticated client is not authorized to use this authorization grant type.</span><span class="sxs-lookup"><span data-stu-id="45541-426">The authenticated client is not authorized to use this authorization grant type.</span></span> |<span data-ttu-id="45541-427">This usually occurs when the client application is not registered in Azure AD or is not added to the user's Azure AD tenant.</span><span class="sxs-lookup"><span data-stu-id="45541-427">This usually occurs when the client application is not registered in Azure AD or is not added to the user's Azure AD tenant.</span></span> <span data-ttu-id="45541-428">The application can prompt the user with instruction for installing the application and adding it to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-428">The application can prompt the user with instruction for installing the application and adding it to Azure AD.</span></span> |
| <span data-ttu-id="45541-429">invalid_client</span><span class="sxs-lookup"><span data-stu-id="45541-429">invalid_client</span></span> |<span data-ttu-id="45541-430">Client authentication failed.</span><span class="sxs-lookup"><span data-stu-id="45541-430">Client authentication failed.</span></span> |<span data-ttu-id="45541-431">The client credentials are not valid.</span><span class="sxs-lookup"><span data-stu-id="45541-431">The client credentials are not valid.</span></span> <span data-ttu-id="45541-432">To fix, the application administrator updates the credentials.</span><span class="sxs-lookup"><span data-stu-id="45541-432">To fix, the application administrator updates the credentials.</span></span> |
| <span data-ttu-id="45541-433">unsupported_grant_type</span><span class="sxs-lookup"><span data-stu-id="45541-433">unsupported_grant_type</span></span> |<span data-ttu-id="45541-434">The authorization server does not support the authorization grant type.</span><span class="sxs-lookup"><span data-stu-id="45541-434">The authorization server does not support the authorization grant type.</span></span> |<span data-ttu-id="45541-435">Change the grant type in the request.</span><span class="sxs-lookup"><span data-stu-id="45541-435">Change the grant type in the request.</span></span> <span data-ttu-id="45541-436">This type of error should occur only during development and be detected during initial testing.</span><span class="sxs-lookup"><span data-stu-id="45541-436">This type of error should occur only during development and be detected during initial testing.</span></span> |
| <span data-ttu-id="45541-437">invalid_resource</span><span class="sxs-lookup"><span data-stu-id="45541-437">invalid_resource</span></span> |<span data-ttu-id="45541-438">The target resource is invalid because it does not exist, Azure AD cannot find it, or it is not correctly configured.</span><span class="sxs-lookup"><span data-stu-id="45541-438">The target resource is invalid because it does not exist, Azure AD cannot find it, or it is not correctly configured.</span></span> |<span data-ttu-id="45541-439">This indicates the resource, if it exists, has not been configured in the tenant.</span><span class="sxs-lookup"><span data-stu-id="45541-439">This indicates the resource, if it exists, has not been configured in the tenant.</span></span> <span data-ttu-id="45541-440">The application can prompt the user with instruction for installing the application and adding it to Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-440">The application can prompt the user with instruction for installing the application and adding it to Azure AD.</span></span> |
| <span data-ttu-id="45541-441">interaction_required</span><span class="sxs-lookup"><span data-stu-id="45541-441">interaction_required</span></span> |<span data-ttu-id="45541-442">The request requires user interaction.</span><span class="sxs-lookup"><span data-stu-id="45541-442">The request requires user interaction.</span></span> <span data-ttu-id="45541-443">For example, an additional authentication step is required.</span><span class="sxs-lookup"><span data-stu-id="45541-443">For example, an additional authentication step is required.</span></span> | <span data-ttu-id="45541-444">Instead of a non-interactive request, retry with an interactive authorization request for the same resource.</span><span class="sxs-lookup"><span data-stu-id="45541-444">Instead of a non-interactive request, retry with an interactive authorization request for the same resource.</span></span> |
| <span data-ttu-id="45541-445">temporarily_unavailable</span><span class="sxs-lookup"><span data-stu-id="45541-445">temporarily_unavailable</span></span> |<span data-ttu-id="45541-446">The server is temporarily too busy to handle the request.</span><span class="sxs-lookup"><span data-stu-id="45541-446">The server is temporarily too busy to handle the request.</span></span> |<span data-ttu-id="45541-447">Retry the request.</span><span class="sxs-lookup"><span data-stu-id="45541-447">Retry the request.</span></span> <span data-ttu-id="45541-448">The client application might explain to the user that its response is delayed due to a temporary condition.</span><span class="sxs-lookup"><span data-stu-id="45541-448">The client application might explain to the user that its response is delayed due to a temporary condition.</span></span> |

## <a name="use-the-access-token-to-access-the-resource"></a><span data-ttu-id="45541-449">Use the access token to access the resource</span><span class="sxs-lookup"><span data-stu-id="45541-449">Use the access token to access the resource</span></span>
<span data-ttu-id="45541-450">Now that you've successfully acquired an `access_token`, you can use the token in requests to Web APIs, by including it in the `Authorization` header.</span><span class="sxs-lookup"><span data-stu-id="45541-450">Now that you've successfully acquired an `access_token`, you can use the token in requests to Web APIs, by including it in the `Authorization` header.</span></span> <span data-ttu-id="45541-451">The [RFC 6750](http://www.rfc-editor.org/rfc/rfc6750.txt) specification explains how to use bearer tokens in HTTP requests to access protected resources.</span><span class="sxs-lookup"><span data-stu-id="45541-451">The [RFC 6750](http://www.rfc-editor.org/rfc/rfc6750.txt) specification explains how to use bearer tokens in HTTP requests to access protected resources.</span></span>

### <a name="sample-request"></a><span data-ttu-id="45541-452">Sample request</span><span class="sxs-lookup"><span data-stu-id="45541-452">Sample request</span></span>
```
GET /data HTTP/1.1
Host: service.contoso.com
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1THdqcHdBSk9NOW4tQSJ9.eyJhdWQiOiJodHRwczovL3NlcnZpY2UuY29udG9zby5jb20vIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvN2ZlODE0NDctZGE1Ny00Mzg1LWJlY2ItNmRlNTdmMjE0NzdlLyIsImlhdCI6MTM4ODQ0MDg2MywibmJmIjoxMzg4NDQwODYzLCJleHAiOjEzODg0NDQ3NjMsInZlciI6IjEuMCIsInRpZCI6IjdmZTgxNDQ3LWRhNTctNDM4NS1iZWNiLTZkZTU3ZjIxNDc3ZSIsIm9pZCI6IjY4Mzg5YWUyLTYyZmEtNGIxOC05MWZlLTUzZGQxMDlkNzRmNSIsInVwbiI6ImZyYW5rbUBjb250b3NvLmNvbSIsInVuaXF1ZV9uYW1lIjoiZnJhbmttQGNvbnRvc28uY29tIiwic3ViIjoiZGVOcUlqOUlPRTlQV0pXYkhzZnRYdDJFYWJQVmwwQ2o4UUFtZWZSTFY5OCIsImZhbWlseV9uYW1lIjoiTWlsbGVyIiwiZ2l2ZW5fbmFtZSI6IkZyYW5rIiwiYXBwaWQiOiIyZDRkMTFhMi1mODE0LTQ2YTctODkwYS0yNzRhNzJhNzMwOWUiLCJhcHBpZGFjciI6IjAiLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJhY3IiOiIxIn0.JZw8jC0gptZxVC-7l5sFkdnJgP3_tRjeQEPgUn28XctVe3QqmheLZw7QVZDPCyGycDWBaqy7FLpSekET_BftDkewRhyHk9FW_KeEz0ch2c3i08NGNDbr6XYGVayNuSesYk5Aw_p3ICRlUV1bqEwk-Jkzs9EEkQg4hbefqJS6yS1HoV_2EsEhpd_wCQpxK89WPs3hLYZETRJtG5kvCCEOvSHXmDE6eTHGTnEgsIk--UlPe275Dvou4gEAwLofhLDQbMSjnlV5VLsjimNBVcSRFShoxmQwBJR_b2011Y5IuD6St5zPnzruBbZYkGNurQK63TJPWmRd3mbJsGM0mf3CUQ
```

### <a name="error-response"></a><span data-ttu-id="45541-453">Error Response</span><span class="sxs-lookup"><span data-stu-id="45541-453">Error Response</span></span>
<span data-ttu-id="45541-454">Secured resources that implement RFC 6750 issue HTTP status codes.</span><span class="sxs-lookup"><span data-stu-id="45541-454">Secured resources that implement RFC 6750 issue HTTP status codes.</span></span> <span data-ttu-id="45541-455">If the request does not include authentication credentials or is missing the token, the response includes an `WWW-Authenticate` header.</span><span class="sxs-lookup"><span data-stu-id="45541-455">If the request does not include authentication credentials or is missing the token, the response includes an `WWW-Authenticate` header.</span></span> <span data-ttu-id="45541-456">When a request fails, the resource server responds with the HTTP status code and an error code.</span><span class="sxs-lookup"><span data-stu-id="45541-456">When a request fails, the resource server responds with the HTTP status code and an error code.</span></span>

<span data-ttu-id="45541-457">The following is an example of an unsuccessful response when the client request does not include the bearer token:</span><span class="sxs-lookup"><span data-stu-id="45541-457">The following is an example of an unsuccessful response when the client request does not include the bearer token:</span></span>

```
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer authorization_uri="https://login.microsoftonline.com/contoso.com/oauth2/authorize",  error="invalid_token",  error_description="The access token is missing.",
```

#### <a name="error-parameters"></a><span data-ttu-id="45541-458">Error parameters</span><span class="sxs-lookup"><span data-stu-id="45541-458">Error parameters</span></span>
| <span data-ttu-id="45541-459">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-459">Parameter</span></span> | <span data-ttu-id="45541-460">Description</span><span class="sxs-lookup"><span data-stu-id="45541-460">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-461">authorization_uri</span><span class="sxs-lookup"><span data-stu-id="45541-461">authorization_uri</span></span> |<span data-ttu-id="45541-462">The URI (physical endpoint) of the authorization server.</span><span class="sxs-lookup"><span data-stu-id="45541-462">The URI (physical endpoint) of the authorization server.</span></span> <span data-ttu-id="45541-463">This value is also used as a lookup key to get more information about the server from a discovery endpoint.</span><span class="sxs-lookup"><span data-stu-id="45541-463">This value is also used as a lookup key to get more information about the server from a discovery endpoint.</span></span> <p><p> <span data-ttu-id="45541-464">The client must validate that the authorization server is trusted.</span><span class="sxs-lookup"><span data-stu-id="45541-464">The client must validate that the authorization server is trusted.</span></span> <span data-ttu-id="45541-465">When the resource is protected by Azure AD, it is sufficient to verify that the URL begins with https://login.microsoftonline.com or another hostname that Azure AD supports.</span><span class="sxs-lookup"><span data-stu-id="45541-465">When the resource is protected by Azure AD, it is sufficient to verify that the URL begins with https://login.microsoftonline.com or another hostname that Azure AD supports.</span></span> <span data-ttu-id="45541-466">A tenant-specific resource should always return a tenant-specific authorization URI.</span><span class="sxs-lookup"><span data-stu-id="45541-466">A tenant-specific resource should always return a tenant-specific authorization URI.</span></span> |
| <span data-ttu-id="45541-467">error</span><span class="sxs-lookup"><span data-stu-id="45541-467">error</span></span> |<span data-ttu-id="45541-468">An error code value defined in Section 5.2 of the [OAuth 2.0 Authorization Framework](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="45541-468">An error code value defined in Section 5.2 of the [OAuth 2.0 Authorization Framework](http://tools.ietf.org/html/rfc6749).</span></span> |
| <span data-ttu-id="45541-469">error_description</span><span class="sxs-lookup"><span data-stu-id="45541-469">error_description</span></span> |<span data-ttu-id="45541-470">A more detailed description of the error.</span><span class="sxs-lookup"><span data-stu-id="45541-470">A more detailed description of the error.</span></span> <span data-ttu-id="45541-471">This message is not intended to be end-user friendly.</span><span class="sxs-lookup"><span data-stu-id="45541-471">This message is not intended to be end-user friendly.</span></span> |
| <span data-ttu-id="45541-472">resource_id</span><span class="sxs-lookup"><span data-stu-id="45541-472">resource_id</span></span> |<span data-ttu-id="45541-473">Returns the unique identifier of the resource.</span><span class="sxs-lookup"><span data-stu-id="45541-473">Returns the unique identifier of the resource.</span></span> <span data-ttu-id="45541-474">The client application can use this identifier as the value of the `resource` parameter when it requests a token for the resource.</span><span class="sxs-lookup"><span data-stu-id="45541-474">The client application can use this identifier as the value of the `resource` parameter when it requests a token for the resource.</span></span> <p><p> <span data-ttu-id="45541-475">It is important for the client application to verify this value, otherwise a malicious service might be able to induce an **elevation-of-privileges** attack</span><span class="sxs-lookup"><span data-stu-id="45541-475">It is important for the client application to verify this value, otherwise a malicious service might be able to induce an **elevation-of-privileges** attack</span></span> <p><p> <span data-ttu-id="45541-476">The recommended strategy for preventing an attack is to verify that the `resource_id` matches the base of the web API URL that being accessed.</span><span class="sxs-lookup"><span data-stu-id="45541-476">The recommended strategy for preventing an attack is to verify that the `resource_id` matches the base of the web API URL that being accessed.</span></span> <span data-ttu-id="45541-477">For example, if https://service.contoso.com/data is being accessed, the `resource_id` can be htttps://service.contoso.com/.</span><span class="sxs-lookup"><span data-stu-id="45541-477">For example, if https://service.contoso.com/data is being accessed, the `resource_id` can be htttps://service.contoso.com/.</span></span> <span data-ttu-id="45541-478">The client application must reject a `resource_id` that does not begin with the base URL unless there is a reliable alternate way to verify the id.</span><span class="sxs-lookup"><span data-stu-id="45541-478">The client application must reject a `resource_id` that does not begin with the base URL unless there is a reliable alternate way to verify the id.</span></span> |

#### <a name="bearer-scheme-error-codes"></a><span data-ttu-id="45541-479">Bearer scheme error codes</span><span class="sxs-lookup"><span data-stu-id="45541-479">Bearer scheme error codes</span></span>
<span data-ttu-id="45541-480">The RFC 6750 specification defines the following errors for resources that use the WWW-Authenticate header and Bearer scheme in the response.</span><span class="sxs-lookup"><span data-stu-id="45541-480">The RFC 6750 specification defines the following errors for resources that use the WWW-Authenticate header and Bearer scheme in the response.</span></span>

| <span data-ttu-id="45541-481">HTTP Status Code</span><span class="sxs-lookup"><span data-stu-id="45541-481">HTTP Status Code</span></span> | <span data-ttu-id="45541-482">Error Code</span><span class="sxs-lookup"><span data-stu-id="45541-482">Error Code</span></span> | <span data-ttu-id="45541-483">Description</span><span class="sxs-lookup"><span data-stu-id="45541-483">Description</span></span> | <span data-ttu-id="45541-484">Client Action</span><span class="sxs-lookup"><span data-stu-id="45541-484">Client Action</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="45541-485">400</span><span class="sxs-lookup"><span data-stu-id="45541-485">400</span></span> |<span data-ttu-id="45541-486">invalid_request</span><span class="sxs-lookup"><span data-stu-id="45541-486">invalid_request</span></span> |<span data-ttu-id="45541-487">The request is not well-formed.</span><span class="sxs-lookup"><span data-stu-id="45541-487">The request is not well-formed.</span></span> <span data-ttu-id="45541-488">For example, it might be missing a parameter or using the same parameter twice.</span><span class="sxs-lookup"><span data-stu-id="45541-488">For example, it might be missing a parameter or using the same parameter twice.</span></span> |<span data-ttu-id="45541-489">Fix the error and retry the request.</span><span class="sxs-lookup"><span data-stu-id="45541-489">Fix the error and retry the request.</span></span> <span data-ttu-id="45541-490">This type of error should occur only during development and be detected in initial testing.</span><span class="sxs-lookup"><span data-stu-id="45541-490">This type of error should occur only during development and be detected in initial testing.</span></span> |
| <span data-ttu-id="45541-491">401</span><span class="sxs-lookup"><span data-stu-id="45541-491">401</span></span> |<span data-ttu-id="45541-492">invalid_token</span><span class="sxs-lookup"><span data-stu-id="45541-492">invalid_token</span></span> |<span data-ttu-id="45541-493">The access token is missing, invalid, or is revoked.</span><span class="sxs-lookup"><span data-stu-id="45541-493">The access token is missing, invalid, or is revoked.</span></span> <span data-ttu-id="45541-494">The value of the error_description parameter provides additional detail.</span><span class="sxs-lookup"><span data-stu-id="45541-494">The value of the error_description parameter provides additional detail.</span></span> |<span data-ttu-id="45541-495">Request a new token from the authorization server.</span><span class="sxs-lookup"><span data-stu-id="45541-495">Request a new token from the authorization server.</span></span> <span data-ttu-id="45541-496">If the new token fails, an unexpected error has occurred.</span><span class="sxs-lookup"><span data-stu-id="45541-496">If the new token fails, an unexpected error has occurred.</span></span> <span data-ttu-id="45541-497">Send an error message to the user and retry after random delays.</span><span class="sxs-lookup"><span data-stu-id="45541-497">Send an error message to the user and retry after random delays.</span></span> |
| <span data-ttu-id="45541-498">403</span><span class="sxs-lookup"><span data-stu-id="45541-498">403</span></span> |<span data-ttu-id="45541-499">insufficient_scope</span><span class="sxs-lookup"><span data-stu-id="45541-499">insufficient_scope</span></span> |<span data-ttu-id="45541-500">The access token does not contain the impersonation permissions required to access the resource.</span><span class="sxs-lookup"><span data-stu-id="45541-500">The access token does not contain the impersonation permissions required to access the resource.</span></span> |<span data-ttu-id="45541-501">Send a new authorization request to the authorization endpoint.</span><span class="sxs-lookup"><span data-stu-id="45541-501">Send a new authorization request to the authorization endpoint.</span></span> <span data-ttu-id="45541-502">If the response contains the scope parameter, use the scope value in the request to the resource.</span><span class="sxs-lookup"><span data-stu-id="45541-502">If the response contains the scope parameter, use the scope value in the request to the resource.</span></span> |
| <span data-ttu-id="45541-503">403</span><span class="sxs-lookup"><span data-stu-id="45541-503">403</span></span> |<span data-ttu-id="45541-504">insufficient_access</span><span class="sxs-lookup"><span data-stu-id="45541-504">insufficient_access</span></span> |<span data-ttu-id="45541-505">The subject of the token does not have the permissions that are required to access the resource.</span><span class="sxs-lookup"><span data-stu-id="45541-505">The subject of the token does not have the permissions that are required to access the resource.</span></span> |<span data-ttu-id="45541-506">Prompt the user to use a different account or to request permissions to the specified resource.</span><span class="sxs-lookup"><span data-stu-id="45541-506">Prompt the user to use a different account or to request permissions to the specified resource.</span></span> |

## <a name="refreshing-the-access-tokens"></a><span data-ttu-id="45541-507">Refreshing the access tokens</span><span class="sxs-lookup"><span data-stu-id="45541-507">Refreshing the access tokens</span></span>
<span data-ttu-id="45541-508">Access Tokens are short-lived and must be refreshed after they expire to continue accessing resources.</span><span class="sxs-lookup"><span data-stu-id="45541-508">Access Tokens are short-lived and must be refreshed after they expire to continue accessing resources.</span></span> <span data-ttu-id="45541-509">You can refresh the `access_token` by submitting another `POST` request to the `/token` endpoint, but this time providing the `refresh_token` instead of the `code`.</span><span class="sxs-lookup"><span data-stu-id="45541-509">You can refresh the `access_token` by submitting another `POST` request to the `/token` endpoint, but this time providing the `refresh_token` instead of the `code`.</span></span>

<span data-ttu-id="45541-510">Refresh tokens do not have specified lifetimes.</span><span class="sxs-lookup"><span data-stu-id="45541-510">Refresh tokens do not have specified lifetimes.</span></span> <span data-ttu-id="45541-511">Typically, the lifetimes of refresh tokens are relatively long.</span><span class="sxs-lookup"><span data-stu-id="45541-511">Typically, the lifetimes of refresh tokens are relatively long.</span></span> <span data-ttu-id="45541-512">However, in some cases, refresh tokens expire, are revoked, or lack sufficient privileges for the desired action.</span><span class="sxs-lookup"><span data-stu-id="45541-512">However, in some cases, refresh tokens expire, are revoked, or lack sufficient privileges for the desired action.</span></span> <span data-ttu-id="45541-513">Your application needs to expect and handle errors returned by the token issuance endpoint correctly.</span><span class="sxs-lookup"><span data-stu-id="45541-513">Your application needs to expect and handle errors returned by the token issuance endpoint correctly.</span></span>

<span data-ttu-id="45541-514">When you receive a response with a refresh token error, discard the current refresh token and request a new authorization code or access token.</span><span class="sxs-lookup"><span data-stu-id="45541-514">When you receive a response with a refresh token error, discard the current refresh token and request a new authorization code or access token.</span></span> <span data-ttu-id="45541-515">In particular, when using a refresh token in the Authorization Code Grant flow, if you receive a response with the `interaction_required` or `invalid_grant` error codes, discard the refresh token and request a new authorization code.</span><span class="sxs-lookup"><span data-stu-id="45541-515">In particular, when using a refresh token in the Authorization Code Grant flow, if you receive a response with the `interaction_required` or `invalid_grant` error codes, discard the refresh token and request a new authorization code.</span></span>

<span data-ttu-id="45541-516">A sample request to the **tenant-specific** endpoint (you can also use the **common** endpoint) to get a new access token using a refresh token looks like this:</span><span class="sxs-lookup"><span data-stu-id="45541-516">A sample request to the **tenant-specific** endpoint (you can also use the **common** endpoint) to get a new access token using a refresh token looks like this:</span></span>

```
// Line breaks for legibility only

POST /{tenant}/oauth2/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&refresh_token=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq...
&grant_type=refresh_token
&resource=https%3A%2F%2Fservice.contoso.com%2F
&client_secret=JqQX2PNo9bpM0uEihUPzyrh    // NOTE: Only required for web apps
```

### <a name="successful-response"></a><span data-ttu-id="45541-517">Successful response</span><span class="sxs-lookup"><span data-stu-id="45541-517">Successful response</span></span>
<span data-ttu-id="45541-518">A successful token response will look like:</span><span class="sxs-lookup"><span data-stu-id="45541-518">A successful token response will look like:</span></span>

```
{
  "token_type": "Bearer",
  "expires_in": "3600",
  "expires_on": "1460404526",
  "resource": "https://service.contoso.com/",
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1THdqcHdBSk9NOW4tQSJ9.eyJhdWQiOiJodHRwczovL3NlcnZpY2UuY29udG9zby5jb20vIiwiaXNzIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvN2ZlODE0NDctZGE1Ny00Mzg1LWJlY2ItNmRlNTdmMjE0NzdlLyIsImlhdCI6MTM4ODQ0MDg2MywibmJmIjoxMzg4NDQwODYzLCJleHAiOjEzODg0NDQ3NjMsInZlciI6IjEuMCIsInRpZCI6IjdmZTgxNDQ3LWRhNTctNDM4NS1iZWNiLTZkZTU3ZjIxNDc3ZSIsIm9pZCI6IjY4Mzg5YWUyLTYyZmEtNGIxOC05MWZlLTUzZGQxMDlkNzRmNSIsInVwbiI6ImZyYW5rbUBjb250b3NvLmNvbSIsInVuaXF1ZV9uYW1lIjoiZnJhbmttQGNvbnRvc28uY29tIiwic3ViIjoiZGVOcUlqOUlPRTlQV0pXYkhzZnRYdDJFYWJQVmwwQ2o4UUFtZWZSTFY5OCIsImZhbWlseV9uYW1lIjoiTWlsbGVyIiwiZ2l2ZW5fbmFtZSI6IkZyYW5rIiwiYXBwaWQiOiIyZDRkMTFhMi1mODE0LTQ2YTctODkwYS0yNzRhNzJhNzMwOWUiLCJhcHBpZGFjciI6IjAiLCJzY3AiOiJ1c2VyX2ltcGVyc29uYXRpb24iLCJhY3IiOiIxIn0.JZw8jC0gptZxVC-7l5sFkdnJgP3_tRjeQEPgUn28XctVe3QqmheLZw7QVZDPCyGycDWBaqy7FLpSekET_BftDkewRhyHk9FW_KeEz0ch2c3i08NGNDbr6XYGVayNuSesYk5Aw_p3ICRlUV1bqEwk-Jkzs9EEkQg4hbefqJS6yS1HoV_2EsEhpd_wCQpxK89WPs3hLYZETRJtG5kvCCEOvSHXmDE6eTHGTnEgsIk--UlPe275Dvou4gEAwLofhLDQbMSjnlV5VLsjimNBVcSRFShoxmQwBJR_b2011Y5IuD6St5zPnzruBbZYkGNurQK63TJPWmRd3mbJsGM0mf3CUQ",
  "refresh_token": "AwABAAAAv YNqmf9SoAylD1PycGCB90xzZeEDg6oBzOIPfYsbDWNf621pKo2Q3GGTHYlmNfwoc-OlrxK69hkha2CF12azM_NYhgO668yfcUl4VBbiSHZyd1NVZG5QTIOcbObu3qnLutbpadZGAxqjIbMkQ2bQS09fTrjMBtDE3D6kSMIodpCecoANon9b0LATkpitimVCrl PM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4rTfgV29ghDOHRc2B-C_hHeJaJICqjZ3mY2b_YNqmf9SoAylD1PycGCB90xzZeEDg6oBzOIPfYsbDWNf621pKo2Q3GGTHYlmNfwoc-OlrxK69hkha2CF12azM_NYhgO668yfmVCrl-NyfN3oyG4ZCWu18M9-vEou4Sq-1oMDzExgAf61noxzkNiaTecM-Ve5cq6wHqYQjfV9DOz4lbceuYCAA"
}
```
| <span data-ttu-id="45541-519">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-519">Parameter</span></span> | <span data-ttu-id="45541-520">Description</span><span class="sxs-lookup"><span data-stu-id="45541-520">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-521">token_type</span><span class="sxs-lookup"><span data-stu-id="45541-521">token_type</span></span> |<span data-ttu-id="45541-522">The token type.</span><span class="sxs-lookup"><span data-stu-id="45541-522">The token type.</span></span> <span data-ttu-id="45541-523">The only supported value is **bearer**.</span><span class="sxs-lookup"><span data-stu-id="45541-523">The only supported value is **bearer**.</span></span> |
| <span data-ttu-id="45541-524">expires_in</span><span class="sxs-lookup"><span data-stu-id="45541-524">expires_in</span></span> |<span data-ttu-id="45541-525">The remaining lifetime of the token in seconds.</span><span class="sxs-lookup"><span data-stu-id="45541-525">The remaining lifetime of the token in seconds.</span></span> <span data-ttu-id="45541-526">A typical value is 3600 (one hour).</span><span class="sxs-lookup"><span data-stu-id="45541-526">A typical value is 3600 (one hour).</span></span> |
| <span data-ttu-id="45541-527">expires_on</span><span class="sxs-lookup"><span data-stu-id="45541-527">expires_on</span></span> |<span data-ttu-id="45541-528">The date and time on which the token expires.</span><span class="sxs-lookup"><span data-stu-id="45541-528">The date and time on which the token expires.</span></span> <span data-ttu-id="45541-529">The date is represented as the number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.</span><span class="sxs-lookup"><span data-stu-id="45541-529">The date is represented as the number of seconds from 1970-01-01T0:0:0Z UTC until the expiration time.</span></span> |
| <span data-ttu-id="45541-530">resource</span><span class="sxs-lookup"><span data-stu-id="45541-530">resource</span></span> |<span data-ttu-id="45541-531">Identifies the secured resource that the access token can be used to access.</span><span class="sxs-lookup"><span data-stu-id="45541-531">Identifies the secured resource that the access token can be used to access.</span></span> |
| <span data-ttu-id="45541-532">scope</span><span class="sxs-lookup"><span data-stu-id="45541-532">scope</span></span> |<span data-ttu-id="45541-533">Impersonation permissions granted to the native client application.</span><span class="sxs-lookup"><span data-stu-id="45541-533">Impersonation permissions granted to the native client application.</span></span> <span data-ttu-id="45541-534">The default permission is **user_impersonation**.</span><span class="sxs-lookup"><span data-stu-id="45541-534">The default permission is **user_impersonation**.</span></span> <span data-ttu-id="45541-535">The owner of the target resource can register alternate values in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="45541-535">The owner of the target resource can register alternate values in Azure AD.</span></span> |
| <span data-ttu-id="45541-536">access_token</span><span class="sxs-lookup"><span data-stu-id="45541-536">access_token</span></span> |<span data-ttu-id="45541-537">The new access token that was requested.</span><span class="sxs-lookup"><span data-stu-id="45541-537">The new access token that was requested.</span></span> |
| <span data-ttu-id="45541-538">refresh_token</span><span class="sxs-lookup"><span data-stu-id="45541-538">refresh_token</span></span> |<span data-ttu-id="45541-539">A new OAuth 2.0 refresh_token that can be used to request new access tokens when the one in this response expires.</span><span class="sxs-lookup"><span data-stu-id="45541-539">A new OAuth 2.0 refresh_token that can be used to request new access tokens when the one in this response expires.</span></span> |

### <a name="error-response"></a><span data-ttu-id="45541-540">Error response</span><span class="sxs-lookup"><span data-stu-id="45541-540">Error response</span></span>
<span data-ttu-id="45541-541">A sample error response could look like this:</span><span class="sxs-lookup"><span data-stu-id="45541-541">A sample error response could look like this:</span></span>

```
{
  "error": "invalid_resource",
  "error_description": "AADSTS50001: The application named https://foo.microsoft.com/mail.read was not found in the tenant named 295e01fc-0c56-4ac3-ac57-5d0ed568f872. This can happen if the application has not been installed by the administrator of the tenant or consented to by any user in the tenant. You might have sent your authentication request to the wrong tenant.\r\nTrace ID: ef1f89f6-a14f-49de-9868-61bd4072f0a9\r\nCorrelation ID: b6908274-2c58-4e91-aea9-1f6b9c99347c\r\nTimestamp: 2016-04-11 18:59:01Z",
  "error_codes": [
    50001
  ],
  "timestamp": "2016-04-11 18:59:01Z",
  "trace_id": "ef1f89f6-a14f-49de-9868-61bd4072f0a9",
  "correlation_id": "b6908274-2c58-4e91-aea9-1f6b9c99347c"
}
```

| <span data-ttu-id="45541-542">Parameter</span><span class="sxs-lookup"><span data-stu-id="45541-542">Parameter</span></span> | <span data-ttu-id="45541-543">Description</span><span class="sxs-lookup"><span data-stu-id="45541-543">Description</span></span> |
| --- | --- |
| <span data-ttu-id="45541-544">error</span><span class="sxs-lookup"><span data-stu-id="45541-544">error</span></span> |<span data-ttu-id="45541-545">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span><span class="sxs-lookup"><span data-stu-id="45541-545">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span></span> |
| <span data-ttu-id="45541-546">error_description</span><span class="sxs-lookup"><span data-stu-id="45541-546">error_description</span></span> |<span data-ttu-id="45541-547">A specific error message that can help a developer identify the root cause of an authentication error.</span><span class="sxs-lookup"><span data-stu-id="45541-547">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |
| <span data-ttu-id="45541-548">error_codes</span><span class="sxs-lookup"><span data-stu-id="45541-548">error_codes</span></span> |<span data-ttu-id="45541-549">A list of STS-specific error codes that can help in diagnostics.</span><span class="sxs-lookup"><span data-stu-id="45541-549">A list of STS-specific error codes that can help in diagnostics.</span></span> |
| <span data-ttu-id="45541-550">timestamp</span><span class="sxs-lookup"><span data-stu-id="45541-550">timestamp</span></span> |<span data-ttu-id="45541-551">The time at which the error occurred.</span><span class="sxs-lookup"><span data-stu-id="45541-551">The time at which the error occurred.</span></span> |
| <span data-ttu-id="45541-552">trace_id</span><span class="sxs-lookup"><span data-stu-id="45541-552">trace_id</span></span> |<span data-ttu-id="45541-553">A unique identifier for the request that can help in diagnostics.</span><span class="sxs-lookup"><span data-stu-id="45541-553">A unique identifier for the request that can help in diagnostics.</span></span> |
| <span data-ttu-id="45541-554">correlation_id</span><span class="sxs-lookup"><span data-stu-id="45541-554">correlation_id</span></span> |<span data-ttu-id="45541-555">A unique identifier for the request that can help in diagnostics across components.</span><span class="sxs-lookup"><span data-stu-id="45541-555">A unique identifier for the request that can help in diagnostics across components.</span></span> |

<span data-ttu-id="45541-556">For a description of the error codes and the recommended client action, see [Error codes for token endpoint errors](#error-codes-for-token-endpoint-errors).</span><span class="sxs-lookup"><span data-stu-id="45541-556">For a description of the error codes and the recommended client action, see [Error codes for token endpoint errors](#error-codes-for-token-endpoint-errors).</span></span>
