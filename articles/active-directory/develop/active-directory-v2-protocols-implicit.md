---
title: Secure single page applications using the Azure AD v2.0 implicit flow | Microsoft Docs
description: Building web applications using Azure AD's v2.0 implementation of the implicit flow for single page apps.
services: active-directory
documentationcenter: ''
author: dstrockis
manager: mbaldwin
editor: ''
ms.assetid: 3605931f-dc24-4910-bb50-5375defec6a8
ms.service: active-directory
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 01/07/2017
ms.author: dastrock
ms.openlocfilehash: c203f5b60d7bccd805dae103360b6d8befd42b31
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44563921"
---
# <a name="v20-protocols---spas-using-the-implicit-flow"></a><span data-ttu-id="55c4d-103">v2.0 Protocols - SPAs using the implicit flow</span><span class="sxs-lookup"><span data-stu-id="55c4d-103">v2.0 Protocols - SPAs using the implicit flow</span></span>
<span data-ttu-id="55c4d-104">With the v2.0 endpoint, you can sign users into your single page apps with both personal and work/school accounts from Microsoft.</span><span class="sxs-lookup"><span data-stu-id="55c4d-104">With the v2.0 endpoint, you can sign users into your single page apps with both personal and work/school accounts from Microsoft.</span></span>  <span data-ttu-id="55c4d-105">Single page and other JavaScript apps that run primarily in a browser face a few interesting challenges when it comes to authentication:</span><span class="sxs-lookup"><span data-stu-id="55c4d-105">Single page and other JavaScript apps that run primarily in a browser face a few interesting challenges when it comes to authentication:</span></span>

* <span data-ttu-id="55c4d-106">The security characteristics of these apps are significantly different from traditional server based web applications.</span><span class="sxs-lookup"><span data-stu-id="55c4d-106">The security characteristics of these apps are significantly different from traditional server based web applications.</span></span>
* <span data-ttu-id="55c4d-107">Many authorization servers & identity providers do not support CORS requests.</span><span class="sxs-lookup"><span data-stu-id="55c4d-107">Many authorization servers & identity providers do not support CORS requests.</span></span>
* <span data-ttu-id="55c4d-108">Full page browser redirects away from the app become particularly invasive to the user experience.</span><span class="sxs-lookup"><span data-stu-id="55c4d-108">Full page browser redirects away from the app become particularly invasive to the user experience.</span></span>

<span data-ttu-id="55c4d-109">For these applications (think: AngularJS, Ember.js, React.js, etc) Azure AD supports the OAuth 2.0 Implicit Grant flow.</span><span class="sxs-lookup"><span data-stu-id="55c4d-109">For these applications (think: AngularJS, Ember.js, React.js, etc) Azure AD supports the OAuth 2.0 Implicit Grant flow.</span></span>  <span data-ttu-id="55c4d-110">The implicit flow is described in the [OAuth 2.0 Specification](http://tools.ietf.org/html/rfc6749#section-4.2).</span><span class="sxs-lookup"><span data-stu-id="55c4d-110">The implicit flow is described in the [OAuth 2.0 Specification](http://tools.ietf.org/html/rfc6749#section-4.2).</span></span>  <span data-ttu-id="55c4d-111">Its primary benefit is that it allows the app to get tokens from Azure AD without performing a backend server credential exchange.</span><span class="sxs-lookup"><span data-stu-id="55c4d-111">Its primary benefit is that it allows the app to get tokens from Azure AD without performing a backend server credential exchange.</span></span>  <span data-ttu-id="55c4d-112">This allows the app to sign in the user, maintain session, and get tokens to other web APIs all within the client JavaScript code.</span><span class="sxs-lookup"><span data-stu-id="55c4d-112">This allows the app to sign in the user, maintain session, and get tokens to other web APIs all within the client JavaScript code.</span></span>  <span data-ttu-id="55c4d-113">There are a few important security considerations to take into account when using the implicit flow - specifically around [client](http://tools.ietf.org/html/rfc6749#section-10.3) and [user impersonation](http://tools.ietf.org/html/rfc6749#section-10.3).</span><span class="sxs-lookup"><span data-stu-id="55c4d-113">There are a few important security considerations to take into account when using the implicit flow - specifically around [client](http://tools.ietf.org/html/rfc6749#section-10.3) and [user impersonation](http://tools.ietf.org/html/rfc6749#section-10.3).</span></span>

<span data-ttu-id="55c4d-114">If you want to use the implicit flow and Azure AD to add authentication to your JavaScript app, we recommend you use our open source JavaScript library, [adal.js](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span><span class="sxs-lookup"><span data-stu-id="55c4d-114">If you want to use the implicit flow and Azure AD to add authentication to your JavaScript app, we recommend you use our open source JavaScript library, [adal.js](https://github.com/AzureAD/azure-activedirectory-library-for-js).</span></span>  <span data-ttu-id="55c4d-115">There are few AngularJS tutorials available [here](active-directory-appmodel-v2-overview.md#getting-started) to help you get started.</span><span class="sxs-lookup"><span data-stu-id="55c4d-115">There are few AngularJS tutorials available [here](active-directory-appmodel-v2-overview.md#getting-started) to help you get started.</span></span>  

<span data-ttu-id="55c4d-116">However, if you would prefer not to use a library in your single page app and send protocol messages yourself, follow the general steps below.</span><span class="sxs-lookup"><span data-stu-id="55c4d-116">However, if you would prefer not to use a library in your single page app and send protocol messages yourself, follow the general steps below.</span></span>

> [!NOTE]
> <span data-ttu-id="55c4d-117">Not all Azure Active Directory scenarios & features are supported by the v2.0 endpoint.</span><span class="sxs-lookup"><span data-stu-id="55c4d-117">Not all Azure Active Directory scenarios & features are supported by the v2.0 endpoint.</span></span>  <span data-ttu-id="55c4d-118">To determine if you should use the v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span><span class="sxs-lookup"><span data-stu-id="55c4d-118">To determine if you should use the v2.0 endpoint, read about [v2.0 limitations](active-directory-v2-limitations.md).</span></span>
> 
> 

## <a name="protocol-diagram"></a><span data-ttu-id="55c4d-119">Protocol diagram</span><span class="sxs-lookup"><span data-stu-id="55c4d-119">Protocol diagram</span></span>
<span data-ttu-id="55c4d-120">The entire implicit sign in flow looks something like this - each of the steps are described in detail below.</span><span class="sxs-lookup"><span data-stu-id="55c4d-120">The entire implicit sign in flow looks something like this - each of the steps are described in detail below.</span></span>

![OpenId Connect Swimlanes](https://docstestmedia1.blob.core.windows.net/azure-media/articles/media/active-directory-v2-flows/convergence_scenarios_implicit.png)

## <a name="send-the-sign-in-request"></a><span data-ttu-id="55c4d-122">Send the sign-in request</span><span class="sxs-lookup"><span data-stu-id="55c4d-122">Send the sign-in request</span></span>
<span data-ttu-id="55c4d-123">To initially sign the user into your app, you can send an [OpenID Connect](active-directory-v2-protocols-oidc.md) authorization request and get an `id_token` from the v2.0 endpoint:</span><span class="sxs-lookup"><span data-stu-id="55c4d-123">To initially sign the user into your app, you can send an [OpenID Connect](active-directory-v2-protocols-oidc.md) authorization request and get an `id_token` from the v2.0 endpoint:</span></span>

```
// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=id_token+token
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&scope=openid%20https%3A%2F%2Fgraph.microsoft.com%2Fmail.read
&response_mode=fragment
&state=12345
&nonce=678910
```

> [!TIP]
> <span data-ttu-id="55c4d-124">Click the link below to execute this request!</span><span class="sxs-lookup"><span data-stu-id="55c4d-124">Click the link below to execute this request!</span></span> <span data-ttu-id="55c4d-125">After signing in, your browser should be redirected to `https://localhost/myapp/` with a `id_token` in the address bar.</span><span class="sxs-lookup"><span data-stu-id="55c4d-125">After signing in, your browser should be redirected to `https://localhost/myapp/` with a `id_token` in the address bar.</span></span>
> <span data-ttu-id="55c4d-126"><a href="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=id_token+token&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&scope=openid%20https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&response_mode=fragment&state=12345&nonce=678910" target="_blank">https://login.microsoftonline.com/common/oauth2/v2.0/authorize...</a></span><span class="sxs-lookup"><span data-stu-id="55c4d-126"><a href="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=id_token+token&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&scope=openid%20https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&response_mode=fragment&state=12345&nonce=678910" target="_blank">https://login.microsoftonline.com/common/oauth2/v2.0/authorize...</a></span></span>
> 
> 

| <span data-ttu-id="55c4d-127">Parameter</span><span class="sxs-lookup"><span data-stu-id="55c4d-127">Parameter</span></span> |  | <span data-ttu-id="55c4d-128">Description</span><span class="sxs-lookup"><span data-stu-id="55c4d-128">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="55c4d-129">tenant</span><span class="sxs-lookup"><span data-stu-id="55c4d-129">tenant</span></span> |<span data-ttu-id="55c4d-130">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-130">required</span></span> |<span data-ttu-id="55c4d-131">The `{tenant}` value in the path of the request can be used to control who can sign into the application.</span><span class="sxs-lookup"><span data-stu-id="55c4d-131">The `{tenant}` value in the path of the request can be used to control who can sign into the application.</span></span>  <span data-ttu-id="55c4d-132">The allowed values are `common`, `organizations`, `consumers`, and tenant identifiers.</span><span class="sxs-lookup"><span data-stu-id="55c4d-132">The allowed values are `common`, `organizations`, `consumers`, and tenant identifiers.</span></span>  <span data-ttu-id="55c4d-133">For more detail, see [protocol basics](active-directory-v2-protocols.md#endpoints).</span><span class="sxs-lookup"><span data-stu-id="55c4d-133">For more detail, see [protocol basics](active-directory-v2-protocols.md#endpoints).</span></span> |
| <span data-ttu-id="55c4d-134">client_id</span><span class="sxs-lookup"><span data-stu-id="55c4d-134">client_id</span></span> |<span data-ttu-id="55c4d-135">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-135">required</span></span> |<span data-ttu-id="55c4d-136">The Application Id that the registration portal ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) assigned your app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-136">The Application Id that the registration portal ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) assigned your app.</span></span> |
| <span data-ttu-id="55c4d-137">response_type</span><span class="sxs-lookup"><span data-stu-id="55c4d-137">response_type</span></span> |<span data-ttu-id="55c4d-138">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-138">required</span></span> |<span data-ttu-id="55c4d-139">Must include `id_token` for OpenID Connect sign-in.</span><span class="sxs-lookup"><span data-stu-id="55c4d-139">Must include `id_token` for OpenID Connect sign-in.</span></span>  <span data-ttu-id="55c4d-140">It may also include the response_type `token`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-140">It may also include the response_type `token`.</span></span> <span data-ttu-id="55c4d-141">Using `token` here will allow your app to receive an access token immediately from the authorize endpoint without having to make a second request to the authorize endpoint.</span><span class="sxs-lookup"><span data-stu-id="55c4d-141">Using `token` here will allow your app to receive an access token immediately from the authorize endpoint without having to make a second request to the authorize endpoint.</span></span>  <span data-ttu-id="55c4d-142">If you use the `token` response_type, the `scope` parameter must contain a scope indicating which resource to issue the token for.</span><span class="sxs-lookup"><span data-stu-id="55c4d-142">If you use the `token` response_type, the `scope` parameter must contain a scope indicating which resource to issue the token for.</span></span> |
| <span data-ttu-id="55c4d-143">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="55c4d-143">redirect_uri</span></span> |<span data-ttu-id="55c4d-144">recommended</span><span class="sxs-lookup"><span data-stu-id="55c4d-144">recommended</span></span> |<span data-ttu-id="55c4d-145">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-145">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span></span>  <span data-ttu-id="55c4d-146">It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded.</span><span class="sxs-lookup"><span data-stu-id="55c4d-146">It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded.</span></span> |
| <span data-ttu-id="55c4d-147">scope</span><span class="sxs-lookup"><span data-stu-id="55c4d-147">scope</span></span> |<span data-ttu-id="55c4d-148">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-148">required</span></span> |<span data-ttu-id="55c4d-149">A space-separated list of scopes.</span><span class="sxs-lookup"><span data-stu-id="55c4d-149">A space-separated list of scopes.</span></span>  <span data-ttu-id="55c4d-150">For OpenID Connect, it must include the scope `openid`, which translates to the "Sign you in" permission in the consent UI.</span><span class="sxs-lookup"><span data-stu-id="55c4d-150">For OpenID Connect, it must include the scope `openid`, which translates to the "Sign you in" permission in the consent UI.</span></span>  <span data-ttu-id="55c4d-151">Optionally you may also want to include the `email` or `profile` [scopes](active-directory-v2-scopes.md) for gaining access to additional user data.</span><span class="sxs-lookup"><span data-stu-id="55c4d-151">Optionally you may also want to include the `email` or `profile` [scopes](active-directory-v2-scopes.md) for gaining access to additional user data.</span></span>  <span data-ttu-id="55c4d-152">You may also include other scopes in this request for requesting consent to various resources.</span><span class="sxs-lookup"><span data-stu-id="55c4d-152">You may also include other scopes in this request for requesting consent to various resources.</span></span> |
| <span data-ttu-id="55c4d-153">response_mode</span><span class="sxs-lookup"><span data-stu-id="55c4d-153">response_mode</span></span> |<span data-ttu-id="55c4d-154">recommended</span><span class="sxs-lookup"><span data-stu-id="55c4d-154">recommended</span></span> |<span data-ttu-id="55c4d-155">Specifies the method that should be used to send the resulting token back to your app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-155">Specifies the method that should be used to send the resulting token back to your app.</span></span>  <span data-ttu-id="55c4d-156">Should be `fragment` for the implicit flow.</span><span class="sxs-lookup"><span data-stu-id="55c4d-156">Should be `fragment` for the implicit flow.</span></span> |
| <span data-ttu-id="55c4d-157">state</span><span class="sxs-lookup"><span data-stu-id="55c4d-157">state</span></span> |<span data-ttu-id="55c4d-158">recommended</span><span class="sxs-lookup"><span data-stu-id="55c4d-158">recommended</span></span> |<span data-ttu-id="55c4d-159">A value included in the request that will also be returned in the token response.</span><span class="sxs-lookup"><span data-stu-id="55c4d-159">A value included in the request that will also be returned in the token response.</span></span>  <span data-ttu-id="55c4d-160">It can be a string of any content that you wish.</span><span class="sxs-lookup"><span data-stu-id="55c4d-160">It can be a string of any content that you wish.</span></span>  <span data-ttu-id="55c4d-161">A randomly generated unique value is typically used for [preventing cross-site request forgery attacks](http://tools.ietf.org/html/rfc6749#section-10.12).</span><span class="sxs-lookup"><span data-stu-id="55c4d-161">A randomly generated unique value is typically used for [preventing cross-site request forgery attacks](http://tools.ietf.org/html/rfc6749#section-10.12).</span></span>  <span data-ttu-id="55c4d-162">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span><span class="sxs-lookup"><span data-stu-id="55c4d-162">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |
| <span data-ttu-id="55c4d-163">nonce</span><span class="sxs-lookup"><span data-stu-id="55c4d-163">nonce</span></span> |<span data-ttu-id="55c4d-164">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-164">required</span></span> |<span data-ttu-id="55c4d-165">A value included in the request, generated by the app, that will be included in the resulting id_token as a claim.</span><span class="sxs-lookup"><span data-stu-id="55c4d-165">A value included in the request, generated by the app, that will be included in the resulting id_token as a claim.</span></span>  <span data-ttu-id="55c4d-166">The app can then verify this value to mitigate token replay attacks.</span><span class="sxs-lookup"><span data-stu-id="55c4d-166">The app can then verify this value to mitigate token replay attacks.</span></span>  <span data-ttu-id="55c4d-167">The value is typically a randomized, unique string that can be used to identify the origin of the request.</span><span class="sxs-lookup"><span data-stu-id="55c4d-167">The value is typically a randomized, unique string that can be used to identify the origin of the request.</span></span> |
| <span data-ttu-id="55c4d-168">prompt</span><span class="sxs-lookup"><span data-stu-id="55c4d-168">prompt</span></span> |<span data-ttu-id="55c4d-169">optional</span><span class="sxs-lookup"><span data-stu-id="55c4d-169">optional</span></span> |<span data-ttu-id="55c4d-170">Indicates the type of user interaction that is required.</span><span class="sxs-lookup"><span data-stu-id="55c4d-170">Indicates the type of user interaction that is required.</span></span>  <span data-ttu-id="55c4d-171">The only valid values at this time are 'login', 'none', and 'consent'.</span><span class="sxs-lookup"><span data-stu-id="55c4d-171">The only valid values at this time are 'login', 'none', and 'consent'.</span></span>  <span data-ttu-id="55c4d-172">`prompt=login` will force the user to enter their credentials on that request, negating single-sign on.</span><span class="sxs-lookup"><span data-stu-id="55c4d-172">`prompt=login` will force the user to enter their credentials on that request, negating single-sign on.</span></span>  <span data-ttu-id="55c4d-173">`prompt=none` is the opposite - it will ensure that the user is not presented with any interactive prompt whatsoever.</span><span class="sxs-lookup"><span data-stu-id="55c4d-173">`prompt=none` is the opposite - it will ensure that the user is not presented with any interactive prompt whatsoever.</span></span>  <span data-ttu-id="55c4d-174">If the request cannot be completed silently via single-sign on, the v2.0 endpoint will return an error.</span><span class="sxs-lookup"><span data-stu-id="55c4d-174">If the request cannot be completed silently via single-sign on, the v2.0 endpoint will return an error.</span></span>  <span data-ttu-id="55c4d-175">`prompt=consent` will trigger the OAuth consent dialog after the user signs in, asking the user to grant permissions to the app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-175">`prompt=consent` will trigger the OAuth consent dialog after the user signs in, asking the user to grant permissions to the app.</span></span> |
| <span data-ttu-id="55c4d-176">login_hint</span><span class="sxs-lookup"><span data-stu-id="55c4d-176">login_hint</span></span> |<span data-ttu-id="55c4d-177">optional</span><span class="sxs-lookup"><span data-stu-id="55c4d-177">optional</span></span> |<span data-ttu-id="55c4d-178">Can be used to pre-fill the username/email address field of the sign in page for the user, if you know their username ahead of time.</span><span class="sxs-lookup"><span data-stu-id="55c4d-178">Can be used to pre-fill the username/email address field of the sign in page for the user, if you know their username ahead of time.</span></span>  <span data-ttu-id="55c4d-179">Often apps will use this parameter during re-authentication, having already extracted the username from a previous sign-in using the `preferred_username` claim.</span><span class="sxs-lookup"><span data-stu-id="55c4d-179">Often apps will use this parameter during re-authentication, having already extracted the username from a previous sign-in using the `preferred_username` claim.</span></span> |
| <span data-ttu-id="55c4d-180">domain_hint</span><span class="sxs-lookup"><span data-stu-id="55c4d-180">domain_hint</span></span> |<span data-ttu-id="55c4d-181">optional</span><span class="sxs-lookup"><span data-stu-id="55c4d-181">optional</span></span> |<span data-ttu-id="55c4d-182">Can be one of `consumers` or `organizations`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-182">Can be one of `consumers` or `organizations`.</span></span>  <span data-ttu-id="55c4d-183">If included, it will skip the email-based discovery process that user goes through on the v2.0 sign in page, leading to a slightly more streamlined user experience.</span><span class="sxs-lookup"><span data-stu-id="55c4d-183">If included, it will skip the email-based discovery process that user goes through on the v2.0 sign in page, leading to a slightly more streamlined user experience.</span></span>  <span data-ttu-id="55c4d-184">Often apps will use this parameter during re-authentication, by extracting the `tid` claim from the id_token.</span><span class="sxs-lookup"><span data-stu-id="55c4d-184">Often apps will use this parameter during re-authentication, by extracting the `tid` claim from the id_token.</span></span>  <span data-ttu-id="55c4d-185">If the `tid` claim value is `9188040d-6c67-4c5b-b112-36a304b66dad`, you should use `domain_hint=consumers`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-185">If the `tid` claim value is `9188040d-6c67-4c5b-b112-36a304b66dad`, you should use `domain_hint=consumers`.</span></span>  <span data-ttu-id="55c4d-186">Otherwise, use `domain_hint=organizations`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-186">Otherwise, use `domain_hint=organizations`.</span></span> |

<span data-ttu-id="55c4d-187">At this point, the user will be asked to enter their credentials and complete the authentication.</span><span class="sxs-lookup"><span data-stu-id="55c4d-187">At this point, the user will be asked to enter their credentials and complete the authentication.</span></span>  <span data-ttu-id="55c4d-188">The v2.0 endpoint will also ensure that the user has consented to the permissions indicated in the `scope` query parameter.</span><span class="sxs-lookup"><span data-stu-id="55c4d-188">The v2.0 endpoint will also ensure that the user has consented to the permissions indicated in the `scope` query parameter.</span></span>  <span data-ttu-id="55c4d-189">If the user has not consented to any of those permissions, it will ask the user to consent to the required permissions.</span><span class="sxs-lookup"><span data-stu-id="55c4d-189">If the user has not consented to any of those permissions, it will ask the user to consent to the required permissions.</span></span>  <span data-ttu-id="55c4d-190">Details of [permissions, consent, and multi-tenant apps are provided here](active-directory-v2-scopes.md).</span><span class="sxs-lookup"><span data-stu-id="55c4d-190">Details of [permissions, consent, and multi-tenant apps are provided here](active-directory-v2-scopes.md).</span></span>

<span data-ttu-id="55c4d-191">Once the user authenticates and grants consent, the v2.0 endpoint will return a response to your app at the indicated `redirect_uri`, using the method specified in the `response_mode` parameter.</span><span class="sxs-lookup"><span data-stu-id="55c4d-191">Once the user authenticates and grants consent, the v2.0 endpoint will return a response to your app at the indicated `redirect_uri`, using the method specified in the `response_mode` parameter.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="55c4d-192">Successful response</span><span class="sxs-lookup"><span data-stu-id="55c4d-192">Successful response</span></span>
<span data-ttu-id="55c4d-193">A successful response using `response_mode=fragment` and `response_type=id_token+token` looks like the following, with line breaks for legibility:</span><span class="sxs-lookup"><span data-stu-id="55c4d-193">A successful response using `response_mode=fragment` and `response_type=id_token+token` looks like the following, with line breaks for legibility:</span></span>

```
GET https://localhost/myapp/#
access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&token_type=Bearer
&expires_in=3599
&scope=https%3a%2f%2fgraph.microsoft.com%2fmail.read 
&id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&state=12345
```

| <span data-ttu-id="55c4d-194">Parameter</span><span class="sxs-lookup"><span data-stu-id="55c4d-194">Parameter</span></span> | <span data-ttu-id="55c4d-195">Description</span><span class="sxs-lookup"><span data-stu-id="55c4d-195">Description</span></span> |
| --- | --- |
| <span data-ttu-id="55c4d-196">access_token</span><span class="sxs-lookup"><span data-stu-id="55c4d-196">access_token</span></span> |<span data-ttu-id="55c4d-197">Included if `response_type` includes `token`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-197">Included if `response_type` includes `token`.</span></span> <span data-ttu-id="55c4d-198">The access token that the app requested, in this case for the Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="55c4d-198">The access token that the app requested, in this case for the Microsoft Graph.</span></span>  <span data-ttu-id="55c4d-199">The access token should not be decoded or otherwise inspected, it can be treated as an opaque string.</span><span class="sxs-lookup"><span data-stu-id="55c4d-199">The access token should not be decoded or otherwise inspected, it can be treated as an opaque string.</span></span> |
| <span data-ttu-id="55c4d-200">token_type</span><span class="sxs-lookup"><span data-stu-id="55c4d-200">token_type</span></span> |<span data-ttu-id="55c4d-201">Included if `response_type` includes `token`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-201">Included if `response_type` includes `token`.</span></span>  <span data-ttu-id="55c4d-202">Will always be `Bearer`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-202">Will always be `Bearer`.</span></span> |
| <span data-ttu-id="55c4d-203">expires_in</span><span class="sxs-lookup"><span data-stu-id="55c4d-203">expires_in</span></span> |<span data-ttu-id="55c4d-204">Included if `response_type` includes `token`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-204">Included if `response_type` includes `token`.</span></span>  <span data-ttu-id="55c4d-205">Indicates the number of seconds the token is valid, for caching purposes.</span><span class="sxs-lookup"><span data-stu-id="55c4d-205">Indicates the number of seconds the token is valid, for caching purposes.</span></span> |
| <span data-ttu-id="55c4d-206">scope</span><span class="sxs-lookup"><span data-stu-id="55c4d-206">scope</span></span> |<span data-ttu-id="55c4d-207">Included if `response_type` includes `token`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-207">Included if `response_type` includes `token`.</span></span>  <span data-ttu-id="55c4d-208">Indicates the scope(s) for which the access_token will be valid.</span><span class="sxs-lookup"><span data-stu-id="55c4d-208">Indicates the scope(s) for which the access_token will be valid.</span></span> |
| <span data-ttu-id="55c4d-209">id_token</span><span class="sxs-lookup"><span data-stu-id="55c4d-209">id_token</span></span> |<span data-ttu-id="55c4d-210">The id_token that the app requested.</span><span class="sxs-lookup"><span data-stu-id="55c4d-210">The id_token that the app requested.</span></span> <span data-ttu-id="55c4d-211">You can use the id_token to verify the user's identity and begin a session with the user.</span><span class="sxs-lookup"><span data-stu-id="55c4d-211">You can use the id_token to verify the user's identity and begin a session with the user.</span></span>  <span data-ttu-id="55c4d-212">More details on id_tokens and their contents is included in the [v2.0 endpoint token reference](active-directory-v2-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="55c4d-212">More details on id_tokens and their contents is included in the [v2.0 endpoint token reference](active-directory-v2-tokens.md).</span></span> |
| <span data-ttu-id="55c4d-213">state</span><span class="sxs-lookup"><span data-stu-id="55c4d-213">state</span></span> |<span data-ttu-id="55c4d-214">If a state parameter is included in the request, the same value should appear in the response.</span><span class="sxs-lookup"><span data-stu-id="55c4d-214">If a state parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="55c4d-215">The  app should verify that the state values in the request and response are identical.</span><span class="sxs-lookup"><span data-stu-id="55c4d-215">The  app should verify that the state values in the request and response are identical.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="55c4d-216">Error response</span><span class="sxs-lookup"><span data-stu-id="55c4d-216">Error response</span></span>
<span data-ttu-id="55c4d-217">Error responses may also be sent to the `redirect_uri` so the app can handle them appropriately:</span><span class="sxs-lookup"><span data-stu-id="55c4d-217">Error responses may also be sent to the `redirect_uri` so the app can handle them appropriately:</span></span>

```
GET https://localhost/myapp/#
error=access_denied
&error_description=the+user+canceled+the+authentication
```

| <span data-ttu-id="55c4d-218">Parameter</span><span class="sxs-lookup"><span data-stu-id="55c4d-218">Parameter</span></span> | <span data-ttu-id="55c4d-219">Description</span><span class="sxs-lookup"><span data-stu-id="55c4d-219">Description</span></span> |
| --- | --- |
| <span data-ttu-id="55c4d-220">error</span><span class="sxs-lookup"><span data-stu-id="55c4d-220">error</span></span> |<span data-ttu-id="55c4d-221">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span><span class="sxs-lookup"><span data-stu-id="55c4d-221">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span></span> |
| <span data-ttu-id="55c4d-222">error_description</span><span class="sxs-lookup"><span data-stu-id="55c4d-222">error_description</span></span> |<span data-ttu-id="55c4d-223">A specific error message that can help a developer identify the root cause of an authentication error.</span><span class="sxs-lookup"><span data-stu-id="55c4d-223">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |

## <a name="validate-the-idtoken"></a><span data-ttu-id="55c4d-224">Validate the id_token</span><span class="sxs-lookup"><span data-stu-id="55c4d-224">Validate the id_token</span></span>
<span data-ttu-id="55c4d-225">Just receiving an id_token is not sufficient to authenticate the user; you must validate the id_token's signature and verify the claims in the token per your app's requirements.</span><span class="sxs-lookup"><span data-stu-id="55c4d-225">Just receiving an id_token is not sufficient to authenticate the user; you must validate the id_token's signature and verify the claims in the token per your app's requirements.</span></span>  <span data-ttu-id="55c4d-226">The v2.0 endpoint uses [JSON Web Tokens (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) and public key cryptography to sign tokens and verify that they are valid.</span><span class="sxs-lookup"><span data-stu-id="55c4d-226">The v2.0 endpoint uses [JSON Web Tokens (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) and public key cryptography to sign tokens and verify that they are valid.</span></span>

<span data-ttu-id="55c4d-227">You can choose to validate the `id_token` in client code, but a common practice is to send the `id_token` to a backend server and perform the validation there.</span><span class="sxs-lookup"><span data-stu-id="55c4d-227">You can choose to validate the `id_token` in client code, but a common practice is to send the `id_token` to a backend server and perform the validation there.</span></span>  <span data-ttu-id="55c4d-228">Once you've validated the signature of the id_token, there are a few claims you will be required to verify.</span><span class="sxs-lookup"><span data-stu-id="55c4d-228">Once you've validated the signature of the id_token, there are a few claims you will be required to verify.</span></span>  <span data-ttu-id="55c4d-229">See the [v2.0 token reference](active-directory-v2-tokens.md) for more information, including [Validating Tokens](active-directory-v2-tokens.md#validating-tokens) and [Important Information About Signing Key Rollover](active-directory-v2-tokens.md#validating-tokens).</span><span class="sxs-lookup"><span data-stu-id="55c4d-229">See the [v2.0 token reference](active-directory-v2-tokens.md) for more information, including [Validating Tokens](active-directory-v2-tokens.md#validating-tokens) and [Important Information About Signing Key Rollover](active-directory-v2-tokens.md#validating-tokens).</span></span>  <span data-ttu-id="55c4d-230">We recommend making use of a library for parsing and validating tokens - there is at least one available for most languages and platforms.</span><span class="sxs-lookup"><span data-stu-id="55c4d-230">We recommend making use of a library for parsing and validating tokens - there is at least one available for most languages and platforms.</span></span>
<!--TODO: Improve the information on this-->

<span data-ttu-id="55c4d-231">You may also wish to validate additional claims depending on your scenario.</span><span class="sxs-lookup"><span data-stu-id="55c4d-231">You may also wish to validate additional claims depending on your scenario.</span></span>  <span data-ttu-id="55c4d-232">Some common validations include:</span><span class="sxs-lookup"><span data-stu-id="55c4d-232">Some common validations include:</span></span>

* <span data-ttu-id="55c4d-233">Ensuring the user/organization has signed up for the app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-233">Ensuring the user/organization has signed up for the app.</span></span>
* <span data-ttu-id="55c4d-234">Ensuring the user has proper authorization/privileges</span><span class="sxs-lookup"><span data-stu-id="55c4d-234">Ensuring the user has proper authorization/privileges</span></span>
* <span data-ttu-id="55c4d-235">Ensuring a certain strength of authentication has occurred, such as multi-factor authentication.</span><span class="sxs-lookup"><span data-stu-id="55c4d-235">Ensuring a certain strength of authentication has occurred, such as multi-factor authentication.</span></span>

<span data-ttu-id="55c4d-236">For more information on the claims in an id_token, see the [v2.0 endpoint token reference](active-directory-v2-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="55c4d-236">For more information on the claims in an id_token, see the [v2.0 endpoint token reference](active-directory-v2-tokens.md).</span></span>

<span data-ttu-id="55c4d-237">Once you have completely validated the id_token, you can begin a session with the user and use the claims in the id_token to obtain information about the user in your app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-237">Once you have completely validated the id_token, you can begin a session with the user and use the claims in the id_token to obtain information about the user in your app.</span></span>  <span data-ttu-id="55c4d-238">This information can be used for display, records, authorizations, etc.</span><span class="sxs-lookup"><span data-stu-id="55c4d-238">This information can be used for display, records, authorizations, etc.</span></span>

## <a name="get-access-tokens"></a><span data-ttu-id="55c4d-239">Get access tokens</span><span class="sxs-lookup"><span data-stu-id="55c4d-239">Get access tokens</span></span>
<span data-ttu-id="55c4d-240">Now that you've signed the user into your single page app, you can get access tokens for calling web APIs secured by Azure AD, such as the [Microsoft Graph](https://graph.microsoft.io).</span><span class="sxs-lookup"><span data-stu-id="55c4d-240">Now that you've signed the user into your single page app, you can get access tokens for calling web APIs secured by Azure AD, such as the [Microsoft Graph](https://graph.microsoft.io).</span></span>  <span data-ttu-id="55c4d-241">Even if you already received a token using the `token` response_type, you can use this method to acquire tokens to additional resources without having to redirect the user to sign in again.</span><span class="sxs-lookup"><span data-stu-id="55c4d-241">Even if you already received a token using the `token` response_type, you can use this method to acquire tokens to additional resources without having to redirect the user to sign in again.</span></span>

<span data-ttu-id="55c4d-242">In the normal OpenID Connect/OAuth flow, you would do this by making a request to the v2.0 `/token` endpoint.</span><span class="sxs-lookup"><span data-stu-id="55c4d-242">In the normal OpenID Connect/OAuth flow, you would do this by making a request to the v2.0 `/token` endpoint.</span></span>  <span data-ttu-id="55c4d-243">However, the v2.0 endpoint does not support CORS requests, so making AJAX calls to get and refresh tokens is out of the question.</span><span class="sxs-lookup"><span data-stu-id="55c4d-243">However, the v2.0 endpoint does not support CORS requests, so making AJAX calls to get and refresh tokens is out of the question.</span></span>  <span data-ttu-id="55c4d-244">Instead, you can use the implicit flow in a hidden iframe to get new tokens for other web APIs:</span><span class="sxs-lookup"><span data-stu-id="55c4d-244">Instead, you can use the implicit flow in a hidden iframe to get new tokens for other web APIs:</span></span> 

```
// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=token
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&scope=https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&response_mode=fragment
&state=12345&nonce=678910
&prompt=none
&domain_hint=organizations
&login_hint=myuser@mycompany.com
```

> [!TIP]
> <span data-ttu-id="55c4d-245">Try copy & pasting the below request into a browser tab!</span><span class="sxs-lookup"><span data-stu-id="55c4d-245">Try copy & pasting the below request into a browser tab!</span></span> <span data-ttu-id="55c4d-246">(Don't forget to replace the `domain_hint` and the `login_hint` values with the correct values for your user)</span><span class="sxs-lookup"><span data-stu-id="55c4d-246">(Don't forget to replace the `domain_hint` and the `login_hint` values with the correct values for your user)</span></span>
> 
> 

```
https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=token&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&scope=https%3A%2F%2Fgraph.microsoft.com%2Fmail.read&response_mode=fragment&state=12345&nonce=678910&prompt=none&domain_hint={{consumers-or-organizations}}&login_hint={{your-username}}
```

| <span data-ttu-id="55c4d-247">Parameter</span><span class="sxs-lookup"><span data-stu-id="55c4d-247">Parameter</span></span> |  | <span data-ttu-id="55c4d-248">Description</span><span class="sxs-lookup"><span data-stu-id="55c4d-248">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="55c4d-249">tenant</span><span class="sxs-lookup"><span data-stu-id="55c4d-249">tenant</span></span> |<span data-ttu-id="55c4d-250">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-250">required</span></span> |<span data-ttu-id="55c4d-251">The `{tenant}` value in the path of the request can be used to control who can sign into the application.</span><span class="sxs-lookup"><span data-stu-id="55c4d-251">The `{tenant}` value in the path of the request can be used to control who can sign into the application.</span></span>  <span data-ttu-id="55c4d-252">The allowed values are `common`, `organizations`, `consumers`, and tenant identifiers.</span><span class="sxs-lookup"><span data-stu-id="55c4d-252">The allowed values are `common`, `organizations`, `consumers`, and tenant identifiers.</span></span>  <span data-ttu-id="55c4d-253">For more detail, see [protocol basics](active-directory-v2-protocols.md#endpoints).</span><span class="sxs-lookup"><span data-stu-id="55c4d-253">For more detail, see [protocol basics](active-directory-v2-protocols.md#endpoints).</span></span> |
| <span data-ttu-id="55c4d-254">client_id</span><span class="sxs-lookup"><span data-stu-id="55c4d-254">client_id</span></span> |<span data-ttu-id="55c4d-255">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-255">required</span></span> |<span data-ttu-id="55c4d-256">The Application Id that the registration portal ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) assigned your app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-256">The Application Id that the registration portal ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) assigned your app.</span></span> |
| <span data-ttu-id="55c4d-257">response_type</span><span class="sxs-lookup"><span data-stu-id="55c4d-257">response_type</span></span> |<span data-ttu-id="55c4d-258">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-258">required</span></span> |<span data-ttu-id="55c4d-259">Must include `id_token` for OpenID Connect sign-in.</span><span class="sxs-lookup"><span data-stu-id="55c4d-259">Must include `id_token` for OpenID Connect sign-in.</span></span>  <span data-ttu-id="55c4d-260">It may also include other response_types, such as `code`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-260">It may also include other response_types, such as `code`.</span></span> |
| <span data-ttu-id="55c4d-261">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="55c4d-261">redirect_uri</span></span> |<span data-ttu-id="55c4d-262">recommended</span><span class="sxs-lookup"><span data-stu-id="55c4d-262">recommended</span></span> |<span data-ttu-id="55c4d-263">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-263">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span></span>  <span data-ttu-id="55c4d-264">It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded.</span><span class="sxs-lookup"><span data-stu-id="55c4d-264">It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded.</span></span> |
| <span data-ttu-id="55c4d-265">scope</span><span class="sxs-lookup"><span data-stu-id="55c4d-265">scope</span></span> |<span data-ttu-id="55c4d-266">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-266">required</span></span> |<span data-ttu-id="55c4d-267">A space-separated list of scopes.</span><span class="sxs-lookup"><span data-stu-id="55c4d-267">A space-separated list of scopes.</span></span>  <span data-ttu-id="55c4d-268">For getting tokens, include all [scopes](active-directory-v2-scopes.md) you require for the resource of interest.</span><span class="sxs-lookup"><span data-stu-id="55c4d-268">For getting tokens, include all [scopes](active-directory-v2-scopes.md) you require for the resource of interest.</span></span> |
| <span data-ttu-id="55c4d-269">response_mode</span><span class="sxs-lookup"><span data-stu-id="55c4d-269">response_mode</span></span> |<span data-ttu-id="55c4d-270">recommended</span><span class="sxs-lookup"><span data-stu-id="55c4d-270">recommended</span></span> |<span data-ttu-id="55c4d-271">Specifies the method that should be used to send the resulting token back to your app.</span><span class="sxs-lookup"><span data-stu-id="55c4d-271">Specifies the method that should be used to send the resulting token back to your app.</span></span>  <span data-ttu-id="55c4d-272">Can be one of `query`, `form_post`, or `fragment`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-272">Can be one of `query`, `form_post`, or `fragment`.</span></span> |
| <span data-ttu-id="55c4d-273">state</span><span class="sxs-lookup"><span data-stu-id="55c4d-273">state</span></span> |<span data-ttu-id="55c4d-274">recommended</span><span class="sxs-lookup"><span data-stu-id="55c4d-274">recommended</span></span> |<span data-ttu-id="55c4d-275">A value included in the request that will also be returned in the token response.</span><span class="sxs-lookup"><span data-stu-id="55c4d-275">A value included in the request that will also be returned in the token response.</span></span>  <span data-ttu-id="55c4d-276">It can be a string of any content that you wish.</span><span class="sxs-lookup"><span data-stu-id="55c4d-276">It can be a string of any content that you wish.</span></span>  <span data-ttu-id="55c4d-277">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span><span class="sxs-lookup"><span data-stu-id="55c4d-277">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span></span>  <span data-ttu-id="55c4d-278">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span><span class="sxs-lookup"><span data-stu-id="55c4d-278">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |
| <span data-ttu-id="55c4d-279">nonce</span><span class="sxs-lookup"><span data-stu-id="55c4d-279">nonce</span></span> |<span data-ttu-id="55c4d-280">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-280">required</span></span> |<span data-ttu-id="55c4d-281">A value included in the request, generated by the app, that will be included in the resulting id_token as a claim.</span><span class="sxs-lookup"><span data-stu-id="55c4d-281">A value included in the request, generated by the app, that will be included in the resulting id_token as a claim.</span></span>  <span data-ttu-id="55c4d-282">The app can then verify this value to mitigate token replay attacks.</span><span class="sxs-lookup"><span data-stu-id="55c4d-282">The app can then verify this value to mitigate token replay attacks.</span></span>  <span data-ttu-id="55c4d-283">The value is typically a randomized, unique string that can be used to identify the origin of the request.</span><span class="sxs-lookup"><span data-stu-id="55c4d-283">The value is typically a randomized, unique string that can be used to identify the origin of the request.</span></span> |
| <span data-ttu-id="55c4d-284">prompt</span><span class="sxs-lookup"><span data-stu-id="55c4d-284">prompt</span></span> |<span data-ttu-id="55c4d-285">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-285">required</span></span> |<span data-ttu-id="55c4d-286">For refreshing & getting tokens in a hidden iframe, you should use `prompt=none` to ensure that the iframe does not hang on the v2.0 sign in page, and returns immediately.</span><span class="sxs-lookup"><span data-stu-id="55c4d-286">For refreshing & getting tokens in a hidden iframe, you should use `prompt=none` to ensure that the iframe does not hang on the v2.0 sign in page, and returns immediately.</span></span> |
| <span data-ttu-id="55c4d-287">login_hint</span><span class="sxs-lookup"><span data-stu-id="55c4d-287">login_hint</span></span> |<span data-ttu-id="55c4d-288">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-288">required</span></span> |<span data-ttu-id="55c4d-289">For refreshing & getting tokens in a hidden iframe, you must include the username of the user in this hint in order to distinguish between multiple sessions the user may have at a given point in time.</span><span class="sxs-lookup"><span data-stu-id="55c4d-289">For refreshing & getting tokens in a hidden iframe, you must include the username of the user in this hint in order to distinguish between multiple sessions the user may have at a given point in time.</span></span> <span data-ttu-id="55c4d-290">You can extract the username from a previous sign-in using the `preferred_username` claim.</span><span class="sxs-lookup"><span data-stu-id="55c4d-290">You can extract the username from a previous sign-in using the `preferred_username` claim.</span></span> |
| <span data-ttu-id="55c4d-291">domain_hint</span><span class="sxs-lookup"><span data-stu-id="55c4d-291">domain_hint</span></span> |<span data-ttu-id="55c4d-292">required</span><span class="sxs-lookup"><span data-stu-id="55c4d-292">required</span></span> |<span data-ttu-id="55c4d-293">Can be one of `consumers` or `organizations`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-293">Can be one of `consumers` or `organizations`.</span></span>  <span data-ttu-id="55c4d-294">For refreshing & getting tokens in a hidden iframe, you must include the domain_hint in the request.</span><span class="sxs-lookup"><span data-stu-id="55c4d-294">For refreshing & getting tokens in a hidden iframe, you must include the domain_hint in the request.</span></span>  <span data-ttu-id="55c4d-295">You should extract the `tid` claim from the id_token of a previous sign-in to determine which value to use.</span><span class="sxs-lookup"><span data-stu-id="55c4d-295">You should extract the `tid` claim from the id_token of a previous sign-in to determine which value to use.</span></span>  <span data-ttu-id="55c4d-296">If the `tid` claim value is `9188040d-6c67-4c5b-b112-36a304b66dad`, you should use `domain_hint=consumers`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-296">If the `tid` claim value is `9188040d-6c67-4c5b-b112-36a304b66dad`, you should use `domain_hint=consumers`.</span></span>  <span data-ttu-id="55c4d-297">Otherwise, use `domain_hint=organizations`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-297">Otherwise, use `domain_hint=organizations`.</span></span> |

<span data-ttu-id="55c4d-298">Thanks to the `prompt=none` parameter, this request will either succeed or fail immediately and return to your application.</span><span class="sxs-lookup"><span data-stu-id="55c4d-298">Thanks to the `prompt=none` parameter, this request will either succeed or fail immediately and return to your application.</span></span>  <span data-ttu-id="55c4d-299">A successful response will be sent to your app at the indicated `redirect_uri`, using the method specified in the `response_mode` parameter.</span><span class="sxs-lookup"><span data-stu-id="55c4d-299">A successful response will be sent to your app at the indicated `redirect_uri`, using the method specified in the `response_mode` parameter.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="55c4d-300">Successful response</span><span class="sxs-lookup"><span data-stu-id="55c4d-300">Successful response</span></span>
<span data-ttu-id="55c4d-301">A successful response using `response_mode=fragment` looks like:</span><span class="sxs-lookup"><span data-stu-id="55c4d-301">A successful response using `response_mode=fragment` looks like:</span></span>

```
GET https://localhost/myapp/#
access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&state=12345
&token_type=Bearer
&expires_in=3599
&scope=https%3A%2F%2Fgraph.windows.net%2Fdirectory.read
```

| <span data-ttu-id="55c4d-302">Parameter</span><span class="sxs-lookup"><span data-stu-id="55c4d-302">Parameter</span></span> | <span data-ttu-id="55c4d-303">Description</span><span class="sxs-lookup"><span data-stu-id="55c4d-303">Description</span></span> |
| --- | --- |
| <span data-ttu-id="55c4d-304">access_token</span><span class="sxs-lookup"><span data-stu-id="55c4d-304">access_token</span></span> |<span data-ttu-id="55c4d-305">The token that the app requested.</span><span class="sxs-lookup"><span data-stu-id="55c4d-305">The token that the app requested.</span></span> |
| <span data-ttu-id="55c4d-306">token_type</span><span class="sxs-lookup"><span data-stu-id="55c4d-306">token_type</span></span> |<span data-ttu-id="55c4d-307">Will always be `Bearer`.</span><span class="sxs-lookup"><span data-stu-id="55c4d-307">Will always be `Bearer`.</span></span> |
| <span data-ttu-id="55c4d-308">state</span><span class="sxs-lookup"><span data-stu-id="55c4d-308">state</span></span> |<span data-ttu-id="55c4d-309">If a state parameter is included in the request, the same value should appear in the response.</span><span class="sxs-lookup"><span data-stu-id="55c4d-309">If a state parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="55c4d-310">The  app should verify that the state values in the request and response are identical.</span><span class="sxs-lookup"><span data-stu-id="55c4d-310">The  app should verify that the state values in the request and response are identical.</span></span> |
| <span data-ttu-id="55c4d-311">expires_in</span><span class="sxs-lookup"><span data-stu-id="55c4d-311">expires_in</span></span> |<span data-ttu-id="55c4d-312">How long the access token is valid (in seconds).</span><span class="sxs-lookup"><span data-stu-id="55c4d-312">How long the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="55c4d-313">scope</span><span class="sxs-lookup"><span data-stu-id="55c4d-313">scope</span></span> |<span data-ttu-id="55c4d-314">The scopes that the access token is valid for.</span><span class="sxs-lookup"><span data-stu-id="55c4d-314">The scopes that the access token is valid for.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="55c4d-315">Error response</span><span class="sxs-lookup"><span data-stu-id="55c4d-315">Error response</span></span>
<span data-ttu-id="55c4d-316">Error responses may also be sent to the `redirect_uri` so the app can handle them appropriately.</span><span class="sxs-lookup"><span data-stu-id="55c4d-316">Error responses may also be sent to the `redirect_uri` so the app can handle them appropriately.</span></span>  <span data-ttu-id="55c4d-317">In the case of `prompt=none`, an expected error will be:</span><span class="sxs-lookup"><span data-stu-id="55c4d-317">In the case of `prompt=none`, an expected error will be:</span></span>

```
GET https://localhost/myapp/#
error=user_authentication_required
&error_description=the+request+could+not+be+completed+silently
```

| <span data-ttu-id="55c4d-318">Parameter</span><span class="sxs-lookup"><span data-stu-id="55c4d-318">Parameter</span></span> | <span data-ttu-id="55c4d-319">Description</span><span class="sxs-lookup"><span data-stu-id="55c4d-319">Description</span></span> |
| --- | --- |
| <span data-ttu-id="55c4d-320">error</span><span class="sxs-lookup"><span data-stu-id="55c4d-320">error</span></span> |<span data-ttu-id="55c4d-321">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span><span class="sxs-lookup"><span data-stu-id="55c4d-321">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span></span> |
| <span data-ttu-id="55c4d-322">error_description</span><span class="sxs-lookup"><span data-stu-id="55c4d-322">error_description</span></span> |<span data-ttu-id="55c4d-323">A specific error message that can help a developer identify the root cause of an authentication error.</span><span class="sxs-lookup"><span data-stu-id="55c4d-323">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |

<span data-ttu-id="55c4d-324">If you receive this error in the iframe request, the user must interactively sign in again to retrieve a new token.</span><span class="sxs-lookup"><span data-stu-id="55c4d-324">If you receive this error in the iframe request, the user must interactively sign in again to retrieve a new token.</span></span>  <span data-ttu-id="55c4d-325">You can choose to handle this case in whatever way makes sense for your application.</span><span class="sxs-lookup"><span data-stu-id="55c4d-325">You can choose to handle this case in whatever way makes sense for your application.</span></span>

## <a name="refreshing-tokens"></a><span data-ttu-id="55c4d-326">Refreshing tokens</span><span class="sxs-lookup"><span data-stu-id="55c4d-326">Refreshing tokens</span></span>
<span data-ttu-id="55c4d-327">Both `id_token`s and `access_token`s will expire after a short period of time, so your app must be prepared to refresh these tokens periodically.</span><span class="sxs-lookup"><span data-stu-id="55c4d-327">Both `id_token`s and `access_token`s will expire after a short period of time, so your app must be prepared to refresh these tokens periodically.</span></span>  <span data-ttu-id="55c4d-328">To refresh either type of token, you can perform the same hidden iframe request from above using the `prompt=none` parameter to control Azure AD's behavior.</span><span class="sxs-lookup"><span data-stu-id="55c4d-328">To refresh either type of token, you can perform the same hidden iframe request from above using the `prompt=none` parameter to control Azure AD's behavior.</span></span>  <span data-ttu-id="55c4d-329">If you want to receive a new `id_token`, be sure to use `response_type=id_token` and `scope=openid`, as well as a `nonce` parameter.</span><span class="sxs-lookup"><span data-stu-id="55c4d-329">If you want to receive a new `id_token`, be sure to use `response_type=id_token` and `scope=openid`, as well as a `nonce` parameter.</span></span>

## <a name="send-a-sign-out-request"></a><span data-ttu-id="55c4d-330">Send a sign out request</span><span class="sxs-lookup"><span data-stu-id="55c4d-330">Send a sign out request</span></span>
<span data-ttu-id="55c4d-331">The OpenIdConnect `end_session_endpoint` is not currently supported by the v2.0 endpoint.</span><span class="sxs-lookup"><span data-stu-id="55c4d-331">The OpenIdConnect `end_session_endpoint` is not currently supported by the v2.0 endpoint.</span></span> <span data-ttu-id="55c4d-332">This means your app cannot send a request to the v2.0 endpoint to end a user's session and clear cookies set by the v2.0 endpoint.</span><span class="sxs-lookup"><span data-stu-id="55c4d-332">This means your app cannot send a request to the v2.0 endpoint to end a user's session and clear cookies set by the v2.0 endpoint.</span></span>
<span data-ttu-id="55c4d-333">To sign a user out, your app can simply end its own session with the user, and leave the user's session with the v2.0 endpoint in-tact.</span><span class="sxs-lookup"><span data-stu-id="55c4d-333">To sign a user out, your app can simply end its own session with the user, and leave the user's session with the v2.0 endpoint in-tact.</span></span>  <span data-ttu-id="55c4d-334">The next time the user tries to sign in, they will see a "choose account" page, with their actively signed-in accounts listed.</span><span class="sxs-lookup"><span data-stu-id="55c4d-334">The next time the user tries to sign in, they will see a "choose account" page, with their actively signed-in accounts listed.</span></span>
<span data-ttu-id="55c4d-335">On that page, the user can choose to sign out of any account, ending the session with the v2.0 endpoint.</span><span class="sxs-lookup"><span data-stu-id="55c4d-335">On that page, the user can choose to sign out of any account, ending the session with the v2.0 endpoint.</span></span>

<!--

When you wish to sign the user out of the  app, it is not sufficient to clear your app's cookies or otherwise end the session with the user.  You must also redirect the user to the v2.0 endpoint for sign out.  If you fail to do so, the user will be able to re-authenticate to your app without entering their credentials again, because they will have a valid single sign-on session with the v2.0 endpoint.

You can simply redirect the user to the `end_session_endpoint` listed in the OpenID Connect metadata document:

```
GET https://login.microsoftonline.com/common/oauth2/v2.0/logout?
post_logout_redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
```

| Parameter | | Description |
| ----------------------- | ------------------------------- | ------------ |
| post_logout_redirect_uri | recommended | The URL which the user should be redirected to after successful logout.  If not included, the user will be shown a generic message by the v2.0 endpoint.  |

-->

