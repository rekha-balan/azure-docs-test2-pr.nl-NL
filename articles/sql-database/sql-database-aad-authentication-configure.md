---
title: Configure Azure Active Directory authentication - SQL | Microsoft Docs
description: Learn how to connect to SQL Database, Managed Instance, and SQL Data Warehouse by using Azure Active Directory Authentication - after configuring Azure AD.
services: sql-database
author: GithubMirek
manager: craigg
ms.service: sql-database
ms.prod_service: sql-database, sql-data-warehouse
ms.custom: security
ms.topic: conceptual
ms.date: 03/07/2018
ms.author: mireks
ms.reviewer: carlrab
ms.openlocfilehash: a648071d4d98f500e70557b330d5c79dba747a1f
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44819187"
---
# <a name="configure-and-manage-azure-active-directory-authentication-with-sql-database-managed-instance-or-sql-data-warehouse"></a><span data-ttu-id="dfb29-103">Configure and manage Azure Active Directory authentication with SQL Database, Managed Instance, or SQL Data Warehouse</span><span class="sxs-lookup"><span data-stu-id="dfb29-103">Configure and manage Azure Active Directory authentication with SQL Database, Managed Instance, or SQL Data Warehouse</span></span>

<span data-ttu-id="dfb29-104">This article shows you how to create and populate Azure AD, and then use Azure AD with Azure [SQL Database](sql-database-technical-overview.md) and [SQL Data Warehouse](../sql-data-warehouse/sql-data-warehouse-overview-what-is.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-104">This article shows you how to create and populate Azure AD, and then use Azure AD with Azure [SQL Database](sql-database-technical-overview.md) and [SQL Data Warehouse](../sql-data-warehouse/sql-data-warehouse-overview-what-is.md).</span></span> <span data-ttu-id="dfb29-105">For an overview, see [Azure Active Directory Authentication](sql-database-aad-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-105">For an overview, see [Azure Active Directory Authentication](sql-database-aad-authentication.md).</span></span>

> [!NOTE]
> <span data-ttu-id="dfb29-106">This topic applies to Azure SQL server, and to both SQL Database and SQL Data Warehouse databases that are created on the Azure SQL server.</span><span class="sxs-lookup"><span data-stu-id="dfb29-106">This topic applies to Azure SQL server, and to both SQL Database and SQL Data Warehouse databases that are created on the Azure SQL server.</span></span> <span data-ttu-id="dfb29-107">For simplicity, SQL Database is used when referring to both SQL Database and SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-107">For simplicity, SQL Database is used when referring to both SQL Database and SQL Data Warehouse.</span></span>

>  [!IMPORTANT]  
>  <span data-ttu-id="dfb29-108">Connecting to SQL Server running on an Azure VM is not supported using an Azure Active Directory account.</span><span class="sxs-lookup"><span data-stu-id="dfb29-108">Connecting to SQL Server running on an Azure VM is not supported using an Azure Active Directory account.</span></span> <span data-ttu-id="dfb29-109">Use a domain Active Directory account instead.</span><span class="sxs-lookup"><span data-stu-id="dfb29-109">Use a domain Active Directory account instead.</span></span>

## <a name="create-and-populate-an-azure-ad"></a><span data-ttu-id="dfb29-110">Create and populate an Azure AD</span><span class="sxs-lookup"><span data-stu-id="dfb29-110">Create and populate an Azure AD</span></span>
<span data-ttu-id="dfb29-111">Create an Azure AD and populate it with users and groups.</span><span class="sxs-lookup"><span data-stu-id="dfb29-111">Create an Azure AD and populate it with users and groups.</span></span> <span data-ttu-id="dfb29-112">Azure AD can be the initial Azure AD managed domain.</span><span class="sxs-lookup"><span data-stu-id="dfb29-112">Azure AD can be the initial Azure AD managed domain.</span></span> <span data-ttu-id="dfb29-113">Azure AD can also be an on-premises Active Directory Domain Services that is federated with the Azure AD.</span><span class="sxs-lookup"><span data-stu-id="dfb29-113">Azure AD can also be an on-premises Active Directory Domain Services that is federated with the Azure AD.</span></span>

<span data-ttu-id="dfb29-114">For more information, see [Integrating your on-premises identities with Azure Active Directory](../active-directory/active-directory-aadconnect.md), [Add your own domain name to Azure AD](../active-directory/active-directory-domains-add-azure-portal.md), [Microsoft Azure now supports federation with Windows Server Active Directory](https://azure.microsoft.com/blog/2012/11/28/windows-azure-now-supports-federation-with-windows-server-active-directory/), [Administering your Azure AD directory](../active-directory/fundamentals/active-directory-administer.md), [Manage Azure AD using Windows PowerShell](/powershell/azure/overview?view=azureadps-2.0), and [Hybrid Identity Required Ports and Protocols](..//active-directory/connect/active-directory-aadconnect-ports.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-114">For more information, see [Integrating your on-premises identities with Azure Active Directory](../active-directory/active-directory-aadconnect.md), [Add your own domain name to Azure AD](../active-directory/active-directory-domains-add-azure-portal.md), [Microsoft Azure now supports federation with Windows Server Active Directory](https://azure.microsoft.com/blog/2012/11/28/windows-azure-now-supports-federation-with-windows-server-active-directory/), [Administering your Azure AD directory](../active-directory/fundamentals/active-directory-administer.md), [Manage Azure AD using Windows PowerShell](/powershell/azure/overview?view=azureadps-2.0), and [Hybrid Identity Required Ports and Protocols](..//active-directory/connect/active-directory-aadconnect-ports.md).</span></span>

## <a name="associate-or-add-an-azure-subscription-to-azure-active-directory"></a><span data-ttu-id="dfb29-115">Associate or add an Azure subscription to Azure Active Directory</span><span class="sxs-lookup"><span data-stu-id="dfb29-115">Associate or add an Azure subscription to Azure Active Directory</span></span>

1. <span data-ttu-id="dfb29-116">Associate your Azure subscription to Azure Active Directory by making the directory a trusted directory for the Azure subscription hosting the database.</span><span class="sxs-lookup"><span data-stu-id="dfb29-116">Associate your Azure subscription to Azure Active Directory by making the directory a trusted directory for the Azure subscription hosting the database.</span></span> <span data-ttu-id="dfb29-117">For details, see [How Azure subscriptions are associated with Azure AD](../active-directory/fundamentals/active-directory-how-subscriptions-associated-directory.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-117">For details, see [How Azure subscriptions are associated with Azure AD](../active-directory/fundamentals/active-directory-how-subscriptions-associated-directory.md).</span></span>
2. <span data-ttu-id="dfb29-118">Use the directory switcher in the Azure portal to switch to the subscription associated with domain.</span><span class="sxs-lookup"><span data-stu-id="dfb29-118">Use the directory switcher in the Azure portal to switch to the subscription associated with domain.</span></span>

   <span data-ttu-id="dfb29-119">**Additional information:** Every Azure subscription has a trust relationship with an Azure AD instance.</span><span class="sxs-lookup"><span data-stu-id="dfb29-119">**Additional information:** Every Azure subscription has a trust relationship with an Azure AD instance.</span></span> <span data-ttu-id="dfb29-120">This means that it trusts that directory to authenticate users, services, and devices.</span><span class="sxs-lookup"><span data-stu-id="dfb29-120">This means that it trusts that directory to authenticate users, services, and devices.</span></span> <span data-ttu-id="dfb29-121">Multiple subscriptions can trust the same directory, but a subscription trusts only one directory.</span><span class="sxs-lookup"><span data-stu-id="dfb29-121">Multiple subscriptions can trust the same directory, but a subscription trusts only one directory.</span></span> <span data-ttu-id="dfb29-122">This trust relationship that a subscription has with a directory is unlike the relationship that a subscription has with all other resources in Azure (websites, databases, and so on), which are more like child resources of a subscription.</span><span class="sxs-lookup"><span data-stu-id="dfb29-122">This trust relationship that a subscription has with a directory is unlike the relationship that a subscription has with all other resources in Azure (websites, databases, and so on), which are more like child resources of a subscription.</span></span> <span data-ttu-id="dfb29-123">If a subscription expires, then access to those other resources associated with the subscription also stops.</span><span class="sxs-lookup"><span data-stu-id="dfb29-123">If a subscription expires, then access to those other resources associated with the subscription also stops.</span></span> <span data-ttu-id="dfb29-124">But the directory remains in Azure, and you can associate another subscription with that directory and continue to manage the directory users.</span><span class="sxs-lookup"><span data-stu-id="dfb29-124">But the directory remains in Azure, and you can associate another subscription with that directory and continue to manage the directory users.</span></span> <span data-ttu-id="dfb29-125">For more information about resources, see [Understanding resource access in Azure](../active-directory/active-directory-b2b-admin-add-users.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-125">For more information about resources, see [Understanding resource access in Azure](../active-directory/active-directory-b2b-admin-add-users.md).</span></span> <span data-ttu-id="dfb29-126">To learn more about this trusted relationship see [How to associate or add an Azure subscription to Azure Active Directory](../active-directory/fundamentals/active-directory-how-subscriptions-associated-directory.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-126">To learn more about this trusted relationship see [How to associate or add an Azure subscription to Azure Active Directory](../active-directory/fundamentals/active-directory-how-subscriptions-associated-directory.md).</span></span>

## <a name="create-an-azure-ad-administrator-for-azure-sql-server"></a><span data-ttu-id="dfb29-127">Create an Azure AD administrator for Azure SQL server</span><span class="sxs-lookup"><span data-stu-id="dfb29-127">Create an Azure AD administrator for Azure SQL server</span></span>
<span data-ttu-id="dfb29-128">Each Azure SQL server (which hosts a SQL Database or SQL Data Warehouse) starts with a single server administrator account that is the administrator of the entire Azure SQL server.</span><span class="sxs-lookup"><span data-stu-id="dfb29-128">Each Azure SQL server (which hosts a SQL Database or SQL Data Warehouse) starts with a single server administrator account that is the administrator of the entire Azure SQL server.</span></span> <span data-ttu-id="dfb29-129">A second SQL Server administrator must be created, that is an Azure AD account.</span><span class="sxs-lookup"><span data-stu-id="dfb29-129">A second SQL Server administrator must be created, that is an Azure AD account.</span></span> <span data-ttu-id="dfb29-130">This principal is created as a contained database user in the master database.</span><span class="sxs-lookup"><span data-stu-id="dfb29-130">This principal is created as a contained database user in the master database.</span></span> <span data-ttu-id="dfb29-131">As administrators, the server administrator accounts are members of the **db_owner** role in every user database, and enter each user database as the **dbo** user.</span><span class="sxs-lookup"><span data-stu-id="dfb29-131">As administrators, the server administrator accounts are members of the **db_owner** role in every user database, and enter each user database as the **dbo** user.</span></span> <span data-ttu-id="dfb29-132">For more information about the server administrator accounts, see [Managing Databases and Logins in Azure SQL Database](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-132">For more information about the server administrator accounts, see [Managing Databases and Logins in Azure SQL Database](sql-database-manage-logins.md).</span></span>

<span data-ttu-id="dfb29-133">When using Azure Active Directory with geo-replication, the Azure Active Directory administrator must be configured for both the primary and the secondary servers.</span><span class="sxs-lookup"><span data-stu-id="dfb29-133">When using Azure Active Directory with geo-replication, the Azure Active Directory administrator must be configured for both the primary and the secondary servers.</span></span> <span data-ttu-id="dfb29-134">If a server does not have an Azure Active Directory administrator, then Azure Active Directory logins and users receive a "Cannot connect" to server error.</span><span class="sxs-lookup"><span data-stu-id="dfb29-134">If a server does not have an Azure Active Directory administrator, then Azure Active Directory logins and users receive a "Cannot connect" to server error.</span></span>

> [!NOTE]
> <span data-ttu-id="dfb29-135">Users that are not based on an Azure AD account (including the Azure SQL server administrator account), cannot create Azure AD-based users, because they do not have permission to validate proposed database users with the Azure AD.</span><span class="sxs-lookup"><span data-stu-id="dfb29-135">Users that are not based on an Azure AD account (including the Azure SQL server administrator account), cannot create Azure AD-based users, because they do not have permission to validate proposed database users with the Azure AD.</span></span>
> 

## <a name="provision-an-azure-active-directory-administrator-for-your-managed-instance"></a><span data-ttu-id="dfb29-136">Provision an Azure Active Directory administrator for your Managed Instance</span><span class="sxs-lookup"><span data-stu-id="dfb29-136">Provision an Azure Active Directory administrator for your Managed Instance</span></span>

> [!IMPORTANT]
> <span data-ttu-id="dfb29-137">Only follow these steps if you are provisioning a Managed Instance.</span><span class="sxs-lookup"><span data-stu-id="dfb29-137">Only follow these steps if you are provisioning a Managed Instance.</span></span> <span data-ttu-id="dfb29-138">This operation can only be executed by Global/Company administrator in Azure AD.</span><span class="sxs-lookup"><span data-stu-id="dfb29-138">This operation can only be executed by Global/Company administrator in Azure AD.</span></span> <span data-ttu-id="dfb29-139">Following steps describe the process of granting permissions for users with different privileges in directory.</span><span class="sxs-lookup"><span data-stu-id="dfb29-139">Following steps describe the process of granting permissions for users with different privileges in directory.</span></span>

<span data-ttu-id="dfb29-140">Your Managed Instance needs permissions to read Azure AD to successfully accomplish tasks such as authentication of users through security group membership or creation of new users.</span><span class="sxs-lookup"><span data-stu-id="dfb29-140">Your Managed Instance needs permissions to read Azure AD to successfully accomplish tasks such as authentication of users through security group membership or creation of new users.</span></span> <span data-ttu-id="dfb29-141">For this to work, you need to grant permissions to Managed Instance to read Azure AD.</span><span class="sxs-lookup"><span data-stu-id="dfb29-141">For this to work, you need to grant permissions to Managed Instance to read Azure AD.</span></span> <span data-ttu-id="dfb29-142">There are two ways to do it: from Portal and PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dfb29-142">There are two ways to do it: from Portal and PowerShell.</span></span> <span data-ttu-id="dfb29-143">The following steps both methods.</span><span class="sxs-lookup"><span data-stu-id="dfb29-143">The following steps both methods.</span></span>

1. <span data-ttu-id="dfb29-144">In the Azure portal, in the upper-right corner, select your connection to drop down a list of possible Active Directories.</span><span class="sxs-lookup"><span data-stu-id="dfb29-144">In the Azure portal, in the upper-right corner, select your connection to drop down a list of possible Active Directories.</span></span> 
2. <span data-ttu-id="dfb29-145">Choose the correct Active Directory as the default Azure AD.</span><span class="sxs-lookup"><span data-stu-id="dfb29-145">Choose the correct Active Directory as the default Azure AD.</span></span> 

   <span data-ttu-id="dfb29-146">This step links the subscription associated with Active Directory with Managed Instance making sure that the same subscription is used for both Azure AD and the Managed Instance.</span><span class="sxs-lookup"><span data-stu-id="dfb29-146">This step links the subscription associated with Active Directory with Managed Instance making sure that the same subscription is used for both Azure AD and the Managed Instance.</span></span>
3. <span data-ttu-id="dfb29-147">Navigate to Managed Instance and select one that you want to use for Azure AD integration.</span><span class="sxs-lookup"><span data-stu-id="dfb29-147">Navigate to Managed Instance and select one that you want to use for Azure AD integration.</span></span>

   ![aad](./media/sql-database-aad-authentication/aad.png)

4.  <span data-ttu-id="dfb29-149">Select on banner on top of Active Directory admin page.</span><span class="sxs-lookup"><span data-stu-id="dfb29-149">Select on banner on top of Active Directory admin page.</span></span> <span data-ttu-id="dfb29-150">If you are logged in as Global/Company administrator in Azure AD, you can do it from Azure portal or using PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dfb29-150">If you are logged in as Global/Company administrator in Azure AD, you can do it from Azure portal or using PowerShell.</span></span>

    ![grant permissions-portal](./media/sql-database-aad-authentication/grant-permissions.png)

    ![grant permissions-powershell](./media/sql-database-aad-authentication/grant-permissions-powershell.png)
    
    <span data-ttu-id="dfb29-153">If you are logged in as Global/Company administrator in Azure AD, you can do it from the Azure portal or execute a PowerShell script.</span><span class="sxs-lookup"><span data-stu-id="dfb29-153">If you are logged in as Global/Company administrator in Azure AD, you can do it from the Azure portal or execute a PowerShell script.</span></span>

5. <span data-ttu-id="dfb29-154">After operation is successfully completed, following notification will show up in top right corner:</span><span class="sxs-lookup"><span data-stu-id="dfb29-154">After operation is successfully completed, following notification will show up in top right corner:</span></span>

    ![success](./media/sql-database-aad-authentication/success.png)

6.  <span data-ttu-id="dfb29-156">Now you can choose your Azure AD admin for your Managed Instance.</span><span class="sxs-lookup"><span data-stu-id="dfb29-156">Now you can choose your Azure AD admin for your Managed Instance.</span></span> <span data-ttu-id="dfb29-157">For that, on the Active Directory admin page, select **Set admin** command.</span><span class="sxs-lookup"><span data-stu-id="dfb29-157">For that, on the Active Directory admin page, select **Set admin** command.</span></span>

    ![set-admin](./media/sql-database-aad-authentication/set-admin.png)

7. <span data-ttu-id="dfb29-159">In the Add admin page, search for a user, select the user or group to be an administrator, and then select **Select**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-159">In the Add admin page, search for a user, select the user or group to be an administrator, and then select **Select**.</span></span> 

   <span data-ttu-id="dfb29-160">The Active Directory admin page shows all members and groups of your Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfb29-160">The Active Directory admin page shows all members and groups of your Active Directory.</span></span> <span data-ttu-id="dfb29-161">Users or groups that are grayed out cannot be selected because they are not supported as Azure AD administrators.</span><span class="sxs-lookup"><span data-stu-id="dfb29-161">Users or groups that are grayed out cannot be selected because they are not supported as Azure AD administrators.</span></span> <span data-ttu-id="dfb29-162">See the list of supported admins in [Azure AD Features and Limitations](sql-database-aad-authentication.md#azure-ad-features-and-limitations).</span><span class="sxs-lookup"><span data-stu-id="dfb29-162">See the list of supported admins in [Azure AD Features and Limitations](sql-database-aad-authentication.md#azure-ad-features-and-limitations).</span></span> <span data-ttu-id="dfb29-163">Role-based access control (RBAC) applies only to the Azure portal and is not propagated to SQL Server.</span><span class="sxs-lookup"><span data-stu-id="dfb29-163">Role-based access control (RBAC) applies only to the Azure portal and is not propagated to SQL Server.</span></span>

    ![add-admin](./media/sql-database-aad-authentication/add-admin.png)

8. <span data-ttu-id="dfb29-165">At the top of the Active Directory admin page, select **Save**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-165">At the top of the Active Directory admin page, select **Save**.</span></span>

    ![save](./media/sql-database-aad-authentication/save.png)

    <span data-ttu-id="dfb29-167">The process of changing the administrator may take several minutes.</span><span class="sxs-lookup"><span data-stu-id="dfb29-167">The process of changing the administrator may take several minutes.</span></span> <span data-ttu-id="dfb29-168">Then the new administrator appears in the Active Directory admin box.</span><span class="sxs-lookup"><span data-stu-id="dfb29-168">Then the new administrator appears in the Active Directory admin box.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="dfb29-169">When setting up the Azure AD admin, the new admin name (user or group) cannot already be present in the virtual master database as a SQL Server authentication user.</span><span class="sxs-lookup"><span data-stu-id="dfb29-169">When setting up the Azure AD admin, the new admin name (user or group) cannot already be present in the virtual master database as a SQL Server authentication user.</span></span> <span data-ttu-id="dfb29-170">If present, the Azure AD admin setup will fail and rolling back its creation, indicating that such an admin (name) already exists.</span><span class="sxs-lookup"><span data-stu-id="dfb29-170">If present, the Azure AD admin setup will fail and rolling back its creation, indicating that such an admin (name) already exists.</span></span> <span data-ttu-id="dfb29-171">Since such a SQL Server authentication user is not part of the Azure AD, any effort to connect to the server using Azure AD authentication fails.</span><span class="sxs-lookup"><span data-stu-id="dfb29-171">Since such a SQL Server authentication user is not part of the Azure AD, any effort to connect to the server using Azure AD authentication fails.</span></span>

> [!TIP]
> <span data-ttu-id="dfb29-172">To later remove an Admin, at the top of the Active Directory admin page, select **Remove admin**, and then select **Save**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-172">To later remove an Admin, at the top of the Active Directory admin page, select **Remove admin**, and then select **Save**.</span></span>
 
## <a name="provision-an-azure-active-directory-administrator-for-your-azure-sql-database-server"></a><span data-ttu-id="dfb29-173">Provision an Azure Active Directory administrator for your Azure SQL Database server</span><span class="sxs-lookup"><span data-stu-id="dfb29-173">Provision an Azure Active Directory administrator for your Azure SQL Database server</span></span>

> [!IMPORTANT]
> <span data-ttu-id="dfb29-174">Only follow these steps if you are provisioning an Azure SQL Database server or Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-174">Only follow these steps if you are provisioning an Azure SQL Database server or Data Warehouse.</span></span>

<span data-ttu-id="dfb29-175">The following two procedures show you how to provision an Azure Active Directory administrator for your Azure SQL server in the Azure portal and by using PowerShell.</span><span class="sxs-lookup"><span data-stu-id="dfb29-175">The following two procedures show you how to provision an Azure Active Directory administrator for your Azure SQL server in the Azure portal and by using PowerShell.</span></span>

### <a name="azure-portal"></a><span data-ttu-id="dfb29-176">Azure portal</span><span class="sxs-lookup"><span data-stu-id="dfb29-176">Azure portal</span></span>
1. <span data-ttu-id="dfb29-177">In the [Azure portal](https://portal.azure.com/), in the upper-right corner, select your connection to drop down a list of possible Active Directories.</span><span class="sxs-lookup"><span data-stu-id="dfb29-177">In the [Azure portal](https://portal.azure.com/), in the upper-right corner, select your connection to drop down a list of possible Active Directories.</span></span> <span data-ttu-id="dfb29-178">Choose the correct Active Directory as the default Azure AD.</span><span class="sxs-lookup"><span data-stu-id="dfb29-178">Choose the correct Active Directory as the default Azure AD.</span></span> <span data-ttu-id="dfb29-179">This step links the subscription-associated Active Directory with Azure SQL server making sure that the same subscription is used for both Azure AD and SQL Server.</span><span class="sxs-lookup"><span data-stu-id="dfb29-179">This step links the subscription-associated Active Directory with Azure SQL server making sure that the same subscription is used for both Azure AD and SQL Server.</span></span> <span data-ttu-id="dfb29-180">(The Azure SQL server can be hosting either Azure SQL Database or Azure SQL Data Warehouse.)</span><span class="sxs-lookup"><span data-stu-id="dfb29-180">(The Azure SQL server can be hosting either Azure SQL Database or Azure SQL Data Warehouse.)</span></span>   
    <span data-ttu-id="dfb29-181">![choose-ad][8]</span><span class="sxs-lookup"><span data-stu-id="dfb29-181">![choose-ad][8]</span></span>   
    
2. <span data-ttu-id="dfb29-182">In the left banner select **All services**, and in the filter type in **SQL server**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-182">In the left banner select **All services**, and in the filter type in **SQL server**.</span></span> <span data-ttu-id="dfb29-183">Select **Sql Servers**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-183">Select **Sql Servers**.</span></span> 

    ![sqlservers.png](media/sql-database-aad-authentication/sqlservers.png)    

    >[!NOTE]
    > <span data-ttu-id="dfb29-185">On this page, before you select **SQL servers**, you can select the **star** next to the name to *favorite* the category and add **SQL servers** to the left navigation bar.</span><span class="sxs-lookup"><span data-stu-id="dfb29-185">On this page, before you select **SQL servers**, you can select the **star** next to the name to *favorite* the category and add **SQL servers** to the left navigation bar.</span></span> 

1. <span data-ttu-id="dfb29-186">On **SQL Server** page, select **Active Directory admin**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-186">On **SQL Server** page, select **Active Directory admin**.</span></span>   
2. <span data-ttu-id="dfb29-187">In the **Active Directory admin** page, select **Set admin**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-187">In the **Active Directory admin** page, select **Set admin**.</span></span>   
    <span data-ttu-id="dfb29-188">![select active directory](./media/sql-database-aad-authentication/select-active-directory.png)</span><span class="sxs-lookup"><span data-stu-id="dfb29-188">![select active directory](./media/sql-database-aad-authentication/select-active-directory.png)</span></span>  
    
4. <span data-ttu-id="dfb29-189">In the **Add admin** page, search for a user, select the user or group to be an administrator, and then select **Select**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-189">In the **Add admin** page, search for a user, select the user or group to be an administrator, and then select **Select**.</span></span> <span data-ttu-id="dfb29-190">(The Active Directory admin page shows all members and groups of your Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfb29-190">(The Active Directory admin page shows all members and groups of your Active Directory.</span></span> <span data-ttu-id="dfb29-191">Users or groups that are grayed out cannot be selected because they are not supported as Azure AD administrators.</span><span class="sxs-lookup"><span data-stu-id="dfb29-191">Users or groups that are grayed out cannot be selected because they are not supported as Azure AD administrators.</span></span> <span data-ttu-id="dfb29-192">(See the list of supported admins in the **Azure AD Features and Limitations** section of [Use Azure Active Directory Authentication for authentication with SQL Database or SQL Data Warehouse](sql-database-aad-authentication.md).) Role-based access control (RBAC) applies only to the portal and is not propagated to SQL Server.</span><span class="sxs-lookup"><span data-stu-id="dfb29-192">(See the list of supported admins in the **Azure AD Features and Limitations** section of [Use Azure Active Directory Authentication for authentication with SQL Database or SQL Data Warehouse](sql-database-aad-authentication.md).) Role-based access control (RBAC) applies only to the portal and is not propagated to SQL Server.</span></span>   
    <span data-ttu-id="dfb29-193">![select admin](./media/sql-database-aad-authentication/select-admin.png)</span><span class="sxs-lookup"><span data-stu-id="dfb29-193">![select admin](./media/sql-database-aad-authentication/select-admin.png)</span></span>  
    
5. <span data-ttu-id="dfb29-194">At the top of the **Active Directory admin** page, select **SAVE**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-194">At the top of the **Active Directory admin** page, select **SAVE**.</span></span>   
    <span data-ttu-id="dfb29-195">![save admin](./media/sql-database-aad-authentication/save-admin.png)</span><span class="sxs-lookup"><span data-stu-id="dfb29-195">![save admin](./media/sql-database-aad-authentication/save-admin.png)</span></span>   

<span data-ttu-id="dfb29-196">The process of changing the administrator may take several minutes.</span><span class="sxs-lookup"><span data-stu-id="dfb29-196">The process of changing the administrator may take several minutes.</span></span> <span data-ttu-id="dfb29-197">Then the new administrator appears in the **Active Directory admin** box.</span><span class="sxs-lookup"><span data-stu-id="dfb29-197">Then the new administrator appears in the **Active Directory admin** box.</span></span>

   > [!NOTE]
   > <span data-ttu-id="dfb29-198">When setting up the Azure AD admin, the new admin name (user or group) cannot already be present in the virtual master database as a SQL Server authentication user.</span><span class="sxs-lookup"><span data-stu-id="dfb29-198">When setting up the Azure AD admin, the new admin name (user or group) cannot already be present in the virtual master database as a SQL Server authentication user.</span></span> <span data-ttu-id="dfb29-199">If present, the Azure AD admin setup will fail; rolling back its creation and indicating that such an admin (name) already exists.</span><span class="sxs-lookup"><span data-stu-id="dfb29-199">If present, the Azure AD admin setup will fail; rolling back its creation and indicating that such an admin (name) already exists.</span></span> <span data-ttu-id="dfb29-200">Since such a SQL Server authentication user is not part of the Azure AD, any effort to connect to the server using Azure AD authentication fails.</span><span class="sxs-lookup"><span data-stu-id="dfb29-200">Since such a SQL Server authentication user is not part of the Azure AD, any effort to connect to the server using Azure AD authentication fails.</span></span>
   > 


<span data-ttu-id="dfb29-201">To later remove an Admin, at the top of the **Active Directory admin** page, select **Remove admin**, and then select **Save**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-201">To later remove an Admin, at the top of the **Active Directory admin** page, select **Remove admin**, and then select **Save**.</span></span>

### <a name="powershell"></a><span data-ttu-id="dfb29-202">PowerShell</span><span class="sxs-lookup"><span data-stu-id="dfb29-202">PowerShell</span></span>
<span data-ttu-id="dfb29-203">To run PowerShell cmdlets, you need to have Azure PowerShell installed and running.</span><span class="sxs-lookup"><span data-stu-id="dfb29-203">To run PowerShell cmdlets, you need to have Azure PowerShell installed and running.</span></span> <span data-ttu-id="dfb29-204">For detailed information, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span><span class="sxs-lookup"><span data-stu-id="dfb29-204">For detailed information, see [How to install and configure Azure PowerShell](/powershell/azure/overview).</span></span>

<span data-ttu-id="dfb29-205">To provision an Azure AD admin, execute the following Azure PowerShell commands:</span><span class="sxs-lookup"><span data-stu-id="dfb29-205">To provision an Azure AD admin, execute the following Azure PowerShell commands:</span></span>

* <span data-ttu-id="dfb29-206">Connect-AzureRmAccount</span><span class="sxs-lookup"><span data-stu-id="dfb29-206">Connect-AzureRmAccount</span></span>
* <span data-ttu-id="dfb29-207">Select-AzureRmSubscription</span><span class="sxs-lookup"><span data-stu-id="dfb29-207">Select-AzureRmSubscription</span></span>

<span data-ttu-id="dfb29-208">Cmdlets used to provision and manage Azure AD admin:</span><span class="sxs-lookup"><span data-stu-id="dfb29-208">Cmdlets used to provision and manage Azure AD admin:</span></span>

| <span data-ttu-id="dfb29-209">Cmdlet name</span><span class="sxs-lookup"><span data-stu-id="dfb29-209">Cmdlet name</span></span> | <span data-ttu-id="dfb29-210">Description</span><span class="sxs-lookup"><span data-stu-id="dfb29-210">Description</span></span> |
| --- | --- |
| [<span data-ttu-id="dfb29-211">Set-AzureRmSqlServerActiveDirectoryAdministrator</span><span class="sxs-lookup"><span data-stu-id="dfb29-211">Set-AzureRmSqlServerActiveDirectoryAdministrator</span></span>](/powershell/module/azurerm.sql/set-azurermsqlserveractivedirectoryadministrator) |<span data-ttu-id="dfb29-212">Provisions an Azure Active Directory administrator for Azure SQL server or Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-212">Provisions an Azure Active Directory administrator for Azure SQL server or Azure SQL Data Warehouse.</span></span> <span data-ttu-id="dfb29-213">(Must be from the current subscription.)</span><span class="sxs-lookup"><span data-stu-id="dfb29-213">(Must be from the current subscription.)</span></span> |
| [<span data-ttu-id="dfb29-214">Remove-AzureRmSqlServerActiveDirectoryAdministrator</span><span class="sxs-lookup"><span data-stu-id="dfb29-214">Remove-AzureRmSqlServerActiveDirectoryAdministrator</span></span>](/powershell/module/azurerm.sql/remove-azurermsqlserveractivedirectoryadministrator) |<span data-ttu-id="dfb29-215">Removes an Azure Active Directory administrator for Azure SQL server or Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-215">Removes an Azure Active Directory administrator for Azure SQL server or Azure SQL Data Warehouse.</span></span> |
| [<span data-ttu-id="dfb29-216">Get-AzureRmSqlServerActiveDirectoryAdministrator</span><span class="sxs-lookup"><span data-stu-id="dfb29-216">Get-AzureRmSqlServerActiveDirectoryAdministrator</span></span>](/powershell/module/azurerm.sql/get-azurermsqlserveractivedirectoryadministrator) |<span data-ttu-id="dfb29-217">Returns information about an Azure Active Directory administrator currently configured for the Azure SQL server or Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-217">Returns information about an Azure Active Directory administrator currently configured for the Azure SQL server or Azure SQL Data Warehouse.</span></span> |

<span data-ttu-id="dfb29-218">Use PowerShell command get-help to see more information for each of these commands, for example ``get-help Set-AzureRmSqlServerActiveDirectoryAdministrator``.</span><span class="sxs-lookup"><span data-stu-id="dfb29-218">Use PowerShell command get-help to see more information for each of these commands, for example ``get-help Set-AzureRmSqlServerActiveDirectoryAdministrator``.</span></span>

<span data-ttu-id="dfb29-219">The following script provisions an Azure AD administrator group named **DBA_Group** (object id `40b79501-b343-44ed-9ce7-da4c8cc7353f`) for the **demo_server** server in a resource group named **Group-23**:</span><span class="sxs-lookup"><span data-stu-id="dfb29-219">The following script provisions an Azure AD administrator group named **DBA_Group** (object id `40b79501-b343-44ed-9ce7-da4c8cc7353f`) for the **demo_server** server in a resource group named **Group-23**:</span></span>

```
Set-AzureRmSqlServerActiveDirectoryAdministrator -ResourceGroupName "Group-23"
-ServerName "demo_server" -DisplayName "DBA_Group"
```

<span data-ttu-id="dfb29-220">The **DisplayName** input parameter accepts either the Azure AD display name or the User Principal Name.</span><span class="sxs-lookup"><span data-stu-id="dfb29-220">The **DisplayName** input parameter accepts either the Azure AD display name or the User Principal Name.</span></span> <span data-ttu-id="dfb29-221">For example, ``DisplayName="John Smith"`` and ``DisplayName="johns@contoso.com"``.</span><span class="sxs-lookup"><span data-stu-id="dfb29-221">For example, ``DisplayName="John Smith"`` and ``DisplayName="johns@contoso.com"``.</span></span> <span data-ttu-id="dfb29-222">For Azure AD groups only the Azure AD display name is supported.</span><span class="sxs-lookup"><span data-stu-id="dfb29-222">For Azure AD groups only the Azure AD display name is supported.</span></span>

> [!NOTE]
> <span data-ttu-id="dfb29-223">The Azure PowerShell  command ```Set-AzureRmSqlServerActiveDirectoryAdministrator``` does not prevent you from provisioning Azure AD admins for unsupported users.</span><span class="sxs-lookup"><span data-stu-id="dfb29-223">The Azure PowerShell  command ```Set-AzureRmSqlServerActiveDirectoryAdministrator``` does not prevent you from provisioning Azure AD admins for unsupported users.</span></span> <span data-ttu-id="dfb29-224">An unsupported user can be provisioned, but can not connect to a database.</span><span class="sxs-lookup"><span data-stu-id="dfb29-224">An unsupported user can be provisioned, but can not connect to a database.</span></span> 
> 

<span data-ttu-id="dfb29-225">The following example uses the optional **ObjectID**:</span><span class="sxs-lookup"><span data-stu-id="dfb29-225">The following example uses the optional **ObjectID**:</span></span>

```
Set-AzureRmSqlServerActiveDirectoryAdministrator -ResourceGroupName "Group-23"
-ServerName "demo_server" -DisplayName "DBA_Group" -ObjectId "40b79501-b343-44ed-9ce7-da4c8cc7353f"
```

> [!NOTE]
> <span data-ttu-id="dfb29-226">The Azure AD **ObjectID** is required when the **DisplayName** is not unique.</span><span class="sxs-lookup"><span data-stu-id="dfb29-226">The Azure AD **ObjectID** is required when the **DisplayName** is not unique.</span></span> <span data-ttu-id="dfb29-227">To retrieve the **ObjectID** and **DisplayName** values, use the Active Directory section of Azure Classic Portal, and view the properties of a user or group.</span><span class="sxs-lookup"><span data-stu-id="dfb29-227">To retrieve the **ObjectID** and **DisplayName** values, use the Active Directory section of Azure Classic Portal, and view the properties of a user or group.</span></span>
> 

<span data-ttu-id="dfb29-228">The following example returns information about the current Azure AD admin for Azure SQL server:</span><span class="sxs-lookup"><span data-stu-id="dfb29-228">The following example returns information about the current Azure AD admin for Azure SQL server:</span></span>

```
Get-AzureRmSqlServerActiveDirectoryAdministrator -ResourceGroupName "Group-23" -ServerName "demo_server" | Format-List
```

<span data-ttu-id="dfb29-229">The following example removes an Azure AD administrator:</span><span class="sxs-lookup"><span data-stu-id="dfb29-229">The following example removes an Azure AD administrator:</span></span>

```
Remove-AzureRmSqlServerActiveDirectoryAdministrator -ResourceGroupName "Group-23" -ServerName "demo_server"
```

<span data-ttu-id="dfb29-230">You can also provision an Azure Active Directory Administrator by using the REST APIs.</span><span class="sxs-lookup"><span data-stu-id="dfb29-230">You can also provision an Azure Active Directory Administrator by using the REST APIs.</span></span> <span data-ttu-id="dfb29-231">For more information, see [Service Management REST API Reference and Operations for Azure SQL Databases Operations for Azure SQL Databases](https://msdn.microsoft.com/library/azure/dn505719.aspx)</span><span class="sxs-lookup"><span data-stu-id="dfb29-231">For more information, see [Service Management REST API Reference and Operations for Azure SQL Databases Operations for Azure SQL Databases](https://msdn.microsoft.com/library/azure/dn505719.aspx)</span></span>

### <a name="cli"></a><span data-ttu-id="dfb29-232">CLI</span><span class="sxs-lookup"><span data-stu-id="dfb29-232">CLI</span></span>  
<span data-ttu-id="dfb29-233">You can also provision an Azure AD admin by calling the following CLI commands:</span><span class="sxs-lookup"><span data-stu-id="dfb29-233">You can also provision an Azure AD admin by calling the following CLI commands:</span></span>
| <span data-ttu-id="dfb29-234">Command</span><span class="sxs-lookup"><span data-stu-id="dfb29-234">Command</span></span> | <span data-ttu-id="dfb29-235">Description</span><span class="sxs-lookup"><span data-stu-id="dfb29-235">Description</span></span> |
| --- | --- |
|[<span data-ttu-id="dfb29-236">az sql server ad-admin create</span><span class="sxs-lookup"><span data-stu-id="dfb29-236">az sql server ad-admin create</span></span>](https://docs.microsoft.com/cli/azure/sql/server/ad-admin#az_sql_server_ad_admin_create) |<span data-ttu-id="dfb29-237">Provisions an Azure Active Directory administrator for Azure SQL server or Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-237">Provisions an Azure Active Directory administrator for Azure SQL server or Azure SQL Data Warehouse.</span></span> <span data-ttu-id="dfb29-238">(Must be from the current subscription.)</span><span class="sxs-lookup"><span data-stu-id="dfb29-238">(Must be from the current subscription.)</span></span> |
|[<span data-ttu-id="dfb29-239">az sql server ad-admin delete</span><span class="sxs-lookup"><span data-stu-id="dfb29-239">az sql server ad-admin delete</span></span>](https://docs.microsoft.com/cli/azure/sql/server/ad-admin#az_sql_server_ad_admin_delete) |<span data-ttu-id="dfb29-240">Removes an Azure Active Directory administrator for Azure SQL server or Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-240">Removes an Azure Active Directory administrator for Azure SQL server or Azure SQL Data Warehouse.</span></span> |
|[<span data-ttu-id="dfb29-241">az sql server ad-admin list</span><span class="sxs-lookup"><span data-stu-id="dfb29-241">az sql server ad-admin list</span></span>](https://docs.microsoft.com/cli/azure/sql/server/ad-admin#az_sql_server_ad_admin_list) |<span data-ttu-id="dfb29-242">Returns information about an Azure Active Directory administrator currently configured for the Azure SQL server or Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-242">Returns information about an Azure Active Directory administrator currently configured for the Azure SQL server or Azure SQL Data Warehouse.</span></span> |
|[<span data-ttu-id="dfb29-243">az sql server ad-admin update</span><span class="sxs-lookup"><span data-stu-id="dfb29-243">az sql server ad-admin update</span></span>](https://docs.microsoft.com/cli/azure/sql/server/ad-admin#az_sql_server_ad_admin_update) |<span data-ttu-id="dfb29-244">Updates the Active Directory administrator for an Azure SQL server or Azure SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-244">Updates the Active Directory administrator for an Azure SQL server or Azure SQL Data Warehouse.</span></span> |

<span data-ttu-id="dfb29-245">For more information about CLI commands, see [SQL - az sql](https://docs.microsoft.com/cli/azure/sql/server).</span><span class="sxs-lookup"><span data-stu-id="dfb29-245">For more information about CLI commands, see [SQL - az sql](https://docs.microsoft.com/cli/azure/sql/server).</span></span>  


## <a name="configure-your-client-computers"></a><span data-ttu-id="dfb29-246">Configure your client computers</span><span class="sxs-lookup"><span data-stu-id="dfb29-246">Configure your client computers</span></span>
<span data-ttu-id="dfb29-247">On all client machines, from which your applications or users connect to Azure SQL Database or Azure SQL Data Warehouse using Azure AD identities, you must install the following software:</span><span class="sxs-lookup"><span data-stu-id="dfb29-247">On all client machines, from which your applications or users connect to Azure SQL Database or Azure SQL Data Warehouse using Azure AD identities, you must install the following software:</span></span>

* <span data-ttu-id="dfb29-248">.NET Framework 4.6 or later from [https://msdn.microsoft.com/library/5a4x27ek.aspx](https://msdn.microsoft.com/library/5a4x27ek.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfb29-248">.NET Framework 4.6 or later from [https://msdn.microsoft.com/library/5a4x27ek.aspx](https://msdn.microsoft.com/library/5a4x27ek.aspx).</span></span>
* <span data-ttu-id="dfb29-249">Azure Active Directory Authentication Library for SQL Server (**ADALSQL.DLL**) is available in multiple languages (both x86 and amd64) from the download center at [Microsoft Active Directory Authentication Library for Microsoft SQL Server](http://www.microsoft.com/download/details.aspx?id=48742).</span><span class="sxs-lookup"><span data-stu-id="dfb29-249">Azure Active Directory Authentication Library for SQL Server (**ADALSQL.DLL**) is available in multiple languages (both x86 and amd64) from the download center at [Microsoft Active Directory Authentication Library for Microsoft SQL Server](http://www.microsoft.com/download/details.aspx?id=48742).</span></span>

<span data-ttu-id="dfb29-250">You can meet these requirements by:</span><span class="sxs-lookup"><span data-stu-id="dfb29-250">You can meet these requirements by:</span></span>

* <span data-ttu-id="dfb29-251">Installing either [SQL Server 2016 Management Studio](https://msdn.microsoft.com/library/mt238290.aspx) or [SQL Server Data Tools for Visual Studio 2015](https://msdn.microsoft.com/library/mt204009.aspx) meets the .NET Framework 4.6 requirement.</span><span class="sxs-lookup"><span data-stu-id="dfb29-251">Installing either [SQL Server 2016 Management Studio](https://msdn.microsoft.com/library/mt238290.aspx) or [SQL Server Data Tools for Visual Studio 2015](https://msdn.microsoft.com/library/mt204009.aspx) meets the .NET Framework 4.6 requirement.</span></span>
* <span data-ttu-id="dfb29-252">SSMS installs the x86 version of **ADALSQL.DLL**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-252">SSMS installs the x86 version of **ADALSQL.DLL**.</span></span>
* <span data-ttu-id="dfb29-253">SSDT installs the amd64 version of **ADALSQL.DLL**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-253">SSDT installs the amd64 version of **ADALSQL.DLL**.</span></span>
* <span data-ttu-id="dfb29-254">The latest Visual Studio from [Visual Studio Downloads](https://www.visualstudio.com/downloads/download-visual-studio-vs) meets the .NET Framework 4.6 requirement, but does not install the required amd64 version of **ADALSQL.DLL**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-254">The latest Visual Studio from [Visual Studio Downloads](https://www.visualstudio.com/downloads/download-visual-studio-vs) meets the .NET Framework 4.6 requirement, but does not install the required amd64 version of **ADALSQL.DLL**.</span></span>

## <a name="create-contained-database-users-in-your-database-mapped-to-azure-ad-identities"></a><span data-ttu-id="dfb29-255">Create contained database users in your database mapped to Azure AD identities</span><span class="sxs-lookup"><span data-stu-id="dfb29-255">Create contained database users in your database mapped to Azure AD identities</span></span>

<span data-ttu-id="dfb29-256">Azure Active Directory authentication requires database users to be created as contained database users.</span><span class="sxs-lookup"><span data-stu-id="dfb29-256">Azure Active Directory authentication requires database users to be created as contained database users.</span></span> <span data-ttu-id="dfb29-257">A contained database user based on an Azure AD identity, is a database user that does not have a login in the master database, and which maps to an identity in the Azure AD directory that is associated with the database.</span><span class="sxs-lookup"><span data-stu-id="dfb29-257">A contained database user based on an Azure AD identity, is a database user that does not have a login in the master database, and which maps to an identity in the Azure AD directory that is associated with the database.</span></span> <span data-ttu-id="dfb29-258">The Azure AD identity can be either an individual user account or a group.</span><span class="sxs-lookup"><span data-stu-id="dfb29-258">The Azure AD identity can be either an individual user account or a group.</span></span> <span data-ttu-id="dfb29-259">For more information about contained database users, see [Contained Database Users- Making Your Database Portable](https://msdn.microsoft.com/library/ff929188.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfb29-259">For more information about contained database users, see [Contained Database Users- Making Your Database Portable](https://msdn.microsoft.com/library/ff929188.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="dfb29-260">Database users (with the exception of administrators) cannot be created using the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="dfb29-260">Database users (with the exception of administrators) cannot be created using the Azure portal.</span></span> <span data-ttu-id="dfb29-261">RBAC roles are not propagated to SQL Server, SQL Database, or SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-261">RBAC roles are not propagated to SQL Server, SQL Database, or SQL Data Warehouse.</span></span> <span data-ttu-id="dfb29-262">Azure RBAC roles are used for managing Azure Resources, and do not apply to database permissions.</span><span class="sxs-lookup"><span data-stu-id="dfb29-262">Azure RBAC roles are used for managing Azure Resources, and do not apply to database permissions.</span></span> <span data-ttu-id="dfb29-263">For example, the **SQL Server Contributor** role does not grant access to connect to the SQL Database or SQL Data Warehouse.</span><span class="sxs-lookup"><span data-stu-id="dfb29-263">For example, the **SQL Server Contributor** role does not grant access to connect to the SQL Database or SQL Data Warehouse.</span></span> <span data-ttu-id="dfb29-264">The access permission must be granted directly in the database using Transact-SQL statements.</span><span class="sxs-lookup"><span data-stu-id="dfb29-264">The access permission must be granted directly in the database using Transact-SQL statements.</span></span>
>

<span data-ttu-id="dfb29-265">To create an Azure AD-based contained database user (other than the server administrator that owns the database), connect to the database with an Azure AD identity, as a user with at least the **ALTER ANY USER** permission.</span><span class="sxs-lookup"><span data-stu-id="dfb29-265">To create an Azure AD-based contained database user (other than the server administrator that owns the database), connect to the database with an Azure AD identity, as a user with at least the **ALTER ANY USER** permission.</span></span> <span data-ttu-id="dfb29-266">Then use the following Transact-SQL syntax:</span><span class="sxs-lookup"><span data-stu-id="dfb29-266">Then use the following Transact-SQL syntax:</span></span>

```
CREATE USER <Azure_AD_principal_name> FROM EXTERNAL PROVIDER;
```

<span data-ttu-id="dfb29-267">*Azure_AD_principal_name* can be the user principal name of an Azure AD user or the display name for an Azure AD group.</span><span class="sxs-lookup"><span data-stu-id="dfb29-267">*Azure_AD_principal_name* can be the user principal name of an Azure AD user or the display name for an Azure AD group.</span></span>

<span data-ttu-id="dfb29-268">**Examples:** To create a contained database user representing an Azure AD federated or managed domain user:</span><span class="sxs-lookup"><span data-stu-id="dfb29-268">**Examples:** To create a contained database user representing an Azure AD federated or managed domain user:</span></span>
```
CREATE USER [bob@contoso.com] FROM EXTERNAL PROVIDER;
CREATE USER [alice@fabrikam.onmicrosoft.com] FROM EXTERNAL PROVIDER;
```

<span data-ttu-id="dfb29-269">To create a contained database user representing an Azure AD or federated domain group, provide the display name of a security group:</span><span class="sxs-lookup"><span data-stu-id="dfb29-269">To create a contained database user representing an Azure AD or federated domain group, provide the display name of a security group:</span></span>
```
CREATE USER [ICU Nurses] FROM EXTERNAL PROVIDER;
```

<span data-ttu-id="dfb29-270">To create a contained database user representing an application that connects using an Azure AD token:</span><span class="sxs-lookup"><span data-stu-id="dfb29-270">To create a contained database user representing an application that connects using an Azure AD token:</span></span>

```
CREATE USER [appName] FROM EXTERNAL PROVIDER;
```

>  [!TIP]
>  <span data-ttu-id="dfb29-271">You cannot directly create a user from an Azure Active Directory other than the Azure Active Directory that is associated with your Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="dfb29-271">You cannot directly create a user from an Azure Active Directory other than the Azure Active Directory that is associated with your Azure subscription.</span></span> <span data-ttu-id="dfb29-272">However, members of other Active Directories that are imported users in the associated Active Directory (known as external users) can be added to an Active Directory group in the tenant Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfb29-272">However, members of other Active Directories that are imported users in the associated Active Directory (known as external users) can be added to an Active Directory group in the tenant Active Directory.</span></span> <span data-ttu-id="dfb29-273">By creating a contained database user for that AD group, the users from the external Active Directory can gain access to SQL Database.</span><span class="sxs-lookup"><span data-stu-id="dfb29-273">By creating a contained database user for that AD group, the users from the external Active Directory can gain access to SQL Database.</span></span>   

<span data-ttu-id="dfb29-274">For more information about creating contained database users based on Azure Active Directory identities, see [CREATE USER (Transact-SQL)](http://msdn.microsoft.com/library/ms173463.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfb29-274">For more information about creating contained database users based on Azure Active Directory identities, see [CREATE USER (Transact-SQL)](http://msdn.microsoft.com/library/ms173463.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="dfb29-275">Removing the Azure Active Directory administrator for Azure SQL server prevents any Azure AD authentication user from connecting to the server.</span><span class="sxs-lookup"><span data-stu-id="dfb29-275">Removing the Azure Active Directory administrator for Azure SQL server prevents any Azure AD authentication user from connecting to the server.</span></span> <span data-ttu-id="dfb29-276">If necessary, unusable Azure AD users can be dropped manually by a SQL Database administrator.</span><span class="sxs-lookup"><span data-stu-id="dfb29-276">If necessary, unusable Azure AD users can be dropped manually by a SQL Database administrator.</span></span>   

>  [!NOTE]
>  <span data-ttu-id="dfb29-277">If you receive a **Connection Timeout Expired**, you may need to set the `TransparentNetworkIPResolution` parameter of the connection string to false.</span><span class="sxs-lookup"><span data-stu-id="dfb29-277">If you receive a **Connection Timeout Expired**, you may need to set the `TransparentNetworkIPResolution` parameter of the connection string to false.</span></span> <span data-ttu-id="dfb29-278">For more information, see [Connection timeout issue with .NET Framework 4.6.1 - TransparentNetworkIPResolution](https://blogs.msdn.microsoft.com/dataaccesstechnologies/2016/05/07/connection-timeout-issue-with-net-framework-4-6-1-transparentnetworkipresolution/).</span><span class="sxs-lookup"><span data-stu-id="dfb29-278">For more information, see [Connection timeout issue with .NET Framework 4.6.1 - TransparentNetworkIPResolution](https://blogs.msdn.microsoft.com/dataaccesstechnologies/2016/05/07/connection-timeout-issue-with-net-framework-4-6-1-transparentnetworkipresolution/).</span></span>   

   
<span data-ttu-id="dfb29-279">When you create a database user, that user receives the **CONNECT** permission and can connect to that database as a member of the **PUBLIC** role.</span><span class="sxs-lookup"><span data-stu-id="dfb29-279">When you create a database user, that user receives the **CONNECT** permission and can connect to that database as a member of the **PUBLIC** role.</span></span> <span data-ttu-id="dfb29-280">Initially the only permissions available to the user are any permissions granted to the **PUBLIC** role, or any permissions granted to any Azure AD groups that they are a member of.</span><span class="sxs-lookup"><span data-stu-id="dfb29-280">Initially the only permissions available to the user are any permissions granted to the **PUBLIC** role, or any permissions granted to any Azure AD groups that they are a member of.</span></span> <span data-ttu-id="dfb29-281">Once you provision an Azure AD-based contained database user, you can grant the user additional permissions, the same way as you grant permission to any other type of user.</span><span class="sxs-lookup"><span data-stu-id="dfb29-281">Once you provision an Azure AD-based contained database user, you can grant the user additional permissions, the same way as you grant permission to any other type of user.</span></span> <span data-ttu-id="dfb29-282">Typically grant permissions to database roles, and add users to roles.</span><span class="sxs-lookup"><span data-stu-id="dfb29-282">Typically grant permissions to database roles, and add users to roles.</span></span> <span data-ttu-id="dfb29-283">For more information, see [Database Engine Permission Basics](http://social.technet.microsoft.com/wiki/contents/articles/4433.database-engine-permission-basics.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfb29-283">For more information, see [Database Engine Permission Basics](http://social.technet.microsoft.com/wiki/contents/articles/4433.database-engine-permission-basics.aspx).</span></span> <span data-ttu-id="dfb29-284">For more information about special SQL Database roles, see [Managing Databases and Logins in Azure SQL Database](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-284">For more information about special SQL Database roles, see [Managing Databases and Logins in Azure SQL Database](sql-database-manage-logins.md).</span></span>
<span data-ttu-id="dfb29-285">A federated domain user account that is imported into a managed domain as an external user, must use the managed domain identity.</span><span class="sxs-lookup"><span data-stu-id="dfb29-285">A federated domain user account that is imported into a managed domain as an external user, must use the managed domain identity.</span></span>

> [!NOTE]
> <span data-ttu-id="dfb29-286">Azure AD users are marked in the database metadata with type E (EXTERNAL_USER) and for groups with type X (EXTERNAL_GROUPS).</span><span class="sxs-lookup"><span data-stu-id="dfb29-286">Azure AD users are marked in the database metadata with type E (EXTERNAL_USER) and for groups with type X (EXTERNAL_GROUPS).</span></span> <span data-ttu-id="dfb29-287">For more information, see [sys.database_principals](https://msdn.microsoft.com/library/ms187328.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfb29-287">For more information, see [sys.database_principals](https://msdn.microsoft.com/library/ms187328.aspx).</span></span> 
>

## <a name="connect-to-the-user-database-or-data-warehouse-by-using-ssms-or-ssdt"></a><span data-ttu-id="dfb29-288">Connect to the user database or data warehouse by using SSMS or SSDT</span><span class="sxs-lookup"><span data-stu-id="dfb29-288">Connect to the user database or data warehouse by using SSMS or SSDT</span></span>  
<span data-ttu-id="dfb29-289">To confirm the Azure AD administrator is properly set up, connect to the **master** database using the Azure AD administrator account.</span><span class="sxs-lookup"><span data-stu-id="dfb29-289">To confirm the Azure AD administrator is properly set up, connect to the **master** database using the Azure AD administrator account.</span></span>
<span data-ttu-id="dfb29-290">To provision an Azure AD-based contained database user (other than the server administrator that owns the database), connect to the database with an Azure AD identity that has access to the database.</span><span class="sxs-lookup"><span data-stu-id="dfb29-290">To provision an Azure AD-based contained database user (other than the server administrator that owns the database), connect to the database with an Azure AD identity that has access to the database.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="dfb29-291">Support for Azure Active Directory authentication is available with [SQL Server 2016 Management Studio](https://msdn.microsoft.com/library/mt238290.aspx) and [SQL Server Data Tools](https://msdn.microsoft.com/library/mt204009.aspx) in Visual Studio 2015.</span><span class="sxs-lookup"><span data-stu-id="dfb29-291">Support for Azure Active Directory authentication is available with [SQL Server 2016 Management Studio](https://msdn.microsoft.com/library/mt238290.aspx) and [SQL Server Data Tools](https://msdn.microsoft.com/library/mt204009.aspx) in Visual Studio 2015.</span></span> <span data-ttu-id="dfb29-292">The August 2016 release of SSMS also includes support for Active Directory Universal Authentication, which allows administrators to require Multi-Factor Authentication using a phone call, text message, smart cards with pin, or mobile app notification.</span><span class="sxs-lookup"><span data-stu-id="dfb29-292">The August 2016 release of SSMS also includes support for Active Directory Universal Authentication, which allows administrators to require Multi-Factor Authentication using a phone call, text message, smart cards with pin, or mobile app notification.</span></span>
 
## <a name="using-an-azure-ad-identity-to-connect-using-ssms-or-ssdt"></a><span data-ttu-id="dfb29-293">Using an Azure AD identity to connect using SSMS or SSDT</span><span class="sxs-lookup"><span data-stu-id="dfb29-293">Using an Azure AD identity to connect using SSMS or SSDT</span></span>  

<span data-ttu-id="dfb29-294">The following procedures show you how to connect to a SQL database with an Azure AD identity using SQL Server Management Studio or SQL Server Database Tools.</span><span class="sxs-lookup"><span data-stu-id="dfb29-294">The following procedures show you how to connect to a SQL database with an Azure AD identity using SQL Server Management Studio or SQL Server Database Tools.</span></span>

### <a name="active-directory-integrated-authentication"></a><span data-ttu-id="dfb29-295">Active Directory integrated authentication</span><span class="sxs-lookup"><span data-stu-id="dfb29-295">Active Directory integrated authentication</span></span>

<span data-ttu-id="dfb29-296">Use this method if you are logged in to Windows using your Azure Active Directory credentials from a federated domain.</span><span class="sxs-lookup"><span data-stu-id="dfb29-296">Use this method if you are logged in to Windows using your Azure Active Directory credentials from a federated domain.</span></span>

1. <span data-ttu-id="dfb29-297">Start Management Studio or Data Tools and in the **Connect to Server** (or **Connect to Database Engine**) dialog box, in the **Authentication** box, select **Active Directory - Integrated**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-297">Start Management Studio or Data Tools and in the **Connect to Server** (or **Connect to Database Engine**) dialog box, in the **Authentication** box, select **Active Directory - Integrated**.</span></span> <span data-ttu-id="dfb29-298">No password is needed or can be entered because your existing credentials will be presented for the connection.</span><span class="sxs-lookup"><span data-stu-id="dfb29-298">No password is needed or can be entered because your existing credentials will be presented for the connection.</span></span>   

    ![Select AD Integrated Authentication][11]
2. <span data-ttu-id="dfb29-300">Select the **Options** button, and on the **Connection Properties** page, in the **Connect to database** box, type the name of the user database you want to connect to.</span><span class="sxs-lookup"><span data-stu-id="dfb29-300">Select the **Options** button, and on the **Connection Properties** page, in the **Connect to database** box, type the name of the user database you want to connect to.</span></span> <span data-ttu-id="dfb29-301">(The **AD domain name or tenant ID** option is only supported for **Universal with MFA connection** options, otherwise it is greyed out.)</span><span class="sxs-lookup"><span data-stu-id="dfb29-301">(The **AD domain name or tenant ID** option is only supported for **Universal with MFA connection** options, otherwise it is greyed out.)</span></span>  

    ![Select the database name][13]

## <a name="active-directory-password-authentication"></a><span data-ttu-id="dfb29-303">Active Directory password authentication</span><span class="sxs-lookup"><span data-stu-id="dfb29-303">Active Directory password authentication</span></span>

<span data-ttu-id="dfb29-304">Use this method when connecting with an Azure AD principal name using the Azure AD managed domain.</span><span class="sxs-lookup"><span data-stu-id="dfb29-304">Use this method when connecting with an Azure AD principal name using the Azure AD managed domain.</span></span> <span data-ttu-id="dfb29-305">You can also use it for federated accounts without access to the domain, for example when working remotely.</span><span class="sxs-lookup"><span data-stu-id="dfb29-305">You can also use it for federated accounts without access to the domain, for example when working remotely.</span></span>

<span data-ttu-id="dfb29-306">Use this method to authenticate to SQL DB/DW with Azure AD  for native of federated Azure AD users.</span><span class="sxs-lookup"><span data-stu-id="dfb29-306">Use this method to authenticate to SQL DB/DW with Azure AD  for native of federated Azure AD users.</span></span>
<span data-ttu-id="dfb29-307">A native user is one explicitly created in Azure AD and being authenticated using user name and password, while a federated user is a Windows user whose domain is federated with Azure AD.</span><span class="sxs-lookup"><span data-stu-id="dfb29-307">A native user is one explicitly created in Azure AD and being authenticated using user name and password, while a federated user is a Windows user whose domain is federated with Azure AD.</span></span> <span data-ttu-id="dfb29-308">The latter method (using user & password) can be used when a user wants to use his windows credential, but his local machine is not joined with the domain ( i.e. using a remote access).</span><span class="sxs-lookup"><span data-stu-id="dfb29-308">The latter method (using user & password) can be used when a user wants to use his windows credential, but his local machine is not joined with the domain ( i.e. using a remote access).</span></span> <span data-ttu-id="dfb29-309">In this case a Windows user can indicate his domain account and password and can authenticate to SQL DB/DW using  federated credentials.</span><span class="sxs-lookup"><span data-stu-id="dfb29-309">In this case a Windows user can indicate his domain account and password and can authenticate to SQL DB/DW using  federated credentials.</span></span>

1. <span data-ttu-id="dfb29-310">Start Management Studio or Data Tools and in the **Connect to Server** (or **Connect to Database Engine**) dialog box, in the **Authentication** box, select **Active Directory - Password**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-310">Start Management Studio or Data Tools and in the **Connect to Server** (or **Connect to Database Engine**) dialog box, in the **Authentication** box, select **Active Directory - Password**.</span></span>
2. <span data-ttu-id="dfb29-311">In the **User name** box, type your Azure Active Directory user name in the format **username@domain.com**.</span><span class="sxs-lookup"><span data-stu-id="dfb29-311">In the **User name** box, type your Azure Active Directory user name in the format **username@domain.com**.</span></span> <span data-ttu-id="dfb29-312">This must be an account from the Azure Active Directory or an account from a domain federate with the Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfb29-312">This must be an account from the Azure Active Directory or an account from a domain federate with the Azure Active Directory.</span></span>
3. <span data-ttu-id="dfb29-313">In the **Password** box, type your user password for the Azure Active Directory account or federated domain account.</span><span class="sxs-lookup"><span data-stu-id="dfb29-313">In the **Password** box, type your user password for the Azure Active Directory account or federated domain account.</span></span>

    ![Select AD Password Authentication][12]
4. <span data-ttu-id="dfb29-315">Select the **Options** button, and on the **Connection Properties** page, in the **Connect to database** box, type the name of the user database you want to connect to.</span><span class="sxs-lookup"><span data-stu-id="dfb29-315">Select the **Options** button, and on the **Connection Properties** page, in the **Connect to database** box, type the name of the user database you want to connect to.</span></span> <span data-ttu-id="dfb29-316">(See the graphic in the previous option.)</span><span class="sxs-lookup"><span data-stu-id="dfb29-316">(See the graphic in the previous option.)</span></span>

## <a name="using-an-azure-ad-identity-to-connect-from-a-client-application"></a><span data-ttu-id="dfb29-317">Using an Azure AD identity to connect from a client application</span><span class="sxs-lookup"><span data-stu-id="dfb29-317">Using an Azure AD identity to connect from a client application</span></span>

<span data-ttu-id="dfb29-318">The following procedures show you how to connect to a SQL database with an Azure AD identity from a client application.</span><span class="sxs-lookup"><span data-stu-id="dfb29-318">The following procedures show you how to connect to a SQL database with an Azure AD identity from a client application.</span></span>

###  <a name="active-directory-integrated-authentication"></a><span data-ttu-id="dfb29-319">Active Directory integrated authentication</span><span class="sxs-lookup"><span data-stu-id="dfb29-319">Active Directory integrated authentication</span></span>

<span data-ttu-id="dfb29-320">To use integrated Windows authentication, your domains Active Directory must be federated with Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="dfb29-320">To use integrated Windows authentication, your domains Active Directory must be federated with Azure Active Directory.</span></span> <span data-ttu-id="dfb29-321">Your client application (or a service) connecting to the database must be running on a domain-joined machine under a users domain credentials.</span><span class="sxs-lookup"><span data-stu-id="dfb29-321">Your client application (or a service) connecting to the database must be running on a domain-joined machine under a users domain credentials.</span></span>

<span data-ttu-id="dfb29-322">To connect to a database using integrated authentication and an Azure AD identity, the Authentication keyword in the database connection string must be set to Active Directory Integrated.</span><span class="sxs-lookup"><span data-stu-id="dfb29-322">To connect to a database using integrated authentication and an Azure AD identity, the Authentication keyword in the database connection string must be set to Active Directory Integrated.</span></span> <span data-ttu-id="dfb29-323">The following C# code sample uses ADO .NET.</span><span class="sxs-lookup"><span data-stu-id="dfb29-323">The following C# code sample uses ADO .NET.</span></span>

```
string ConnectionString =
@"Data Source=n9lxnyuzhv.database.windows.net; Authentication=Active Directory Integrated; Initial Catalog=testdb;";
SqlConnection conn = new SqlConnection(ConnectionString);
conn.Open();
```

<span data-ttu-id="dfb29-324">The connection string keyword ``Integrated Security=True`` is not supported for connecting to Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="dfb29-324">The connection string keyword ``Integrated Security=True`` is not supported for connecting to Azure SQL Database.</span></span> <span data-ttu-id="dfb29-325">When making an ODBC connection, you will need to remove spaces and set Authentication to 'ActiveDirectoryIntegrated'.</span><span class="sxs-lookup"><span data-stu-id="dfb29-325">When making an ODBC connection, you will need to remove spaces and set Authentication to 'ActiveDirectoryIntegrated'.</span></span>

### <a name="active-directory-password-authentication"></a><span data-ttu-id="dfb29-326">Active Directory password authentication</span><span class="sxs-lookup"><span data-stu-id="dfb29-326">Active Directory password authentication</span></span>

<span data-ttu-id="dfb29-327">To connect to a database using integrated authentication and an Azure AD identity, the Authentication keyword must be set to Active Directory Password.</span><span class="sxs-lookup"><span data-stu-id="dfb29-327">To connect to a database using integrated authentication and an Azure AD identity, the Authentication keyword must be set to Active Directory Password.</span></span> <span data-ttu-id="dfb29-328">The connection string must contain User ID/UID and Password/PWD keywords and values.</span><span class="sxs-lookup"><span data-stu-id="dfb29-328">The connection string must contain User ID/UID and Password/PWD keywords and values.</span></span> <span data-ttu-id="dfb29-329">The following C# code sample uses ADO .NET.</span><span class="sxs-lookup"><span data-stu-id="dfb29-329">The following C# code sample uses ADO .NET.</span></span>

```
string ConnectionString =
@"Data Source=n9lxnyuzhv.database.windows.net; Authentication=Active Directory Password; Initial Catalog=testdb;  UID=bob@contoso.onmicrosoft.com; PWD=MyPassWord!";
SqlConnection conn = new SqlConnection(ConnectionString);
conn.Open();
```

<span data-ttu-id="dfb29-330">Learn more about Azure AD authentication methods using the demo code samples available at [Azure AD Authentication GitHub Demo](https://github.com/Microsoft/sql-server-samples/tree/master/samples/features/security/azure-active-directory-auth).</span><span class="sxs-lookup"><span data-stu-id="dfb29-330">Learn more about Azure AD authentication methods using the demo code samples available at [Azure AD Authentication GitHub Demo](https://github.com/Microsoft/sql-server-samples/tree/master/samples/features/security/azure-active-directory-auth).</span></span>

## <a name="azure-ad-token"></a><span data-ttu-id="dfb29-331">Azure AD token</span><span class="sxs-lookup"><span data-stu-id="dfb29-331">Azure AD token</span></span>
<span data-ttu-id="dfb29-332">This authentication method allows middle-tier services to connect to Azure SQL Database or Azure SQL Data Warehouse by obtaining a token from Azure Active Directory (AAD).</span><span class="sxs-lookup"><span data-stu-id="dfb29-332">This authentication method allows middle-tier services to connect to Azure SQL Database or Azure SQL Data Warehouse by obtaining a token from Azure Active Directory (AAD).</span></span> <span data-ttu-id="dfb29-333">It enables sophisticated scenarios including certificate-based authentication.</span><span class="sxs-lookup"><span data-stu-id="dfb29-333">It enables sophisticated scenarios including certificate-based authentication.</span></span> <span data-ttu-id="dfb29-334">You must complete four basic steps to use Azure AD token authentication:</span><span class="sxs-lookup"><span data-stu-id="dfb29-334">You must complete four basic steps to use Azure AD token authentication:</span></span>

1. <span data-ttu-id="dfb29-335">Register your application with Azure Active Directory and get the client id for your code.</span><span class="sxs-lookup"><span data-stu-id="dfb29-335">Register your application with Azure Active Directory and get the client id for your code.</span></span> 
2. <span data-ttu-id="dfb29-336">Create a database user representing the application.</span><span class="sxs-lookup"><span data-stu-id="dfb29-336">Create a database user representing the application.</span></span> <span data-ttu-id="dfb29-337">(Completed earlier in step 6.)</span><span class="sxs-lookup"><span data-stu-id="dfb29-337">(Completed earlier in step 6.)</span></span>
3. <span data-ttu-id="dfb29-338">Create a certificate on the client computer runs the application.</span><span class="sxs-lookup"><span data-stu-id="dfb29-338">Create a certificate on the client computer runs the application.</span></span>
4. <span data-ttu-id="dfb29-339">Add the certificate as a key for your application.</span><span class="sxs-lookup"><span data-stu-id="dfb29-339">Add the certificate as a key for your application.</span></span>

<span data-ttu-id="dfb29-340">Sample connection string:</span><span class="sxs-lookup"><span data-stu-id="dfb29-340">Sample connection string:</span></span>

```
string ConnectionString =@"Data Source=n9lxnyuzhv.database.windows.net; Initial Catalog=testdb;"
SqlConnection conn = new SqlConnection(ConnectionString);
connection.AccessToken = "Your JWT token"
conn.Open();
```

<span data-ttu-id="dfb29-341">For more information, see [SQL Server Security Blog](https://blogs.msdn.microsoft.com/sqlsecurity/2016/02/09/token-based-authentication-support-for-azure-sql-db-using-azure-ad-auth/).</span><span class="sxs-lookup"><span data-stu-id="dfb29-341">For more information, see [SQL Server Security Blog](https://blogs.msdn.microsoft.com/sqlsecurity/2016/02/09/token-based-authentication-support-for-azure-sql-db-using-azure-ad-auth/).</span></span> <span data-ttu-id="dfb29-342">For information about adding a certificate, see [Get started with certificate-based authentication in Azure Active Directory](../active-directory/authentication/active-directory-certificate-based-authentication-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-342">For information about adding a certificate, see [Get started with certificate-based authentication in Azure Active Directory](../active-directory/authentication/active-directory-certificate-based-authentication-get-started.md).</span></span>

### <a name="sqlcmd"></a><span data-ttu-id="dfb29-343">sqlcmd</span><span class="sxs-lookup"><span data-stu-id="dfb29-343">sqlcmd</span></span>

<span data-ttu-id="dfb29-344">The following statements, connect using version 13.1 of sqlcmd, which is available from the [Download Center](http://go.microsoft.com/fwlink/?LinkID=825643).</span><span class="sxs-lookup"><span data-stu-id="dfb29-344">The following statements, connect using version 13.1 of sqlcmd, which is available from the [Download Center](http://go.microsoft.com/fwlink/?LinkID=825643).</span></span>

```
sqlcmd -S Target_DB_or_DW.testsrv.database.windows.net  -G  
sqlcmd -S Target_DB_or_DW.testsrv.database.windows.net -U bob@contoso.com -P MyAADPassword -G -l 30
```

## <a name="next-steps"></a><span data-ttu-id="dfb29-345">Next steps</span><span class="sxs-lookup"><span data-stu-id="dfb29-345">Next steps</span></span>
- <span data-ttu-id="dfb29-346">For an overview of access and control in SQL Database, see [SQL Database access and control](sql-database-control-access.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-346">For an overview of access and control in SQL Database, see [SQL Database access and control](sql-database-control-access.md).</span></span>
- <span data-ttu-id="dfb29-347">For an overview of logins, users, and database roles in SQL Database, see [Logins, users, and database roles](sql-database-manage-logins.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-347">For an overview of logins, users, and database roles in SQL Database, see [Logins, users, and database roles](sql-database-manage-logins.md).</span></span>
- <span data-ttu-id="dfb29-348">For more information about database principals, see [Principals](https://msdn.microsoft.com/library/ms181127.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfb29-348">For more information about database principals, see [Principals](https://msdn.microsoft.com/library/ms181127.aspx).</span></span>
- <span data-ttu-id="dfb29-349">For more information about database roles, see [Database roles](https://msdn.microsoft.com/library/ms189121.aspx).</span><span class="sxs-lookup"><span data-stu-id="dfb29-349">For more information about database roles, see [Database roles](https://msdn.microsoft.com/library/ms189121.aspx).</span></span>
- <span data-ttu-id="dfb29-350">For more information about firewall rules in SQL Database, see [SQL Database firewall rules](sql-database-firewall-configure.md).</span><span class="sxs-lookup"><span data-stu-id="dfb29-350">For more information about firewall rules in SQL Database, see [SQL Database firewall rules](sql-database-firewall-configure.md).</span></span>

<!--Image references-->

[1]: ./media/sql-database-aad-authentication/1aad-auth-diagram.png
[2]: ./media/sql-database-aad-authentication/2subscription-relationship.png
[3]: ./media/sql-database-aad-authentication/3admin-structure.png
[4]: ./media/sql-database-aad-authentication/4select-subscription.png
[5]: ./media/sql-database-aad-authentication/5ad-settings-portal.png
[6]: ./media/sql-database-aad-authentication/6edit-directory-select.png
[7]: ./media/sql-database-aad-authentication/7edit-directory-confirm.png
[8]: ./media/sql-database-aad-authentication/8choose-ad.png
[10]: ./media/sql-database-aad-authentication/10choose-admin.png
[11]: ./media/sql-database-aad-authentication/active-directory-integrated.png
[12]: ./media/sql-database-aad-authentication/12connect-using-pw-auth2.png
[13]: ./media/sql-database-aad-authentication/13connect-to-db2.png

