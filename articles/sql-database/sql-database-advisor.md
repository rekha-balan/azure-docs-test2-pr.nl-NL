---
title: Query performance tuning recommendations - Azure SQL Database | Microsoft Docs
description: The Azure SQL Database Advisor provides recommendations for your existing SQL Databases that can improve current query performance.
services: sql-database
documentationcenter: ''
author: stevestein
manager: jhubbard
editor: monicar
ms.assetid: 1db441ff-58f5-45da-8d38-b54dc2aa6145
ms.service: sql-database
ms.custom: monitor and tune
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: data-management
ms.date: 09/30/2016
ms.author: sstein
ms.openlocfilehash: a8d0b08abc7e3c688f9ab79499b3459b33f06848
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44661527"
---
# <a name="sql-database-advisor"></a><span data-ttu-id="e989b-103">SQL Database Advisor</span><span class="sxs-lookup"><span data-stu-id="e989b-103">SQL Database Advisor</span></span>

<span data-ttu-id="e989b-104">Azure SQL Database learns and adapts with your application and provides customized recommendations enabling you to maximize the performance of your SQL databases.</span><span class="sxs-lookup"><span data-stu-id="e989b-104">Azure SQL Database learns and adapts with your application and provides customized recommendations enabling you to maximize the performance of your SQL databases.</span></span> <span data-ttu-id="e989b-105">The SQL Database Advisor provides recommendations for creating and dropping indexes, parameterizing queries, and fixing schema issues.</span><span class="sxs-lookup"><span data-stu-id="e989b-105">The SQL Database Advisor provides recommendations for creating and dropping indexes, parameterizing queries, and fixing schema issues.</span></span> <span data-ttu-id="e989b-106">The advisor assesses performance by analyzing your SQL database's usage history.</span><span class="sxs-lookup"><span data-stu-id="e989b-106">The advisor assesses performance by analyzing your SQL database's usage history.</span></span> <span data-ttu-id="e989b-107">The recommendations that are best suited for running your database’s typical workload are recommended.</span><span class="sxs-lookup"><span data-stu-id="e989b-107">The recommendations that are best suited for running your database’s typical workload are recommended.</span></span> 

<span data-ttu-id="e989b-108">The following recommendations are available for Azure SQL Database servers.</span><span class="sxs-lookup"><span data-stu-id="e989b-108">The following recommendations are available for Azure SQL Database servers.</span></span> <span data-ttu-id="e989b-109">Currently you can set the create and drop index recommendations to be applied automatically, see [Automatic index management](sql-database-advisor-portal.md#enable-automatic-index-management) for details.</span><span class="sxs-lookup"><span data-stu-id="e989b-109">Currently you can set the create and drop index recommendations to be applied automatically, see [Automatic index management](sql-database-advisor-portal.md#enable-automatic-index-management) for details.</span></span>

## <a name="create-index-recommendations"></a><span data-ttu-id="e989b-110">Create Index recommendations</span><span class="sxs-lookup"><span data-stu-id="e989b-110">Create Index recommendations</span></span>
<span data-ttu-id="e989b-111">**Create Index** recommendations appear when the SQL Database service detects a missing index that if created, can benefit your databases workload (non-clustered indexes only).</span><span class="sxs-lookup"><span data-stu-id="e989b-111">**Create Index** recommendations appear when the SQL Database service detects a missing index that if created, can benefit your databases workload (non-clustered indexes only).</span></span>

## <a name="drop-index-recommendations"></a><span data-ttu-id="e989b-112">Drop Index recommendations</span><span class="sxs-lookup"><span data-stu-id="e989b-112">Drop Index recommendations</span></span>
<span data-ttu-id="e989b-113">**Drop Index** recommendations appear when the SQL Database service detects duplicate indexes (currently in preview and applies to duplicate indexes only).</span><span class="sxs-lookup"><span data-stu-id="e989b-113">**Drop Index** recommendations appear when the SQL Database service detects duplicate indexes (currently in preview and applies to duplicate indexes only).</span></span>

## <a name="parameterize-queries-recommendations"></a><span data-ttu-id="e989b-114">Parameterize queries recommendations</span><span class="sxs-lookup"><span data-stu-id="e989b-114">Parameterize queries recommendations</span></span>
<span data-ttu-id="e989b-115">**Parameterize queries** recommendations appear when you have one or more queries that are constantly being recompiled but end up with the same query execution plan.</span><span class="sxs-lookup"><span data-stu-id="e989b-115">**Parameterize queries** recommendations appear when you have one or more queries that are constantly being recompiled but end up with the same query execution plan.</span></span> <span data-ttu-id="e989b-116">This condition opens up an opportunity to apply forced parameterization, which will allow query plans to be cached and reused in the future improving performance and reducing resource usage.</span><span class="sxs-lookup"><span data-stu-id="e989b-116">This condition opens up an opportunity to apply forced parameterization, which will allow query plans to be cached and reused in the future improving performance and reducing resource usage.</span></span> 

<span data-ttu-id="e989b-117">Every query issued against SQL Server initially needs to be compiled to generate an execution plan.</span><span class="sxs-lookup"><span data-stu-id="e989b-117">Every query issued against SQL Server initially needs to be compiled to generate an execution plan.</span></span> <span data-ttu-id="e989b-118">Each generated plan is added to the plan cache and subsequent executions of the same query can reuse this plan from the cache, eliminating the need for additional compilation.</span><span class="sxs-lookup"><span data-stu-id="e989b-118">Each generated plan is added to the plan cache and subsequent executions of the same query can reuse this plan from the cache, eliminating the need for additional compilation.</span></span> 

<span data-ttu-id="e989b-119">Applications that send queries, which include non-parameterized values, can lead to a performance overhead, where for every such query with different parameter values the execution plan is compiled again.</span><span class="sxs-lookup"><span data-stu-id="e989b-119">Applications that send queries, which include non-parameterized values, can lead to a performance overhead, where for every such query with different parameter values the execution plan is compiled again.</span></span> <span data-ttu-id="e989b-120">In many cases the same queries with different parameter values generate the same execution plans, but these plans are still separately added to the plan cache.</span><span class="sxs-lookup"><span data-stu-id="e989b-120">In many cases the same queries with different parameter values generate the same execution plans, but these plans are still separately added to the plan cache.</span></span> <span data-ttu-id="e989b-121">Recompiling execution plans use database resources, increase the query duration time and overflow the plan cache causing plans to be evicted from the cache.</span><span class="sxs-lookup"><span data-stu-id="e989b-121">Recompiling execution plans use database resources, increase the query duration time and overflow the plan cache causing plans to be evicted from the cache.</span></span> <span data-ttu-id="e989b-122">This behavior of SQL Server can be altered by setting the forced parameterization option on the database.</span><span class="sxs-lookup"><span data-stu-id="e989b-122">This behavior of SQL Server can be altered by setting the forced parameterization option on the database.</span></span> 

<span data-ttu-id="e989b-123">To help you estimate the impact of this recommendation, you are provided with a comparison between the actual CPU usage and the projected CPU usage (as if the recommendation was applied).</span><span class="sxs-lookup"><span data-stu-id="e989b-123">To help you estimate the impact of this recommendation, you are provided with a comparison between the actual CPU usage and the projected CPU usage (as if the recommendation was applied).</span></span> <span data-ttu-id="e989b-124">In addition to CPU savings, your query duration decreases for the time spent in compilation.</span><span class="sxs-lookup"><span data-stu-id="e989b-124">In addition to CPU savings, your query duration decreases for the time spent in compilation.</span></span> <span data-ttu-id="e989b-125">There will also be much less overhead on plan cache, allowing majority of the plans to stay in cache and be reused.</span><span class="sxs-lookup"><span data-stu-id="e989b-125">There will also be much less overhead on plan cache, allowing majority of the plans to stay in cache and be reused.</span></span> <span data-ttu-id="e989b-126">You can apply this recommendation quickly and easily by clicking on the **Apply** command.</span><span class="sxs-lookup"><span data-stu-id="e989b-126">You can apply this recommendation quickly and easily by clicking on the **Apply** command.</span></span> 

<span data-ttu-id="e989b-127">Once you apply this recommendation, it will enable forced parameterization within minutes on your database and it starts the monitoring process which approximately lasts for 24 hours.</span><span class="sxs-lookup"><span data-stu-id="e989b-127">Once you apply this recommendation, it will enable forced parameterization within minutes on your database and it starts the monitoring process which approximately lasts for 24 hours.</span></span> <span data-ttu-id="e989b-128">After this period, you will be able to see the validation report that shows CPU usage of your database 24 hours before and after the recommendation has been applied.</span><span class="sxs-lookup"><span data-stu-id="e989b-128">After this period, you will be able to see the validation report that shows CPU usage of your database 24 hours before and after the recommendation has been applied.</span></span> <span data-ttu-id="e989b-129">SQL Database Advisor has a safety mechanism that automatically reverts the applied recommendation in case a performance regression has been detected.</span><span class="sxs-lookup"><span data-stu-id="e989b-129">SQL Database Advisor has a safety mechanism that automatically reverts the applied recommendation in case a performance regression has been detected.</span></span>

## <a name="fix-schema-issues-recommendations"></a><span data-ttu-id="e989b-130">Fix schema issues recommendations</span><span class="sxs-lookup"><span data-stu-id="e989b-130">Fix schema issues recommendations</span></span>
<span data-ttu-id="e989b-131">**Fix schema issues** recommendations appear when the SQL Database service notices an anomaly in the number of schema-related SQL errors happening on your Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="e989b-131">**Fix schema issues** recommendations appear when the SQL Database service notices an anomaly in the number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="e989b-132">This recommendation typically appears when your database encounters multiple schema-related errors (invalid column name, invalid object name, etc.) within an hour.</span><span class="sxs-lookup"><span data-stu-id="e989b-132">This recommendation typically appears when your database encounters multiple schema-related errors (invalid column name, invalid object name, etc.) within an hour.</span></span>

<span data-ttu-id="e989b-133">“Schema issues” are a class of syntax errors in SQL Server that happen when the definition of the SQL query and the definition of the database schema are not aligned.</span><span class="sxs-lookup"><span data-stu-id="e989b-133">“Schema issues” are a class of syntax errors in SQL Server that happen when the definition of the SQL query and the definition of the database schema are not aligned.</span></span> <span data-ttu-id="e989b-134">For example, one of the columns expected by the query may be missing in the target table, or vice versa.</span><span class="sxs-lookup"><span data-stu-id="e989b-134">For example, one of the columns expected by the query may be missing in the target table, or vice versa.</span></span> 

<span data-ttu-id="e989b-135">“Fix schema issue” recommendation appears when Azure SQL Database service notices an anomaly in the number of schema-related SQL errors happening on your Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="e989b-135">“Fix schema issue” recommendation appears when Azure SQL Database service notices an anomaly in the number of schema-related SQL errors happening on your Azure SQL Database.</span></span> <span data-ttu-id="e989b-136">The following table shows the errors that are related to schema issues:</span><span class="sxs-lookup"><span data-stu-id="e989b-136">The following table shows the errors that are related to schema issues:</span></span>

| <span data-ttu-id="e989b-137">SQL Error Code</span><span class="sxs-lookup"><span data-stu-id="e989b-137">SQL Error Code</span></span> | <span data-ttu-id="e989b-138">Message</span><span class="sxs-lookup"><span data-stu-id="e989b-138">Message</span></span> |
| --- | --- |
| <span data-ttu-id="e989b-139">201</span><span class="sxs-lookup"><span data-stu-id="e989b-139">201</span></span> |<span data-ttu-id="e989b-140">Procedure or function '*' expects parameter '*', which was not supplied.</span><span class="sxs-lookup"><span data-stu-id="e989b-140">Procedure or function '*' expects parameter '*', which was not supplied.</span></span> |
| <span data-ttu-id="e989b-141">207</span><span class="sxs-lookup"><span data-stu-id="e989b-141">207</span></span> |<span data-ttu-id="e989b-142">Invalid column name '\*'.</span><span class="sxs-lookup"><span data-stu-id="e989b-142">Invalid column name '\*'.</span></span> |
| <span data-ttu-id="e989b-143">208</span><span class="sxs-lookup"><span data-stu-id="e989b-143">208</span></span> |<span data-ttu-id="e989b-144">Invalid object name '\*'.</span><span class="sxs-lookup"><span data-stu-id="e989b-144">Invalid object name '\*'.</span></span> |
| <span data-ttu-id="e989b-145">213</span><span class="sxs-lookup"><span data-stu-id="e989b-145">213</span></span> |<span data-ttu-id="e989b-146">Column name or number of supplied values does not match table definition.</span><span class="sxs-lookup"><span data-stu-id="e989b-146">Column name or number of supplied values does not match table definition.</span></span> |
| <span data-ttu-id="e989b-147">2812</span><span class="sxs-lookup"><span data-stu-id="e989b-147">2812</span></span> |<span data-ttu-id="e989b-148">Could not find stored procedure '\*'.</span><span class="sxs-lookup"><span data-stu-id="e989b-148">Could not find stored procedure '\*'.</span></span> |
| <span data-ttu-id="e989b-149">8144</span><span class="sxs-lookup"><span data-stu-id="e989b-149">8144</span></span> |<span data-ttu-id="e989b-150">Procedure or function \* has too many arguments specified.</span><span class="sxs-lookup"><span data-stu-id="e989b-150">Procedure or function \* has too many arguments specified.</span></span> |

## <a name="next-steps"></a><span data-ttu-id="e989b-151">Next steps</span><span class="sxs-lookup"><span data-stu-id="e989b-151">Next steps</span></span>
<span data-ttu-id="e989b-152">Monitor your recommendations and continue to apply them to refine performance.</span><span class="sxs-lookup"><span data-stu-id="e989b-152">Monitor your recommendations and continue to apply them to refine performance.</span></span> <span data-ttu-id="e989b-153">Database workloads are dynamic and change continuously.</span><span class="sxs-lookup"><span data-stu-id="e989b-153">Database workloads are dynamic and change continuously.</span></span> <span data-ttu-id="e989b-154">SQL Database advisor continues to monitor and provide recommendations that can potentially improve your database's performance.</span><span class="sxs-lookup"><span data-stu-id="e989b-154">SQL Database advisor continues to monitor and provide recommendations that can potentially improve your database's performance.</span></span> 

* <span data-ttu-id="e989b-155">See [SQL Database Advisor in the Azure portal](sql-database-advisor-portal.md) for steps on how to use SQL Database Advisor in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="e989b-155">See [SQL Database Advisor in the Azure portal](sql-database-advisor-portal.md) for steps on how to use SQL Database Advisor in the Azure portal.</span></span>
* <span data-ttu-id="e989b-156">See [Query Performance Insights](sql-database-query-performance.md) to learn about and view the performance impact of your top queries.</span><span class="sxs-lookup"><span data-stu-id="e989b-156">See [Query Performance Insights](sql-database-query-performance.md) to learn about and view the performance impact of your top queries.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="e989b-157">Additional resources</span><span class="sxs-lookup"><span data-stu-id="e989b-157">Additional resources</span></span>
* [<span data-ttu-id="e989b-158">Query Store</span><span class="sxs-lookup"><span data-stu-id="e989b-158">Query Store</span></span>](https://msdn.microsoft.com/library/dn817826.aspx)
* [<span data-ttu-id="e989b-159">CREATE INDEX</span><span class="sxs-lookup"><span data-stu-id="e989b-159">CREATE INDEX</span></span>](https://msdn.microsoft.com/library/ms188783.aspx)
* [<span data-ttu-id="e989b-160">Role-based access control</span><span class="sxs-lookup"><span data-stu-id="e989b-160">Role-based access control</span></span>](../active-directory/role-based-access-control-configure.md)

