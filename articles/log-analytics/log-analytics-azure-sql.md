---
title: Azure SQL Analytics solution in Log Analytics | Microsoft Docs
description: The Azure SQL Analytics solution helps you manage your Azure SQL databases.
services: log-analytics
documentationcenter: ''
author: bandersmsft
manager: carmonm
editor: ''
ms.assetid: b2712749-1ded-40c4-b211-abc51cc65171
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/12/2017
ms.author: banders
ms.openlocfilehash: 3f05014fcc23f7f052cd1c1f92c9e42a366370e5
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44548953"
---
# <a name="monitor-azure-sql-database-using-azure-sql-analytics-preview-in-log-analytics"></a><span data-ttu-id="05aa6-103">Monitor Azure SQL Database using Azure SQL Analytics (Preview) in Log Analytics</span><span class="sxs-lookup"><span data-stu-id="05aa6-103">Monitor Azure SQL Database using Azure SQL Analytics (Preview) in Log Analytics</span></span>

<span data-ttu-id="05aa6-104">The Azure SQL Monitoring solution in Azure Log Analytics collects and visualizes important SQL Azure performance metrics.</span><span class="sxs-lookup"><span data-stu-id="05aa6-104">The Azure SQL Monitoring solution in Azure Log Analytics collects and visualizes important SQL Azure performance metrics.</span></span> <span data-ttu-id="05aa6-105">By using the metrics that you collect with the solution, you can create custom monitoring rules and alerts.</span><span class="sxs-lookup"><span data-stu-id="05aa6-105">By using the metrics that you collect with the solution, you can create custom monitoring rules and alerts.</span></span> <span data-ttu-id="05aa6-106">And, you can monitor Azure SQL Database and elastic pool metrics across multiple Azure subscriptions and elastic pools and visualize them.</span><span class="sxs-lookup"><span data-stu-id="05aa6-106">And, you can monitor Azure SQL Database and elastic pool metrics across multiple Azure subscriptions and elastic pools and visualize them.</span></span> <span data-ttu-id="05aa6-107">The solution also helps you to identify issues at each layer of your application stack.</span><span class="sxs-lookup"><span data-stu-id="05aa6-107">The solution also helps you to identify issues at each layer of your application stack.</span></span>  <span data-ttu-id="05aa6-108">It uses [Azure Diagnostic metrics](log-analytics-azure-storage.md) together with Log Analytics views to present data about all your Azure SQL databases and elastic pools in a single Log Analytics workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-108">It uses [Azure Diagnostic metrics](log-analytics-azure-storage.md) together with Log Analytics views to present data about all your Azure SQL databases and elastic pools in a single Log Analytics workspace.</span></span>

<span data-ttu-id="05aa6-109">Currently, this preview solution supports up to 150,000 Azure SQL Databases and 5,000 SQL Elastic Pools per workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-109">Currently, this preview solution supports up to 150,000 Azure SQL Databases and 5,000 SQL Elastic Pools per workspace.</span></span>

<span data-ttu-id="05aa6-110">The Azure SQL Monitoring solution, like others available for Log Analytics, helps you monitor and receive notifications about the health of your Azure resources—in this case, Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="05aa6-110">The Azure SQL Monitoring solution, like others available for Log Analytics, helps you monitor and receive notifications about the health of your Azure resources—in this case, Azure SQL Database.</span></span> <span data-ttu-id="05aa6-111">Microsoft Azure SQL Database is a scalable relational database service that provides familiar SQL-Server-like capabilities to applications running in the Azure cloud.</span><span class="sxs-lookup"><span data-stu-id="05aa6-111">Microsoft Azure SQL Database is a scalable relational database service that provides familiar SQL-Server-like capabilities to applications running in the Azure cloud.</span></span> <span data-ttu-id="05aa6-112">Log Analytics helps you to collect, correlate, and visualize structured and unstructured data.</span><span class="sxs-lookup"><span data-stu-id="05aa6-112">Log Analytics helps you to collect, correlate, and visualize structured and unstructured data.</span></span>

## <a name="connected-sources"></a><span data-ttu-id="05aa6-113">Connected sources</span><span class="sxs-lookup"><span data-stu-id="05aa6-113">Connected sources</span></span>

<span data-ttu-id="05aa6-114">The Azure SQL Monitoring solution doesn't use agents to connect to the Log Analytics service.</span><span class="sxs-lookup"><span data-stu-id="05aa6-114">The Azure SQL Monitoring solution doesn't use agents to connect to the Log Analytics service.</span></span>

<span data-ttu-id="05aa6-115">The following table describes the connected sources that are supported by this solution.</span><span class="sxs-lookup"><span data-stu-id="05aa6-115">The following table describes the connected sources that are supported by this solution.</span></span>

| <span data-ttu-id="05aa6-116">Connected Source</span><span class="sxs-lookup"><span data-stu-id="05aa6-116">Connected Source</span></span> | <span data-ttu-id="05aa6-117">Support</span><span class="sxs-lookup"><span data-stu-id="05aa6-117">Support</span></span> | <span data-ttu-id="05aa6-118">Description</span><span class="sxs-lookup"><span data-stu-id="05aa6-118">Description</span></span> |
| --- | --- | --- |
| [<span data-ttu-id="05aa6-119">Windows agents</span><span class="sxs-lookup"><span data-stu-id="05aa6-119">Windows agents</span></span>](log-analytics-windows-agents.md) | <span data-ttu-id="05aa6-120">No</span><span class="sxs-lookup"><span data-stu-id="05aa6-120">No</span></span> | <span data-ttu-id="05aa6-121">Direct Windows agents are not used by the solution.</span><span class="sxs-lookup"><span data-stu-id="05aa6-121">Direct Windows agents are not used by the solution.</span></span> |
| [<span data-ttu-id="05aa6-122">Linux agents</span><span class="sxs-lookup"><span data-stu-id="05aa6-122">Linux agents</span></span>](log-analytics-linux-agents.md) | <span data-ttu-id="05aa6-123">No</span><span class="sxs-lookup"><span data-stu-id="05aa6-123">No</span></span> | <span data-ttu-id="05aa6-124">Direct Linux agents are not used by the solution.</span><span class="sxs-lookup"><span data-stu-id="05aa6-124">Direct Linux agents are not used by the solution.</span></span> |
| [<span data-ttu-id="05aa6-125">SCOM management group</span><span class="sxs-lookup"><span data-stu-id="05aa6-125">SCOM management group</span></span>](log-analytics-om-agents.md) | <span data-ttu-id="05aa6-126">No</span><span class="sxs-lookup"><span data-stu-id="05aa6-126">No</span></span> | <span data-ttu-id="05aa6-127">A direct connection from the SCOM agent to Log Analytics is not used by the solution.</span><span class="sxs-lookup"><span data-stu-id="05aa6-127">A direct connection from the SCOM agent to Log Analytics is not used by the solution.</span></span> |
| [<span data-ttu-id="05aa6-128">Azure storage account</span><span class="sxs-lookup"><span data-stu-id="05aa6-128">Azure storage account</span></span>](log-analytics-azure-storage.md) | <span data-ttu-id="05aa6-129">No</span><span class="sxs-lookup"><span data-stu-id="05aa6-129">No</span></span> | <span data-ttu-id="05aa6-130">Log Analytics does not read the data from a storage account.</span><span class="sxs-lookup"><span data-stu-id="05aa6-130">Log Analytics does not read the data from a storage account.</span></span> |
| [<span data-ttu-id="05aa6-131">Azure diagnostics</span><span class="sxs-lookup"><span data-stu-id="05aa6-131">Azure diagnostics</span></span>](log-analytics-azure-storage.md) | <span data-ttu-id="05aa6-132">Yes</span><span class="sxs-lookup"><span data-stu-id="05aa6-132">Yes</span></span> | <span data-ttu-id="05aa6-133">Azure metric data is sent to Log Analytics directly by Azure.</span><span class="sxs-lookup"><span data-stu-id="05aa6-133">Azure metric data is sent to Log Analytics directly by Azure.</span></span> |

## <a name="prerequisites"></a><span data-ttu-id="05aa6-134">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="05aa6-134">Prerequisites</span></span>

1. <span data-ttu-id="05aa6-135">An Azure Subscription.</span><span class="sxs-lookup"><span data-stu-id="05aa6-135">An Azure Subscription.</span></span> <span data-ttu-id="05aa6-136">If you don't have one, you can create one for [free](https://azure.microsoft.com/free/).</span><span class="sxs-lookup"><span data-stu-id="05aa6-136">If you don't have one, you can create one for [free](https://azure.microsoft.com/free/).</span></span>
2. <span data-ttu-id="05aa6-137">A Log Analytics workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-137">A Log Analytics workspace.</span></span> <span data-ttu-id="05aa6-138">You can use an existing one, or you can [create a new one](log-analytics-get-started.md) before you start using this solution.</span><span class="sxs-lookup"><span data-stu-id="05aa6-138">You can use an existing one, or you can [create a new one](log-analytics-get-started.md) before you start using this solution.</span></span>
3. <span data-ttu-id="05aa6-139">Enable Azure Diagnostics for your Azure SQL databases and elastic pools and [configure them to send their data to Log Analytics](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell/).</span><span class="sxs-lookup"><span data-stu-id="05aa6-139">Enable Azure Diagnostics for your Azure SQL databases and elastic pools and [configure them to send their data to Log Analytics](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell/).</span></span>

## <a name="configuration"></a><span data-ttu-id="05aa6-140">Configuration</span><span class="sxs-lookup"><span data-stu-id="05aa6-140">Configuration</span></span>

<span data-ttu-id="05aa6-141">Perform the following steps to add the Azure SQL Monitoring solution to your workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-141">Perform the following steps to add the Azure SQL Monitoring solution to your workspace.</span></span>

1. <span data-ttu-id="05aa6-142">Add the Azure SQL Analytics solution to your workspace from [Azure marketplace](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/Microsoft.AzureSQLAnalyticsOMS?tab=Overview) or by using the process described in [Add Log Analytics solutions from the Solutions Gallery](log-analytics-add-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="05aa6-142">Add the Azure SQL Analytics solution to your workspace from [Azure marketplace](https://azuremarketplace.microsoft.com/en-us/marketplace/apps/Microsoft.AzureSQLAnalyticsOMS?tab=Overview) or by using the process described in [Add Log Analytics solutions from the Solutions Gallery](log-analytics-add-solutions.md).</span></span>
2. <span data-ttu-id="05aa6-143">In the Azure portal, click **New** (the + symbol), then in the list of resources, select **Monitoring + Management**.</span><span class="sxs-lookup"><span data-stu-id="05aa6-143">In the Azure portal, click **New** (the + symbol), then in the list of resources, select **Monitoring + Management**.</span></span>  
    <span data-ttu-id="05aa6-144">![Monitoring + Management](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/monitoring-management.png)</span><span class="sxs-lookup"><span data-stu-id="05aa6-144">![Monitoring + Management](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/monitoring-management.png)</span></span>
3. <span data-ttu-id="05aa6-145">In the **Monitoring + Management** list click **See all**.</span><span class="sxs-lookup"><span data-stu-id="05aa6-145">In the **Monitoring + Management** list click **See all**.</span></span>
4. <span data-ttu-id="05aa6-146">In the **Recommended** list, click **More** , and then in the new list, find **Azure SQL Analytics (Preview)** and then select it.</span><span class="sxs-lookup"><span data-stu-id="05aa6-146">In the **Recommended** list, click **More** , and then in the new list, find **Azure SQL Analytics (Preview)** and then select it.</span></span>  
    <span data-ttu-id="05aa6-147">![Azure SQL Analytics solution](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/azure-sql-solution-portal.png)</span><span class="sxs-lookup"><span data-stu-id="05aa6-147">![Azure SQL Analytics solution](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/azure-sql-solution-portal.png)</span></span>
5. <span data-ttu-id="05aa6-148">In the **Azure SQL Analytics (Preview)** blade, click **Create**.</span><span class="sxs-lookup"><span data-stu-id="05aa6-148">In the **Azure SQL Analytics (Preview)** blade, click **Create**.</span></span>  
    <span data-ttu-id="05aa6-149">![Create](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/portal-create.png)</span><span class="sxs-lookup"><span data-stu-id="05aa6-149">![Create](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/portal-create.png)</span></span>
6. <span data-ttu-id="05aa6-150">In the **Create new solution** blade, select the workspace that you want to add the solution to and then click **Create**.</span><span class="sxs-lookup"><span data-stu-id="05aa6-150">In the **Create new solution** blade, select the workspace that you want to add the solution to and then click **Create**.</span></span>  
    <span data-ttu-id="05aa6-151">![add to workspace](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/add-to-workspace.png)</span><span class="sxs-lookup"><span data-stu-id="05aa6-151">![add to workspace](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/add-to-workspace.png)</span></span>


### <a name="to-configure-multiple-azure-subscriptions"></a><span data-ttu-id="05aa6-152">To configure multiple Azure subscriptions</span><span class="sxs-lookup"><span data-stu-id="05aa6-152">To configure multiple Azure subscriptions</span></span>

<span data-ttu-id="05aa6-153">To support multiple subscriptions, use the PowerShell script from [Enable Azure resource metrics logging using PowerShell](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell/).</span><span class="sxs-lookup"><span data-stu-id="05aa6-153">To support multiple subscriptions, use the PowerShell script from [Enable Azure resource metrics logging using PowerShell](https://blogs.technet.microsoft.com/msoms/2017/01/17/enable-azure-resource-metrics-logging-using-powershell/).</span></span> <span data-ttu-id="05aa6-154">Provide the workspace resource ID as a parameter when executing the script to send diagnostic data from resources in one Azure subscription to a workspace in another Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="05aa6-154">Provide the workspace resource ID as a parameter when executing the script to send diagnostic data from resources in one Azure subscription to a workspace in another Azure subscription.</span></span>

<span data-ttu-id="05aa6-155">**Example**</span><span class="sxs-lookup"><span data-stu-id="05aa6-155">**Example**</span></span>

```
PS C:\> $WSID = "/subscriptions/<subID>/resourcegroups/oms/providers/microsoft.operationalinsights/workspaces/omsws"
```

```
PS C:\> .\Enable-AzureRMDiagnostics.ps1 -WSID $WSID
```

## <a name="using-the-solution"></a><span data-ttu-id="05aa6-156">Using the solution</span><span class="sxs-lookup"><span data-stu-id="05aa6-156">Using the solution</span></span>

<span data-ttu-id="05aa6-157">When you add the solution to your workspace, the Azure SQL Analytics tile is added to your workspace, and it appears in Overview.</span><span class="sxs-lookup"><span data-stu-id="05aa6-157">When you add the solution to your workspace, the Azure SQL Analytics tile is added to your workspace, and it appears in Overview.</span></span> <span data-ttu-id="05aa6-158">The tile shows the number of Azure SQL databases and Azure SQL elastic pools that the solution is connected to.</span><span class="sxs-lookup"><span data-stu-id="05aa6-158">The tile shows the number of Azure SQL databases and Azure SQL elastic pools that the solution is connected to.</span></span>

![Azure SQL Analytics tile](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/azure-sql-sol-tile.png)

### <a name="viewing-azure-sql-monitoring-data"></a><span data-ttu-id="05aa6-160">Viewing Azure SQL Monitoring data</span><span class="sxs-lookup"><span data-stu-id="05aa6-160">Viewing Azure SQL Monitoring data</span></span>

<span data-ttu-id="05aa6-161">Click on the **Azure SQL Monitoring** tile to open the Azure SQL Analytics dashboard.</span><span class="sxs-lookup"><span data-stu-id="05aa6-161">Click on the **Azure SQL Monitoring** tile to open the Azure SQL Analytics dashboard.</span></span> <span data-ttu-id="05aa6-162">The dashboard includes the columns in the following table.</span><span class="sxs-lookup"><span data-stu-id="05aa6-162">The dashboard includes the columns in the following table.</span></span> <span data-ttu-id="05aa6-163">Each column lists up to ten items matching that column's criteria for the specified scope and time range.</span><span class="sxs-lookup"><span data-stu-id="05aa6-163">Each column lists up to ten items matching that column's criteria for the specified scope and time range.</span></span> <span data-ttu-id="05aa6-164">You can run a log search that returns all records by clicking **See all** at the bottom of the column or by clicking the column header.</span><span class="sxs-lookup"><span data-stu-id="05aa6-164">You can run a log search that returns all records by clicking **See all** at the bottom of the column or by clicking the column header.</span></span>

<span data-ttu-id="05aa6-165">Read about [SQL Database options and performance for service tiers](../sql-database/sql-database-service-tiers.md).</span><span class="sxs-lookup"><span data-stu-id="05aa6-165">Read about [SQL Database options and performance for service tiers](../sql-database/sql-database-service-tiers.md).</span></span>



![Azure SQL Analytics dashboard](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/azure-sql-dash-01.png)



![Azure SQL Analytics dashboard](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/azure-sql-dash-02.png)

| <span data-ttu-id="05aa6-168">Column</span><span class="sxs-lookup"><span data-stu-id="05aa6-168">Column</span></span> | <span data-ttu-id="05aa6-169">Description</span><span class="sxs-lookup"><span data-stu-id="05aa6-169">Description</span></span> |
| --- | --- |
| <span data-ttu-id="05aa6-170">**Azure SQL Database Analytics**</span><span class="sxs-lookup"><span data-stu-id="05aa6-170">**Azure SQL Database Analytics**</span></span> | &nbsp; |
| <span data-ttu-id="05aa6-171">Top N Databases by DTU Utilization &gt; 90%</span><span class="sxs-lookup"><span data-stu-id="05aa6-171">Top N Databases by DTU Utilization &gt; 90%</span></span> | <span data-ttu-id="05aa6-172">This panel shows the number of Azure SQL databases that had DTU utilization over 90% for the time selected.</span><span class="sxs-lookup"><span data-stu-id="05aa6-172">This panel shows the number of Azure SQL databases that had DTU utilization over 90% for the time selected.</span></span> <span data-ttu-id="05aa6-173">The top tile shows the number of databases that have consumed more than 90% of total allocated DTU availability during the same specified time of all databases you are monitoring within Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="05aa6-173">The top tile shows the number of databases that have consumed more than 90% of total allocated DTU availability during the same specified time of all databases you are monitoring within Log Analytics.</span></span>  <span data-ttu-id="05aa6-174">Click on a database name to run a log search that shows a line chart comparing the database's DTU utilization compared to all others monitored by the workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-174">Click on a database name to run a log search that shows a line chart comparing the database's DTU utilization compared to all others monitored by the workspace.</span></span> |
| <span data-ttu-id="05aa6-175">Top N Databases by CPU Utilization &gt; 90%</span><span class="sxs-lookup"><span data-stu-id="05aa6-175">Top N Databases by CPU Utilization &gt; 90%</span></span> | <span data-ttu-id="05aa6-176">This panel shows the number of Azure SQL databases that had CPU utilization over 90% for the time selected.</span><span class="sxs-lookup"><span data-stu-id="05aa6-176">This panel shows the number of Azure SQL databases that had CPU utilization over 90% for the time selected.</span></span> <span data-ttu-id="05aa6-177">The top tile shows the number of databases that have consumed more than 90% of total allocated CPU availability during the same specified time of all databases you are monitoring within Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="05aa6-177">The top tile shows the number of databases that have consumed more than 90% of total allocated CPU availability during the same specified time of all databases you are monitoring within Log Analytics.</span></span>  <span data-ttu-id="05aa6-178">Click on a database name to run a log search that shows a line chart comparing the database's CPU utilization compared to all others monitored by the workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-178">Click on a database name to run a log search that shows a line chart comparing the database's CPU utilization compared to all others monitored by the workspace.</span></span> |
| <span data-ttu-id="05aa6-179">Top N Databases by Storage Consumption &gt; 90%</span><span class="sxs-lookup"><span data-stu-id="05aa6-179">Top N Databases by Storage Consumption &gt; 90%</span></span> | <span data-ttu-id="05aa6-180">This panel shows the number of Azure SQL databases that had consumed greater than 90% of their storage allocation for the time selected.</span><span class="sxs-lookup"><span data-stu-id="05aa6-180">This panel shows the number of Azure SQL databases that had consumed greater than 90% of their storage allocation for the time selected.</span></span> <span data-ttu-id="05aa6-181">The top tile shows the number of databases that have breached the threshold of 90% during the same specified time of all databases you are monitoring within Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="05aa6-181">The top tile shows the number of databases that have breached the threshold of 90% during the same specified time of all databases you are monitoring within Log Analytics.</span></span>  <span data-ttu-id="05aa6-182">Click on a database name to run a log search that shows a line chart comparing the database's storage consumption compared to all others monitored by the workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-182">Click on a database name to run a log search that shows a line chart comparing the database's storage consumption compared to all others monitored by the workspace.</span></span> |
| <span data-ttu-id="05aa6-183">**Azure SQL Elastic Pools**</span><span class="sxs-lookup"><span data-stu-id="05aa6-183">**Azure SQL Elastic Pools**</span></span> | &nbsp; |
| <span data-ttu-id="05aa6-184">Top N Elastic Pools by DTU &gt; 90%</span><span class="sxs-lookup"><span data-stu-id="05aa6-184">Top N Elastic Pools by DTU &gt; 90%</span></span> | <span data-ttu-id="05aa6-185">This panel shows the number of Azure SQL elastic pools that had consumed greater than 90% of their total DTU allocation for the time selected.</span><span class="sxs-lookup"><span data-stu-id="05aa6-185">This panel shows the number of Azure SQL elastic pools that had consumed greater than 90% of their total DTU allocation for the time selected.</span></span> <span data-ttu-id="05aa6-186">The top tile shows the number of elastic pools that have breached the threshold of 90% during the same specified time of all Azure SQL elastic pools you are monitoring within Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="05aa6-186">The top tile shows the number of elastic pools that have breached the threshold of 90% during the same specified time of all Azure SQL elastic pools you are monitoring within Log Analytics.</span></span>  <span data-ttu-id="05aa6-187">Click on an elastic pool name to run a log search that shows a line chart comparing the elastic pool's storage consumption compared to all others monitored by the workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-187">Click on an elastic pool name to run a log search that shows a line chart comparing the elastic pool's storage consumption compared to all others monitored by the workspace.</span></span> |
| <span data-ttu-id="05aa6-188">Top N Elastic Pools by CPU &gt; 90%</span><span class="sxs-lookup"><span data-stu-id="05aa6-188">Top N Elastic Pools by CPU &gt; 90%</span></span> | <span data-ttu-id="05aa6-189">This panel shows the number of Azure SQL elastic pools that had CPU utilization over 90% for the time period selected.</span><span class="sxs-lookup"><span data-stu-id="05aa6-189">This panel shows the number of Azure SQL elastic pools that had CPU utilization over 90% for the time period selected.</span></span> <span data-ttu-id="05aa6-190">The top tile shows the number of elastic pools that have breached the threshold of 90% during the same specified time of all Azure SQL elastic pools you are monitoring within Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="05aa6-190">The top tile shows the number of elastic pools that have breached the threshold of 90% during the same specified time of all Azure SQL elastic pools you are monitoring within Log Analytics.</span></span>  <span data-ttu-id="05aa6-191">Click on an elastic pool name to run a log search that shows a line chart comparing the elastic pool's CPU utilization compared to all others monitored by the workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-191">Click on an elastic pool name to run a log search that shows a line chart comparing the elastic pool's CPU utilization compared to all others monitored by the workspace.</span></span> |
| <span data-ttu-id="05aa6-192">Top N Elastic Pools by Storage Consumption &gt; 90%</span><span class="sxs-lookup"><span data-stu-id="05aa6-192">Top N Elastic Pools by Storage Consumption &gt; 90%</span></span> | <span data-ttu-id="05aa6-193">This panel shows the number of Azure SQL elastic pools that had consumed greater than 90% of their storage allocation for the time selected.</span><span class="sxs-lookup"><span data-stu-id="05aa6-193">This panel shows the number of Azure SQL elastic pools that had consumed greater than 90% of their storage allocation for the time selected.</span></span> <span data-ttu-id="05aa6-194">The top tile shows the number of elastic pools that have breached the threshold of 90% during the same specified time of all elastic pools you are monitoring within Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="05aa6-194">The top tile shows the number of elastic pools that have breached the threshold of 90% during the same specified time of all elastic pools you are monitoring within Log Analytics.</span></span>  <span data-ttu-id="05aa6-195">Click on an elastic pool name to run a log search that shows a line chart comparing the elastic pool's storage consumption compared to all others monitored by the workspace.</span><span class="sxs-lookup"><span data-stu-id="05aa6-195">Click on an elastic pool name to run a log search that shows a line chart comparing the elastic pool's storage consumption compared to all others monitored by the workspace.</span></span> |
| <span data-ttu-id="05aa6-196">**Azure SQL Activity Logs**</span><span class="sxs-lookup"><span data-stu-id="05aa6-196">**Azure SQL Activity Logs**</span></span> | &nbsp; |
| <span data-ttu-id="05aa6-197">SQL Azure Activity Audit</span><span class="sxs-lookup"><span data-stu-id="05aa6-197">SQL Azure Activity Audit</span></span> | <span data-ttu-id="05aa6-198">This panel shows the number of Azure activity records related to Azure SQL for the time selected.</span><span class="sxs-lookup"><span data-stu-id="05aa6-198">This panel shows the number of Azure activity records related to Azure SQL for the time selected.</span></span> <span data-ttu-id="05aa6-199">Click an item to run a log search that shows additional details about the item.</span><span class="sxs-lookup"><span data-stu-id="05aa6-199">Click an item to run a log search that shows additional details about the item.</span></span> |



### <a name="analyze-data-and-create-alerts"></a><span data-ttu-id="05aa6-200">Analyze data and create alerts</span><span class="sxs-lookup"><span data-stu-id="05aa6-200">Analyze data and create alerts</span></span>

<span data-ttu-id="05aa6-201">The solution includes useful queries to help get you analyzing your data.</span><span class="sxs-lookup"><span data-stu-id="05aa6-201">The solution includes useful queries to help get you analyzing your data.</span></span> <span data-ttu-id="05aa6-202">If you scroll to the right, the dashboard will list several common queries that you can click on to perform a [log search](log-analytics-log-searches.md) for Azure SQL data.</span><span class="sxs-lookup"><span data-stu-id="05aa6-202">If you scroll to the right, the dashboard will list several common queries that you can click on to perform a [log search](log-analytics-log-searches.md) for Azure SQL data.</span></span>

![queries](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/azure-sql-queries.png)

<span data-ttu-id="05aa6-204">The solution includes some *alert-based queries*, as shown above that you can use to alert on specific thresholds for both Azure SQL databases and elastic pools.</span><span class="sxs-lookup"><span data-stu-id="05aa6-204">The solution includes some *alert-based queries*, as shown above that you can use to alert on specific thresholds for both Azure SQL databases and elastic pools.</span></span>

#### <a name="to-configure-an-alert-for-your-workspace"></a><span data-ttu-id="05aa6-205">To configure an alert for your workspace</span><span class="sxs-lookup"><span data-stu-id="05aa6-205">To configure an alert for your workspace</span></span>

1. <span data-ttu-id="05aa6-206">Go to the [OMS portal](http://mms.microsoft.com/) and sign in.</span><span class="sxs-lookup"><span data-stu-id="05aa6-206">Go to the [OMS portal](http://mms.microsoft.com/) and sign in.</span></span>
2. <span data-ttu-id="05aa6-207">Open the workspace that you have configured for the solution.</span><span class="sxs-lookup"><span data-stu-id="05aa6-207">Open the workspace that you have configured for the solution.</span></span>
3. <span data-ttu-id="05aa6-208">On the Overview page, click the **Azure SQL Analytics (Preview)** tile.</span><span class="sxs-lookup"><span data-stu-id="05aa6-208">On the Overview page, click the **Azure SQL Analytics (Preview)** tile.</span></span>
4. <span data-ttu-id="05aa6-209">Scroll to the right and click a query to start creating an alert.</span><span class="sxs-lookup"><span data-stu-id="05aa6-209">Scroll to the right and click a query to start creating an alert.</span></span>  
![alert query](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/alert-query.png)
5. <span data-ttu-id="05aa6-211">In Log Search, click **Alert**.</span><span class="sxs-lookup"><span data-stu-id="05aa6-211">In Log Search, click **Alert**.</span></span>  
<span data-ttu-id="05aa6-212">![create alert in search](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/create-alert01.png)</span><span class="sxs-lookup"><span data-stu-id="05aa6-212">![create alert in search](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/create-alert01.png)</span></span>
6. <span data-ttu-id="05aa6-213">On the **Add Alert Rule** page, configure the appropriate properties and the specific thresholds that you want and then click **Save**.</span><span class="sxs-lookup"><span data-stu-id="05aa6-213">On the **Add Alert Rule** page, configure the appropriate properties and the specific thresholds that you want and then click **Save**.</span></span>  
<span data-ttu-id="05aa6-214">![add alert rule](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/create-alert02.png)</span><span class="sxs-lookup"><span data-stu-id="05aa6-214">![add alert rule](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/create-alert02.png)</span></span>

### <a name="act-on-azure-sql-monitoring-data"></a><span data-ttu-id="05aa6-215">Act on Azure SQL Monitoring data</span><span class="sxs-lookup"><span data-stu-id="05aa6-215">Act on Azure SQL Monitoring data</span></span>

<span data-ttu-id="05aa6-216">As an example, one of the most useful queries that you can perform is to compare the DTU utilization for all Azure SQL Elastic Pools across all your Azure subscriptions.</span><span class="sxs-lookup"><span data-stu-id="05aa6-216">As an example, one of the most useful queries that you can perform is to compare the DTU utilization for all Azure SQL Elastic Pools across all your Azure subscriptions.</span></span> <span data-ttu-id="05aa6-217">Database Throughput Unit (DTU) provides a way to describe the relative capacity of a performance level of Basic, Standard, and Premium databases and pools.</span><span class="sxs-lookup"><span data-stu-id="05aa6-217">Database Throughput Unit (DTU) provides a way to describe the relative capacity of a performance level of Basic, Standard, and Premium databases and pools.</span></span> <span data-ttu-id="05aa6-218">DTUs are based on a blended measure of CPU, memory, reads, and writes.</span><span class="sxs-lookup"><span data-stu-id="05aa6-218">DTUs are based on a blended measure of CPU, memory, reads, and writes.</span></span> <span data-ttu-id="05aa6-219">As DTUs increase, the power offered by the performance level increases.</span><span class="sxs-lookup"><span data-stu-id="05aa6-219">As DTUs increase, the power offered by the performance level increases.</span></span> <span data-ttu-id="05aa6-220">For example, a performance level with 5 DTUs has five times more power than a performance level with 1 DTU.</span><span class="sxs-lookup"><span data-stu-id="05aa6-220">For example, a performance level with 5 DTUs has five times more power than a performance level with 1 DTU.</span></span> <span data-ttu-id="05aa6-221">A maximum DTU quota applies to each server and elastic pool.</span><span class="sxs-lookup"><span data-stu-id="05aa6-221">A maximum DTU quota applies to each server and elastic pool.</span></span>

<span data-ttu-id="05aa6-222">By running the following Log Search query, you can easily tell if you are underutilizing or over utilizing your SQL Azure elastic pools.</span><span class="sxs-lookup"><span data-stu-id="05aa6-222">By running the following Log Search query, you can easily tell if you are underutilizing or over utilizing your SQL Azure elastic pools.</span></span>

```
Type=AzureMetrics ResourceId=*"/ELASTICPOOLS/"* MetricName=dtu_consumption_percent | measure avg(Average) by Resource | display LineChart
```

<span data-ttu-id="05aa6-223">In the following example, you can see that one elastic pool has a high usage near 100% DTU while others have very little usage.</span><span class="sxs-lookup"><span data-stu-id="05aa6-223">In the following example, you can see that one elastic pool has a high usage near 100% DTU while others have very little usage.</span></span> <span data-ttu-id="05aa6-224">You can investigate further to troubleshoot potential recent changes in your environment using Azure Activity logs.</span><span class="sxs-lookup"><span data-stu-id="05aa6-224">You can investigate further to troubleshoot potential recent changes in your environment using Azure Activity logs.</span></span>

![Log search results - high utilization](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-azure-sql/log-search-high-util.png)

## <a name="see-also"></a><span data-ttu-id="05aa6-226">See also</span><span class="sxs-lookup"><span data-stu-id="05aa6-226">See also</span></span>

- <span data-ttu-id="05aa6-227">Use [Log Searches](log-analytics-log-searches.md) in Log Analytics to view detailed Azure SQL data.</span><span class="sxs-lookup"><span data-stu-id="05aa6-227">Use [Log Searches](log-analytics-log-searches.md) in Log Analytics to view detailed Azure SQL data.</span></span>
- <span data-ttu-id="05aa6-228">[Create your own dashboards](log-analytics-dashboards.md) showing Azure SQL data.</span><span class="sxs-lookup"><span data-stu-id="05aa6-228">[Create your own dashboards](log-analytics-dashboards.md) showing Azure SQL data.</span></span>
- <span data-ttu-id="05aa6-229">[Create alerts](log-analytics-alerts.md) when specific Azure SQL events occur.</span><span class="sxs-lookup"><span data-stu-id="05aa6-229">[Create alerts](log-analytics-alerts.md) when specific Azure SQL events occur.</span></span>












