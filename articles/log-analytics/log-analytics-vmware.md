---
title: VMware Monitoring solution in Log Analytics | Microsoft Docs
description: Learn about how the VMware Monitoring solution can help manage logs and monitor ESXi hosts.
services: log-analytics
documentationcenter: ''
author: bandersmsft
manager: carmonm
editor: ''
ms.assetid: 16516639-cc1e-465c-a22f-022f3be297f1
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 04/12/2017
ms.author: banders
ms.openlocfilehash: 902ec1d2bfc4b78fc1333b8aeff8bc694ce57e8e
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44563216"
---
# <a name="vmware-monitoring-preview-solution-in-log-analytics"></a><span data-ttu-id="a7820-103">VMware Monitoring (Preview) solution in Log Analytics</span><span class="sxs-lookup"><span data-stu-id="a7820-103">VMware Monitoring (Preview) solution in Log Analytics</span></span>
<span data-ttu-id="a7820-104">The VMware Monitoring solution in Log Analytics is a solution that helps you create a centralized logging and monitoring approach for large VMware logs.</span><span class="sxs-lookup"><span data-stu-id="a7820-104">The VMware Monitoring solution in Log Analytics is a solution that helps you create a centralized logging and monitoring approach for large VMware logs.</span></span> <span data-ttu-id="a7820-105">This article describes how you can troubleshoot, capture, and manage the ESXi hosts in a single location using the solution.</span><span class="sxs-lookup"><span data-stu-id="a7820-105">This article describes how you can troubleshoot, capture, and manage the ESXi hosts in a single location using the solution.</span></span> <span data-ttu-id="a7820-106">With the solution, you can see detailed data for all your ESXi hosts in a single location.</span><span class="sxs-lookup"><span data-stu-id="a7820-106">With the solution, you can see detailed data for all your ESXi hosts in a single location.</span></span> <span data-ttu-id="a7820-107">You can see top event counts, status, and trends of VM and ESXi hosts provided through the ESXi host logs.</span><span class="sxs-lookup"><span data-stu-id="a7820-107">You can see top event counts, status, and trends of VM and ESXi hosts provided through the ESXi host logs.</span></span> <span data-ttu-id="a7820-108">You can troubleshoot by viewing and searching centralized ESXi host logs.</span><span class="sxs-lookup"><span data-stu-id="a7820-108">You can troubleshoot by viewing and searching centralized ESXi host logs.</span></span> <span data-ttu-id="a7820-109">And, you can create alerts based on log search queries.</span><span class="sxs-lookup"><span data-stu-id="a7820-109">And, you can create alerts based on log search queries.</span></span>

<span data-ttu-id="a7820-110">The solution uses native syslog functionality of the ESXi host to push data to a target VM, which has OMS Agent.</span><span class="sxs-lookup"><span data-stu-id="a7820-110">The solution uses native syslog functionality of the ESXi host to push data to a target VM, which has OMS Agent.</span></span> <span data-ttu-id="a7820-111">However, the solution doesn't write files into syslog within the target VM.</span><span class="sxs-lookup"><span data-stu-id="a7820-111">However, the solution doesn't write files into syslog within the target VM.</span></span> <span data-ttu-id="a7820-112">The OMS agent opens port 1514 and listens to this.</span><span class="sxs-lookup"><span data-stu-id="a7820-112">The OMS agent opens port 1514 and listens to this.</span></span> <span data-ttu-id="a7820-113">Once it receives the data, the OMS agent pushes the data into OMS.</span><span class="sxs-lookup"><span data-stu-id="a7820-113">Once it receives the data, the OMS agent pushes the data into OMS.</span></span>

## <a name="installing-and-configuring-the-solution"></a><span data-ttu-id="a7820-114">Installing and configuring the solution</span><span class="sxs-lookup"><span data-stu-id="a7820-114">Installing and configuring the solution</span></span>
<span data-ttu-id="a7820-115">Use the following information to install and configure the solution.</span><span class="sxs-lookup"><span data-stu-id="a7820-115">Use the following information to install and configure the solution.</span></span>

* <span data-ttu-id="a7820-116">Add the VMware Monitoring solution to your OMS workspace using the process described in [Add Log Analytics solutions from the Solutions Gallery](log-analytics-add-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="a7820-116">Add the VMware Monitoring solution to your OMS workspace using the process described in [Add Log Analytics solutions from the Solutions Gallery](log-analytics-add-solutions.md).</span></span>

#### <a name="supported-vmware-esxi-hosts"></a><span data-ttu-id="a7820-117">Supported VMware ESXi hosts</span><span class="sxs-lookup"><span data-stu-id="a7820-117">Supported VMware ESXi hosts</span></span>
<span data-ttu-id="a7820-118">vSphere ESXi Host 5.5 and 6.0</span><span class="sxs-lookup"><span data-stu-id="a7820-118">vSphere ESXi Host 5.5 and 6.0</span></span>

#### <a name="prepare-a-linux-server"></a><span data-ttu-id="a7820-119">Prepare a Linux server</span><span class="sxs-lookup"><span data-stu-id="a7820-119">Prepare a Linux server</span></span>
<span data-ttu-id="a7820-120">Create a Linux operating system VM to receive all syslog data from the ESXi hosts.</span><span class="sxs-lookup"><span data-stu-id="a7820-120">Create a Linux operating system VM to receive all syslog data from the ESXi hosts.</span></span> <span data-ttu-id="a7820-121">The [OMS Linux Agent](log-analytics-linux-agents.md) is the collection point for all ESXi host syslog data.</span><span class="sxs-lookup"><span data-stu-id="a7820-121">The [OMS Linux Agent](log-analytics-linux-agents.md) is the collection point for all ESXi host syslog data.</span></span> <span data-ttu-id="a7820-122">You can use multiple ESXi hosts to forward logs to a single Linux server, as in the following example.</span><span class="sxs-lookup"><span data-stu-id="a7820-122">You can use multiple ESXi hosts to forward logs to a single Linux server, as in the following example.</span></span>  

   ![syslog flow](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/diagram.png)

### <a name="configure-syslog-collection"></a><span data-ttu-id="a7820-124">Configure syslog collection</span><span class="sxs-lookup"><span data-stu-id="a7820-124">Configure syslog collection</span></span>
1. <span data-ttu-id="a7820-125">Set up syslog forwarding for VSphere.</span><span class="sxs-lookup"><span data-stu-id="a7820-125">Set up syslog forwarding for VSphere.</span></span> <span data-ttu-id="a7820-126">For detailed information to help set up syslog forwarding, see [Configuring syslog on ESXi 5.x and 6.0 (2003322)](https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2003322).</span><span class="sxs-lookup"><span data-stu-id="a7820-126">For detailed information to help set up syslog forwarding, see [Configuring syslog on ESXi 5.x and 6.0 (2003322)](https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2003322).</span></span> <span data-ttu-id="a7820-127">Go to **ESXi Host Configuration** > **Software** > **Advanced Settings** > **Syslog**.</span><span class="sxs-lookup"><span data-stu-id="a7820-127">Go to **ESXi Host Configuration** > **Software** > **Advanced Settings** > **Syslog**.</span></span>
   <span data-ttu-id="a7820-128">![vsphereconfig](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/vsphere1.png)</span><span class="sxs-lookup"><span data-stu-id="a7820-128">![vsphereconfig](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/vsphere1.png)</span></span>  
2. <span data-ttu-id="a7820-129">In the *Syslog.global.logHost* field, add your Linux server and the port number *1514*.</span><span class="sxs-lookup"><span data-stu-id="a7820-129">In the *Syslog.global.logHost* field, add your Linux server and the port number *1514*.</span></span> <span data-ttu-id="a7820-130">For example, `tcp://hostname:1514` or `tcp://123.456.789.101:1514`</span><span class="sxs-lookup"><span data-stu-id="a7820-130">For example, `tcp://hostname:1514` or `tcp://123.456.789.101:1514`</span></span>
3. <span data-ttu-id="a7820-131">Open the ESXi host firewall for syslog.</span><span class="sxs-lookup"><span data-stu-id="a7820-131">Open the ESXi host firewall for syslog.</span></span> <span data-ttu-id="a7820-132">**ESXi Host Configuration** > **Software** > **Security Profile** > **Firewall** and open **Properties**.</span><span class="sxs-lookup"><span data-stu-id="a7820-132">**ESXi Host Configuration** > **Software** > **Security Profile** > **Firewall** and open **Properties**.</span></span>  

    ![vspherefw](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/vsphere2.png)  

    ![vspherefwproperties](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/vsphere3.png)  
4. <span data-ttu-id="a7820-135">Check the vSphere Console to verify that that syslog is properly set up.</span><span class="sxs-lookup"><span data-stu-id="a7820-135">Check the vSphere Console to verify that that syslog is properly set up.</span></span> <span data-ttu-id="a7820-136">Confirm on the ESXI host that port **1514** is configured.</span><span class="sxs-lookup"><span data-stu-id="a7820-136">Confirm on the ESXI host that port **1514** is configured.</span></span>
5. <span data-ttu-id="a7820-137">Download and install the OMS Agent for Linux on the Linux server.</span><span class="sxs-lookup"><span data-stu-id="a7820-137">Download and install the OMS Agent for Linux on the Linux server.</span></span> <span data-ttu-id="a7820-138">For more information, see the [Documentation for OMS Agent for Linux](https://github.com/Microsoft/OMS-Agent-for-Linux).</span><span class="sxs-lookup"><span data-stu-id="a7820-138">For more information, see the [Documentation for OMS Agent for Linux](https://github.com/Microsoft/OMS-Agent-for-Linux).</span></span>
6. <span data-ttu-id="a7820-139">After the OMS Agent for Linux is installed, go to the  /etc/opt/microsoft/omsagent/sysconf/omsagent.d directory and copy the vmware_esxi.conf file to the /etc/opt/microsoft/omsagent/conf/omsagent.d directory and the change the owner/group and permissions of the file.</span><span class="sxs-lookup"><span data-stu-id="a7820-139">After the OMS Agent for Linux is installed, go to the  /etc/opt/microsoft/omsagent/sysconf/omsagent.d directory and copy the vmware_esxi.conf file to the /etc/opt/microsoft/omsagent/conf/omsagent.d directory and the change the owner/group and permissions of the file.</span></span> <span data-ttu-id="a7820-140">For example:</span><span class="sxs-lookup"><span data-stu-id="a7820-140">For example:</span></span>

    ```
    sudo cp /etc/opt/microsoft/omsagent/sysconf/omsagent.d/vmware_esxi.conf /etc/opt/microsoft/omsagent/conf/omsagent.d
   sudo chown omsagent:omiusers /etc/opt/microsoft/omsagent/conf/omsagent.d/vmware_esxi.conf
    ```
7. <span data-ttu-id="a7820-141">Restart the OMS Agent for Linux by running `sudo /opt/microsoft/omsagent/bin/service_control restart`.</span><span class="sxs-lookup"><span data-stu-id="a7820-141">Restart the OMS Agent for Linux by running `sudo /opt/microsoft/omsagent/bin/service_control restart`.</span></span>
8. <span data-ttu-id="a7820-142">Test the connectivity between the Linux server and the ESXi host by using the `nc` command on the ESXi Host.</span><span class="sxs-lookup"><span data-stu-id="a7820-142">Test the connectivity between the Linux server and the ESXi host by using the `nc` command on the ESXi Host.</span></span> <span data-ttu-id="a7820-143">For example:</span><span class="sxs-lookup"><span data-stu-id="a7820-143">For example:</span></span>

    ```
    [root@ESXiHost:~] nc -z 123.456.789.101 1514
    Connection to 123.456.789.101 1514 port [tcp/*] succeeded!
    ```

9. <span data-ttu-id="a7820-144">In the OMS Portal, perform a log search for `Type=VMware_CL`.</span><span class="sxs-lookup"><span data-stu-id="a7820-144">In the OMS Portal, perform a log search for `Type=VMware_CL`.</span></span> <span data-ttu-id="a7820-145">When OMS collects the syslog data, it retains the syslog format.</span><span class="sxs-lookup"><span data-stu-id="a7820-145">When OMS collects the syslog data, it retains the syslog format.</span></span> <span data-ttu-id="a7820-146">In the portal, some specific fields are captured, such as *Hostname* and *ProcessName*.</span><span class="sxs-lookup"><span data-stu-id="a7820-146">In the portal, some specific fields are captured, such as *Hostname* and *ProcessName*.</span></span>  

    ![type](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/type.png)  

    <span data-ttu-id="a7820-148">If your view log search results are similar to the image above, you're set to use the OMS VMware Monitoring solution dashboard.</span><span class="sxs-lookup"><span data-stu-id="a7820-148">If your view log search results are similar to the image above, you're set to use the OMS VMware Monitoring solution dashboard.</span></span>  

## <a name="vmware-data-collection-details"></a><span data-ttu-id="a7820-149">VMware data collection details</span><span class="sxs-lookup"><span data-stu-id="a7820-149">VMware data collection details</span></span>
<span data-ttu-id="a7820-150">The VMware Monitoring solution collects various performance metrics and log data from ESXi hosts using the OMS Agents for Linux that you have enabled.</span><span class="sxs-lookup"><span data-stu-id="a7820-150">The VMware Monitoring solution collects various performance metrics and log data from ESXi hosts using the OMS Agents for Linux that you have enabled.</span></span>

<span data-ttu-id="a7820-151">The following table shows data collection methods and other details about how data is collected.</span><span class="sxs-lookup"><span data-stu-id="a7820-151">The following table shows data collection methods and other details about how data is collected.</span></span>

| <span data-ttu-id="a7820-152">platform</span><span class="sxs-lookup"><span data-stu-id="a7820-152">platform</span></span> | <span data-ttu-id="a7820-153">OMS Agent for Linux</span><span class="sxs-lookup"><span data-stu-id="a7820-153">OMS Agent for Linux</span></span> | <span data-ttu-id="a7820-154">SCOM agent</span><span class="sxs-lookup"><span data-stu-id="a7820-154">SCOM agent</span></span> | <span data-ttu-id="a7820-155">Azure Storage</span><span class="sxs-lookup"><span data-stu-id="a7820-155">Azure Storage</span></span> | <span data-ttu-id="a7820-156">SCOM required?</span><span class="sxs-lookup"><span data-stu-id="a7820-156">SCOM required?</span></span> | <span data-ttu-id="a7820-157">SCOM agent data sent via management group</span><span class="sxs-lookup"><span data-stu-id="a7820-157">SCOM agent data sent via management group</span></span> | <span data-ttu-id="a7820-158">collection frequency</span><span class="sxs-lookup"><span data-stu-id="a7820-158">collection frequency</span></span> |
| --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="a7820-159">Linux</span><span class="sxs-lookup"><span data-stu-id="a7820-159">Linux</span></span> |![Yes](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/oms-bullet-green.png) |![No](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/oms-bullet-red.png) |![No](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/oms-bullet-red.png) |![No](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-containers/oms-bullet-red.png) |![No](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/oms-bullet-red.png) |<span data-ttu-id="a7820-165">every 3 minutes</span><span class="sxs-lookup"><span data-stu-id="a7820-165">every 3 minutes</span></span> |

<span data-ttu-id="a7820-166">The following table show examples of data fields collected by the VMware Monitoring solution:</span><span class="sxs-lookup"><span data-stu-id="a7820-166">The following table show examples of data fields collected by the VMware Monitoring solution:</span></span>

| <span data-ttu-id="a7820-167">field name</span><span class="sxs-lookup"><span data-stu-id="a7820-167">field name</span></span> | <span data-ttu-id="a7820-168">description</span><span class="sxs-lookup"><span data-stu-id="a7820-168">description</span></span> |
| --- | --- |
| <span data-ttu-id="a7820-169">Device_s</span><span class="sxs-lookup"><span data-stu-id="a7820-169">Device_s</span></span> |<span data-ttu-id="a7820-170">VMware storage devices</span><span class="sxs-lookup"><span data-stu-id="a7820-170">VMware storage devices</span></span> |
| <span data-ttu-id="a7820-171">ESXIFailure_s</span><span class="sxs-lookup"><span data-stu-id="a7820-171">ESXIFailure_s</span></span> |<span data-ttu-id="a7820-172">failure types</span><span class="sxs-lookup"><span data-stu-id="a7820-172">failure types</span></span> |
| <span data-ttu-id="a7820-173">EventTime_t</span><span class="sxs-lookup"><span data-stu-id="a7820-173">EventTime_t</span></span> |<span data-ttu-id="a7820-174">time when event occurred</span><span class="sxs-lookup"><span data-stu-id="a7820-174">time when event occurred</span></span> |
| <span data-ttu-id="a7820-175">HostName_s</span><span class="sxs-lookup"><span data-stu-id="a7820-175">HostName_s</span></span> |<span data-ttu-id="a7820-176">ESXi host name</span><span class="sxs-lookup"><span data-stu-id="a7820-176">ESXi host name</span></span> |
| <span data-ttu-id="a7820-177">Operation_s</span><span class="sxs-lookup"><span data-stu-id="a7820-177">Operation_s</span></span> |<span data-ttu-id="a7820-178">create VM or delete VM</span><span class="sxs-lookup"><span data-stu-id="a7820-178">create VM or delete VM</span></span> |
| <span data-ttu-id="a7820-179">ProcessName_s</span><span class="sxs-lookup"><span data-stu-id="a7820-179">ProcessName_s</span></span> |<span data-ttu-id="a7820-180">event name</span><span class="sxs-lookup"><span data-stu-id="a7820-180">event name</span></span> |
| <span data-ttu-id="a7820-181">ResourceId_s</span><span class="sxs-lookup"><span data-stu-id="a7820-181">ResourceId_s</span></span> |<span data-ttu-id="a7820-182">name of the VMware host</span><span class="sxs-lookup"><span data-stu-id="a7820-182">name of the VMware host</span></span> |
| <span data-ttu-id="a7820-183">ResourceLocation_s</span><span class="sxs-lookup"><span data-stu-id="a7820-183">ResourceLocation_s</span></span> |<span data-ttu-id="a7820-184">VMware</span><span class="sxs-lookup"><span data-stu-id="a7820-184">VMware</span></span> |
| <span data-ttu-id="a7820-185">ResourceName_s</span><span class="sxs-lookup"><span data-stu-id="a7820-185">ResourceName_s</span></span> |<span data-ttu-id="a7820-186">VMware</span><span class="sxs-lookup"><span data-stu-id="a7820-186">VMware</span></span> |
| <span data-ttu-id="a7820-187">ResourceType_s</span><span class="sxs-lookup"><span data-stu-id="a7820-187">ResourceType_s</span></span> |<span data-ttu-id="a7820-188">Hyper-V</span><span class="sxs-lookup"><span data-stu-id="a7820-188">Hyper-V</span></span> |
| <span data-ttu-id="a7820-189">SCSIStatus_s</span><span class="sxs-lookup"><span data-stu-id="a7820-189">SCSIStatus_s</span></span> |<span data-ttu-id="a7820-190">VMware SCSI status</span><span class="sxs-lookup"><span data-stu-id="a7820-190">VMware SCSI status</span></span> |
| <span data-ttu-id="a7820-191">SyslogMessage_s</span><span class="sxs-lookup"><span data-stu-id="a7820-191">SyslogMessage_s</span></span> |<span data-ttu-id="a7820-192">Syslog data</span><span class="sxs-lookup"><span data-stu-id="a7820-192">Syslog data</span></span> |
| <span data-ttu-id="a7820-193">UserName_s</span><span class="sxs-lookup"><span data-stu-id="a7820-193">UserName_s</span></span> |<span data-ttu-id="a7820-194">user who created or deleted VM</span><span class="sxs-lookup"><span data-stu-id="a7820-194">user who created or deleted VM</span></span> |
| <span data-ttu-id="a7820-195">VMName_s</span><span class="sxs-lookup"><span data-stu-id="a7820-195">VMName_s</span></span> |<span data-ttu-id="a7820-196">VM name</span><span class="sxs-lookup"><span data-stu-id="a7820-196">VM name</span></span> |
| <span data-ttu-id="a7820-197">Computer</span><span class="sxs-lookup"><span data-stu-id="a7820-197">Computer</span></span> |<span data-ttu-id="a7820-198">host computer</span><span class="sxs-lookup"><span data-stu-id="a7820-198">host computer</span></span> |
| <span data-ttu-id="a7820-199">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="a7820-199">TimeGenerated</span></span> |<span data-ttu-id="a7820-200">time the data was generated</span><span class="sxs-lookup"><span data-stu-id="a7820-200">time the data was generated</span></span> |
| <span data-ttu-id="a7820-201">DataCenter_s</span><span class="sxs-lookup"><span data-stu-id="a7820-201">DataCenter_s</span></span> |<span data-ttu-id="a7820-202">VMware datacenter</span><span class="sxs-lookup"><span data-stu-id="a7820-202">VMware datacenter</span></span> |
| <span data-ttu-id="a7820-203">StorageLatency_s</span><span class="sxs-lookup"><span data-stu-id="a7820-203">StorageLatency_s</span></span> |<span data-ttu-id="a7820-204">storage latency (ms)</span><span class="sxs-lookup"><span data-stu-id="a7820-204">storage latency (ms)</span></span> |

## <a name="vmware-monitoring-solution-overview"></a><span data-ttu-id="a7820-205">VMware Monitoring solution overview</span><span class="sxs-lookup"><span data-stu-id="a7820-205">VMware Monitoring solution overview</span></span>
<span data-ttu-id="a7820-206">The VMware tile appears in the OMS portal.</span><span class="sxs-lookup"><span data-stu-id="a7820-206">The VMware tile appears in the OMS portal.</span></span> <span data-ttu-id="a7820-207">It provides a high-level view of any failures.</span><span class="sxs-lookup"><span data-stu-id="a7820-207">It provides a high-level view of any failures.</span></span> <span data-ttu-id="a7820-208">When you click the tile, you go into a dashboard view.</span><span class="sxs-lookup"><span data-stu-id="a7820-208">When you click the tile, you go into a dashboard view.</span></span>

![tile](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/tile.png)

#### <a name="navigate-the-dashboard-view"></a><span data-ttu-id="a7820-210">Navigate the dashboard view</span><span class="sxs-lookup"><span data-stu-id="a7820-210">Navigate the dashboard view</span></span>
<span data-ttu-id="a7820-211">In the **VMware** dashboard view, blades are organized by:</span><span class="sxs-lookup"><span data-stu-id="a7820-211">In the **VMware** dashboard view, blades are organized by:</span></span>

* <span data-ttu-id="a7820-212">Failure Status Count</span><span class="sxs-lookup"><span data-stu-id="a7820-212">Failure Status Count</span></span>
* <span data-ttu-id="a7820-213">Top Host by Event Counts</span><span class="sxs-lookup"><span data-stu-id="a7820-213">Top Host by Event Counts</span></span>
* <span data-ttu-id="a7820-214">Top Event Counts</span><span class="sxs-lookup"><span data-stu-id="a7820-214">Top Event Counts</span></span>
* <span data-ttu-id="a7820-215">Virtual Machine Activities</span><span class="sxs-lookup"><span data-stu-id="a7820-215">Virtual Machine Activities</span></span>
* <span data-ttu-id="a7820-216">ESXi Host Disk Events</span><span class="sxs-lookup"><span data-stu-id="a7820-216">ESXi Host Disk Events</span></span>

![solution1](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/solutionview1-1.png)

![solution2](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/solutionview1-2.png)

<span data-ttu-id="a7820-219">Click any blade to open Log Analytics search pane that shows detailed information specific for the blade.</span><span class="sxs-lookup"><span data-stu-id="a7820-219">Click any blade to open Log Analytics search pane that shows detailed information specific for the blade.</span></span>

<span data-ttu-id="a7820-220">From here, you can edit the search query to modify it for something specific.</span><span class="sxs-lookup"><span data-stu-id="a7820-220">From here, you can edit the search query to modify it for something specific.</span></span> <span data-ttu-id="a7820-221">For a tutorial on the basics of OMS search, check out the [OMS log search tutorial.](log-analytics-log-searches.md)</span><span class="sxs-lookup"><span data-stu-id="a7820-221">For a tutorial on the basics of OMS search, check out the [OMS log search tutorial.](log-analytics-log-searches.md)</span></span>

#### <a name="find-esxi-host-events"></a><span data-ttu-id="a7820-222">Find ESXi host events</span><span class="sxs-lookup"><span data-stu-id="a7820-222">Find ESXi host events</span></span>
<span data-ttu-id="a7820-223">A single ESXi host generates multiple logs, based on their processes.</span><span class="sxs-lookup"><span data-stu-id="a7820-223">A single ESXi host generates multiple logs, based on their processes.</span></span> <span data-ttu-id="a7820-224">The VMware Monitoring solution centralizes them and summarizes the event counts.</span><span class="sxs-lookup"><span data-stu-id="a7820-224">The VMware Monitoring solution centralizes them and summarizes the event counts.</span></span> <span data-ttu-id="a7820-225">This centralized view helps you understand which ESXi host has a high volume of events and what events occur most frequently in your environment.</span><span class="sxs-lookup"><span data-stu-id="a7820-225">This centralized view helps you understand which ESXi host has a high volume of events and what events occur most frequently in your environment.</span></span>

![event](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/events.png)

<span data-ttu-id="a7820-227">You can drill further by clicking an ESXi host or an event type.</span><span class="sxs-lookup"><span data-stu-id="a7820-227">You can drill further by clicking an ESXi host or an event type.</span></span>

<span data-ttu-id="a7820-228">When you click an ESXi host name, you view information from that ESXi host.</span><span class="sxs-lookup"><span data-stu-id="a7820-228">When you click an ESXi host name, you view information from that ESXi host.</span></span> <span data-ttu-id="a7820-229">If you want to narrow results with the event type, add `“ProcessName_s=EVENT TYPE”` in your search query.</span><span class="sxs-lookup"><span data-stu-id="a7820-229">If you want to narrow results with the event type, add `“ProcessName_s=EVENT TYPE”` in your search query.</span></span> <span data-ttu-id="a7820-230">You can select **ProcessName** in the search filter.</span><span class="sxs-lookup"><span data-stu-id="a7820-230">You can select **ProcessName** in the search filter.</span></span> <span data-ttu-id="a7820-231">That narrows the information for you.</span><span class="sxs-lookup"><span data-stu-id="a7820-231">That narrows the information for you.</span></span>

![drill](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/eventhostdrilldown.png)

#### <a name="find-high-vm-activities"></a><span data-ttu-id="a7820-233">Find high VM activities</span><span class="sxs-lookup"><span data-stu-id="a7820-233">Find high VM activities</span></span>
<span data-ttu-id="a7820-234">A virtual machine can be created and deleted on any ESXi host.</span><span class="sxs-lookup"><span data-stu-id="a7820-234">A virtual machine can be created and deleted on any ESXi host.</span></span> <span data-ttu-id="a7820-235">It's helpful for an administrator to identify how many VMs an ESXi host creates.</span><span class="sxs-lookup"><span data-stu-id="a7820-235">It's helpful for an administrator to identify how many VMs an ESXi host creates.</span></span> <span data-ttu-id="a7820-236">That in-turn, helps to understand performance and capacity planning.</span><span class="sxs-lookup"><span data-stu-id="a7820-236">That in-turn, helps to understand performance and capacity planning.</span></span> <span data-ttu-id="a7820-237">Keeping track of VM activity events is crucial when managing your environment.</span><span class="sxs-lookup"><span data-stu-id="a7820-237">Keeping track of VM activity events is crucial when managing your environment.</span></span>

![drill](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/vmactivities1.png)

<span data-ttu-id="a7820-239">If you want to see additional ESXi host VM creation data, click an ESXi host name.</span><span class="sxs-lookup"><span data-stu-id="a7820-239">If you want to see additional ESXi host VM creation data, click an ESXi host name.</span></span>

![drill](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/createvm.png)

#### <a name="common-search-queries"></a><span data-ttu-id="a7820-241">Common search queries</span><span class="sxs-lookup"><span data-stu-id="a7820-241">Common search queries</span></span>
<span data-ttu-id="a7820-242">The solution includes other useful queries that can help you manage your ESXi hosts, such as high storage space, storage latency, and path failure.</span><span class="sxs-lookup"><span data-stu-id="a7820-242">The solution includes other useful queries that can help you manage your ESXi hosts, such as high storage space, storage latency, and path failure.</span></span>

![queries](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/queries.png)

#### <a name="save-queries"></a><span data-ttu-id="a7820-244">Save queries</span><span class="sxs-lookup"><span data-stu-id="a7820-244">Save queries</span></span>
<span data-ttu-id="a7820-245">Saving search queries is a standard feature in OMS and can help you keep any queries that you’ve found useful.</span><span class="sxs-lookup"><span data-stu-id="a7820-245">Saving search queries is a standard feature in OMS and can help you keep any queries that you’ve found useful.</span></span> <span data-ttu-id="a7820-246">After you create a query that you find useful, save it by clicking the **Favorites**.</span><span class="sxs-lookup"><span data-stu-id="a7820-246">After you create a query that you find useful, save it by clicking the **Favorites**.</span></span> <span data-ttu-id="a7820-247">A saved query lets you easily reuse it later from the [My Dashboard](log-analytics-dashboards.md) page where you can create your own custom dashboards.</span><span class="sxs-lookup"><span data-stu-id="a7820-247">A saved query lets you easily reuse it later from the [My Dashboard](log-analytics-dashboards.md) page where you can create your own custom dashboards.</span></span>

![DockerDashboardView](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-vmware/dockerdashboardview.png)

#### <a name="create-alerts-from-queries"></a><span data-ttu-id="a7820-249">Create alerts from queries</span><span class="sxs-lookup"><span data-stu-id="a7820-249">Create alerts from queries</span></span>
<span data-ttu-id="a7820-250">After you’ve created your queries, you might want to use the queries to alert you when specific events occur.</span><span class="sxs-lookup"><span data-stu-id="a7820-250">After you’ve created your queries, you might want to use the queries to alert you when specific events occur.</span></span> <span data-ttu-id="a7820-251">See [Alerts in Log Analytics](log-analytics-alerts.md) for information about how to create alerts.</span><span class="sxs-lookup"><span data-stu-id="a7820-251">See [Alerts in Log Analytics](log-analytics-alerts.md) for information about how to create alerts.</span></span> <span data-ttu-id="a7820-252">For examples of alerting queries and other query examples, see the [Monitor VMware using OMS Log Analytics](https://blogs.technet.microsoft.com/msoms/2016/06/15/monitor-vmware-using-oms-log-analytics) blog post.</span><span class="sxs-lookup"><span data-stu-id="a7820-252">For examples of alerting queries and other query examples, see the [Monitor VMware using OMS Log Analytics](https://blogs.technet.microsoft.com/msoms/2016/06/15/monitor-vmware-using-oms-log-analytics) blog post.</span></span>

## <a name="frequently-asked-questions"></a><span data-ttu-id="a7820-253">Frequently asked questions</span><span class="sxs-lookup"><span data-stu-id="a7820-253">Frequently asked questions</span></span>
### <a name="what-do-i-need-to-do-on-the-esxi-host-setting-what-impact-will-it-have-on-my-current-environment"></a><span data-ttu-id="a7820-254">What do I need to do on the ESXi host setting?</span><span class="sxs-lookup"><span data-stu-id="a7820-254">What do I need to do on the ESXi host setting?</span></span> <span data-ttu-id="a7820-255">What impact will it have on my current environment?</span><span class="sxs-lookup"><span data-stu-id="a7820-255">What impact will it have on my current environment?</span></span>
<span data-ttu-id="a7820-256">The solution uses the native ESXi Host Syslog forwarding mechanism.</span><span class="sxs-lookup"><span data-stu-id="a7820-256">The solution uses the native ESXi Host Syslog forwarding mechanism.</span></span> <span data-ttu-id="a7820-257">You don't need any additional Microsoft software on the ESXi Host to capture the logs.</span><span class="sxs-lookup"><span data-stu-id="a7820-257">You don't need any additional Microsoft software on the ESXi Host to capture the logs.</span></span> <span data-ttu-id="a7820-258">It should have a low impact to your existing environment.</span><span class="sxs-lookup"><span data-stu-id="a7820-258">It should have a low impact to your existing environment.</span></span> <span data-ttu-id="a7820-259">However, you do need to set syslog forwarding, which is ESXI functionality.</span><span class="sxs-lookup"><span data-stu-id="a7820-259">However, you do need to set syslog forwarding, which is ESXI functionality.</span></span>

### <a name="do-i-need-to-restart-my-esxi-host"></a><span data-ttu-id="a7820-260">Do I need to restart my ESXi host?</span><span class="sxs-lookup"><span data-stu-id="a7820-260">Do I need to restart my ESXi host?</span></span>
<span data-ttu-id="a7820-261">No.</span><span class="sxs-lookup"><span data-stu-id="a7820-261">No.</span></span> <span data-ttu-id="a7820-262">This process does not require a restart.</span><span class="sxs-lookup"><span data-stu-id="a7820-262">This process does not require a restart.</span></span> <span data-ttu-id="a7820-263">Sometimes, vSphere does not properly update the syslog.</span><span class="sxs-lookup"><span data-stu-id="a7820-263">Sometimes, vSphere does not properly update the syslog.</span></span> <span data-ttu-id="a7820-264">In such a case, log on to the ESXi host and reload the syslog.</span><span class="sxs-lookup"><span data-stu-id="a7820-264">In such a case, log on to the ESXi host and reload the syslog.</span></span> <span data-ttu-id="a7820-265">Again, you don't have to restart the host, so this process isn't disruptive to your environment.</span><span class="sxs-lookup"><span data-stu-id="a7820-265">Again, you don't have to restart the host, so this process isn't disruptive to your environment.</span></span>

### <a name="can-i-increase-or-decrease-the-volume-of-log-data-sent-to-oms"></a><span data-ttu-id="a7820-266">Can I increase or decrease the volume of log data sent to OMS?</span><span class="sxs-lookup"><span data-stu-id="a7820-266">Can I increase or decrease the volume of log data sent to OMS?</span></span>
<span data-ttu-id="a7820-267">Yes you can.</span><span class="sxs-lookup"><span data-stu-id="a7820-267">Yes you can.</span></span> <span data-ttu-id="a7820-268">You can use the ESXi Host Log Level settings in vSphere.</span><span class="sxs-lookup"><span data-stu-id="a7820-268">You can use the ESXi Host Log Level settings in vSphere.</span></span> <span data-ttu-id="a7820-269">Log collection is based on the *info* level.</span><span class="sxs-lookup"><span data-stu-id="a7820-269">Log collection is based on the *info* level.</span></span> <span data-ttu-id="a7820-270">So, if you want to audit VM creation or deletion, you need to keep the *info* level on Hostd.</span><span class="sxs-lookup"><span data-stu-id="a7820-270">So, if you want to audit VM creation or deletion, you need to keep the *info* level on Hostd.</span></span> <span data-ttu-id="a7820-271">For more information, see the [VMware Knowledge Base](https://kb.vmware.com/selfservice/microsites/search.do?&cmd=displayKC&externalId=1017658).</span><span class="sxs-lookup"><span data-stu-id="a7820-271">For more information, see the [VMware Knowledge Base](https://kb.vmware.com/selfservice/microsites/search.do?&cmd=displayKC&externalId=1017658).</span></span>

### <a name="why-is-hostd-not-providing-data-to-oms-my-log-setting-is-set-to-info"></a><span data-ttu-id="a7820-272">Why is Hostd not providing data to OMS?</span><span class="sxs-lookup"><span data-stu-id="a7820-272">Why is Hostd not providing data to OMS?</span></span> <span data-ttu-id="a7820-273">My log setting is set to info.</span><span class="sxs-lookup"><span data-stu-id="a7820-273">My log setting is set to info.</span></span>
<span data-ttu-id="a7820-274">There was an ESXi host bug for the syslog timestamp.</span><span class="sxs-lookup"><span data-stu-id="a7820-274">There was an ESXi host bug for the syslog timestamp.</span></span> <span data-ttu-id="a7820-275">For more information, see the [VMware Knowledge Base](https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2111202).</span><span class="sxs-lookup"><span data-stu-id="a7820-275">For more information, see the [VMware Knowledge Base](https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2111202).</span></span> <span data-ttu-id="a7820-276">After you apply the workaround, Hostd should function normally.</span><span class="sxs-lookup"><span data-stu-id="a7820-276">After you apply the workaround, Hostd should function normally.</span></span>

### <a name="can-i-have-multiple-esxi-hosts-forwarding-syslog-data-to-a-single-vm-with-omsagent"></a><span data-ttu-id="a7820-277">Can I have multiple ESXi hosts forwarding syslog data to a single VM with omsagent?</span><span class="sxs-lookup"><span data-stu-id="a7820-277">Can I have multiple ESXi hosts forwarding syslog data to a single VM with omsagent?</span></span>
<span data-ttu-id="a7820-278">Yes.</span><span class="sxs-lookup"><span data-stu-id="a7820-278">Yes.</span></span> <span data-ttu-id="a7820-279">You can have multiple ESXi hosts forwarding to a single VM with omsagent.</span><span class="sxs-lookup"><span data-stu-id="a7820-279">You can have multiple ESXi hosts forwarding to a single VM with omsagent.</span></span>

### <a name="why-dont-i-see-data-flowing-into-oms"></a><span data-ttu-id="a7820-280">Why don't I see data flowing into OMS?</span><span class="sxs-lookup"><span data-stu-id="a7820-280">Why don't I see data flowing into OMS?</span></span>
<span data-ttu-id="a7820-281">There can be multiple reasons:</span><span class="sxs-lookup"><span data-stu-id="a7820-281">There can be multiple reasons:</span></span>

* <span data-ttu-id="a7820-282">The ESXi host is not correctly pushing data to the VM running omsagent.</span><span class="sxs-lookup"><span data-stu-id="a7820-282">The ESXi host is not correctly pushing data to the VM running omsagent.</span></span> <span data-ttu-id="a7820-283">To test, perform the following steps:</span><span class="sxs-lookup"><span data-stu-id="a7820-283">To test, perform the following steps:</span></span>

  1. <span data-ttu-id="a7820-284">To confirm, log on to the ESXi host using ssh and run the following command: `nc -z ipaddressofVM 1514`</span><span class="sxs-lookup"><span data-stu-id="a7820-284">To confirm, log on to the ESXi host using ssh and run the following command: `nc -z ipaddressofVM 1514`</span></span>

      <span data-ttu-id="a7820-285">If this is not successful, vSphere settings in the Advanced Configuration are likely not correct.</span><span class="sxs-lookup"><span data-stu-id="a7820-285">If this is not successful, vSphere settings in the Advanced Configuration are likely not correct.</span></span> <span data-ttu-id="a7820-286">See [Configure syslog collection](#configure-syslog-collection) for information about how to set up the ESXi host for syslog forwarding.</span><span class="sxs-lookup"><span data-stu-id="a7820-286">See [Configure syslog collection](#configure-syslog-collection) for information about how to set up the ESXi host for syslog forwarding.</span></span>
  2. <span data-ttu-id="a7820-287">If syslog port connectivity is successful, but you don't still see any data, then reload the syslog on the ESXi host by using ssh to run the following command: ` esxcli system syslog reload`</span><span class="sxs-lookup"><span data-stu-id="a7820-287">If syslog port connectivity is successful, but you don't still see any data, then reload the syslog on the ESXi host by using ssh to run the following command: ` esxcli system syslog reload`</span></span>
* <span data-ttu-id="a7820-288">The VM with OMS Agent is not set correctly.</span><span class="sxs-lookup"><span data-stu-id="a7820-288">The VM with OMS Agent is not set correctly.</span></span> <span data-ttu-id="a7820-289">To test this, perform the following steps:</span><span class="sxs-lookup"><span data-stu-id="a7820-289">To test this, perform the following steps:</span></span>

  1. <span data-ttu-id="a7820-290">OMS listens to the port 1514 and pushes data into OMS.</span><span class="sxs-lookup"><span data-stu-id="a7820-290">OMS listens to the port 1514 and pushes data into OMS.</span></span> <span data-ttu-id="a7820-291">To verify that it is open, run the following command: `netstat -a | grep 1514`</span><span class="sxs-lookup"><span data-stu-id="a7820-291">To verify that it is open, run the following command: `netstat -a | grep 1514`</span></span>
  2. <span data-ttu-id="a7820-292">You should see port `1514/tcp` open.</span><span class="sxs-lookup"><span data-stu-id="a7820-292">You should see port `1514/tcp` open.</span></span> <span data-ttu-id="a7820-293">If you do not, verify that the omsagent is installed correctly.</span><span class="sxs-lookup"><span data-stu-id="a7820-293">If you do not, verify that the omsagent is installed correctly.</span></span> <span data-ttu-id="a7820-294">If you do not see the port information, then the syslog port is not open on the VM.</span><span class="sxs-lookup"><span data-stu-id="a7820-294">If you do not see the port information, then the syslog port is not open on the VM.</span></span>

     1. <span data-ttu-id="a7820-295">Verify that the OMS Agent is running by using `ps -ef | grep oms`.</span><span class="sxs-lookup"><span data-stu-id="a7820-295">Verify that the OMS Agent is running by using `ps -ef | grep oms`.</span></span> <span data-ttu-id="a7820-296">If it is not running, start the process by running the command ` sudo /opt/microsoft/omsagent/bin/service_control start`</span><span class="sxs-lookup"><span data-stu-id="a7820-296">If it is not running, start the process by running the command ` sudo /opt/microsoft/omsagent/bin/service_control start`</span></span>
     2. <span data-ttu-id="a7820-297">Open the `/etc/opt/microsoft/omsagent/conf/omsagent.d/vmware_esxi.conf` file.</span><span class="sxs-lookup"><span data-stu-id="a7820-297">Open the `/etc/opt/microsoft/omsagent/conf/omsagent.d/vmware_esxi.conf` file.</span></span>

         <span data-ttu-id="a7820-298">Verify that the proper user and group setting is valid, similar to: `-rw-r--r-- 1 omsagent omiusers 677 Sep 20 16:46 vmware_esxi.conf`</span><span class="sxs-lookup"><span data-stu-id="a7820-298">Verify that the proper user and group setting is valid, similar to: `-rw-r--r-- 1 omsagent omiusers 677 Sep 20 16:46 vmware_esxi.conf`</span></span>

         <span data-ttu-id="a7820-299">If the file does not exist or the user and group setting is wrong, take corrective action by [Preparing a Linux server](#prepare-a-linux-server).</span><span class="sxs-lookup"><span data-stu-id="a7820-299">If the file does not exist or the user and group setting is wrong, take corrective action by [Preparing a Linux server](#prepare-a-linux-server).</span></span>

## <a name="next-steps"></a><span data-ttu-id="a7820-300">Next steps</span><span class="sxs-lookup"><span data-stu-id="a7820-300">Next steps</span></span>
* <span data-ttu-id="a7820-301">Use [Log Searches](log-analytics-log-searches.md) in Log Analytics to view detailed VMware host data.</span><span class="sxs-lookup"><span data-stu-id="a7820-301">Use [Log Searches](log-analytics-log-searches.md) in Log Analytics to view detailed VMware host data.</span></span>
* <span data-ttu-id="a7820-302">[Create your own dashboards](log-analytics-dashboards.md) showing VMware host data.</span><span class="sxs-lookup"><span data-stu-id="a7820-302">[Create your own dashboards](log-analytics-dashboards.md) showing VMware host data.</span></span>
* <span data-ttu-id="a7820-303">[Create alerts](log-analytics-alerts.md) when specific VMware host events occur.</span><span class="sxs-lookup"><span data-stu-id="a7820-303">[Create alerts](log-analytics-alerts.md) when specific VMware host events occur.</span></span>



















