---
title: Respond to events with Azure Log Analytics Alerts | Microsoft Docs
description: This tutorial helps you understand alerting with Log Analytics to identify important information in your workspace and proactively notify you of issues or invoke actions to attempt to correct them.
services: log-analytics
documentationcenter: log-analytics
author: mgoedtel
manager: carmonm
editor: ''
ms.assetid: abb07f6c-b356-4f15-85f5-60e4415d0ba2
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: tutorial
ms.date: 07/30/2018
ms.author: magoedte
ms.custom: mvc
ms.component: na
ms.openlocfilehash: c6c7b3f897e38fbd67098c9f881380bc073f13da
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44867800"
---
# <a name="respond-to-events-with-azure-monitor-alerts"></a><span data-ttu-id="94cae-103">Respond to events with Azure Monitor Alerts</span><span class="sxs-lookup"><span data-stu-id="94cae-103">Respond to events with Azure Monitor Alerts</span></span>
<span data-ttu-id="94cae-104">Log search rules are created by Azure Alerts to automatically run specified log queries at regular intervals.</span><span class="sxs-lookup"><span data-stu-id="94cae-104">Log search rules are created by Azure Alerts to automatically run specified log queries at regular intervals.</span></span>  <span data-ttu-id="94cae-105">If the results of the log query match particular criteria, then an alert record is created.</span><span class="sxs-lookup"><span data-stu-id="94cae-105">If the results of the log query match particular criteria, then an alert record is created.</span></span> <span data-ttu-id="94cae-106">The rule can then automatically run one or more actions using [Action Groups](../monitoring-and-diagnostics/monitoring-action-groups.md).</span><span class="sxs-lookup"><span data-stu-id="94cae-106">The rule can then automatically run one or more actions using [Action Groups](../monitoring-and-diagnostics/monitoring-action-groups.md).</span></span>  <span data-ttu-id="94cae-107">This tutorial is a continuation of the [Create and share dashboards of Log Analytics data](log-analytics-tutorial-dashboards.md) tutorial.</span><span class="sxs-lookup"><span data-stu-id="94cae-107">This tutorial is a continuation of the [Create and share dashboards of Log Analytics data](log-analytics-tutorial-dashboards.md) tutorial.</span></span>   

<span data-ttu-id="94cae-108">In this tutorial, you learn how to:</span><span class="sxs-lookup"><span data-stu-id="94cae-108">In this tutorial, you learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="94cae-109">Create an alert rule</span><span class="sxs-lookup"><span data-stu-id="94cae-109">Create an alert rule</span></span>
> * <span data-ttu-id="94cae-110">Configure an Action Group to send an e-mail notification</span><span class="sxs-lookup"><span data-stu-id="94cae-110">Configure an Action Group to send an e-mail notification</span></span>

<span data-ttu-id="94cae-111">To complete the example in this tutorial, you must have an existing virtual machine [connected to the Log Analytics workspace](log-analytics-quick-collect-azurevm.md).</span><span class="sxs-lookup"><span data-stu-id="94cae-111">To complete the example in this tutorial, you must have an existing virtual machine [connected to the Log Analytics workspace](log-analytics-quick-collect-azurevm.md).</span></span>

## <a name="sign-in-to-azure-portal"></a><span data-ttu-id="94cae-112">Sign in to Azure portal</span><span class="sxs-lookup"><span data-stu-id="94cae-112">Sign in to Azure portal</span></span>
<span data-ttu-id="94cae-113">Log in to the Azure portal at [https://portal.azure.com](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="94cae-113">Log in to the Azure portal at [https://portal.azure.com](https://portal.azure.com).</span></span>

## <a name="create-alerts"></a><span data-ttu-id="94cae-114">Create alerts</span><span class="sxs-lookup"><span data-stu-id="94cae-114">Create alerts</span></span>
<span data-ttu-id="94cae-115">Alerts are created by alert rules in Azure Monitor and can automatically run saved queries or custom log searches at regular intervals.</span><span class="sxs-lookup"><span data-stu-id="94cae-115">Alerts are created by alert rules in Azure Monitor and can automatically run saved queries or custom log searches at regular intervals.</span></span>  <span data-ttu-id="94cae-116">You can create alerts based on specific performance metrics or when certain events are created, absence of an event, or a number of events are created within a particular time window.</span><span class="sxs-lookup"><span data-stu-id="94cae-116">You can create alerts based on specific performance metrics or when certain events are created, absence of an event, or a number of events are created within a particular time window.</span></span>  <span data-ttu-id="94cae-117">For example, alerts can be used to notify you when average CPU usage exceeds a certain threshold, when a missing update is detected, or when an event is generated upon detecting that a specific Windows service or Linux daemon is not running.</span><span class="sxs-lookup"><span data-stu-id="94cae-117">For example, alerts can be used to notify you when average CPU usage exceeds a certain threshold, when a missing update is detected, or when an event is generated upon detecting that a specific Windows service or Linux daemon is not running.</span></span>  <span data-ttu-id="94cae-118">If the results of the log search match particular criteria, then an alert is created.</span><span class="sxs-lookup"><span data-stu-id="94cae-118">If the results of the log search match particular criteria, then an alert is created.</span></span> <span data-ttu-id="94cae-119">The rule can then automatically run one or more actions, such as notify you of the alert or invoke another process.</span><span class="sxs-lookup"><span data-stu-id="94cae-119">The rule can then automatically run one or more actions, such as notify you of the alert or invoke another process.</span></span>

<span data-ttu-id="94cae-120">In the following example, you create a metric measurement alert rule based off of the *Azure VMs - Processor Utilization* query saved in the [Visualize data tutorial](log-analytics-tutorial-dashboards.md).</span><span class="sxs-lookup"><span data-stu-id="94cae-120">In the following example, you create a metric measurement alert rule based off of the *Azure VMs - Processor Utilization* query saved in the [Visualize data tutorial](log-analytics-tutorial-dashboards.md).</span></span> <span data-ttu-id="94cae-121">An alert is created for each virtual machine that exceeds a threshold of 90%.</span><span class="sxs-lookup"><span data-stu-id="94cae-121">An alert is created for each virtual machine that exceeds a threshold of 90%.</span></span>

1. <span data-ttu-id="94cae-122">In the Azure portal, click **All services**.</span><span class="sxs-lookup"><span data-stu-id="94cae-122">In the Azure portal, click **All services**.</span></span> <span data-ttu-id="94cae-123">In the list of resources, type **Monitor**.</span><span class="sxs-lookup"><span data-stu-id="94cae-123">In the list of resources, type **Monitor**.</span></span> <span data-ttu-id="94cae-124">As you begin typing, the list filters based on your input.</span><span class="sxs-lookup"><span data-stu-id="94cae-124">As you begin typing, the list filters based on your input.</span></span> <span data-ttu-id="94cae-125">Select **Monitor**.</span><span class="sxs-lookup"><span data-stu-id="94cae-125">Select **Monitor**.</span></span>
1. <span data-ttu-id="94cae-126">In the left-hand pane, select **Alerts** and then click **New Alert Rule** from the top of the page to create a new alert.</span><span class="sxs-lookup"><span data-stu-id="94cae-126">In the left-hand pane, select **Alerts** and then click **New Alert Rule** from the top of the page to create a new alert.</span></span>

    ![Create new alert rule](./media/log-analytics-tutorial-response/alert-rule-02.png)

1. <span data-ttu-id="94cae-128">For the first step, under the **Create Alert** section, you are going to select your Log Analytics workspace as the resource, since this is a log based alert signal.</span><span class="sxs-lookup"><span data-stu-id="94cae-128">For the first step, under the **Create Alert** section, you are going to select your Log Analytics workspace as the resource, since this is a log based alert signal.</span></span>  <span data-ttu-id="94cae-129">Filter the results by choosing the specific **Subscription** from the drop-down list if you have more than one, which contains the VM and Log Analytics workspace created earlier.</span><span class="sxs-lookup"><span data-stu-id="94cae-129">Filter the results by choosing the specific **Subscription** from the drop-down list if you have more than one, which contains the VM and Log Analytics workspace created earlier.</span></span>  <span data-ttu-id="94cae-130">Filter the **Resource Type** by selecting **Log Analytics** from the drop-down list.</span><span class="sxs-lookup"><span data-stu-id="94cae-130">Filter the **Resource Type** by selecting **Log Analytics** from the drop-down list.</span></span>  <span data-ttu-id="94cae-131">Finally, select the **Resource** **DefaultLAWorkspace** and then click **Done**.</span><span class="sxs-lookup"><span data-stu-id="94cae-131">Finally, select the **Resource** **DefaultLAWorkspace** and then click **Done**.</span></span>

    ![Create alert step 1 task](./media/log-analytics-tutorial-response/alert-rule-03.png)

1. <span data-ttu-id="94cae-133">Under the section **Alert Criteria**, click **Add Criteria** to define the query and then specify logic that the alert rule follows.</span><span class="sxs-lookup"><span data-stu-id="94cae-133">Under the section **Alert Criteria**, click **Add Criteria** to define the query and then specify logic that the alert rule follows.</span></span> <span data-ttu-id="94cae-134">From the **Configure signal logic** pane, select **Custom log search** as signal name and enter your query in **Search query**.</span><span class="sxs-lookup"><span data-stu-id="94cae-134">From the **Configure signal logic** pane, select **Custom log search** as signal name and enter your query in **Search query**.</span></span>

    <span data-ttu-id="94cae-135">For example:</span><span class="sxs-lookup"><span data-stu-id="94cae-135">For example:</span></span>
    ```
    Perf
    | where CounterName == "% Processor Time" and ObjectName == "Processor" and InstanceName == "_Total"
    | summarize AggregatedValue=avg(CounterValue) by bin(TimeGenerated, 1m)
    ```

    <span data-ttu-id="94cae-136">The pane updates to present the configuration settings for the alert.</span><span class="sxs-lookup"><span data-stu-id="94cae-136">The pane updates to present the configuration settings for the alert.</span></span>  <span data-ttu-id="94cae-137">On the top, it shows the results for the last 30 minutes of the selected signal.</span><span class="sxs-lookup"><span data-stu-id="94cae-137">On the top, it shows the results for the last 30 minutes of the selected signal.</span></span>

1. <span data-ttu-id="94cae-138">Configure the alert with the following information:</span><span class="sxs-lookup"><span data-stu-id="94cae-138">Configure the alert with the following information:</span></span>  
   <span data-ttu-id="94cae-139">a.</span><span class="sxs-lookup"><span data-stu-id="94cae-139">a.</span></span> <span data-ttu-id="94cae-140">From the \**Based on* drop-down list select **Metric measurement**.</span><span class="sxs-lookup"><span data-stu-id="94cae-140">From the \**Based on* drop-down list select **Metric measurement**.</span></span>  <span data-ttu-id="94cae-141">A metric measurement will create an alert for each object in the query with a value that exceeds our specified threshold.</span><span class="sxs-lookup"><span data-stu-id="94cae-141">A metric measurement will create an alert for each object in the query with a value that exceeds our specified threshold.</span></span>  
   <span data-ttu-id="94cae-142">b.</span><span class="sxs-lookup"><span data-stu-id="94cae-142">b.</span></span> <span data-ttu-id="94cae-143">For the **Condition**, select **Greater than** and enter **90** for **Threshold**.</span><span class="sxs-lookup"><span data-stu-id="94cae-143">For the **Condition**, select **Greater than** and enter **90** for **Threshold**.</span></span>  
   <span data-ttu-id="94cae-144">c.</span><span class="sxs-lookup"><span data-stu-id="94cae-144">c.</span></span> <span data-ttu-id="94cae-145">Under Trigger Alert Based On section, select **Consecutive breaches** and from the drop-down list select **Greater than** enter a value of 3.</span><span class="sxs-lookup"><span data-stu-id="94cae-145">Under Trigger Alert Based On section, select **Consecutive breaches** and from the drop-down list select **Greater than** enter a value of 3.</span></span>  
   <span data-ttu-id="94cae-146">d.</span><span class="sxs-lookup"><span data-stu-id="94cae-146">d.</span></span> <span data-ttu-id="94cae-147">Under Evaluation based on section, accept the defaults.</span><span class="sxs-lookup"><span data-stu-id="94cae-147">Under Evaluation based on section, accept the defaults.</span></span> <span data-ttu-id="94cae-148">The rule will run every five minutes and return records that were created within this range of the current time.</span><span class="sxs-lookup"><span data-stu-id="94cae-148">The rule will run every five minutes and return records that were created within this range of the current time.</span></span>  
1. <span data-ttu-id="94cae-149">Click **Done** to complete the alert rule.</span><span class="sxs-lookup"><span data-stu-id="94cae-149">Click **Done** to complete the alert rule.</span></span>

    ![Configure alert signal](./media/log-analytics-tutorial-response/alert-signal-logic-02.png)

1. <span data-ttu-id="94cae-151">Now moving onto the second step, provide a name of your alert in the **Alert rule name** field, such as **Percentage CPU greater than 90 percent**.</span><span class="sxs-lookup"><span data-stu-id="94cae-151">Now moving onto the second step, provide a name of your alert in the **Alert rule name** field, such as **Percentage CPU greater than 90 percent**.</span></span>  <span data-ttu-id="94cae-152">Specify a **Description** detailing specifics for the alert, and select **Critical(Sev 0)** for the **Severity** value from the options provided.</span><span class="sxs-lookup"><span data-stu-id="94cae-152">Specify a **Description** detailing specifics for the alert, and select **Critical(Sev 0)** for the **Severity** value from the options provided.</span></span>

    ![Configure alert details](./media/log-analytics-tutorial-response/alert-signal-logic-04.png)

1. <span data-ttu-id="94cae-154">To immediately activate the alert rule on creation, accept the default value for **Enable rule upon creation**.</span><span class="sxs-lookup"><span data-stu-id="94cae-154">To immediately activate the alert rule on creation, accept the default value for **Enable rule upon creation**.</span></span>  
1. <span data-ttu-id="94cae-155">For the third and final step, you specify an **Action Group**, which ensures that the same actions are taken each time an alert is triggered and can be used for each rule you define.</span><span class="sxs-lookup"><span data-stu-id="94cae-155">For the third and final step, you specify an **Action Group**, which ensures that the same actions are taken each time an alert is triggered and can be used for each rule you define.</span></span>  <span data-ttu-id="94cae-156">Configure a new action group with the following information:</span><span class="sxs-lookup"><span data-stu-id="94cae-156">Configure a new action group with the following information:</span></span>  
   <span data-ttu-id="94cae-157">a.</span><span class="sxs-lookup"><span data-stu-id="94cae-157">a.</span></span> <span data-ttu-id="94cae-158">Select **New action group** and the **Add action group** pane appears.</span><span class="sxs-lookup"><span data-stu-id="94cae-158">Select **New action group** and the **Add action group** pane appears.</span></span>  
   <span data-ttu-id="94cae-159">b.</span><span class="sxs-lookup"><span data-stu-id="94cae-159">b.</span></span> <span data-ttu-id="94cae-160">For **Action group name**, specify a name such as **IT Operations - Notify** and a **Short name** such as **itops-n**.</span><span class="sxs-lookup"><span data-stu-id="94cae-160">For **Action group name**, specify a name such as **IT Operations - Notify** and a **Short name** such as **itops-n**.</span></span>  
   <span data-ttu-id="94cae-161">c.</span><span class="sxs-lookup"><span data-stu-id="94cae-161">c.</span></span> <span data-ttu-id="94cae-162">Verify the default values for **Subscription** and **Resource group** are correct.</span><span class="sxs-lookup"><span data-stu-id="94cae-162">Verify the default values for **Subscription** and **Resource group** are correct.</span></span> <span data-ttu-id="94cae-163">If not, select the correct one from the drop-down list.</span><span class="sxs-lookup"><span data-stu-id="94cae-163">If not, select the correct one from the drop-down list.</span></span>  
   <span data-ttu-id="94cae-164">d.</span><span class="sxs-lookup"><span data-stu-id="94cae-164">d.</span></span> <span data-ttu-id="94cae-165">Under the Actions section, specify a name for the action, such as **Send Email** and under **Action Type** select **Email/SMS/Push/Voice** from the drop-down list.</span><span class="sxs-lookup"><span data-stu-id="94cae-165">Under the Actions section, specify a name for the action, such as **Send Email** and under **Action Type** select **Email/SMS/Push/Voice** from the drop-down list.</span></span> <span data-ttu-id="94cae-166">The **Email/SMS/Push/Voice** properties pane will open to the right in order to provide additional information.</span><span class="sxs-lookup"><span data-stu-id="94cae-166">The **Email/SMS/Push/Voice** properties pane will open to the right in order to provide additional information.</span></span>  
   <span data-ttu-id="94cae-167">e.</span><span class="sxs-lookup"><span data-stu-id="94cae-167">e.</span></span> <span data-ttu-id="94cae-168">On the **Email/SMS/Push/Voice** pane, enable **Email** and provide a valid email SMTP address to deliver the message to.</span><span class="sxs-lookup"><span data-stu-id="94cae-168">On the **Email/SMS/Push/Voice** pane, enable **Email** and provide a valid email SMTP address to deliver the message to.</span></span>  
   <span data-ttu-id="94cae-169">f.</span><span class="sxs-lookup"><span data-stu-id="94cae-169">f.</span></span> <span data-ttu-id="94cae-170">Click **OK** to save your changes.</span><span class="sxs-lookup"><span data-stu-id="94cae-170">Click **OK** to save your changes.</span></span>  
       <span data-ttu-id="94cae-171">![Create new action group](./media/log-analytics-tutorial-response/action-group-properties-01.png)</span><span class="sxs-lookup"><span data-stu-id="94cae-171">![Create new action group](./media/log-analytics-tutorial-response/action-group-properties-01.png)</span></span>

1. <span data-ttu-id="94cae-172">Click **OK** to complete the action group.</span><span class="sxs-lookup"><span data-stu-id="94cae-172">Click **OK** to complete the action group.</span></span>
1. <span data-ttu-id="94cae-173">Click **Create alert rule** to complete the alert rule.</span><span class="sxs-lookup"><span data-stu-id="94cae-173">Click **Create alert rule** to complete the alert rule.</span></span> <span data-ttu-id="94cae-174">It starts running immediately.</span><span class="sxs-lookup"><span data-stu-id="94cae-174">It starts running immediately.</span></span>

    ![Complete creating new alert rule](./media/log-analytics-tutorial-response/alert-rule-01.png)

## <a name="view-your-alerts-in-azure-portal"></a><span data-ttu-id="94cae-176">View your alerts in Azure portal</span><span class="sxs-lookup"><span data-stu-id="94cae-176">View your alerts in Azure portal</span></span>
<span data-ttu-id="94cae-177">Now that you have created an alert, you can view Azure alerts in a single pane and manage all alert rules across your Azure subscriptions.</span><span class="sxs-lookup"><span data-stu-id="94cae-177">Now that you have created an alert, you can view Azure alerts in a single pane and manage all alert rules across your Azure subscriptions.</span></span> <span data-ttu-id="94cae-178">It lists all the alert rules (enabled or disabled) and can be sorted based on target resources, resource groups, rule name, or status.</span><span class="sxs-lookup"><span data-stu-id="94cae-178">It lists all the alert rules (enabled or disabled) and can be sorted based on target resources, resource groups, rule name, or status.</span></span> <span data-ttu-id="94cae-179">Included is an aggregated summary of all the fired alerts, and total configured/enabled alert rules.</span><span class="sxs-lookup"><span data-stu-id="94cae-179">Included is an aggregated summary of all the fired alerts, and total configured/enabled alert rules.</span></span>

![Azure Alerts status page](./media/log-analytics-tutorial-response/azure-alerts-02.png)

<span data-ttu-id="94cae-181">When the alert triggers, the table reflects the condition and how many times it occurred within the time range selected (the default is last six hours).</span><span class="sxs-lookup"><span data-stu-id="94cae-181">When the alert triggers, the table reflects the condition and how many times it occurred within the time range selected (the default is last six hours).</span></span>  <span data-ttu-id="94cae-182">There should be a corresponding email in your inbox similar to the following example showing the offending virtual machine and the top results that matched the search query in this case.</span><span class="sxs-lookup"><span data-stu-id="94cae-182">There should be a corresponding email in your inbox similar to the following example showing the offending virtual machine and the top results that matched the search query in this case.</span></span>

![Alert email action example](./media/log-analytics-tutorial-response/azure-alert-email-notification-01.png)

## <a name="next-steps"></a><span data-ttu-id="94cae-184">Next steps</span><span class="sxs-lookup"><span data-stu-id="94cae-184">Next steps</span></span>
<span data-ttu-id="94cae-185">In this tutorial, you learned how alert rules can proactively identify and respond to an issue when they run log searches at scheduled intervals and match a particular criteria.</span><span class="sxs-lookup"><span data-stu-id="94cae-185">In this tutorial, you learned how alert rules can proactively identify and respond to an issue when they run log searches at scheduled intervals and match a particular criteria.</span></span>

<span data-ttu-id="94cae-186">Follow this link to see pre-built Log Analytics script samples.</span><span class="sxs-lookup"><span data-stu-id="94cae-186">Follow this link to see pre-built Log Analytics script samples.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="94cae-187">Log Analytics script samples</span><span class="sxs-lookup"><span data-stu-id="94cae-187">Log Analytics script samples</span></span>](powershell-samples.md)
