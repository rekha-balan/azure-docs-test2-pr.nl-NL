---
title: Guidance for personal data stored in Azure Log Analytics| Microsoft Docs
description: This article describes how to manage personal data stored in Azure Log Analytics and the methods to identify and remove it.
services: log-analytics
documentationcenter: ''
author: mgoedtel
manager: carmonm
editor: ''
ms.assetid: ''
ms.service: log-analytics
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: conceptual
ms.date: 05/18/2018
ms.author: magoedte
ms.component: na
ms.openlocfilehash: 3692c83a4991fc67ec176687bd076ab14e4c640d
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44858077"
---
# <a name="guidance-for-personal-data-stored-in-log-analytics"></a><span data-ttu-id="48c81-103">Guidance for personal data stored in Log Analytics</span><span class="sxs-lookup"><span data-stu-id="48c81-103">Guidance for personal data stored in Log Analytics</span></span>

<span data-ttu-id="48c81-104">Log Analytics is a data store where personal data is likely to be found.</span><span class="sxs-lookup"><span data-stu-id="48c81-104">Log Analytics is a data store where personal data is likely to be found.</span></span> <span data-ttu-id="48c81-105">This article will discuss where in Log Analytics such data is typically found, as well as the capabilities available to you to handle such data.</span><span class="sxs-lookup"><span data-stu-id="48c81-105">This article will discuss where in Log Analytics such data is typically found, as well as the capabilities available to you to handle such data.</span></span>

[!INCLUDE [gdpr-dsr-and-stp-note](../../includes/gdpr-dsr-and-stp-note.md)]

## <a name="strategy-for-personal-data-handling"></a><span data-ttu-id="48c81-106">Strategy for personal data handling</span><span class="sxs-lookup"><span data-stu-id="48c81-106">Strategy for personal data handling</span></span>

<span data-ttu-id="48c81-107">While it will be up to you and your company to ultimately determine the strategy with which you will handle your private data (if at all), the following are some possible approaches.</span><span class="sxs-lookup"><span data-stu-id="48c81-107">While it will be up to you and your company to ultimately determine the strategy with which you will handle your private data (if at all), the following are some possible approaches.</span></span> <span data-ttu-id="48c81-108">They are listed in order of preference from a technical point of view from most to least preferable:</span><span class="sxs-lookup"><span data-stu-id="48c81-108">They are listed in order of preference from a technical point of view from most to least preferable:</span></span>

* <span data-ttu-id="48c81-109">Where possible, stop collection of, obfuscate, anonymize, or otherwise adjust the data being collected to exclude it from being considered "private".</span><span class="sxs-lookup"><span data-stu-id="48c81-109">Where possible, stop collection of, obfuscate, anonymize, or otherwise adjust the data being collected to exclude it from being considered "private".</span></span> <span data-ttu-id="48c81-110">This is _by far_ the preferred approach, saving you the need to create a very costly and impactful data handling strategy.</span><span class="sxs-lookup"><span data-stu-id="48c81-110">This is _by far_ the preferred approach, saving you the need to create a very costly and impactful data handling strategy.</span></span>
* <span data-ttu-id="48c81-111">Where not possible, attempt to normalize the data to reduce the impact on the data platform and performance.</span><span class="sxs-lookup"><span data-stu-id="48c81-111">Where not possible, attempt to normalize the data to reduce the impact on the data platform and performance.</span></span> <span data-ttu-id="48c81-112">For example, instead of logging an explicit User ID, create a lookup data that will correlate the username and their details to an internal ID that can then be logged elsewhere.</span><span class="sxs-lookup"><span data-stu-id="48c81-112">For example, instead of logging an explicit User ID, create a lookup data that will correlate the username and their details to an internal ID that can then be logged elsewhere.</span></span> <span data-ttu-id="48c81-113">That way, should one of your users ask you to delete their personal information, it is possible that only deleting the row in the lookup table corresponding to the user will be sufficient.</span><span class="sxs-lookup"><span data-stu-id="48c81-113">That way, should one of your users ask you to delete their personal information, it is possible that only deleting the row in the lookup table corresponding to the user will be sufficient.</span></span> 
* <span data-ttu-id="48c81-114">Finally, if private data must be collected, build a process around the purge API path and the existing query API path to meet any obligations you may have around exporting and deleting any private data associated with a user.</span><span class="sxs-lookup"><span data-stu-id="48c81-114">Finally, if private data must be collected, build a process around the purge API path and the existing query API path to meet any obligations you may have around exporting and deleting any private data associated with a user.</span></span> 

## <a name="where-to-look-for-private-data-in-log-analytics"></a><span data-ttu-id="48c81-115">Where to look for private data in Log Analytics?</span><span class="sxs-lookup"><span data-stu-id="48c81-115">Where to look for private data in Log Analytics?</span></span>

<span data-ttu-id="48c81-116">Log Analytics is a flexible store, which while prescribing a schema to your data, allows you to override every field with custom values.</span><span class="sxs-lookup"><span data-stu-id="48c81-116">Log Analytics is a flexible store, which while prescribing a schema to your data, allows you to override every field with custom values.</span></span> <span data-ttu-id="48c81-117">Additionally, any custom schema can be ingested.</span><span class="sxs-lookup"><span data-stu-id="48c81-117">Additionally, any custom schema can be ingested.</span></span> <span data-ttu-id="48c81-118">As such, it is impossible to say exactly where Private data will be found in your specific workspace.</span><span class="sxs-lookup"><span data-stu-id="48c81-118">As such, it is impossible to say exactly where Private data will be found in your specific workspace.</span></span> <span data-ttu-id="48c81-119">The following locations, however, are good starting points in your inventory:</span><span class="sxs-lookup"><span data-stu-id="48c81-119">The following locations, however, are good starting points in your inventory:</span></span>

* <span data-ttu-id="48c81-120">*IP addresses*: Log Analytics collects a variety of IP information across many different tables.</span><span class="sxs-lookup"><span data-stu-id="48c81-120">*IP addresses*: Log Analytics collects a variety of IP information across many different tables.</span></span> <span data-ttu-id="48c81-121">For example, the following query shows all tables where IPv4 addresses have been collected over the last 24 hours:</span><span class="sxs-lookup"><span data-stu-id="48c81-121">For example, the following query shows all tables where IPv4 addresses have been collected over the last 24 hours:</span></span>
    ```
    search * 
    | where * matches regex @'\b((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(\.|$)){4}\b' //RegEx originally provided on https://stackoverflow.com/questions/5284147/validating-ipv4-addresses-with-regexp
    | summarize count() by $table
    ```
* <span data-ttu-id="48c81-122">*User IDs*: User IDs are found in a large variety of solutions and tables.</span><span class="sxs-lookup"><span data-stu-id="48c81-122">*User IDs*: User IDs are found in a large variety of solutions and tables.</span></span> <span data-ttu-id="48c81-123">You can look for a particular username across your entire dataset using the search command:</span><span class="sxs-lookup"><span data-stu-id="48c81-123">You can look for a particular username across your entire dataset using the search command:</span></span>
    ```
    search "[username goes here]"
    ```
<span data-ttu-id="48c81-124">Remember to look not only for human-readable user names but also GUIDs that can directly be traced back to a particular user!</span><span class="sxs-lookup"><span data-stu-id="48c81-124">Remember to look not only for human-readable user names but also GUIDs that can directly be traced back to a particular user!</span></span>
* <span data-ttu-id="48c81-125">*Device IDs*: Like user IDs, device IDs are sometimes considered "private".</span><span class="sxs-lookup"><span data-stu-id="48c81-125">*Device IDs*: Like user IDs, device IDs are sometimes considered "private".</span></span> <span data-ttu-id="48c81-126">Use the same approach as listed above for user IDs to identify tables where this might be a concern.</span><span class="sxs-lookup"><span data-stu-id="48c81-126">Use the same approach as listed above for user IDs to identify tables where this might be a concern.</span></span> 
* <span data-ttu-id="48c81-127">*Custom data*: Log Analytics allows the collection in a variety of methods: custom logs and custom fields, the [HTTP Data Collector API](log-analytics-data-collector-api.md) , and custom data collected as part of system event logs.</span><span class="sxs-lookup"><span data-stu-id="48c81-127">*Custom data*: Log Analytics allows the collection in a variety of methods: custom logs and custom fields, the [HTTP Data Collector API](log-analytics-data-collector-api.md) , and custom data collected as part of system event logs.</span></span> <span data-ttu-id="48c81-128">All of these are susceptible to containing private data, and should be examined to verify whether any such data exists.</span><span class="sxs-lookup"><span data-stu-id="48c81-128">All of these are susceptible to containing private data, and should be examined to verify whether any such data exists.</span></span>
* <span data-ttu-id="48c81-129">*Solution-captured data*: Because the solution mechanism is an open-ended one, we recommend reviewing all tables generated by solutions to ensure compliance.</span><span class="sxs-lookup"><span data-stu-id="48c81-129">*Solution-captured data*: Because the solution mechanism is an open-ended one, we recommend reviewing all tables generated by solutions to ensure compliance.</span></span>

## <a name="how-to-export-and-delete-private-data"></a><span data-ttu-id="48c81-130">How to export and delete private data</span><span class="sxs-lookup"><span data-stu-id="48c81-130">How to export and delete private data</span></span>

<span data-ttu-id="48c81-131">As mentioned in the [strategy for personal data handling](#strategy-for-personal-data-handling) section earlier, it is __strongly__ recommended to if it all possible, to restructure your data collection policy to disable the collection of private data, obfuscating or anonymizing it, or otherwise modifying it to remove it from being considered "private".</span><span class="sxs-lookup"><span data-stu-id="48c81-131">As mentioned in the [strategy for personal data handling](#strategy-for-personal-data-handling) section earlier, it is __strongly__ recommended to if it all possible, to restructure your data collection policy to disable the collection of private data, obfuscating or anonymizing it, or otherwise modifying it to remove it from being considered "private".</span></span> <span data-ttu-id="48c81-132">Handling the data will foremost result in costs to you and your team to define and automate a strategy, build an interface for your customers to interact with their data through, and ongoing maintenance costs.</span><span class="sxs-lookup"><span data-stu-id="48c81-132">Handling the data will foremost result in costs to you and your team to define and automate a strategy, build an interface for your customers to interact with their data through, and ongoing maintenance costs.</span></span> <span data-ttu-id="48c81-133">Further, it is computationally costly for Log Analytics, and a large volume of concurrent query or purge API calls have the potential to negatively impact all other interaction with Log Analytics functionality.</span><span class="sxs-lookup"><span data-stu-id="48c81-133">Further, it is computationally costly for Log Analytics, and a large volume of concurrent query or purge API calls have the potential to negatively impact all other interaction with Log Analytics functionality.</span></span> <span data-ttu-id="48c81-134">That said, there are indeed some valid scenarios where private data must be collected.</span><span class="sxs-lookup"><span data-stu-id="48c81-134">That said, there are indeed some valid scenarios where private data must be collected.</span></span> <span data-ttu-id="48c81-135">For these cases, data should be handled as described in this section.</span><span class="sxs-lookup"><span data-stu-id="48c81-135">For these cases, data should be handled as described in this section.</span></span>

[!INCLUDE [gdpr-intro-sentence](../../includes/gdpr-intro-sentence.md)]

### <a name="view-and-export"></a><span data-ttu-id="48c81-136">View and export</span><span class="sxs-lookup"><span data-stu-id="48c81-136">View and export</span></span>

<span data-ttu-id="48c81-137">For both view and export data requests, the [Query API](https://dev.loganalytics.io/) should be used.</span><span class="sxs-lookup"><span data-stu-id="48c81-137">For both view and export data requests, the [Query API](https://dev.loganalytics.io/) should be used.</span></span> <span data-ttu-id="48c81-138">Logic to convert the shape of the data to an appropriate one to deliver to your users will be up to you to implement.</span><span class="sxs-lookup"><span data-stu-id="48c81-138">Logic to convert the shape of the data to an appropriate one to deliver to your users will be up to you to implement.</span></span> <span data-ttu-id="48c81-139">[Azure Functions](https://azure.microsoft.com/services/functions/) makes a great place to host such logic.</span><span class="sxs-lookup"><span data-stu-id="48c81-139">[Azure Functions](https://azure.microsoft.com/services/functions/) makes a great place to host such logic.</span></span>

### <a name="delete"></a><span data-ttu-id="48c81-140">Delete</span><span class="sxs-lookup"><span data-stu-id="48c81-140">Delete</span></span>

> [!WARNING]
> <span data-ttu-id="48c81-141">Deletes in Log Analytics are destructive and non-reversible!</span><span class="sxs-lookup"><span data-stu-id="48c81-141">Deletes in Log Analytics are destructive and non-reversible!</span></span> <span data-ttu-id="48c81-142">Please use extreme caution in their execution.</span><span class="sxs-lookup"><span data-stu-id="48c81-142">Please use extreme caution in their execution.</span></span>

<span data-ttu-id="48c81-143">We have made available as part of a privacy handling a *purge* API path.</span><span class="sxs-lookup"><span data-stu-id="48c81-143">We have made available as part of a privacy handling a *purge* API path.</span></span> <span data-ttu-id="48c81-144">This path should be used sparingly due to the risk associated with doing so, the potential performance impact, and the potential to skew all-up aggregations, measurements, and other aspects of your Log Analytics data.</span><span class="sxs-lookup"><span data-stu-id="48c81-144">This path should be used sparingly due to the risk associated with doing so, the potential performance impact, and the potential to skew all-up aggregations, measurements, and other aspects of your Log Analytics data.</span></span> <span data-ttu-id="48c81-145">See the [Strategy for personal data handling](#strategy-for-personal-data-handling) section for alternative approaches to handle private data.</span><span class="sxs-lookup"><span data-stu-id="48c81-145">See the [Strategy for personal data handling](#strategy-for-personal-data-handling) section for alternative approaches to handle private data.</span></span>

<span data-ttu-id="48c81-146">Purge is a highly privileged operation that no app or user in Azure (including even the resource owner) will have permissions to execute without explicitly being granted a role in Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="48c81-146">Purge is a highly privileged operation that no app or user in Azure (including even the resource owner) will have permissions to execute without explicitly being granted a role in Azure Resource Manager.</span></span> <span data-ttu-id="48c81-147">This role is _Data Purger_ and should be cautiously delegated due to the potential for data loss.</span><span class="sxs-lookup"><span data-stu-id="48c81-147">This role is _Data Purger_ and should be cautiously delegated due to the potential for data loss.</span></span> 

<span data-ttu-id="48c81-148">Once the Azure Resource Manager role has been assigned, two new API paths are available:</span><span class="sxs-lookup"><span data-stu-id="48c81-148">Once the Azure Resource Manager role has been assigned, two new API paths are available:</span></span> 

* <span data-ttu-id="48c81-149">[POST purge] (https://docs.microsoft.com/rest/api/loganalytics/workspaces%202015-03-20/purge) - takes an object specifying parameters of data to delete and returns a reference GUID</span><span class="sxs-lookup"><span data-stu-id="48c81-149">[POST purge] (https://docs.microsoft.com/rest/api/loganalytics/workspaces%202015-03-20/purge) - takes an object specifying parameters of data to delete and returns a reference GUID</span></span> 
* <span data-ttu-id="48c81-150">GET purge status - the POST purge call will return an 'x-ms-status-location' header that will include a URL that you can call to determine the status of your purge API.</span><span class="sxs-lookup"><span data-stu-id="48c81-150">GET purge status - the POST purge call will return an 'x-ms-status-location' header that will include a URL that you can call to determine the status of your purge API.</span></span> <span data-ttu-id="48c81-151">For example:</span><span class="sxs-lookup"><span data-stu-id="48c81-151">For example:</span></span>

    ```
    x-ms-status-location: https://management.azure.com/subscriptions/[SubscriptionId]/resourceGroups/[ResourceGroupName]/providers/Microsoft.OperatonalInsights/workspaces/[WorkspaceName]/operations/purge-[PurgeOperationId]?api-version=2015-03-20
    ```

<span data-ttu-id="48c81-152">While we expect the vast majority of purge operations to complete much quicker than our SLA, due to their heavy impact on the data platform used by Log Analytics, the formal SLA for the completion of purge operations is set at 30 days.</span><span class="sxs-lookup"><span data-stu-id="48c81-152">While we expect the vast majority of purge operations to complete much quicker than our SLA, due to their heavy impact on the data platform used by Log Analytics, the formal SLA for the completion of purge operations is set at 30 days.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="48c81-153">Next steps</span><span class="sxs-lookup"><span data-stu-id="48c81-153">Next steps</span></span>
<span data-ttu-id="48c81-154">To learn more about how data is collected, processed, and secured, see [Log Analytics data security](log-analytics-data-security.md).</span><span class="sxs-lookup"><span data-stu-id="48c81-154">To learn more about how data is collected, processed, and secured, see [Log Analytics data security](log-analytics-data-security.md).</span></span>