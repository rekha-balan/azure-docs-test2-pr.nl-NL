---
title: Collect and analyze performance counters in Azure Log Analytics | Microsoft Docs
description: Performance counters are collected by Log Analytics to analyze performance on Windows and Linux agents.  This article describes how to configure collection of Performance counters for both Windows and Linux agents, details of they are stored in the OMS repository, and how to analyze them in the OMS portal.
services: log-analytics
documentationcenter: ''
author: bwren
manager: carmonm
editor: tysonn
ms.assetid: 20e145e4-2ace-4cd9-b252-71fb4f94099e
ms.service: log-analytics
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/24/2017
ms.author: bwren
ms.openlocfilehash: 559ea812400e04058fc5f3005d1b82898d00a6cc
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44540823"
---
# <a name="windows-and-linux-performance-data-sources-in-log-analytics"></a><span data-ttu-id="b56d3-104">Windows and Linux performance data sources in Log Analytics</span><span class="sxs-lookup"><span data-stu-id="b56d3-104">Windows and Linux performance data sources in Log Analytics</span></span>
<span data-ttu-id="b56d3-105">Performance counters in Windows and Linux provide insight into the performance of hardware components, operating systems, and applications.</span><span class="sxs-lookup"><span data-stu-id="b56d3-105">Performance counters in Windows and Linux provide insight into the performance of hardware components, operating systems, and applications.</span></span>  <span data-ttu-id="b56d3-106">Log Analytics can collect performance counters at frequent intervals for Near Real Time (NRT) analysis in addition to aggregating performance data for longer term analysis and reporting.</span><span class="sxs-lookup"><span data-stu-id="b56d3-106">Log Analytics can collect performance counters at frequent intervals for Near Real Time (NRT) analysis in addition to aggregating performance data for longer term analysis and reporting.</span></span>

![Performance counters](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-data-sources-performance-counters/overview.png)

## <a name="configuring-performance-counters"></a><span data-ttu-id="b56d3-108">Configuring Performance counters</span><span class="sxs-lookup"><span data-stu-id="b56d3-108">Configuring Performance counters</span></span>
<span data-ttu-id="b56d3-109">Configure  Performance counters from the [Data menu in Log Analytics Settings](log-analytics-data-sources.md#configuring-data-sources).</span><span class="sxs-lookup"><span data-stu-id="b56d3-109">Configure  Performance counters from the [Data menu in Log Analytics Settings](log-analytics-data-sources.md#configuring-data-sources).</span></span>

<span data-ttu-id="b56d3-110">When you first configure Windows or Linux Performance counters for a new OMS workspace, you are given the option to quickly create several common counters.</span><span class="sxs-lookup"><span data-stu-id="b56d3-110">When you first configure Windows or Linux Performance counters for a new OMS workspace, you are given the option to quickly create several common counters.</span></span>  <span data-ttu-id="b56d3-111">They are listed with a checkbox next to each.</span><span class="sxs-lookup"><span data-stu-id="b56d3-111">They are listed with a checkbox next to each.</span></span>  <span data-ttu-id="b56d3-112">Ensure that any counters you want to initially create are checked and then click **Add the selected performance counters**.</span><span class="sxs-lookup"><span data-stu-id="b56d3-112">Ensure that any counters you want to initially create are checked and then click **Add the selected performance counters**.</span></span>

![Configure Windows Performance counters](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-data-sources-performance-counters/configure-windows.png)

<span data-ttu-id="b56d3-114">Follow this procedure to add a new Windows performance counter to collect.</span><span class="sxs-lookup"><span data-stu-id="b56d3-114">Follow this procedure to add a new Windows performance counter to collect.</span></span>

1. <span data-ttu-id="b56d3-115">Type the name of the counter in the text box in the format *object(instance)\counter*.</span><span class="sxs-lookup"><span data-stu-id="b56d3-115">Type the name of the counter in the text box in the format *object(instance)\counter*.</span></span>  <span data-ttu-id="b56d3-116">When you start typing, you are presented with a matching list of common counters.</span><span class="sxs-lookup"><span data-stu-id="b56d3-116">When you start typing, you are presented with a matching list of common counters.</span></span>  <span data-ttu-id="b56d3-117">You can either select a counter from the list or type in one of your own.</span><span class="sxs-lookup"><span data-stu-id="b56d3-117">You can either select a counter from the list or type in one of your own.</span></span>  <span data-ttu-id="b56d3-118">You can also return all instances for a particular counter by specifying *object\counter*.</span><span class="sxs-lookup"><span data-stu-id="b56d3-118">You can also return all instances for a particular counter by specifying *object\counter*.</span></span>
2. <span data-ttu-id="b56d3-119">Click **+** or press **Enter** to add the counter to the list.</span><span class="sxs-lookup"><span data-stu-id="b56d3-119">Click **+** or press **Enter** to add the counter to the list.</span></span>
3. <span data-ttu-id="b56d3-120">When you add a counter, it uses the default of 10 seconds for its **Sample Interval**.</span><span class="sxs-lookup"><span data-stu-id="b56d3-120">When you add a counter, it uses the default of 10 seconds for its **Sample Interval**.</span></span>  <span data-ttu-id="b56d3-121">You can change this to a higher value of up to 1800 seconds (30 minutes) if you want to reduce the storage requirements of the collected performance data.</span><span class="sxs-lookup"><span data-stu-id="b56d3-121">You can change this to a higher value of up to 1800 seconds (30 minutes) if you want to reduce the storage requirements of the collected performance data.</span></span>
4. <span data-ttu-id="b56d3-122">When you're done adding counters, click the **Save** button at the top of the screen to save the configuration.</span><span class="sxs-lookup"><span data-stu-id="b56d3-122">When you're done adding counters, click the **Save** button at the top of the screen to save the configuration.</span></span>

![Configure Linux Performance counters](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-data-sources-performance-counters/configure-linux.png)

<span data-ttu-id="b56d3-124">Follow this procedure to add a new Linux performance counter to collect.</span><span class="sxs-lookup"><span data-stu-id="b56d3-124">Follow this procedure to add a new Linux performance counter to collect.</span></span>

1. <span data-ttu-id="b56d3-125">By default, all configuration changes are automatically pushed to all agents.</span><span class="sxs-lookup"><span data-stu-id="b56d3-125">By default, all configuration changes are automatically pushed to all agents.</span></span>  <span data-ttu-id="b56d3-126">For Linux agents, a configuration file is sent to the Fluentd data collector.</span><span class="sxs-lookup"><span data-stu-id="b56d3-126">For Linux agents, a configuration file is sent to the Fluentd data collector.</span></span>  <span data-ttu-id="b56d3-127">If you wish to modify this file manually on each Linux agent, then uncheck the box *Apply below configuration to my Linux machines*.</span><span class="sxs-lookup"><span data-stu-id="b56d3-127">If you wish to modify this file manually on each Linux agent, then uncheck the box *Apply below configuration to my Linux machines*.</span></span>
2. <span data-ttu-id="b56d3-128">Type the name of the counter in the text box in the format *object(instance)\counter*.</span><span class="sxs-lookup"><span data-stu-id="b56d3-128">Type the name of the counter in the text box in the format *object(instance)\counter*.</span></span>  <span data-ttu-id="b56d3-129">When you start typing, you are presented with a matching list of common counters.</span><span class="sxs-lookup"><span data-stu-id="b56d3-129">When you start typing, you are presented with a matching list of common counters.</span></span>  <span data-ttu-id="b56d3-130">You can either select a counter from the list or type in one of your own.</span><span class="sxs-lookup"><span data-stu-id="b56d3-130">You can either select a counter from the list or type in one of your own.</span></span>  
3. <span data-ttu-id="b56d3-131">Click **+** or press **Enter** to add the counter to the list of other counters for the object.</span><span class="sxs-lookup"><span data-stu-id="b56d3-131">Click **+** or press **Enter** to add the counter to the list of other counters for the object.</span></span>
4. <span data-ttu-id="b56d3-132">All counters for an object use the same **Sample Interval**.</span><span class="sxs-lookup"><span data-stu-id="b56d3-132">All counters for an object use the same **Sample Interval**.</span></span>  <span data-ttu-id="b56d3-133">The default is 10 seconds.</span><span class="sxs-lookup"><span data-stu-id="b56d3-133">The default is 10 seconds.</span></span>  <span data-ttu-id="b56d3-134">You change this to a higher value of up to 1800 seconds (30 minutes) if you want to reduce the storage requirements of the collected performance data.</span><span class="sxs-lookup"><span data-stu-id="b56d3-134">You change this to a higher value of up to 1800 seconds (30 minutes) if you want to reduce the storage requirements of the collected performance data.</span></span>
5. <span data-ttu-id="b56d3-135">When you're done adding counters, click the **Save** button at the top of the screen to save the configuration.</span><span class="sxs-lookup"><span data-stu-id="b56d3-135">When you're done adding counters, click the **Save** button at the top of the screen to save the configuration.</span></span>

## <a name="data-collection"></a><span data-ttu-id="b56d3-136">Data collection</span><span class="sxs-lookup"><span data-stu-id="b56d3-136">Data collection</span></span>
<span data-ttu-id="b56d3-137">Log Analytics collects all specified performance counters at their specified sample interval on all agents that have that counter installed.</span><span class="sxs-lookup"><span data-stu-id="b56d3-137">Log Analytics collects all specified performance counters at their specified sample interval on all agents that have that counter installed.</span></span>  <span data-ttu-id="b56d3-138">The data is not aggregated, and the raw data is available in all log search views for the duration specified by your OMS subscription.</span><span class="sxs-lookup"><span data-stu-id="b56d3-138">The data is not aggregated, and the raw data is available in all log search views for the duration specified by your OMS subscription.</span></span>

## <a name="performance-record-properties"></a><span data-ttu-id="b56d3-139">Performance record properties</span><span class="sxs-lookup"><span data-stu-id="b56d3-139">Performance record properties</span></span>
<span data-ttu-id="b56d3-140">Performance records have a type of **Perf** and have the properties in the following table.</span><span class="sxs-lookup"><span data-stu-id="b56d3-140">Performance records have a type of **Perf** and have the properties in the following table.</span></span>

| <span data-ttu-id="b56d3-141">Property</span><span class="sxs-lookup"><span data-stu-id="b56d3-141">Property</span></span> | <span data-ttu-id="b56d3-142">Description</span><span class="sxs-lookup"><span data-stu-id="b56d3-142">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="b56d3-143">Computer</span><span class="sxs-lookup"><span data-stu-id="b56d3-143">Computer</span></span> |<span data-ttu-id="b56d3-144">Computer that the event was collected from.</span><span class="sxs-lookup"><span data-stu-id="b56d3-144">Computer that the event was collected from.</span></span> |
| <span data-ttu-id="b56d3-145">CounterName</span><span class="sxs-lookup"><span data-stu-id="b56d3-145">CounterName</span></span> |<span data-ttu-id="b56d3-146">Name of the performance counter</span><span class="sxs-lookup"><span data-stu-id="b56d3-146">Name of the performance counter</span></span> |
| <span data-ttu-id="b56d3-147">CounterPath</span><span class="sxs-lookup"><span data-stu-id="b56d3-147">CounterPath</span></span> |<span data-ttu-id="b56d3-148">Full path of the counter in the form \\\\\<Computer>\\object(instance)\\counter.</span><span class="sxs-lookup"><span data-stu-id="b56d3-148">Full path of the counter in the form \\\\\<Computer>\\object(instance)\\counter.</span></span> |
| <span data-ttu-id="b56d3-149">CounterValue</span><span class="sxs-lookup"><span data-stu-id="b56d3-149">CounterValue</span></span> |<span data-ttu-id="b56d3-150">Numeric value of the counter.</span><span class="sxs-lookup"><span data-stu-id="b56d3-150">Numeric value of the counter.</span></span> |
| <span data-ttu-id="b56d3-151">InstanceName</span><span class="sxs-lookup"><span data-stu-id="b56d3-151">InstanceName</span></span> |<span data-ttu-id="b56d3-152">Name of the event instance.</span><span class="sxs-lookup"><span data-stu-id="b56d3-152">Name of the event instance.</span></span>  <span data-ttu-id="b56d3-153">Empty if no instance.</span><span class="sxs-lookup"><span data-stu-id="b56d3-153">Empty if no instance.</span></span> |
| <span data-ttu-id="b56d3-154">ObjectName</span><span class="sxs-lookup"><span data-stu-id="b56d3-154">ObjectName</span></span> |<span data-ttu-id="b56d3-155">Name of the performance object</span><span class="sxs-lookup"><span data-stu-id="b56d3-155">Name of the performance object</span></span> |
| <span data-ttu-id="b56d3-156">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="b56d3-156">SourceSystem</span></span> |<span data-ttu-id="b56d3-157">Type of agent the data was collected from.</span><span class="sxs-lookup"><span data-stu-id="b56d3-157">Type of agent the data was collected from.</span></span> <br> <span data-ttu-id="b56d3-158">OpsManager – Windows agent, either direct connect or SCOM</span><span class="sxs-lookup"><span data-stu-id="b56d3-158">OpsManager – Windows agent, either direct connect or SCOM</span></span> <br> <span data-ttu-id="b56d3-159">Linux – All Linux agents</span><span class="sxs-lookup"><span data-stu-id="b56d3-159">Linux – All Linux agents</span></span>  <br> <span data-ttu-id="b56d3-160">AzureStorage – Azure Diagnostics</span><span class="sxs-lookup"><span data-stu-id="b56d3-160">AzureStorage – Azure Diagnostics</span></span> |
| <span data-ttu-id="b56d3-161">TimeGenerated</span><span class="sxs-lookup"><span data-stu-id="b56d3-161">TimeGenerated</span></span> |<span data-ttu-id="b56d3-162">Date and time the data was sampled.</span><span class="sxs-lookup"><span data-stu-id="b56d3-162">Date and time the data was sampled.</span></span> |

## <a name="sizing-estimates"></a><span data-ttu-id="b56d3-163">Sizing estimates</span><span class="sxs-lookup"><span data-stu-id="b56d3-163">Sizing estimates</span></span>
 <span data-ttu-id="b56d3-164">A rough estimate for collection of a particular counter at 10-second intervals is about 1 MB per day per instance.</span><span class="sxs-lookup"><span data-stu-id="b56d3-164">A rough estimate for collection of a particular counter at 10-second intervals is about 1 MB per day per instance.</span></span>  <span data-ttu-id="b56d3-165">You can estimate the storage requirements of a particular counter with the following formula.</span><span class="sxs-lookup"><span data-stu-id="b56d3-165">You can estimate the storage requirements of a particular counter with the following formula.</span></span>

    1 MB x (number of counters) x (number of agents) x (number of instances)

## <a name="log-searches-with-performance-records"></a><span data-ttu-id="b56d3-166">Log searches with Performance records</span><span class="sxs-lookup"><span data-stu-id="b56d3-166">Log searches with Performance records</span></span>
<span data-ttu-id="b56d3-167">The following table provides different examples of log searches that retrieve Performance records.</span><span class="sxs-lookup"><span data-stu-id="b56d3-167">The following table provides different examples of log searches that retrieve Performance records.</span></span>

| <span data-ttu-id="b56d3-168">Query</span><span class="sxs-lookup"><span data-stu-id="b56d3-168">Query</span></span> | <span data-ttu-id="b56d3-169">Description</span><span class="sxs-lookup"><span data-stu-id="b56d3-169">Description</span></span> |
|:--- |:--- |
| <span data-ttu-id="b56d3-170">Type=Perf</span><span class="sxs-lookup"><span data-stu-id="b56d3-170">Type=Perf</span></span> |<span data-ttu-id="b56d3-171">All Performance data</span><span class="sxs-lookup"><span data-stu-id="b56d3-171">All Performance data</span></span> |
| <span data-ttu-id="b56d3-172">Type=Perf Computer="MyComputer"</span><span class="sxs-lookup"><span data-stu-id="b56d3-172">Type=Perf Computer="MyComputer"</span></span> |<span data-ttu-id="b56d3-173">All Performance data from a particular computer</span><span class="sxs-lookup"><span data-stu-id="b56d3-173">All Performance data from a particular computer</span></span> |
| <span data-ttu-id="b56d3-174">Type=Perf CounterName="Current Disk Queue Length"</span><span class="sxs-lookup"><span data-stu-id="b56d3-174">Type=Perf CounterName="Current Disk Queue Length"</span></span> |<span data-ttu-id="b56d3-175">All Performance data for a particular counter</span><span class="sxs-lookup"><span data-stu-id="b56d3-175">All Performance data for a particular counter</span></span> |
| <span data-ttu-id="b56d3-176">Type=Perf (ObjectName=Processor) CounterName="% Processor Time" InstanceName=_Total &#124; measure Avg(Average) as AVGCPU  by Computer</span><span class="sxs-lookup"><span data-stu-id="b56d3-176">Type=Perf (ObjectName=Processor) CounterName="% Processor Time" InstanceName=_Total &#124; measure Avg(Average) as AVGCPU  by Computer</span></span> |<span data-ttu-id="b56d3-177">Average CPU Utilization across all computers</span><span class="sxs-lookup"><span data-stu-id="b56d3-177">Average CPU Utilization across all computers</span></span> |
| <span data-ttu-id="b56d3-178">Type=Perf (CounterName="% Processor Time") &#124;  measure max(Max) by Computer</span><span class="sxs-lookup"><span data-stu-id="b56d3-178">Type=Perf (CounterName="% Processor Time") &#124;  measure max(Max) by Computer</span></span> |<span data-ttu-id="b56d3-179">Maximum CPU Utilization across all computers</span><span class="sxs-lookup"><span data-stu-id="b56d3-179">Maximum CPU Utilization across all computers</span></span> |
| <span data-ttu-id="b56d3-180">Type=Perf ObjectName=LogicalDisk CounterName="Current Disk Queue Length" Computer="MyComputerName" &#124; measure Avg(Average) by InstanceName</span><span class="sxs-lookup"><span data-stu-id="b56d3-180">Type=Perf ObjectName=LogicalDisk CounterName="Current Disk Queue Length" Computer="MyComputerName" &#124; measure Avg(Average) by InstanceName</span></span> |<span data-ttu-id="b56d3-181">Average Current Disk Queue length across all  the instances of a given computer</span><span class="sxs-lookup"><span data-stu-id="b56d3-181">Average Current Disk Queue length across all  the instances of a given computer</span></span> |
| <span data-ttu-id="b56d3-182">Type=Perf CounterName="DiskTransfers/sec" &#124; measure percentile95(Average) by Computer</span><span class="sxs-lookup"><span data-stu-id="b56d3-182">Type=Perf CounterName="DiskTransfers/sec" &#124; measure percentile95(Average) by Computer</span></span> |<span data-ttu-id="b56d3-183">95th Percentile of Disk Transfers/Sec across all computers</span><span class="sxs-lookup"><span data-stu-id="b56d3-183">95th Percentile of Disk Transfers/Sec across all computers</span></span> |
| <span data-ttu-id="b56d3-184">Type=Perf CounterName="% Processor Time" InstanceName="_Total"  &#124; measure avg(CounterValue) by Computer Interval 1HOUR</span><span class="sxs-lookup"><span data-stu-id="b56d3-184">Type=Perf CounterName="% Processor Time" InstanceName="_Total"  &#124; measure avg(CounterValue) by Computer Interval 1HOUR</span></span> |<span data-ttu-id="b56d3-185">Hourly average of CPU usage across all computers</span><span class="sxs-lookup"><span data-stu-id="b56d3-185">Hourly average of CPU usage across all computers</span></span> |
| <span data-ttu-id="b56d3-186">Type=Perf Computer="MyComputer" CounterName=%\* InstanceName=_Total &#124; measure percentile70(CounterValue) by CounterName Interval 1HOUR</span><span class="sxs-lookup"><span data-stu-id="b56d3-186">Type=Perf Computer="MyComputer" CounterName=%\* InstanceName=_Total &#124; measure percentile70(CounterValue) by CounterName Interval 1HOUR</span></span> |<span data-ttu-id="b56d3-187">Hourly 70 percentile of every % percent counter for a particular computer</span><span class="sxs-lookup"><span data-stu-id="b56d3-187">Hourly 70 percentile of every % percent counter for a particular computer</span></span> |
| <span data-ttu-id="b56d3-188">Type=Perf CounterName="% Processor Time" InstanceName="_Total"  (Computer="MyComputer") &#124; measure min(CounterValue), avg(CounterValue), percentile75(CounterValue), max(CounterValue) by Computer Interval 1HOUR</span><span class="sxs-lookup"><span data-stu-id="b56d3-188">Type=Perf CounterName="% Processor Time" InstanceName="_Total"  (Computer="MyComputer") &#124; measure min(CounterValue), avg(CounterValue), percentile75(CounterValue), max(CounterValue) by Computer Interval 1HOUR</span></span> |<span data-ttu-id="b56d3-189">Hourly average, minimum, maximum, and 75-percentile CPU usage for a specific computer</span><span class="sxs-lookup"><span data-stu-id="b56d3-189">Hourly average, minimum, maximum, and 75-percentile CPU usage for a specific computer</span></span> |

## <a name="viewing-performance-data"></a><span data-ttu-id="b56d3-190">Viewing performance data</span><span class="sxs-lookup"><span data-stu-id="b56d3-190">Viewing performance data</span></span>
<span data-ttu-id="b56d3-191">When you run a log search for performance data, the **Log** view is displayed by default.</span><span class="sxs-lookup"><span data-stu-id="b56d3-191">When you run a log search for performance data, the **Log** view is displayed by default.</span></span>  <span data-ttu-id="b56d3-192">To view the data in graphical form, click **Metrics**.</span><span class="sxs-lookup"><span data-stu-id="b56d3-192">To view the data in graphical form, click **Metrics**.</span></span>  <span data-ttu-id="b56d3-193">For a detailed graphical view, click the **+** next to a counter.</span><span class="sxs-lookup"><span data-stu-id="b56d3-193">For a detailed graphical view, click the **+** next to a counter.</span></span>  

![Metrics view collapsed](https://docstestmedia1.blob.core.windows.net/azure-media/articles/log-analytics/media/log-analytics-data-sources-performance-counters/metricscollapsed.png)

<span data-ttu-id="b56d3-195">To aggregate performance data in a log search, see [On-demand metric aggregation and visualization in OMS](http://blogs.technet.microsoft.com/msoms/2016/02/26/on-demand-metric-aggregation-and-visualization-in-oms/).</span><span class="sxs-lookup"><span data-stu-id="b56d3-195">To aggregate performance data in a log search, see [On-demand metric aggregation and visualization in OMS](http://blogs.technet.microsoft.com/msoms/2016/02/26/on-demand-metric-aggregation-and-visualization-in-oms/).</span></span>

## <a name="next-steps"></a><span data-ttu-id="b56d3-196">Next steps</span><span class="sxs-lookup"><span data-stu-id="b56d3-196">Next steps</span></span>
* <span data-ttu-id="b56d3-197">Learn about [log searches](log-analytics-log-searches.md) to analyze the data collected from data sources and solutions.</span><span class="sxs-lookup"><span data-stu-id="b56d3-197">Learn about [log searches](log-analytics-log-searches.md) to analyze the data collected from data sources and solutions.</span></span>  
* <span data-ttu-id="b56d3-198">Export collected data to [Power BI](log-analytics-powerbi.md) for additional visualizations and analysis.</span><span class="sxs-lookup"><span data-stu-id="b56d3-198">Export collected data to [Power BI](log-analytics-powerbi.md) for additional visualizations and analysis.</span></span>




