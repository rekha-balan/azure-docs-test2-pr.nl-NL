---
title: Archive telemetry data with Azure Event Hubs Archive overview | Microsoft Docs
description: Overview of the Azure Event Hubs Archive feature.
services: event-hubs
documentationcenter: ''
author: djrosanova
manager: timlt
editor: ''
ms.assetid: e53cdeea-8a6a-474e-9f96-59d43c0e8562
ms.service: event-hubs
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 03/22/2017
ms.author: darosa;sethm
ms.openlocfilehash: 6cfee4d3a0973c0f84f007642b689d871ad8d7e7
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44550220"
---
# <a name="azure-event-hubs-archive"></a><span data-ttu-id="653d0-103">Azure Event Hubs Archive</span><span class="sxs-lookup"><span data-stu-id="653d0-103">Azure Event Hubs Archive</span></span>
<span data-ttu-id="653d0-104">Azure Event Hubs Archive enables you to automatically deliver the streaming data in Event Hubs to a Blob storage account of your choice with added flexibility to specify a time or size interval of your choosing.</span><span class="sxs-lookup"><span data-stu-id="653d0-104">Azure Event Hubs Archive enables you to automatically deliver the streaming data in Event Hubs to a Blob storage account of your choice with added flexibility to specify a time or size interval of your choosing.</span></span> <span data-ttu-id="653d0-105">Setting up Archive is fast, there are no administrative costs to run it, and it scales automatically with Event Hubs [throughput units](event-hubs-what-is-event-hubs.md#capacity).</span><span class="sxs-lookup"><span data-stu-id="653d0-105">Setting up Archive is fast, there are no administrative costs to run it, and it scales automatically with Event Hubs [throughput units](event-hubs-what-is-event-hubs.md#capacity).</span></span> <span data-ttu-id="653d0-106">Event Hubs Archive is the easiest way to load streaming data into Azure and enables you to focus on data processing rather than on data capture.</span><span class="sxs-lookup"><span data-stu-id="653d0-106">Event Hubs Archive is the easiest way to load streaming data into Azure and enables you to focus on data processing rather than on data capture.</span></span>

<span data-ttu-id="653d0-107">Event Hubs Archive enables you to process real-time and batch-based pipelines on the same stream.</span><span class="sxs-lookup"><span data-stu-id="653d0-107">Event Hubs Archive enables you to process real-time and batch-based pipelines on the same stream.</span></span> <span data-ttu-id="653d0-108">This enables you to build solutions that can grow with your needs over time.</span><span class="sxs-lookup"><span data-stu-id="653d0-108">This enables you to build solutions that can grow with your needs over time.</span></span> <span data-ttu-id="653d0-109">Whether you're building batch-based systems today with an eye towards future real-time processing, or you want to add an efficient cold path to an existing real-time solution, Event Hubs Archive makes working with streaming data easier.</span><span class="sxs-lookup"><span data-stu-id="653d0-109">Whether you're building batch-based systems today with an eye towards future real-time processing, or you want to add an efficient cold path to an existing real-time solution, Event Hubs Archive makes working with streaming data easier.</span></span>

## <a name="how-event-hubs-archive-works"></a><span data-ttu-id="653d0-110">How Event Hubs Archive works</span><span class="sxs-lookup"><span data-stu-id="653d0-110">How Event Hubs Archive works</span></span>
<span data-ttu-id="653d0-111">Event Hubs is a time-retention durable buffer for telemetry ingress, similar to a distributed log.</span><span class="sxs-lookup"><span data-stu-id="653d0-111">Event Hubs is a time-retention durable buffer for telemetry ingress, similar to a distributed log.</span></span> <span data-ttu-id="653d0-112">The key to scaling in Event Hubs is the [partitioned consumer model](event-hubs-what-is-event-hubs.md#partitions).</span><span class="sxs-lookup"><span data-stu-id="653d0-112">The key to scaling in Event Hubs is the [partitioned consumer model](event-hubs-what-is-event-hubs.md#partitions).</span></span> <span data-ttu-id="653d0-113">Each partition is an independent segment of data and is consumed independently.</span><span class="sxs-lookup"><span data-stu-id="653d0-113">Each partition is an independent segment of data and is consumed independently.</span></span> <span data-ttu-id="653d0-114">Over time this data ages off, based on the configurable retention period.</span><span class="sxs-lookup"><span data-stu-id="653d0-114">Over time this data ages off, based on the configurable retention period.</span></span> <span data-ttu-id="653d0-115">As a result, a given event hub never gets "too full."</span><span class="sxs-lookup"><span data-stu-id="653d0-115">As a result, a given event hub never gets "too full."</span></span>

<span data-ttu-id="653d0-116">Event Hubs Archive enables you to specify your own Azure Blob Storage account and Container which will be used to store the archived data.</span><span class="sxs-lookup"><span data-stu-id="653d0-116">Event Hubs Archive enables you to specify your own Azure Blob Storage account and Container which will be used to store the archived data.</span></span> <span data-ttu-id="653d0-117">This account can be in the same region as your event hub or in another region, adding to the flexibility of the Event Hubs Archive feature.</span><span class="sxs-lookup"><span data-stu-id="653d0-117">This account can be in the same region as your event hub or in another region, adding to the flexibility of the Event Hubs Archive feature.</span></span>

<span data-ttu-id="653d0-118">Archived data is written in [Apache Avro][Apache Avro] format: a compact, fast, binary format that provides rich data structures with inline schema.</span><span class="sxs-lookup"><span data-stu-id="653d0-118">Archived data is written in [Apache Avro][Apache Avro] format: a compact, fast, binary format that provides rich data structures with inline schema.</span></span> <span data-ttu-id="653d0-119">This format is widely used in the Hadoop ecosystem, as well as by Stream Analytics and Azure Data Factory.</span><span class="sxs-lookup"><span data-stu-id="653d0-119">This format is widely used in the Hadoop ecosystem, as well as by Stream Analytics and Azure Data Factory.</span></span> <span data-ttu-id="653d0-120">More information about working with Avro is available later in this article.</span><span class="sxs-lookup"><span data-stu-id="653d0-120">More information about working with Avro is available later in this article.</span></span>

### <a name="archive-windowing"></a><span data-ttu-id="653d0-121">Archive windowing</span><span class="sxs-lookup"><span data-stu-id="653d0-121">Archive windowing</span></span>
<span data-ttu-id="653d0-122">Event Hubs Archive enables you to set up a "window" to control archiving.</span><span class="sxs-lookup"><span data-stu-id="653d0-122">Event Hubs Archive enables you to set up a "window" to control archiving.</span></span> <span data-ttu-id="653d0-123">This window is a minimum size and time configuration with a "first wins policy," meaning that the first trigger encountered causes an archive operation.</span><span class="sxs-lookup"><span data-stu-id="653d0-123">This window is a minimum size and time configuration with a "first wins policy," meaning that the first trigger encountered causes an archive operation.</span></span> <span data-ttu-id="653d0-124">If you have a fifteen-minute, 100 MB archive window and send 1 MB per second, the size window will trigger before the time window.</span><span class="sxs-lookup"><span data-stu-id="653d0-124">If you have a fifteen-minute, 100 MB archive window and send 1 MB per second, the size window will trigger before the time window.</span></span> <span data-ttu-id="653d0-125">Each partition archives independently and writes a completed block blob at the time of archive, named for the time at which the archive interval was encountered.</span><span class="sxs-lookup"><span data-stu-id="653d0-125">Each partition archives independently and writes a completed block blob at the time of archive, named for the time at which the archive interval was encountered.</span></span> <span data-ttu-id="653d0-126">The naming convention is as follows:</span><span class="sxs-lookup"><span data-stu-id="653d0-126">The naming convention is as follows:</span></span>

```
[Namespace]/[EventHub]/[Partition]/[YYYY]/[MM]/[DD]/[HH]/[mm]/[ss]
```

### <a name="scaling-to-throughput-units"></a><span data-ttu-id="653d0-127">Scaling to throughput units</span><span class="sxs-lookup"><span data-stu-id="653d0-127">Scaling to throughput units</span></span>
<span data-ttu-id="653d0-128">Event Hubs traffic is controlled by [throughput units](event-hubs-what-is-event-hubs.md#capacity).</span><span class="sxs-lookup"><span data-stu-id="653d0-128">Event Hubs traffic is controlled by [throughput units](event-hubs-what-is-event-hubs.md#capacity).</span></span> <span data-ttu-id="653d0-129">A single throughput unit allows 1 MB per second or 1000 events per second of ingress and twice that amount of egress.</span><span class="sxs-lookup"><span data-stu-id="653d0-129">A single throughput unit allows 1 MB per second or 1000 events per second of ingress and twice that amount of egress.</span></span> <span data-ttu-id="653d0-130">Standard Event Hubs can be configured with 1-20 throughput units, and you can purchase more via a quota increase [support request][support request].</span><span class="sxs-lookup"><span data-stu-id="653d0-130">Standard Event Hubs can be configured with 1-20 throughput units, and you can purchase more via a quota increase [support request][support request].</span></span> <span data-ttu-id="653d0-131">Usage beyond your purchased throughput units is throttled.</span><span class="sxs-lookup"><span data-stu-id="653d0-131">Usage beyond your purchased throughput units is throttled.</span></span> <span data-ttu-id="653d0-132">Event Hubs Archive copies data directly from the internal Event Hubs storage, bypassing throughput unit egress quotas and saving your egress for other processing readers, such as Stream Analytics or Spark.</span><span class="sxs-lookup"><span data-stu-id="653d0-132">Event Hubs Archive copies data directly from the internal Event Hubs storage, bypassing throughput unit egress quotas and saving your egress for other processing readers, such as Stream Analytics or Spark.</span></span>

<span data-ttu-id="653d0-133">Once configured, Event Hubs Archive runs automatically as soon as you send your first event.</span><span class="sxs-lookup"><span data-stu-id="653d0-133">Once configured, Event Hubs Archive runs automatically as soon as you send your first event.</span></span> <span data-ttu-id="653d0-134">It continues running at all times.</span><span class="sxs-lookup"><span data-stu-id="653d0-134">It continues running at all times.</span></span> <span data-ttu-id="653d0-135">To make it easier to for your downstream processing to know that the process is working, Event Hubs writes empty files when there is no data.</span><span class="sxs-lookup"><span data-stu-id="653d0-135">To make it easier to for your downstream processing to know that the process is working, Event Hubs writes empty files when there is no data.</span></span> <span data-ttu-id="653d0-136">This provides a predictable cadence and marker that can feed your batch processors.</span><span class="sxs-lookup"><span data-stu-id="653d0-136">This provides a predictable cadence and marker that can feed your batch processors.</span></span>

## <a name="setting-up-event-hubs-archive"></a><span data-ttu-id="653d0-137">Setting up Event Hubs Archive</span><span class="sxs-lookup"><span data-stu-id="653d0-137">Setting up Event Hubs Archive</span></span>
<span data-ttu-id="653d0-138">You can configure Archive at the event hub creation time via the portal, or Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="653d0-138">You can configure Archive at the event hub creation time via the portal, or Azure Resource Manager.</span></span> <span data-ttu-id="653d0-139">You simply enable Archive by clicking the **On** button.</span><span class="sxs-lookup"><span data-stu-id="653d0-139">You simply enable Archive by clicking the **On** button.</span></span> <span data-ttu-id="653d0-140">You configure a Storage Account and container by clicking the **Container** section of the blade.</span><span class="sxs-lookup"><span data-stu-id="653d0-140">You configure a Storage Account and container by clicking the **Container** section of the blade.</span></span> <span data-ttu-id="653d0-141">Because Event Hubs Archive uses service-to-service authentication with storage, you do not need to specify a storage connection string.</span><span class="sxs-lookup"><span data-stu-id="653d0-141">Because Event Hubs Archive uses service-to-service authentication with storage, you do not need to specify a storage connection string.</span></span> <span data-ttu-id="653d0-142">The resource picker selects the resource URI for your storage account automatically.</span><span class="sxs-lookup"><span data-stu-id="653d0-142">The resource picker selects the resource URI for your storage account automatically.</span></span> <span data-ttu-id="653d0-143">If you use Azure Resource Manager, you must supply this URI explicitly as a string.</span><span class="sxs-lookup"><span data-stu-id="653d0-143">If you use Azure Resource Manager, you must supply this URI explicitly as a string.</span></span>

<span data-ttu-id="653d0-144">The default time window is 5 minutes.</span><span class="sxs-lookup"><span data-stu-id="653d0-144">The default time window is 5 minutes.</span></span> <span data-ttu-id="653d0-145">The minimum value is 1, the maximum 15.</span><span class="sxs-lookup"><span data-stu-id="653d0-145">The minimum value is 1, the maximum 15.</span></span> <span data-ttu-id="653d0-146">The **Size** window has a range of 10-500 MB.</span><span class="sxs-lookup"><span data-stu-id="653d0-146">The **Size** window has a range of 10-500 MB.</span></span>

![][1]

## <a name="adding-archive-to-an-existing-event-hub"></a><span data-ttu-id="653d0-147">Adding Archive to an existing event hub</span><span class="sxs-lookup"><span data-stu-id="653d0-147">Adding Archive to an existing event hub</span></span>
<span data-ttu-id="653d0-148">Archive can be configured on existing event hubs that are in an Event Hubs namespace.</span><span class="sxs-lookup"><span data-stu-id="653d0-148">Archive can be configured on existing event hubs that are in an Event Hubs namespace.</span></span> <span data-ttu-id="653d0-149">The feature is not available on older **Messaging** or **Mixed** type namespaces.</span><span class="sxs-lookup"><span data-stu-id="653d0-149">The feature is not available on older **Messaging** or **Mixed** type namespaces.</span></span> <span data-ttu-id="653d0-150">To enable Archive on an existing event hub, or to change your Archive settings, click your namespace to load the **Essentials** blade, then click the event hub for which you want to enable or change the Archive setting.</span><span class="sxs-lookup"><span data-stu-id="653d0-150">To enable Archive on an existing event hub, or to change your Archive settings, click your namespace to load the **Essentials** blade, then click the event hub for which you want to enable or change the Archive setting.</span></span> <span data-ttu-id="653d0-151">Finally, click on the **Properties** section of the open blade as shown in the following figure.</span><span class="sxs-lookup"><span data-stu-id="653d0-151">Finally, click on the **Properties** section of the open blade as shown in the following figure.</span></span>

![][2]

<span data-ttu-id="653d0-152">You can also configure Event Hubs Archive via Azure Resource Manager templates.</span><span class="sxs-lookup"><span data-stu-id="653d0-152">You can also configure Event Hubs Archive via Azure Resource Manager templates.</span></span> <span data-ttu-id="653d0-153">For more information, see [this article](event-hubs-resource-manager-namespace-event-hub-enable-archive.md).</span><span class="sxs-lookup"><span data-stu-id="653d0-153">For more information, see [this article](event-hubs-resource-manager-namespace-event-hub-enable-archive.md).</span></span>

## <a name="exploring-the-archive-and-working-with-avro"></a><span data-ttu-id="653d0-154">Exploring the archive and working with Avro</span><span class="sxs-lookup"><span data-stu-id="653d0-154">Exploring the archive and working with Avro</span></span>
<span data-ttu-id="653d0-155">Once configured, Event Hubs Archive creates files in the Azure Storage account and container provided on the configured time window.</span><span class="sxs-lookup"><span data-stu-id="653d0-155">Once configured, Event Hubs Archive creates files in the Azure Storage account and container provided on the configured time window.</span></span> <span data-ttu-id="653d0-156">You can view these files in any tool such as [Azure Storage Explorer][Azure Storage Explorer].</span><span class="sxs-lookup"><span data-stu-id="653d0-156">You can view these files in any tool such as [Azure Storage Explorer][Azure Storage Explorer].</span></span> <span data-ttu-id="653d0-157">You can download the files locally to work on them.</span><span class="sxs-lookup"><span data-stu-id="653d0-157">You can download the files locally to work on them.</span></span>

<span data-ttu-id="653d0-158">The files produced by Event Hubs Archive have the following Avro schema:</span><span class="sxs-lookup"><span data-stu-id="653d0-158">The files produced by Event Hubs Archive have the following Avro schema:</span></span>

![][3]

<span data-ttu-id="653d0-159">An easy way to explore Avro files is by using the [Avro Tools][Avro Tools] jar from Apache.</span><span class="sxs-lookup"><span data-stu-id="653d0-159">An easy way to explore Avro files is by using the [Avro Tools][Avro Tools] jar from Apache.</span></span> <span data-ttu-id="653d0-160">After downloading this jar, you can see the schema of a specific Avro file by running the following command:</span><span class="sxs-lookup"><span data-stu-id="653d0-160">After downloading this jar, you can see the schema of a specific Avro file by running the following command:</span></span>

```
java -jar avro-tools-1.8.1.jar getschema \<name of archive file\>
```

<span data-ttu-id="653d0-161">This command returns</span><span class="sxs-lookup"><span data-stu-id="653d0-161">This command returns</span></span>

```
{

    "type":"record",
    "name":"EventData",
    "namespace":"Microsoft.ServiceBus.Messaging",
    "fields":[
                 {"name":"SequenceNumber","type":"long"},
                 {"name":"Offset","type":"string"},
                 {"name":"EnqueuedTimeUtc","type":"string"},
                 {"name":"SystemProperties","type":{"type":"map","values":["long","double","string","bytes"]}},
                 {"name":"Properties","type":{"type":"map","values":["long","double","string","bytes"]}},
                 {"name":"Body","type":["null","bytes"]}
             ]
}
```

<span data-ttu-id="653d0-162">You can also use Avro Tools to convert the file to JSON format and perform other processing.</span><span class="sxs-lookup"><span data-stu-id="653d0-162">You can also use Avro Tools to convert the file to JSON format and perform other processing.</span></span>

<span data-ttu-id="653d0-163">To perform more advanced processing, download and install Avro for your choice of platform.</span><span class="sxs-lookup"><span data-stu-id="653d0-163">To perform more advanced processing, download and install Avro for your choice of platform.</span></span> <span data-ttu-id="653d0-164">At the time of this writing, there are implementations available for C, C++, C\#, Java, NodeJS, Perl, PHP, Python, and Ruby.</span><span class="sxs-lookup"><span data-stu-id="653d0-164">At the time of this writing, there are implementations available for C, C++, C\#, Java, NodeJS, Perl, PHP, Python, and Ruby.</span></span>

<span data-ttu-id="653d0-165">Apache Avro has complete Getting Started guides for [Java][Java] and [Python][Python].</span><span class="sxs-lookup"><span data-stu-id="653d0-165">Apache Avro has complete Getting Started guides for [Java][Java] and [Python][Python].</span></span> <span data-ttu-id="653d0-166">You can also read the [Getting Started with Event Hubs Archive](event-hubs-archive-python.md) article.</span><span class="sxs-lookup"><span data-stu-id="653d0-166">You can also read the [Getting Started with Event Hubs Archive](event-hubs-archive-python.md) article.</span></span>

## <a name="how-event-hubs-archive-is-charged"></a><span data-ttu-id="653d0-167">How Event Hubs Archive is charged</span><span class="sxs-lookup"><span data-stu-id="653d0-167">How Event Hubs Archive is charged</span></span>
<span data-ttu-id="653d0-168">Event Hubs Archive is metered similarly to throughput units, as an hourly charge.</span><span class="sxs-lookup"><span data-stu-id="653d0-168">Event Hubs Archive is metered similarly to throughput units, as an hourly charge.</span></span> <span data-ttu-id="653d0-169">The charge is directly proportional to the number of throughput units purchased for the namespace.</span><span class="sxs-lookup"><span data-stu-id="653d0-169">The charge is directly proportional to the number of throughput units purchased for the namespace.</span></span> <span data-ttu-id="653d0-170">As throughput units are increased and decreased, Event Hubs Archive increases and decreases to provide matching performance.</span><span class="sxs-lookup"><span data-stu-id="653d0-170">As throughput units are increased and decreased, Event Hubs Archive increases and decreases to provide matching performance.</span></span> <span data-ttu-id="653d0-171">The meters occur in tandem.</span><span class="sxs-lookup"><span data-stu-id="653d0-171">The meters occur in tandem.</span></span> <span data-ttu-id="653d0-172">The charge for Event Hubs Archive is $0.10 per hour per throughput unit, offered at a 50% discount during the preview period.</span><span class="sxs-lookup"><span data-stu-id="653d0-172">The charge for Event Hubs Archive is $0.10 per hour per throughput unit, offered at a 50% discount during the preview period.</span></span>

<span data-ttu-id="653d0-173">Event Hubs Archive is the easiest way to get data into Azure.</span><span class="sxs-lookup"><span data-stu-id="653d0-173">Event Hubs Archive is the easiest way to get data into Azure.</span></span> <span data-ttu-id="653d0-174">Using Azure Data Lake, Azure Data Factory, and Azure HDInsight, you can perform batch processing and other analytics of your choosing using familiar tools and platforms at any scale you need.</span><span class="sxs-lookup"><span data-stu-id="653d0-174">Using Azure Data Lake, Azure Data Factory, and Azure HDInsight, you can perform batch processing and other analytics of your choosing using familiar tools and platforms at any scale you need.</span></span>

## <a name="next-steps"></a><span data-ttu-id="653d0-175">Next steps</span><span class="sxs-lookup"><span data-stu-id="653d0-175">Next steps</span></span>
<span data-ttu-id="653d0-176">You can learn more about Event Hubs by visiting the following links:</span><span class="sxs-lookup"><span data-stu-id="653d0-176">You can learn more about Event Hubs by visiting the following links:</span></span>

* <span data-ttu-id="653d0-177">A complete [sample application that uses Event Hubs][sample application that uses Event Hubs].</span><span class="sxs-lookup"><span data-stu-id="653d0-177">A complete [sample application that uses Event Hubs][sample application that uses Event Hubs].</span></span>
* <span data-ttu-id="653d0-178">The [Scale out Event Processing with Event Hubs][Scale out Event Processing with Event Hubs] sample.</span><span class="sxs-lookup"><span data-stu-id="653d0-178">The [Scale out Event Processing with Event Hubs][Scale out Event Processing with Event Hubs] sample.</span></span>
* <span data-ttu-id="653d0-179">[Event Hubs overview][Event Hubs overview]</span><span class="sxs-lookup"><span data-stu-id="653d0-179">[Event Hubs overview][Event Hubs overview]</span></span>

[Apache Avro]: http://avro.apache.org/
[support request]: https://portal.azure.com/?#blade/Microsoft_Azure_Support/HelpAndSupportBlade
[1]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/event-hubs/media/event-hubs-archive-overview/event-hubs-archive1.png
[2]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/event-hubs/media/event-hubs-archive-overview/event-hubs-archive2.png
[Azure Storage Explorer]: http://azurestorageexplorer.codeplex.com/
[3]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/event-hubs/media/event-hubs-archive-overview/event-hubs-archive3.png
[Avro Tools]: http://www-us.apache.org/dist/avro/avro-1.8.1/java/avro-tools-1.8.1.jar
[Java]: http://avro.apache.org/docs/current/gettingstartedjava.html
[Python]: http://avro.apache.org/docs/current/gettingstartedpython.html
[Event Hubs overview]: event-hubs-what-is-event-hubs.md
[sample application that uses Event Hubs]: https://code.msdn.microsoft.com/Service-Bus-Event-Hub-286fd097
[Scale out Event Processing with Event Hubs]: https://code.msdn.microsoft.com/Service-Bus-Event-Hub-45f43fc3



