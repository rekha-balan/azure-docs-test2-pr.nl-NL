---
title: Create and manage Azure Database for MySQL VNet service endpoints and rules using Azure CLI | Microsoft Docs
description: This article describes how to create and manage Azure Database for MySQL VNet service endpoints and rules using Azure CLI command line.
services: mysql
author: mbolz
ms.author: mbolz
manager: jhubbard
editor: jasonwhowell
ms.service: mysql
ms.devlang: azure-cli
ms.topic: article
ms.date: 08/15/2018
ms.openlocfilehash: dd856cda58bc88c8c3d928ac41366caaa15faac9
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44969495"
---
# <a name="create-and-manage-azure-database-for-mysql-vnet-service-endpoints-using-azure-cli"></a><span data-ttu-id="1b52e-103">Create and manage Azure Database for MySQL VNet service endpoints using Azure CLI</span><span class="sxs-lookup"><span data-stu-id="1b52e-103">Create and manage Azure Database for MySQL VNet service endpoints using Azure CLI</span></span>
<span data-ttu-id="1b52e-104">Virtual Network (VNet) services endpoints and rules extend the private address space of a Virtual Network to your Azure Database for MySQL server.</span><span class="sxs-lookup"><span data-stu-id="1b52e-104">Virtual Network (VNet) services endpoints and rules extend the private address space of a Virtual Network to your Azure Database for MySQL server.</span></span> <span data-ttu-id="1b52e-105">Using convenient Azure Command Line Interface (CLI) commands, you can create, update, delete, list, and show VNet service endpoints and rules to manage your server.</span><span class="sxs-lookup"><span data-stu-id="1b52e-105">Using convenient Azure Command Line Interface (CLI) commands, you can create, update, delete, list, and show VNet service endpoints and rules to manage your server.</span></span> <span data-ttu-id="1b52e-106">For an overview of Azure Database for MySQL VNet service endpoints, including limitations, see [Azure Database for MySQL Server VNet service endpoints](concepts-data-access-and-security-vnet.md).</span><span class="sxs-lookup"><span data-stu-id="1b52e-106">For an overview of Azure Database for MySQL VNet service endpoints, including limitations, see [Azure Database for MySQL Server VNet service endpoints](concepts-data-access-and-security-vnet.md).</span></span> <span data-ttu-id="1b52e-107">VNet service endpoints are available in all supported regions for Azure Database for MySQL.</span><span class="sxs-lookup"><span data-stu-id="1b52e-107">VNet service endpoints are available in all supported regions for Azure Database for MySQL.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="1b52e-108">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="1b52e-108">Prerequisites</span></span>
<span data-ttu-id="1b52e-109">To step through this how-to guide, you need:</span><span class="sxs-lookup"><span data-stu-id="1b52e-109">To step through this how-to guide, you need:</span></span>
- <span data-ttu-id="1b52e-110">Install [Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest) command-line utility or use the Azure Cloud Shell in the browser.</span><span class="sxs-lookup"><span data-stu-id="1b52e-110">Install [Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest) command-line utility or use the Azure Cloud Shell in the browser.</span></span>
- <span data-ttu-id="1b52e-111">An [Azure Database for MySQL server and database](quickstart-create-mysql-server-database-using-azure-cli.md).</span><span class="sxs-lookup"><span data-stu-id="1b52e-111">An [Azure Database for MySQL server and database](quickstart-create-mysql-server-database-using-azure-cli.md).</span></span>

> [!NOTE]
> <span data-ttu-id="1b52e-112">Support for VNet service endpoints is only for General Purpose and Memory Optimized servers.</span><span class="sxs-lookup"><span data-stu-id="1b52e-112">Support for VNet service endpoints is only for General Purpose and Memory Optimized servers.</span></span>

## <a name="configure-vnet-service-endpoints-for-azure-database-for-mysql"></a><span data-ttu-id="1b52e-113">Configure Vnet service endpoints for Azure Database for MySQL</span><span class="sxs-lookup"><span data-stu-id="1b52e-113">Configure Vnet service endpoints for Azure Database for MySQL</span></span>
<span data-ttu-id="1b52e-114">The [az network vnet](https://docs.microsoft.com/cli/azure/network/vnet?view=azure-cli-latest) commands are used to configure Virtual Networks.</span><span class="sxs-lookup"><span data-stu-id="1b52e-114">The [az network vnet](https://docs.microsoft.com/cli/azure/network/vnet?view=azure-cli-latest) commands are used to configure Virtual Networks.</span></span>

<span data-ttu-id="1b52e-115">If you don't have an Azure subscription, create a [free](https://azure.microsoft.com/free/) account before you begin.</span><span class="sxs-lookup"><span data-stu-id="1b52e-115">If you don't have an Azure subscription, create a [free](https://azure.microsoft.com/free/) account before you begin.</span></span>

[!INCLUDE [cloud-shell-try-it](../../includes/cloud-shell-try-it.md)]

<span data-ttu-id="1b52e-116">If you choose to install and use the CLI locally, this article requires that you are running the Azure CLI version 2.0 or later.</span><span class="sxs-lookup"><span data-stu-id="1b52e-116">If you choose to install and use the CLI locally, this article requires that you are running the Azure CLI version 2.0 or later.</span></span> <span data-ttu-id="1b52e-117">To see the version installed, run the `az --version` command.</span><span class="sxs-lookup"><span data-stu-id="1b52e-117">To see the version installed, run the `az --version` command.</span></span> <span data-ttu-id="1b52e-118">If you need to install or upgrade, see [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest).</span><span class="sxs-lookup"><span data-stu-id="1b52e-118">If you need to install or upgrade, see [Install Azure CLI 2.0](https://docs.microsoft.com/cli/azure/install-azure-cli?view=azure-cli-latest).</span></span> 

<span data-ttu-id="1b52e-119">If you are running the CLI locally, you need to log in to your account using the [az login](https://docs.microsoft.com/cli/azure/authenticate-azure-cli?view=azure-cli-latest) command.</span><span class="sxs-lookup"><span data-stu-id="1b52e-119">If you are running the CLI locally, you need to log in to your account using the [az login](https://docs.microsoft.com/cli/azure/authenticate-azure-cli?view=azure-cli-latest) command.</span></span> <span data-ttu-id="1b52e-120">Note the **id** property from the command output for the corresponding subscription name.</span><span class="sxs-lookup"><span data-stu-id="1b52e-120">Note the **id** property from the command output for the corresponding subscription name.</span></span>
```azurecli-interactive
az login
```

<span data-ttu-id="1b52e-121">If you have multiple subscriptions, choose the appropriate subscription in which the resource should be billed.</span><span class="sxs-lookup"><span data-stu-id="1b52e-121">If you have multiple subscriptions, choose the appropriate subscription in which the resource should be billed.</span></span> <span data-ttu-id="1b52e-122">Select the specific subscription ID under your account using [az account set](https://docs.microsoft.com/cli/azure/account?view=azure-cli-latest#az-account-set) command.</span><span class="sxs-lookup"><span data-stu-id="1b52e-122">Select the specific subscription ID under your account using [az account set](https://docs.microsoft.com/cli/azure/account?view=azure-cli-latest#az-account-set) command.</span></span> <span data-ttu-id="1b52e-123">Substitute the **id** property from the **az login** output for your subscription into the subscription id placeholder.</span><span class="sxs-lookup"><span data-stu-id="1b52e-123">Substitute the **id** property from the **az login** output for your subscription into the subscription id placeholder.</span></span>

- <span data-ttu-id="1b52e-124">The account must have the necessary permissions to create a virtual network and service endpoint.</span><span class="sxs-lookup"><span data-stu-id="1b52e-124">The account must have the necessary permissions to create a virtual network and service endpoint.</span></span>

<span data-ttu-id="1b52e-125">Service endpoints can be configured on virtual networks independently, by a user with write access to the virtual network.</span><span class="sxs-lookup"><span data-stu-id="1b52e-125">Service endpoints can be configured on virtual networks independently, by a user with write access to the virtual network.</span></span>

<span data-ttu-id="1b52e-126">To secure Azure service resources to a VNet, the user must have permission to "Microsoft.Network/JoinServicetoaSubnet" for the subnets being added.</span><span class="sxs-lookup"><span data-stu-id="1b52e-126">To secure Azure service resources to a VNet, the user must have permission to "Microsoft.Network/JoinServicetoaSubnet" for the subnets being added.</span></span> <span data-ttu-id="1b52e-127">This permission is included in the built-in service administrator roles, by default and can be modified by creating custom roles.</span><span class="sxs-lookup"><span data-stu-id="1b52e-127">This permission is included in the built-in service administrator roles, by default and can be modified by creating custom roles.</span></span>

<span data-ttu-id="1b52e-128">Learn more about [built-in roles](https://docs.microsoft.com/azure/active-directory/role-based-access-built-in-roles) and assigning specific permissions to [custom roles](https://docs.microsoft.com/azure/active-directory/role-based-access-control-custom-roles).</span><span class="sxs-lookup"><span data-stu-id="1b52e-128">Learn more about [built-in roles](https://docs.microsoft.com/azure/active-directory/role-based-access-built-in-roles) and assigning specific permissions to [custom roles](https://docs.microsoft.com/azure/active-directory/role-based-access-control-custom-roles).</span></span>

<span data-ttu-id="1b52e-129">VNets and Azure service resources can be in the same or different subscriptions.</span><span class="sxs-lookup"><span data-stu-id="1b52e-129">VNets and Azure service resources can be in the same or different subscriptions.</span></span> <span data-ttu-id="1b52e-130">If the VNet and Azure service resources are in different subscriptions, the resources should be under the same Active Directory (AD) tenant.</span><span class="sxs-lookup"><span data-stu-id="1b52e-130">If the VNet and Azure service resources are in different subscriptions, the resources should be under the same Active Directory (AD) tenant.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1b52e-131">It is highly recommended to read this article about service endpoint configurations and considerations before running the sample script below, or configuring service endpoints.</span><span class="sxs-lookup"><span data-stu-id="1b52e-131">It is highly recommended to read this article about service endpoint configurations and considerations before running the sample script below, or configuring service endpoints.</span></span> <span data-ttu-id="1b52e-132">**Virtual Network service endpoint:** A [Virtual Network service endpoint](../virtual-network/virtual-network-service-endpoints-overview.md) is a subnet whose property values include one or more formal Azure service type names.</span><span class="sxs-lookup"><span data-stu-id="1b52e-132">**Virtual Network service endpoint:** A [Virtual Network service endpoint](../virtual-network/virtual-network-service-endpoints-overview.md) is a subnet whose property values include one or more formal Azure service type names.</span></span> <span data-ttu-id="1b52e-133">VNet services endpoints use the service type name **Microsoft.Sql**, which refers to the Azure service named SQL Database.</span><span class="sxs-lookup"><span data-stu-id="1b52e-133">VNet services endpoints use the service type name **Microsoft.Sql**, which refers to the Azure service named SQL Database.</span></span> <span data-ttu-id="1b52e-134">This service tag also applies to the Azure SQL Database, Azure Database for PostgreSQL and MySQL services.</span><span class="sxs-lookup"><span data-stu-id="1b52e-134">This service tag also applies to the Azure SQL Database, Azure Database for PostgreSQL and MySQL services.</span></span> <span data-ttu-id="1b52e-135">It is important to note when applying the **Microsoft.Sql** service tag to a VNet service endpoint it configures service endpoint traffic for all Azure Database services, including Azure SQL Database, Azure Database for PostgreSQL and Azure Database for MySQL servers on the subnet.</span><span class="sxs-lookup"><span data-stu-id="1b52e-135">It is important to note when applying the **Microsoft.Sql** service tag to a VNet service endpoint it configures service endpoint traffic for all Azure Database services, including Azure SQL Database, Azure Database for PostgreSQL and Azure Database for MySQL servers on the subnet.</span></span> 
> 

### <a name="sample-script-to-create-an-azure-database-for-mysql-database-create-a-vnet-vnet-service-endpoint-and-secure-the-server-to-the-subnet-with-a-vnet-rule"></a><span data-ttu-id="1b52e-136">Sample script to create an Azure Database for MySQL database, create a VNet, VNet service endpoint and secure the server to the subnet with a VNet rule</span><span class="sxs-lookup"><span data-stu-id="1b52e-136">Sample script to create an Azure Database for MySQL database, create a VNet, VNet service endpoint and secure the server to the subnet with a VNet rule</span></span>
<span data-ttu-id="1b52e-137">In this sample script, change the highlighted lines to customize the admin username and password.</span><span class="sxs-lookup"><span data-stu-id="1b52e-137">In this sample script, change the highlighted lines to customize the admin username and password.</span></span> <span data-ttu-id="1b52e-138">Replace the SubscriptionID used in the `az account set --subscription` command with your own subscription identifier.</span><span class="sxs-lookup"><span data-stu-id="1b52e-138">Replace the SubscriptionID used in the `az account set --subscription` command with your own subscription identifier.</span></span>
[!code-azurecli-interactive[main](../../cli_scripts/mysql/create-mysql-server-vnet/create-mysql-server.sh?highlight=5,20 "Create an Azure Database for MySQL, VNet, VNet service endpoint, and VNet rule.")]

## <a name="clean-up-deployment"></a><span data-ttu-id="1b52e-139">Clean up deployment</span><span class="sxs-lookup"><span data-stu-id="1b52e-139">Clean up deployment</span></span>
<span data-ttu-id="1b52e-140">After the script sample has been run, the following command can be used to remove the resource group and all resources associated with it.</span><span class="sxs-lookup"><span data-stu-id="1b52e-140">After the script sample has been run, the following command can be used to remove the resource group and all resources associated with it.</span></span>
[!code-azurecli-interactive[main](../../cli_scripts/mysql/create-mysql-server-vnet/delete-mysql.sh "Delete the resource group.")]
