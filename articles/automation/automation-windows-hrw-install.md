---
title: Azure Automation Windows Hybrid Runbook Worker
description: This article provides information on installing an Azure Automation Hybrid Runbook Worker that you can use to run runbooks on Windows-based computers in your local datacenter or cloud environment.
services: automation
ms.service: automation
ms.component: process-automation
author: georgewallace
ms.author: gwallace
ms.date: 04/25/2018
ms.topic: conceptual
manager: carmonm
ms.openlocfilehash: e449e6e457c4fa568b5a4de5823014b4dcea82d0
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44864542"
---
# <a name="deploy-a-windows-hybrid-runbook-worker"></a><span data-ttu-id="bad1c-103">Deploy a Windows Hybrid Runbook Worker</span><span class="sxs-lookup"><span data-stu-id="bad1c-103">Deploy a Windows Hybrid Runbook Worker</span></span>

<span data-ttu-id="bad1c-104">You can use the Hybrid Runbook Worker feature of Azure Automation to run runbooks directly on the computer that's hosting the role and against resources in the environment to manage those local resources.</span><span class="sxs-lookup"><span data-stu-id="bad1c-104">You can use the Hybrid Runbook Worker feature of Azure Automation to run runbooks directly on the computer that's hosting the role and against resources in the environment to manage those local resources.</span></span> <span data-ttu-id="bad1c-105">Runbooks are stored and managed in Azure Automation and then delivered to one or more designated computers.</span><span class="sxs-lookup"><span data-stu-id="bad1c-105">Runbooks are stored and managed in Azure Automation and then delivered to one or more designated computers.</span></span> <span data-ttu-id="bad1c-106">This article describes how to install the Hybrid Runbook Worker on a Windows machine.</span><span class="sxs-lookup"><span data-stu-id="bad1c-106">This article describes how to install the Hybrid Runbook Worker on a Windows machine.</span></span>

## <a name="installing-the-windows-hybrid-runbook-worker"></a><span data-ttu-id="bad1c-107">Installing the Windows Hybrid Runbook Worker</span><span class="sxs-lookup"><span data-stu-id="bad1c-107">Installing the Windows Hybrid Runbook Worker</span></span>

<span data-ttu-id="bad1c-108">To install and configure a Windows Hybrid Runbook Worker, you can use two methods.</span><span class="sxs-lookup"><span data-stu-id="bad1c-108">To install and configure a Windows Hybrid Runbook Worker, you can use two methods.</span></span> <span data-ttu-id="bad1c-109">The recommended method is using an Automation runbook to completely automate the process of configuring a Windows computer.</span><span class="sxs-lookup"><span data-stu-id="bad1c-109">The recommended method is using an Automation runbook to completely automate the process of configuring a Windows computer.</span></span> <span data-ttu-id="bad1c-110">The second method is following a step-by-step procedure to manually install and configure the role.</span><span class="sxs-lookup"><span data-stu-id="bad1c-110">The second method is following a step-by-step procedure to manually install and configure the role.</span></span>

> [!NOTE]
> <span data-ttu-id="bad1c-111">To manage the configuration of your servers that support the Hybrid Runbook Worker role with Desired State Configuration (DSC), you need to add them as DSC nodes.</span><span class="sxs-lookup"><span data-stu-id="bad1c-111">To manage the configuration of your servers that support the Hybrid Runbook Worker role with Desired State Configuration (DSC), you need to add them as DSC nodes.</span></span>

<span data-ttu-id="bad1c-112">The minimum requirements for a Windows Hybrid Runbook Worker are:</span><span class="sxs-lookup"><span data-stu-id="bad1c-112">The minimum requirements for a Windows Hybrid Runbook Worker are:</span></span>

* <span data-ttu-id="bad1c-113">Windows Server 2012 or later.</span><span class="sxs-lookup"><span data-stu-id="bad1c-113">Windows Server 2012 or later.</span></span>
* <span data-ttu-id="bad1c-114">Windows PowerShell 4.0 or later ([download WMF 4.0](https://www.microsoft.com/download/details.aspx?id=40855)).</span><span class="sxs-lookup"><span data-stu-id="bad1c-114">Windows PowerShell 4.0 or later ([download WMF 4.0](https://www.microsoft.com/download/details.aspx?id=40855)).</span></span> <span data-ttu-id="bad1c-115">We recommend Windows PowerShell 5.1 ([download WMF 5.1](https://www.microsoft.com/download/details.aspx?id=54616)) for increased reliability.</span><span class="sxs-lookup"><span data-stu-id="bad1c-115">We recommend Windows PowerShell 5.1 ([download WMF 5.1](https://www.microsoft.com/download/details.aspx?id=54616)) for increased reliability.</span></span>
* <span data-ttu-id="bad1c-116">.NET Framework 4.6.2 or later.</span><span class="sxs-lookup"><span data-stu-id="bad1c-116">.NET Framework 4.6.2 or later.</span></span>
* <span data-ttu-id="bad1c-117">Two cores.</span><span class="sxs-lookup"><span data-stu-id="bad1c-117">Two cores.</span></span>
* <span data-ttu-id="bad1c-118">4 GB of RAM.</span><span class="sxs-lookup"><span data-stu-id="bad1c-118">4 GB of RAM.</span></span>
* <span data-ttu-id="bad1c-119">Port 443 (outbound).</span><span class="sxs-lookup"><span data-stu-id="bad1c-119">Port 443 (outbound).</span></span>

<span data-ttu-id="bad1c-120">To get more networking requirements for the Hybrid Runbook Worker, see [Configuring your network](automation-hybrid-runbook-worker.md#network-planning).</span><span class="sxs-lookup"><span data-stu-id="bad1c-120">To get more networking requirements for the Hybrid Runbook Worker, see [Configuring your network](automation-hybrid-runbook-worker.md#network-planning).</span></span>

<span data-ttu-id="bad1c-121">For more information about onboarding servers for management with DSC, see [Onboarding machines for management by Azure Automation DSC](automation-dsc-onboarding.md).</span><span class="sxs-lookup"><span data-stu-id="bad1c-121">For more information about onboarding servers for management with DSC, see [Onboarding machines for management by Azure Automation DSC](automation-dsc-onboarding.md).</span></span>
<span data-ttu-id="bad1c-122">If you enable the [Update Management solution](../operations-management-suite/oms-solution-update-management.md), any Windows computer that's connected to your Azure Log Analytics workspace is  automatically configured as a Hybrid Runbook Worker to support runbooks included in this solution.</span><span class="sxs-lookup"><span data-stu-id="bad1c-122">If you enable the [Update Management solution](../operations-management-suite/oms-solution-update-management.md), any Windows computer that's connected to your Azure Log Analytics workspace is  automatically configured as a Hybrid Runbook Worker to support runbooks included in this solution.</span></span> <span data-ttu-id="bad1c-123">However, it isn't registered with any Hybrid Worker groups already defined in your Automation account.</span><span class="sxs-lookup"><span data-stu-id="bad1c-123">However, it isn't registered with any Hybrid Worker groups already defined in your Automation account.</span></span> 

<span data-ttu-id="bad1c-124">The computer can be added to a Hybrid Runbook Worker group in your Automation account to support Automation runbooks as long as you're using the same account for both the solution and the Hybrid Runbook Worker group membership.</span><span class="sxs-lookup"><span data-stu-id="bad1c-124">The computer can be added to a Hybrid Runbook Worker group in your Automation account to support Automation runbooks as long as you're using the same account for both the solution and the Hybrid Runbook Worker group membership.</span></span> <span data-ttu-id="bad1c-125">This functionality has been added to version 7.2.12024.0 of the Hybrid Runbook Worker.</span><span class="sxs-lookup"><span data-stu-id="bad1c-125">This functionality has been added to version 7.2.12024.0 of the Hybrid Runbook Worker.</span></span>

<span data-ttu-id="bad1c-126">After you successfully deploy a runbook worker, review [Run runbooks on a Hybrid Runbook Worker](automation-hrw-run-runbooks.md) to learn how to configure your runbooks to automate processes in your on-premises datacenter or other cloud environment.</span><span class="sxs-lookup"><span data-stu-id="bad1c-126">After you successfully deploy a runbook worker, review [Run runbooks on a Hybrid Runbook Worker](automation-hrw-run-runbooks.md) to learn how to configure your runbooks to automate processes in your on-premises datacenter or other cloud environment.</span></span>

### <a name="automated-deployment"></a><span data-ttu-id="bad1c-127">Automated deployment</span><span class="sxs-lookup"><span data-stu-id="bad1c-127">Automated deployment</span></span>

<span data-ttu-id="bad1c-128">Perform the following steps to automate the installation and configuration of the Windows Hybrid Worker role:</span><span class="sxs-lookup"><span data-stu-id="bad1c-128">Perform the following steps to automate the installation and configuration of the Windows Hybrid Worker role:</span></span>

1. <span data-ttu-id="bad1c-129">Download the New-OnPremiseHybridWorker.ps1 script from the [PowerShell Gallery](https://www.powershellgallery.com/packages/New-OnPremiseHybridWorker/DisplayScript) directly from the computer running the Hybrid Runbook Worker role or from another computer in your environment.</span><span class="sxs-lookup"><span data-stu-id="bad1c-129">Download the New-OnPremiseHybridWorker.ps1 script from the [PowerShell Gallery](https://www.powershellgallery.com/packages/New-OnPremiseHybridWorker/DisplayScript) directly from the computer running the Hybrid Runbook Worker role or from another computer in your environment.</span></span> <span data-ttu-id="bad1c-130">Copy the script to the worker.</span><span class="sxs-lookup"><span data-stu-id="bad1c-130">Copy the script to the worker.</span></span>

   <span data-ttu-id="bad1c-131">The New-OnPremiseHybridWorker.ps1 script requires the following parameters during execution:</span><span class="sxs-lookup"><span data-stu-id="bad1c-131">The New-OnPremiseHybridWorker.ps1 script requires the following parameters during execution:</span></span>

   * <span data-ttu-id="bad1c-132">*AutomationAccountName* (mandatory): The name of your Automation account.</span><span class="sxs-lookup"><span data-stu-id="bad1c-132">*AutomationAccountName* (mandatory): The name of your Automation account.</span></span>
   * <span data-ttu-id="bad1c-133">*AAResourceGroupName* (mandatory): The name of the resource group that's associated with your Automation account.</span><span class="sxs-lookup"><span data-stu-id="bad1c-133">*AAResourceGroupName* (mandatory): The name of the resource group that's associated with your Automation account.</span></span>
   * <span data-ttu-id="bad1c-134">*OMSResourceGroupName* (optional): The name of the resource group for the Operations Management Suite workspace.</span><span class="sxs-lookup"><span data-stu-id="bad1c-134">*OMSResourceGroupName* (optional): The name of the resource group for the Operations Management Suite workspace.</span></span> <span data-ttu-id="bad1c-135">If this resource group is not specified, *AAResourceGroupName* is used.</span><span class="sxs-lookup"><span data-stu-id="bad1c-135">If this resource group is not specified, *AAResourceGroupName* is used.</span></span>
   * <span data-ttu-id="bad1c-136">*HybridGroupName* (mandatory): The name of a Hybrid Runbook Worker group that you specify as a target for the runbooks that support this scenario.</span><span class="sxs-lookup"><span data-stu-id="bad1c-136">*HybridGroupName* (mandatory): The name of a Hybrid Runbook Worker group that you specify as a target for the runbooks that support this scenario.</span></span>
   * <span data-ttu-id="bad1c-137">*SubscriptionID* (mandatory): The Azure subscription ID that your Automation account is in.</span><span class="sxs-lookup"><span data-stu-id="bad1c-137">*SubscriptionID* (mandatory): The Azure subscription ID that your Automation account is in.</span></span>
   * <span data-ttu-id="bad1c-138">*WorkspaceName* (optional): The Log Analytics workspace name.</span><span class="sxs-lookup"><span data-stu-id="bad1c-138">*WorkspaceName* (optional): The Log Analytics workspace name.</span></span> <span data-ttu-id="bad1c-139">If you don't have a Log Analytics workspace, the script creates and configures one.</span><span class="sxs-lookup"><span data-stu-id="bad1c-139">If you don't have a Log Analytics workspace, the script creates and configures one.</span></span>

     > [!NOTE]
     > <span data-ttu-id="bad1c-140">Currently, the only Automation regions supported for integration with Log Analytics are **Australia Southeast**, **East US 2**, **Southeast Asia**, and **West Europe**.</span><span class="sxs-lookup"><span data-stu-id="bad1c-140">Currently, the only Automation regions supported for integration with Log Analytics are **Australia Southeast**, **East US 2**, **Southeast Asia**, and **West Europe**.</span></span> <span data-ttu-id="bad1c-141">If your Automation account is not in one of those regions, the script creates a Log Analytics workspace but warns you that it can't link them together.</span><span class="sxs-lookup"><span data-stu-id="bad1c-141">If your Automation account is not in one of those regions, the script creates a Log Analytics workspace but warns you that it can't link them together.</span></span>

1. <span data-ttu-id="bad1c-142">On your computer, open **Windows PowerShell** from the **Start** screen in Administrator mode.</span><span class="sxs-lookup"><span data-stu-id="bad1c-142">On your computer, open **Windows PowerShell** from the **Start** screen in Administrator mode.</span></span>
1. <span data-ttu-id="bad1c-143">From the PowerShell command-line shell, browse to the folder that contains the script that you downloaded.</span><span class="sxs-lookup"><span data-stu-id="bad1c-143">From the PowerShell command-line shell, browse to the folder that contains the script that you downloaded.</span></span> <span data-ttu-id="bad1c-144">Change the values for the parameters *-AutomationAccountName*, *-AAResourceGroupName*, *-OMSResourceGroupName*, *-HybridGroupName*, *-SubscriptionId*, and *-WorkspaceName*.</span><span class="sxs-lookup"><span data-stu-id="bad1c-144">Change the values for the parameters *-AutomationAccountName*, *-AAResourceGroupName*, *-OMSResourceGroupName*, *-HybridGroupName*, *-SubscriptionId*, and *-WorkspaceName*.</span></span> <span data-ttu-id="bad1c-145">Then run the script.</span><span class="sxs-lookup"><span data-stu-id="bad1c-145">Then run the script.</span></span>

     > [!NOTE]
     > <span data-ttu-id="bad1c-146">You're prompted to authenticate with Azure after you run the script.</span><span class="sxs-lookup"><span data-stu-id="bad1c-146">You're prompted to authenticate with Azure after you run the script.</span></span> <span data-ttu-id="bad1c-147">You *must* sign in with an account that's a member of the Subscription Admins role and co-administrator of the subscription.</span><span class="sxs-lookup"><span data-stu-id="bad1c-147">You *must* sign in with an account that's a member of the Subscription Admins role and co-administrator of the subscription.</span></span>

   ```powershell-interactive
   .\New-OnPremiseHybridWorker.ps1 -AutomationAccountName <NameofAutomationAccount> -AAResourceGroupName <NameofResourceGroup>`
   -OMSResourceGroupName <NameofOResourceGroup> -HybridGroupName <NameofHRWGroup> `
   -SubscriptionId <AzureSubscriptionId> -WorkspaceName <NameOfLogAnalyticsWorkspace>
   ```

1. <span data-ttu-id="bad1c-148">You're prompted to agree to install NuGet, and you're prompted to authenticate with your Azure credentials.</span><span class="sxs-lookup"><span data-stu-id="bad1c-148">You're prompted to agree to install NuGet, and you're prompted to authenticate with your Azure credentials.</span></span>

1. <span data-ttu-id="bad1c-149">After the script is finished, the **Hybrid Worker Groups** page shows the new group and the number of members.</span><span class="sxs-lookup"><span data-stu-id="bad1c-149">After the script is finished, the **Hybrid Worker Groups** page shows the new group and the number of members.</span></span> <span data-ttu-id="bad1c-150">If it's an existing group, the number of members is incremented.</span><span class="sxs-lookup"><span data-stu-id="bad1c-150">If it's an existing group, the number of members is incremented.</span></span> <span data-ttu-id="bad1c-151">You can select the group from the list on the **Hybrid Worker Groups** page and select the **Hybrid Workers** tile.</span><span class="sxs-lookup"><span data-stu-id="bad1c-151">You can select the group from the list on the **Hybrid Worker Groups** page and select the **Hybrid Workers** tile.</span></span> <span data-ttu-id="bad1c-152">On the **Hybrid Workers** page, you see each member of the group listed.</span><span class="sxs-lookup"><span data-stu-id="bad1c-152">On the **Hybrid Workers** page, you see each member of the group listed.</span></span>

### <a name="manual-deployment"></a><span data-ttu-id="bad1c-153">Manual deployment</span><span class="sxs-lookup"><span data-stu-id="bad1c-153">Manual deployment</span></span>

<span data-ttu-id="bad1c-154">Perform the first two steps once for your Automation environment, and then repeat the remaining steps for each worker computer.</span><span class="sxs-lookup"><span data-stu-id="bad1c-154">Perform the first two steps once for your Automation environment, and then repeat the remaining steps for each worker computer.</span></span>

#### <a name="1-create-a-log-analytics-workspace"></a><span data-ttu-id="bad1c-155">1. Create a Log Analytics workspace</span><span class="sxs-lookup"><span data-stu-id="bad1c-155">1. Create a Log Analytics workspace</span></span>

<span data-ttu-id="bad1c-156">If you don't already have a Log Analytics workspace, create one by using the instructions at [Manage your workspace](../log-analytics/log-analytics-manage-access.md).</span><span class="sxs-lookup"><span data-stu-id="bad1c-156">If you don't already have a Log Analytics workspace, create one by using the instructions at [Manage your workspace](../log-analytics/log-analytics-manage-access.md).</span></span> <span data-ttu-id="bad1c-157">You can use an existing workspace if you already have one.</span><span class="sxs-lookup"><span data-stu-id="bad1c-157">You can use an existing workspace if you already have one.</span></span>

#### <a name="2-add-the-automation-solution-to-the-log-analytics-workspace"></a><span data-ttu-id="bad1c-158">2. Add the Automation solution to the Log Analytics workspace</span><span class="sxs-lookup"><span data-stu-id="bad1c-158">2. Add the Automation solution to the Log Analytics workspace</span></span>

<span data-ttu-id="bad1c-159">Solutions add functionality to Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="bad1c-159">Solutions add functionality to Log Analytics.</span></span> <span data-ttu-id="bad1c-160">The Automation solution adds functionality for Azure Automation, including support for Hybrid Runbook Worker.</span><span class="sxs-lookup"><span data-stu-id="bad1c-160">The Automation solution adds functionality for Azure Automation, including support for Hybrid Runbook Worker.</span></span> <span data-ttu-id="bad1c-161">When you add the solution to your workspace, it automatically pushes worker components to the agent computer that you will install in the next step.</span><span class="sxs-lookup"><span data-stu-id="bad1c-161">When you add the solution to your workspace, it automatically pushes worker components to the agent computer that you will install in the next step.</span></span>

<span data-ttu-id="bad1c-162">To add the **Automation** solution to your Log Analytics workspace, follow the instructions at [To add a solution using the Solutions Gallery](../log-analytics/log-analytics-add-solutions.md).</span><span class="sxs-lookup"><span data-stu-id="bad1c-162">To add the **Automation** solution to your Log Analytics workspace, follow the instructions at [To add a solution using the Solutions Gallery](../log-analytics/log-analytics-add-solutions.md).</span></span>

#### <a name="3-install-the-microsoft-monitoring-agent"></a><span data-ttu-id="bad1c-163">3. Install the Microsoft Monitoring Agent</span><span class="sxs-lookup"><span data-stu-id="bad1c-163">3. Install the Microsoft Monitoring Agent</span></span>

<span data-ttu-id="bad1c-164">The Microsoft Monitoring Agent connects computers to Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="bad1c-164">The Microsoft Monitoring Agent connects computers to Log Analytics.</span></span> <span data-ttu-id="bad1c-165">When you install the agent on your on-premises computer and connect it to your workspace, it automatically downloads the components that are required for Hybrid Runbook Worker.</span><span class="sxs-lookup"><span data-stu-id="bad1c-165">When you install the agent on your on-premises computer and connect it to your workspace, it automatically downloads the components that are required for Hybrid Runbook Worker.</span></span>

<span data-ttu-id="bad1c-166">To install the agent on the on-premises computer, follow the instructions at [Connect Windows computers to Log Analytics](../log-analytics/log-analytics-windows-agent.md).</span><span class="sxs-lookup"><span data-stu-id="bad1c-166">To install the agent on the on-premises computer, follow the instructions at [Connect Windows computers to Log Analytics](../log-analytics/log-analytics-windows-agent.md).</span></span> <span data-ttu-id="bad1c-167">You can repeat this process for multiple computers to add multiple workers to your environment.</span><span class="sxs-lookup"><span data-stu-id="bad1c-167">You can repeat this process for multiple computers to add multiple workers to your environment.</span></span>

<span data-ttu-id="bad1c-168">When the agent has successfully connected to Log Analytics, it's listed on the **Connected Sources** tab of the Log Analytics **Settings** page.</span><span class="sxs-lookup"><span data-stu-id="bad1c-168">When the agent has successfully connected to Log Analytics, it's listed on the **Connected Sources** tab of the Log Analytics **Settings** page.</span></span> <span data-ttu-id="bad1c-169">You can verify that the agent has correctly downloaded the Automation solution when it has a folder called **AzureAutomationFiles** in C:\Program Files\Microsoft Monitoring Agent\Agent.</span><span class="sxs-lookup"><span data-stu-id="bad1c-169">You can verify that the agent has correctly downloaded the Automation solution when it has a folder called **AzureAutomationFiles** in C:\Program Files\Microsoft Monitoring Agent\Agent.</span></span> <span data-ttu-id="bad1c-170">To confirm the version of the Hybrid Runbook Worker, you can browse to C:\Program Files\Microsoft Monitoring Agent\Agent\AzureAutomation\ and note the \\*version* subfolder.</span><span class="sxs-lookup"><span data-stu-id="bad1c-170">To confirm the version of the Hybrid Runbook Worker, you can browse to C:\Program Files\Microsoft Monitoring Agent\Agent\AzureAutomation\ and note the \\*version* subfolder.</span></span>

#### <a name="4-install-the-runbook-environment-and-connect-to-azure-automation"></a><span data-ttu-id="bad1c-171">4. Install the runbook environment and connect to Azure Automation</span><span class="sxs-lookup"><span data-stu-id="bad1c-171">4. Install the runbook environment and connect to Azure Automation</span></span>

<span data-ttu-id="bad1c-172">When you add an agent to Log Analytics, the Automation solution pushes down the **HybridRegistration** PowerShell module, which contains the **Add-HybridRunbookWorker** cmdlet.</span><span class="sxs-lookup"><span data-stu-id="bad1c-172">When you add an agent to Log Analytics, the Automation solution pushes down the **HybridRegistration** PowerShell module, which contains the **Add-HybridRunbookWorker** cmdlet.</span></span> <span data-ttu-id="bad1c-173">You use this cmdlet to install the runbook environment on the computer and register it with Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="bad1c-173">You use this cmdlet to install the runbook environment on the computer and register it with Azure Automation.</span></span>

<span data-ttu-id="bad1c-174">Open a PowerShell session in Administrator mode and run the following commands to import the module:</span><span class="sxs-lookup"><span data-stu-id="bad1c-174">Open a PowerShell session in Administrator mode and run the following commands to import the module:</span></span>

```powershell-interactive
cd "C:\Program Files\Microsoft Monitoring Agent\Agent\AzureAutomation\<version>\HybridRegistration"
Import-Module HybridRegistration.psd1
```

<span data-ttu-id="bad1c-175">Then run the **Add-HybridRunbookWorker** cmdlet by using the following syntax:</span><span class="sxs-lookup"><span data-stu-id="bad1c-175">Then run the **Add-HybridRunbookWorker** cmdlet by using the following syntax:</span></span>

```powershell-interactive
Add-HybridRunbookWorker â€“GroupName <String> -EndPoint <Url> -Token <String>
```

<span data-ttu-id="bad1c-176">You can get the information required for this cmdlet from the **Manage Keys** page in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="bad1c-176">You can get the information required for this cmdlet from the **Manage Keys** page in the Azure portal.</span></span> <span data-ttu-id="bad1c-177">Open this page by selecting the **Keys** option from the **Settings** page in your Automation account.</span><span class="sxs-lookup"><span data-stu-id="bad1c-177">Open this page by selecting the **Keys** option from the **Settings** page in your Automation account.</span></span>

!["Manage Keys" page](media/automation-hybrid-runbook-worker/elements-panel-keys.png)

* <span data-ttu-id="bad1c-179">**GroupName** is the name of the Hybrid Runbook Worker group.</span><span class="sxs-lookup"><span data-stu-id="bad1c-179">**GroupName** is the name of the Hybrid Runbook Worker group.</span></span> <span data-ttu-id="bad1c-180">If this group already exists in the Automation account, the current computer is added to it.</span><span class="sxs-lookup"><span data-stu-id="bad1c-180">If this group already exists in the Automation account, the current computer is added to it.</span></span> <span data-ttu-id="bad1c-181">If this group doesn't exist, it's added.</span><span class="sxs-lookup"><span data-stu-id="bad1c-181">If this group doesn't exist, it's added.</span></span>
* <span data-ttu-id="bad1c-182">**EndPoint** is the **URL** entry on the **Manage Keys** page.</span><span class="sxs-lookup"><span data-stu-id="bad1c-182">**EndPoint** is the **URL** entry on the **Manage Keys** page.</span></span>
* <span data-ttu-id="bad1c-183">**Token** is the **PRIMARY ACCESS KEY** entry on the **Manage Keys** page.</span><span class="sxs-lookup"><span data-stu-id="bad1c-183">**Token** is the **PRIMARY ACCESS KEY** entry on the **Manage Keys** page.</span></span>

<span data-ttu-id="bad1c-184">To receive detailed information about the installation, use the **-Verbose** switch with **Add-HybridRunbookWorker**.</span><span class="sxs-lookup"><span data-stu-id="bad1c-184">To receive detailed information about the installation, use the **-Verbose** switch with **Add-HybridRunbookWorker**.</span></span>

#### <a name="5-install-powershell-modules"></a><span data-ttu-id="bad1c-185">5. Install PowerShell modules</span><span class="sxs-lookup"><span data-stu-id="bad1c-185">5. Install PowerShell modules</span></span>

<span data-ttu-id="bad1c-186">Runbooks can use any of the activities and cmdlets defined in the modules that are installed in your Azure Automation environment.</span><span class="sxs-lookup"><span data-stu-id="bad1c-186">Runbooks can use any of the activities and cmdlets defined in the modules that are installed in your Azure Automation environment.</span></span> <span data-ttu-id="bad1c-187">These modules are not automatically deployed to on-premises computers, so you must install them manually.</span><span class="sxs-lookup"><span data-stu-id="bad1c-187">These modules are not automatically deployed to on-premises computers, so you must install them manually.</span></span> <span data-ttu-id="bad1c-188">The exception is the Azure module, which is installed by default and provides access to cmdlets for all Azure services and activities for Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="bad1c-188">The exception is the Azure module, which is installed by default and provides access to cmdlets for all Azure services and activities for Azure Automation.</span></span>

<span data-ttu-id="bad1c-189">Because the primary purpose of the Hybrid Runbook Worker feature is to manage local resources, you most likely need to install the modules that support these resources.</span><span class="sxs-lookup"><span data-stu-id="bad1c-189">Because the primary purpose of the Hybrid Runbook Worker feature is to manage local resources, you most likely need to install the modules that support these resources.</span></span> <span data-ttu-id="bad1c-190">For information on installing Windows PowerShell modules, see [Installing Modules](http://msdn.microsoft.com/library/dd878350.aspx).</span><span class="sxs-lookup"><span data-stu-id="bad1c-190">For information on installing Windows PowerShell modules, see [Installing Modules](http://msdn.microsoft.com/library/dd878350.aspx).</span></span> 

<span data-ttu-id="bad1c-191">Modules that are installed must be in a location referenced by the **PSModulePath** environment variable so that the hybrid worker can automatically import them.</span><span class="sxs-lookup"><span data-stu-id="bad1c-191">Modules that are installed must be in a location referenced by the **PSModulePath** environment variable so that the hybrid worker can automatically import them.</span></span> <span data-ttu-id="bad1c-192">For more information, see [Modifying the PSModulePath Installation Path](https://msdn.microsoft.com/library/dd878326%28v=vs.85%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="bad1c-192">For more information, see [Modifying the PSModulePath Installation Path](https://msdn.microsoft.com/library/dd878326%28v=vs.85%29.aspx).</span></span>

## <a name="troubleshoot"></a><span data-ttu-id="bad1c-193">Troubleshoot</span><span class="sxs-lookup"><span data-stu-id="bad1c-193">Troubleshoot</span></span>

<span data-ttu-id="bad1c-194">To learn how to troubleshoot your Hybrid Runbook Workers, see [Troubleshooting Windows Hybrid Runbook Workers](troubleshoot/hybrid-runbook-worker.md#windows)</span><span class="sxs-lookup"><span data-stu-id="bad1c-194">To learn how to troubleshoot your Hybrid Runbook Workers, see [Troubleshooting Windows Hybrid Runbook Workers](troubleshoot/hybrid-runbook-worker.md#windows)</span></span>

<span data-ttu-id="bad1c-195">For additional steps on how to troubleshoot issues with Update Management, see [Update Management: troubleshooting](troubleshoot/update-management.md).</span><span class="sxs-lookup"><span data-stu-id="bad1c-195">For additional steps on how to troubleshoot issues with Update Management, see [Update Management: troubleshooting](troubleshoot/update-management.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="bad1c-196">Next steps</span><span class="sxs-lookup"><span data-stu-id="bad1c-196">Next steps</span></span>

* <span data-ttu-id="bad1c-197">To learn how to configure your runbooks to automate processes in your on-premises datacenter or other cloud environment, see [Run runbooks on a Hybrid Runbook Worker](automation-hrw-run-runbooks.md).</span><span class="sxs-lookup"><span data-stu-id="bad1c-197">To learn how to configure your runbooks to automate processes in your on-premises datacenter or other cloud environment, see [Run runbooks on a Hybrid Runbook Worker](automation-hrw-run-runbooks.md).</span></span>
* <span data-ttu-id="bad1c-198">For instructions on how to remove Hybrid Runbook Workers, see [Remove Azure Automation Hybrid Runbook Workers](automation-hybrid-runbook-worker.md#remove-a-hybrid-runbook-worker).</span><span class="sxs-lookup"><span data-stu-id="bad1c-198">For instructions on how to remove Hybrid Runbook Workers, see [Remove Azure Automation Hybrid Runbook Workers](automation-hybrid-runbook-worker.md#remove-a-hybrid-runbook-worker).</span></span>