---
title: Error handling in Azure Automation graphical runbooks | Microsoft Docs
description: This article describes how to implement error handling logic in Azure Automation graphical runbooks.
services: automation
documentationcenter: ''
author: mgoedtel
manager: jwhit
editor: tysonn
ms.assetid: ''
ms.service: automation
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 12/26/2016
ms.author: magoedte
ms.openlocfilehash: 07bc25a55ed4f2b41c526d7615c72667b1ce2a8b
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44671487"
---
# <a name="error-handling-in-azure-automation-graphical-runbooks"></a><span data-ttu-id="ed7ac-103">Error handling in Azure Automation graphical runbooks</span><span class="sxs-lookup"><span data-stu-id="ed7ac-103">Error handling in Azure Automation graphical runbooks</span></span>

<span data-ttu-id="ed7ac-104">A key runbook design principal to consider is identifying different issues that a runbook might experience.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-104">A key runbook design principal to consider is identifying different issues that a runbook might experience.</span></span> <span data-ttu-id="ed7ac-105">These issues can include success, expected error states, and unexpected error conditions.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-105">These issues can include success, expected error states, and unexpected error conditions.</span></span>

<span data-ttu-id="ed7ac-106">Runbooks should include error handling.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-106">Runbooks should include error handling.</span></span> <span data-ttu-id="ed7ac-107">To validate the output of an activity or handle an error with graphical runbooks, you could use a Windows PowerShell code activity, define conditional logic on the output link of the activity, or apply another method.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-107">To validate the output of an activity or handle an error with graphical runbooks, you could use a Windows PowerShell code activity, define conditional logic on the output link of the activity, or apply another method.</span></span>          

<span data-ttu-id="ed7ac-108">Often, if there is a non-terminating error that occurs with a runbook activity, any activity that follows is processed regardless of the error.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-108">Often, if there is a non-terminating error that occurs with a runbook activity, any activity that follows is processed regardless of the error.</span></span> <span data-ttu-id="ed7ac-109">The error is likely to generate an exception, but the next activity is still allowed to run.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-109">The error is likely to generate an exception, but the next activity is still allowed to run.</span></span> <span data-ttu-id="ed7ac-110">This is the way that PowerShell is designed to handle errors.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-110">This is the way that PowerShell is designed to handle errors.</span></span>    

<span data-ttu-id="ed7ac-111">The types of PowerShell errors that can occur during execution are terminating or non-terminating.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-111">The types of PowerShell errors that can occur during execution are terminating or non-terminating.</span></span> <span data-ttu-id="ed7ac-112">The differences between terminating and non-terminating errors are as follows:</span><span class="sxs-lookup"><span data-stu-id="ed7ac-112">The differences between terminating and non-terminating errors are as follows:</span></span>

* <span data-ttu-id="ed7ac-113">**Terminating error**: A serious error during execution that halts the command (or script execution) completely.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-113">**Terminating error**: A serious error during execution that halts the command (or script execution) completely.</span></span> <span data-ttu-id="ed7ac-114">Examples include non-existent cmdlets, syntax errors that prevent a cmdlet from running, or other fatal errors.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-114">Examples include non-existent cmdlets, syntax errors that prevent a cmdlet from running, or other fatal errors.</span></span>

* <span data-ttu-id="ed7ac-115">**Non-terminating error**: A non-serious error that allows execution to continue despite the failure.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-115">**Non-terminating error**: A non-serious error that allows execution to continue despite the failure.</span></span> <span data-ttu-id="ed7ac-116">Examples include operational errors such as file not found errors and permissions problems.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-116">Examples include operational errors such as file not found errors and permissions problems.</span></span>

<span data-ttu-id="ed7ac-117">Azure Automation graphical runbooks have been improved with the capability to include error handling.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-117">Azure Automation graphical runbooks have been improved with the capability to include error handling.</span></span> <span data-ttu-id="ed7ac-118">You can now turn exceptions into non-terminating errors and create error links between activities.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-118">You can now turn exceptions into non-terminating errors and create error links between activities.</span></span> <span data-ttu-id="ed7ac-119">This process allows a runbook author to catch errors and manage realized or unexpected conditions.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-119">This process allows a runbook author to catch errors and manage realized or unexpected conditions.</span></span>  

## <a name="when-to-use-error-handling"></a><span data-ttu-id="ed7ac-120">When to use error handling</span><span class="sxs-lookup"><span data-stu-id="ed7ac-120">When to use error handling</span></span>

<span data-ttu-id="ed7ac-121">Whenever there is a critical activity that throws an error or exception, it's important to prevent the next activity in your runbook from processing and to handle the error appropriately.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-121">Whenever there is a critical activity that throws an error or exception, it's important to prevent the next activity in your runbook from processing and to handle the error appropriately.</span></span> <span data-ttu-id="ed7ac-122">This is especially critical when your runbooks are supporting a business or service operations process.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-122">This is especially critical when your runbooks are supporting a business or service operations process.</span></span>

<span data-ttu-id="ed7ac-123">For each activity that can produce an error, the runbook author can add an error link pointing to any other activity.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-123">For each activity that can produce an error, the runbook author can add an error link pointing to any other activity.</span></span>  <span data-ttu-id="ed7ac-124">The destination activity can be of any type, including code activities, invoking a cmdlet, invoking another runbook, and so on.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-124">The destination activity can be of any type, including code activities, invoking a cmdlet, invoking another runbook, and so on.</span></span>

<span data-ttu-id="ed7ac-125">In addition, the destination activity can also have outgoing links.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-125">In addition, the destination activity can also have outgoing links.</span></span> <span data-ttu-id="ed7ac-126">These links can be regular links or error links.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-126">These links can be regular links or error links.</span></span> <span data-ttu-id="ed7ac-127">This means the runbook author can implement complex error-handling logic without resorting to a code activity.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-127">This means the runbook author can implement complex error-handling logic without resorting to a code activity.</span></span> <span data-ttu-id="ed7ac-128">The recommended practice is to create a dedicated error-handling runbook with common functionality, but it's not mandatory.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-128">The recommended practice is to create a dedicated error-handling runbook with common functionality, but it's not mandatory.</span></span> <span data-ttu-id="ed7ac-129">Error-handling logic in a PowerShell code activity it isn't the only option.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-129">Error-handling logic in a PowerShell code activity it isn't the only option.</span></span>  

<span data-ttu-id="ed7ac-130">For example, consider a runbook that tries to start a VM and install an application on it.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-130">For example, consider a runbook that tries to start a VM and install an application on it.</span></span> <span data-ttu-id="ed7ac-131">If the VM doesn't start correctly, it performs two actions:</span><span class="sxs-lookup"><span data-stu-id="ed7ac-131">If the VM doesn't start correctly, it performs two actions:</span></span>

1. <span data-ttu-id="ed7ac-132">It sends a notification about this problem.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-132">It sends a notification about this problem.</span></span>
2. <span data-ttu-id="ed7ac-133">It starts another runbook that automatically provisions a new VM instead.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-133">It starts another runbook that automatically provisions a new VM instead.</span></span>

<span data-ttu-id="ed7ac-134">One solution is to have an error link pointing to an activity that handles step one.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-134">One solution is to have an error link pointing to an activity that handles step one.</span></span> <span data-ttu-id="ed7ac-135">For example, you could connect the **Write-Warning** cmdlet to an activity for step two, such as the **Start-AzureRmAutomationRunbook** cmdlet.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-135">For example, you could connect the **Write-Warning** cmdlet to an activity for step two, such as the **Start-AzureRmAutomationRunbook** cmdlet.</span></span>

<span data-ttu-id="ed7ac-136">You could also generalize this behavior for use in many runbooks by putting these two activities in a separate error handling runbook and following the guidance suggested earlier.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-136">You could also generalize this behavior for use in many runbooks by putting these two activities in a separate error handling runbook and following the guidance suggested earlier.</span></span> <span data-ttu-id="ed7ac-137">Before calling this error-handling runbook, you could construct a custom message from the data in the original runbook, and then pass it as a parameter to the error-handling runbook.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-137">Before calling this error-handling runbook, you could construct a custom message from the data in the original runbook, and then pass it as a parameter to the error-handling runbook.</span></span>

## <a name="how-to-use-error-handling"></a><span data-ttu-id="ed7ac-138">How to use error handling</span><span class="sxs-lookup"><span data-stu-id="ed7ac-138">How to use error handling</span></span>

<span data-ttu-id="ed7ac-139">Each activity has a configuration setting that turns exceptions into non-terminating errors.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-139">Each activity has a configuration setting that turns exceptions into non-terminating errors.</span></span> <span data-ttu-id="ed7ac-140">By default, this setting is disabled.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-140">By default, this setting is disabled.</span></span> <span data-ttu-id="ed7ac-141">We recommend that you enable this setting on any activity where you want to handle errors.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-141">We recommend that you enable this setting on any activity where you want to handle errors.</span></span>  

<span data-ttu-id="ed7ac-142">By enabling this configuration, you are assuring that both terminating and non-terminating errors in the activity are handled as non-terminating errors, and can be handled with an error link.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-142">By enabling this configuration, you are assuring that both terminating and non-terminating errors in the activity are handled as non-terminating errors, and can be handled with an error link.</span></span>  

<span data-ttu-id="ed7ac-143">After configuring this setting, you create an activity that handles the error.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-143">After configuring this setting, you create an activity that handles the error.</span></span> <span data-ttu-id="ed7ac-144">If an activity produces any error, then the outgoing error links are followed, and the regular links are not, even if the activity produces regular output as well.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-144">If an activity produces any error, then the outgoing error links are followed, and the regular links are not, even if the activity produces regular output as well.</span></span><br><br> ![Automation runbook error link example](https://docstestmedia1.blob.core.windows.net/azure-media/articles/automation/media/automation-runbook-graphical-error-handling/error-link-example.png)

<span data-ttu-id="ed7ac-146">In the following example, a runbook retrieves a variable that contains the computer name of a virtual machine.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-146">In the following example, a runbook retrieves a variable that contains the computer name of a virtual machine.</span></span> <span data-ttu-id="ed7ac-147">It then attempts to start the virtual machine with the next activity.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-147">It then attempts to start the virtual machine with the next activity.</span></span><br><br> ![Automation runbook error-handling example](https://docstestmedia1.blob.core.windows.net/azure-media/articles/automation/media/automation-runbook-graphical-error-handling/runbook-example-error-handling.png)<br><br>      

<span data-ttu-id="ed7ac-149">The **Get-AutomationVariable** activity and **Start-AzureRmVm** are configured to convert exceptions to errors.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-149">The **Get-AutomationVariable** activity and **Start-AzureRmVm** are configured to convert exceptions to errors.</span></span>  <span data-ttu-id="ed7ac-150">If there are problems getting the variable or starting the VM, then errors are generated.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-150">If there are problems getting the variable or starting the VM, then errors are generated.</span></span><br><br> <span data-ttu-id="ed7ac-151">![Automation runbook error-handling activity settings](https://docstestmedia1.blob.core.windows.net/azure-media/articles/automation/media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span><span class="sxs-lookup"><span data-stu-id="ed7ac-151">![Automation runbook error-handling activity settings](https://docstestmedia1.blob.core.windows.net/azure-media/articles/automation/media/automation-runbook-graphical-error-handling/activity-blade-convertexception-option.png)</span></span>

<span data-ttu-id="ed7ac-152">Error links flow from these activities to a single **error management** activity (a code activity).</span><span class="sxs-lookup"><span data-stu-id="ed7ac-152">Error links flow from these activities to a single **error management** activity (a code activity).</span></span> <span data-ttu-id="ed7ac-153">This activity is configured with a simple PowerShell expression that uses the *Throw* keyword to stop processing, along with *$Error.Exception.Message* to get the message that describes the current exception.</span><span class="sxs-lookup"><span data-stu-id="ed7ac-153">This activity is configured with a simple PowerShell expression that uses the *Throw* keyword to stop processing, along with *$Error.Exception.Message* to get the message that describes the current exception.</span></span><br><br> <span data-ttu-id="ed7ac-154">![Automation runbook error-handling code example](https://docstestmedia1.blob.core.windows.net/azure-media/articles/automation/media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span><span class="sxs-lookup"><span data-stu-id="ed7ac-154">![Automation runbook error-handling code example](https://docstestmedia1.blob.core.windows.net/azure-media/articles/automation/media/automation-runbook-graphical-error-handling/runbook-example-error-handling-code.png)</span></span>


## <a name="next-steps"></a><span data-ttu-id="ed7ac-155">Next steps</span><span class="sxs-lookup"><span data-stu-id="ed7ac-155">Next steps</span></span>

* <span data-ttu-id="ed7ac-156">To learn more about links and link types in graphical runbooks, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span><span class="sxs-lookup"><span data-stu-id="ed7ac-156">To learn more about links and link types in graphical runbooks, see [Graphical authoring in Azure Automation](automation-graphical-authoring-intro.md#links-and-workflow).</span></span>

* <span data-ttu-id="ed7ac-157">To learn more about runbook execution, how to monitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span><span class="sxs-lookup"><span data-stu-id="ed7ac-157">To learn more about runbook execution, how to monitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span></span>




