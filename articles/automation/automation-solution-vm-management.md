---
title: Start/Stop VMs during off-hours solution
description: This VM management solution starts and stops your Azure Resource Manager virtual machines on a schedule and proactively monitors from Log Analytics.
services: automation
ms.service: automation
ms.component: process-automation
author: georgewallace
ms.author: gwallace
ms.date: 08/1/2018
ms.topic: conceptual
manager: carmonm
ms.openlocfilehash: f272ac7ee6432b43d0c9a72daf620a46e52366f8
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44791328"
---
# <a name="startstop-vms-during-off-hours-solution-in-azure-automation"></a><span data-ttu-id="1a2ce-103">Start/Stop VMs during off-hours solution in Azure Automation</span><span class="sxs-lookup"><span data-stu-id="1a2ce-103">Start/Stop VMs during off-hours solution in Azure Automation</span></span>

<span data-ttu-id="1a2ce-104">The Start/Stop VMs during off-hours solution starts and stops your Azure virtual machines on user-defined schedules, provides insights through Azure Log Analytics, and sends optional emails by using [action groups](../monitoring-and-diagnostics/monitoring-action-groups.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-104">The Start/Stop VMs during off-hours solution starts and stops your Azure virtual machines on user-defined schedules, provides insights through Azure Log Analytics, and sends optional emails by using [action groups](../monitoring-and-diagnostics/monitoring-action-groups.md).</span></span> <span data-ttu-id="1a2ce-105">It supports both Azure Resource Manager and classic VMs for most scenarios.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-105">It supports both Azure Resource Manager and classic VMs for most scenarios.</span></span>

<span data-ttu-id="1a2ce-106">This solution provides a decentralized low-cost automation option for users who want to optimize their VM costs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-106">This solution provides a decentralized low-cost automation option for users who want to optimize their VM costs.</span></span> <span data-ttu-id="1a2ce-107">With this solution, you can:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-107">With this solution, you can:</span></span>

- <span data-ttu-id="1a2ce-108">Schedule VMs to start and stop.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-108">Schedule VMs to start and stop.</span></span>
- <span data-ttu-id="1a2ce-109">Schedule VMs to start and stop in ascending order by using Azure Tags (not supported for classic VMs).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-109">Schedule VMs to start and stop in ascending order by using Azure Tags (not supported for classic VMs).</span></span>
- <span data-ttu-id="1a2ce-110">Auto-stop VMs based on low CPU usage.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-110">Auto-stop VMs based on low CPU usage.</span></span>

<span data-ttu-id="1a2ce-111">The following are limitations to the current solution:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-111">The following are limitations to the current solution:</span></span>

- <span data-ttu-id="1a2ce-112">This solution manages VMs in any region, but can only be used in the same subscription as your Azure Automation account.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-112">This solution manages VMs in any region, but can only be used in the same subscription as your Azure Automation account.</span></span>
- <span data-ttu-id="1a2ce-113">This solution is available in Azure and AzureGov to any region that supports a Log Analytics workspace, an Azure Automation account, and Alerts.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-113">This solution is available in Azure and AzureGov to any region that supports a Log Analytics workspace, an Azure Automation account, and Alerts.</span></span> <span data-ttu-id="1a2ce-114">AzureGov regions currently do not support email functionality.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-114">AzureGov regions currently do not support email functionality.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="1a2ce-115">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="1a2ce-115">Prerequisites</span></span>

<span data-ttu-id="1a2ce-116">The runbooks for this solution work with an [Azure Run As account](automation-create-runas-account.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-116">The runbooks for this solution work with an [Azure Run As account](automation-create-runas-account.md).</span></span> <span data-ttu-id="1a2ce-117">The Run As account is the preferred authentication method, because it uses certificate authentication instead of a password that might expire or change frequently.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-117">The Run As account is the preferred authentication method, because it uses certificate authentication instead of a password that might expire or change frequently.</span></span>

## <a name="deploy-the-solution"></a><span data-ttu-id="1a2ce-118">Deploy the solution</span><span class="sxs-lookup"><span data-stu-id="1a2ce-118">Deploy the solution</span></span>

<span data-ttu-id="1a2ce-119">Perform the following steps to add the Start/Stop VMs during off-hours solution to your Automation account, and then configure the variables to customize the solution.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-119">Perform the following steps to add the Start/Stop VMs during off-hours solution to your Automation account, and then configure the variables to customize the solution.</span></span>

1. <span data-ttu-id="1a2ce-120">From an Automation Account select **Start/Stop VM** under **Related Resources**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-120">From an Automation Account select **Start/Stop VM** under **Related Resources**.</span></span> <span data-ttu-id="1a2ce-121">From here, you can click **Learn more about and enable the solution**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-121">From here, you can click **Learn more about and enable the solution**.</span></span> <span data-ttu-id="1a2ce-122">If you already have a Start/Stop VM solution deployed, you can click **Manage the solution** to be taken to a list of the deployed solutions and select it from there.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-122">If you already have a Start/Stop VM solution deployed, you can click **Manage the solution** to be taken to a list of the deployed solutions and select it from there.</span></span>

   ![Enable from automation account](./media/automation-solution-vm-management/enable-from-automation-account.png)

   > [!NOTE]
   > <span data-ttu-id="1a2ce-124">You can also create it from anywhere in the Azure portal, by clicking **Create a resource**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-124">You can also create it from anywhere in the Azure portal, by clicking **Create a resource**.</span></span> <span data-ttu-id="1a2ce-125">In the Marketplace page, type a keyword such as **Start** or **Start/Stop**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-125">In the Marketplace page, type a keyword such as **Start** or **Start/Stop**.</span></span> <span data-ttu-id="1a2ce-126">As you begin typing, the list filters based on your input.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-126">As you begin typing, the list filters based on your input.</span></span> <span data-ttu-id="1a2ce-127">Alternatively, you can type in one or more keywords from the full name of the solution and then press Enter.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-127">Alternatively, you can type in one or more keywords from the full name of the solution and then press Enter.</span></span> <span data-ttu-id="1a2ce-128">Select **Start/Stop VMs during off-hours** from the search results.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-128">Select **Start/Stop VMs during off-hours** from the search results.</span></span>
1. <span data-ttu-id="1a2ce-129">In the **Start/Stop VMs during off-hours** page for the selected solution, review the summary information and then click **Create**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-129">In the **Start/Stop VMs during off-hours** page for the selected solution, review the summary information and then click **Create**.</span></span>

   ![Azure portal](media/automation-solution-vm-management/azure-portal-01.png)

1. <span data-ttu-id="1a2ce-131">The **Add Solution** page appears.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-131">The **Add Solution** page appears.</span></span> <span data-ttu-id="1a2ce-132">You are prompted to configure the solution before you can import it into your Automation subscription.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-132">You are prompted to configure the solution before you can import it into your Automation subscription.</span></span>

   ![VM Management Add Solution page](media/automation-solution-vm-management/azure-portal-add-solution-01.png)

1. <span data-ttu-id="1a2ce-134">On the **Add Solution** page, select **Workspace**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-134">On the **Add Solution** page, select **Workspace**.</span></span> <span data-ttu-id="1a2ce-135">Select a Log Analytics workspace that's linked to the same Azure subscription that the Automation account is in.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-135">Select a Log Analytics workspace that's linked to the same Azure subscription that the Automation account is in.</span></span> <span data-ttu-id="1a2ce-136">If you don't have a workspace, select **Create New Workspace**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-136">If you don't have a workspace, select **Create New Workspace**.</span></span> <span data-ttu-id="1a2ce-137">On the **OMS Workspace** page, perform the following steps:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-137">On the **OMS Workspace** page, perform the following steps:</span></span>
   - <span data-ttu-id="1a2ce-138">Specify a name for the new **OMS Workspace**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-138">Specify a name for the new **OMS Workspace**.</span></span>
   - <span data-ttu-id="1a2ce-139">Select a **Subscription** to link to by selecting from the drop-down list, if the default selected is not appropriate.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-139">Select a **Subscription** to link to by selecting from the drop-down list, if the default selected is not appropriate.</span></span>
   - <span data-ttu-id="1a2ce-140">For **Resource Group**, you can create a new resource group or select an existing one.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-140">For **Resource Group**, you can create a new resource group or select an existing one.</span></span>
   - <span data-ttu-id="1a2ce-141">Select a **Location**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-141">Select a **Location**.</span></span> <span data-ttu-id="1a2ce-142">Currently, the only locations available are **Australia Southeast**, **Canada Central**, **Central India**, **East US**, **Japan East**, **Southeast Asia**, **UK South**, and **West Europe**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-142">Currently, the only locations available are **Australia Southeast**, **Canada Central**, **Central India**, **East US**, **Japan East**, **Southeast Asia**, **UK South**, and **West Europe**.</span></span>
   - <span data-ttu-id="1a2ce-143">Select a **Pricing tier**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-143">Select a **Pricing tier**.</span></span> <span data-ttu-id="1a2ce-144">Choose the **Per GB (Standalone)** option.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-144">Choose the **Per GB (Standalone)** option.</span></span> <span data-ttu-id="1a2ce-145">Log Analytics has updated [pricing](https://azure.microsoft.com/pricing/details/log-analytics/) and the Per GB tier is the only option.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-145">Log Analytics has updated [pricing](https://azure.microsoft.com/pricing/details/log-analytics/) and the Per GB tier is the only option.</span></span>

1. <span data-ttu-id="1a2ce-146">After providing the required information on the **OMS workspace** page, click **Create**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-146">After providing the required information on the **OMS workspace** page, click **Create**.</span></span> <span data-ttu-id="1a2ce-147">You can track its progress under **Notifications** from the menu, which returns you to the **Add Solution** page when done.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-147">You can track its progress under **Notifications** from the menu, which returns you to the **Add Solution** page when done.</span></span>
1. <span data-ttu-id="1a2ce-148">On the **Add Solution** page, select **Automation account**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-148">On the **Add Solution** page, select **Automation account**.</span></span> <span data-ttu-id="1a2ce-149">If you're creating a new Log Analytics workspace, you can create a new Automation account to be associated with it, or select an existing Automation Account that is not already linked to a Log Analystics workspace.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-149">If you're creating a new Log Analytics workspace, you can create a new Automation account to be associated with it, or select an existing Automation Account that is not already linked to a Log Analystics workspace.</span></span> <span data-ttu-id="1a2ce-150">Select an existing Automation Account or click **Create an Automation account**, and on the **Add Automation account** page, provide the following information:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-150">Select an existing Automation Account or click **Create an Automation account**, and on the **Add Automation account** page, provide the following information:</span></span>
   - <span data-ttu-id="1a2ce-151">In the **Name** field, enter the name of the Automation account.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-151">In the **Name** field, enter the name of the Automation account.</span></span>

    <span data-ttu-id="1a2ce-152">All other options are automatically populated based on the Log Analytics workspace selected.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-152">All other options are automatically populated based on the Log Analytics workspace selected.</span></span> <span data-ttu-id="1a2ce-153">These options cannot be modified.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-153">These options cannot be modified.</span></span> <span data-ttu-id="1a2ce-154">An Azure Run As account is the default authentication method for the runbooks included in this solution.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-154">An Azure Run As account is the default authentication method for the runbooks included in this solution.</span></span> <span data-ttu-id="1a2ce-155">After you click **OK**, the configuration options are validated and the Automation account is created.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-155">After you click **OK**, the configuration options are validated and the Automation account is created.</span></span> <span data-ttu-id="1a2ce-156">You can track its progress under **Notifications** from the menu.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-156">You can track its progress under **Notifications** from the menu.</span></span>

1. <span data-ttu-id="1a2ce-157">Finally, on the **Add Solution** page, select **Configuration**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-157">Finally, on the **Add Solution** page, select **Configuration**.</span></span> <span data-ttu-id="1a2ce-158">The **Parameters** page appears.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-158">The **Parameters** page appears.</span></span>

   ![Parameters page for solution](media/automation-solution-vm-management/azure-portal-add-solution-02.png)

   <span data-ttu-id="1a2ce-160">Here, you're prompted to:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-160">Here, you're prompted to:</span></span>
   - <span data-ttu-id="1a2ce-161">Specify the **Target ResourceGroup Names**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-161">Specify the **Target ResourceGroup Names**.</span></span> <span data-ttu-id="1a2ce-162">These are resource group names that contain VMs to be managed by this solution.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-162">These are resource group names that contain VMs to be managed by this solution.</span></span> <span data-ttu-id="1a2ce-163">You can enter more than one name and separate each by using a comma (values are not case-sensitive).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-163">You can enter more than one name and separate each by using a comma (values are not case-sensitive).</span></span> <span data-ttu-id="1a2ce-164">Using a wildcard is supported if you want to target VMs in all resource groups in the subscription.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-164">Using a wildcard is supported if you want to target VMs in all resource groups in the subscription.</span></span> <span data-ttu-id="1a2ce-165">This value is stored in the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupNames** variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-165">This value is stored in the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupNames** variables.</span></span>
   - <span data-ttu-id="1a2ce-166">Specify the **VM Exclude List (string)**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-166">Specify the **VM Exclude List (string)**.</span></span> <span data-ttu-id="1a2ce-167">This is the name of one or more virtual machines from the target resource group.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-167">This is the name of one or more virtual machines from the target resource group.</span></span> <span data-ttu-id="1a2ce-168">You can enter more than one name and separate each by using a comma (values are not case-sensitive).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-168">You can enter more than one name and separate each by using a comma (values are not case-sensitive).</span></span> <span data-ttu-id="1a2ce-169">Using a wildcard is supported.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-169">Using a wildcard is supported.</span></span> <span data-ttu-id="1a2ce-170">This value is stored in the **External_ExcludeVMNames** variable.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-170">This value is stored in the **External_ExcludeVMNames** variable.</span></span>
   - <span data-ttu-id="1a2ce-171">Select a **Schedule**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-171">Select a **Schedule**.</span></span> <span data-ttu-id="1a2ce-172">This is a recurring date and time for starting and stopping the VMs in the target resource groups.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-172">This is a recurring date and time for starting and stopping the VMs in the target resource groups.</span></span> <span data-ttu-id="1a2ce-173">By default, the schedule is configured for 30 minutes from now.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-173">By default, the schedule is configured for 30 minutes from now.</span></span> <span data-ttu-id="1a2ce-174">Selecting a different region is not available.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-174">Selecting a different region is not available.</span></span> <span data-ttu-id="1a2ce-175">To configure the schedule to your specific time zone after configuring the solution, see [Modifying the startup and shutdown schedule](#modify-the-startup-and-shutdown-schedule).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-175">To configure the schedule to your specific time zone after configuring the solution, see [Modifying the startup and shutdown schedule](#modify-the-startup-and-shutdown-schedule).</span></span>
   - <span data-ttu-id="1a2ce-176">To receive **Email notifications** from an action group, accept the default value of **Yes** and provide a valid email address.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-176">To receive **Email notifications** from an action group, accept the default value of **Yes** and provide a valid email address.</span></span> <span data-ttu-id="1a2ce-177">If you select **No** but decide at a later date that you want to receive email notifications, you can update the [action group](../monitoring-and-diagnostics/monitoring-action-groups.md) that is created with valid email addresses separated by a comma.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-177">If you select **No** but decide at a later date that you want to receive email notifications, you can update the [action group](../monitoring-and-diagnostics/monitoring-action-groups.md) that is created with valid email addresses separated by a comma.</span></span> <span data-ttu-id="1a2ce-178">You also need to enable the following alert rules:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-178">You also need to enable the following alert rules:</span></span>

     - <span data-ttu-id="1a2ce-179">AutoStop_VM_Child</span><span class="sxs-lookup"><span data-stu-id="1a2ce-179">AutoStop_VM_Child</span></span>
     - <span data-ttu-id="1a2ce-180">Scheduled_StartStop_Parent</span><span class="sxs-lookup"><span data-stu-id="1a2ce-180">Scheduled_StartStop_Parent</span></span>
     - <span data-ttu-id="1a2ce-181">Sequenced_StartStop_Parent</span><span class="sxs-lookup"><span data-stu-id="1a2ce-181">Sequenced_StartStop_Parent</span></span>

     > [!IMPORTANT]
     > <span data-ttu-id="1a2ce-182">The default value for **Target ResourceGroup Names** is a **&ast;**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-182">The default value for **Target ResourceGroup Names** is a **&ast;**.</span></span> <span data-ttu-id="1a2ce-183">This targets all VMs in a subscription.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-183">This targets all VMs in a subscription.</span></span> <span data-ttu-id="1a2ce-184">If you do not want the solution to target all the VMs in your subscription this value needs to be updated to a list of resource group names prior to enabling the schedules.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-184">If you do not want the solution to target all the VMs in your subscription this value needs to be updated to a list of resource group names prior to enabling the schedules.</span></span>

1. <span data-ttu-id="1a2ce-185">After you have configured the initial settings required for the solution, click **OK** to close the **Parameters** page and select **Create**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-185">After you have configured the initial settings required for the solution, click **OK** to close the **Parameters** page and select **Create**.</span></span> <span data-ttu-id="1a2ce-186">After all settings are validated, the solution is deployed to your subscription.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-186">After all settings are validated, the solution is deployed to your subscription.</span></span> <span data-ttu-id="1a2ce-187">This process can take several seconds to finish, and you can track its progress under **Notifications** from the menu.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-187">This process can take several seconds to finish, and you can track its progress under **Notifications** from the menu.</span></span>

## <a name="scenarios"></a><span data-ttu-id="1a2ce-188">Scenarios</span><span class="sxs-lookup"><span data-stu-id="1a2ce-188">Scenarios</span></span>

<span data-ttu-id="1a2ce-189">The solution contains three distinct scenarios.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-189">The solution contains three distinct scenarios.</span></span> <span data-ttu-id="1a2ce-190">These scenarios are:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-190">These scenarios are:</span></span>

### <a name="scenario-1-startstop-vms-on-a-schedule"></a><span data-ttu-id="1a2ce-191">Scenario 1: Start/Stop VMs on a schedule</span><span class="sxs-lookup"><span data-stu-id="1a2ce-191">Scenario 1: Start/Stop VMs on a schedule</span></span>

<span data-ttu-id="1a2ce-192">This is the default configuration when you first deploy the solution.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-192">This is the default configuration when you first deploy the solution.</span></span> <span data-ttu-id="1a2ce-193">For example, you can configure it to stop all VMs across a subscription when you leave work in the evening, and start them in the morning when you are back in the office.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-193">For example, you can configure it to stop all VMs across a subscription when you leave work in the evening, and start them in the morning when you are back in the office.</span></span> <span data-ttu-id="1a2ce-194">When you configure the schedules **Scheduled-StartVM** and **Scheduled-StopVM** during deployment, they start and stop targeted VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-194">When you configure the schedules **Scheduled-StartVM** and **Scheduled-StopVM** during deployment, they start and stop targeted VMs.</span></span> <span data-ttu-id="1a2ce-195">Configuring this solution to just stop VMs is supported, see [Modify the startup and shutdown schedules](#modify-the-startup-and-shutdown-schedules) to learn how to configure a custom schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-195">Configuring this solution to just stop VMs is supported, see [Modify the startup and shutdown schedules](#modify-the-startup-and-shutdown-schedules) to learn how to configure a custom schedule.</span></span>

> [!NOTE]
> <span data-ttu-id="1a2ce-196">The time zone is your current time zone when you configure the schedule time parameter.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-196">The time zone is your current time zone when you configure the schedule time parameter.</span></span> <span data-ttu-id="1a2ce-197">However, it is stored in UTC format in Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-197">However, it is stored in UTC format in Azure Automation.</span></span> <span data-ttu-id="1a2ce-198">You do not have to do any time zone conversion as this is handled during the deployment.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-198">You do not have to do any time zone conversion as this is handled during the deployment.</span></span>

<span data-ttu-id="1a2ce-199">You control which VMs are in scope by configuring the following variables: **External_Start_ResourceGroupNames**, **External_Stop_ResourceGroupNames**, and **External_ExcludeVMNames**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-199">You control which VMs are in scope by configuring the following variables: **External_Start_ResourceGroupNames**, **External_Stop_ResourceGroupNames**, and **External_ExcludeVMNames**.</span></span>

<span data-ttu-id="1a2ce-200">You can enable either targeting the action against a subscription and resource group, or targeting a specific list of VMs, but not both.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-200">You can enable either targeting the action against a subscription and resource group, or targeting a specific list of VMs, but not both.</span></span>

#### <a name="target-the-start-and-stop-actions-against-a-subscription-and-resource-group"></a><span data-ttu-id="1a2ce-201">Target the start and stop actions against a subscription and resource group</span><span class="sxs-lookup"><span data-stu-id="1a2ce-201">Target the start and stop actions against a subscription and resource group</span></span>

1. <span data-ttu-id="1a2ce-202">Configure the **External_Stop_ResourceGroupNames** and **External_ExcludeVMNames** variables to specify the target VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-202">Configure the **External_Stop_ResourceGroupNames** and **External_ExcludeVMNames** variables to specify the target VMs.</span></span>
1. <span data-ttu-id="1a2ce-203">Enable and update the **Scheduled-StartVM** and **Scheduled-StopVM** schedules.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-203">Enable and update the **Scheduled-StartVM** and **Scheduled-StopVM** schedules.</span></span>
1. <span data-ttu-id="1a2ce-204">Run the **ScheduledStartStop_Parent** runbook with the ACTION parameter set to **start** and the WHATIF parameter set to **True** to preview your changes.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-204">Run the **ScheduledStartStop_Parent** runbook with the ACTION parameter set to **start** and the WHATIF parameter set to **True** to preview your changes.</span></span>

#### <a name="target-the-start-and-stop-action-by-vm-list"></a><span data-ttu-id="1a2ce-205">Target the start and stop action by VM list</span><span class="sxs-lookup"><span data-stu-id="1a2ce-205">Target the start and stop action by VM list</span></span>

1. <span data-ttu-id="1a2ce-206">Run the **ScheduledStartStop_Parent** runbook with the ACTION parameter set to **start**, add a comma-separated list of VMs in the *VMList* parameter, and then set the WHATIF parameter to **True**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-206">Run the **ScheduledStartStop_Parent** runbook with the ACTION parameter set to **start**, add a comma-separated list of VMs in the *VMList* parameter, and then set the WHATIF parameter to **True**.</span></span> <span data-ttu-id="1a2ce-207">Preview your changes.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-207">Preview your changes.</span></span>
1. <span data-ttu-id="1a2ce-208">Configure the **External_ExcludeVMNames** parameter with a comma-separated list of VMs (VM1,VM2,VM3).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-208">Configure the **External_ExcludeVMNames** parameter with a comma-separated list of VMs (VM1,VM2,VM3).</span></span>
1. <span data-ttu-id="1a2ce-209">This scenario does not honor the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupnames** variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-209">This scenario does not honor the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupnames** variables.</span></span> <span data-ttu-id="1a2ce-210">For this scenario, you need to create your own Automation schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-210">For this scenario, you need to create your own Automation schedule.</span></span> <span data-ttu-id="1a2ce-211">For details, see [Scheduling a runbook in Azure Automation](../automation/automation-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-211">For details, see [Scheduling a runbook in Azure Automation](../automation/automation-schedules.md).</span></span>

> [!NOTE]
> <span data-ttu-id="1a2ce-212">The value for **Target ResourceGroup Names** is stored as the value for both **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupNames**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-212">The value for **Target ResourceGroup Names** is stored as the value for both **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupNames**.</span></span> <span data-ttu-id="1a2ce-213">For further granularity, you can modify each of these variables to target different resource groups.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-213">For further granularity, you can modify each of these variables to target different resource groups.</span></span> <span data-ttu-id="1a2ce-214">For start action, use **External_Start_ResourceGroupNames**, and for stop action, use **External_Stop_ResourceGroupNames**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-214">For start action, use **External_Start_ResourceGroupNames**, and for stop action, use **External_Stop_ResourceGroupNames**.</span></span> <span data-ttu-id="1a2ce-215">VMs are automatically added to the start and stop schedules.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-215">VMs are automatically added to the start and stop schedules.</span></span>

### <a name="scenario-2-startstop-vms-in-sequence-by-using-tags"></a><span data-ttu-id="1a2ce-216">Scenario 2: Start/Stop VMS in sequence by using tags</span><span class="sxs-lookup"><span data-stu-id="1a2ce-216">Scenario 2: Start/Stop VMS in sequence by using tags</span></span>

<span data-ttu-id="1a2ce-217">In an environment that includes two or more components on multiple VMs supporting a distributed workload, supporting the sequence in which components are started and stopped in order is important.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-217">In an environment that includes two or more components on multiple VMs supporting a distributed workload, supporting the sequence in which components are started and stopped in order is important.</span></span> <span data-ttu-id="1a2ce-218">You can accomplish this by performing the following steps:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-218">You can accomplish this by performing the following steps:</span></span>

#### <a name="target-the-start-and-stop-actions-against-a-subscription-and-resource-group"></a><span data-ttu-id="1a2ce-219">Target the start and stop actions against a subscription and resource group</span><span class="sxs-lookup"><span data-stu-id="1a2ce-219">Target the start and stop actions against a subscription and resource group</span></span>

1. <span data-ttu-id="1a2ce-220">Add a **SequenceStart** and a **SequenceStop** tag with a positive integer value to VMs that are targeted in **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupNames** variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-220">Add a **SequenceStart** and a **SequenceStop** tag with a positive integer value to VMs that are targeted in **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupNames** variables.</span></span> <span data-ttu-id="1a2ce-221">The start and stop actions are performed in ascending order.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-221">The start and stop actions are performed in ascending order.</span></span> <span data-ttu-id="1a2ce-222">To learn how to tag a VM, see [Tag a Windows Virtual Machine in Azure](../virtual-machines/windows/tag.md) and [Tag a Linux Virtual Machine in Azure](../virtual-machines/linux/tag.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-222">To learn how to tag a VM, see [Tag a Windows Virtual Machine in Azure](../virtual-machines/windows/tag.md) and [Tag a Linux Virtual Machine in Azure](../virtual-machines/linux/tag.md).</span></span>
1. <span data-ttu-id="1a2ce-223">Modify the schedules **Sequenced-StartVM** and **Sequenced-StopVM** to the date and time that meet your requirements and enable the schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-223">Modify the schedules **Sequenced-StartVM** and **Sequenced-StopVM** to the date and time that meet your requirements and enable the schedule.</span></span>
1. <span data-ttu-id="1a2ce-224">Run the **SequencedStartStop_Parent** runbook with the ACTION parameter set to **start** and the WHATIF parameter set to **True** to preview your changes.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-224">Run the **SequencedStartStop_Parent** runbook with the ACTION parameter set to **start** and the WHATIF parameter set to **True** to preview your changes.</span></span>
1. <span data-ttu-id="1a2ce-225">Preview the action and make any necessary changes before implementing against production VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-225">Preview the action and make any necessary changes before implementing against production VMs.</span></span> <span data-ttu-id="1a2ce-226">When ready, manually execute the runbook with the parameter set to **False**, or let the Automation schedule **Sequenced-StartVM** and **Sequenced-StopVM** run automatically following your prescribed schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-226">When ready, manually execute the runbook with the parameter set to **False**, or let the Automation schedule **Sequenced-StartVM** and **Sequenced-StopVM** run automatically following your prescribed schedule.</span></span>

#### <a name="target-the-start-and-stop-action-by-vm-list"></a><span data-ttu-id="1a2ce-227">Target the start and stop action by VM list</span><span class="sxs-lookup"><span data-stu-id="1a2ce-227">Target the start and stop action by VM list</span></span>

1. <span data-ttu-id="1a2ce-228">Add a **SequenceStart** and a **SequenceStop** tag with a positive integer value to VMs you plan to add to the **VMList** variable.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-228">Add a **SequenceStart** and a **SequenceStop** tag with a positive integer value to VMs you plan to add to the **VMList** variable.</span></span> 
1. <span data-ttu-id="1a2ce-229">Run the **SequencedStartStop_Parent** runbook with the ACTION parameter set to **start**, add a comma-separated list of VMs in the *VMList* parameter, and then set the WHATIF parameter to **True**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-229">Run the **SequencedStartStop_Parent** runbook with the ACTION parameter set to **start**, add a comma-separated list of VMs in the *VMList* parameter, and then set the WHATIF parameter to **True**.</span></span> <span data-ttu-id="1a2ce-230">Preview your changes.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-230">Preview your changes.</span></span>
1. <span data-ttu-id="1a2ce-231">Configure the **External_ExcludeVMNames** parameter with a comma-separated list of VMs (VM1,VM2,VM3).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-231">Configure the **External_ExcludeVMNames** parameter with a comma-separated list of VMs (VM1,VM2,VM3).</span></span>
1. <span data-ttu-id="1a2ce-232">This scenario does not honor the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupnames** variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-232">This scenario does not honor the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupnames** variables.</span></span> <span data-ttu-id="1a2ce-233">For this scenario, you need to create your own Automation schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-233">For this scenario, you need to create your own Automation schedule.</span></span> <span data-ttu-id="1a2ce-234">For details, see [Scheduling a runbook in Azure Automation](../automation/automation-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-234">For details, see [Scheduling a runbook in Azure Automation](../automation/automation-schedules.md).</span></span>
1. <span data-ttu-id="1a2ce-235">Preview the action and make any necessary changes before implementing against production VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-235">Preview the action and make any necessary changes before implementing against production VMs.</span></span> <span data-ttu-id="1a2ce-236">When ready, manually execute the monitoring-and-diagnostics/monitoring-action-groupsrunbook with the parameter set to **False**, or let the Automation schedule **Sequenced-StartVM** and **Sequenced-StopVM** run automatically following your prescribed schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-236">When ready, manually execute the monitoring-and-diagnostics/monitoring-action-groupsrunbook with the parameter set to **False**, or let the Automation schedule **Sequenced-StartVM** and **Sequenced-StopVM** run automatically following your prescribed schedule.</span></span>

### <a name="scenario-3-startstop-automatically-based-on-cpu-utilization"></a><span data-ttu-id="1a2ce-237">Scenario 3: Start/Stop automatically based on CPU utilization</span><span class="sxs-lookup"><span data-stu-id="1a2ce-237">Scenario 3: Start/Stop automatically based on CPU utilization</span></span>

<span data-ttu-id="1a2ce-238">This solution can help manage the cost of running virtual machines in your subscription by evaluating Azure VMs that aren't used during non-peak periods, such as after hours, and automatically shutting them down if processor utilization is less than x%.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-238">This solution can help manage the cost of running virtual machines in your subscription by evaluating Azure VMs that aren't used during non-peak periods, such as after hours, and automatically shutting them down if processor utilization is less than x%.</span></span>

<span data-ttu-id="1a2ce-239">By default, the solution is pre-configured to evaluate the percentage CPU metric to see if average utilization is 5 percent or less.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-239">By default, the solution is pre-configured to evaluate the percentage CPU metric to see if average utilization is 5 percent or less.</span></span> <span data-ttu-id="1a2ce-240">This is controlled by the following variables and can be modified if the default values do not meet your requirements:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-240">This is controlled by the following variables and can be modified if the default values do not meet your requirements:</span></span>

- <span data-ttu-id="1a2ce-241">External_AutoStop_MetricName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-241">External_AutoStop_MetricName</span></span>
- <span data-ttu-id="1a2ce-242">External_AutoStop_Threshold</span><span class="sxs-lookup"><span data-stu-id="1a2ce-242">External_AutoStop_Threshold</span></span>
- <span data-ttu-id="1a2ce-243">External_AutoStop_TimeAggregationOperator</span><span class="sxs-lookup"><span data-stu-id="1a2ce-243">External_AutoStop_TimeAggregationOperator</span></span>
- <span data-ttu-id="1a2ce-244">External_AutoStop_TimeWindow</span><span class="sxs-lookup"><span data-stu-id="1a2ce-244">External_AutoStop_TimeWindow</span></span>

<span data-ttu-id="1a2ce-245">You can enable either targeting the action against a subscription and resource group, or targeting a specific list of VMs, but not both.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-245">You can enable either targeting the action against a subscription and resource group, or targeting a specific list of VMs, but not both.</span></span>

#### <a name="target-the-stop-action-against-a-subscription-and-resource-group"></a><span data-ttu-id="1a2ce-246">Target the stop action against a subscription and resource group</span><span class="sxs-lookup"><span data-stu-id="1a2ce-246">Target the stop action against a subscription and resource group</span></span>

1. <span data-ttu-id="1a2ce-247">Configure the **External_Stop_ResourceGroupNames** and **External_ExcludeVMNames** variables to specify the target VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-247">Configure the **External_Stop_ResourceGroupNames** and **External_ExcludeVMNames** variables to specify the target VMs.</span></span>
1. <span data-ttu-id="1a2ce-248">Enable and update the **Schedule_AutoStop_CreateAlert_Parent** schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-248">Enable and update the **Schedule_AutoStop_CreateAlert_Parent** schedule.</span></span>
1. <span data-ttu-id="1a2ce-249">Run the **AutoStop_CreateAlert_Parent** runbook with the ACTION parameter set to **start** and the WHATIF parameter set to **True** to preview your changes.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-249">Run the **AutoStop_CreateAlert_Parent** runbook with the ACTION parameter set to **start** and the WHATIF parameter set to **True** to preview your changes.</span></span>

#### <a name="target-the-start-and-stop-action-by-vm-list"></a><span data-ttu-id="1a2ce-250">Target the start and stop action by VM list</span><span class="sxs-lookup"><span data-stu-id="1a2ce-250">Target the start and stop action by VM list</span></span>

1. <span data-ttu-id="1a2ce-251">Run the **AutoStop_CreateAlert_Parent** runbook with the ACTION parameter set to **start**, add a comma-separated list of VMs in the *VMList* parameter, and then set the WHATIF parameter to **True**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-251">Run the **AutoStop_CreateAlert_Parent** runbook with the ACTION parameter set to **start**, add a comma-separated list of VMs in the *VMList* parameter, and then set the WHATIF parameter to **True**.</span></span> <span data-ttu-id="1a2ce-252">Preview your changes.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-252">Preview your changes.</span></span>
1. <span data-ttu-id="1a2ce-253">Configure the **External_ExcludeVMNames** parameter with a comma-separated list of VMs (VM1,VM2,VM3).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-253">Configure the **External_ExcludeVMNames** parameter with a comma-separated list of VMs (VM1,VM2,VM3).</span></span>
1. <span data-ttu-id="1a2ce-254">This scenario does not honor the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupnames** variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-254">This scenario does not honor the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupnames** variables.</span></span> <span data-ttu-id="1a2ce-255">For this scenario, you need to create your own Automation schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-255">For this scenario, you need to create your own Automation schedule.</span></span> <span data-ttu-id="1a2ce-256">For details, see [Scheduling a runbook in Azure Automation](../automation/automation-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-256">For details, see [Scheduling a runbook in Azure Automation](../automation/automation-schedules.md).</span></span>

<span data-ttu-id="1a2ce-257">Now that you have a schedule for stopping VMs based on CPU utilization, you need to enable one of the following schedules to start them.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-257">Now that you have a schedule for stopping VMs based on CPU utilization, you need to enable one of the following schedules to start them.</span></span>

- <span data-ttu-id="1a2ce-258">Target start action by subscription and resource group.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-258">Target start action by subscription and resource group.</span></span> <span data-ttu-id="1a2ce-259">See the steps in [Scenario 1](#scenario-1-startstop-vms-on-a-schedule) for testing and enabling **Scheduled-StartVM** schedules.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-259">See the steps in [Scenario 1](#scenario-1-startstop-vms-on-a-schedule) for testing and enabling **Scheduled-StartVM** schedules.</span></span>
- <span data-ttu-id="1a2ce-260">Target start action by subscription, resource group, and tag.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-260">Target start action by subscription, resource group, and tag.</span></span> <span data-ttu-id="1a2ce-261">See the steps in [Scenario 2](#scenario-2-startstop-vms-in-sequence-by-using-tags) for testing and enabling **Sequenced-StartVM** schedules.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-261">See the steps in [Scenario 2](#scenario-2-startstop-vms-in-sequence-by-using-tags) for testing and enabling **Sequenced-StartVM** schedules.</span></span>

## <a name="solution-components"></a><span data-ttu-id="1a2ce-262">Solution components</span><span class="sxs-lookup"><span data-stu-id="1a2ce-262">Solution components</span></span>

<span data-ttu-id="1a2ce-263">This solution includes preconfigured runbooks, schedules, and integration with Log Analytics so you can tailor the startup and shutdown of your virtual machines to suit your business needs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-263">This solution includes preconfigured runbooks, schedules, and integration with Log Analytics so you can tailor the startup and shutdown of your virtual machines to suit your business needs.</span></span>

### <a name="runbooks"></a><span data-ttu-id="1a2ce-264">Runbooks</span><span class="sxs-lookup"><span data-stu-id="1a2ce-264">Runbooks</span></span>

<span data-ttu-id="1a2ce-265">The following table lists the runbooks deployed to your Automation account by this solution.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-265">The following table lists the runbooks deployed to your Automation account by this solution.</span></span> <span data-ttu-id="1a2ce-266">You should not make changes to the runbook code.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-266">You should not make changes to the runbook code.</span></span> <span data-ttu-id="1a2ce-267">Instead, write your own runbook for new functionality.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-267">Instead, write your own runbook for new functionality.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="1a2ce-268">Do not directly run any runbook with "child" appended to its name.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-268">Do not directly run any runbook with "child" appended to its name.</span></span>

<span data-ttu-id="1a2ce-269">All parent runbooks include the _WhatIf_ parameter.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-269">All parent runbooks include the _WhatIf_ parameter.</span></span> <span data-ttu-id="1a2ce-270">When set to **True**, _WhatIf_ supports detailing the exact behavior the runbook takes when run without the _WhatIf_ parameter and validates the correct VMs are being targeted.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-270">When set to **True**, _WhatIf_ supports detailing the exact behavior the runbook takes when run without the _WhatIf_ parameter and validates the correct VMs are being targeted.</span></span> <span data-ttu-id="1a2ce-271">A runbook only performs its defined actions when the _WhatIf_ parameter is set to **False**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-271">A runbook only performs its defined actions when the _WhatIf_ parameter is set to **False**.</span></span>

|<span data-ttu-id="1a2ce-272">Runbook</span><span class="sxs-lookup"><span data-stu-id="1a2ce-272">Runbook</span></span> | <span data-ttu-id="1a2ce-273">Parameters</span><span class="sxs-lookup"><span data-stu-id="1a2ce-273">Parameters</span></span> | <span data-ttu-id="1a2ce-274">Description</span><span class="sxs-lookup"><span data-stu-id="1a2ce-274">Description</span></span>|
| --- | --- | ---|
|<span data-ttu-id="1a2ce-275">AutoStop_CreateAlert_Child</span><span class="sxs-lookup"><span data-stu-id="1a2ce-275">AutoStop_CreateAlert_Child</span></span> | <span data-ttu-id="1a2ce-276">VMObject</span><span class="sxs-lookup"><span data-stu-id="1a2ce-276">VMObject</span></span> <br> <span data-ttu-id="1a2ce-277">AlertAction</span><span class="sxs-lookup"><span data-stu-id="1a2ce-277">AlertAction</span></span> <br> <span data-ttu-id="1a2ce-278">WebHookURI</span><span class="sxs-lookup"><span data-stu-id="1a2ce-278">WebHookURI</span></span> | <span data-ttu-id="1a2ce-279">Called from the parent runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-279">Called from the parent runbook.</span></span> <span data-ttu-id="1a2ce-280">This runbook creates alerts on a per-resource basis for the AutoStop scenario.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-280">This runbook creates alerts on a per-resource basis for the AutoStop scenario.</span></span>|
|<span data-ttu-id="1a2ce-281">AutoStop_CreateAlert_Parent</span><span class="sxs-lookup"><span data-stu-id="1a2ce-281">AutoStop_CreateAlert_Parent</span></span> | <span data-ttu-id="1a2ce-282">VMList</span><span class="sxs-lookup"><span data-stu-id="1a2ce-282">VMList</span></span><br> <span data-ttu-id="1a2ce-283">WhatIf: True or False</span><span class="sxs-lookup"><span data-stu-id="1a2ce-283">WhatIf: True or False</span></span>  | <span data-ttu-id="1a2ce-284">Creates or updates Azure alert rules on VMs in the targeted subscription or resource groups.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-284">Creates or updates Azure alert rules on VMs in the targeted subscription or resource groups.</span></span> <br> <span data-ttu-id="1a2ce-285">VMList: Comma-separated list of VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-285">VMList: Comma-separated list of VMs.</span></span> <span data-ttu-id="1a2ce-286">For example, _vm1,vm2,vm3_.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-286">For example, _vm1,vm2,vm3_.</span></span><br> <span data-ttu-id="1a2ce-287">*WhatIf* validates the runbook logic without executing.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-287">*WhatIf* validates the runbook logic without executing.</span></span>|
|<span data-ttu-id="1a2ce-288">AutoStop_Disable</span><span class="sxs-lookup"><span data-stu-id="1a2ce-288">AutoStop_Disable</span></span> | <span data-ttu-id="1a2ce-289">none</span><span class="sxs-lookup"><span data-stu-id="1a2ce-289">none</span></span> | <span data-ttu-id="1a2ce-290">Disables AutoStop alerts and default schedule.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-290">Disables AutoStop alerts and default schedule.</span></span>|
|<span data-ttu-id="1a2ce-291">AutoStop_StopVM_Child</span><span class="sxs-lookup"><span data-stu-id="1a2ce-291">AutoStop_StopVM_Child</span></span> | <span data-ttu-id="1a2ce-292">WebHookData</span><span class="sxs-lookup"><span data-stu-id="1a2ce-292">WebHookData</span></span> | <span data-ttu-id="1a2ce-293">Called from the parent runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-293">Called from the parent runbook.</span></span> <span data-ttu-id="1a2ce-294">Alert rules call this runbook to stop the VM.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-294">Alert rules call this runbook to stop the VM.</span></span>|
|<span data-ttu-id="1a2ce-295">Bootstrap_Main</span><span class="sxs-lookup"><span data-stu-id="1a2ce-295">Bootstrap_Main</span></span> | <span data-ttu-id="1a2ce-296">none</span><span class="sxs-lookup"><span data-stu-id="1a2ce-296">none</span></span> | <span data-ttu-id="1a2ce-297">Used one time to set up bootstrap configurations such as webhookURI, which are typically not accessible from Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-297">Used one time to set up bootstrap configurations such as webhookURI, which are typically not accessible from Azure Resource Manager.</span></span> <span data-ttu-id="1a2ce-298">This runbook is removed automatically upon successful deployment.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-298">This runbook is removed automatically upon successful deployment.</span></span>|
|<span data-ttu-id="1a2ce-299">ScheduledStartStop_Child</span><span class="sxs-lookup"><span data-stu-id="1a2ce-299">ScheduledStartStop_Child</span></span> | <span data-ttu-id="1a2ce-300">VMName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-300">VMName</span></span> <br> <span data-ttu-id="1a2ce-301">Action: Start or Stop</span><span class="sxs-lookup"><span data-stu-id="1a2ce-301">Action: Start or Stop</span></span> <br> <span data-ttu-id="1a2ce-302">ResourceGroupName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-302">ResourceGroupName</span></span> | <span data-ttu-id="1a2ce-303">Called from the parent runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-303">Called from the parent runbook.</span></span> <span data-ttu-id="1a2ce-304">Executes a start or stop action for the scheduled stop.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-304">Executes a start or stop action for the scheduled stop.</span></span>|
|<span data-ttu-id="1a2ce-305">ScheduledStartStop_Parent</span><span class="sxs-lookup"><span data-stu-id="1a2ce-305">ScheduledStartStop_Parent</span></span> | <span data-ttu-id="1a2ce-306">Action: Start or Stop</span><span class="sxs-lookup"><span data-stu-id="1a2ce-306">Action: Start or Stop</span></span> <br><span data-ttu-id="1a2ce-307">VMList</span><span class="sxs-lookup"><span data-stu-id="1a2ce-307">VMList</span></span> <br> <span data-ttu-id="1a2ce-308">WhatIf: True or False</span><span class="sxs-lookup"><span data-stu-id="1a2ce-308">WhatIf: True or False</span></span> | <span data-ttu-id="1a2ce-309">This affects all VMs in the subscription.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-309">This affects all VMs in the subscription.</span></span> <span data-ttu-id="1a2ce-310">Edit the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupNames** to only execute on these targeted resource groups.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-310">Edit the **External_Start_ResourceGroupNames** and **External_Stop_ResourceGroupNames** to only execute on these targeted resource groups.</span></span> <span data-ttu-id="1a2ce-311">You can also exclude specific VMs by updating the **External_ExcludeVMNames** variable.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-311">You can also exclude specific VMs by updating the **External_ExcludeVMNames** variable.</span></span><br> <span data-ttu-id="1a2ce-312">VMList: Comma-separated list of VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-312">VMList: Comma-separated list of VMs.</span></span> <span data-ttu-id="1a2ce-313">For example, _vm1,vm2,vm3_.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-313">For example, _vm1,vm2,vm3_.</span></span><br> <span data-ttu-id="1a2ce-314">_WhatIf_ validates the runbook logic without executing.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-314">_WhatIf_ validates the runbook logic without executing.</span></span>|
|<span data-ttu-id="1a2ce-315">SequencedStartStop_Parent</span><span class="sxs-lookup"><span data-stu-id="1a2ce-315">SequencedStartStop_Parent</span></span> | <span data-ttu-id="1a2ce-316">Action: Start or Stop</span><span class="sxs-lookup"><span data-stu-id="1a2ce-316">Action: Start or Stop</span></span> <br> <span data-ttu-id="1a2ce-317">WhatIf: True or False</span><span class="sxs-lookup"><span data-stu-id="1a2ce-317">WhatIf: True or False</span></span><br><span data-ttu-id="1a2ce-318">VMList</span><span class="sxs-lookup"><span data-stu-id="1a2ce-318">VMList</span></span>| <span data-ttu-id="1a2ce-319">Create tags named **SequenceStart** and **SequenceStop** on each VM for which you want to sequence start/stop activity.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-319">Create tags named **SequenceStart** and **SequenceStop** on each VM for which you want to sequence start/stop activity.</span></span> <span data-ttu-id="1a2ce-320">The value of the tag should be a positive integer (1, 2, 3) that corresponds to the order in which you want to start or stop.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-320">The value of the tag should be a positive integer (1, 2, 3) that corresponds to the order in which you want to start or stop.</span></span> <br> <span data-ttu-id="1a2ce-321">VMList: Comma-separated list of VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-321">VMList: Comma-separated list of VMs.</span></span> <span data-ttu-id="1a2ce-322">For example, _vm1,vm2,vm3_.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-322">For example, _vm1,vm2,vm3_.</span></span> <br> <span data-ttu-id="1a2ce-323">_WhatIf_ validates the runbook logic without executing.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-323">_WhatIf_ validates the runbook logic without executing.</span></span> <br> <span data-ttu-id="1a2ce-324">**Note**: VMs must be within resource groups defined as External_Start_ResourceGroupNames, External_Stop_ResourceGroupNames, and External_ExcludeVMNames in Azure Automation variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-324">**Note**: VMs must be within resource groups defined as External_Start_ResourceGroupNames, External_Stop_ResourceGroupNames, and External_ExcludeVMNames in Azure Automation variables.</span></span> <span data-ttu-id="1a2ce-325">They must have the appropriate tags for actions to take effect.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-325">They must have the appropriate tags for actions to take effect.</span></span>|

### <a name="variables"></a><span data-ttu-id="1a2ce-326">Variables</span><span class="sxs-lookup"><span data-stu-id="1a2ce-326">Variables</span></span>

<span data-ttu-id="1a2ce-327">The following table lists the variables created in your Automation account.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-327">The following table lists the variables created in your Automation account.</span></span> <span data-ttu-id="1a2ce-328">You should only modify variables prefixed with **External**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-328">You should only modify variables prefixed with **External**.</span></span> <span data-ttu-id="1a2ce-329">Modifying variables prefixed with **Internal** causes undesirable effects.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-329">Modifying variables prefixed with **Internal** causes undesirable effects.</span></span>

|<span data-ttu-id="1a2ce-330">Variable</span><span class="sxs-lookup"><span data-stu-id="1a2ce-330">Variable</span></span> | <span data-ttu-id="1a2ce-331">Description</span><span class="sxs-lookup"><span data-stu-id="1a2ce-331">Description</span></span>|
|---------|------------|
|<span data-ttu-id="1a2ce-332">External_AutoStop_Condition</span><span class="sxs-lookup"><span data-stu-id="1a2ce-332">External_AutoStop_Condition</span></span> | <span data-ttu-id="1a2ce-333">The conditional operator required for configuring the condition before triggering an alert.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-333">The conditional operator required for configuring the condition before triggering an alert.</span></span> <span data-ttu-id="1a2ce-334">Acceptable values are **GreaterThan**, **GreaterThanOrEqual**, **LessThan**, and **LessThanOrEqual**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-334">Acceptable values are **GreaterThan**, **GreaterThanOrEqual**, **LessThan**, and **LessThanOrEqual**.</span></span>|
|<span data-ttu-id="1a2ce-335">External_AutoStop_Description</span><span class="sxs-lookup"><span data-stu-id="1a2ce-335">External_AutoStop_Description</span></span> | <span data-ttu-id="1a2ce-336">The alert to stop the VM if the CPU percentage exceeds the threshold.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-336">The alert to stop the VM if the CPU percentage exceeds the threshold.</span></span>|
|<span data-ttu-id="1a2ce-337">External_AutoStop_MetricName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-337">External_AutoStop_MetricName</span></span> | <span data-ttu-id="1a2ce-338">The name of the performance metric for which the Azure Alert rule is to be configured.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-338">The name of the performance metric for which the Azure Alert rule is to be configured.</span></span>|
|<span data-ttu-id="1a2ce-339">External_AutoStop_Threshold</span><span class="sxs-lookup"><span data-stu-id="1a2ce-339">External_AutoStop_Threshold</span></span> | <span data-ttu-id="1a2ce-340">The threshold for the Azure Alert rule specified in the variable _External_AutoStop_MetricName_.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-340">The threshold for the Azure Alert rule specified in the variable _External_AutoStop_MetricName_.</span></span> <span data-ttu-id="1a2ce-341">Percentage values can range from 1 to 100.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-341">Percentage values can range from 1 to 100.</span></span>|
|<span data-ttu-id="1a2ce-342">External_AutoStop_TimeAggregationOperator</span><span class="sxs-lookup"><span data-stu-id="1a2ce-342">External_AutoStop_TimeAggregationOperator</span></span> | <span data-ttu-id="1a2ce-343">The time aggregation operator, which is applied to the selected window size to evaluate the condition.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-343">The time aggregation operator, which is applied to the selected window size to evaluate the condition.</span></span> <span data-ttu-id="1a2ce-344">Acceptable values are **Average**, **Minimum**, **Maximum**, **Total**, and **Last**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-344">Acceptable values are **Average**, **Minimum**, **Maximum**, **Total**, and **Last**.</span></span>|
|<span data-ttu-id="1a2ce-345">External_AutoStop_TimeWindow</span><span class="sxs-lookup"><span data-stu-id="1a2ce-345">External_AutoStop_TimeWindow</span></span> | <span data-ttu-id="1a2ce-346">The window size during which Azure analyzes selected metrics for triggering an alert.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-346">The window size during which Azure analyzes selected metrics for triggering an alert.</span></span> <span data-ttu-id="1a2ce-347">This parameter accepts input in timespan format.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-347">This parameter accepts input in timespan format.</span></span> <span data-ttu-id="1a2ce-348">Possible values are from 5 minutes to 6 hours.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-348">Possible values are from 5 minutes to 6 hours.</span></span>|
|<span data-ttu-id="1a2ce-349">External_ExcludeVMNames</span><span class="sxs-lookup"><span data-stu-id="1a2ce-349">External_ExcludeVMNames</span></span> | <span data-ttu-id="1a2ce-350">Enter VM names to be excluded, separating names by using a comma with no spaces.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-350">Enter VM names to be excluded, separating names by using a comma with no spaces.</span></span>|
|<span data-ttu-id="1a2ce-351">External_Start_ResourceGroupNames</span><span class="sxs-lookup"><span data-stu-id="1a2ce-351">External_Start_ResourceGroupNames</span></span> | <span data-ttu-id="1a2ce-352">Specifies one or more resource groups, separating values by using a comma, targeted for start actions.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-352">Specifies one or more resource groups, separating values by using a comma, targeted for start actions.</span></span>|
|<span data-ttu-id="1a2ce-353">External_Stop_ResourceGroupNames</span><span class="sxs-lookup"><span data-stu-id="1a2ce-353">External_Stop_ResourceGroupNames</span></span> | <span data-ttu-id="1a2ce-354">Specifies one or more resource groups, separating values by using a comma, targeted for stop actions.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-354">Specifies one or more resource groups, separating values by using a comma, targeted for stop actions.</span></span>|
|<span data-ttu-id="1a2ce-355">Internal_AutomationAccountName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-355">Internal_AutomationAccountName</span></span> | <span data-ttu-id="1a2ce-356">Specifies the name of the Automation account.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-356">Specifies the name of the Automation account.</span></span>|
|<span data-ttu-id="1a2ce-357">Internal_AutoSnooze_WebhookUri</span><span class="sxs-lookup"><span data-stu-id="1a2ce-357">Internal_AutoSnooze_WebhookUri</span></span> | <span data-ttu-id="1a2ce-358">Specifies Webhook URI called for the AutoStop scenario.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-358">Specifies Webhook URI called for the AutoStop scenario.</span></span>|
|<span data-ttu-id="1a2ce-359">Internal_AzureSubscriptionId</span><span class="sxs-lookup"><span data-stu-id="1a2ce-359">Internal_AzureSubscriptionId</span></span> | <span data-ttu-id="1a2ce-360">Specifies the Azure Subscription ID.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-360">Specifies the Azure Subscription ID.</span></span>|
|<span data-ttu-id="1a2ce-361">Internal_ResourceGroupName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-361">Internal_ResourceGroupName</span></span> | <span data-ttu-id="1a2ce-362">Specifies the Automation account resource group name.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-362">Specifies the Automation account resource group name.</span></span>|

<span data-ttu-id="1a2ce-363">Across all scenarios, the **External_Start_ResourceGroupNames**,  **External_Stop_ResourceGroupNames**, and **External_ExcludeVMNames** variables are necessary for targeting VMs, with the exception of providing a comma-separated list of VMs for the **AutoStop_CreateAlert_Parent**, **SequencedStartStop_Parent**, and **ScheduledStartStop_Parent** runbooks.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-363">Across all scenarios, the **External_Start_ResourceGroupNames**,  **External_Stop_ResourceGroupNames**, and **External_ExcludeVMNames** variables are necessary for targeting VMs, with the exception of providing a comma-separated list of VMs for the **AutoStop_CreateAlert_Parent**, **SequencedStartStop_Parent**, and **ScheduledStartStop_Parent** runbooks.</span></span> <span data-ttu-id="1a2ce-364">That is, your VMs must reside in target resource groups for start and stop actions to occur.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-364">That is, your VMs must reside in target resource groups for start and stop actions to occur.</span></span> <span data-ttu-id="1a2ce-365">The logic works similar to Azure policy, in that you can target the subscription or resource group and have actions inherited by newly created VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-365">The logic works similar to Azure policy, in that you can target the subscription or resource group and have actions inherited by newly created VMs.</span></span> <span data-ttu-id="1a2ce-366">This approach avoids having to maintain a separate schedule for every VM and manage starts and stops in scale.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-366">This approach avoids having to maintain a separate schedule for every VM and manage starts and stops in scale.</span></span>

### <a name="schedules"></a><span data-ttu-id="1a2ce-367">Schedules</span><span class="sxs-lookup"><span data-stu-id="1a2ce-367">Schedules</span></span>

<span data-ttu-id="1a2ce-368">The following table lists each of the default schedules created in your Automation account.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-368">The following table lists each of the default schedules created in your Automation account.</span></span> <span data-ttu-id="1a2ce-369">You can modify them or create your own custom schedules.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-369">You can modify them or create your own custom schedules.</span></span> <span data-ttu-id="1a2ce-370">By default, each of these are disabled except for **Scheduled_StartVM** and **Scheduled_StopVM**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-370">By default, each of these are disabled except for **Scheduled_StartVM** and **Scheduled_StopVM**.</span></span>

<span data-ttu-id="1a2ce-371">You should not enable all schedules, because this might create overlapping schedule actions.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-371">You should not enable all schedules, because this might create overlapping schedule actions.</span></span> <span data-ttu-id="1a2ce-372">It's best to determine which optimizations you want to perform and modify accordingly.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-372">It's best to determine which optimizations you want to perform and modify accordingly.</span></span> <span data-ttu-id="1a2ce-373">See the example scenarios in the overview section for further explanation.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-373">See the example scenarios in the overview section for further explanation.</span></span>

|<span data-ttu-id="1a2ce-374">Schedule name</span><span class="sxs-lookup"><span data-stu-id="1a2ce-374">Schedule name</span></span> | <span data-ttu-id="1a2ce-375">Frequency</span><span class="sxs-lookup"><span data-stu-id="1a2ce-375">Frequency</span></span> | <span data-ttu-id="1a2ce-376">Description</span><span class="sxs-lookup"><span data-stu-id="1a2ce-376">Description</span></span>|
|--- | --- | ---|
|<span data-ttu-id="1a2ce-377">Schedule_AutoStop_CreateAlert_Parent</span><span class="sxs-lookup"><span data-stu-id="1a2ce-377">Schedule_AutoStop_CreateAlert_Parent</span></span> | <span data-ttu-id="1a2ce-378">Every 8 hours</span><span class="sxs-lookup"><span data-stu-id="1a2ce-378">Every 8 hours</span></span> | <span data-ttu-id="1a2ce-379">Runs the AutoStop_CreateAlert_Parent runbook every 8 hours, which in turn stops the VM-based values in External_Start_ResourceGroupNames, External_Stop_ResourceGroupNames, and External_ExcludeVMNames in Azure Automation variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-379">Runs the AutoStop_CreateAlert_Parent runbook every 8 hours, which in turn stops the VM-based values in External_Start_ResourceGroupNames, External_Stop_ResourceGroupNames, and External_ExcludeVMNames in Azure Automation variables.</span></span> <span data-ttu-id="1a2ce-380">Alternatively, you can specify a comma-separated list of VMs by using the VMList parameter.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-380">Alternatively, you can specify a comma-separated list of VMs by using the VMList parameter.</span></span>|
|<span data-ttu-id="1a2ce-381">Scheduled_StopVM</span><span class="sxs-lookup"><span data-stu-id="1a2ce-381">Scheduled_StopVM</span></span> | <span data-ttu-id="1a2ce-382">User defined, daily</span><span class="sxs-lookup"><span data-stu-id="1a2ce-382">User defined, daily</span></span> | <span data-ttu-id="1a2ce-383">Runs the Scheduled_Parent runbook with a parameter of _Stop_ every day at the specified time.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-383">Runs the Scheduled_Parent runbook with a parameter of _Stop_ every day at the specified time.</span></span> <span data-ttu-id="1a2ce-384">Automatically stops all VMs that meet the rules defined by asset variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-384">Automatically stops all VMs that meet the rules defined by asset variables.</span></span> <span data-ttu-id="1a2ce-385">You should enable the related schedule, **Scheduled-StartVM**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-385">You should enable the related schedule, **Scheduled-StartVM**.</span></span>|
|<span data-ttu-id="1a2ce-386">Scheduled_StartVM</span><span class="sxs-lookup"><span data-stu-id="1a2ce-386">Scheduled_StartVM</span></span> | <span data-ttu-id="1a2ce-387">User defined, daily</span><span class="sxs-lookup"><span data-stu-id="1a2ce-387">User defined, daily</span></span> | <span data-ttu-id="1a2ce-388">Runs the Scheduled_Parent runbook with a parameter of _Start_ every day at the specified time.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-388">Runs the Scheduled_Parent runbook with a parameter of _Start_ every day at the specified time.</span></span> <span data-ttu-id="1a2ce-389">Automatically starts all VMs that meet the rules defined by the appropriate variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-389">Automatically starts all VMs that meet the rules defined by the appropriate variables.</span></span> <span data-ttu-id="1a2ce-390">You should enable the related schedule, **Scheduled-StopVM**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-390">You should enable the related schedule, **Scheduled-StopVM**.</span></span>|
|<span data-ttu-id="1a2ce-391">Sequenced-StopVM</span><span class="sxs-lookup"><span data-stu-id="1a2ce-391">Sequenced-StopVM</span></span> | <span data-ttu-id="1a2ce-392">1:00 AM (UTC), every Friday</span><span class="sxs-lookup"><span data-stu-id="1a2ce-392">1:00 AM (UTC), every Friday</span></span> | <span data-ttu-id="1a2ce-393">Runs the Sequenced_Parent runbook with a parameter of _Stop_ every Friday at the specified time.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-393">Runs the Sequenced_Parent runbook with a parameter of _Stop_ every Friday at the specified time.</span></span> <span data-ttu-id="1a2ce-394">Sequentially (ascending) stops all VMs with a tag of **SequenceStop** defined by the appropriate variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-394">Sequentially (ascending) stops all VMs with a tag of **SequenceStop** defined by the appropriate variables.</span></span> <span data-ttu-id="1a2ce-395">Refer to the Runbooks section for more details on tag values and asset variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-395">Refer to the Runbooks section for more details on tag values and asset variables.</span></span> <span data-ttu-id="1a2ce-396">You should enable the related schedule, **Sequenced-StartVM**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-396">You should enable the related schedule, **Sequenced-StartVM**.</span></span>|
|<span data-ttu-id="1a2ce-397">Sequenced-StartVM</span><span class="sxs-lookup"><span data-stu-id="1a2ce-397">Sequenced-StartVM</span></span> | <span data-ttu-id="1a2ce-398">1:00 PM (UTC), every Monday</span><span class="sxs-lookup"><span data-stu-id="1a2ce-398">1:00 PM (UTC), every Monday</span></span> | <span data-ttu-id="1a2ce-399">Runs the Sequenced_Parent runbook with a parameter of _Start_ every Monday at the specified time.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-399">Runs the Sequenced_Parent runbook with a parameter of _Start_ every Monday at the specified time.</span></span> <span data-ttu-id="1a2ce-400">Sequentially (descending) starts all VMs with a tag of **SequenceStart** defined by the appropriate variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-400">Sequentially (descending) starts all VMs with a tag of **SequenceStart** defined by the appropriate variables.</span></span> <span data-ttu-id="1a2ce-401">Refer to the Runbooks section for more details on tag values and asset variables.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-401">Refer to the Runbooks section for more details on tag values and asset variables.</span></span> <span data-ttu-id="1a2ce-402">You should enable the related schedule, **Sequenced-StopVM**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-402">You should enable the related schedule, **Sequenced-StopVM**.</span></span>|

## <a name="log-analytics-records"></a><span data-ttu-id="1a2ce-403">Log Analytics records</span><span class="sxs-lookup"><span data-stu-id="1a2ce-403">Log Analytics records</span></span>

<span data-ttu-id="1a2ce-404">Automation creates two types of records in the Log Analytics workspace: job logs and job streams.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-404">Automation creates two types of records in the Log Analytics workspace: job logs and job streams.</span></span>

### <a name="job-logs"></a><span data-ttu-id="1a2ce-405">Job logs</span><span class="sxs-lookup"><span data-stu-id="1a2ce-405">Job logs</span></span>

|<span data-ttu-id="1a2ce-406">Property</span><span class="sxs-lookup"><span data-stu-id="1a2ce-406">Property</span></span> | <span data-ttu-id="1a2ce-407">Description</span><span class="sxs-lookup"><span data-stu-id="1a2ce-407">Description</span></span>|
|----------|----------|
|<span data-ttu-id="1a2ce-408">Caller</span><span class="sxs-lookup"><span data-stu-id="1a2ce-408">Caller</span></span> |  <span data-ttu-id="1a2ce-409">Who initiated the operation.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-409">Who initiated the operation.</span></span> <span data-ttu-id="1a2ce-410">Possible values are either an email address or system for scheduled jobs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-410">Possible values are either an email address or system for scheduled jobs.</span></span>|
|<span data-ttu-id="1a2ce-411">Category</span><span class="sxs-lookup"><span data-stu-id="1a2ce-411">Category</span></span> | <span data-ttu-id="1a2ce-412">Classification of the type of data.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-412">Classification of the type of data.</span></span> <span data-ttu-id="1a2ce-413">For Automation, the value is JobLogs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-413">For Automation, the value is JobLogs.</span></span>|
|<span data-ttu-id="1a2ce-414">CorrelationId</span><span class="sxs-lookup"><span data-stu-id="1a2ce-414">CorrelationId</span></span> | <span data-ttu-id="1a2ce-415">GUID that is the Correlation ID of the runbook job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-415">GUID that is the Correlation ID of the runbook job.</span></span>|
|<span data-ttu-id="1a2ce-416">JobId</span><span class="sxs-lookup"><span data-stu-id="1a2ce-416">JobId</span></span> | <span data-ttu-id="1a2ce-417">GUID that is the ID of the runbook job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-417">GUID that is the ID of the runbook job.</span></span>|
|<span data-ttu-id="1a2ce-418">operationName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-418">operationName</span></span> | <span data-ttu-id="1a2ce-419">Specifies the type of operation performed in Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-419">Specifies the type of operation performed in Azure.</span></span> <span data-ttu-id="1a2ce-420">For Automation, the value is Job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-420">For Automation, the value is Job.</span></span>|
|<span data-ttu-id="1a2ce-421">resourceId</span><span class="sxs-lookup"><span data-stu-id="1a2ce-421">resourceId</span></span> | <span data-ttu-id="1a2ce-422">Specifies the resource type in Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-422">Specifies the resource type in Azure.</span></span> <span data-ttu-id="1a2ce-423">For Automation, the value is the Automation account associated with the runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-423">For Automation, the value is the Automation account associated with the runbook.</span></span>|
|<span data-ttu-id="1a2ce-424">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="1a2ce-424">ResourceGroup</span></span> | <span data-ttu-id="1a2ce-425">Specifies the resource group  name of the runbook job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-425">Specifies the resource group  name of the runbook job.</span></span>|
|<span data-ttu-id="1a2ce-426">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="1a2ce-426">ResourceProvider</span></span> | <span data-ttu-id="1a2ce-427">Specifies the Azure service that supplies the resources you can deploy and manage.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-427">Specifies the Azure service that supplies the resources you can deploy and manage.</span></span> <span data-ttu-id="1a2ce-428">For Automation, the value is Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-428">For Automation, the value is Azure Automation.</span></span>|
|<span data-ttu-id="1a2ce-429">ResourceType</span><span class="sxs-lookup"><span data-stu-id="1a2ce-429">ResourceType</span></span> | <span data-ttu-id="1a2ce-430">Specifies the resource type in Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-430">Specifies the resource type in Azure.</span></span> <span data-ttu-id="1a2ce-431">For Automation, the value is the Automation account associated with the runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-431">For Automation, the value is the Automation account associated with the runbook.</span></span>|
|<span data-ttu-id="1a2ce-432">resultType</span><span class="sxs-lookup"><span data-stu-id="1a2ce-432">resultType</span></span> | <span data-ttu-id="1a2ce-433">The status of the runbook job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-433">The status of the runbook job.</span></span> <span data-ttu-id="1a2ce-434">Possible values are:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-434">Possible values are:</span></span><br><span data-ttu-id="1a2ce-435">- Started</span><span class="sxs-lookup"><span data-stu-id="1a2ce-435">- Started</span></span><br><span data-ttu-id="1a2ce-436">- Stopped</span><span class="sxs-lookup"><span data-stu-id="1a2ce-436">- Stopped</span></span><br><span data-ttu-id="1a2ce-437">- Suspended</span><span class="sxs-lookup"><span data-stu-id="1a2ce-437">- Suspended</span></span><br><span data-ttu-id="1a2ce-438">- Failed</span><span class="sxs-lookup"><span data-stu-id="1a2ce-438">- Failed</span></span><br><span data-ttu-id="1a2ce-439">- Succeeded</span><span class="sxs-lookup"><span data-stu-id="1a2ce-439">- Succeeded</span></span>|
|<span data-ttu-id="1a2ce-440">resultDescription</span><span class="sxs-lookup"><span data-stu-id="1a2ce-440">resultDescription</span></span> | <span data-ttu-id="1a2ce-441">Describes the runbook job result state.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-441">Describes the runbook job result state.</span></span> <span data-ttu-id="1a2ce-442">Possible values are:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-442">Possible values are:</span></span><br><span data-ttu-id="1a2ce-443">- Job is started</span><span class="sxs-lookup"><span data-stu-id="1a2ce-443">- Job is started</span></span><br><span data-ttu-id="1a2ce-444">- Job Failed</span><span class="sxs-lookup"><span data-stu-id="1a2ce-444">- Job Failed</span></span><br><span data-ttu-id="1a2ce-445">- Job Completed</span><span class="sxs-lookup"><span data-stu-id="1a2ce-445">- Job Completed</span></span>|
|<span data-ttu-id="1a2ce-446">RunbookName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-446">RunbookName</span></span> | <span data-ttu-id="1a2ce-447">Specifies the name of the runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-447">Specifies the name of the runbook.</span></span>|
|<span data-ttu-id="1a2ce-448">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="1a2ce-448">SourceSystem</span></span> | <span data-ttu-id="1a2ce-449">Specifies the source system for the data submitted.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-449">Specifies the source system for the data submitted.</span></span> <span data-ttu-id="1a2ce-450">For Automation, the value is OpsManager</span><span class="sxs-lookup"><span data-stu-id="1a2ce-450">For Automation, the value is OpsManager</span></span>|
|<span data-ttu-id="1a2ce-451">StreamType</span><span class="sxs-lookup"><span data-stu-id="1a2ce-451">StreamType</span></span> | <span data-ttu-id="1a2ce-452">Specifies the type of event.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-452">Specifies the type of event.</span></span> <span data-ttu-id="1a2ce-453">Possible values are:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-453">Possible values are:</span></span><br><span data-ttu-id="1a2ce-454">- Verbose</span><span class="sxs-lookup"><span data-stu-id="1a2ce-454">- Verbose</span></span><br><span data-ttu-id="1a2ce-455">- Output</span><span class="sxs-lookup"><span data-stu-id="1a2ce-455">- Output</span></span><br><span data-ttu-id="1a2ce-456">- Error</span><span class="sxs-lookup"><span data-stu-id="1a2ce-456">- Error</span></span><br><span data-ttu-id="1a2ce-457">- Warning</span><span class="sxs-lookup"><span data-stu-id="1a2ce-457">- Warning</span></span>|
|<span data-ttu-id="1a2ce-458">SubscriptionId</span><span class="sxs-lookup"><span data-stu-id="1a2ce-458">SubscriptionId</span></span> | <span data-ttu-id="1a2ce-459">Specifies the subscription ID of the job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-459">Specifies the subscription ID of the job.</span></span>
|<span data-ttu-id="1a2ce-460">Time</span><span class="sxs-lookup"><span data-stu-id="1a2ce-460">Time</span></span> | <span data-ttu-id="1a2ce-461">Date and time when the runbook job executed.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-461">Date and time when the runbook job executed.</span></span>|

### <a name="job-streams"></a><span data-ttu-id="1a2ce-462">Job streams</span><span class="sxs-lookup"><span data-stu-id="1a2ce-462">Job streams</span></span>

|<span data-ttu-id="1a2ce-463">Property</span><span class="sxs-lookup"><span data-stu-id="1a2ce-463">Property</span></span> | <span data-ttu-id="1a2ce-464">Description</span><span class="sxs-lookup"><span data-stu-id="1a2ce-464">Description</span></span>|
|----------|----------|
|<span data-ttu-id="1a2ce-465">Caller</span><span class="sxs-lookup"><span data-stu-id="1a2ce-465">Caller</span></span> |  <span data-ttu-id="1a2ce-466">Who initiated the operation.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-466">Who initiated the operation.</span></span> <span data-ttu-id="1a2ce-467">Possible values are either an email address or system for scheduled jobs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-467">Possible values are either an email address or system for scheduled jobs.</span></span>|
|<span data-ttu-id="1a2ce-468">Category</span><span class="sxs-lookup"><span data-stu-id="1a2ce-468">Category</span></span> | <span data-ttu-id="1a2ce-469">Classification of the type of data.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-469">Classification of the type of data.</span></span> <span data-ttu-id="1a2ce-470">For Automation, the value is JobStreams.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-470">For Automation, the value is JobStreams.</span></span>|
|<span data-ttu-id="1a2ce-471">JobId</span><span class="sxs-lookup"><span data-stu-id="1a2ce-471">JobId</span></span> | <span data-ttu-id="1a2ce-472">GUID that is the ID of the runbook job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-472">GUID that is the ID of the runbook job.</span></span>|
|<span data-ttu-id="1a2ce-473">operationName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-473">operationName</span></span> | <span data-ttu-id="1a2ce-474">Specifies the type of operation performed in Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-474">Specifies the type of operation performed in Azure.</span></span> <span data-ttu-id="1a2ce-475">For Automation, the value is Job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-475">For Automation, the value is Job.</span></span>|
|<span data-ttu-id="1a2ce-476">ResourceGroup</span><span class="sxs-lookup"><span data-stu-id="1a2ce-476">ResourceGroup</span></span> | <span data-ttu-id="1a2ce-477">Specifies the resource group  name of the runbook job.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-477">Specifies the resource group  name of the runbook job.</span></span>|
|<span data-ttu-id="1a2ce-478">resourceId</span><span class="sxs-lookup"><span data-stu-id="1a2ce-478">resourceId</span></span> | <span data-ttu-id="1a2ce-479">Specifies the resource ID in Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-479">Specifies the resource ID in Azure.</span></span> <span data-ttu-id="1a2ce-480">For Automation, the value is the Automation account associated with the runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-480">For Automation, the value is the Automation account associated with the runbook.</span></span>|
|<span data-ttu-id="1a2ce-481">ResourceProvider</span><span class="sxs-lookup"><span data-stu-id="1a2ce-481">ResourceProvider</span></span> | <span data-ttu-id="1a2ce-482">Specifies the Azure service that supplies the resources you can deploy and manage.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-482">Specifies the Azure service that supplies the resources you can deploy and manage.</span></span> <span data-ttu-id="1a2ce-483">For Automation, the value is Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-483">For Automation, the value is Azure Automation.</span></span>|
|<span data-ttu-id="1a2ce-484">ResourceType</span><span class="sxs-lookup"><span data-stu-id="1a2ce-484">ResourceType</span></span> | <span data-ttu-id="1a2ce-485">Specifies the resource type in Azure.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-485">Specifies the resource type in Azure.</span></span> <span data-ttu-id="1a2ce-486">For Automation, the value is the Automation account associated with the runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-486">For Automation, the value is the Automation account associated with the runbook.</span></span>|
|<span data-ttu-id="1a2ce-487">resultType</span><span class="sxs-lookup"><span data-stu-id="1a2ce-487">resultType</span></span> | <span data-ttu-id="1a2ce-488">The result of the runbook job at the time the event was generated.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-488">The result of the runbook job at the time the event was generated.</span></span> <span data-ttu-id="1a2ce-489">A possible value is:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-489">A possible value is:</span></span><br><span data-ttu-id="1a2ce-490">- InProgress</span><span class="sxs-lookup"><span data-stu-id="1a2ce-490">- InProgress</span></span>|
|<span data-ttu-id="1a2ce-491">resultDescription</span><span class="sxs-lookup"><span data-stu-id="1a2ce-491">resultDescription</span></span> | <span data-ttu-id="1a2ce-492">Includes the output stream from the runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-492">Includes the output stream from the runbook.</span></span>|
|<span data-ttu-id="1a2ce-493">RunbookName</span><span class="sxs-lookup"><span data-stu-id="1a2ce-493">RunbookName</span></span> | <span data-ttu-id="1a2ce-494">The name of the runbook.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-494">The name of the runbook.</span></span>|
|<span data-ttu-id="1a2ce-495">SourceSystem</span><span class="sxs-lookup"><span data-stu-id="1a2ce-495">SourceSystem</span></span> | <span data-ttu-id="1a2ce-496">Specifies the source system for the data submitted.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-496">Specifies the source system for the data submitted.</span></span> <span data-ttu-id="1a2ce-497">For Automation, the value is OpsManager.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-497">For Automation, the value is OpsManager.</span></span>|
|<span data-ttu-id="1a2ce-498">StreamType</span><span class="sxs-lookup"><span data-stu-id="1a2ce-498">StreamType</span></span> | <span data-ttu-id="1a2ce-499">The type of job stream.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-499">The type of job stream.</span></span> <span data-ttu-id="1a2ce-500">Possible values are:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-500">Possible values are:</span></span><br><span data-ttu-id="1a2ce-501">- Progress</span><span class="sxs-lookup"><span data-stu-id="1a2ce-501">- Progress</span></span><br><span data-ttu-id="1a2ce-502">- Output</span><span class="sxs-lookup"><span data-stu-id="1a2ce-502">- Output</span></span><br><span data-ttu-id="1a2ce-503">- Warning</span><span class="sxs-lookup"><span data-stu-id="1a2ce-503">- Warning</span></span><br><span data-ttu-id="1a2ce-504">- Error</span><span class="sxs-lookup"><span data-stu-id="1a2ce-504">- Error</span></span><br><span data-ttu-id="1a2ce-505">- Debug</span><span class="sxs-lookup"><span data-stu-id="1a2ce-505">- Debug</span></span><br><span data-ttu-id="1a2ce-506">- Verbose</span><span class="sxs-lookup"><span data-stu-id="1a2ce-506">- Verbose</span></span>|
|<span data-ttu-id="1a2ce-507">Time</span><span class="sxs-lookup"><span data-stu-id="1a2ce-507">Time</span></span> | <span data-ttu-id="1a2ce-508">Date and time when the runbook job executed.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-508">Date and time when the runbook job executed.</span></span>|

<span data-ttu-id="1a2ce-509">When you perform any log search that returns category records of **JobLogs** or **JobStreams**, you can select the **JobLogs** or **JobStreams** view, which displays a set of tiles summarizing the updates returned by the search.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-509">When you perform any log search that returns category records of **JobLogs** or **JobStreams**, you can select the **JobLogs** or **JobStreams** view, which displays a set of tiles summarizing the updates returned by the search.</span></span>

## <a name="sample-log-searches"></a><span data-ttu-id="1a2ce-510">Sample log searches</span><span class="sxs-lookup"><span data-stu-id="1a2ce-510">Sample log searches</span></span>

<span data-ttu-id="1a2ce-511">The following table provides sample log searches for job records collected by this solution.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-511">The following table provides sample log searches for job records collected by this solution.</span></span>

|<span data-ttu-id="1a2ce-512">Query</span><span class="sxs-lookup"><span data-stu-id="1a2ce-512">Query</span></span> | <span data-ttu-id="1a2ce-513">Description</span><span class="sxs-lookup"><span data-stu-id="1a2ce-513">Description</span></span>|
|----------|----------|
|<span data-ttu-id="1a2ce-514">Find jobs for runbook ScheduledStartStop_Parent that have finished successfully</span><span class="sxs-lookup"><span data-stu-id="1a2ce-514">Find jobs for runbook ScheduledStartStop_Parent that have finished successfully</span></span> | <span data-ttu-id="1a2ce-515">search Category == "JobLogs" &#124; where ( RunbookName_s == "ScheduledStartStop_Parent" ) &#124; where ( ResultType == "Completed" )  &#124; summarize</span><span class="sxs-lookup"><span data-stu-id="1a2ce-515">search Category == "JobLogs" &#124; where ( RunbookName_s == "ScheduledStartStop_Parent" ) &#124; where ( ResultType == "Completed" )  &#124; summarize</span></span> |<span data-ttu-id="1a2ce-516">AggregatedValue = count() by ResultType, bin(TimeGenerated, 1h) &#124; sort by TimeGenerated desc</span><span class="sxs-lookup"><span data-stu-id="1a2ce-516">AggregatedValue = count() by ResultType, bin(TimeGenerated, 1h) &#124; sort by TimeGenerated desc</span></span>|
|<span data-ttu-id="1a2ce-517">Find jobs for runbook SequencedStartStop_Parent that have finished successfully</span><span class="sxs-lookup"><span data-stu-id="1a2ce-517">Find jobs for runbook SequencedStartStop_Parent that have finished successfully</span></span> | <span data-ttu-id="1a2ce-518">search Category == "JobLogs" &#124; where ( RunbookName_s == "SequencedStartStop_Parent" ) &#124; where ( ResultType == "Completed" )  &#124; summarize</span><span class="sxs-lookup"><span data-stu-id="1a2ce-518">search Category == "JobLogs" &#124; where ( RunbookName_s == "SequencedStartStop_Parent" ) &#124; where ( ResultType == "Completed" )  &#124; summarize</span></span> |<span data-ttu-id="1a2ce-519">AggregatedValue = count() by ResultType, bin(TimeGenerated, 1h) &#124; sort by TimeGenerated desc</span><span class="sxs-lookup"><span data-stu-id="1a2ce-519">AggregatedValue = count() by ResultType, bin(TimeGenerated, 1h) &#124; sort by TimeGenerated desc</span></span>

## <a name="viewing-the-solution"></a><span data-ttu-id="1a2ce-520">Viewing the solution</span><span class="sxs-lookup"><span data-stu-id="1a2ce-520">Viewing the solution</span></span>

<span data-ttu-id="1a2ce-521">To access the solution, navigate to your Automation Account, select **Workspace** under **RELATED RESOURCES**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-521">To access the solution, navigate to your Automation Account, select **Workspace** under **RELATED RESOURCES**.</span></span> <span data-ttu-id="1a2ce-522">On the Log Analytics page, select **Solutions** under **GENERAL**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-522">On the Log Analytics page, select **Solutions** under **GENERAL**.</span></span> <span data-ttu-id="1a2ce-523">On the **Solutions** page, select the solution **Start-Stop-VM[workspace]** from the list.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-523">On the **Solutions** page, select the solution **Start-Stop-VM[workspace]** from the list.</span></span>

<span data-ttu-id="1a2ce-524">Selecting the solution displays the **Start-Stop-VM[workspace]** solution page.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-524">Selecting the solution displays the **Start-Stop-VM[workspace]** solution page.</span></span> <span data-ttu-id="1a2ce-525">Here you can review important details such as the **StartStopVM** tile.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-525">Here you can review important details such as the **StartStopVM** tile.</span></span> <span data-ttu-id="1a2ce-526">As in your Log Analytics workspace, this tile displays a count and a graphical representation of the runbook jobs for the solution that have started and have finished successfully.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-526">As in your Log Analytics workspace, this tile displays a count and a graphical representation of the runbook jobs for the solution that have started and have finished successfully.</span></span>

![Automation Update Management solution page](media/automation-solution-vm-management/azure-portal-vmupdate-solution-01.png)

<span data-ttu-id="1a2ce-528">From here, you can perform further analysis of the job records by clicking the donut tile.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-528">From here, you can perform further analysis of the job records by clicking the donut tile.</span></span> <span data-ttu-id="1a2ce-529">The solution dashboard shows job history and pre-defined log search queries.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-529">The solution dashboard shows job history and pre-defined log search queries.</span></span> <span data-ttu-id="1a2ce-530">Switch to the Log Analytics Advanced portal to search based on your search queries.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-530">Switch to the Log Analytics Advanced portal to search based on your search queries.</span></span>

## <a name="configure-email-notifications"></a><span data-ttu-id="1a2ce-531">Configure email notifications</span><span class="sxs-lookup"><span data-stu-id="1a2ce-531">Configure email notifications</span></span>

<span data-ttu-id="1a2ce-532">To change email notifications after the solution is deployed, modify action group that was created during deployment.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-532">To change email notifications after the solution is deployed, modify action group that was created during deployment.</span></span>  

<span data-ttu-id="1a2ce-533">In the Azure portal, navigate to Monitor -> Action groups.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-533">In the Azure portal, navigate to Monitor -> Action groups.</span></span> <span data-ttu-id="1a2ce-534">Select the action group titled **StartStop_VM_Notication**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-534">Select the action group titled **StartStop_VM_Notication**.</span></span>

![Automation Update Management solution page](media/automation-solution-vm-management/azure-monitor.png)

<span data-ttu-id="1a2ce-536">On the **StartStop_VM_Notification** page, click **Edit details** under **Details**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-536">On the **StartStop_VM_Notification** page, click **Edit details** under **Details**.</span></span> <span data-ttu-id="1a2ce-537">This opens the **Email/SMS/Push/Voice** page.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-537">This opens the **Email/SMS/Push/Voice** page.</span></span> <span data-ttu-id="1a2ce-538">Update the email address and click **OK** to save your changes.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-538">Update the email address and click **OK** to save your changes.</span></span>

![Automation Update Management solution page](media/automation-solution-vm-management/change-email.png)

<span data-ttu-id="1a2ce-540">Alternatively you can add additional actions to the action group, to learn more about action groups, see [action groups](../monitoring-and-diagnostics/monitoring-action-groups.md)</span><span class="sxs-lookup"><span data-stu-id="1a2ce-540">Alternatively you can add additional actions to the action group, to learn more about action groups, see [action groups](../monitoring-and-diagnostics/monitoring-action-groups.md)</span></span>

<span data-ttu-id="1a2ce-541">The following is an example email that is sent when the solution shuts down virtual machines.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-541">The following is an example email that is sent when the solution shuts down virtual machines.</span></span>

![Automation Update Management solution page](media/automation-solution-vm-management/email.png)

## <a name="modify-the-startup-and-shutdown-schedules"></a><span data-ttu-id="1a2ce-543">Modify the startup and shutdown schedules</span><span class="sxs-lookup"><span data-stu-id="1a2ce-543">Modify the startup and shutdown schedules</span></span>

<span data-ttu-id="1a2ce-544">Managing the startup and shutdown schedules in this solution follows the same steps as outlined in [Scheduling a runbook in Azure Automation](automation-schedules.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-544">Managing the startup and shutdown schedules in this solution follows the same steps as outlined in [Scheduling a runbook in Azure Automation](automation-schedules.md).</span></span>

<span data-ttu-id="1a2ce-545">Configuring the solution to just stop VMs at a certain time is supported.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-545">Configuring the solution to just stop VMs at a certain time is supported.</span></span> <span data-ttu-id="1a2ce-546">To do this, you need to:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-546">To do this, you need to:</span></span>

1. <span data-ttu-id="1a2ce-547">Ensure you have added the resource groups for the VMs to shut down in the **External_Start_ResourceGroupNames** variable.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-547">Ensure you have added the resource groups for the VMs to shut down in the **External_Start_ResourceGroupNames** variable.</span></span>
1. <span data-ttu-id="1a2ce-548">Create your own schedule for the time you want to shut down the VMs.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-548">Create your own schedule for the time you want to shut down the VMs.</span></span>
1. <span data-ttu-id="1a2ce-549">Navigate to the **ScheduledStartStop_Parent** runbook and click **Schedule**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-549">Navigate to the **ScheduledStartStop_Parent** runbook and click **Schedule**.</span></span> <span data-ttu-id="1a2ce-550">This allows you to select the schedule you created in the preceding step.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-550">This allows you to select the schedule you created in the preceding step.</span></span>
1. <span data-ttu-id="1a2ce-551">Select **Parameters and run settings** and set the ACTION parameter to "Stop".</span><span class="sxs-lookup"><span data-stu-id="1a2ce-551">Select **Parameters and run settings** and set the ACTION parameter to "Stop".</span></span>
1. <span data-ttu-id="1a2ce-552">Click **OK** to save your changes.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-552">Click **OK** to save your changes.</span></span>

## <a name="update-the-solution"></a><span data-ttu-id="1a2ce-553">Update the solution</span><span class="sxs-lookup"><span data-stu-id="1a2ce-553">Update the solution</span></span>

<span data-ttu-id="1a2ce-554">If you have deployed a previous version of this solution, you must first delete it from your account before deploying an updated release.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-554">If you have deployed a previous version of this solution, you must first delete it from your account before deploying an updated release.</span></span> <span data-ttu-id="1a2ce-555">Follow the steps to [remove the solution](#remove-the-solution) and then follow the steps above to [deploy the solution](#deploy-the-solution).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-555">Follow the steps to [remove the solution](#remove-the-solution) and then follow the steps above to [deploy the solution](#deploy-the-solution).</span></span>

## <a name="remove-the-solution"></a><span data-ttu-id="1a2ce-556">Remove the solution</span><span class="sxs-lookup"><span data-stu-id="1a2ce-556">Remove the solution</span></span>

<span data-ttu-id="1a2ce-557">If you decide you no longer need to use the solution, you can delete it from the Automation account.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-557">If you decide you no longer need to use the solution, you can delete it from the Automation account.</span></span> <span data-ttu-id="1a2ce-558">Deleting the solution only removes the runbooks.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-558">Deleting the solution only removes the runbooks.</span></span> <span data-ttu-id="1a2ce-559">It does not delete the schedules or variables that were created when the solution was added.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-559">It does not delete the schedules or variables that were created when the solution was added.</span></span> <span data-ttu-id="1a2ce-560">Those assets you need to delete manually if you are not using them with other runbooks.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-560">Those assets you need to delete manually if you are not using them with other runbooks.</span></span>

<span data-ttu-id="1a2ce-561">To delete the solution, perform the following steps:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-561">To delete the solution, perform the following steps:</span></span>

1. <span data-ttu-id="1a2ce-562">From your Automation account, select **Workspace** from the left page.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-562">From your Automation account, select **Workspace** from the left page.</span></span>
1. <span data-ttu-id="1a2ce-563">On the **Solutions** page, select the solution **Start-Stop-VM[Workspace]**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-563">On the **Solutions** page, select the solution **Start-Stop-VM[Workspace]**.</span></span> <span data-ttu-id="1a2ce-564">On the **VMManagementSolution[Workspace]** page, from the menu, select **Delete**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-564">On the **VMManagementSolution[Workspace]** page, from the menu, select **Delete**.</span></span><br><br> <span data-ttu-id="1a2ce-565">![Delete VM Mgmt Solution](media/automation-solution-vm-management/vm-management-solution-delete.png)</span><span class="sxs-lookup"><span data-stu-id="1a2ce-565">![Delete VM Mgmt Solution](media/automation-solution-vm-management/vm-management-solution-delete.png)</span></span>
1. <span data-ttu-id="1a2ce-566">In the **Delete Solution** window, confirm that  you want to delete the solution.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-566">In the **Delete Solution** window, confirm that  you want to delete the solution.</span></span>
1. <span data-ttu-id="1a2ce-567">While the information is verified and the solution is deleted, you can track its progress under **Notifications** from the menu.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-567">While the information is verified and the solution is deleted, you can track its progress under **Notifications** from the menu.</span></span> <span data-ttu-id="1a2ce-568">You are returned to the **Solutions** page after the process to remove the solution starts.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-568">You are returned to the **Solutions** page after the process to remove the solution starts.</span></span>

<span data-ttu-id="1a2ce-569">The Automation account and Log Analytics workspace are not deleted as part of this process.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-569">The Automation account and Log Analytics workspace are not deleted as part of this process.</span></span> <span data-ttu-id="1a2ce-570">If you do not want to retain the Log Analytics workspace, you need to manually delete it.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-570">If you do not want to retain the Log Analytics workspace, you need to manually delete it.</span></span> <span data-ttu-id="1a2ce-571">This can be accomplished from the Azure portal:</span><span class="sxs-lookup"><span data-stu-id="1a2ce-571">This can be accomplished from the Azure portal:</span></span>

1. <span data-ttu-id="1a2ce-572">From the  Azure portal home screen, select **Log Analytics**.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-572">From the  Azure portal home screen, select **Log Analytics**.</span></span>
1. <span data-ttu-id="1a2ce-573">On the **Log Analytics** page, select the workspace.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-573">On the **Log Analytics** page, select the workspace.</span></span>
1. <span data-ttu-id="1a2ce-574">Select **Delete** from the menu on the workspace settings page.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-574">Select **Delete** from the menu on the workspace settings page.</span></span>

<span data-ttu-id="1a2ce-575">If you do not want to retain the Azure Automation account components, you can manually delete each.</span><span class="sxs-lookup"><span data-stu-id="1a2ce-575">If you do not want to retain the Azure Automation account components, you can manually delete each.</span></span> <span data-ttu-id="1a2ce-576">For the list of runbooks, variables, and schedules created by the solution, see the [Solution components](#solution-components).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-576">For the list of runbooks, variables, and schedules created by the solution, see the [Solution components](#solution-components).</span></span>

## <a name="next-steps"></a><span data-ttu-id="1a2ce-577">Next steps</span><span class="sxs-lookup"><span data-stu-id="1a2ce-577">Next steps</span></span>

- <span data-ttu-id="1a2ce-578">To learn more about how to construct different search queries and review the Automation job logs with Log Analytics, see [Log searches in Log Analytics](../log-analytics/log-analytics-log-searches.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-578">To learn more about how to construct different search queries and review the Automation job logs with Log Analytics, see [Log searches in Log Analytics](../log-analytics/log-analytics-log-searches.md).</span></span>
- <span data-ttu-id="1a2ce-579">To learn more about runbook execution, how to monitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-579">To learn more about runbook execution, how to monitor runbook jobs, and other technical details, see [Track a runbook job](automation-runbook-execution.md).</span></span>
- <span data-ttu-id="1a2ce-580">To learn more about Log Analytics and data collection sources, see [Collecting Azure storage data in Log Analytics overview](../log-analytics/log-analytics-azure-storage.md).</span><span class="sxs-lookup"><span data-stu-id="1a2ce-580">To learn more about Log Analytics and data collection sources, see [Collecting Azure storage data in Log Analytics overview](../log-analytics/log-analytics-azure-storage.md).</span></span>