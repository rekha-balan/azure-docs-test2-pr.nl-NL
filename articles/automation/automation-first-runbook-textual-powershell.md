---
title: My first PowerShell runbook in Azure Automation
description: Tutorial that walks you through the creation, testing, and publishing of a simple PowerShell runbook.
keywords: azure powershell, powershell script tutorial, powershell automation
services: automation
ms.service: automation
ms.component: process-automation
author: georgewallace
ms.author: gwallace
ms.date: 03/16/2018
ms.topic: conceptual
manager: carmonm
ms.openlocfilehash: 2f5d2f3634545001dc6dc1419530223b5a1a85a3
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44776431"
---
# <a name="my-first-powershell-runbook"></a><span data-ttu-id="802cb-104">My first PowerShell runbook</span><span class="sxs-lookup"><span data-stu-id="802cb-104">My first PowerShell runbook</span></span>

> [!div class="op_single_selector"]
> * [Graphical](automation-first-runbook-graphical.md)
> * [PowerShell](automation-first-runbook-textual-powershell.md)
> * [PowerShell Workflow](automation-first-runbook-textual.md)
> * [Python](automation-first-runbook-textual-python2.md)

<span data-ttu-id="802cb-109">This tutorial walks you through the creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span><span class="sxs-lookup"><span data-stu-id="802cb-109">This tutorial walks you through the creation of a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) in Azure Automation.</span></span> <span data-ttu-id="802cb-110">You start with a simple runbook that you test and publish while you learn how to track the status of the runbook job.</span><span class="sxs-lookup"><span data-stu-id="802cb-110">You start with a simple runbook that you test and publish while you learn how to track the status of the runbook job.</span></span> <span data-ttu-id="802cb-111">Then you modify the runbook to actually manage Azure resources, in this case starting an Azure virtual machine.</span><span class="sxs-lookup"><span data-stu-id="802cb-111">Then you modify the runbook to actually manage Azure resources, in this case starting an Azure virtual machine.</span></span> <span data-ttu-id="802cb-112">Lastly, you make the runbook more robust by adding runbook parameters.</span><span class="sxs-lookup"><span data-stu-id="802cb-112">Lastly, you make the runbook more robust by adding runbook parameters.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="802cb-113">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="802cb-113">Prerequisites</span></span>
<span data-ttu-id="802cb-114">To complete this tutorial, you need the following:</span><span class="sxs-lookup"><span data-stu-id="802cb-114">To complete this tutorial, you need the following:</span></span>

* <span data-ttu-id="802cb-115">Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="802cb-115">Azure subscription.</span></span> <span data-ttu-id="802cb-116">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or sign up for a [free account](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).</span><span class="sxs-lookup"><span data-stu-id="802cb-116">If you don't have one yet, you can [activate your MSDN subscriber benefits](https://azure.microsoft.com/pricing/member-offers/msdn-benefits-details/) or sign up for a [free account](https://azure.microsoft.com/free/?WT.mc_id=A261C142F).</span></span>
* <span data-ttu-id="802cb-117">[Automation account](automation-offering-get-started.md) to hold the runbook and authenticate to Azure resources.</span><span class="sxs-lookup"><span data-stu-id="802cb-117">[Automation account](automation-offering-get-started.md) to hold the runbook and authenticate to Azure resources.</span></span> <span data-ttu-id="802cb-118">This account must have permission to start and stop the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="802cb-118">This account must have permission to start and stop the virtual machine.</span></span>
* <span data-ttu-id="802cb-119">An Azure virtual machine.</span><span class="sxs-lookup"><span data-stu-id="802cb-119">An Azure virtual machine.</span></span> <span data-ttu-id="802cb-120">You stop and start this machine so it should not be a production VM.</span><span class="sxs-lookup"><span data-stu-id="802cb-120">You stop and start this machine so it should not be a production VM.</span></span>

## <a name="step-1---create-new-runbook"></a><span data-ttu-id="802cb-121">Step 1 - Create new runbook</span><span class="sxs-lookup"><span data-stu-id="802cb-121">Step 1 - Create new runbook</span></span>
<span data-ttu-id="802cb-122">You start by creating a simple runbook that outputs the text *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="802cb-122">You start by creating a simple runbook that outputs the text *Hello World*.</span></span>

1. <span data-ttu-id="802cb-123">In the Azure portal, open your Automation account.</span><span class="sxs-lookup"><span data-stu-id="802cb-123">In the Azure portal, open your Automation account.</span></span>

   <span data-ttu-id="802cb-124">The Automation account page gives you a quick view of the resources in this account.</span><span class="sxs-lookup"><span data-stu-id="802cb-124">The Automation account page gives you a quick view of the resources in this account.</span></span> <span data-ttu-id="802cb-125">You should already have some assets.</span><span class="sxs-lookup"><span data-stu-id="802cb-125">You should already have some assets.</span></span> <span data-ttu-id="802cb-126">Most of those are the modules that are automatically included in a new Automation account.</span><span class="sxs-lookup"><span data-stu-id="802cb-126">Most of those are the modules that are automatically included in a new Automation account.</span></span> <span data-ttu-id="802cb-127">You should also have the Credential asset that's mentioned in the [prerequisites](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="802cb-127">You should also have the Credential asset that's mentioned in the [prerequisites](#prerequisites).</span></span>

1. <span data-ttu-id="802cb-128">Click **Runbooks** under **Process Automation** to open the list of runbooks.</span><span class="sxs-lookup"><span data-stu-id="802cb-128">Click **Runbooks** under **Process Automation** to open the list of runbooks.</span></span>
2. <span data-ttu-id="802cb-129">Create a new runbook by clicking the **+ Add a runbook** button and then **Create a new runbook**.</span><span class="sxs-lookup"><span data-stu-id="802cb-129">Create a new runbook by clicking the **+ Add a runbook** button and then **Create a new runbook**.</span></span>
3. <span data-ttu-id="802cb-130">Give the runbook the name *MyFirstRunbook-PowerShell*.</span><span class="sxs-lookup"><span data-stu-id="802cb-130">Give the runbook the name *MyFirstRunbook-PowerShell*.</span></span>
4. <span data-ttu-id="802cb-131">In this case, you're going to create a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span><span class="sxs-lookup"><span data-stu-id="802cb-131">In this case, you're going to create a [PowerShell runbook](automation-runbook-types.md#powershell-runbooks) so select **Powershell** for **Runbook type**.</span></span>
5. <span data-ttu-id="802cb-132">Click **Create** to create the runbook and open the textual editor.</span><span class="sxs-lookup"><span data-stu-id="802cb-132">Click **Create** to create the runbook and open the textual editor.</span></span>

## <a name="step-2---add-code-to-the-runbook"></a><span data-ttu-id="802cb-133">Step 2 - Add code to the runbook</span><span class="sxs-lookup"><span data-stu-id="802cb-133">Step 2 - Add code to the runbook</span></span>
<span data-ttu-id="802cb-134">You can either type code directly into the runbook, or you can select cmdlets, runbooks, and assets from the Library control and have them added to the runbook with any related parameters.</span><span class="sxs-lookup"><span data-stu-id="802cb-134">You can either type code directly into the runbook, or you can select cmdlets, runbooks, and assets from the Library control and have them added to the runbook with any related parameters.</span></span> <span data-ttu-id="802cb-135">For this walkthrough, you type directly in the runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-135">For this walkthrough, you type directly in the runbook.</span></span>

1. <span data-ttu-id="802cb-136">Your runbook is currently empty, type *Write-Output "Hello World."*</span><span class="sxs-lookup"><span data-stu-id="802cb-136">Your runbook is currently empty, type *Write-Output "Hello World."*</span></span> <span data-ttu-id="802cb-137">in the body of the script.</span><span class="sxs-lookup"><span data-stu-id="802cb-137">in the body of the script.</span></span><br><br> <span data-ttu-id="802cb-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span><span class="sxs-lookup"><span data-stu-id="802cb-138">![Hello World](media/automation-first-runbook-textual-powershell/automation-helloworld.png)</span></span>  
2. <span data-ttu-id="802cb-139">Save the runbook by clicking **Save**.</span><span class="sxs-lookup"><span data-stu-id="802cb-139">Save the runbook by clicking **Save**.</span></span>

## <a name="step-3---test-the-runbook"></a><span data-ttu-id="802cb-140">Step 3 - Test the runbook</span><span class="sxs-lookup"><span data-stu-id="802cb-140">Step 3 - Test the runbook</span></span>
<span data-ttu-id="802cb-141">Before you publish the runbook to make it available in production, you want to test it to make sure that it works properly.</span><span class="sxs-lookup"><span data-stu-id="802cb-141">Before you publish the runbook to make it available in production, you want to test it to make sure that it works properly.</span></span> <span data-ttu-id="802cb-142">When you test a runbook, you run its **Draft** version and view its output interactively.</span><span class="sxs-lookup"><span data-stu-id="802cb-142">When you test a runbook, you run its **Draft** version and view its output interactively.</span></span>

1. <span data-ttu-id="802cb-143">Click **Test pane** to open the Test pane.</span><span class="sxs-lookup"><span data-stu-id="802cb-143">Click **Test pane** to open the Test pane.</span></span>
2. <span data-ttu-id="802cb-144">Click **Start** to start the test.</span><span class="sxs-lookup"><span data-stu-id="802cb-144">Click **Start** to start the test.</span></span> <span data-ttu-id="802cb-145">This should be the only enabled option.</span><span class="sxs-lookup"><span data-stu-id="802cb-145">This should be the only enabled option.</span></span>
3. <span data-ttu-id="802cb-146">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span><span class="sxs-lookup"><span data-stu-id="802cb-146">A [runbook job](automation-runbook-execution.md) is created and its status displayed.</span></span>

   <span data-ttu-id="802cb-147">The job status starts as *Queued* indicating that it is waiting for a runbook worker in the cloud to come available.</span><span class="sxs-lookup"><span data-stu-id="802cb-147">The job status starts as *Queued* indicating that it is waiting for a runbook worker in the cloud to come available.</span></span> <span data-ttu-id="802cb-148">It moves to *Starting* when a worker claims the job, and then *Running* when the runbook actually starts running.</span><span class="sxs-lookup"><span data-stu-id="802cb-148">It moves to *Starting* when a worker claims the job, and then *Running* when the runbook actually starts running.</span></span>  

1. <span data-ttu-id="802cb-149">When the runbook job completes, its output is displayed.</span><span class="sxs-lookup"><span data-stu-id="802cb-149">When the runbook job completes, its output is displayed.</span></span> <span data-ttu-id="802cb-150">In your case, you should see *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="802cb-150">In your case, you should see *Hello World*.</span></span><br><br> <span data-ttu-id="802cb-151">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span><span class="sxs-lookup"><span data-stu-id="802cb-151">![Test Pane Output](media/automation-first-runbook-textual-powershell/automation-testpane-output.png)</span></span>  
2. <span data-ttu-id="802cb-152">Close the Test pane to return to the canvas.</span><span class="sxs-lookup"><span data-stu-id="802cb-152">Close the Test pane to return to the canvas.</span></span>

## <a name="step-4---publish-and-start-the-runbook"></a><span data-ttu-id="802cb-153">Step 4 - Publish and start the runbook</span><span class="sxs-lookup"><span data-stu-id="802cb-153">Step 4 - Publish and start the runbook</span></span>
<span data-ttu-id="802cb-154">The runbook that you created is still in Draft mode.</span><span class="sxs-lookup"><span data-stu-id="802cb-154">The runbook that you created is still in Draft mode.</span></span> <span data-ttu-id="802cb-155">you need to publish it before you can run it in production.</span><span class="sxs-lookup"><span data-stu-id="802cb-155">you need to publish it before you can run it in production.</span></span>  <span data-ttu-id="802cb-156">When you publish a runbook, you overwrite the existing Published version with the Draft version.</span><span class="sxs-lookup"><span data-stu-id="802cb-156">When you publish a runbook, you overwrite the existing Published version with the Draft version.</span></span> <span data-ttu-id="802cb-157">In your case, you don't have a Published version yet because you just created the runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-157">In your case, you don't have a Published version yet because you just created the runbook.</span></span>

1. <span data-ttu-id="802cb-158">Click **Publish** to publish the runbook and then **Yes** when prompted.</span><span class="sxs-lookup"><span data-stu-id="802cb-158">Click **Publish** to publish the runbook and then **Yes** when prompted.</span></span>
2. <span data-ttu-id="802cb-159">If you scroll left to view the runbook in the **Runbooks** pane now, it shows an **Authoring Status** of **Published**.</span><span class="sxs-lookup"><span data-stu-id="802cb-159">If you scroll left to view the runbook in the **Runbooks** pane now, it shows an **Authoring Status** of **Published**.</span></span>
3. <span data-ttu-id="802cb-160">Scroll back to the right to view the pane for **MyFirstRunbook-PowerShell**.</span><span class="sxs-lookup"><span data-stu-id="802cb-160">Scroll back to the right to view the pane for **MyFirstRunbook-PowerShell**.</span></span>  
   <span data-ttu-id="802cb-161">The options across the top allow us to start the runbook, view the runbook, schedule it to start at some time in the future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span><span class="sxs-lookup"><span data-stu-id="802cb-161">The options across the top allow us to start the runbook, view the runbook, schedule it to start at some time in the future, or create a [webhook](automation-webhooks.md) so it can be started through an HTTP call.</span></span>
4. <span data-ttu-id="802cb-162">You want to start the runbook, so click **Start** and then click **Ok** when the Start Runbook page opens.</span><span class="sxs-lookup"><span data-stu-id="802cb-162">You want to start the runbook, so click **Start** and then click **Ok** when the Start Runbook page opens.</span></span>
5. <span data-ttu-id="802cb-163">A job page is opened for the runbook job that you created.</span><span class="sxs-lookup"><span data-stu-id="802cb-163">A job page is opened for the runbook job that you created.</span></span> <span data-ttu-id="802cb-164">You can close this pane, but in this case you leave it open so you can watch the job's progress.</span><span class="sxs-lookup"><span data-stu-id="802cb-164">You can close this pane, but in this case you leave it open so you can watch the job's progress.</span></span>
6. <span data-ttu-id="802cb-165">The job status is shown in **Job Summary** and matches the statuses that you saw when you tested the runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-165">The job status is shown in **Job Summary** and matches the statuses that you saw when you tested the runbook.</span></span><br><br> <span data-ttu-id="802cb-166">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span><span class="sxs-lookup"><span data-stu-id="802cb-166">![Job Summary](media/automation-first-runbook-textual-powershell/job-pane-status-blade-jobsummary.png)</span></span><br>  
7. <span data-ttu-id="802cb-167">Once the runbook status shows *Completed*, under **Overview** click **Output**.</span><span class="sxs-lookup"><span data-stu-id="802cb-167">Once the runbook status shows *Completed*, under **Overview** click **Output**.</span></span> <span data-ttu-id="802cb-168">The Output pane is opened, and you can see your *Hello World*.</span><span class="sxs-lookup"><span data-stu-id="802cb-168">The Output pane is opened, and you can see your *Hello World*.</span></span><br><br> <span data-ttu-id="802cb-169">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span><span class="sxs-lookup"><span data-stu-id="802cb-169">![Job Output](media/automation-first-runbook-textual-powershell/job-pane-status-blade-outputtile.png)</span></span><br> 
8. <span data-ttu-id="802cb-170">Close the Output page.</span><span class="sxs-lookup"><span data-stu-id="802cb-170">Close the Output page.</span></span>
9. <span data-ttu-id="802cb-171">Click **All Logs** to open the Streams pane for the runbook job.</span><span class="sxs-lookup"><span data-stu-id="802cb-171">Click **All Logs** to open the Streams pane for the runbook job.</span></span> <span data-ttu-id="802cb-172">You should only see *Hello World* in the output stream, but this can show other streams for a runbook job such as Verbose and Error if the runbook writes to them.</span><span class="sxs-lookup"><span data-stu-id="802cb-172">You should only see *Hello World* in the output stream, but this can show other streams for a runbook job such as Verbose and Error if the runbook writes to them.</span></span><br><br> <span data-ttu-id="802cb-173">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span><span class="sxs-lookup"><span data-stu-id="802cb-173">![All Logs](media/automation-first-runbook-textual-powershell/job-pane-status-blade-alllogstile.png)</span></span><br>   
10. <span data-ttu-id="802cb-174">Close the Streams page and the Job page to return to the MyFirstRunbook-PowerShell page.</span><span class="sxs-lookup"><span data-stu-id="802cb-174">Close the Streams page and the Job page to return to the MyFirstRunbook-PowerShell page.</span></span>
11. <span data-ttu-id="802cb-175">Under **Details**, click **Jobs** to open the Jobs pane for this runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-175">Under **Details**, click **Jobs** to open the Jobs pane for this runbook.</span></span> <span data-ttu-id="802cb-176">This lists all of the jobs created by this runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-176">This lists all of the jobs created by this runbook.</span></span> <span data-ttu-id="802cb-177">You should only see one job listed since you only ran the job once.</span><span class="sxs-lookup"><span data-stu-id="802cb-177">You should only see one job listed since you only ran the job once.</span></span><br><br> <span data-ttu-id="802cb-178">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span><span class="sxs-lookup"><span data-stu-id="802cb-178">![Job List](media/automation-first-runbook-textual-powershell/runbook-control-job-tile.png)</span></span>  
12. <span data-ttu-id="802cb-179">You can click this job to open the same Job pane that you viewed when you started the runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-179">You can click this job to open the same Job pane that you viewed when you started the runbook.</span></span> <span data-ttu-id="802cb-180">This allows you to go back in time and view the details of any job that was created for a particular runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-180">This allows you to go back in time and view the details of any job that was created for a particular runbook.</span></span>

## <a name="step-5---add-authentication-to-manage-azure-resources"></a><span data-ttu-id="802cb-181">Step 5 - Add authentication to manage Azure resources</span><span class="sxs-lookup"><span data-stu-id="802cb-181">Step 5 - Add authentication to manage Azure resources</span></span>
<span data-ttu-id="802cb-182">You've tested and published your runbook, but so far it doesn't do anything useful.</span><span class="sxs-lookup"><span data-stu-id="802cb-182">You've tested and published your runbook, but so far it doesn't do anything useful.</span></span> <span data-ttu-id="802cb-183">You want to have it manage Azure resources.</span><span class="sxs-lookup"><span data-stu-id="802cb-183">You want to have it manage Azure resources.</span></span> <span data-ttu-id="802cb-184">It is not able to do that though unless You have it authenticate using the credentials that are referred to in the [prerequisites](#prerequisites).</span><span class="sxs-lookup"><span data-stu-id="802cb-184">It is not able to do that though unless You have it authenticate using the credentials that are referred to in the [prerequisites](#prerequisites).</span></span> <span data-ttu-id="802cb-185">You do that with the **Connect-AzureRmAccount** cmdlet.</span><span class="sxs-lookup"><span data-stu-id="802cb-185">You do that with the **Connect-AzureRmAccount** cmdlet.</span></span>

1. <span data-ttu-id="802cb-186">Open the textual editor by clicking **Edit** on the MyFirstRunbook-PowerShell page.</span><span class="sxs-lookup"><span data-stu-id="802cb-186">Open the textual editor by clicking **Edit** on the MyFirstRunbook-PowerShell page.</span></span>
2. <span data-ttu-id="802cb-187">You don't need the **Write-Output** line anymore, so go ahead and delete it.</span><span class="sxs-lookup"><span data-stu-id="802cb-187">You don't need the **Write-Output** line anymore, so go ahead and delete it.</span></span>
3. <span data-ttu-id="802cb-188">Type or copy and paste the following code that handles the authentication with your Automation Run As account:</span><span class="sxs-lookup"><span data-stu-id="802cb-188">Type or copy and paste the following code that handles the authentication with your Automation Run As account:</span></span>

   ```powershell
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Connect-AzureRmAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationId $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   ```

   > [!IMPORTANT]
   > **Add-AzureRmAccount** and **Login-AzureRmAccount** are now  aliases for **Connect-AzureRMAccount**. If the **Connect-AzureRMAccount** cmdlet does not exist, you can use **Add-AzureRmAccount** or **Login-AzureRmAccount**, or you can update your modules in your Automation Account to the latest versions.

4. <span data-ttu-id="802cb-191">Click **Test pane** so that you can test the runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-191">Click **Test pane** so that you can test the runbook.</span></span>
5. <span data-ttu-id="802cb-192">Click **Start** to start the test.</span><span class="sxs-lookup"><span data-stu-id="802cb-192">Click **Start** to start the test.</span></span> <span data-ttu-id="802cb-193">Once it completes, you should receive output similar to the following, displaying basic information from your account.</span><span class="sxs-lookup"><span data-stu-id="802cb-193">Once it completes, you should receive output similar to the following, displaying basic information from your account.</span></span> <span data-ttu-id="802cb-194">This confirms that the credential is valid.</span><span class="sxs-lookup"><span data-stu-id="802cb-194">This confirms that the credential is valid.</span></span><br><br> <span data-ttu-id="802cb-195">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span><span class="sxs-lookup"><span data-stu-id="802cb-195">![Authenticate](media/automation-first-runbook-textual-powershell/runbook-auth-output.png)</span></span>

## <a name="step-6---add-code-to-start-a-virtual-machine"></a><span data-ttu-id="802cb-196">Step 6 - Add code to start a virtual machine</span><span class="sxs-lookup"><span data-stu-id="802cb-196">Step 6 - Add code to start a virtual machine</span></span>
<span data-ttu-id="802cb-197">Now that your runbook is authenticating to your Azure subscription, you can manage resources.</span><span class="sxs-lookup"><span data-stu-id="802cb-197">Now that your runbook is authenticating to your Azure subscription, you can manage resources.</span></span> <span data-ttu-id="802cb-198">You add a command to start a virtual machine.</span><span class="sxs-lookup"><span data-stu-id="802cb-198">You add a command to start a virtual machine.</span></span> <span data-ttu-id="802cb-199">You can pick any virtual machine in your Azure subscription, and for now you hardcode that name in the runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-199">You can pick any virtual machine in your Azure subscription, and for now you hardcode that name in the runbook.</span></span>

1. <span data-ttu-id="802cb-200">After *Connect-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing the name and Resource Group name of the virtual machine to start.</span><span class="sxs-lookup"><span data-stu-id="802cb-200">After *Connect-AzureRmAccount*, type *Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'NameofResourceGroup'* providing the name and Resource Group name of the virtual machine to start.</span></span>  
   
   ```
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Connect-AzureRmAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name 'VMName' -ResourceGroupName 'ResourceGroupName'
   ```
   <br>
2. <span data-ttu-id="802cb-201">Save the runbook and then click **Test pane** so that you can test it.</span><span class="sxs-lookup"><span data-stu-id="802cb-201">Save the runbook and then click **Test pane** so that you can test it.</span></span>
3. <span data-ttu-id="802cb-202">Click **Start** to start the test.</span><span class="sxs-lookup"><span data-stu-id="802cb-202">Click **Start** to start the test.</span></span> <span data-ttu-id="802cb-203">Once it completes, check that the virtual machine was started.</span><span class="sxs-lookup"><span data-stu-id="802cb-203">Once it completes, check that the virtual machine was started.</span></span>

## <a name="step-7---add-an-input-parameter-to-the-runbook"></a><span data-ttu-id="802cb-204">Step 7 - Add an input parameter to the runbook</span><span class="sxs-lookup"><span data-stu-id="802cb-204">Step 7 - Add an input parameter to the runbook</span></span>
<span data-ttu-id="802cb-205">Your runbook currently starts the virtual machine that you hardcoded in the runbook, but it would be more useful if you specify the virtual machine when the runbook is started.</span><span class="sxs-lookup"><span data-stu-id="802cb-205">Your runbook currently starts the virtual machine that you hardcoded in the runbook, but it would be more useful if you specify the virtual machine when the runbook is started.</span></span> <span data-ttu-id="802cb-206">You add input parameters to the runbook to provide that functionality.</span><span class="sxs-lookup"><span data-stu-id="802cb-206">You add input parameters to the runbook to provide that functionality.</span></span>

1. <span data-ttu-id="802cb-207">Add parameters for *VMName* and *ResourceGroupName* to the runbook and use these variables with the **Start-AzureRmVM** cmdlet as in the following example.</span><span class="sxs-lookup"><span data-stu-id="802cb-207">Add parameters for *VMName* and *ResourceGroupName* to the runbook and use these variables with the **Start-AzureRmVM** cmdlet as in the following example.</span></span>

   ```
   Param(
    [string]$VMName,
    [string]$ResourceGroupName
   )
   $Conn = Get-AutomationConnection -Name AzureRunAsConnection
   Connect-AzureRmAccount -ServicePrincipal -Tenant $Conn.TenantID `
   -ApplicationID $Conn.ApplicationID -CertificateThumbprint $Conn.CertificateThumbprint
   Start-AzureRmVM -Name $VMName -ResourceGroupName $ResourceGroupName
   ```
   <br>
1. <span data-ttu-id="802cb-208">Save the runbook and open the Test pane.</span><span class="sxs-lookup"><span data-stu-id="802cb-208">Save the runbook and open the Test pane.</span></span> <span data-ttu-id="802cb-209">You can now provide values for the two input variables that are used in the test.</span><span class="sxs-lookup"><span data-stu-id="802cb-209">You can now provide values for the two input variables that are used in the test.</span></span>
2. <span data-ttu-id="802cb-210">Close the Test pane.</span><span class="sxs-lookup"><span data-stu-id="802cb-210">Close the Test pane.</span></span>
3. <span data-ttu-id="802cb-211">Click **Publish** to publish the new version of the runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-211">Click **Publish** to publish the new version of the runbook.</span></span>
4. <span data-ttu-id="802cb-212">Stop the virtual machine that you started in the previous step.</span><span class="sxs-lookup"><span data-stu-id="802cb-212">Stop the virtual machine that you started in the previous step.</span></span>
5. <span data-ttu-id="802cb-213">Click **OK** to start the runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-213">Click **OK** to start the runbook.</span></span> <span data-ttu-id="802cb-214">Type in the **VMName** and **ResourceGroupName** for the virtual machine that you're going to start.</span><span class="sxs-lookup"><span data-stu-id="802cb-214">Type in the **VMName** and **ResourceGroupName** for the virtual machine that you're going to start.</span></span><br><br> <span data-ttu-id="802cb-215">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span><span class="sxs-lookup"><span data-stu-id="802cb-215">![Pass Parameter](media/automation-first-runbook-textual-powershell/automation-pass-params.png)</span></span><br>  
6. <span data-ttu-id="802cb-216">When the runbook completes, check that the virtual machine was started.</span><span class="sxs-lookup"><span data-stu-id="802cb-216">When the runbook completes, check that the virtual machine was started.</span></span>

## <a name="differences-from-powershell-workflow"></a><span data-ttu-id="802cb-217">Differences from PowerShell Workflow</span><span class="sxs-lookup"><span data-stu-id="802cb-217">Differences from PowerShell Workflow</span></span>
<span data-ttu-id="802cb-218">PowerShell runbooks have the same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span><span class="sxs-lookup"><span data-stu-id="802cb-218">PowerShell runbooks have the same lifecycle, capabilities, and management as PowerShell Workflow runbooks but there are some differences and limitations:</span></span>

1. <span data-ttu-id="802cb-219">PowerShell runbooks run fast compared to PowerShell Workflow runbooks as they don’t have compilation step.</span><span class="sxs-lookup"><span data-stu-id="802cb-219">PowerShell runbooks run fast compared to PowerShell Workflow runbooks as they don’t have compilation step.</span></span>
2. <span data-ttu-id="802cb-220">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in the runbook whereas PowerShell runbooks can only resume from the beginning.</span><span class="sxs-lookup"><span data-stu-id="802cb-220">PowerShell Workflow runbooks support checkpoints, using checkpoints, PowerShell Workflow runbooks can resume from any point in the runbook whereas PowerShell runbooks can only resume from the beginning.</span></span>
3. <span data-ttu-id="802cb-221">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span><span class="sxs-lookup"><span data-stu-id="802cb-221">PowerShell Workflow runbooks support parallel and serial execution whereas PowerShell runbooks can only execute commands serially.</span></span>
4. <span data-ttu-id="802cb-222">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span><span class="sxs-lookup"><span data-stu-id="802cb-222">In a PowerShell Workflow runbook, an activity, a command, or a script block can have its own runspace whereas in a PowerShell runbook, everything in a script runs in a single runspace.</span></span> <span data-ttu-id="802cb-223">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span><span class="sxs-lookup"><span data-stu-id="802cb-223">There are also some [syntactic differences](https://technet.microsoft.com/magazine/dn151046.aspx) between a native PowerShell runbook and a PowerShell Workflow runbook.</span></span>

## <a name="next-steps"></a><span data-ttu-id="802cb-224">Next steps</span><span class="sxs-lookup"><span data-stu-id="802cb-224">Next steps</span></span>
* <span data-ttu-id="802cb-225">To get started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span><span class="sxs-lookup"><span data-stu-id="802cb-225">To get started with Graphical runbooks, see [My first graphical runbook](automation-first-runbook-graphical.md)</span></span>
* <span data-ttu-id="802cb-226">To get started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span><span class="sxs-lookup"><span data-stu-id="802cb-226">To get started with PowerShell workflow runbooks, see [My first PowerShell workflow runbook](automation-first-runbook-textual.md)</span></span>
* <span data-ttu-id="802cb-227">To know more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span><span class="sxs-lookup"><span data-stu-id="802cb-227">To know more about runbook types, their advantages and limitations, see [Azure Automation runbook types](automation-runbook-types.md)</span></span>
* <span data-ttu-id="802cb-228">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span><span class="sxs-lookup"><span data-stu-id="802cb-228">For more information on PowerShell script support feature, see [Native PowerShell script support in Azure Automation](https://azure.microsoft.com/blog/announcing-powershell-script-support-azure-automation-2/)</span></span>

