---
title: Planning your VM backup infrastructure in Azure
description: Important considerations when planning to back up virtual machines in Azure
services: backup
author: markgalioto
manager: carmonm
keywords: backup vms, backup virtual machines
ms.service: backup
ms.topic: conceptual
ms.date: 8/29/2018
ms.author: markgal
ms.openlocfilehash: 9e2ef16cffb044409b6f7f8e7785010097bcda87
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44784971"
---
# <a name="plan-your-vm-backup-infrastructure-in-azure"></a><span data-ttu-id="b689d-104">Plan your VM backup infrastructure in Azure</span><span class="sxs-lookup"><span data-stu-id="b689d-104">Plan your VM backup infrastructure in Azure</span></span>
<span data-ttu-id="b689d-105">This article provides performance and resource suggestions to help you plan your VM backup infrastructure.</span><span class="sxs-lookup"><span data-stu-id="b689d-105">This article provides performance and resource suggestions to help you plan your VM backup infrastructure.</span></span> <span data-ttu-id="b689d-106">It also defines key aspects of the Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span><span class="sxs-lookup"><span data-stu-id="b689d-106">It also defines key aspects of the Backup service; these aspects can be critical in determining your architecture, capacity planning, and scheduling.</span></span> <span data-ttu-id="b689d-107">If you've [prepared your environment](backup-azure-arm-vms-prepare.md), planning is the next step before you begin [to back up VMs](backup-azure-arm-vms.md).</span><span class="sxs-lookup"><span data-stu-id="b689d-107">If you've [prepared your environment](backup-azure-arm-vms-prepare.md), planning is the next step before you begin [to back up VMs](backup-azure-arm-vms.md).</span></span> <span data-ttu-id="b689d-108">If you need more information about Azure virtual machines, see the [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="b689d-108">If you need more information about Azure virtual machines, see the [Virtual Machines documentation](https://azure.microsoft.com/documentation/services/virtual-machines/).</span></span> 

> [!NOTE]
> <span data-ttu-id="b689d-109">This article is for use with managed and unmanaged disks.</span><span class="sxs-lookup"><span data-stu-id="b689d-109">This article is for use with managed and unmanaged disks.</span></span> <span data-ttu-id="b689d-110">If you use unmanaged disks, there are storage account recommendations.</span><span class="sxs-lookup"><span data-stu-id="b689d-110">If you use unmanaged disks, there are storage account recommendations.</span></span> <span data-ttu-id="b689d-111">If you use [Azure Managed Disks](../virtual-machines/windows/managed-disks-overview.md), you don't have to worry about performance or resource utilization issues.</span><span class="sxs-lookup"><span data-stu-id="b689d-111">If you use [Azure Managed Disks](../virtual-machines/windows/managed-disks-overview.md), you don't have to worry about performance or resource utilization issues.</span></span> <span data-ttu-id="b689d-112">Azure optimizes storage utilization for you.</span><span class="sxs-lookup"><span data-stu-id="b689d-112">Azure optimizes storage utilization for you.</span></span>
>

## <a name="how-does-azure-back-up-virtual-machines"></a><span data-ttu-id="b689d-113">How does Azure back up virtual machines?</span><span class="sxs-lookup"><span data-stu-id="b689d-113">How does Azure back up virtual machines?</span></span>
<span data-ttu-id="b689d-114">When the Azure Backup service initiates a backup job at the scheduled time, the service triggers the backup extension to take a point-in-time snapshot.</span><span class="sxs-lookup"><span data-stu-id="b689d-114">When the Azure Backup service initiates a backup job at the scheduled time, the service triggers the backup extension to take a point-in-time snapshot.</span></span> <span data-ttu-id="b689d-115">The Azure Backup service uses the _VMSnapshot_ extension in Windows, and the _VMSnapshotLinux_ extension in Linux.</span><span class="sxs-lookup"><span data-stu-id="b689d-115">The Azure Backup service uses the _VMSnapshot_ extension in Windows, and the _VMSnapshotLinux_ extension in Linux.</span></span> <span data-ttu-id="b689d-116">The extension is installed during the first VM backup.</span><span class="sxs-lookup"><span data-stu-id="b689d-116">The extension is installed during the first VM backup.</span></span> <span data-ttu-id="b689d-117">To install the extension, the VM must be running.</span><span class="sxs-lookup"><span data-stu-id="b689d-117">To install the extension, the VM must be running.</span></span> <span data-ttu-id="b689d-118">If the VM is not running, the Backup service takes a snapshot of the underlying storage (since no application writes occur while the VM is stopped).</span><span class="sxs-lookup"><span data-stu-id="b689d-118">If the VM is not running, the Backup service takes a snapshot of the underlying storage (since no application writes occur while the VM is stopped).</span></span>

<span data-ttu-id="b689d-119">When taking a snapshot of Windows VMs, the Backup service coordinates with the Volume Shadow Copy Service (VSS) to get a consistent snapshot of the virtual machine's disks.</span><span class="sxs-lookup"><span data-stu-id="b689d-119">When taking a snapshot of Windows VMs, the Backup service coordinates with the Volume Shadow Copy Service (VSS) to get a consistent snapshot of the virtual machine's disks.</span></span> <span data-ttu-id="b689d-120">If you're backing up Linux VMs, you can write your own custom scripts to ensure consistency when taking a VM snapshot.</span><span class="sxs-lookup"><span data-stu-id="b689d-120">If you're backing up Linux VMs, you can write your own custom scripts to ensure consistency when taking a VM snapshot.</span></span> <span data-ttu-id="b689d-121">Details on invoking these scripts are provided later in this article.</span><span class="sxs-lookup"><span data-stu-id="b689d-121">Details on invoking these scripts are provided later in this article.</span></span>

<span data-ttu-id="b689d-122">Once the Azure Backup service takes the snapshot, the data is transferred to the vault.</span><span class="sxs-lookup"><span data-stu-id="b689d-122">Once the Azure Backup service takes the snapshot, the data is transferred to the vault.</span></span> <span data-ttu-id="b689d-123">To maximize efficiency, the service identifies and transfers only the blocks of data that have changed since the previous backup.</span><span class="sxs-lookup"><span data-stu-id="b689d-123">To maximize efficiency, the service identifies and transfers only the blocks of data that have changed since the previous backup.</span></span>

![Azure virtual machine backup architecture](./media/backup-azure-vms-introduction/vmbackup-architecture.png)

<span data-ttu-id="b689d-125">When the data transfer is complete, the snapshot is removed and a recovery point is created.</span><span class="sxs-lookup"><span data-stu-id="b689d-125">When the data transfer is complete, the snapshot is removed and a recovery point is created.</span></span>

> [!NOTE]
> 1. <span data-ttu-id="b689d-126">During the backup process, Azure Backup doesn't include the temporary disk attached to the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="b689d-126">During the backup process, Azure Backup doesn't include the temporary disk attached to the virtual machine.</span></span> <span data-ttu-id="b689d-127">For more information, see the blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span><span class="sxs-lookup"><span data-stu-id="b689d-127">For more information, see the blog on [temporary storage](https://blogs.msdn.microsoft.com/mast/2013/12/06/understanding-the-temporary-drive-on-windows-azure-virtual-machines/).</span></span>
> 2. <span data-ttu-id="b689d-128">Azure Backup takes a storage-level snapshot and transfers that snapshot to vault.</span><span class="sxs-lookup"><span data-stu-id="b689d-128">Azure Backup takes a storage-level snapshot and transfers that snapshot to vault.</span></span> <span data-ttu-id="b689d-129">Don't change the storage account keys until the backup job finishes.</span><span class="sxs-lookup"><span data-stu-id="b689d-129">Don't change the storage account keys until the backup job finishes.</span></span>
>

### <a name="data-consistency"></a><span data-ttu-id="b689d-130">Data consistency</span><span class="sxs-lookup"><span data-stu-id="b689d-130">Data consistency</span></span>
<span data-ttu-id="b689d-131">Backing up and restoring business critical data is complicated by the fact that business critical data must be backed up while the applications that produce the data are running.</span><span class="sxs-lookup"><span data-stu-id="b689d-131">Backing up and restoring business critical data is complicated by the fact that business critical data must be backed up while the applications that produce the data are running.</span></span> <span data-ttu-id="b689d-132">To address this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span><span class="sxs-lookup"><span data-stu-id="b689d-132">To address this, Azure Backup supports application-consistent backups for both Windows and Linux VMs</span></span>
#### <a name="windows-vm"></a><span data-ttu-id="b689d-133">Windows VM</span><span class="sxs-lookup"><span data-stu-id="b689d-133">Windows VM</span></span>
<span data-ttu-id="b689d-134">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span><span class="sxs-lookup"><span data-stu-id="b689d-134">Azure Backup takes VSS full backups on Windows VMs (read more about [VSS full backup](http://blogs.technet.com/b/filecab/archive/2008/05/21/what-is-the-difference-between-vss-full-backup-and-vss-copy-backup-in-windows-server-2008.aspx)).</span></span> <span data-ttu-id="b689d-135">To enable VSS copy backups, the following registry key needs to be set on the VM.</span><span class="sxs-lookup"><span data-stu-id="b689d-135">To enable VSS copy backups, the following registry key needs to be set on the VM.</span></span>

```
[HKEY_LOCAL_MACHINE\SOFTWARE\MICROSOFT\BCDRAGENT]
"USEVSSCOPYBACKUP"="TRUE"
```

#### <a name="linux-vms"></a><span data-ttu-id="b689d-136">Linux VMs</span><span class="sxs-lookup"><span data-stu-id="b689d-136">Linux VMs</span></span>

<span data-ttu-id="b689d-137">Azure Backup provides a scripting framework for controlling the backup workflow and environment.</span><span class="sxs-lookup"><span data-stu-id="b689d-137">Azure Backup provides a scripting framework for controlling the backup workflow and environment.</span></span> <span data-ttu-id="b689d-138">To ensure application-consistent Linux VM backups, use the scripting framework to create custom pre-scripts and post-scripts.</span><span class="sxs-lookup"><span data-stu-id="b689d-138">To ensure application-consistent Linux VM backups, use the scripting framework to create custom pre-scripts and post-scripts.</span></span> <span data-ttu-id="b689d-139">Invoke the pre-script before taking the VM snapshot, and then invoke the post-script once the VM snapshot job completes.</span><span class="sxs-lookup"><span data-stu-id="b689d-139">Invoke the pre-script before taking the VM snapshot, and then invoke the post-script once the VM snapshot job completes.</span></span> <span data-ttu-id="b689d-140">For more information, see the article [application consistent Linux VM backups](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="b689d-140">For more information, see the article [application consistent Linux VM backups](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span>

> [!NOTE]
> <span data-ttu-id="b689d-141">Azure Backup only invokes the customer-written pre- and post-scripts.</span><span class="sxs-lookup"><span data-stu-id="b689d-141">Azure Backup only invokes the customer-written pre- and post-scripts.</span></span> <span data-ttu-id="b689d-142">If the pre-script and post-scripts execute successfully, Azure Backup marks the recovery point as application consistent.</span><span class="sxs-lookup"><span data-stu-id="b689d-142">If the pre-script and post-scripts execute successfully, Azure Backup marks the recovery point as application consistent.</span></span> <span data-ttu-id="b689d-143">However, the customer is ultimately responsible for the application consistency when using custom scripts.</span><span class="sxs-lookup"><span data-stu-id="b689d-143">However, the customer is ultimately responsible for the application consistency when using custom scripts.</span></span>
>

<span data-ttu-id="b689d-144">The following table explains the types of consistency, and the conditions when they occur.</span><span class="sxs-lookup"><span data-stu-id="b689d-144">The following table explains the types of consistency, and the conditions when they occur.</span></span>

| <span data-ttu-id="b689d-145">Consistency</span><span class="sxs-lookup"><span data-stu-id="b689d-145">Consistency</span></span> | <span data-ttu-id="b689d-146">VSS-based</span><span class="sxs-lookup"><span data-stu-id="b689d-146">VSS-based</span></span> | <span data-ttu-id="b689d-147">Explanation and details</span><span class="sxs-lookup"><span data-stu-id="b689d-147">Explanation and details</span></span> |
| --- | --- | --- |
| <span data-ttu-id="b689d-148">Application consistency</span><span class="sxs-lookup"><span data-stu-id="b689d-148">Application consistency</span></span> |<span data-ttu-id="b689d-149">Yes for Windows</span><span class="sxs-lookup"><span data-stu-id="b689d-149">Yes for Windows</span></span>|<span data-ttu-id="b689d-150">Application consistency is ideal for workloads as it ensures that:</span><span class="sxs-lookup"><span data-stu-id="b689d-150">Application consistency is ideal for workloads as it ensures that:</span></span><ol><li> <span data-ttu-id="b689d-151">The VM *boots up*.</span><span class="sxs-lookup"><span data-stu-id="b689d-151">The VM *boots up*.</span></span> <li><span data-ttu-id="b689d-152">There is *no corruption*.</span><span class="sxs-lookup"><span data-stu-id="b689d-152">There is *no corruption*.</span></span> <li><span data-ttu-id="b689d-153">There is *no data loss*.</span><span class="sxs-lookup"><span data-stu-id="b689d-153">There is *no data loss*.</span></span><li> <span data-ttu-id="b689d-154">The data is consistent to the application that uses the data, by involving the application at the time of backup--using VSS or pre/post script.</span><span class="sxs-lookup"><span data-stu-id="b689d-154">The data is consistent to the application that uses the data, by involving the application at the time of backup--using VSS or pre/post script.</span></span></ol> <li><span data-ttu-id="b689d-155">*Windows VMs*- Most Microsoft workloads have VSS writers that execute workload-specific actions related to data consistency.</span><span class="sxs-lookup"><span data-stu-id="b689d-155">*Windows VMs*- Most Microsoft workloads have VSS writers that execute workload-specific actions related to data consistency.</span></span> <span data-ttu-id="b689d-156">For example, the SQL Server VSS writer ensures the writes to the transaction log file and the database, are done correctly.</span><span class="sxs-lookup"><span data-stu-id="b689d-156">For example, the SQL Server VSS writer ensures the writes to the transaction log file and the database, are done correctly.</span></span> <span data-ttu-id="b689d-157">For IaaS Windows VM backups, to create an application-consistent recovery point, the backup extension must invoke the VSS workflow, and complete it before taking the VM snapshot.</span><span class="sxs-lookup"><span data-stu-id="b689d-157">For IaaS Windows VM backups, to create an application-consistent recovery point, the backup extension must invoke the VSS workflow, and complete it before taking the VM snapshot.</span></span> <span data-ttu-id="b689d-158">For the Azure VM snapshot to be accurate, the VSS writers of all Azure VM applications must complete as well.</span><span class="sxs-lookup"><span data-stu-id="b689d-158">For the Azure VM snapshot to be accurate, the VSS writers of all Azure VM applications must complete as well.</span></span> <span data-ttu-id="b689d-159">(Learn the [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into the details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span><span class="sxs-lookup"><span data-stu-id="b689d-159">(Learn the [basics of VSS](http://blogs.technet.com/b/josebda/archive/2007/10/10/the-basics-of-the-volume-shadow-copy-service-vss.aspx) and dive deep into the details of [how it works](https://technet.microsoft.com/library/cc785914%28v=ws.10%29.aspx)).</span></span> </li> <li> <span data-ttu-id="b689d-160">*Linux VMs*- Customers can execute [custom pre-script and post-script to ensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span><span class="sxs-lookup"><span data-stu-id="b689d-160">*Linux VMs*- Customers can execute [custom pre-script and post-script to ensure application consistency](https://docs.microsoft.com/azure/backup/backup-azure-linux-app-consistent).</span></span> </li> |
| <span data-ttu-id="b689d-161">File-system consistency</span><span class="sxs-lookup"><span data-stu-id="b689d-161">File-system consistency</span></span> |<span data-ttu-id="b689d-162">Yes - for Windows-based computers</span><span class="sxs-lookup"><span data-stu-id="b689d-162">Yes - for Windows-based computers</span></span> |<span data-ttu-id="b689d-163">There are two scenarios where the recovery point can be *file-system consistent*:</span><span class="sxs-lookup"><span data-stu-id="b689d-163">There are two scenarios where the recovery point can be *file-system consistent*:</span></span><ul><li><span data-ttu-id="b689d-164">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span><span class="sxs-lookup"><span data-stu-id="b689d-164">Backups of Linux VMs in Azure, without pre-script/post-script or if pre-script/post-script failed.</span></span> <li><span data-ttu-id="b689d-165">VSS failure during backup for Windows VMs in Azure.</span><span class="sxs-lookup"><span data-stu-id="b689d-165">VSS failure during backup for Windows VMs in Azure.</span></span></li></ul> <span data-ttu-id="b689d-166">In both these cases, the best that can be done is to ensure that:</span><span class="sxs-lookup"><span data-stu-id="b689d-166">In both these cases, the best that can be done is to ensure that:</span></span> <ol><li> <span data-ttu-id="b689d-167">The VM *boots up*.</span><span class="sxs-lookup"><span data-stu-id="b689d-167">The VM *boots up*.</span></span> <li><span data-ttu-id="b689d-168">There is *no corruption*.</span><span class="sxs-lookup"><span data-stu-id="b689d-168">There is *no corruption*.</span></span><li><span data-ttu-id="b689d-169">There is *no data loss*.</span><span class="sxs-lookup"><span data-stu-id="b689d-169">There is *no data loss*.</span></span></ol> <span data-ttu-id="b689d-170">Applications need to implement their own "fix-up" mechanism on the restored data.</span><span class="sxs-lookup"><span data-stu-id="b689d-170">Applications need to implement their own "fix-up" mechanism on the restored data.</span></span> |
| <span data-ttu-id="b689d-171">Crash consistency</span><span class="sxs-lookup"><span data-stu-id="b689d-171">Crash consistency</span></span> |<span data-ttu-id="b689d-172">No</span><span class="sxs-lookup"><span data-stu-id="b689d-172">No</span></span> |<span data-ttu-id="b689d-173">This situation is equivalent to a virtual machine experiencing a "crash" (through either a soft or hard reset).</span><span class="sxs-lookup"><span data-stu-id="b689d-173">This situation is equivalent to a virtual machine experiencing a "crash" (through either a soft or hard reset).</span></span> <span data-ttu-id="b689d-174">Crash consistency typically happens when the Azure virtual machine is shut down at the time of backup.</span><span class="sxs-lookup"><span data-stu-id="b689d-174">Crash consistency typically happens when the Azure virtual machine is shut down at the time of backup.</span></span> <span data-ttu-id="b689d-175">A crash-consistent recovery point provides no guarantees around the consistency of the data on the storage medium--either from the perspective of the operating system or the application.</span><span class="sxs-lookup"><span data-stu-id="b689d-175">A crash-consistent recovery point provides no guarantees around the consistency of the data on the storage medium--either from the perspective of the operating system or the application.</span></span> <span data-ttu-id="b689d-176">Only the data that already exists on the disk at the time of backup is captured and backed up.</span><span class="sxs-lookup"><span data-stu-id="b689d-176">Only the data that already exists on the disk at the time of backup is captured and backed up.</span></span> <br/> <br/> <span data-ttu-id="b689d-177">While there are no guarantees, usually, the operating system boots, followed by disk-checking procedure, like chkdsk, to fix any corruption errors.</span><span class="sxs-lookup"><span data-stu-id="b689d-177">While there are no guarantees, usually, the operating system boots, followed by disk-checking procedure, like chkdsk, to fix any corruption errors.</span></span> <span data-ttu-id="b689d-178">Any in-memory data or writes that have not been transferred to the disk are lost.</span><span class="sxs-lookup"><span data-stu-id="b689d-178">Any in-memory data or writes that have not been transferred to the disk are lost.</span></span> <span data-ttu-id="b689d-179">The application typically follows with its own verification mechanism in case data rollback needs to be done.</span><span class="sxs-lookup"><span data-stu-id="b689d-179">The application typically follows with its own verification mechanism in case data rollback needs to be done.</span></span> <br><br><span data-ttu-id="b689d-180">As an example, if the transaction log has entries not present in the database, the database software rolls back until the data is consistent.</span><span class="sxs-lookup"><span data-stu-id="b689d-180">As an example, if the transaction log has entries not present in the database, the database software rolls back until the data is consistent.</span></span> <span data-ttu-id="b689d-181">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for the correctness of the data.</span><span class="sxs-lookup"><span data-stu-id="b689d-181">When data is spread across multiple virtual disks (like spanned volumes), a crash-consistent recovery point provides no guarantees for the correctness of the data.</span></span> |

## <a name="performance-and-resource-utilization"></a><span data-ttu-id="b689d-182">Performance and resource utilization</span><span class="sxs-lookup"><span data-stu-id="b689d-182">Performance and resource utilization</span></span>
<span data-ttu-id="b689d-183">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span><span class="sxs-lookup"><span data-stu-id="b689d-183">Like backup software that is deployed on-premises, you should plan for capacity and resource utilization needs when backing up VMs in Azure.</span></span> <span data-ttu-id="b689d-184">The [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how to structure VM deployments to get maximum performance with minimum impact to running workloads.</span><span class="sxs-lookup"><span data-stu-id="b689d-184">The [Azure Storage limits](../azure-subscription-service-limits.md#storage-limits) define how to structure VM deployments to get maximum performance with minimum impact to running workloads.</span></span>

### <a name="number-of-disks"></a><span data-ttu-id="b689d-185">Number of disks</span><span class="sxs-lookup"><span data-stu-id="b689d-185">Number of disks</span></span>
<span data-ttu-id="b689d-186">The backup process tries to complete a backup job as quickly as possible.</span><span class="sxs-lookup"><span data-stu-id="b689d-186">The backup process tries to complete a backup job as quickly as possible.</span></span> <span data-ttu-id="b689d-187">In doing so, it consumes as many resources as it can.</span><span class="sxs-lookup"><span data-stu-id="b689d-187">In doing so, it consumes as many resources as it can.</span></span> <span data-ttu-id="b689d-188">However, all I/O operations are limited by the *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span><span class="sxs-lookup"><span data-stu-id="b689d-188">However, all I/O operations are limited by the *Target Throughput for Single Blob*, which has a limit of 60 MB per second.</span></span> <span data-ttu-id="b689d-189">In an attempt to maximize its speed, the backup process tries to back up each of the VM's disks *in parallel*.</span><span class="sxs-lookup"><span data-stu-id="b689d-189">In an attempt to maximize its speed, the backup process tries to back up each of the VM's disks *in parallel*.</span></span> <span data-ttu-id="b689d-190">If a VM has four disks, the service attempts to back up all four disks in parallel.</span><span class="sxs-lookup"><span data-stu-id="b689d-190">If a VM has four disks, the service attempts to back up all four disks in parallel.</span></span> <span data-ttu-id="b689d-191">The **number of disks** being backed up, is the most important factor in determining storage account backup traffic.</span><span class="sxs-lookup"><span data-stu-id="b689d-191">The **number of disks** being backed up, is the most important factor in determining storage account backup traffic.</span></span>

### <a name="backup-schedule"></a><span data-ttu-id="b689d-192">Backup schedule</span><span class="sxs-lookup"><span data-stu-id="b689d-192">Backup schedule</span></span>
<span data-ttu-id="b689d-193">An additional factor that impacts performance is the **backup schedule**.</span><span class="sxs-lookup"><span data-stu-id="b689d-193">An additional factor that impacts performance is the **backup schedule**.</span></span> <span data-ttu-id="b689d-194">If you configure the policies so all VMs are backed up at the same time, you have scheduled a traffic jam.</span><span class="sxs-lookup"><span data-stu-id="b689d-194">If you configure the policies so all VMs are backed up at the same time, you have scheduled a traffic jam.</span></span> <span data-ttu-id="b689d-195">The backup process attempts to back up all disks in parallel.</span><span class="sxs-lookup"><span data-stu-id="b689d-195">The backup process attempts to back up all disks in parallel.</span></span> <span data-ttu-id="b689d-196">To reduce the backup traffic, back up different VMs at different time of the day, with no overlap.</span><span class="sxs-lookup"><span data-stu-id="b689d-196">To reduce the backup traffic, back up different VMs at different time of the day, with no overlap.</span></span>

## <a name="capacity-planning"></a><span data-ttu-id="b689d-197">Capacity planning</span><span class="sxs-lookup"><span data-stu-id="b689d-197">Capacity planning</span></span>
<span data-ttu-id="b689d-198">Download the [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) to see the impact of your disk and backup schedule choices.</span><span class="sxs-lookup"><span data-stu-id="b689d-198">Download the [VM backup capacity planning Excel spreadsheet](https://gallery.technet.microsoft.com/Azure-Backup-Storage-a46d7e33) to see the impact of your disk and backup schedule choices.</span></span>

### <a name="backup-throughput"></a><span data-ttu-id="b689d-199">Backup throughput</span><span class="sxs-lookup"><span data-stu-id="b689d-199">Backup throughput</span></span>
<span data-ttu-id="b689d-200">For each disk being backed up, Azure Backup reads the blocks on the disk and stores only the changed data (incremental backup).</span><span class="sxs-lookup"><span data-stu-id="b689d-200">For each disk being backed up, Azure Backup reads the blocks on the disk and stores only the changed data (incremental backup).</span></span> <span data-ttu-id="b689d-201">The following table shows the average Backup service throughput values.</span><span class="sxs-lookup"><span data-stu-id="b689d-201">The following table shows the average Backup service throughput values.</span></span> <span data-ttu-id="b689d-202">Using the following data, you can estimate the amount of time needed to back up a disk of a given size.</span><span class="sxs-lookup"><span data-stu-id="b689d-202">Using the following data, you can estimate the amount of time needed to back up a disk of a given size.</span></span>

| <span data-ttu-id="b689d-203">Backup operation</span><span class="sxs-lookup"><span data-stu-id="b689d-203">Backup operation</span></span> | <span data-ttu-id="b689d-204">Best-case throughput</span><span class="sxs-lookup"><span data-stu-id="b689d-204">Best-case throughput</span></span> |
| --- | --- |
| <span data-ttu-id="b689d-205">Initial backup</span><span class="sxs-lookup"><span data-stu-id="b689d-205">Initial backup</span></span> |<span data-ttu-id="b689d-206">160 Mbps</span><span class="sxs-lookup"><span data-stu-id="b689d-206">160 Mbps</span></span> |
| <span data-ttu-id="b689d-207">Incremental backup (DR)</span><span class="sxs-lookup"><span data-stu-id="b689d-207">Incremental backup (DR)</span></span> |<span data-ttu-id="b689d-208">640 Mbps</span><span class="sxs-lookup"><span data-stu-id="b689d-208">640 Mbps</span></span> <br><br> <span data-ttu-id="b689d-209">Throughput drops significantly if the changed data (that needs to be backed up) is dispersed across the disk.</span><span class="sxs-lookup"><span data-stu-id="b689d-209">Throughput drops significantly if the changed data (that needs to be backed up) is dispersed across the disk.</span></span>|

## <a name="total-vm-backup-time"></a><span data-ttu-id="b689d-210">Total VM backup time</span><span class="sxs-lookup"><span data-stu-id="b689d-210">Total VM backup time</span></span>
<span data-ttu-id="b689d-211">While most of the backup time is spent reading and copying data, other operations contribute to the total time needed to back up a VM:</span><span class="sxs-lookup"><span data-stu-id="b689d-211">While most of the backup time is spent reading and copying data, other operations contribute to the total time needed to back up a VM:</span></span>

* <span data-ttu-id="b689d-212">Time needed to [install or update the backup extension](backup-azure-arm-vms.md).</span><span class="sxs-lookup"><span data-stu-id="b689d-212">Time needed to [install or update the backup extension](backup-azure-arm-vms.md).</span></span>
* <span data-ttu-id="b689d-213">Snapshot time, which is the time taken to trigger a snapshot.</span><span class="sxs-lookup"><span data-stu-id="b689d-213">Snapshot time, which is the time taken to trigger a snapshot.</span></span> <span data-ttu-id="b689d-214">Snapshots are triggered close to the scheduled backup time.</span><span class="sxs-lookup"><span data-stu-id="b689d-214">Snapshots are triggered close to the scheduled backup time.</span></span>
* <span data-ttu-id="b689d-215">Queue wait time.</span><span class="sxs-lookup"><span data-stu-id="b689d-215">Queue wait time.</span></span> <span data-ttu-id="b689d-216">Since the Backup service processes jobs from multiple customers at the same time, snapshot data may not immediately be copied to the Recovery Services vault.</span><span class="sxs-lookup"><span data-stu-id="b689d-216">Since the Backup service processes jobs from multiple customers at the same time, snapshot data may not immediately be copied to the Recovery Services vault.</span></span> <span data-ttu-id="b689d-217">At peak load times, it can take up to eight hours before the backups are processed.</span><span class="sxs-lookup"><span data-stu-id="b689d-217">At peak load times, it can take up to eight hours before the backups are processed.</span></span> <span data-ttu-id="b689d-218">However, the total VM backup time is less than 24 hours for daily backup policies.</span><span class="sxs-lookup"><span data-stu-id="b689d-218">However, the total VM backup time is less than 24 hours for daily backup policies.</span></span>
<span data-ttu-id="b689d-219">Total backup time of less than 24 hours is valid for incremental backups, but may not be for the first backup.</span><span class="sxs-lookup"><span data-stu-id="b689d-219">Total backup time of less than 24 hours is valid for incremental backups, but may not be for the first backup.</span></span> <span data-ttu-id="b689d-220">First backup time is proportional and can be greater than 24 hours depending upon the size of the data and when the backup is taken.</span><span class="sxs-lookup"><span data-stu-id="b689d-220">First backup time is proportional and can be greater than 24 hours depending upon the size of the data and when the backup is taken.</span></span>
* <span data-ttu-id="b689d-221">Data transfer time, time needed for backup service to compute the incremental changes from previous backup and transfer those changes to vault storage.</span><span class="sxs-lookup"><span data-stu-id="b689d-221">Data transfer time, time needed for backup service to compute the incremental changes from previous backup and transfer those changes to vault storage.</span></span>

### <a name="why-are-backup-times-longer-than-12-hours"></a><span data-ttu-id="b689d-222">Why are backup times longer than 12 hours?</span><span class="sxs-lookup"><span data-stu-id="b689d-222">Why are backup times longer than 12 hours?</span></span>

<span data-ttu-id="b689d-223">Backup consists of two phases: taking snapshots and transferring the snapshots to the vault.</span><span class="sxs-lookup"><span data-stu-id="b689d-223">Backup consists of two phases: taking snapshots and transferring the snapshots to the vault.</span></span> <span data-ttu-id="b689d-224">The Backup service optimizes for storage.</span><span class="sxs-lookup"><span data-stu-id="b689d-224">The Backup service optimizes for storage.</span></span> <span data-ttu-id="b689d-225">When transferring the snapshot data to a vault, the service only transfers incremental changes from the previous snapshot.</span><span class="sxs-lookup"><span data-stu-id="b689d-225">When transferring the snapshot data to a vault, the service only transfers incremental changes from the previous snapshot.</span></span>  <span data-ttu-id="b689d-226">To determine the incremental changes, the service computes the checksum of the blocks.</span><span class="sxs-lookup"><span data-stu-id="b689d-226">To determine the incremental changes, the service computes the checksum of the blocks.</span></span> <span data-ttu-id="b689d-227">If a block is changed, the block is identified as a block to be sent to the vault.</span><span class="sxs-lookup"><span data-stu-id="b689d-227">If a block is changed, the block is identified as a block to be sent to the vault.</span></span> <span data-ttu-id="b689d-228">Then the service drills further into each of the identified blocks, looking for opportunities to minimize the data to transfer.</span><span class="sxs-lookup"><span data-stu-id="b689d-228">Then the service drills further into each of the identified blocks, looking for opportunities to minimize the data to transfer.</span></span> <span data-ttu-id="b689d-229">After evaluating all changed blocks, the service coalesces the changes and sends them to the vault.</span><span class="sxs-lookup"><span data-stu-id="b689d-229">After evaluating all changed blocks, the service coalesces the changes and sends them to the vault.</span></span> <span data-ttu-id="b689d-230">In some legacy applications, small, fragmented writes are not optimal for storage.</span><span class="sxs-lookup"><span data-stu-id="b689d-230">In some legacy applications, small, fragmented writes are not optimal for storage.</span></span> <span data-ttu-id="b689d-231">If the snapshot contains many small, fragmented writes, the service spends additional time processing the data written by the applications.</span><span class="sxs-lookup"><span data-stu-id="b689d-231">If the snapshot contains many small, fragmented writes, the service spends additional time processing the data written by the applications.</span></span> <span data-ttu-id="b689d-232">For applications running inside the VM, the recommended application-writes block minimum is 8 KB.</span><span class="sxs-lookup"><span data-stu-id="b689d-232">For applications running inside the VM, the recommended application-writes block minimum is 8 KB.</span></span> <span data-ttu-id="b689d-233">If your application uses a block of less than 8 KB, backup performance is effected.</span><span class="sxs-lookup"><span data-stu-id="b689d-233">If your application uses a block of less than 8 KB, backup performance is effected.</span></span> <span data-ttu-id="b689d-234">For help with tuning your application to improve backup performance, see [Tuning applications for optimal performance with Azure storage](../virtual-machines/windows/premium-storage-performance.md).</span><span class="sxs-lookup"><span data-stu-id="b689d-234">For help with tuning your application to improve backup performance, see [Tuning applications for optimal performance with Azure storage](../virtual-machines/windows/premium-storage-performance.md).</span></span> <span data-ttu-id="b689d-235">Though the article on backup performance uses Premium storage examples, the guidance is applicable for Standard storage disks.</span><span class="sxs-lookup"><span data-stu-id="b689d-235">Though the article on backup performance uses Premium storage examples, the guidance is applicable for Standard storage disks.</span></span>

## <a name="total-restore-time"></a><span data-ttu-id="b689d-236">Total restore time</span><span class="sxs-lookup"><span data-stu-id="b689d-236">Total restore time</span></span>

<span data-ttu-id="b689d-237">A restore operation consists of two main tasks: copying data back from the vault to the chosen customer storage account, and creating the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="b689d-237">A restore operation consists of two main tasks: copying data back from the vault to the chosen customer storage account, and creating the virtual machine.</span></span> <span data-ttu-id="b689d-238">The time needed to copy data from the vault depends on where the backups are stored in Azure, and the location of the customer storage account.</span><span class="sxs-lookup"><span data-stu-id="b689d-238">The time needed to copy data from the vault depends on where the backups are stored in Azure, and the location of the customer storage account.</span></span> <span data-ttu-id="b689d-239">Time taken to copy data depends upon:</span><span class="sxs-lookup"><span data-stu-id="b689d-239">Time taken to copy data depends upon:</span></span>
* <span data-ttu-id="b689d-240">Queue wait time - Since the service processes restore jobs from multiple customers at the same time, restore requests are put in a queue.</span><span class="sxs-lookup"><span data-stu-id="b689d-240">Queue wait time - Since the service processes restore jobs from multiple customers at the same time, restore requests are put in a queue.</span></span>
* <span data-ttu-id="b689d-241">Data copy time - Data is copied from the vault to the customer storage account.</span><span class="sxs-lookup"><span data-stu-id="b689d-241">Data copy time - Data is copied from the vault to the customer storage account.</span></span> <span data-ttu-id="b689d-242">Restore time depends on IOPS and throughput Azure Backup service gets on the selected customer storage account.</span><span class="sxs-lookup"><span data-stu-id="b689d-242">Restore time depends on IOPS and throughput Azure Backup service gets on the selected customer storage account.</span></span> <span data-ttu-id="b689d-243">To reduce the copying time during the restore process, select a storage account not loaded with other application writes and reads.</span><span class="sxs-lookup"><span data-stu-id="b689d-243">To reduce the copying time during the restore process, select a storage account not loaded with other application writes and reads.</span></span>

## <a name="best-practices"></a><span data-ttu-id="b689d-244">Best practices</span><span class="sxs-lookup"><span data-stu-id="b689d-244">Best practices</span></span>

<span data-ttu-id="b689d-245">We suggest following these practices while configuring backups for all virtual machines:</span><span class="sxs-lookup"><span data-stu-id="b689d-245">We suggest following these practices while configuring backups for all virtual machines:</span></span>

* <span data-ttu-id="b689d-246">Don't schedule backups for more than 10 classic VMs from the same cloud service, at the same time.</span><span class="sxs-lookup"><span data-stu-id="b689d-246">Don't schedule backups for more than 10 classic VMs from the same cloud service, at the same time.</span></span> <span data-ttu-id="b689d-247">If you want to back up multiple VMs from the same cloud service, stagger the backup start times by an hour.</span><span class="sxs-lookup"><span data-stu-id="b689d-247">If you want to back up multiple VMs from the same cloud service, stagger the backup start times by an hour.</span></span>
* <span data-ttu-id="b689d-248">Don't schedule backups for more than 100 VMs from one vault, at the same time.</span><span class="sxs-lookup"><span data-stu-id="b689d-248">Don't schedule backups for more than 100 VMs from one vault, at the same time.</span></span>
* <span data-ttu-id="b689d-249">Schedule VM backups during non-peak hours.</span><span class="sxs-lookup"><span data-stu-id="b689d-249">Schedule VM backups during non-peak hours.</span></span> <span data-ttu-id="b689d-250">This way the Backup service uses IOPS for transferring data from the customer storage account to the vault.</span><span class="sxs-lookup"><span data-stu-id="b689d-250">This way the Backup service uses IOPS for transferring data from the customer storage account to the vault.</span></span>
* <span data-ttu-id="b689d-251">Make sure Linux VMs enabled for backup, have Python version 2.7 or greater.</span><span class="sxs-lookup"><span data-stu-id="b689d-251">Make sure Linux VMs enabled for backup, have Python version 2.7 or greater.</span></span>

### <a name="best-practices-for-vms-with-unmanaged-disks"></a><span data-ttu-id="b689d-252">Best practices for VMs with unmanaged disks</span><span class="sxs-lookup"><span data-stu-id="b689d-252">Best practices for VMs with unmanaged disks</span></span>

<span data-ttu-id="b689d-253">The following recommendations apply only to VMs using unmanaged disks.</span><span class="sxs-lookup"><span data-stu-id="b689d-253">The following recommendations apply only to VMs using unmanaged disks.</span></span> <span data-ttu-id="b689d-254">If your VMs use managed disks, the Backup service handles all storage management activities.</span><span class="sxs-lookup"><span data-stu-id="b689d-254">If your VMs use managed disks, the Backup service handles all storage management activities.</span></span>

* <span data-ttu-id="b689d-255">Make sure to apply a backup policy to VMs spread across multiple storage accounts.</span><span class="sxs-lookup"><span data-stu-id="b689d-255">Make sure to apply a backup policy to VMs spread across multiple storage accounts.</span></span> <span data-ttu-id="b689d-256">No more than 20 total disks from a single storage account should be protected by the same backup schedule.</span><span class="sxs-lookup"><span data-stu-id="b689d-256">No more than 20 total disks from a single storage account should be protected by the same backup schedule.</span></span> <span data-ttu-id="b689d-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies to get the required IOPS during the transfer phase of the backup process.</span><span class="sxs-lookup"><span data-stu-id="b689d-257">If you have greater than 20 disks in a storage account, spread those VMs across multiple policies to get the required IOPS during the transfer phase of the backup process.</span></span>
* <span data-ttu-id="b689d-258">Do not restore a VM running on Premium storage to same storage account.</span><span class="sxs-lookup"><span data-stu-id="b689d-258">Do not restore a VM running on Premium storage to same storage account.</span></span> <span data-ttu-id="b689d-259">If the restore operation process coincides with the backup operation, it reduces the available IOPS for backup.</span><span class="sxs-lookup"><span data-stu-id="b689d-259">If the restore operation process coincides with the backup operation, it reduces the available IOPS for backup.</span></span>
* <span data-ttu-id="b689d-260">For Premium VM backup on VM backup stack V1, you should allocate only 50% of the total storage account space so the Backup service can copy the snapshot to storage account, and transfer data from the storage account to the vault.</span><span class="sxs-lookup"><span data-stu-id="b689d-260">For Premium VM backup on VM backup stack V1, you should allocate only 50% of the total storage account space so the Backup service can copy the snapshot to storage account, and transfer data from the storage account to the vault.</span></span>


## <a name="data-encryption"></a><span data-ttu-id="b689d-261">Data encryption</span><span class="sxs-lookup"><span data-stu-id="b689d-261">Data encryption</span></span>
<span data-ttu-id="b689d-262">Azure Backup does not encrypt data as a part of the backup process.</span><span class="sxs-lookup"><span data-stu-id="b689d-262">Azure Backup does not encrypt data as a part of the backup process.</span></span> <span data-ttu-id="b689d-263">However, you can encrypt data within the VM and back up the protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span><span class="sxs-lookup"><span data-stu-id="b689d-263">However, you can encrypt data within the VM and back up the protected data seamlessly (read more about [backup of encrypted data](backup-azure-vms-encryption.md)).</span></span>

## <a name="calculating-the-cost-of-protected-instances"></a><span data-ttu-id="b689d-264">Calculating the cost of protected instances</span><span class="sxs-lookup"><span data-stu-id="b689d-264">Calculating the cost of protected instances</span></span>
<span data-ttu-id="b689d-265">Azure virtual machines that are backed up through Azure Backup are subject to [Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span><span class="sxs-lookup"><span data-stu-id="b689d-265">Azure virtual machines that are backed up through Azure Backup are subject to [Azure Backup pricing](https://azure.microsoft.com/pricing/details/backup/).</span></span> <span data-ttu-id="b689d-266">The Protected Instances calculation is based on the *actual* size of the virtual machine, which is the sum of all the data in the virtual machine--excluding the temporary storage.</span><span class="sxs-lookup"><span data-stu-id="b689d-266">The Protected Instances calculation is based on the *actual* size of the virtual machine, which is the sum of all the data in the virtual machine--excluding the temporary storage.</span></span>

<span data-ttu-id="b689d-267">Pricing for backing up VMs is not based on the maximum supported size for each data disk attached to the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="b689d-267">Pricing for backing up VMs is not based on the maximum supported size for each data disk attached to the virtual machine.</span></span> <span data-ttu-id="b689d-268">Pricing is based on the actual data stored in the data disk.</span><span class="sxs-lookup"><span data-stu-id="b689d-268">Pricing is based on the actual data stored in the data disk.</span></span> <span data-ttu-id="b689d-269">Similarly, the backup storage bill is based on the amount of data that is stored in Azure Backup, which is the sum of the actual data in each recovery point.</span><span class="sxs-lookup"><span data-stu-id="b689d-269">Similarly, the backup storage bill is based on the amount of data that is stored in Azure Backup, which is the sum of the actual data in each recovery point.</span></span>

<span data-ttu-id="b689d-270">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 4 TB each.</span><span class="sxs-lookup"><span data-stu-id="b689d-270">For example, take an A2 Standard-sized virtual machine that has two additional data disks with a maximum size of 4 TB each.</span></span> <span data-ttu-id="b689d-271">The following table gives the actual data stored on each of these disks:</span><span class="sxs-lookup"><span data-stu-id="b689d-271">The following table gives the actual data stored on each of these disks:</span></span>

| <span data-ttu-id="b689d-272">Disk type</span><span class="sxs-lookup"><span data-stu-id="b689d-272">Disk type</span></span> | <span data-ttu-id="b689d-273">Max size</span><span class="sxs-lookup"><span data-stu-id="b689d-273">Max size</span></span> | <span data-ttu-id="b689d-274">Actual data present</span><span class="sxs-lookup"><span data-stu-id="b689d-274">Actual data present</span></span> |
| --------- | -------- | ----------- |
| <span data-ttu-id="b689d-275">Operating system disk</span><span class="sxs-lookup"><span data-stu-id="b689d-275">Operating system disk</span></span> |<span data-ttu-id="b689d-276">4095 GB</span><span class="sxs-lookup"><span data-stu-id="b689d-276">4095 GB</span></span> |<span data-ttu-id="b689d-277">17 GB</span><span class="sxs-lookup"><span data-stu-id="b689d-277">17 GB</span></span> |
| <span data-ttu-id="b689d-278">Local disk / Temporary disk</span><span class="sxs-lookup"><span data-stu-id="b689d-278">Local disk / Temporary disk</span></span> |<span data-ttu-id="b689d-279">135 GB</span><span class="sxs-lookup"><span data-stu-id="b689d-279">135 GB</span></span> |<span data-ttu-id="b689d-280">5 GB (not included for backup)</span><span class="sxs-lookup"><span data-stu-id="b689d-280">5 GB (not included for backup)</span></span> |
| <span data-ttu-id="b689d-281">Data disk 1</span><span class="sxs-lookup"><span data-stu-id="b689d-281">Data disk 1</span></span> |<span data-ttu-id="b689d-282">4095 GB</span><span class="sxs-lookup"><span data-stu-id="b689d-282">4095 GB</span></span> |<span data-ttu-id="b689d-283">30 GB</span><span class="sxs-lookup"><span data-stu-id="b689d-283">30 GB</span></span> |
| <span data-ttu-id="b689d-284">Data disk 2</span><span class="sxs-lookup"><span data-stu-id="b689d-284">Data disk 2</span></span> |<span data-ttu-id="b689d-285">4095 GB</span><span class="sxs-lookup"><span data-stu-id="b689d-285">4095 GB</span></span> |<span data-ttu-id="b689d-286">0 GB</span><span class="sxs-lookup"><span data-stu-id="b689d-286">0 GB</span></span> |

<span data-ttu-id="b689d-287">The actual size of the virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span><span class="sxs-lookup"><span data-stu-id="b689d-287">The actual size of the virtual machine in this case is 17 GB + 30 GB + 0 GB = 47 GB.</span></span> <span data-ttu-id="b689d-288">This Protected Instance size (47 GB) becomes the basis for the monthly bill.</span><span class="sxs-lookup"><span data-stu-id="b689d-288">This Protected Instance size (47 GB) becomes the basis for the monthly bill.</span></span> <span data-ttu-id="b689d-289">As the amount of data in the virtual machine grows, the Protected Instance size used for billing changes accordingly.</span><span class="sxs-lookup"><span data-stu-id="b689d-289">As the amount of data in the virtual machine grows, the Protected Instance size used for billing changes accordingly.</span></span>

<span data-ttu-id="b689d-290">Billing does not start until the first successful backup completes.</span><span class="sxs-lookup"><span data-stu-id="b689d-290">Billing does not start until the first successful backup completes.</span></span> <span data-ttu-id="b689d-291">At this point, the billing for both Storage and Protected Instances begins.</span><span class="sxs-lookup"><span data-stu-id="b689d-291">At this point, the billing for both Storage and Protected Instances begins.</span></span> <span data-ttu-id="b689d-292">Billing continues as long as there is any backup data stored in a vault for the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="b689d-292">Billing continues as long as there is any backup data stored in a vault for the virtual machine.</span></span> <span data-ttu-id="b689d-293">If you stop protection on the virtual machine, but virtual machine backup data exists in a vault, billing continues.</span><span class="sxs-lookup"><span data-stu-id="b689d-293">If you stop protection on the virtual machine, but virtual machine backup data exists in a vault, billing continues.</span></span>

<span data-ttu-id="b689d-294">Billing for a specified virtual machine stops only if the protection is stopped and all backup data is deleted.</span><span class="sxs-lookup"><span data-stu-id="b689d-294">Billing for a specified virtual machine stops only if the protection is stopped and all backup data is deleted.</span></span> <span data-ttu-id="b689d-295">When protection stops and there are no active backup jobs, the size of the last successful VM backup becomes the Protected Instance size used for the monthly bill.</span><span class="sxs-lookup"><span data-stu-id="b689d-295">When protection stops and there are no active backup jobs, the size of the last successful VM backup becomes the Protected Instance size used for the monthly bill.</span></span>

## <a name="questions"></a><span data-ttu-id="b689d-296">Questions?</span><span class="sxs-lookup"><span data-stu-id="b689d-296">Questions?</span></span>
<span data-ttu-id="b689d-297">If you have questions, or if there is any feature that you would like to see included, [send us feedback](http://aka.ms/azurebackup_feedback).</span><span class="sxs-lookup"><span data-stu-id="b689d-297">If you have questions, or if there is any feature that you would like to see included, [send us feedback](http://aka.ms/azurebackup_feedback).</span></span>

## <a name="next-steps"></a><span data-ttu-id="b689d-298">Next steps</span><span class="sxs-lookup"><span data-stu-id="b689d-298">Next steps</span></span>
* [<span data-ttu-id="b689d-299">Back up virtual machines</span><span class="sxs-lookup"><span data-stu-id="b689d-299">Back up virtual machines</span></span>](backup-azure-arm-vms.md)
* [<span data-ttu-id="b689d-300">Manage virtual machine backup</span><span class="sxs-lookup"><span data-stu-id="b689d-300">Manage virtual machine backup</span></span>](backup-azure-manage-vms.md)
* [<span data-ttu-id="b689d-301">Restore virtual machines</span><span class="sxs-lookup"><span data-stu-id="b689d-301">Restore virtual machines</span></span>](backup-azure-arm-restore-vms.md)
* [<span data-ttu-id="b689d-302">Troubleshoot VM backup issues</span><span class="sxs-lookup"><span data-stu-id="b689d-302">Troubleshoot VM backup issues</span></span>](backup-azure-vms-troubleshoot.md)
