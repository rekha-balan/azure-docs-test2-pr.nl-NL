---
title: Storing Batch AI job input and output with Azure Storage | Microsoft Docs
description: How to use Azure Storage with Batch AI for fast and easy cloud storage of input and output files
services: batch-ai
documentationcenter: ''
author: kevwang1
manager: jeconnoc
editor: ''
ms.service: batch-ai
ms.topic: article
ms.date: 08/14/2018
ms.author: danlep
ms.custom: mvc
ms.openlocfilehash: 6a9897e94bf8f58ca4000f68ff30bfc6eece6249
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44969018"
---
# <a name="store-batch-ai-job-input-and-output-with-azure-storage"></a><span data-ttu-id="51ab8-103">Store Batch AI job input and output with Azure Storage</span><span class="sxs-lookup"><span data-stu-id="51ab8-103">Store Batch AI job input and output with Azure Storage</span></span>

<span data-ttu-id="51ab8-104">This guide describes how to use Azure Storage for storing input and output files when running a job.</span><span class="sxs-lookup"><span data-stu-id="51ab8-104">This guide describes how to use Azure Storage for storing input and output files when running a job.</span></span> <span data-ttu-id="51ab8-105">Azure Storage is one of several storage options supported by Batch AI.</span><span class="sxs-lookup"><span data-stu-id="51ab8-105">Azure Storage is one of several storage options supported by Batch AI.</span></span> <span data-ttu-id="51ab8-106">Batch AI integrates with Azure Storage by mounting Azure Storage systems to a Batch AI job or cluster filesystem, allowing seamless access to files stored in the cloud.</span><span class="sxs-lookup"><span data-stu-id="51ab8-106">Batch AI integrates with Azure Storage by mounting Azure Storage systems to a Batch AI job or cluster filesystem, allowing seamless access to files stored in the cloud.</span></span> 

## <a name="introduction-to-azure-storage"></a><span data-ttu-id="51ab8-107">Introduction to Azure Storage</span><span class="sxs-lookup"><span data-stu-id="51ab8-107">Introduction to Azure Storage</span></span>

<span data-ttu-id="51ab8-108">Azure Storage is Microsoft's cloud storage solution.</span><span class="sxs-lookup"><span data-stu-id="51ab8-108">Azure Storage is Microsoft's cloud storage solution.</span></span> <span data-ttu-id="51ab8-109">Batch AI supports mounting Azure Blob containers and Azure file shares to Batch AI jobs or clusters, allowing files to be accessed from a job as if they were in the native filesystem.</span><span class="sxs-lookup"><span data-stu-id="51ab8-109">Batch AI supports mounting Azure Blob containers and Azure file shares to Batch AI jobs or clusters, allowing files to be accessed from a job as if they were in the native filesystem.</span></span> <span data-ttu-id="51ab8-110">Batch AI mounts Azure Blob containers with [blobfuse](https://github.com/Azure/azure-storage-fuse), and Azure file shares via the SMB protocol.</span><span class="sxs-lookup"><span data-stu-id="51ab8-110">Batch AI mounts Azure Blob containers with [blobfuse](https://github.com/Azure/azure-storage-fuse), and Azure file shares via the SMB protocol.</span></span> <span data-ttu-id="51ab8-111">For more information on Azure Storage, see [Introduction to Azure Storage](../storage/common/storage-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="51ab8-111">For more information on Azure Storage, see [Introduction to Azure Storage](../storage/common/storage-introduction.md).</span></span>

## <a name="store-datasets-and-input-scripts-in-azure-storage"></a><span data-ttu-id="51ab8-112">Store datasets and input scripts in Azure Storage</span><span class="sxs-lookup"><span data-stu-id="51ab8-112">Store datasets and input scripts in Azure Storage</span></span>

<span data-ttu-id="51ab8-113">When you choose Azure Storage for your Batch AI environment, we recommend that you store your input files (such as datasets) in a Blob container, which has higher throughput, and you store your training output in a file share, which supports streaming (allowing reading of output logs while the job is concurrently running).</span><span class="sxs-lookup"><span data-stu-id="51ab8-113">When you choose Azure Storage for your Batch AI environment, we recommend that you store your input files (such as datasets) in a Blob container, which has higher throughput, and you store your training output in a file share, which supports streaming (allowing reading of output logs while the job is concurrently running).</span></span> 

<span data-ttu-id="51ab8-114">Before you can use Azure Storage, you must [create an Azure Storage account](../storage/common/storage-create-storage-account.md#create-a-storage-account).</span><span class="sxs-lookup"><span data-stu-id="51ab8-114">Before you can use Azure Storage, you must [create an Azure Storage account](../storage/common/storage-create-storage-account.md#create-a-storage-account).</span></span> <span data-ttu-id="51ab8-115">Batch AI supports mounting volumes from both General-purpose v1 (GPv1) and General-purpose v2 (GPv2) Azure Storage accounts.</span><span class="sxs-lookup"><span data-stu-id="51ab8-115">Batch AI supports mounting volumes from both General-purpose v1 (GPv1) and General-purpose v2 (GPv2) Azure Storage accounts.</span></span> <span data-ttu-id="51ab8-116">The Azure Storage account can hold multiple Blob containers or file share instances.</span><span class="sxs-lookup"><span data-stu-id="51ab8-116">The Azure Storage account can hold multiple Blob containers or file share instances.</span></span> <span data-ttu-id="51ab8-117">Consider your cost and performance requirements when choosing a storage account [option](../storage/common/storage-account-options.md).</span><span class="sxs-lookup"><span data-stu-id="51ab8-117">Consider your cost and performance requirements when choosing a storage account [option](../storage/common/storage-account-options.md).</span></span> 

<span data-ttu-id="51ab8-118">To create a Blob container and to upload your dataset to an Azure Blob container, choose one of the following methods:</span><span class="sxs-lookup"><span data-stu-id="51ab8-118">To create a Blob container and to upload your dataset to an Azure Blob container, choose one of the following methods:</span></span>
- <span data-ttu-id="51ab8-119">[Azure portal](../storage/blobs/storage-quickstart-blobs-portal.md) for uploading with a web-based GUI.</span><span class="sxs-lookup"><span data-stu-id="51ab8-119">[Azure portal](../storage/blobs/storage-quickstart-blobs-portal.md) for uploading with a web-based GUI.</span></span> <span data-ttu-id="51ab8-120">To upload a small number of files, Azure portal provides the simplest operation.</span><span class="sxs-lookup"><span data-stu-id="51ab8-120">To upload a small number of files, Azure portal provides the simplest operation.</span></span>
- <span data-ttu-id="51ab8-121">[Azure Storage CLI](../storage/blobs/storage-quickstart-blobs-cli.md) for uploading via the command line (supports directory upload).</span><span class="sxs-lookup"><span data-stu-id="51ab8-121">[Azure Storage CLI](../storage/blobs/storage-quickstart-blobs-cli.md) for uploading via the command line (supports directory upload).</span></span> <span data-ttu-id="51ab8-122">To upload directories of files, use  `az storage blob upload-batch`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-122">To upload directories of files, use  `az storage blob upload-batch`.</span></span>
- <span data-ttu-id="51ab8-123">[other techniques](../storage/common/storage-moving-data.md), including using application SDKs.</span><span class="sxs-lookup"><span data-stu-id="51ab8-123">[other techniques](../storage/common/storage-moving-data.md), including using application SDKs.</span></span>

<span data-ttu-id="51ab8-124">Similarly, to create an Azure File share, choose one of the following methods:</span><span class="sxs-lookup"><span data-stu-id="51ab8-124">Similarly, to create an Azure File share, choose one of the following methods:</span></span>
- [<span data-ttu-id="51ab8-125">Azure portal</span><span class="sxs-lookup"><span data-stu-id="51ab8-125">Azure portal</span></span>](../storage/files/storage-how-to-use-files-portal.md)
- [<span data-ttu-id="51ab8-126">Azure Storage CLI</span><span class="sxs-lookup"><span data-stu-id="51ab8-126">Azure Storage CLI</span></span>](../storage/files/storage-how-to-use-files-cli.md)
- [<span data-ttu-id="51ab8-127">other techniques</span><span class="sxs-lookup"><span data-stu-id="51ab8-127">other techniques</span></span>](../storage/common/storage-moving-data.md)

### <a name="auto-storage-with-batch-ai"></a><span data-ttu-id="51ab8-128">Auto-storage with Batch AI</span><span class="sxs-lookup"><span data-stu-id="51ab8-128">Auto-storage with Batch AI</span></span>

<span data-ttu-id="51ab8-129">Alternatively, you can create an Azure Storage account with an Azure file share and Blob container (and automatically mount these volumes to a Batch AI cluster) by using the `--use-auto-storage` parameter with `az batchai cluster create`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-129">Alternatively, you can create an Azure Storage account with an Azure file share and Blob container (and automatically mount these volumes to a Batch AI cluster) by using the `--use-auto-storage` parameter with `az batchai cluster create`.</span></span> <span data-ttu-id="51ab8-130">For more information, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#auto-storage-account).</span><span class="sxs-lookup"><span data-stu-id="51ab8-130">For more information, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#auto-storage-account).</span></span>

## <a name="mount-azure-storage"></a><span data-ttu-id="51ab8-131">Mount Azure Storage</span><span class="sxs-lookup"><span data-stu-id="51ab8-131">Mount Azure Storage</span></span> 

### <a name="mount-volumes-to-a-job"></a><span data-ttu-id="51ab8-132">Mount volumes to a job</span><span class="sxs-lookup"><span data-stu-id="51ab8-132">Mount volumes to a job</span></span>

<span data-ttu-id="51ab8-133">Mounting an Azure Storage volume allows it to be accessed via the filesystem created for each job.</span><span class="sxs-lookup"><span data-stu-id="51ab8-133">Mounting an Azure Storage volume allows it to be accessed via the filesystem created for each job.</span></span> <span data-ttu-id="51ab8-134">Therefore, a job can read and write files seamlessly to cloud storage as if they were local files.</span><span class="sxs-lookup"><span data-stu-id="51ab8-134">Therefore, a job can read and write files seamlessly to cloud storage as if they were local files.</span></span>

<span data-ttu-id="51ab8-135">To mount an Azure Storage volume to a job created with the Azure CLI, use the `mountVolumes` property in your `job.json` file when running `az batchai job create`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-135">To mount an Azure Storage volume to a job created with the Azure CLI, use the `mountVolumes` property in your `job.json` file when running `az batchai job create`.</span></span> <span data-ttu-id="51ab8-136">For an example, see the [Tensorflow GPU Distributed Recipe](https://github.com/Azure/BatchAI/blob/master/recipes/TensorFlow/TensorFlow-GPU-Distributed/job.json).</span><span class="sxs-lookup"><span data-stu-id="51ab8-136">For an example, see the [Tensorflow GPU Distributed Recipe](https://github.com/Azure/BatchAI/blob/master/recipes/TensorFlow/TensorFlow-GPU-Distributed/job.json).</span></span> <span data-ttu-id="51ab8-137">The schema for `mountVolumes` is:</span><span class="sxs-lookup"><span data-stu-id="51ab8-137">The schema for `mountVolumes` is:</span></span>
```json
{
    "mountVolumes": {
        "azureFileShares": [{
            "azureFileUrl": "https://<STORAGE_ACCOUNT_NAME>.file.core.windows.net/<FILE_SHARE_NAME>",
            "relativeMountPath": "<RELATIVE_MOUNT_PATH>"
        }],
        "azureBlobFileSystems": [{
            "accountName": "<STORAGE_ACCOUNT_NAME>",
            "containerName": "<BLOB_CONTAINER_NAME>",
            "relativeMountPath": "<RELATIVE_MOUNT_PATH>"
        }]
    }
}
```

<span data-ttu-id="51ab8-138">`azureFileShares` and `azureBlobFileSystems` are both arrays of objects that represent the volumes to mount.</span><span class="sxs-lookup"><span data-stu-id="51ab8-138">`azureFileShares` and `azureBlobFileSystems` are both arrays of objects that represent the volumes to mount.</span></span> <span data-ttu-id="51ab8-139">Descriptions of the placeholders:</span><span class="sxs-lookup"><span data-stu-id="51ab8-139">Descriptions of the placeholders:</span></span>

- <span data-ttu-id="51ab8-140"><RELATIVE_MOUNT_PATH> - the volume will be mounted at this path.</span><span class="sxs-lookup"><span data-stu-id="51ab8-140"><RELATIVE_MOUNT_PATH> - the volume will be mounted at this path.</span></span> <span data-ttu-id="51ab8-141">For example, if `relativeMountPath` is `jobs`, the volume will be located at `$AZ_BATCHAI_JOB_MOUNT_ROOT/jobs`)</span><span class="sxs-lookup"><span data-stu-id="51ab8-141">For example, if `relativeMountPath` is `jobs`, the volume will be located at `$AZ_BATCHAI_JOB_MOUNT_ROOT/jobs`)</span></span>
- <span data-ttu-id="51ab8-142"><STORAGE_ACCOUNT_NAME> - the name of the Azure Storage account that holds the file share or Blob container</span><span class="sxs-lookup"><span data-stu-id="51ab8-142"><STORAGE_ACCOUNT_NAME> - the name of the Azure Storage account that holds the file share or Blob container</span></span>
- <span data-ttu-id="51ab8-143"><FILE_SHARE_NAME> - the name of the file share</span><span class="sxs-lookup"><span data-stu-id="51ab8-143"><FILE_SHARE_NAME> - the name of the file share</span></span>
- <span data-ttu-id="51ab8-144"><BLOB_CONTAINER_NAME> - the name of the Blob container</span><span class="sxs-lookup"><span data-stu-id="51ab8-144"><BLOB_CONTAINER_NAME> - the name of the Blob container</span></span>

<span data-ttu-id="51ab8-145">To mount Azure Storage volumes with the Azure Batch AI SDKs, set the `mount_volumes` (Python) or `MountVolumes` (C#, Java) property on `JobCreateParameters`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-145">To mount Azure Storage volumes with the Azure Batch AI SDKs, set the `mount_volumes` (Python) or `MountVolumes` (C#, Java) property on `JobCreateParameters`.</span></span> <span data-ttu-id="51ab8-146">You must provide the storage account's credentials when mounting volumes with Azure Batch AI SDKs.</span><span class="sxs-lookup"><span data-stu-id="51ab8-146">You must provide the storage account's credentials when mounting volumes with Azure Batch AI SDKs.</span></span> <span data-ttu-id="51ab8-147">View the schemas for mounting volumes in [Python](https://docs.microsoft.com/python/api/azure-mgmt-batchai/azure.mgmt.batchai.models.MountVolumes?view=azure-python), [C#](https://docs.microsoft.com/dotnet/api/microsoft.azure.management.batchai.models.mountvolumes?view=azure-dotnet), and [Java](https://docs.microsoft.com/java/api/com.microsoft.azure.management.batchai._mount_volumes?view=azure-java-stable).</span><span class="sxs-lookup"><span data-stu-id="51ab8-147">View the schemas for mounting volumes in [Python](https://docs.microsoft.com/python/api/azure-mgmt-batchai/azure.mgmt.batchai.models.MountVolumes?view=azure-python), [C#](https://docs.microsoft.com/dotnet/api/microsoft.azure.management.batchai.models.mountvolumes?view=azure-dotnet), and [Java](https://docs.microsoft.com/java/api/com.microsoft.azure.management.batchai._mount_volumes?view=azure-java-stable).</span></span>

### <a name="mount-volumes-to-a-cluster"></a><span data-ttu-id="51ab8-148">Mount volumes to a cluster</span><span class="sxs-lookup"><span data-stu-id="51ab8-148">Mount volumes to a cluster</span></span>

<span data-ttu-id="51ab8-149">Batch AI also supports mounting Azure Storage volumes to a Batch AI cluster.</span><span class="sxs-lookup"><span data-stu-id="51ab8-149">Batch AI also supports mounting Azure Storage volumes to a Batch AI cluster.</span></span> <span data-ttu-id="51ab8-150">When a volume is mounted to a cluster, all jobs running on that cluster may use volumes mounted to that cluster.</span><span class="sxs-lookup"><span data-stu-id="51ab8-150">When a volume is mounted to a cluster, all jobs running on that cluster may use volumes mounted to that cluster.</span></span> <span data-ttu-id="51ab8-151">While job-level mounting provides the most flexibility (allowing each job to have different mounted volumes), cluster-level mounting may be sufficient in simple scenarios.</span><span class="sxs-lookup"><span data-stu-id="51ab8-151">While job-level mounting provides the most flexibility (allowing each job to have different mounted volumes), cluster-level mounting may be sufficient in simple scenarios.</span></span>

<span data-ttu-id="51ab8-152">To mount an Azure Storage volume to a cluster created with the Azure CLI, use the `mountVolumes` property in your `cluster.json` file when running `az batchai cluster create`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-152">To mount an Azure Storage volume to a cluster created with the Azure CLI, use the `mountVolumes` property in your `cluster.json` file when running `az batchai cluster create`.</span></span> <span data-ttu-id="51ab8-153">The schema for `mountVolumes` when mounting a cluster is the same as when mounting to a job.</span><span class="sxs-lookup"><span data-stu-id="51ab8-153">The schema for `mountVolumes` when mounting a cluster is the same as when mounting to a job.</span></span> 

<span data-ttu-id="51ab8-154">Similarly, you can use the `mount_volumes` (Python) or `MountVolumes` (C#, Java) property on `ClusterCreateParameters` when mounting with the Azure Batch AI SDKs.</span><span class="sxs-lookup"><span data-stu-id="51ab8-154">Similarly, you can use the `mount_volumes` (Python) or `MountVolumes` (C#, Java) property on `ClusterCreateParameters` when mounting with the Azure Batch AI SDKs.</span></span> 

## <a name="access-mounted-filesystem-in-a-job"></a><span data-ttu-id="51ab8-155">Access mounted filesystem in a job</span><span class="sxs-lookup"><span data-stu-id="51ab8-155">Access mounted filesystem in a job</span></span>

### <a name="azbatchaijobmountroot-environment-variable"></a><span data-ttu-id="51ab8-156">$AZ_BATCHAI_JOB_MOUNT_ROOT environment variable</span><span class="sxs-lookup"><span data-stu-id="51ab8-156">$AZ_BATCHAI_JOB_MOUNT_ROOT environment variable</span></span>

<span data-ttu-id="51ab8-157">Inside the job's execution environment, the directory containing the mounted storage systems can be accessed with the `$AZ_BATCHAI_JOB_MOUNT_ROOT` environment variable (if you use job-level mounting).</span><span class="sxs-lookup"><span data-stu-id="51ab8-157">Inside the job's execution environment, the directory containing the mounted storage systems can be accessed with the `$AZ_BATCHAI_JOB_MOUNT_ROOT` environment variable (if you use job-level mounting).</span></span> <span data-ttu-id="51ab8-158">If you use cluster-level mounting, this environment variable is `$AZ_BATCHAI_MOUNT_ROOT`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-158">If you use cluster-level mounting, this environment variable is `$AZ_BATCHAI_MOUNT_ROOT`.</span></span> <span data-ttu-id="51ab8-159">The following examples assume you use job-level mounting.</span><span class="sxs-lookup"><span data-stu-id="51ab8-159">The following examples assume you use job-level mounting.</span></span>

<span data-ttu-id="51ab8-160">To provide the path of data in a mounted volume, use the environment variable `$AZ_BATCHAI_JOB_MOUNT_ROOT` together with the mounted path.</span><span class="sxs-lookup"><span data-stu-id="51ab8-160">To provide the path of data in a mounted volume, use the environment variable `$AZ_BATCHAI_JOB_MOUNT_ROOT` together with the mounted path.</span></span> <span data-ttu-id="51ab8-161">For example, if the training script `train.py` was uploaded to an Azure File share mounted at relative mount path `scripts`, the file will be available at `$AZ_BATCHAI_JOB_MOUNT_ROOT/scripts/train.py`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-161">For example, if the training script `train.py` was uploaded to an Azure File share mounted at relative mount path `scripts`, the file will be available at `$AZ_BATCHAI_JOB_MOUNT_ROOT/scripts/train.py`.</span></span>

<span data-ttu-id="51ab8-162">If your training script requires knowledge of a path, you should pass it as a command-line argument.</span><span class="sxs-lookup"><span data-stu-id="51ab8-162">If your training script requires knowledge of a path, you should pass it as a command-line argument.</span></span> <span data-ttu-id="51ab8-163">For example, if you stored your data in a folder called `train_data` in an Azure Blob container mounted at path `data`, you could pass `--data-dir=$AZ_BATCHAI_JOB_MOUNT_ROOT/data/train_data` as a command-line argument to your script.</span><span class="sxs-lookup"><span data-stu-id="51ab8-163">For example, if you stored your data in a folder called `train_data` in an Azure Blob container mounted at path `data`, you could pass `--data-dir=$AZ_BATCHAI_JOB_MOUNT_ROOT/data/train_data` as a command-line argument to your script.</span></span> <span data-ttu-id="51ab8-164">Accordingly, you must modify your script to accept command-line arguments.</span><span class="sxs-lookup"><span data-stu-id="51ab8-164">Accordingly, you must modify your script to accept command-line arguments.</span></span>

### <a name="abbreviate-input-paths"></a><span data-ttu-id="51ab8-165">Abbreviate input paths</span><span class="sxs-lookup"><span data-stu-id="51ab8-165">Abbreviate input paths</span></span>

<span data-ttu-id="51ab8-166">To abbreviate input paths as an environment variable, use the `inputDirectories` property of your `job.json` file (or `models.JobCreateParamters.input_directories` if using the Batch AI SDK).</span><span class="sxs-lookup"><span data-stu-id="51ab8-166">To abbreviate input paths as an environment variable, use the `inputDirectories` property of your `job.json` file (or `models.JobCreateParamters.input_directories` if using the Batch AI SDK).</span></span> <span data-ttu-id="51ab8-167">The schema of `inputDirectories` is:</span><span class="sxs-lookup"><span data-stu-id="51ab8-167">The schema of `inputDirectories` is:</span></span>

```json
{
    "inputDirectories": [{
        "id": "<ID>",
        "path": "<PATH>" 
    }]
}
```

<span data-ttu-id="51ab8-168">Each path specified will be placed in an environment variable called `$AZ_BATCHAI_INPUT_<ID>`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-168">Each path specified will be placed in an environment variable called `$AZ_BATCHAI_INPUT_<ID>`.</span></span> <span data-ttu-id="51ab8-169">Using this method can simplify the paths to input files or directories.</span><span class="sxs-lookup"><span data-stu-id="51ab8-169">Using this method can simplify the paths to input files or directories.</span></span> <span data-ttu-id="51ab8-170">For example, to abbreviate the path to a training script: if `"id"` is `"SCRIPT"` and `"path"` is `"$AZ_BATCHAI_JOB_MOUNT_ROOT/scripts/train.py"`, then that path is available at `$AZ_BATCHAI_INPUT_SCRIPT` in the job's execution environment.</span><span class="sxs-lookup"><span data-stu-id="51ab8-170">For example, to abbreviate the path to a training script: if `"id"` is `"SCRIPT"` and `"path"` is `"$AZ_BATCHAI_JOB_MOUNT_ROOT/scripts/train.py"`, then that path is available at `$AZ_BATCHAI_INPUT_SCRIPT` in the job's execution environment.</span></span>

<span data-ttu-id="51ab8-171">For more information, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#input-directories).</span><span class="sxs-lookup"><span data-stu-id="51ab8-171">For more information, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#input-directories).</span></span>

### <a name="abbreviate-output-paths"></a><span data-ttu-id="51ab8-172">Abbreviate output paths</span><span class="sxs-lookup"><span data-stu-id="51ab8-172">Abbreviate output paths</span></span>

<span data-ttu-id="51ab8-173">To abbreviate output paths as an environment variable, use the `outputDirectories` property of your `job.json` file (or `models.JobCreateParamters.output_directories` if using the Batch AI SDK).</span><span class="sxs-lookup"><span data-stu-id="51ab8-173">To abbreviate output paths as an environment variable, use the `outputDirectories` property of your `job.json` file (or `models.JobCreateParamters.output_directories` if using the Batch AI SDK).</span></span> <span data-ttu-id="51ab8-174">Using this method can simplify the paths for output files.</span><span class="sxs-lookup"><span data-stu-id="51ab8-174">Using this method can simplify the paths for output files.</span></span> <span data-ttu-id="51ab8-175">The schema of `outputDirectories` is:</span><span class="sxs-lookup"><span data-stu-id="51ab8-175">The schema of `outputDirectories` is:</span></span>

```json
{
    "outputDirectories": [{
        "id": "<ID>",
        "pathPrefix": "<PATH_PREFIX>",
        "pathSuffix": "<PATH_SUFFIX>"
    }]
}
```

<span data-ttu-id="51ab8-176">Each path specified will be placed in an environment variable called `$AZ_BATCHAI_OUTPUT_<ID>`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-176">Each path specified will be placed in an environment variable called `$AZ_BATCHAI_OUTPUT_<ID>`.</span></span> <span data-ttu-id="51ab8-177">The `pathPrefix` determines the mounted volume to store the output (for example, `"$AZ_BATCHAI_JOB_MOUNT_ROOT/output"`).</span><span class="sxs-lookup"><span data-stu-id="51ab8-177">The `pathPrefix` determines the mounted volume to store the output (for example, `"$AZ_BATCHAI_JOB_MOUNT_ROOT/output"`).</span></span> <span data-ttu-id="51ab8-178">The `pathSuffix` determines the folder name of the output (for example, `"logs"`, `"checkpoints"`).</span><span class="sxs-lookup"><span data-stu-id="51ab8-178">The `pathSuffix` determines the folder name of the output (for example, `"logs"`, `"checkpoints"`).</span></span> <span data-ttu-id="51ab8-179">The actual path of the output is a concatenation of `pathPrefix`, `jobOutputDirectoryPathSegment` (autogenerated for each job) and `pathSuffix`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-179">The actual path of the output is a concatenation of `pathPrefix`, `jobOutputDirectoryPathSegment` (autogenerated for each job) and `pathSuffix`.</span></span>

<span data-ttu-id="51ab8-180">For more information, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#output-directories).</span><span class="sxs-lookup"><span data-stu-id="51ab8-180">For more information, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#output-directories).</span></span>

## <a name="retrieve-job-output-from-azure-storage"></a><span data-ttu-id="51ab8-181">Retrieve job output from Azure Storage</span><span class="sxs-lookup"><span data-stu-id="51ab8-181">Retrieve job output from Azure Storage</span></span>

### <a name="use-azure-portal"></a><span data-ttu-id="51ab8-182">Use Azure portal</span><span class="sxs-lookup"><span data-stu-id="51ab8-182">Use Azure portal</span></span>

<span data-ttu-id="51ab8-183">The Azure portal is a convenient way to view the output of jobs by using a GUI file explorer.</span><span class="sxs-lookup"><span data-stu-id="51ab8-183">The Azure portal is a convenient way to view the output of jobs by using a GUI file explorer.</span></span> <span data-ttu-id="51ab8-184">However, if you wish to view the output from Stdout and Stderr, or from a path in  `outputDirectories`, the files are placed in an autogenerated path in your Azure Storage volume.</span><span class="sxs-lookup"><span data-stu-id="51ab8-184">However, if you wish to view the output from Stdout and Stderr, or from a path in  `outputDirectories`, the files are placed in an autogenerated path in your Azure Storage volume.</span></span> <span data-ttu-id="51ab8-185">See below for more information.</span><span class="sxs-lookup"><span data-stu-id="51ab8-185">See below for more information.</span></span>

### <a name="access-stdout-and-stderr-output"></a><span data-ttu-id="51ab8-186">Access Stdout and Stderr output</span><span class="sxs-lookup"><span data-stu-id="51ab8-186">Access Stdout and Stderr output</span></span>

<span data-ttu-id="51ab8-187">Use the `stdOutErrPathPrefix` property of `job.json` to tell the job where to place the job's execution logs and Stdout and Stderr output.</span><span class="sxs-lookup"><span data-stu-id="51ab8-187">Use the `stdOutErrPathPrefix` property of `job.json` to tell the job where to place the job's execution logs and Stdout and Stderr output.</span></span> <span data-ttu-id="51ab8-188">For example, if you  mounted a file share at relative mount path `outputs`, and you specify the `stdOutErrPathPrefix` to be `"$AZ_BATCHAI_JOB_MOUNT_ROOT/outputs"`, then the Stdout and Stderr job output will be available at `{subscription id}/{resource group}/workspaces/{workspace name}/experiments/{experiment name}/jobs/{job name}/{job uuid}/stdouterr` in that mounted volume.</span><span class="sxs-lookup"><span data-stu-id="51ab8-188">For example, if you  mounted a file share at relative mount path `outputs`, and you specify the `stdOutErrPathPrefix` to be `"$AZ_BATCHAI_JOB_MOUNT_ROOT/outputs"`, then the Stdout and Stderr job output will be available at `{subscription id}/{resource group}/workspaces/{workspace name}/experiments/{experiment name}/jobs/{job name}/{job uuid}/stdouterr` in that mounted volume.</span></span> <span data-ttu-id="51ab8-189">This autogenerated path is used to prevent output collisions between jobs of the same name.</span><span class="sxs-lookup"><span data-stu-id="51ab8-189">This autogenerated path is used to prevent output collisions between jobs of the same name.</span></span>

<span data-ttu-id="51ab8-190">For more information, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#standard-and-error-output).</span><span class="sxs-lookup"><span data-stu-id="51ab8-190">For more information, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#standard-and-error-output).</span></span>

### <a name="list-the-output-files"></a><span data-ttu-id="51ab8-191">List the output files</span><span class="sxs-lookup"><span data-stu-id="51ab8-191">List the output files</span></span>

<span data-ttu-id="51ab8-192">You can use the Azure CLI to list the available output files of a job with the `az batchai job file list` command.</span><span class="sxs-lookup"><span data-stu-id="51ab8-192">You can use the Azure CLI to list the available output files of a job with the `az batchai job file list` command.</span></span> <span data-ttu-id="51ab8-193">For example, to list the files in the standard output directory of a job, use `az batchai job file list -j <JOB_NAME> -g <RESOURCE_GROUP_NAME> -w <WORKSPACE_NAME> -e <EXPERIMENT_NAME>`.</span><span class="sxs-lookup"><span data-stu-id="51ab8-193">For example, to list the files in the standard output directory of a job, use `az batchai job file list -j <JOB_NAME> -g <RESOURCE_GROUP_NAME> -w <WORKSPACE_NAME> -e <EXPERIMENT_NAME>`.</span></span>

<span data-ttu-id="51ab8-194">For more information and examples, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#stream-files-from-output-directories).</span><span class="sxs-lookup"><span data-stu-id="51ab8-194">For more information and examples, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#stream-files-from-output-directories).</span></span>

### <a name="stream-output-files"></a><span data-ttu-id="51ab8-195">Stream output files</span><span class="sxs-lookup"><span data-stu-id="51ab8-195">Stream output files</span></span>

<span data-ttu-id="51ab8-196">You can use the Azure CLI to stream files with the `az batchai job file stream` command.</span><span class="sxs-lookup"><span data-stu-id="51ab8-196">You can use the Azure CLI to stream files with the `az batchai job file stream` command.</span></span> <span data-ttu-id="51ab8-197">For example, to view:</span><span class="sxs-lookup"><span data-stu-id="51ab8-197">For example, to view:</span></span>
- <span data-ttu-id="51ab8-198">Stdout: `az batchai job file stream -j <JOB_NAME> -g <RESOURCE_GROUP_NAME> -w <WORKSPACE_NAME> -e <EXPERIMENT_NAME> -f stdout.txt`</span><span class="sxs-lookup"><span data-stu-id="51ab8-198">Stdout: `az batchai job file stream -j <JOB_NAME> -g <RESOURCE_GROUP_NAME> -w <WORKSPACE_NAME> -e <EXPERIMENT_NAME> -f stdout.txt`</span></span>
- <span data-ttu-id="51ab8-199">Stderr: `az batchai job file stream -j <JOB_NAME> -g <RESOURCE_GROUP_NAME> -w <WORKSPACE_NAME> -e <EXPERIMENT_NAME> -f stderr.txt`</span><span class="sxs-lookup"><span data-stu-id="51ab8-199">Stderr: `az batchai job file stream -j <JOB_NAME> -g <RESOURCE_GROUP_NAME> -w <WORKSPACE_NAME> -e <EXPERIMENT_NAME> -f stderr.txt`</span></span>

<span data-ttu-id="51ab8-200">For more information and examples, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#stream-files-from-output-directories).</span><span class="sxs-lookup"><span data-stu-id="51ab8-200">For more information and examples, see [here](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#stream-files-from-output-directories).</span></span>

## <a name="next-steps"></a><span data-ttu-id="51ab8-201">Next steps</span><span class="sxs-lookup"><span data-stu-id="51ab8-201">Next steps</span></span>
- <span data-ttu-id="51ab8-202">To learn more about CLI commands to interface with Azure Storage, view the [Azure Batch AI CLI documentation](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md).</span><span class="sxs-lookup"><span data-stu-id="51ab8-202">To learn more about CLI commands to interface with Azure Storage, view the [Azure Batch AI CLI documentation](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md).</span></span>
- <span data-ttu-id="51ab8-203">To find more usage examples of Batch AI, including mounting storage and reading output files, see the [Jupyter Notebook recipes for Batch AI](https://github.com/Azure/BatchAI).</span><span class="sxs-lookup"><span data-stu-id="51ab8-203">To find more usage examples of Batch AI, including mounting storage and reading output files, see the [Jupyter Notebook recipes for Batch AI](https://github.com/Azure/BatchAI).</span></span>
- <span data-ttu-id="51ab8-204">Explore other options for mounting storage, including [mounting an NFS server](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#mounting-nfs) and [mounting your own NFS, cifs, or GlusterFS cluster](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#mounting-nfs)</span><span class="sxs-lookup"><span data-stu-id="51ab8-204">Explore other options for mounting storage, including [mounting an NFS server](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#mounting-nfs) and [mounting your own NFS, cifs, or GlusterFS cluster](https://github.com/Azure/BatchAI/blob/master/documentation/using-azure-cli-20.md#mounting-nfs)</span></span>