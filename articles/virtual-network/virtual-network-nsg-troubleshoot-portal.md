---
title: Troubleshoot Network Security Groups - Portal | Microsoft Docs
description: Learn how to troubleshoot Network Security Groups in the Azure Resource Manager deployment model using the Azure Portal.
services: virtual-network
documentationcenter: na
author: AnithaAdusumilli
manager: narayan
editor: ''
tags: azure-resource-manager
ms.assetid: a54feccf-0123-4e49-a743-eb8d0bdd1ebc
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 09/23/2016
ms.author: anithaa
ms.openlocfilehash: 6419c7590bf5dac8639eb08a70de93e92a6f2ceb
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44564208"
---
# <a name="troubleshoot-network-security-groups-using-the-azure-portal"></a><span data-ttu-id="0e0ac-103">Troubleshoot Network Security Groups using the Azure Portal</span><span class="sxs-lookup"><span data-stu-id="0e0ac-103">Troubleshoot Network Security Groups using the Azure Portal</span></span>
> [!div class="op_single_selector"]
> * [Azure Portal](virtual-network-nsg-troubleshoot-portal.md)
> * [PowerShell](virtual-network-nsg-troubleshoot-powershell.md)
> 
> 

<span data-ttu-id="0e0ac-106">If you configured Network Security Groups (NSGs) on your virtual machine (VM) and are experiencing VM connectivity issues, this article provides an overview of diagnostics capabilities for NSGs to help troubleshoot further.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-106">If you configured Network Security Groups (NSGs) on your virtual machine (VM) and are experiencing VM connectivity issues, this article provides an overview of diagnostics capabilities for NSGs to help troubleshoot further.</span></span>

<span data-ttu-id="0e0ac-107">NSGs enable you to control the types of traffic that flow in and out of your virtual machines (VMs).</span><span class="sxs-lookup"><span data-stu-id="0e0ac-107">NSGs enable you to control the types of traffic that flow in and out of your virtual machines (VMs).</span></span> <span data-ttu-id="0e0ac-108">NSGs can be applied to subnets in an Azure Virtual Network (VNet), network interfaces (NIC), or both.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-108">NSGs can be applied to subnets in an Azure Virtual Network (VNet), network interfaces (NIC), or both.</span></span> <span data-ttu-id="0e0ac-109">The effective rules applied to a NIC are an aggregation of the rules that exist in the NSGs applied to a NIC and the subnet it is connected to.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-109">The effective rules applied to a NIC are an aggregation of the rules that exist in the NSGs applied to a NIC and the subnet it is connected to.</span></span> <span data-ttu-id="0e0ac-110">Rules across these NSGs can sometimes conflict with each other and impact a VM's network connectivity.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-110">Rules across these NSGs can sometimes conflict with each other and impact a VM's network connectivity.</span></span>  

<span data-ttu-id="0e0ac-111">You can view all the effective security rules from your NSGs, as applied on your VM's NICs.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-111">You can view all the effective security rules from your NSGs, as applied on your VM's NICs.</span></span> <span data-ttu-id="0e0ac-112">This article shows how to troubleshoot VM connectivity issues using these rules in the Azure Resource Manager deployment model.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-112">This article shows how to troubleshoot VM connectivity issues using these rules in the Azure Resource Manager deployment model.</span></span> <span data-ttu-id="0e0ac-113">If you're not familiar with VNet and NSG concepts, read the [Virtual network](virtual-networks-overview.md) and [Network security groups](virtual-networks-nsg.md) overview articles.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-113">If you're not familiar with VNet and NSG concepts, read the [Virtual network](virtual-networks-overview.md) and [Network security groups](virtual-networks-nsg.md) overview articles.</span></span>

## <a name="using-effective-security-rules-to-troubleshoot-vm-traffic-flow"></a><span data-ttu-id="0e0ac-114">Using Effective Security Rules to troubleshoot VM traffic flow</span><span class="sxs-lookup"><span data-stu-id="0e0ac-114">Using Effective Security Rules to troubleshoot VM traffic flow</span></span>
<span data-ttu-id="0e0ac-115">The scenario that follows is an example of a common connection problem:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-115">The scenario that follows is an example of a common connection problem:</span></span>

<span data-ttu-id="0e0ac-116">A VM named *VM1* is part of a subnet named *Subnet1* within a VNet named *WestUS-VNet1*.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-116">A VM named *VM1* is part of a subnet named *Subnet1* within a VNet named *WestUS-VNet1*.</span></span> <span data-ttu-id="0e0ac-117">An attempt to connect to the VM using RDP over TCP port 3389 fails.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-117">An attempt to connect to the VM using RDP over TCP port 3389 fails.</span></span> <span data-ttu-id="0e0ac-118">NSGs are applied at both the NIC *VM1-NIC1* and the subnet *Subnet1*.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-118">NSGs are applied at both the NIC *VM1-NIC1* and the subnet *Subnet1*.</span></span> <span data-ttu-id="0e0ac-119">Traffic to TCP port 3389 is allowed in the NSG associated with the network interface *VM1-NIC1*, however TCP ping to VM1's port 3389 fails.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-119">Traffic to TCP port 3389 is allowed in the NSG associated with the network interface *VM1-NIC1*, however TCP ping to VM1's port 3389 fails.</span></span>

<span data-ttu-id="0e0ac-120">While this example uses TCP port 3389, the following steps can be used to determine inbound and outbound connection failures over any port.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-120">While this example uses TCP port 3389, the following steps can be used to determine inbound and outbound connection failures over any port.</span></span>

### <a name="view-effective-security-rules-for-a-virtual-machine"></a><span data-ttu-id="0e0ac-121">View effective security rules for a virtual machine</span><span class="sxs-lookup"><span data-stu-id="0e0ac-121">View effective security rules for a virtual machine</span></span>
<span data-ttu-id="0e0ac-122">Complete the following steps to troubleshoot NSGs for a VM:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-122">Complete the following steps to troubleshoot NSGs for a VM:</span></span>

<span data-ttu-id="0e0ac-123">You can view full list of the effective security rules on a NIC, from the VM itself.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-123">You can view full list of the effective security rules on a NIC, from the VM itself.</span></span> <span data-ttu-id="0e0ac-124">You can also add, modify, and delete both NIC and subnet NSG rules from the effective rules blade, if you have permissions to perform these operations.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-124">You can also add, modify, and delete both NIC and subnet NSG rules from the effective rules blade, if you have permissions to perform these operations.</span></span>

1. <span data-ttu-id="0e0ac-125">Login to the Azure portal at https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-125">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="0e0ac-126">Click **More services**, then click **Virtual machines** in the list that appears.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-126">Click **More services**, then click **Virtual machines** in the list that appears.</span></span>
3. <span data-ttu-id="0e0ac-127">Select a VM to troubleshoot from the list that appears and a VM blade with options appears.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-127">Select a VM to troubleshoot from the list that appears and a VM blade with options appears.</span></span>
4. <span data-ttu-id="0e0ac-128">Click **Diagnose & solve problems** and then select a common problem.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-128">Click **Diagnose & solve problems** and then select a common problem.</span></span> <span data-ttu-id="0e0ac-129">For this example, **I can’t connect to my Windows VM** is selected.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-129">For this example, **I can’t connect to my Windows VM** is selected.</span></span> 
   
    ![](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-troubleshoot-portal/image1.png)
5. <span data-ttu-id="0e0ac-130">Steps appear under the problem, as shown in the following picture:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-130">Steps appear under the problem, as shown in the following picture:</span></span> 
   
    ![](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-troubleshoot-portal/image2.png)
   
    <span data-ttu-id="0e0ac-131">Click *effective security group rules* in the list of recommended steps.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-131">Click *effective security group rules* in the list of recommended steps.</span></span>
6. <span data-ttu-id="0e0ac-132">The **Get effective security rules** blade appears, as shown in the following picture:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-132">The **Get effective security rules** blade appears, as shown in the following picture:</span></span>
   
    ![](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-troubleshoot-portal/image3.png)
   
    <span data-ttu-id="0e0ac-133">Notice the following sections of the picture:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-133">Notice the following sections of the picture:</span></span>
   
   * <span data-ttu-id="0e0ac-134">**Scope:** Set to *VM1*, the VM selected in step 3.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-134">**Scope:** Set to *VM1*, the VM selected in step 3.</span></span>
   * <span data-ttu-id="0e0ac-135">**Network interface:** *VM1-NIC1* is selected.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-135">**Network interface:** *VM1-NIC1* is selected.</span></span> <span data-ttu-id="0e0ac-136">A VM can have multiple network interfaces (NIC).</span><span class="sxs-lookup"><span data-stu-id="0e0ac-136">A VM can have multiple network interfaces (NIC).</span></span> <span data-ttu-id="0e0ac-137">Each NIC can have unique effective security rules.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-137">Each NIC can have unique effective security rules.</span></span> <span data-ttu-id="0e0ac-138">When troubleshooting, you may need to view the effective security rules for each NIC.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-138">When troubleshooting, you may need to view the effective security rules for each NIC.</span></span>
   * <span data-ttu-id="0e0ac-139">**Associated NSGs:** NSGs can be applied to both the NIC and the subnet the NIC is connected to.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-139">**Associated NSGs:** NSGs can be applied to both the NIC and the subnet the NIC is connected to.</span></span> <span data-ttu-id="0e0ac-140">In the picture, an NSG has been applied to both the NIC and the subnet it's connected to.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-140">In the picture, an NSG has been applied to both the NIC and the subnet it's connected to.</span></span> <span data-ttu-id="0e0ac-141">You can click on the NSG names to directly modify rules in the NSGs.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-141">You can click on the NSG names to directly modify rules in the NSGs.</span></span>
   * <span data-ttu-id="0e0ac-142">**VM1-nsg tab:** The list of rules displayed in the picture is for the NSG applied to the NIC.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-142">**VM1-nsg tab:** The list of rules displayed in the picture is for the NSG applied to the NIC.</span></span> <span data-ttu-id="0e0ac-143">Several default rules are created by Azure whenever an NSG is created.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-143">Several default rules are created by Azure whenever an NSG is created.</span></span> <span data-ttu-id="0e0ac-144">You can't remove the default rules, but you can override them with rules of higher priority.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-144">You can't remove the default rules, but you can override them with rules of higher priority.</span></span> <span data-ttu-id="0e0ac-145">To learn more about default rules, read the [NSG overview](virtual-networks-nsg.md#default-rules) article.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-145">To learn more about default rules, read the [NSG overview](virtual-networks-nsg.md#default-rules) article.</span></span>
   * <span data-ttu-id="0e0ac-146">**DESTINATION column:** Some of the rules have text in the column, while others have address prefixes.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-146">**DESTINATION column:** Some of the rules have text in the column, while others have address prefixes.</span></span> <span data-ttu-id="0e0ac-147">The text is the name of default tags applied to the security rule when it was created.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-147">The text is the name of default tags applied to the security rule when it was created.</span></span> <span data-ttu-id="0e0ac-148">The tags are system-provided identifiers that represent multiple prefixes.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-148">The tags are system-provided identifiers that represent multiple prefixes.</span></span> <span data-ttu-id="0e0ac-149">Selecting a rule with a tag, such as *AllowInternetOutBound*, lists the prefixes in the **Address prefixes** blade.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-149">Selecting a rule with a tag, such as *AllowInternetOutBound*, lists the prefixes in the **Address prefixes** blade.</span></span>
   * <span data-ttu-id="0e0ac-150">**Download:** The list of rules can be long.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-150">**Download:** The list of rules can be long.</span></span> <span data-ttu-id="0e0ac-151">You can download a .csv file of the rules for offline analysis by clicking **Download** and saving the file.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-151">You can download a .csv file of the rules for offline analysis by clicking **Download** and saving the file.</span></span>
   * <span data-ttu-id="0e0ac-152">**AllowRDP** Inbound rule: This rule allows RDP connections to the VM.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-152">**AllowRDP** Inbound rule: This rule allows RDP connections to the VM.</span></span>
7. <span data-ttu-id="0e0ac-153">Click the **Subnet1-NSG** tab to view the effective rules from the NSG applied to the subnet, as shown in the following picture:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-153">Click the **Subnet1-NSG** tab to view the effective rules from the NSG applied to the subnet, as shown in the following picture:</span></span> 
   
    ![](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-troubleshoot-portal/image4.png)
   
    <span data-ttu-id="0e0ac-154">Notice the *denyRDP* **Inbound** rule.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-154">Notice the *denyRDP* **Inbound** rule.</span></span> <span data-ttu-id="0e0ac-155">Inbound rules applied at the subnet are evaluated before rules applied at the network interface.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-155">Inbound rules applied at the subnet are evaluated before rules applied at the network interface.</span></span> <span data-ttu-id="0e0ac-156">Since the deny rule is applied at the subnet, the request to connect to TCP 3389 fails, because the allow rule at the NIC is never evaluated.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-156">Since the deny rule is applied at the subnet, the request to connect to TCP 3389 fails, because the allow rule at the NIC is never evaluated.</span></span> 
   
    <span data-ttu-id="0e0ac-157">The *denyRDP* rule is the reason why the RDP connection is failing.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-157">The *denyRDP* rule is the reason why the RDP connection is failing.</span></span> <span data-ttu-id="0e0ac-158">Removing it should resolve the problem.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-158">Removing it should resolve the problem.</span></span>
   
   > [!NOTE]
   > If the VM associated with the NIC is not in a running state, or NSGs haven't been applied to the NIC or subnet, no rules are shown.
   > 
   > 
8. <span data-ttu-id="0e0ac-160">To edit NSG rules, click *Subnet1-NSG* in the **Associated NSGs** section.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-160">To edit NSG rules, click *Subnet1-NSG* in the **Associated NSGs** section.</span></span>
   <span data-ttu-id="0e0ac-161">This opens the **Subnet1-NSG** blade.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-161">This opens the **Subnet1-NSG** blade.</span></span> <span data-ttu-id="0e0ac-162">You can directly edit the rules by clicking on **Inbound security rules**.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-162">You can directly edit the rules by clicking on **Inbound security rules**.</span></span>
   
    ![](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-troubleshoot-portal/image7.png)
9. <span data-ttu-id="0e0ac-163">After removing the *denyRDP* inbound rule in the **Subnet1-NSG** and adding an *allowRDP* rule, the effective rules list looks like the following picture:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-163">After removing the *denyRDP* inbound rule in the **Subnet1-NSG** and adding an *allowRDP* rule, the effective rules list looks like the following picture:</span></span>
   
    ![](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-troubleshoot-portal/image8.png)
   
    <span data-ttu-id="0e0ac-164">Confirm that TCP port 3389 is open by opening an RDP connection to the VM or using the PsPing tool.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-164">Confirm that TCP port 3389 is open by opening an RDP connection to the VM or using the PsPing tool.</span></span> <span data-ttu-id="0e0ac-165">You can learn more about PsPing by reading the [PsPing download page](https://technet.microsoft.com/sysinternals/psping.aspx).</span><span class="sxs-lookup"><span data-stu-id="0e0ac-165">You can learn more about PsPing by reading the [PsPing download page](https://technet.microsoft.com/sysinternals/psping.aspx).</span></span>

### <a name="view-effective-security-rules-for-a-network-interface"></a><span data-ttu-id="0e0ac-166">View effective security rules for a network interface</span><span class="sxs-lookup"><span data-stu-id="0e0ac-166">View effective security rules for a network interface</span></span>
<span data-ttu-id="0e0ac-167">If your VM traffic flow is impacted for a specific NIC, you can view a full list of the effective rules for the NIC from the network interfaces context by completing the following steps:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-167">If your VM traffic flow is impacted for a specific NIC, you can view a full list of the effective rules for the NIC from the network interfaces context by completing the following steps:</span></span>

1. <span data-ttu-id="0e0ac-168">Login to the Azure portal at https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-168">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="0e0ac-169">Click **More services**, then click **Network interfaces** in the list that appears.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-169">Click **More services**, then click **Network interfaces** in the list that appears.</span></span>
3. <span data-ttu-id="0e0ac-170">Select a network interface.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-170">Select a network interface.</span></span> <span data-ttu-id="0e0ac-171">In the following picture, a NIC named *VM1-NIC1* is selected.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-171">In the following picture, a NIC named *VM1-NIC1* is selected.</span></span>
   
    ![](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-troubleshoot-portal/image5.png)
   
    <span data-ttu-id="0e0ac-172">Notice that the **Scope** is set to the network interface selected.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-172">Notice that the **Scope** is set to the network interface selected.</span></span> <span data-ttu-id="0e0ac-173">To learn more about the additional information shown, read step 6 of the **Troubleshoot NSGs for a VM** section of this article.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-173">To learn more about the additional information shown, read step 6 of the **Troubleshoot NSGs for a VM** section of this article.</span></span>
   
   > [!NOTE]
   > If an NSG is removed from a network interface, the subnet NSG is still effective on the given NIC. In this case, the output would only show rules from the subnet NSG. Rules only appear if the NIC is attached to a VM.
   > 
   > 
4. <span data-ttu-id="0e0ac-177">You can directly edit rules for NSGs associated with a NIC and a subnet.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-177">You can directly edit rules for NSGs associated with a NIC and a subnet.</span></span> <span data-ttu-id="0e0ac-178">To learn how, read step 8 of the **View effective security rules for a virtual machine** section of this article.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-178">To learn how, read step 8 of the **View effective security rules for a virtual machine** section of this article.</span></span>

## <a name="view-effective-security-rules-for-a-network-security-group-nsg"></a><span data-ttu-id="0e0ac-179">View effective security rules for a network security group (NSG)</span><span class="sxs-lookup"><span data-stu-id="0e0ac-179">View effective security rules for a network security group (NSG)</span></span>
<span data-ttu-id="0e0ac-180">When modifying NSG rules, you may want to review the impact of the rules being added on a particular VM.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-180">When modifying NSG rules, you may want to review the impact of the rules being added on a particular VM.</span></span> <span data-ttu-id="0e0ac-181">You can view a full list of the effective security rules for all the NICs that a given NSG is applied to, without having to switch context from the given NSG blade.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-181">You can view a full list of the effective security rules for all the NICs that a given NSG is applied to, without having to switch context from the given NSG blade.</span></span> <span data-ttu-id="0e0ac-182">To troubleshoot effective rules within an NSG, complete the following steps:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-182">To troubleshoot effective rules within an NSG, complete the following steps:</span></span>

1. <span data-ttu-id="0e0ac-183">Login to the Azure portal at https://portal.azure.com.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-183">Login to the Azure portal at https://portal.azure.com.</span></span>
2. <span data-ttu-id="0e0ac-184">Click **More services**, then click **Network security groups** in the list that appears.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-184">Click **More services**, then click **Network security groups** in the list that appears.</span></span>
3. <span data-ttu-id="0e0ac-185">Select an NSG.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-185">Select an NSG.</span></span> <span data-ttu-id="0e0ac-186">In the following picture, an NSG named VM1-nsg was selected.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-186">In the following picture, an NSG named VM1-nsg was selected.</span></span>
   
    ![](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-troubleshoot-portal/image6.png)
   
    <span data-ttu-id="0e0ac-187">Notice the following sections of the previous picture:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-187">Notice the following sections of the previous picture:</span></span>
   
   * <span data-ttu-id="0e0ac-188">**Scope:** Set to the NSG selected.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-188">**Scope:** Set to the NSG selected.</span></span>
   * <span data-ttu-id="0e0ac-189">**Virtual machine:** When an NSG is applied to a subnet, it's applied to all network interfaces attached to all VMs connected to the subnet.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-189">**Virtual machine:** When an NSG is applied to a subnet, it's applied to all network interfaces attached to all VMs connected to the subnet.</span></span> <span data-ttu-id="0e0ac-190">This list shows all VMs this NSG is applied to.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-190">This list shows all VMs this NSG is applied to.</span></span> <span data-ttu-id="0e0ac-191">You can select any VM from the list.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-191">You can select any VM from the list.</span></span>
     
     > [!NOTE]
     > If an NSG is applied to only an empty subnet, VMs will not be listed. If an NSG is applied to a NIC which is not associated with a VM, those NICs will also not be listed. 
     > 
     > 
   * <span data-ttu-id="0e0ac-194">**Network Interface:** A VM can have multiple network interfaces.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-194">**Network Interface:** A VM can have multiple network interfaces.</span></span> <span data-ttu-id="0e0ac-195">You can select a network interface attached to the selected VM.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-195">You can select a network interface attached to the selected VM.</span></span>
   * <span data-ttu-id="0e0ac-196">**AssociatedNSGs:** At any time, a NIC can have up to two effective NSGs, one applied to the NIC and the other to the subnet.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-196">**AssociatedNSGs:** At any time, a NIC can have up to two effective NSGs, one applied to the NIC and the other to the subnet.</span></span> <span data-ttu-id="0e0ac-197">Although the scope is selected as VM1-nsg, if the NIC has an effective subnet NSG, the output will show both NSGs.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-197">Although the scope is selected as VM1-nsg, if the NIC has an effective subnet NSG, the output will show both NSGs.</span></span>
4. <span data-ttu-id="0e0ac-198">You can directly edit rules for NSGs associated with a NIC or subnet.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-198">You can directly edit rules for NSGs associated with a NIC or subnet.</span></span> <span data-ttu-id="0e0ac-199">To learn how, read step 8 of the **View effective security rules for a virtual machine** section of this article.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-199">To learn how, read step 8 of the **View effective security rules for a virtual machine** section of this article.</span></span>

<span data-ttu-id="0e0ac-200">To learn more about the additional information shown, read step 6 of the **View effective security rules for a virtual machine** section of this article.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-200">To learn more about the additional information shown, read step 6 of the **View effective security rules for a virtual machine** section of this article.</span></span>

> [!NOTE]
> Though a subnet and NIC can each have only one NSG applied to them, an NSG can be associated to multiple NICs and multiple subnets.
> 
> 

## <a name="considerations"></a><span data-ttu-id="0e0ac-202">Considerations</span><span class="sxs-lookup"><span data-stu-id="0e0ac-202">Considerations</span></span>
<span data-ttu-id="0e0ac-203">Consider the following points when troubleshooting connectivity problems:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-203">Consider the following points when troubleshooting connectivity problems:</span></span>

* <span data-ttu-id="0e0ac-204">Default NSG rules will block inbound access from the internet and only permit VNet inbound traffic.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-204">Default NSG rules will block inbound access from the internet and only permit VNet inbound traffic.</span></span> <span data-ttu-id="0e0ac-205">Rules should be explicitly added to allow inbound access from Internet, as required.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-205">Rules should be explicitly added to allow inbound access from Internet, as required.</span></span>
* <span data-ttu-id="0e0ac-206">If there are no NSG security rules causing a VM’s network connectivity to fail, the problem may be due to:</span><span class="sxs-lookup"><span data-stu-id="0e0ac-206">If there are no NSG security rules causing a VM’s network connectivity to fail, the problem may be due to:</span></span>
  * <span data-ttu-id="0e0ac-207">Firewall software running within the VM's operating system</span><span class="sxs-lookup"><span data-stu-id="0e0ac-207">Firewall software running within the VM's operating system</span></span>
  * <span data-ttu-id="0e0ac-208">Routes configured for virtual appliances or on-premises traffic.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-208">Routes configured for virtual appliances or on-premises traffic.</span></span> <span data-ttu-id="0e0ac-209">Internet traffic can be redirected to on-premises via forced-tunneling.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-209">Internet traffic can be redirected to on-premises via forced-tunneling.</span></span> <span data-ttu-id="0e0ac-210">An RDP/SSH connection from the Internet to your VM may not work with this setting, depending on how the on-premises network hardware handles this traffic.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-210">An RDP/SSH connection from the Internet to your VM may not work with this setting, depending on how the on-premises network hardware handles this traffic.</span></span> <span data-ttu-id="0e0ac-211">Read the [Troubleshooting Routes](virtual-network-routes-troubleshoot-powershell.md) article to learn how to diagnose route problems that may be impeding the flow of traffic in and out of the VM.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-211">Read the [Troubleshooting Routes](virtual-network-routes-troubleshoot-powershell.md) article to learn how to diagnose route problems that may be impeding the flow of traffic in and out of the VM.</span></span> 
* <span data-ttu-id="0e0ac-212">If you have peered VNets, by default, the VIRTUAL_NETWORK tag will automatically expand to include prefixes for peered VNets.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-212">If you have peered VNets, by default, the VIRTUAL_NETWORK tag will automatically expand to include prefixes for peered VNets.</span></span> <span data-ttu-id="0e0ac-213">You can view these prefixes in the **ExpandedAddressPrefix** list, to troubleshoot any issues related to VNet peering connectivity.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-213">You can view these prefixes in the **ExpandedAddressPrefix** list, to troubleshoot any issues related to VNet peering connectivity.</span></span> 
* <span data-ttu-id="0e0ac-214">Effective security rules are only shown if there is an NSG associated with the VM’s NIC and or subnet.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-214">Effective security rules are only shown if there is an NSG associated with the VM’s NIC and or subnet.</span></span> 
* <span data-ttu-id="0e0ac-215">If there are no NSGs associated with the NIC or subnet and you have a public IP address assigned to your VM, all ports will be open for inbound and outbound access.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-215">If there are no NSGs associated with the NIC or subnet and you have a public IP address assigned to your VM, all ports will be open for inbound and outbound access.</span></span> <span data-ttu-id="0e0ac-216">If the VM has a public IP address, applying NSGs to the NIC or subnet is strongly recommended.</span><span class="sxs-lookup"><span data-stu-id="0e0ac-216">If the VM has a public IP address, applying NSGs to the NIC or subnet is strongly recommended.</span></span>









