---
title: Azure Virtual Network (VNet) Plan and Design Guide | Microsoft Docs
description: Learn how to plan and design virtual networks in Azure based on your isolation, connectivity, and location requirements.
services: virtual-network
documentationcenter: na
author: jimdial
manager: carmonm
editor: tysonn
ms.assetid: 3a4a9aea-7608-4d2e-bb3c-40de2e537200
ms.service: virtual-network
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/08/2016
ms.author: jdial
ms.openlocfilehash: 601e97a2ad7ee18a3e6ff634f7eb2083791e71cc
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44553603"
---
# <a name="plan-and-design-azure-virtual-networks"></a><span data-ttu-id="439d5-103">Plan and design Azure Virtual Networks</span><span class="sxs-lookup"><span data-stu-id="439d5-103">Plan and design Azure Virtual Networks</span></span>
<span data-ttu-id="439d5-104">Creating a VNet to experiment with is easy enough, but chances are, you will deploy multiple VNets over time to support the production needs of your organization.</span><span class="sxs-lookup"><span data-stu-id="439d5-104">Creating a VNet to experiment with is easy enough, but chances are, you will deploy multiple VNets over time to support the production needs of your organization.</span></span> <span data-ttu-id="439d5-105">With some planning and design, you will be able to deploy VNets and connect the resources you need more effectively.</span><span class="sxs-lookup"><span data-stu-id="439d5-105">With some planning and design, you will be able to deploy VNets and connect the resources you need more effectively.</span></span> <span data-ttu-id="439d5-106">If you are not familiar with VNets, it's recommended that you [learn about VNets](virtual-networks-overview.md) and [how to deploy](virtual-networks-create-vnet-arm-pportal.md) one before proceeding.</span><span class="sxs-lookup"><span data-stu-id="439d5-106">If you are not familiar with VNets, it's recommended that you [learn about VNets](virtual-networks-overview.md) and [how to deploy](virtual-networks-create-vnet-arm-pportal.md) one before proceeding.</span></span>

## <a name="plan"></a><span data-ttu-id="439d5-107">Plan</span><span class="sxs-lookup"><span data-stu-id="439d5-107">Plan</span></span>
<span data-ttu-id="439d5-108">A thorough understanding of Azure subscriptions, regions, and network resources is critical for success.</span><span class="sxs-lookup"><span data-stu-id="439d5-108">A thorough understanding of Azure subscriptions, regions, and network resources is critical for success.</span></span> <span data-ttu-id="439d5-109">You can use the list of considerations below as a starting point.</span><span class="sxs-lookup"><span data-stu-id="439d5-109">You can use the list of considerations below as a starting point.</span></span> <span data-ttu-id="439d5-110">Once you understand those considerations, you can define the requirements for your network design.</span><span class="sxs-lookup"><span data-stu-id="439d5-110">Once you understand those considerations, you can define the requirements for your network design.</span></span>

### <a name="considerations"></a><span data-ttu-id="439d5-111">Considerations</span><span class="sxs-lookup"><span data-stu-id="439d5-111">Considerations</span></span>
<span data-ttu-id="439d5-112">Before answering the planning questions below, consider the following:</span><span class="sxs-lookup"><span data-stu-id="439d5-112">Before answering the planning questions below, consider the following:</span></span>

* <span data-ttu-id="439d5-113">Everything you create in Azure is composed of one or more resources.</span><span class="sxs-lookup"><span data-stu-id="439d5-113">Everything you create in Azure is composed of one or more resources.</span></span> <span data-ttu-id="439d5-114">A virtual machine (VM) is a resource, the network adapter interface (NIC) used by a VM is a resource, the public IP address used by a NIC is a resource, the VNet the NIC is connected to is a resource.</span><span class="sxs-lookup"><span data-stu-id="439d5-114">A virtual machine (VM) is a resource, the network adapter interface (NIC) used by a VM is a resource, the public IP address used by a NIC is a resource, the VNet the NIC is connected to is a resource.</span></span>
* <span data-ttu-id="439d5-115">You create resources within an [Azure region](https://azure.microsoft.com/regions/#services) and subscription.</span><span class="sxs-lookup"><span data-stu-id="439d5-115">You create resources within an [Azure region](https://azure.microsoft.com/regions/#services) and subscription.</span></span> <span data-ttu-id="439d5-116">And resources can only be connected to a VNet that exists in the same region and subscription they are in.</span><span class="sxs-lookup"><span data-stu-id="439d5-116">And resources can only be connected to a VNet that exists in the same region and subscription they are in.</span></span>
* <span data-ttu-id="439d5-117">You can connect VNets to each other by using an Azure [VPN Gateway](../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md).</span><span class="sxs-lookup"><span data-stu-id="439d5-117">You can connect VNets to each other by using an Azure [VPN Gateway](../vpn-gateway/vpn-gateway-vnet-vnet-rm-ps.md).</span></span> <span data-ttu-id="439d5-118">You can also connect VNets across regions and subscriptions this way.</span><span class="sxs-lookup"><span data-stu-id="439d5-118">You can also connect VNets across regions and subscriptions this way.</span></span>
* <span data-ttu-id="439d5-119">You can connect VNets to your on-premises network by using one of the [connectivity options](../vpn-gateway/vpn-gateway-about-vpngateways.md#site-to-site-and-multi-site-ipsecike-vpn-tunnel) available in Azure.</span><span class="sxs-lookup"><span data-stu-id="439d5-119">You can connect VNets to your on-premises network by using one of the [connectivity options](../vpn-gateway/vpn-gateway-about-vpngateways.md#site-to-site-and-multi-site-ipsecike-vpn-tunnel) available in Azure.</span></span>
* <span data-ttu-id="439d5-120">Different resources can be grouped together in [resource groups](../azure-resource-manager/resource-group-overview.md#resource-groups), making it easier to manage the resource as a unit.</span><span class="sxs-lookup"><span data-stu-id="439d5-120">Different resources can be grouped together in [resource groups](../azure-resource-manager/resource-group-overview.md#resource-groups), making it easier to manage the resource as a unit.</span></span> <span data-ttu-id="439d5-121">A resource group can contain resources from multiple regions, as long as the resources belong to the same subscription.</span><span class="sxs-lookup"><span data-stu-id="439d5-121">A resource group can contain resources from multiple regions, as long as the resources belong to the same subscription.</span></span>

### <a name="define-requirements"></a><span data-ttu-id="439d5-122">Define requirements</span><span class="sxs-lookup"><span data-stu-id="439d5-122">Define requirements</span></span>
<span data-ttu-id="439d5-123">Use the questions below as a starting point for your Azure network design.</span><span class="sxs-lookup"><span data-stu-id="439d5-123">Use the questions below as a starting point for your Azure network design.</span></span>    

1. <span data-ttu-id="439d5-124">What Azure locations will you use to host VNets?</span><span class="sxs-lookup"><span data-stu-id="439d5-124">What Azure locations will you use to host VNets?</span></span>
2. <span data-ttu-id="439d5-125">Do you need to provide communication between these Azure locations?</span><span class="sxs-lookup"><span data-stu-id="439d5-125">Do you need to provide communication between these Azure locations?</span></span>
3. <span data-ttu-id="439d5-126">Do you need to provide communication between your Azure VNet(s) and your on-premises datacenter(s)?</span><span class="sxs-lookup"><span data-stu-id="439d5-126">Do you need to provide communication between your Azure VNet(s) and your on-premises datacenter(s)?</span></span>
4. <span data-ttu-id="439d5-127">How many Infrastructure as a Service (IaaS) VMs, cloud services roles, and web apps do you need for your solution?</span><span class="sxs-lookup"><span data-stu-id="439d5-127">How many Infrastructure as a Service (IaaS) VMs, cloud services roles, and web apps do you need for your solution?</span></span>
5. <span data-ttu-id="439d5-128">Do you need to isolate traffic based on groups of VMs (i.e. front end web servers and back end database servers)?</span><span class="sxs-lookup"><span data-stu-id="439d5-128">Do you need to isolate traffic based on groups of VMs (i.e. front end web servers and back end database servers)?</span></span>
6. <span data-ttu-id="439d5-129">Do you need to control traffic flow using virtual appliances?</span><span class="sxs-lookup"><span data-stu-id="439d5-129">Do you need to control traffic flow using virtual appliances?</span></span>
7. <span data-ttu-id="439d5-130">Do users need different sets of permissions to different Azure resources?</span><span class="sxs-lookup"><span data-stu-id="439d5-130">Do users need different sets of permissions to different Azure resources?</span></span>

### <a name="understand-vnet-and-subnet-properties"></a><span data-ttu-id="439d5-131">Understand VNet and subnet properties</span><span class="sxs-lookup"><span data-stu-id="439d5-131">Understand VNet and subnet properties</span></span>
<span data-ttu-id="439d5-132">VNet and subnets resources help define a security boundary for workloads running in Azure.</span><span class="sxs-lookup"><span data-stu-id="439d5-132">VNet and subnets resources help define a security boundary for workloads running in Azure.</span></span> <span data-ttu-id="439d5-133">A VNet is characterized by a collection of address spaces, defined as CIDR blocks.</span><span class="sxs-lookup"><span data-stu-id="439d5-133">A VNet is characterized by a collection of address spaces, defined as CIDR blocks.</span></span>

> [!NOTE]
> <span data-ttu-id="439d5-134">Network administrators are familiar with CIDR notation.</span><span class="sxs-lookup"><span data-stu-id="439d5-134">Network administrators are familiar with CIDR notation.</span></span> <span data-ttu-id="439d5-135">If you are not familiar with CIDR, [learn more about it](http://whatismyipaddress.com/cidr).</span><span class="sxs-lookup"><span data-stu-id="439d5-135">If you are not familiar with CIDR, [learn more about it](http://whatismyipaddress.com/cidr).</span></span>
>
>

<span data-ttu-id="439d5-136">VNets contain the following properties.</span><span class="sxs-lookup"><span data-stu-id="439d5-136">VNets contain the following properties.</span></span>

| <span data-ttu-id="439d5-137">Property</span><span class="sxs-lookup"><span data-stu-id="439d5-137">Property</span></span> | <span data-ttu-id="439d5-138">Description</span><span class="sxs-lookup"><span data-stu-id="439d5-138">Description</span></span> | <span data-ttu-id="439d5-139">Constraints</span><span class="sxs-lookup"><span data-stu-id="439d5-139">Constraints</span></span> |
| --- | --- | --- |
| <span data-ttu-id="439d5-140">**name**</span><span class="sxs-lookup"><span data-stu-id="439d5-140">**name**</span></span> |<span data-ttu-id="439d5-141">VNet name</span><span class="sxs-lookup"><span data-stu-id="439d5-141">VNet name</span></span> |<span data-ttu-id="439d5-142">String of up to 80 characters.</span><span class="sxs-lookup"><span data-stu-id="439d5-142">String of up to 80 characters.</span></span> <span data-ttu-id="439d5-143">May contain letters, numbers, underscore, periods, or hyphens.</span><span class="sxs-lookup"><span data-stu-id="439d5-143">May contain letters, numbers, underscore, periods, or hyphens.</span></span> <span data-ttu-id="439d5-144">Must start with a letter or number.</span><span class="sxs-lookup"><span data-stu-id="439d5-144">Must start with a letter or number.</span></span> <span data-ttu-id="439d5-145">Must end with a letter, number, or underscore.</span><span class="sxs-lookup"><span data-stu-id="439d5-145">Must end with a letter, number, or underscore.</span></span> <span data-ttu-id="439d5-146">Can contains upper or lower case letters.</span><span class="sxs-lookup"><span data-stu-id="439d5-146">Can contains upper or lower case letters.</span></span> |
| <span data-ttu-id="439d5-147">**location**</span><span class="sxs-lookup"><span data-stu-id="439d5-147">**location**</span></span> |<span data-ttu-id="439d5-148">Azure location (also referred to as region).</span><span class="sxs-lookup"><span data-stu-id="439d5-148">Azure location (also referred to as region).</span></span> |<span data-ttu-id="439d5-149">Must be one of the valid Azure locations.</span><span class="sxs-lookup"><span data-stu-id="439d5-149">Must be one of the valid Azure locations.</span></span> |
| <span data-ttu-id="439d5-150">**addressSpace**</span><span class="sxs-lookup"><span data-stu-id="439d5-150">**addressSpace**</span></span> |<span data-ttu-id="439d5-151">Collection of address prefixes that make up the VNet in CIDR notation.</span><span class="sxs-lookup"><span data-stu-id="439d5-151">Collection of address prefixes that make up the VNet in CIDR notation.</span></span> |<span data-ttu-id="439d5-152">Must be an array of valid CIDR address blocks, including public IP address ranges.</span><span class="sxs-lookup"><span data-stu-id="439d5-152">Must be an array of valid CIDR address blocks, including public IP address ranges.</span></span> |
| <span data-ttu-id="439d5-153">**subnets**</span><span class="sxs-lookup"><span data-stu-id="439d5-153">**subnets**</span></span> |<span data-ttu-id="439d5-154">Collection of subnets that make up the VNet</span><span class="sxs-lookup"><span data-stu-id="439d5-154">Collection of subnets that make up the VNet</span></span> |<span data-ttu-id="439d5-155">see the subnet properties table below.</span><span class="sxs-lookup"><span data-stu-id="439d5-155">see the subnet properties table below.</span></span> |
| <span data-ttu-id="439d5-156">**dhcpOptions**</span><span class="sxs-lookup"><span data-stu-id="439d5-156">**dhcpOptions**</span></span> |<span data-ttu-id="439d5-157">Object that contains a single required property named **dnsServers**.</span><span class="sxs-lookup"><span data-stu-id="439d5-157">Object that contains a single required property named **dnsServers**.</span></span> | |
| <span data-ttu-id="439d5-158">**dnsServers**</span><span class="sxs-lookup"><span data-stu-id="439d5-158">**dnsServers**</span></span> |<span data-ttu-id="439d5-159">Array of DNS servers used by the VNet.</span><span class="sxs-lookup"><span data-stu-id="439d5-159">Array of DNS servers used by the VNet.</span></span> <span data-ttu-id="439d5-160">If no server is specified, Azure internal name resolution is used.</span><span class="sxs-lookup"><span data-stu-id="439d5-160">If no server is specified, Azure internal name resolution is used.</span></span> |<span data-ttu-id="439d5-161">Must be an array of up to 10 DNS servers, by IP address.</span><span class="sxs-lookup"><span data-stu-id="439d5-161">Must be an array of up to 10 DNS servers, by IP address.</span></span> |

<span data-ttu-id="439d5-162">A subnet is a child resource of a VNet, and helps define segments of address spaces within a CIDR block, using IP address prefixes.</span><span class="sxs-lookup"><span data-stu-id="439d5-162">A subnet is a child resource of a VNet, and helps define segments of address spaces within a CIDR block, using IP address prefixes.</span></span> <span data-ttu-id="439d5-163">NICs can be added to subnets, and connected to VMs, providing connectivity for various workloads.</span><span class="sxs-lookup"><span data-stu-id="439d5-163">NICs can be added to subnets, and connected to VMs, providing connectivity for various workloads.</span></span>

<span data-ttu-id="439d5-164">Subnets contain the following properties.</span><span class="sxs-lookup"><span data-stu-id="439d5-164">Subnets contain the following properties.</span></span>

| <span data-ttu-id="439d5-165">Property</span><span class="sxs-lookup"><span data-stu-id="439d5-165">Property</span></span> | <span data-ttu-id="439d5-166">Description</span><span class="sxs-lookup"><span data-stu-id="439d5-166">Description</span></span> | <span data-ttu-id="439d5-167">Constraints</span><span class="sxs-lookup"><span data-stu-id="439d5-167">Constraints</span></span> |
| --- | --- | --- |
| <span data-ttu-id="439d5-168">**name**</span><span class="sxs-lookup"><span data-stu-id="439d5-168">**name**</span></span> |<span data-ttu-id="439d5-169">Subnet name</span><span class="sxs-lookup"><span data-stu-id="439d5-169">Subnet name</span></span> |<span data-ttu-id="439d5-170">String of up to 80 characters.</span><span class="sxs-lookup"><span data-stu-id="439d5-170">String of up to 80 characters.</span></span> <span data-ttu-id="439d5-171">May contain letters, numbers, underscore, periods, or hyphens.</span><span class="sxs-lookup"><span data-stu-id="439d5-171">May contain letters, numbers, underscore, periods, or hyphens.</span></span> <span data-ttu-id="439d5-172">Must start with a letter or number.</span><span class="sxs-lookup"><span data-stu-id="439d5-172">Must start with a letter or number.</span></span> <span data-ttu-id="439d5-173">Must end with a letter, number, or underscore.</span><span class="sxs-lookup"><span data-stu-id="439d5-173">Must end with a letter, number, or underscore.</span></span> <span data-ttu-id="439d5-174">Can contains upper or lower case letters.</span><span class="sxs-lookup"><span data-stu-id="439d5-174">Can contains upper or lower case letters.</span></span> |
| <span data-ttu-id="439d5-175">**location**</span><span class="sxs-lookup"><span data-stu-id="439d5-175">**location**</span></span> |<span data-ttu-id="439d5-176">Azure location (also referred to as region).</span><span class="sxs-lookup"><span data-stu-id="439d5-176">Azure location (also referred to as region).</span></span> |<span data-ttu-id="439d5-177">Must be one of the valid Azure locations.</span><span class="sxs-lookup"><span data-stu-id="439d5-177">Must be one of the valid Azure locations.</span></span> |
| <span data-ttu-id="439d5-178">**addressPrefix**</span><span class="sxs-lookup"><span data-stu-id="439d5-178">**addressPrefix**</span></span> |<span data-ttu-id="439d5-179">Single address prefix that make up the subnet in CIDR notation</span><span class="sxs-lookup"><span data-stu-id="439d5-179">Single address prefix that make up the subnet in CIDR notation</span></span> |<span data-ttu-id="439d5-180">Must be a single CIDR block that is part of one of the VNet's address spaces.</span><span class="sxs-lookup"><span data-stu-id="439d5-180">Must be a single CIDR block that is part of one of the VNet's address spaces.</span></span> |
| <span data-ttu-id="439d5-181">**networkSecurityGroup**</span><span class="sxs-lookup"><span data-stu-id="439d5-181">**networkSecurityGroup**</span></span> |<span data-ttu-id="439d5-182">NSG applied to the subnet</span><span class="sxs-lookup"><span data-stu-id="439d5-182">NSG applied to the subnet</span></span> | |
| <span data-ttu-id="439d5-183">**routeTable**</span><span class="sxs-lookup"><span data-stu-id="439d5-183">**routeTable**</span></span> |<span data-ttu-id="439d5-184">Route table applied to the subnet</span><span class="sxs-lookup"><span data-stu-id="439d5-184">Route table applied to the subnet</span></span> | |
| <span data-ttu-id="439d5-185">**ipConfigurations**</span><span class="sxs-lookup"><span data-stu-id="439d5-185">**ipConfigurations**</span></span> |<span data-ttu-id="439d5-186">Collection of IP configuration objects used by NICs connected to the subnet</span><span class="sxs-lookup"><span data-stu-id="439d5-186">Collection of IP configuration objects used by NICs connected to the subnet</span></span> | |

### <a name="name-resolution"></a><span data-ttu-id="439d5-187">Name resolution</span><span class="sxs-lookup"><span data-stu-id="439d5-187">Name resolution</span></span>
<span data-ttu-id="439d5-188">By default, your VNet uses [Azure-provided name resolution](virtual-networks-name-resolution-for-vms-and-role-instances.md) to resolve names inside the VNet, and on the public Internet.</span><span class="sxs-lookup"><span data-stu-id="439d5-188">By default, your VNet uses [Azure-provided name resolution](virtual-networks-name-resolution-for-vms-and-role-instances.md) to resolve names inside the VNet, and on the public Internet.</span></span> <span data-ttu-id="439d5-189">However, if you connect your VNets to your on-premises data centers, you need to provide [your own DNS server](virtual-networks-name-resolution-for-vms-and-role-instances.md) to resolve names between your networks.</span><span class="sxs-lookup"><span data-stu-id="439d5-189">However, if you connect your VNets to your on-premises data centers, you need to provide [your own DNS server](virtual-networks-name-resolution-for-vms-and-role-instances.md) to resolve names between your networks.</span></span>  

### <a name="limits"></a><span data-ttu-id="439d5-190">Limits</span><span class="sxs-lookup"><span data-stu-id="439d5-190">Limits</span></span>
<span data-ttu-id="439d5-191">Review the networking limits in the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article to ensure that your design doesn't conflict with any of the limits.</span><span class="sxs-lookup"><span data-stu-id="439d5-191">Review the networking limits in the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article to ensure that your design doesn't conflict with any of the limits.</span></span> <span data-ttu-id="439d5-192">Some limits can be increased by opening a support ticket.</span><span class="sxs-lookup"><span data-stu-id="439d5-192">Some limits can be increased by opening a support ticket.</span></span>

### <a name="role-based-access-control-rbac"></a><span data-ttu-id="439d5-193">Role-Based Access Control (RBAC)</span><span class="sxs-lookup"><span data-stu-id="439d5-193">Role-Based Access Control (RBAC)</span></span>
<span data-ttu-id="439d5-194">You can use [Azure RBAC](../active-directory/role-based-access-built-in-roles.md) to control the level of access different users may have to different resources in Azure.</span><span class="sxs-lookup"><span data-stu-id="439d5-194">You can use [Azure RBAC](../active-directory/role-based-access-built-in-roles.md) to control the level of access different users may have to different resources in Azure.</span></span> <span data-ttu-id="439d5-195">That way you can segregate the work done by your team based on their needs.</span><span class="sxs-lookup"><span data-stu-id="439d5-195">That way you can segregate the work done by your team based on their needs.</span></span>

<span data-ttu-id="439d5-196">As far as virtual networks are concerned, users in the **Network Contributor** role have full control over Azure Resource Manager virtual network resources.</span><span class="sxs-lookup"><span data-stu-id="439d5-196">As far as virtual networks are concerned, users in the **Network Contributor** role have full control over Azure Resource Manager virtual network resources.</span></span> <span data-ttu-id="439d5-197">Similarly, users in the **Classic Network Contributor** role have full control over classic virtual network resources.</span><span class="sxs-lookup"><span data-stu-id="439d5-197">Similarly, users in the **Classic Network Contributor** role have full control over classic virtual network resources.</span></span>

> [!NOTE]
> <span data-ttu-id="439d5-198">You can also [create your own roles](../active-directory/role-based-access-control-configure.md) to separate your administrative needs.</span><span class="sxs-lookup"><span data-stu-id="439d5-198">You can also [create your own roles](../active-directory/role-based-access-control-configure.md) to separate your administrative needs.</span></span>
>
>

## <a name="design"></a><span data-ttu-id="439d5-199">Design</span><span class="sxs-lookup"><span data-stu-id="439d5-199">Design</span></span>
<span data-ttu-id="439d5-200">Once you know the answers to the questions in the [Plan](#Plan) section, review the following before defining your VNets.</span><span class="sxs-lookup"><span data-stu-id="439d5-200">Once you know the answers to the questions in the [Plan](#Plan) section, review the following before defining your VNets.</span></span>

### <a name="number-of-subscriptions-and-vnets"></a><span data-ttu-id="439d5-201">Number of subscriptions and VNets</span><span class="sxs-lookup"><span data-stu-id="439d5-201">Number of subscriptions and VNets</span></span>
<span data-ttu-id="439d5-202">You should consider creating multiple VNets in the following scenarios:</span><span class="sxs-lookup"><span data-stu-id="439d5-202">You should consider creating multiple VNets in the following scenarios:</span></span>

* <span data-ttu-id="439d5-203">**VMs that need to be placed in different Azure locations**.</span><span class="sxs-lookup"><span data-stu-id="439d5-203">**VMs that need to be placed in different Azure locations**.</span></span> <span data-ttu-id="439d5-204">VNets in Azure are regional.</span><span class="sxs-lookup"><span data-stu-id="439d5-204">VNets in Azure are regional.</span></span> <span data-ttu-id="439d5-205">They cannot span locations.</span><span class="sxs-lookup"><span data-stu-id="439d5-205">They cannot span locations.</span></span> <span data-ttu-id="439d5-206">Therefore you need at least one VNet for each Azure location you want to host VMs in.</span><span class="sxs-lookup"><span data-stu-id="439d5-206">Therefore you need at least one VNet for each Azure location you want to host VMs in.</span></span>
* <span data-ttu-id="439d5-207">**Workloads that need to be completely isolated from one another**.</span><span class="sxs-lookup"><span data-stu-id="439d5-207">**Workloads that need to be completely isolated from one another**.</span></span> <span data-ttu-id="439d5-208">You can create separate VNets, that even use the same IP address spaces, to isolate different workloads from one another.</span><span class="sxs-lookup"><span data-stu-id="439d5-208">You can create separate VNets, that even use the same IP address spaces, to isolate different workloads from one another.</span></span>

<span data-ttu-id="439d5-209">Keep in mind that the limits you see above are per region, per subscription.</span><span class="sxs-lookup"><span data-stu-id="439d5-209">Keep in mind that the limits you see above are per region, per subscription.</span></span> <span data-ttu-id="439d5-210">That means you can use multiple subscriptions to increase the limit of resources you can maintain in Azure.</span><span class="sxs-lookup"><span data-stu-id="439d5-210">That means you can use multiple subscriptions to increase the limit of resources you can maintain in Azure.</span></span> <span data-ttu-id="439d5-211">You can use a site-to-site VPN, or an ExpressRoute circuit, to connect VNets in different subscriptions.</span><span class="sxs-lookup"><span data-stu-id="439d5-211">You can use a site-to-site VPN, or an ExpressRoute circuit, to connect VNets in different subscriptions.</span></span>

### <a name="subscription-and-vnet-design-patterns"></a><span data-ttu-id="439d5-212">Subscription and VNet design patterns</span><span class="sxs-lookup"><span data-stu-id="439d5-212">Subscription and VNet design patterns</span></span>
<span data-ttu-id="439d5-213">The table below shows some common design patterns for using subscriptions and VNets.</span><span class="sxs-lookup"><span data-stu-id="439d5-213">The table below shows some common design patterns for using subscriptions and VNets.</span></span>

| <span data-ttu-id="439d5-214">Scenario</span><span class="sxs-lookup"><span data-stu-id="439d5-214">Scenario</span></span> | <span data-ttu-id="439d5-215">Diagram</span><span class="sxs-lookup"><span data-stu-id="439d5-215">Diagram</span></span> | <span data-ttu-id="439d5-216">Pros</span><span class="sxs-lookup"><span data-stu-id="439d5-216">Pros</span></span> | <span data-ttu-id="439d5-217">Cons</span><span class="sxs-lookup"><span data-stu-id="439d5-217">Cons</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="439d5-218">Single subscription, two VNets per app</span><span class="sxs-lookup"><span data-stu-id="439d5-218">Single subscription, two VNets per app</span></span> |![Single subscription](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure1.png) |<span data-ttu-id="439d5-220">Only one subscription to manage.</span><span class="sxs-lookup"><span data-stu-id="439d5-220">Only one subscription to manage.</span></span> |<span data-ttu-id="439d5-221">Maximum number of VNets per Azure region.</span><span class="sxs-lookup"><span data-stu-id="439d5-221">Maximum number of VNets per Azure region.</span></span> <span data-ttu-id="439d5-222">You need more subscriptions after that.</span><span class="sxs-lookup"><span data-stu-id="439d5-222">You need more subscriptions after that.</span></span> <span data-ttu-id="439d5-223">Review the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article for details.</span><span class="sxs-lookup"><span data-stu-id="439d5-223">Review the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article for details.</span></span> |
| <span data-ttu-id="439d5-224">One subscription per app, two VNets per app</span><span class="sxs-lookup"><span data-stu-id="439d5-224">One subscription per app, two VNets per app</span></span> |![Single subscription](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure2.png) |<span data-ttu-id="439d5-226">Uses only two VNets per subscription.</span><span class="sxs-lookup"><span data-stu-id="439d5-226">Uses only two VNets per subscription.</span></span> |<span data-ttu-id="439d5-227">Harder to manage when there are too many apps.</span><span class="sxs-lookup"><span data-stu-id="439d5-227">Harder to manage when there are too many apps.</span></span> |
| <span data-ttu-id="439d5-228">One subscription per business unit, two VNets per app.</span><span class="sxs-lookup"><span data-stu-id="439d5-228">One subscription per business unit, two VNets per app.</span></span> |![Single subscription](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure3.png) |<span data-ttu-id="439d5-230">Balance between number of subscriptions and VNets.</span><span class="sxs-lookup"><span data-stu-id="439d5-230">Balance between number of subscriptions and VNets.</span></span> |<span data-ttu-id="439d5-231">Maximum number of VNets per business unit (subscription).</span><span class="sxs-lookup"><span data-stu-id="439d5-231">Maximum number of VNets per business unit (subscription).</span></span> <span data-ttu-id="439d5-232">Review the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article for details.</span><span class="sxs-lookup"><span data-stu-id="439d5-232">Review the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article for details.</span></span> |
| <span data-ttu-id="439d5-233">One subscription per business unit, two VNets per group of apps.</span><span class="sxs-lookup"><span data-stu-id="439d5-233">One subscription per business unit, two VNets per group of apps.</span></span> |![Single subscription](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure4.png) |<span data-ttu-id="439d5-235">Balance between number of subscriptions and VNets.</span><span class="sxs-lookup"><span data-stu-id="439d5-235">Balance between number of subscriptions and VNets.</span></span> |<span data-ttu-id="439d5-236">Apps must be isolated by using subnets and NSGs.</span><span class="sxs-lookup"><span data-stu-id="439d5-236">Apps must be isolated by using subnets and NSGs.</span></span> |

### <a name="number-of-subnets"></a><span data-ttu-id="439d5-237">Number of subnets</span><span class="sxs-lookup"><span data-stu-id="439d5-237">Number of subnets</span></span>
<span data-ttu-id="439d5-238">You should consider multiple subnets in a VNet in the following scenarios:</span><span class="sxs-lookup"><span data-stu-id="439d5-238">You should consider multiple subnets in a VNet in the following scenarios:</span></span>

* <span data-ttu-id="439d5-239">**Not enough private IP addresses for all NICs in a subnet**.</span><span class="sxs-lookup"><span data-stu-id="439d5-239">**Not enough private IP addresses for all NICs in a subnet**.</span></span> <span data-ttu-id="439d5-240">If your subnet address space does not contain enough IP addresses for the number of NICs in the subnet, you need to create multiple subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-240">If your subnet address space does not contain enough IP addresses for the number of NICs in the subnet, you need to create multiple subnets.</span></span> <span data-ttu-id="439d5-241">Keep in mind that Azure reserves 5 private IP addresses from each subnet that cannot be used: the first and last addresses of the address space (for the subnet address, and multicast) and 3 addresses to be used internally (for DHCP and DNS purposes).</span><span class="sxs-lookup"><span data-stu-id="439d5-241">Keep in mind that Azure reserves 5 private IP addresses from each subnet that cannot be used: the first and last addresses of the address space (for the subnet address, and multicast) and 3 addresses to be used internally (for DHCP and DNS purposes).</span></span>
* <span data-ttu-id="439d5-242">**Security**.</span><span class="sxs-lookup"><span data-stu-id="439d5-242">**Security**.</span></span> <span data-ttu-id="439d5-243">You can use subnets to separate groups of VMs from one another for workloads that have a multi-layer structure, and apply different [network security groups (NSGs)](virtual-networks-nsg.md#subnets) for those subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-243">You can use subnets to separate groups of VMs from one another for workloads that have a multi-layer structure, and apply different [network security groups (NSGs)](virtual-networks-nsg.md#subnets) for those subnets.</span></span>
* <span data-ttu-id="439d5-244">**Hybrid connectivity**.</span><span class="sxs-lookup"><span data-stu-id="439d5-244">**Hybrid connectivity**.</span></span> <span data-ttu-id="439d5-245">You can use VPN gateways and ExpressRoute circuits to [connect](../vpn-gateway/vpn-gateway-about-vpngateways.md#site-to-site-and-multi-site-ipsecike-vpn-tunnel) your VNets to one another, and to your on-premises data center(s).</span><span class="sxs-lookup"><span data-stu-id="439d5-245">You can use VPN gateways and ExpressRoute circuits to [connect](../vpn-gateway/vpn-gateway-about-vpngateways.md#site-to-site-and-multi-site-ipsecike-vpn-tunnel) your VNets to one another, and to your on-premises data center(s).</span></span> <span data-ttu-id="439d5-246">VPN gateways and ExpressRoute circuits require a subnet of their own to be created.</span><span class="sxs-lookup"><span data-stu-id="439d5-246">VPN gateways and ExpressRoute circuits require a subnet of their own to be created.</span></span>
* <span data-ttu-id="439d5-247">**Virtual appliances**.</span><span class="sxs-lookup"><span data-stu-id="439d5-247">**Virtual appliances**.</span></span> <span data-ttu-id="439d5-248">You can use a virtual appliance, such as a firewall, WAN accelerator, or VPN gateway in an Azure VNet.</span><span class="sxs-lookup"><span data-stu-id="439d5-248">You can use a virtual appliance, such as a firewall, WAN accelerator, or VPN gateway in an Azure VNet.</span></span> <span data-ttu-id="439d5-249">When you do so, you need to [route traffic](virtual-networks-udr-overview.md) to those appliances and isolate them in their own subnet.</span><span class="sxs-lookup"><span data-stu-id="439d5-249">When you do so, you need to [route traffic](virtual-networks-udr-overview.md) to those appliances and isolate them in their own subnet.</span></span>

### <a name="subnet-and-nsg-design-patterns"></a><span data-ttu-id="439d5-250">Subnet and NSG design patterns</span><span class="sxs-lookup"><span data-stu-id="439d5-250">Subnet and NSG design patterns</span></span>
<span data-ttu-id="439d5-251">The table below shows some common design patterns for using subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-251">The table below shows some common design patterns for using subnets.</span></span>

| <span data-ttu-id="439d5-252">Scenario</span><span class="sxs-lookup"><span data-stu-id="439d5-252">Scenario</span></span> | <span data-ttu-id="439d5-253">Diagram</span><span class="sxs-lookup"><span data-stu-id="439d5-253">Diagram</span></span> | <span data-ttu-id="439d5-254">Pros</span><span class="sxs-lookup"><span data-stu-id="439d5-254">Pros</span></span> | <span data-ttu-id="439d5-255">Cons</span><span class="sxs-lookup"><span data-stu-id="439d5-255">Cons</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="439d5-256">Single subnet, NSGs per application layer, per app</span><span class="sxs-lookup"><span data-stu-id="439d5-256">Single subnet, NSGs per application layer, per app</span></span> |![Single subnet](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure5.png) |<span data-ttu-id="439d5-258">Only one subnet to manage.</span><span class="sxs-lookup"><span data-stu-id="439d5-258">Only one subnet to manage.</span></span> |<span data-ttu-id="439d5-259">Multiple NSGs necessary to isolate each application.</span><span class="sxs-lookup"><span data-stu-id="439d5-259">Multiple NSGs necessary to isolate each application.</span></span> |
| <span data-ttu-id="439d5-260">One subnet per app, NSGs per application layer</span><span class="sxs-lookup"><span data-stu-id="439d5-260">One subnet per app, NSGs per application layer</span></span> |![Subnet per app](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure6.png) |<span data-ttu-id="439d5-262">Fewer NSGs to manage.</span><span class="sxs-lookup"><span data-stu-id="439d5-262">Fewer NSGs to manage.</span></span> |<span data-ttu-id="439d5-263">Multiple subnets to manage.</span><span class="sxs-lookup"><span data-stu-id="439d5-263">Multiple subnets to manage.</span></span> |
| <span data-ttu-id="439d5-264">One subnet per application layer, NSGs per app.</span><span class="sxs-lookup"><span data-stu-id="439d5-264">One subnet per application layer, NSGs per app.</span></span> |![Subnet per layer](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure7.png) |<span data-ttu-id="439d5-266">Balance between number of subnets and NSGs.</span><span class="sxs-lookup"><span data-stu-id="439d5-266">Balance between number of subnets and NSGs.</span></span> |<span data-ttu-id="439d5-267">Maximum number of NSGs per subscription.</span><span class="sxs-lookup"><span data-stu-id="439d5-267">Maximum number of NSGs per subscription.</span></span> <span data-ttu-id="439d5-268">Review the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article for details.</span><span class="sxs-lookup"><span data-stu-id="439d5-268">Review the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article for details.</span></span> |
| <span data-ttu-id="439d5-269">One subnet per application layer, per app, NSGs per subnet</span><span class="sxs-lookup"><span data-stu-id="439d5-269">One subnet per application layer, per app, NSGs per subnet</span></span> |![Subnet per layer per app](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure8.png) |<span data-ttu-id="439d5-271">Possibly smaller number of NSGs.</span><span class="sxs-lookup"><span data-stu-id="439d5-271">Possibly smaller number of NSGs.</span></span> |<span data-ttu-id="439d5-272">Multiple subnets to manage.</span><span class="sxs-lookup"><span data-stu-id="439d5-272">Multiple subnets to manage.</span></span> |

## <a name="sample-design"></a><span data-ttu-id="439d5-273">Sample design</span><span class="sxs-lookup"><span data-stu-id="439d5-273">Sample design</span></span>
<span data-ttu-id="439d5-274">To illustrate the application of the information in this article, consider the following scenario.</span><span class="sxs-lookup"><span data-stu-id="439d5-274">To illustrate the application of the information in this article, consider the following scenario.</span></span>

<span data-ttu-id="439d5-275">You work for a company that has 2 data centers in North America, and two data centers Europe.</span><span class="sxs-lookup"><span data-stu-id="439d5-275">You work for a company that has 2 data centers in North America, and two data centers Europe.</span></span> <span data-ttu-id="439d5-276">You identified 6 different customer facing applications maintained by 2 different business units that you want to migrate to Azure as a pilot.</span><span class="sxs-lookup"><span data-stu-id="439d5-276">You identified 6 different customer facing applications maintained by 2 different business units that you want to migrate to Azure as a pilot.</span></span> <span data-ttu-id="439d5-277">The basic architecture for the applications are as follows:</span><span class="sxs-lookup"><span data-stu-id="439d5-277">The basic architecture for the applications are as follows:</span></span>

* <span data-ttu-id="439d5-278">App1, App2, App3, and App4 are web applications hosted on Linux servers running Ubuntu.</span><span class="sxs-lookup"><span data-stu-id="439d5-278">App1, App2, App3, and App4 are web applications hosted on Linux servers running Ubuntu.</span></span> <span data-ttu-id="439d5-279">Each application connects to a separate application server that hosts RESTful services on Linux servers.</span><span class="sxs-lookup"><span data-stu-id="439d5-279">Each application connects to a separate application server that hosts RESTful services on Linux servers.</span></span> <span data-ttu-id="439d5-280">The RESTful services connect to a back end MySQL database.</span><span class="sxs-lookup"><span data-stu-id="439d5-280">The RESTful services connect to a back end MySQL database.</span></span>
* <span data-ttu-id="439d5-281">App5 and App6 are web applications hosted on Windows servers running Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="439d5-281">App5 and App6 are web applications hosted on Windows servers running Windows Server 2012 R2.</span></span> <span data-ttu-id="439d5-282">Each application connects to a back end SQL Server database.</span><span class="sxs-lookup"><span data-stu-id="439d5-282">Each application connects to a back end SQL Server database.</span></span>
* <span data-ttu-id="439d5-283">All apps are currently hosted in one of the company's data centers in North America.</span><span class="sxs-lookup"><span data-stu-id="439d5-283">All apps are currently hosted in one of the company's data centers in North America.</span></span>
* <span data-ttu-id="439d5-284">The on-premises data centers use the 10.0.0.0/8 address space.</span><span class="sxs-lookup"><span data-stu-id="439d5-284">The on-premises data centers use the 10.0.0.0/8 address space.</span></span>

<span data-ttu-id="439d5-285">You need to design a virtual network solution that meets the following requirements:</span><span class="sxs-lookup"><span data-stu-id="439d5-285">You need to design a virtual network solution that meets the following requirements:</span></span>

* <span data-ttu-id="439d5-286">Each business unit should not be affected by resource consumption of other business units.</span><span class="sxs-lookup"><span data-stu-id="439d5-286">Each business unit should not be affected by resource consumption of other business units.</span></span>
* <span data-ttu-id="439d5-287">You should minimize the amount of VNets and subnets to make management easier.</span><span class="sxs-lookup"><span data-stu-id="439d5-287">You should minimize the amount of VNets and subnets to make management easier.</span></span>
* <span data-ttu-id="439d5-288">Each business unit should have a single test/development VNet used for all applications.</span><span class="sxs-lookup"><span data-stu-id="439d5-288">Each business unit should have a single test/development VNet used for all applications.</span></span>
* <span data-ttu-id="439d5-289">Each application is hosted in 2 different Azure data centers per continent (North America and Europe).</span><span class="sxs-lookup"><span data-stu-id="439d5-289">Each application is hosted in 2 different Azure data centers per continent (North America and Europe).</span></span>
* <span data-ttu-id="439d5-290">Each application is completely isolated from each other.</span><span class="sxs-lookup"><span data-stu-id="439d5-290">Each application is completely isolated from each other.</span></span>
* <span data-ttu-id="439d5-291">Each application can be accessed by customers over the Internet using HTTP.</span><span class="sxs-lookup"><span data-stu-id="439d5-291">Each application can be accessed by customers over the Internet using HTTP.</span></span>
* <span data-ttu-id="439d5-292">Each application can be accessed by users connected to the on-premises data centers by using an encrypted tunnel.</span><span class="sxs-lookup"><span data-stu-id="439d5-292">Each application can be accessed by users connected to the on-premises data centers by using an encrypted tunnel.</span></span>
* <span data-ttu-id="439d5-293">Connection to on-premises data centers should use existing VPN devices.</span><span class="sxs-lookup"><span data-stu-id="439d5-293">Connection to on-premises data centers should use existing VPN devices.</span></span>
* <span data-ttu-id="439d5-294">The company's networking group should have full control over the VNet configuration.</span><span class="sxs-lookup"><span data-stu-id="439d5-294">The company's networking group should have full control over the VNet configuration.</span></span>
* <span data-ttu-id="439d5-295">Developers in each business unit should only be able to deploy VMs to existing subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-295">Developers in each business unit should only be able to deploy VMs to existing subnets.</span></span>
* <span data-ttu-id="439d5-296">All applications will be migrated as they are to Azure (lift-and-shift).</span><span class="sxs-lookup"><span data-stu-id="439d5-296">All applications will be migrated as they are to Azure (lift-and-shift).</span></span>
* <span data-ttu-id="439d5-297">The databases in each location should replicate to other Azure locations once a day.</span><span class="sxs-lookup"><span data-stu-id="439d5-297">The databases in each location should replicate to other Azure locations once a day.</span></span>
* <span data-ttu-id="439d5-298">Each application should use 5 front end web servers, 2 application servers (when necessary), and 2 database servers.</span><span class="sxs-lookup"><span data-stu-id="439d5-298">Each application should use 5 front end web servers, 2 application servers (when necessary), and 2 database servers.</span></span>

### <a name="plan"></a><span data-ttu-id="439d5-299">Plan</span><span class="sxs-lookup"><span data-stu-id="439d5-299">Plan</span></span>
<span data-ttu-id="439d5-300">You should start your design planning by answering the question in the [Define requirements](#Define-requirements) section as shown below.</span><span class="sxs-lookup"><span data-stu-id="439d5-300">You should start your design planning by answering the question in the [Define requirements](#Define-requirements) section as shown below.</span></span>

1. <span data-ttu-id="439d5-301">What Azure locations will you use to host VNets?</span><span class="sxs-lookup"><span data-stu-id="439d5-301">What Azure locations will you use to host VNets?</span></span>

    <span data-ttu-id="439d5-302">2 locations in North America, and 2 locations in Europe.</span><span class="sxs-lookup"><span data-stu-id="439d5-302">2 locations in North America, and 2 locations in Europe.</span></span> <span data-ttu-id="439d5-303">You should pick those based on the physical location of your existing on-premises data centers.</span><span class="sxs-lookup"><span data-stu-id="439d5-303">You should pick those based on the physical location of your existing on-premises data centers.</span></span> <span data-ttu-id="439d5-304">That way your connection from your physical locations to Azure will have a better latency.</span><span class="sxs-lookup"><span data-stu-id="439d5-304">That way your connection from your physical locations to Azure will have a better latency.</span></span>
2. <span data-ttu-id="439d5-305">Do you need to provide communication between these Azure locations?</span><span class="sxs-lookup"><span data-stu-id="439d5-305">Do you need to provide communication between these Azure locations?</span></span>

    <span data-ttu-id="439d5-306">Yes.</span><span class="sxs-lookup"><span data-stu-id="439d5-306">Yes.</span></span> <span data-ttu-id="439d5-307">Since the databases must be replicated to all locations.</span><span class="sxs-lookup"><span data-stu-id="439d5-307">Since the databases must be replicated to all locations.</span></span>
3. <span data-ttu-id="439d5-308">Do you need to provide communication between your Azure VNet(s) and your on-premises data center(s)?</span><span class="sxs-lookup"><span data-stu-id="439d5-308">Do you need to provide communication between your Azure VNet(s) and your on-premises data center(s)?</span></span>

    <span data-ttu-id="439d5-309">Yes.</span><span class="sxs-lookup"><span data-stu-id="439d5-309">Yes.</span></span> <span data-ttu-id="439d5-310">Since users connected to the on-premises data centers must be able to access the applications through an encrypted tunnel.</span><span class="sxs-lookup"><span data-stu-id="439d5-310">Since users connected to the on-premises data centers must be able to access the applications through an encrypted tunnel.</span></span>
4. <span data-ttu-id="439d5-311">How many IaaS VMs do you need for your solution?</span><span class="sxs-lookup"><span data-stu-id="439d5-311">How many IaaS VMs do you need for your solution?</span></span>

    <span data-ttu-id="439d5-312">200 IaaS VMs.</span><span class="sxs-lookup"><span data-stu-id="439d5-312">200 IaaS VMs.</span></span> <span data-ttu-id="439d5-313">App1, App2 and App3 require 5 web servers each, 2 applications servers each, and 2 database servers each.</span><span class="sxs-lookup"><span data-stu-id="439d5-313">App1, App2 and App3 require 5 web servers each, 2 applications servers each, and 2 database servers each.</span></span> <span data-ttu-id="439d5-314">That's a total of 9 IaaS VMs per application, or 36 IaaS VMs.</span><span class="sxs-lookup"><span data-stu-id="439d5-314">That's a total of 9 IaaS VMs per application, or 36 IaaS VMs.</span></span> <span data-ttu-id="439d5-315">App5 and App6 require 5 web servers and 2 database servers each.</span><span class="sxs-lookup"><span data-stu-id="439d5-315">App5 and App6 require 5 web servers and 2 database servers each.</span></span> <span data-ttu-id="439d5-316">That's a total of 7 IaaS VMs per application, or 14 IaaS VMs.</span><span class="sxs-lookup"><span data-stu-id="439d5-316">That's a total of 7 IaaS VMs per application, or 14 IaaS VMs.</span></span> <span data-ttu-id="439d5-317">Therefore, you need 50 IaaS VMs for all applications in each Azure region.</span><span class="sxs-lookup"><span data-stu-id="439d5-317">Therefore, you need 50 IaaS VMs for all applications in each Azure region.</span></span> <span data-ttu-id="439d5-318">Since we need to use 4 regions, there will be 200 IaaS VMs.</span><span class="sxs-lookup"><span data-stu-id="439d5-318">Since we need to use 4 regions, there will be 200 IaaS VMs.</span></span>

    <span data-ttu-id="439d5-319">You will also need to provide DNS servers in each VNet, or in your on-premises data centers to resolve name between your Azure IaaS VMs and your on-premises network.</span><span class="sxs-lookup"><span data-stu-id="439d5-319">You will also need to provide DNS servers in each VNet, or in your on-premises data centers to resolve name between your Azure IaaS VMs and your on-premises network.</span></span>
5. <span data-ttu-id="439d5-320">Do you need to isolate traffic based on groups of VMs (i.e. front end web servers and back end database servers)?</span><span class="sxs-lookup"><span data-stu-id="439d5-320">Do you need to isolate traffic based on groups of VMs (i.e. front end web servers and back end database servers)?</span></span>

    <span data-ttu-id="439d5-321">Yes.</span><span class="sxs-lookup"><span data-stu-id="439d5-321">Yes.</span></span> <span data-ttu-id="439d5-322">Each application should be completely isolated from each other, and each application layer should also be isolated.</span><span class="sxs-lookup"><span data-stu-id="439d5-322">Each application should be completely isolated from each other, and each application layer should also be isolated.</span></span>
6. <span data-ttu-id="439d5-323">Do you need to control traffic flow using virtual appliances?</span><span class="sxs-lookup"><span data-stu-id="439d5-323">Do you need to control traffic flow using virtual appliances?</span></span>

    <span data-ttu-id="439d5-324">No.</span><span class="sxs-lookup"><span data-stu-id="439d5-324">No.</span></span> <span data-ttu-id="439d5-325">Virtual appliances can be used to provide more control over traffic flow, including more detailed data plane logging.</span><span class="sxs-lookup"><span data-stu-id="439d5-325">Virtual appliances can be used to provide more control over traffic flow, including more detailed data plane logging.</span></span>
7. <span data-ttu-id="439d5-326">Do users need different sets of permissions to different Azure resources?</span><span class="sxs-lookup"><span data-stu-id="439d5-326">Do users need different sets of permissions to different Azure resources?</span></span>

    <span data-ttu-id="439d5-327">Yes.</span><span class="sxs-lookup"><span data-stu-id="439d5-327">Yes.</span></span> <span data-ttu-id="439d5-328">The networking team needs full control on the virtual networking settings, while developers should only be able to deploy their VMs to pre-existing subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-328">The networking team needs full control on the virtual networking settings, while developers should only be able to deploy their VMs to pre-existing subnets.</span></span>

### <a name="design"></a><span data-ttu-id="439d5-329">Design</span><span class="sxs-lookup"><span data-stu-id="439d5-329">Design</span></span>
<span data-ttu-id="439d5-330">You should follow the design specifying subscriptions, VNets, subnets, and NSGs.</span><span class="sxs-lookup"><span data-stu-id="439d5-330">You should follow the design specifying subscriptions, VNets, subnets, and NSGs.</span></span> <span data-ttu-id="439d5-331">We will discuss NSGs here, but you should learn more about [NSGs](virtual-networks-nsg.md) before finishing your design.</span><span class="sxs-lookup"><span data-stu-id="439d5-331">We will discuss NSGs here, but you should learn more about [NSGs](virtual-networks-nsg.md) before finishing your design.</span></span>

<span data-ttu-id="439d5-332">**Number of subscriptions and VNets**</span><span class="sxs-lookup"><span data-stu-id="439d5-332">**Number of subscriptions and VNets**</span></span>

<span data-ttu-id="439d5-333">The following requirements are related to subscriptions and VNets:</span><span class="sxs-lookup"><span data-stu-id="439d5-333">The following requirements are related to subscriptions and VNets:</span></span>

* <span data-ttu-id="439d5-334">Each business unit should not be affected by resource consumption of other business units.</span><span class="sxs-lookup"><span data-stu-id="439d5-334">Each business unit should not be affected by resource consumption of other business units.</span></span>
* <span data-ttu-id="439d5-335">You should minimize the amount of VNets and subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-335">You should minimize the amount of VNets and subnets.</span></span>
* <span data-ttu-id="439d5-336">Each business unit should have a single test/development VNet used for all applications.</span><span class="sxs-lookup"><span data-stu-id="439d5-336">Each business unit should have a single test/development VNet used for all applications.</span></span>
* <span data-ttu-id="439d5-337">Each application is hosted in 2 different Azure data centers per continent (North America and Europe).</span><span class="sxs-lookup"><span data-stu-id="439d5-337">Each application is hosted in 2 different Azure data centers per continent (North America and Europe).</span></span>

<span data-ttu-id="439d5-338">Based on those requirements, you need a subscription for each business unit.</span><span class="sxs-lookup"><span data-stu-id="439d5-338">Based on those requirements, you need a subscription for each business unit.</span></span> <span data-ttu-id="439d5-339">That way, consumption of resources from a business unit will not count towards limits for other business units.</span><span class="sxs-lookup"><span data-stu-id="439d5-339">That way, consumption of resources from a business unit will not count towards limits for other business units.</span></span> <span data-ttu-id="439d5-340">And since you want to minimize the number of VNets, you should consider using the **one subscription per business unit, two VNets per group of apps** pattern as seen below.</span><span class="sxs-lookup"><span data-stu-id="439d5-340">And since you want to minimize the number of VNets, you should consider using the **one subscription per business unit, two VNets per group of apps** pattern as seen below.</span></span>

![Single subscription](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure9.png)

<span data-ttu-id="439d5-342">You also need to specify the address space for each VNet.</span><span class="sxs-lookup"><span data-stu-id="439d5-342">You also need to specify the address space for each VNet.</span></span> <span data-ttu-id="439d5-343">Since you need connectivity between the on-premises data centers and the Azure regions, the address space used for Azure VNets cannot clash with the on-premises network, and the address space used by each VNet should not clash with other existing VNets.</span><span class="sxs-lookup"><span data-stu-id="439d5-343">Since you need connectivity between the on-premises data centers and the Azure regions, the address space used for Azure VNets cannot clash with the on-premises network, and the address space used by each VNet should not clash with other existing VNets.</span></span> <span data-ttu-id="439d5-344">You could use the address spaces in the table below to satisfy these requirements.</span><span class="sxs-lookup"><span data-stu-id="439d5-344">You could use the address spaces in the table below to satisfy these requirements.</span></span>  

| <span data-ttu-id="439d5-345">**Subscription**</span><span class="sxs-lookup"><span data-stu-id="439d5-345">**Subscription**</span></span> | <span data-ttu-id="439d5-346">**VNet**</span><span class="sxs-lookup"><span data-stu-id="439d5-346">**VNet**</span></span> | <span data-ttu-id="439d5-347">**Azure region**</span><span class="sxs-lookup"><span data-stu-id="439d5-347">**Azure region**</span></span> | <span data-ttu-id="439d5-348">**Address space**</span><span class="sxs-lookup"><span data-stu-id="439d5-348">**Address space**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="439d5-349">BU1</span><span class="sxs-lookup"><span data-stu-id="439d5-349">BU1</span></span> |<span data-ttu-id="439d5-350">ProdBU1US1</span><span class="sxs-lookup"><span data-stu-id="439d5-350">ProdBU1US1</span></span> |<span data-ttu-id="439d5-351">West US</span><span class="sxs-lookup"><span data-stu-id="439d5-351">West US</span></span> |<span data-ttu-id="439d5-352">172.16.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-352">172.16.0.0/16</span></span> |
| <span data-ttu-id="439d5-353">BU1</span><span class="sxs-lookup"><span data-stu-id="439d5-353">BU1</span></span> |<span data-ttu-id="439d5-354">ProdBU1US2</span><span class="sxs-lookup"><span data-stu-id="439d5-354">ProdBU1US2</span></span> |<span data-ttu-id="439d5-355">East US</span><span class="sxs-lookup"><span data-stu-id="439d5-355">East US</span></span> |<span data-ttu-id="439d5-356">172.17.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-356">172.17.0.0/16</span></span> |
| <span data-ttu-id="439d5-357">BU1</span><span class="sxs-lookup"><span data-stu-id="439d5-357">BU1</span></span> |<span data-ttu-id="439d5-358">ProdBU1EU1</span><span class="sxs-lookup"><span data-stu-id="439d5-358">ProdBU1EU1</span></span> |<span data-ttu-id="439d5-359">North Europe</span><span class="sxs-lookup"><span data-stu-id="439d5-359">North Europe</span></span> |<span data-ttu-id="439d5-360">172.18.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-360">172.18.0.0/16</span></span> |
| <span data-ttu-id="439d5-361">BU1</span><span class="sxs-lookup"><span data-stu-id="439d5-361">BU1</span></span> |<span data-ttu-id="439d5-362">ProdBU1EU2</span><span class="sxs-lookup"><span data-stu-id="439d5-362">ProdBU1EU2</span></span> |<span data-ttu-id="439d5-363">West Europe</span><span class="sxs-lookup"><span data-stu-id="439d5-363">West Europe</span></span> |<span data-ttu-id="439d5-364">172.19.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-364">172.19.0.0/16</span></span> |
| <span data-ttu-id="439d5-365">BU1</span><span class="sxs-lookup"><span data-stu-id="439d5-365">BU1</span></span> |<span data-ttu-id="439d5-366">TestDevBU1</span><span class="sxs-lookup"><span data-stu-id="439d5-366">TestDevBU1</span></span> |<span data-ttu-id="439d5-367">West US</span><span class="sxs-lookup"><span data-stu-id="439d5-367">West US</span></span> |<span data-ttu-id="439d5-368">172.20.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-368">172.20.0.0/16</span></span> |
| <span data-ttu-id="439d5-369">BU2</span><span class="sxs-lookup"><span data-stu-id="439d5-369">BU2</span></span> |<span data-ttu-id="439d5-370">TestDevBU2</span><span class="sxs-lookup"><span data-stu-id="439d5-370">TestDevBU2</span></span> |<span data-ttu-id="439d5-371">West US</span><span class="sxs-lookup"><span data-stu-id="439d5-371">West US</span></span> |<span data-ttu-id="439d5-372">172.21.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-372">172.21.0.0/16</span></span> |
| <span data-ttu-id="439d5-373">BU2</span><span class="sxs-lookup"><span data-stu-id="439d5-373">BU2</span></span> |<span data-ttu-id="439d5-374">ProdBU2US1</span><span class="sxs-lookup"><span data-stu-id="439d5-374">ProdBU2US1</span></span> |<span data-ttu-id="439d5-375">West US</span><span class="sxs-lookup"><span data-stu-id="439d5-375">West US</span></span> |<span data-ttu-id="439d5-376">172.22.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-376">172.22.0.0/16</span></span> |
| <span data-ttu-id="439d5-377">BU2</span><span class="sxs-lookup"><span data-stu-id="439d5-377">BU2</span></span> |<span data-ttu-id="439d5-378">ProdBU2US2</span><span class="sxs-lookup"><span data-stu-id="439d5-378">ProdBU2US2</span></span> |<span data-ttu-id="439d5-379">East US</span><span class="sxs-lookup"><span data-stu-id="439d5-379">East US</span></span> |<span data-ttu-id="439d5-380">172.23.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-380">172.23.0.0/16</span></span> |
| <span data-ttu-id="439d5-381">BU2</span><span class="sxs-lookup"><span data-stu-id="439d5-381">BU2</span></span> |<span data-ttu-id="439d5-382">ProdBU2EU1</span><span class="sxs-lookup"><span data-stu-id="439d5-382">ProdBU2EU1</span></span> |<span data-ttu-id="439d5-383">North Europe</span><span class="sxs-lookup"><span data-stu-id="439d5-383">North Europe</span></span> |<span data-ttu-id="439d5-384">172.24.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-384">172.24.0.0/16</span></span> |
| <span data-ttu-id="439d5-385">BU2</span><span class="sxs-lookup"><span data-stu-id="439d5-385">BU2</span></span> |<span data-ttu-id="439d5-386">ProdBU2EU2</span><span class="sxs-lookup"><span data-stu-id="439d5-386">ProdBU2EU2</span></span> |<span data-ttu-id="439d5-387">West Europe</span><span class="sxs-lookup"><span data-stu-id="439d5-387">West Europe</span></span> |<span data-ttu-id="439d5-388">172.25.0.0/16</span><span class="sxs-lookup"><span data-stu-id="439d5-388">172.25.0.0/16</span></span> |

<span data-ttu-id="439d5-389">**Number of subnets and NSGs**</span><span class="sxs-lookup"><span data-stu-id="439d5-389">**Number of subnets and NSGs**</span></span>

<span data-ttu-id="439d5-390">The following requirements are related to subnets and NSGs:</span><span class="sxs-lookup"><span data-stu-id="439d5-390">The following requirements are related to subnets and NSGs:</span></span>

* <span data-ttu-id="439d5-391">You should minimize the amount of VNets and subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-391">You should minimize the amount of VNets and subnets.</span></span>
* <span data-ttu-id="439d5-392">Each application is completely isolated from each other.</span><span class="sxs-lookup"><span data-stu-id="439d5-392">Each application is completely isolated from each other.</span></span>
* <span data-ttu-id="439d5-393">Each application can be accessed by customers over the Internet using HTTP.</span><span class="sxs-lookup"><span data-stu-id="439d5-393">Each application can be accessed by customers over the Internet using HTTP.</span></span>
* <span data-ttu-id="439d5-394">Each application can be accessed by users connected to the on-premises data centers by using an encrypted tunnel.</span><span class="sxs-lookup"><span data-stu-id="439d5-394">Each application can be accessed by users connected to the on-premises data centers by using an encrypted tunnel.</span></span>
* <span data-ttu-id="439d5-395">Connection to on-premises data centers should use existing VPN devices.</span><span class="sxs-lookup"><span data-stu-id="439d5-395">Connection to on-premises data centers should use existing VPN devices.</span></span>
* <span data-ttu-id="439d5-396">The databases in each location should replicate to other Azure locations once a day.</span><span class="sxs-lookup"><span data-stu-id="439d5-396">The databases in each location should replicate to other Azure locations once a day.</span></span>

<span data-ttu-id="439d5-397">Based on those requirements, you could use one subnet per application layer, and use NSGs to filter traffic per application.</span><span class="sxs-lookup"><span data-stu-id="439d5-397">Based on those requirements, you could use one subnet per application layer, and use NSGs to filter traffic per application.</span></span> <span data-ttu-id="439d5-398">That way, you only have 3 subnets in each VNet (front end, application layer, and data layer) and one NSG per application per subnet.</span><span class="sxs-lookup"><span data-stu-id="439d5-398">That way, you only have 3 subnets in each VNet (front end, application layer, and data layer) and one NSG per application per subnet.</span></span> <span data-ttu-id="439d5-399">In this case, you should consider using the **one subnet per application layer, NSGs per app** design pattern.</span><span class="sxs-lookup"><span data-stu-id="439d5-399">In this case, you should consider using the **one subnet per application layer, NSGs per app** design pattern.</span></span> <span data-ttu-id="439d5-400">The figure below shows the use of the design pattern representing the **ProdBU1US1** VNet.</span><span class="sxs-lookup"><span data-stu-id="439d5-400">The figure below shows the use of the design pattern representing the **ProdBU1US1** VNet.</span></span>

![One subnet per layer, one NSG per application per layer](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure11.png)

<span data-ttu-id="439d5-402">However, you also need to create an extra subnet for the VPN connectivity between the VNets, and your on-premises data centers.</span><span class="sxs-lookup"><span data-stu-id="439d5-402">However, you also need to create an extra subnet for the VPN connectivity between the VNets, and your on-premises data centers.</span></span> <span data-ttu-id="439d5-403">And you need to specify the address space for each subnet.</span><span class="sxs-lookup"><span data-stu-id="439d5-403">And you need to specify the address space for each subnet.</span></span> <span data-ttu-id="439d5-404">The figure below shows a sample solution for **ProdBU1US1** VNet.</span><span class="sxs-lookup"><span data-stu-id="439d5-404">The figure below shows a sample solution for **ProdBU1US1** VNet.</span></span> <span data-ttu-id="439d5-405">You would replicate this scenario for each VNet.</span><span class="sxs-lookup"><span data-stu-id="439d5-405">You would replicate this scenario for each VNet.</span></span> <span data-ttu-id="439d5-406">Each color represents a different application.</span><span class="sxs-lookup"><span data-stu-id="439d5-406">Each color represents a different application.</span></span>

![Sample VNet](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-vnet-plan-design-arm/figure10.png)

<span data-ttu-id="439d5-408">**Access Control**</span><span class="sxs-lookup"><span data-stu-id="439d5-408">**Access Control**</span></span>

<span data-ttu-id="439d5-409">The following requirements are related to access control:</span><span class="sxs-lookup"><span data-stu-id="439d5-409">The following requirements are related to access control:</span></span>

* <span data-ttu-id="439d5-410">The company's networking group should have full control over the VNet configuration.</span><span class="sxs-lookup"><span data-stu-id="439d5-410">The company's networking group should have full control over the VNet configuration.</span></span>
* <span data-ttu-id="439d5-411">Developers in each business unit should only be able to deploy VMs to existing subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-411">Developers in each business unit should only be able to deploy VMs to existing subnets.</span></span>

<span data-ttu-id="439d5-412">Based on those requirements, you could add users from the networking team to the built-in **Network Contributor** role in each subscription; and create a custom role for the application developers in each subscription giving them rights to add VMs to existing subnets.</span><span class="sxs-lookup"><span data-stu-id="439d5-412">Based on those requirements, you could add users from the networking team to the built-in **Network Contributor** role in each subscription; and create a custom role for the application developers in each subscription giving them rights to add VMs to existing subnets.</span></span>

## <a name="next-steps"></a><span data-ttu-id="439d5-413">Next steps</span><span class="sxs-lookup"><span data-stu-id="439d5-413">Next steps</span></span>
* <span data-ttu-id="439d5-414">[Deploy a virtual network](virtual-networks-create-vnet-arm-template-click.md) based on a scenario.</span><span class="sxs-lookup"><span data-stu-id="439d5-414">[Deploy a virtual network](virtual-networks-create-vnet-arm-template-click.md) based on a scenario.</span></span>
* <span data-ttu-id="439d5-415">Understand how to [load balance](../load-balancer/load-balancer-overview.md) IaaS VMs and [manage routing over multiple Azure regions](../traffic-manager/traffic-manager-overview.md).</span><span class="sxs-lookup"><span data-stu-id="439d5-415">Understand how to [load balance](../load-balancer/load-balancer-overview.md) IaaS VMs and [manage routing over multiple Azure regions](../traffic-manager/traffic-manager-overview.md).</span></span>
* <span data-ttu-id="439d5-416">Learn more about [NSGs and how to plan and design](virtual-networks-nsg.md) an NSG solution.</span><span class="sxs-lookup"><span data-stu-id="439d5-416">Learn more about [NSGs and how to plan and design](virtual-networks-nsg.md) an NSG solution.</span></span>
* <span data-ttu-id="439d5-417">Learn more about your [cross-premises and VNet connectivity options](../vpn-gateway/vpn-gateway-about-vpngateways.md#site-to-site-and-multi-site-ipsecike-vpn-tunnel).</span><span class="sxs-lookup"><span data-stu-id="439d5-417">Learn more about your [cross-premises and VNet connectivity options](../vpn-gateway/vpn-gateway-about-vpngateways.md#site-to-site-and-multi-site-ipsecike-vpn-tunnel).</span></span>











