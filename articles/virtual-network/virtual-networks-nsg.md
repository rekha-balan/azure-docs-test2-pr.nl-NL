---
title: Network security groups in Azure | Microsoft Docs
description: Learn how to isolate and control traffic flow within your virtual networks using the distributed firewall in Azure using Network Security Groups.
services: virtual-network
documentationcenter: na
author: jimdial
manager: timlt
editor: tysonn
ms.assetid: 20e850fc-6456-4b5f-9a3f-a8379b052bc9
ms.service: virtual-network
ms.devlang: na
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/11/2016
ms.author: jdial
ms.openlocfilehash: d55ff65955d5279678cf996a321da2405a3db5be
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44661586"
---
# <a name="filter-network-traffic-with-network-security-groups"></a><span data-ttu-id="9083f-103">Filter network traffic with network security groups</span><span class="sxs-lookup"><span data-stu-id="9083f-103">Filter network traffic with network security groups</span></span>

<span data-ttu-id="9083f-104">A network security group (NSG) contains a list of security rules that allow or deny network traffic to resources connected to Azure Virtual Networks (VNet).</span><span class="sxs-lookup"><span data-stu-id="9083f-104">A network security group (NSG) contains a list of security rules that allow or deny network traffic to resources connected to Azure Virtual Networks (VNet).</span></span> <span data-ttu-id="9083f-105">NSGs can be associated to subnets, individual VMs (classic), or individual network interfaces (NIC) attached to VMs (Resource Manager).</span><span class="sxs-lookup"><span data-stu-id="9083f-105">NSGs can be associated to subnets, individual VMs (classic), or individual network interfaces (NIC) attached to VMs (Resource Manager).</span></span> <span data-ttu-id="9083f-106">When an NSG is associated to a subnet, the rules apply to all resources connected to the subnet.</span><span class="sxs-lookup"><span data-stu-id="9083f-106">When an NSG is associated to a subnet, the rules apply to all resources connected to the subnet.</span></span> <span data-ttu-id="9083f-107">Traffic can further be restricted by also associating an NSG to a VM or NIC.</span><span class="sxs-lookup"><span data-stu-id="9083f-107">Traffic can further be restricted by also associating an NSG to a VM or NIC.</span></span>

> [!NOTE]
> <span data-ttu-id="9083f-108">Azure has two different deployment models for creating and working with resources:  [Resource Manager and classic](../resource-manager-deployment-model.md).</span><span class="sxs-lookup"><span data-stu-id="9083f-108">Azure has two different deployment models for creating and working with resources:  [Resource Manager and classic](../resource-manager-deployment-model.md).</span></span> <span data-ttu-id="9083f-109">This article covers using both models, but Microsoft recommends that most new deployments use the Resource Manager model.</span><span class="sxs-lookup"><span data-stu-id="9083f-109">This article covers using both models, but Microsoft recommends that most new deployments use the Resource Manager model.</span></span>

## <a name="nsg-resource"></a><span data-ttu-id="9083f-110">NSG resource</span><span class="sxs-lookup"><span data-stu-id="9083f-110">NSG resource</span></span>
<span data-ttu-id="9083f-111">NSGs contain the following properties:</span><span class="sxs-lookup"><span data-stu-id="9083f-111">NSGs contain the following properties:</span></span>

| <span data-ttu-id="9083f-112">Property</span><span class="sxs-lookup"><span data-stu-id="9083f-112">Property</span></span> | <span data-ttu-id="9083f-113">Description</span><span class="sxs-lookup"><span data-stu-id="9083f-113">Description</span></span> | <span data-ttu-id="9083f-114">Constraints</span><span class="sxs-lookup"><span data-stu-id="9083f-114">Constraints</span></span> | <span data-ttu-id="9083f-115">Considerations</span><span class="sxs-lookup"><span data-stu-id="9083f-115">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="9083f-116">Name</span><span class="sxs-lookup"><span data-stu-id="9083f-116">Name</span></span> |<span data-ttu-id="9083f-117">Name for the NSG</span><span class="sxs-lookup"><span data-stu-id="9083f-117">Name for the NSG</span></span> |<span data-ttu-id="9083f-118">Must be unique within the region.</span><span class="sxs-lookup"><span data-stu-id="9083f-118">Must be unique within the region.</span></span><br/><span data-ttu-id="9083f-119">Can contain letters, numbers, underscores, periods, and hyphens.</span><span class="sxs-lookup"><span data-stu-id="9083f-119">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="9083f-120">Must start with a letter or number.</span><span class="sxs-lookup"><span data-stu-id="9083f-120">Must start with a letter or number.</span></span><br/><span data-ttu-id="9083f-121">Must end with a letter, number, or underscore.</span><span class="sxs-lookup"><span data-stu-id="9083f-121">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="9083f-122">Cannot exceed 80 characters.</span><span class="sxs-lookup"><span data-stu-id="9083f-122">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="9083f-123">Since you may need to create several NSGs, make sure you have a naming convention that makes it easy to identify the function of your NSGs.</span><span class="sxs-lookup"><span data-stu-id="9083f-123">Since you may need to create several NSGs, make sure you have a naming convention that makes it easy to identify the function of your NSGs.</span></span> |
| <span data-ttu-id="9083f-124">Region</span><span class="sxs-lookup"><span data-stu-id="9083f-124">Region</span></span> |<span data-ttu-id="9083f-125">Azure [region](https://azure.microsoft.com/regions) where the NSG is created.</span><span class="sxs-lookup"><span data-stu-id="9083f-125">Azure [region](https://azure.microsoft.com/regions) where the NSG is created.</span></span> |<span data-ttu-id="9083f-126">NSGs can only be associated to resources within the same region as the NSG.</span><span class="sxs-lookup"><span data-stu-id="9083f-126">NSGs can only be associated to resources within the same region as the NSG.</span></span> |<span data-ttu-id="9083f-127">To learn about how many NSGs you can have per region, read the [Azure limits](../azure-subscription-service-limits.md#virtual-networking-limits-classic) article.</span><span class="sxs-lookup"><span data-stu-id="9083f-127">To learn about how many NSGs you can have per region, read the [Azure limits](../azure-subscription-service-limits.md#virtual-networking-limits-classic) article.</span></span>|
| <span data-ttu-id="9083f-128">Resource group</span><span class="sxs-lookup"><span data-stu-id="9083f-128">Resource group</span></span> |<span data-ttu-id="9083f-129">The [resource group](../azure-resource-manager/resource-group-overview.md#resource-groups) the NSG exists in.</span><span class="sxs-lookup"><span data-stu-id="9083f-129">The [resource group](../azure-resource-manager/resource-group-overview.md#resource-groups) the NSG exists in.</span></span> |<span data-ttu-id="9083f-130">Although an NSG exists in a resource group, it can be associated to resources in any resource group, as long as the resource is part of the same Azure region as the NSG.</span><span class="sxs-lookup"><span data-stu-id="9083f-130">Although an NSG exists in a resource group, it can be associated to resources in any resource group, as long as the resource is part of the same Azure region as the NSG.</span></span> |<span data-ttu-id="9083f-131">Resource groups are used to manage multiple resources together, as a deployment unit.</span><span class="sxs-lookup"><span data-stu-id="9083f-131">Resource groups are used to manage multiple resources together, as a deployment unit.</span></span><br/><span data-ttu-id="9083f-132">You may consider grouping the NSG with resources it is associated to.</span><span class="sxs-lookup"><span data-stu-id="9083f-132">You may consider grouping the NSG with resources it is associated to.</span></span> |
| <span data-ttu-id="9083f-133">Rules</span><span class="sxs-lookup"><span data-stu-id="9083f-133">Rules</span></span> |<span data-ttu-id="9083f-134">Inbound or outbound rules that define what traffic is allowed or denied.</span><span class="sxs-lookup"><span data-stu-id="9083f-134">Inbound or outbound rules that define what traffic is allowed or denied.</span></span> | |<span data-ttu-id="9083f-135">See the [NSG rules](#Nsg-rules) section of this article.</span><span class="sxs-lookup"><span data-stu-id="9083f-135">See the [NSG rules](#Nsg-rules) section of this article.</span></span> |

> [!NOTE]
> <span data-ttu-id="9083f-136">Endpoint-based ACLs and network security groups are not supported on the same VM instance.</span><span class="sxs-lookup"><span data-stu-id="9083f-136">Endpoint-based ACLs and network security groups are not supported on the same VM instance.</span></span> <span data-ttu-id="9083f-137">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span><span class="sxs-lookup"><span data-stu-id="9083f-137">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span></span> <span data-ttu-id="9083f-138">To learn how to remove an ACL, read the [Managing Access Control Lists (ACLs) for Endpoints by using PowerShell](virtual-networks-acl-powershell.md) article.</span><span class="sxs-lookup"><span data-stu-id="9083f-138">To learn how to remove an ACL, read the [Managing Access Control Lists (ACLs) for Endpoints by using PowerShell](virtual-networks-acl-powershell.md) article.</span></span>
> 

### <a name="nsg-rules"></a><span data-ttu-id="9083f-139">NSG rules</span><span class="sxs-lookup"><span data-stu-id="9083f-139">NSG rules</span></span>
<span data-ttu-id="9083f-140">NSG rules contain the following properties:</span><span class="sxs-lookup"><span data-stu-id="9083f-140">NSG rules contain the following properties:</span></span>

| <span data-ttu-id="9083f-141">Property</span><span class="sxs-lookup"><span data-stu-id="9083f-141">Property</span></span> | <span data-ttu-id="9083f-142">Description</span><span class="sxs-lookup"><span data-stu-id="9083f-142">Description</span></span> | <span data-ttu-id="9083f-143">Constraints</span><span class="sxs-lookup"><span data-stu-id="9083f-143">Constraints</span></span> | <span data-ttu-id="9083f-144">Considerations</span><span class="sxs-lookup"><span data-stu-id="9083f-144">Considerations</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="9083f-145">**Name**</span><span class="sxs-lookup"><span data-stu-id="9083f-145">**Name**</span></span> |<span data-ttu-id="9083f-146">Name for the rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-146">Name for the rule.</span></span> |<span data-ttu-id="9083f-147">Must be unique within the region.</span><span class="sxs-lookup"><span data-stu-id="9083f-147">Must be unique within the region.</span></span><br/><span data-ttu-id="9083f-148">Can contain letters, numbers, underscores, periods, and hyphens.</span><span class="sxs-lookup"><span data-stu-id="9083f-148">Can contain letters, numbers, underscores, periods, and hyphens.</span></span><br/><span data-ttu-id="9083f-149">Must start with a letter or number.</span><span class="sxs-lookup"><span data-stu-id="9083f-149">Must start with a letter or number.</span></span><br/><span data-ttu-id="9083f-150">Must end with a letter, number, or underscore.</span><span class="sxs-lookup"><span data-stu-id="9083f-150">Must end with a letter, number, or underscore.</span></span><br/><span data-ttu-id="9083f-151">Cannot exceed 80 characters.</span><span class="sxs-lookup"><span data-stu-id="9083f-151">Cannot exceed 80 characters.</span></span> |<span data-ttu-id="9083f-152">You may have several rules within an NSG, so make sure you follow a naming convention that allows you to identify the function of your rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-152">You may have several rules within an NSG, so make sure you follow a naming convention that allows you to identify the function of your rule.</span></span> |
| <span data-ttu-id="9083f-153">**Protocol**</span><span class="sxs-lookup"><span data-stu-id="9083f-153">**Protocol**</span></span> |<span data-ttu-id="9083f-154">Protocol to match for the rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-154">Protocol to match for the rule.</span></span> |<span data-ttu-id="9083f-155">TCP, UDP, or \*</span><span class="sxs-lookup"><span data-stu-id="9083f-155">TCP, UDP, or \*</span></span> |<span data-ttu-id="9083f-156">Using \* as a protocol includes ICMP (East-West traffic only), as well as UDP and TCP, and may reduce the number of rules you need.</span><span class="sxs-lookup"><span data-stu-id="9083f-156">Using \* as a protocol includes ICMP (East-West traffic only), as well as UDP and TCP, and may reduce the number of rules you need.</span></span><br/><span data-ttu-id="9083f-157">At the same time, using \* might be too broad an approach, so it's recommended that you use \* only when necessary.</span><span class="sxs-lookup"><span data-stu-id="9083f-157">At the same time, using \* might be too broad an approach, so it's recommended that you use \* only when necessary.</span></span> |
| <span data-ttu-id="9083f-158">**Source port range**</span><span class="sxs-lookup"><span data-stu-id="9083f-158">**Source port range**</span></span> |<span data-ttu-id="9083f-159">Source port range to match for the rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-159">Source port range to match for the rule.</span></span> |<span data-ttu-id="9083f-160">Single port number from 1 to 65535, port range (example: 1-65635), or \* (for all ports).</span><span class="sxs-lookup"><span data-stu-id="9083f-160">Single port number from 1 to 65535, port range (example: 1-65635), or \* (for all ports).</span></span> |<span data-ttu-id="9083f-161">Source ports could be ephemeral.</span><span class="sxs-lookup"><span data-stu-id="9083f-161">Source ports could be ephemeral.</span></span> <span data-ttu-id="9083f-162">Unless your client program is using a specific port, use \* in most cases.</span><span class="sxs-lookup"><span data-stu-id="9083f-162">Unless your client program is using a specific port, use \* in most cases.</span></span><br/><span data-ttu-id="9083f-163">Try to use port ranges as much as possible to avoid the need for multiple rules.</span><span class="sxs-lookup"><span data-stu-id="9083f-163">Try to use port ranges as much as possible to avoid the need for multiple rules.</span></span><br/><span data-ttu-id="9083f-164">Multiple ports or port ranges cannot be grouped by a comma.</span><span class="sxs-lookup"><span data-stu-id="9083f-164">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="9083f-165">**Destination port range**</span><span class="sxs-lookup"><span data-stu-id="9083f-165">**Destination port range**</span></span> |<span data-ttu-id="9083f-166">Destination port range to match for the rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-166">Destination port range to match for the rule.</span></span> |<span data-ttu-id="9083f-167">Single port number from 1 to 65535, port range (example: 1-65535), or \* (for all ports).</span><span class="sxs-lookup"><span data-stu-id="9083f-167">Single port number from 1 to 65535, port range (example: 1-65535), or \* (for all ports).</span></span> |<span data-ttu-id="9083f-168">Try to use port ranges as much as possible to avoid the need for multiple rules.</span><span class="sxs-lookup"><span data-stu-id="9083f-168">Try to use port ranges as much as possible to avoid the need for multiple rules.</span></span><br/><span data-ttu-id="9083f-169">Multiple ports or port ranges cannot be grouped by a comma.</span><span class="sxs-lookup"><span data-stu-id="9083f-169">Multiple ports or port ranges cannot be grouped by a comma.</span></span> |
| <span data-ttu-id="9083f-170">**Source address prefix**</span><span class="sxs-lookup"><span data-stu-id="9083f-170">**Source address prefix**</span></span> |<span data-ttu-id="9083f-171">Source address prefix or tag to match for the rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-171">Source address prefix or tag to match for the rule.</span></span> |<span data-ttu-id="9083f-172">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or \* (for all addresses).</span><span class="sxs-lookup"><span data-stu-id="9083f-172">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or \* (for all addresses).</span></span> |<span data-ttu-id="9083f-173">Consider using ranges, default tags, and \* to reduce the number of rules.</span><span class="sxs-lookup"><span data-stu-id="9083f-173">Consider using ranges, default tags, and \* to reduce the number of rules.</span></span> |
| <span data-ttu-id="9083f-174">**Destination address prefix**</span><span class="sxs-lookup"><span data-stu-id="9083f-174">**Destination address prefix**</span></span> |<span data-ttu-id="9083f-175">Destination address prefix or tag to match for the rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-175">Destination address prefix or tag to match for the rule.</span></span> | <span data-ttu-id="9083f-176">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or \* (for all addresses).</span><span class="sxs-lookup"><span data-stu-id="9083f-176">Single IP address (example: 10.10.10.10), IP subnet (example: 192.168.1.0/24), [default tag](#default-tags), or \* (for all addresses).</span></span> |<span data-ttu-id="9083f-177">Consider using ranges, default tags, and \* to reduce the number of rules.</span><span class="sxs-lookup"><span data-stu-id="9083f-177">Consider using ranges, default tags, and \* to reduce the number of rules.</span></span> |
| <span data-ttu-id="9083f-178">**Direction**</span><span class="sxs-lookup"><span data-stu-id="9083f-178">**Direction**</span></span> |<span data-ttu-id="9083f-179">Direction of traffic to match for the rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-179">Direction of traffic to match for the rule.</span></span> |<span data-ttu-id="9083f-180">Inbound or outbound.</span><span class="sxs-lookup"><span data-stu-id="9083f-180">Inbound or outbound.</span></span> |<span data-ttu-id="9083f-181">Inbound and outbound rules are processed separately, based on direction.</span><span class="sxs-lookup"><span data-stu-id="9083f-181">Inbound and outbound rules are processed separately, based on direction.</span></span> |
| <span data-ttu-id="9083f-182">**Priority**</span><span class="sxs-lookup"><span data-stu-id="9083f-182">**Priority**</span></span> |<span data-ttu-id="9083f-183">Rules are checked in the order of priority.</span><span class="sxs-lookup"><span data-stu-id="9083f-183">Rules are checked in the order of priority.</span></span> <span data-ttu-id="9083f-184">Once a rule applies, no more rules are tested for matching.</span><span class="sxs-lookup"><span data-stu-id="9083f-184">Once a rule applies, no more rules are tested for matching.</span></span> | <span data-ttu-id="9083f-185">Number between 100 and 4096.</span><span class="sxs-lookup"><span data-stu-id="9083f-185">Number between 100 and 4096.</span></span> | <span data-ttu-id="9083f-186">Consider creating rules jumping priorities by 100 for each rule to leave space for new rules you might create in the future.</span><span class="sxs-lookup"><span data-stu-id="9083f-186">Consider creating rules jumping priorities by 100 for each rule to leave space for new rules you might create in the future.</span></span> |
| <span data-ttu-id="9083f-187">**Access**</span><span class="sxs-lookup"><span data-stu-id="9083f-187">**Access**</span></span> |<span data-ttu-id="9083f-188">Type of access to apply if the rule matches.</span><span class="sxs-lookup"><span data-stu-id="9083f-188">Type of access to apply if the rule matches.</span></span> | <span data-ttu-id="9083f-189">Allow or deny.</span><span class="sxs-lookup"><span data-stu-id="9083f-189">Allow or deny.</span></span> | <span data-ttu-id="9083f-190">Keep in mind that if an allow rule is not found for a packet, the packet is dropped.</span><span class="sxs-lookup"><span data-stu-id="9083f-190">Keep in mind that if an allow rule is not found for a packet, the packet is dropped.</span></span> |

<span data-ttu-id="9083f-191">NSGs contain two sets of rules: Inbound and outbound.</span><span class="sxs-lookup"><span data-stu-id="9083f-191">NSGs contain two sets of rules: Inbound and outbound.</span></span> <span data-ttu-id="9083f-192">The priority for a rule must be unique within each set.</span><span class="sxs-lookup"><span data-stu-id="9083f-192">The priority for a rule must be unique within each set.</span></span> 

![NSG rule processing](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-overview/figure3.png) 

<span data-ttu-id="9083f-194">The previous picture shows how NSG rules are processed.</span><span class="sxs-lookup"><span data-stu-id="9083f-194">The previous picture shows how NSG rules are processed.</span></span>

### <a name="default-tags"></a><span data-ttu-id="9083f-195">Default Tags</span><span class="sxs-lookup"><span data-stu-id="9083f-195">Default Tags</span></span>
<span data-ttu-id="9083f-196">Default tags are system-provided identifiers to address a category of IP addresses.</span><span class="sxs-lookup"><span data-stu-id="9083f-196">Default tags are system-provided identifiers to address a category of IP addresses.</span></span> <span data-ttu-id="9083f-197">You can use default tags in the **source address prefix** and **destination address prefix** properties of any rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-197">You can use default tags in the **source address prefix** and **destination address prefix** properties of any rule.</span></span> <span data-ttu-id="9083f-198">There are three default tags you can use:</span><span class="sxs-lookup"><span data-stu-id="9083f-198">There are three default tags you can use:</span></span>

* <span data-ttu-id="9083f-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** for classic): This tag includes the virtual network address space (CIDR ranges defined in Azure), all connected on-premises address spaces, and connected Azure VNets (local networks).</span><span class="sxs-lookup"><span data-stu-id="9083f-199">**VirtualNetwork** (Resource Manager) (**VIRTUAL_NETWORK** for classic): This tag includes the virtual network address space (CIDR ranges defined in Azure), all connected on-premises address spaces, and connected Azure VNets (local networks).</span></span>
* <span data-ttu-id="9083f-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** for classic): This tag denotes Azure’s infrastructure load balancer.</span><span class="sxs-lookup"><span data-stu-id="9083f-200">**AzureLoadBalancer** (Resource Manager) (**AZURE_LOADBALANCER** for classic): This tag denotes Azure’s infrastructure load balancer.</span></span> <span data-ttu-id="9083f-201">The tag translates to an Azure datacenter IP where Azure’s health probes originate.</span><span class="sxs-lookup"><span data-stu-id="9083f-201">The tag translates to an Azure datacenter IP where Azure’s health probes originate.</span></span>
* <span data-ttu-id="9083f-202">**Internet** (Resource Manager) (**INTERNET** for classic): This tag denotes the IP address space that is outside the virtual network and reachable by public Internet.</span><span class="sxs-lookup"><span data-stu-id="9083f-202">**Internet** (Resource Manager) (**INTERNET** for classic): This tag denotes the IP address space that is outside the virtual network and reachable by public Internet.</span></span> <span data-ttu-id="9083f-203">The range includes the [Azure owned public IP space](https://www.microsoft.com/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="9083f-203">The range includes the [Azure owned public IP space](https://www.microsoft.com/download/details.aspx?id=41653).</span></span>

### <a name="default-rules"></a><span data-ttu-id="9083f-204">Default rules</span><span class="sxs-lookup"><span data-stu-id="9083f-204">Default rules</span></span>
<span data-ttu-id="9083f-205">All NSGs contain a set of default rules.</span><span class="sxs-lookup"><span data-stu-id="9083f-205">All NSGs contain a set of default rules.</span></span> <span data-ttu-id="9083f-206">The default rules cannot be deleted, but because they are assigned the lowest priority, they can be overridden by the rules that you create.</span><span class="sxs-lookup"><span data-stu-id="9083f-206">The default rules cannot be deleted, but because they are assigned the lowest priority, they can be overridden by the rules that you create.</span></span> 

<span data-ttu-id="9083f-207">The default rules allow and disallow traffic as follows:</span><span class="sxs-lookup"><span data-stu-id="9083f-207">The default rules allow and disallow traffic as follows:</span></span>
- <span data-ttu-id="9083f-208">**Virtual network:** Traffic originating and ending in a virtual network is allowed both in inbound and outbound directions.</span><span class="sxs-lookup"><span data-stu-id="9083f-208">**Virtual network:** Traffic originating and ending in a virtual network is allowed both in inbound and outbound directions.</span></span>
- <span data-ttu-id="9083f-209">**Internet:** Outbound traffic is allowed, but inbound traffic is blocked.</span><span class="sxs-lookup"><span data-stu-id="9083f-209">**Internet:** Outbound traffic is allowed, but inbound traffic is blocked.</span></span>
- <span data-ttu-id="9083f-210">**Load balancer:** Allow Azure’s load balancer to probe the health of your VMs and role instances.</span><span class="sxs-lookup"><span data-stu-id="9083f-210">**Load balancer:** Allow Azure’s load balancer to probe the health of your VMs and role instances.</span></span> <span data-ttu-id="9083f-211">If you are not using a load balanced set you can override this rule.</span><span class="sxs-lookup"><span data-stu-id="9083f-211">If you are not using a load balanced set you can override this rule.</span></span>

<span data-ttu-id="9083f-212">**Inbound default rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-212">**Inbound default rules**</span></span>

| <span data-ttu-id="9083f-213">Name</span><span class="sxs-lookup"><span data-stu-id="9083f-213">Name</span></span> | <span data-ttu-id="9083f-214">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-214">Priority</span></span> | <span data-ttu-id="9083f-215">Source IP</span><span class="sxs-lookup"><span data-stu-id="9083f-215">Source IP</span></span> | <span data-ttu-id="9083f-216">Source Port</span><span class="sxs-lookup"><span data-stu-id="9083f-216">Source Port</span></span> | <span data-ttu-id="9083f-217">Destination IP</span><span class="sxs-lookup"><span data-stu-id="9083f-217">Destination IP</span></span> | <span data-ttu-id="9083f-218">Destination Port</span><span class="sxs-lookup"><span data-stu-id="9083f-218">Destination Port</span></span> | <span data-ttu-id="9083f-219">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-219">Protocol</span></span> | <span data-ttu-id="9083f-220">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-220">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-221">AllowVNetInBound</span><span class="sxs-lookup"><span data-stu-id="9083f-221">AllowVNetInBound</span></span> |<span data-ttu-id="9083f-222">65000</span><span class="sxs-lookup"><span data-stu-id="9083f-222">65000</span></span> | <span data-ttu-id="9083f-223">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="9083f-223">VirtualNetwork</span></span> | * | <span data-ttu-id="9083f-224">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="9083f-224">VirtualNetwork</span></span> | * | * | <span data-ttu-id="9083f-225">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-225">Allow</span></span> |
| <span data-ttu-id="9083f-226">AllowAzureLoadBalancerInBound</span><span class="sxs-lookup"><span data-stu-id="9083f-226">AllowAzureLoadBalancerInBound</span></span> | <span data-ttu-id="9083f-227">65001</span><span class="sxs-lookup"><span data-stu-id="9083f-227">65001</span></span> | <span data-ttu-id="9083f-228">AzureLoadBalancer</span><span class="sxs-lookup"><span data-stu-id="9083f-228">AzureLoadBalancer</span></span> | * | * | * | * | <span data-ttu-id="9083f-229">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-229">Allow</span></span> |
| <span data-ttu-id="9083f-230">DenyAllInBound</span><span class="sxs-lookup"><span data-stu-id="9083f-230">DenyAllInBound</span></span> |<span data-ttu-id="9083f-231">65500</span><span class="sxs-lookup"><span data-stu-id="9083f-231">65500</span></span> | * | * | * | * | * | <span data-ttu-id="9083f-232">Deny</span><span class="sxs-lookup"><span data-stu-id="9083f-232">Deny</span></span> |

<span data-ttu-id="9083f-233">**Outbound default rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-233">**Outbound default rules**</span></span>

| <span data-ttu-id="9083f-234">Name</span><span class="sxs-lookup"><span data-stu-id="9083f-234">Name</span></span> | <span data-ttu-id="9083f-235">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-235">Priority</span></span> | <span data-ttu-id="9083f-236">Source IP</span><span class="sxs-lookup"><span data-stu-id="9083f-236">Source IP</span></span> | <span data-ttu-id="9083f-237">Source Port</span><span class="sxs-lookup"><span data-stu-id="9083f-237">Source Port</span></span> | <span data-ttu-id="9083f-238">Destination IP</span><span class="sxs-lookup"><span data-stu-id="9083f-238">Destination IP</span></span> | <span data-ttu-id="9083f-239">Destination Port</span><span class="sxs-lookup"><span data-stu-id="9083f-239">Destination Port</span></span> | <span data-ttu-id="9083f-240">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-240">Protocol</span></span> | <span data-ttu-id="9083f-241">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-241">Access</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-242">AllowVnetOutBound</span><span class="sxs-lookup"><span data-stu-id="9083f-242">AllowVnetOutBound</span></span> | <span data-ttu-id="9083f-243">65000</span><span class="sxs-lookup"><span data-stu-id="9083f-243">65000</span></span> | <span data-ttu-id="9083f-244">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="9083f-244">VirtualNetwork</span></span> | * | <span data-ttu-id="9083f-245">VirtualNetwork</span><span class="sxs-lookup"><span data-stu-id="9083f-245">VirtualNetwork</span></span> | * | * | <span data-ttu-id="9083f-246">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-246">Allow</span></span> |
| <span data-ttu-id="9083f-247">AllowInternetOutBound</span><span class="sxs-lookup"><span data-stu-id="9083f-247">AllowInternetOutBound</span></span> | <span data-ttu-id="9083f-248">65001</span><span class="sxs-lookup"><span data-stu-id="9083f-248">65001</span></span> | * | * | <span data-ttu-id="9083f-249">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-249">Internet</span></span> | * | * | <span data-ttu-id="9083f-250">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-250">Allow</span></span> |
| <span data-ttu-id="9083f-251">DenyAllOutBound</span><span class="sxs-lookup"><span data-stu-id="9083f-251">DenyAllOutBound</span></span> | <span data-ttu-id="9083f-252">65500</span><span class="sxs-lookup"><span data-stu-id="9083f-252">65500</span></span> | * | * | * | * | * | <span data-ttu-id="9083f-253">Deny</span><span class="sxs-lookup"><span data-stu-id="9083f-253">Deny</span></span> |

## <a name="associating-nsgs"></a><span data-ttu-id="9083f-254">Associating NSGs</span><span class="sxs-lookup"><span data-stu-id="9083f-254">Associating NSGs</span></span>
<span data-ttu-id="9083f-255">You can associate an NSG to VMs, NICs, and subnets, depending on the deployment model you are using, as follows:</span><span class="sxs-lookup"><span data-stu-id="9083f-255">You can associate an NSG to VMs, NICs, and subnets, depending on the deployment model you are using, as follows:</span></span>

* <span data-ttu-id="9083f-256">**VM (classic only):** Security rules are applied to all traffic to/from the VM.</span><span class="sxs-lookup"><span data-stu-id="9083f-256">**VM (classic only):** Security rules are applied to all traffic to/from the VM.</span></span> 
* <span data-ttu-id="9083f-257">**NIC (Resource Manager only):** Security rules are applied to all traffic to/from the NIC the NSG is associated to.</span><span class="sxs-lookup"><span data-stu-id="9083f-257">**NIC (Resource Manager only):** Security rules are applied to all traffic to/from the NIC the NSG is associated to.</span></span> <span data-ttu-id="9083f-258">In a multi-NIC VM, you can apply different (or the same) NSG to each NIC individually.</span><span class="sxs-lookup"><span data-stu-id="9083f-258">In a multi-NIC VM, you can apply different (or the same) NSG to each NIC individually.</span></span> 
* <span data-ttu-id="9083f-259">**Subnet (Resource Manager and classic):** Security rules are applied to any traffic to/from any resources connected to the VNet.</span><span class="sxs-lookup"><span data-stu-id="9083f-259">**Subnet (Resource Manager and classic):** Security rules are applied to any traffic to/from any resources connected to the VNet.</span></span>

<span data-ttu-id="9083f-260">You can associate different NSGs to a VM (or NIC, depending on the deployment model) and the subnet that a NIC or VM is connected to.</span><span class="sxs-lookup"><span data-stu-id="9083f-260">You can associate different NSGs to a VM (or NIC, depending on the deployment model) and the subnet that a NIC or VM is connected to.</span></span> <span data-ttu-id="9083f-261">Security rules are applied to the traffic, by priority, in each NSG, in the following order:</span><span class="sxs-lookup"><span data-stu-id="9083f-261">Security rules are applied to the traffic, by priority, in each NSG, in the following order:</span></span>

- <span data-ttu-id="9083f-262">**Inbound traffic**</span><span class="sxs-lookup"><span data-stu-id="9083f-262">**Inbound traffic**</span></span>

  1. <span data-ttu-id="9083f-263">**NSG applied to subnet:** If a subnet NSG has a matching rule to deny traffic, the packet is dropped.</span><span class="sxs-lookup"><span data-stu-id="9083f-263">**NSG applied to subnet:** If a subnet NSG has a matching rule to deny traffic, the packet is dropped.</span></span>

  2. <span data-ttu-id="9083f-264">**NSG applied to NIC** (Resource Manager) or VM (classic): If VM\NIC NSG has a matching rule that denies traffic, packets are dropped at the VM\NIC, even if a subnet NSG has a matching rule that allows traffic.</span><span class="sxs-lookup"><span data-stu-id="9083f-264">**NSG applied to NIC** (Resource Manager) or VM (classic): If VM\NIC NSG has a matching rule that denies traffic, packets are dropped at the VM\NIC, even if a subnet NSG has a matching rule that allows traffic.</span></span>

- <span data-ttu-id="9083f-265">**Outbound traffic**</span><span class="sxs-lookup"><span data-stu-id="9083f-265">**Outbound traffic**</span></span>

  1. <span data-ttu-id="9083f-266">**NSG applied to NIC** (Resource Manager) or VM (classic): If a VM\NIC NSG has a matching rule that denies traffic, packets are dropped.</span><span class="sxs-lookup"><span data-stu-id="9083f-266">**NSG applied to NIC** (Resource Manager) or VM (classic): If a VM\NIC NSG has a matching rule that denies traffic, packets are dropped.</span></span>

  2. <span data-ttu-id="9083f-267">**NSG applied to subnet:** If a subnet NSG has a matching rule that denies traffic, packets are dropped, even if a VM\NIC NSG has a matching rule that allows traffic.</span><span class="sxs-lookup"><span data-stu-id="9083f-267">**NSG applied to subnet:** If a subnet NSG has a matching rule that denies traffic, packets are dropped, even if a VM\NIC NSG has a matching rule that allows traffic.</span></span>

> [!NOTE]
> <span data-ttu-id="9083f-268">Although you can only associate a single NSG to a subnet, VM, or NIC; you can associate the same NSG to as many resources as you want.</span><span class="sxs-lookup"><span data-stu-id="9083f-268">Although you can only associate a single NSG to a subnet, VM, or NIC; you can associate the same NSG to as many resources as you want.</span></span>
>

## <a name="implementation"></a><span data-ttu-id="9083f-269">Implementation</span><span class="sxs-lookup"><span data-stu-id="9083f-269">Implementation</span></span>
<span data-ttu-id="9083f-270">You can implement NSGs in the Resource Manager or classic deployment models using the following tools:</span><span class="sxs-lookup"><span data-stu-id="9083f-270">You can implement NSGs in the Resource Manager or classic deployment models using the following tools:</span></span>

| <span data-ttu-id="9083f-271">Deployment tool</span><span class="sxs-lookup"><span data-stu-id="9083f-271">Deployment tool</span></span> | <span data-ttu-id="9083f-272">Classic</span><span class="sxs-lookup"><span data-stu-id="9083f-272">Classic</span></span> | <span data-ttu-id="9083f-273">Resource Manager</span><span class="sxs-lookup"><span data-stu-id="9083f-273">Resource Manager</span></span> |
| --- | --- | --- |
| <span data-ttu-id="9083f-274">Azure portal</span><span class="sxs-lookup"><span data-stu-id="9083f-274">Azure portal</span></span>   | <span data-ttu-id="9083f-275">Yes</span><span class="sxs-lookup"><span data-stu-id="9083f-275">Yes</span></span> | [<span data-ttu-id="9083f-276">Yes</span><span class="sxs-lookup"><span data-stu-id="9083f-276">Yes</span></span>](virtual-networks-create-nsg-arm-pportal.md) |
| <span data-ttu-id="9083f-277">PowerShell</span><span class="sxs-lookup"><span data-stu-id="9083f-277">PowerShell</span></span>     | [<span data-ttu-id="9083f-278">Yes</span><span class="sxs-lookup"><span data-stu-id="9083f-278">Yes</span></span>](virtual-networks-create-nsg-classic-ps.md) | [<span data-ttu-id="9083f-279">Yes</span><span class="sxs-lookup"><span data-stu-id="9083f-279">Yes</span></span>](virtual-networks-create-nsg-arm-ps.md) |
| <span data-ttu-id="9083f-280">Azure CLI **V1**</span><span class="sxs-lookup"><span data-stu-id="9083f-280">Azure CLI **V1**</span></span>   | [<span data-ttu-id="9083f-281">Yes</span><span class="sxs-lookup"><span data-stu-id="9083f-281">Yes</span></span>](virtual-networks-create-nsg-classic-cli.md) | [<span data-ttu-id="9083f-282">Yes</span><span class="sxs-lookup"><span data-stu-id="9083f-282">Yes</span></span>](virtual-networks-create-nsg-cli-nodejs.md) |
| <span data-ttu-id="9083f-283">Azure CLI **V2**</span><span class="sxs-lookup"><span data-stu-id="9083f-283">Azure CLI **V2**</span></span>   | <span data-ttu-id="9083f-284">No</span><span class="sxs-lookup"><span data-stu-id="9083f-284">No</span></span> | [<span data-ttu-id="9083f-285">Yes</span><span class="sxs-lookup"><span data-stu-id="9083f-285">Yes</span></span>](virtual-networks-create-nsg-arm-cli.md) |
| <span data-ttu-id="9083f-286">Azure Resource Manager template</span><span class="sxs-lookup"><span data-stu-id="9083f-286">Azure Resource Manager template</span></span>   | <span data-ttu-id="9083f-287">No</span><span class="sxs-lookup"><span data-stu-id="9083f-287">No</span></span>  | [<span data-ttu-id="9083f-288">Yes</span><span class="sxs-lookup"><span data-stu-id="9083f-288">Yes</span></span>](virtual-networks-create-nsg-arm-template.md) |

## <a name="planning"></a><span data-ttu-id="9083f-289">Planning</span><span class="sxs-lookup"><span data-stu-id="9083f-289">Planning</span></span>
<span data-ttu-id="9083f-290">Before implementing NSGs, you need to answer the following questions:</span><span class="sxs-lookup"><span data-stu-id="9083f-290">Before implementing NSGs, you need to answer the following questions:</span></span>

1. <span data-ttu-id="9083f-291">What types of resources do you want to filter traffic to or from?</span><span class="sxs-lookup"><span data-stu-id="9083f-291">What types of resources do you want to filter traffic to or from?</span></span> <span data-ttu-id="9083f-292">You can connect resources such as NICs (Resource Manager), VMs (classic), Cloud Services, Application Service Environments, and VM Scale Sets.</span><span class="sxs-lookup"><span data-stu-id="9083f-292">You can connect resources such as NICs (Resource Manager), VMs (classic), Cloud Services, Application Service Environments, and VM Scale Sets.</span></span> 
2. <span data-ttu-id="9083f-293">Are the resources you want to filter traffic to/from connected to subnets in existing VNets?</span><span class="sxs-lookup"><span data-stu-id="9083f-293">Are the resources you want to filter traffic to/from connected to subnets in existing VNets?</span></span>

<span data-ttu-id="9083f-294">For more information on planning for network security in Azure, read the [Cloud services and network security](../best-practices-network-security.md) article.</span><span class="sxs-lookup"><span data-stu-id="9083f-294">For more information on planning for network security in Azure, read the [Cloud services and network security](../best-practices-network-security.md) article.</span></span> 

## <a name="design-considerations"></a><span data-ttu-id="9083f-295">Design considerations</span><span class="sxs-lookup"><span data-stu-id="9083f-295">Design considerations</span></span>
<span data-ttu-id="9083f-296">Once you know the answers to the questions in the [Planning](#Planning) section, review the following sections before defining your NSGs:</span><span class="sxs-lookup"><span data-stu-id="9083f-296">Once you know the answers to the questions in the [Planning](#Planning) section, review the following sections before defining your NSGs:</span></span>

### <a name="limits"></a><span data-ttu-id="9083f-297">Limits</span><span class="sxs-lookup"><span data-stu-id="9083f-297">Limits</span></span>
<span data-ttu-id="9083f-298">There are limits to the number of NSGs you can have in a subscription and number of rules per NSG.</span><span class="sxs-lookup"><span data-stu-id="9083f-298">There are limits to the number of NSGs you can have in a subscription and number of rules per NSG.</span></span> <span data-ttu-id="9083f-299">To learn more about the limits, read the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article.</span><span class="sxs-lookup"><span data-stu-id="9083f-299">To learn more about the limits, read the [Azure limits](../azure-subscription-service-limits.md#networking-limits) article.</span></span>

### <a name="vnet-and-subnet-design"></a><span data-ttu-id="9083f-300">VNet and subnet design</span><span class="sxs-lookup"><span data-stu-id="9083f-300">VNet and subnet design</span></span>
<span data-ttu-id="9083f-301">Since NSGs can be applied to subnets, you can minimize the number of NSGs by grouping your resources by subnet, and applying NSGs to subnets.</span><span class="sxs-lookup"><span data-stu-id="9083f-301">Since NSGs can be applied to subnets, you can minimize the number of NSGs by grouping your resources by subnet, and applying NSGs to subnets.</span></span>  <span data-ttu-id="9083f-302">If you decide to apply NSGs to subnets, you may find that existing VNets and subnets you have were not defined with NSGs in mind.</span><span class="sxs-lookup"><span data-stu-id="9083f-302">If you decide to apply NSGs to subnets, you may find that existing VNets and subnets you have were not defined with NSGs in mind.</span></span> <span data-ttu-id="9083f-303">You may need to define new VNets and subnets to support your NSG design and deploy your new resources to your new subnets.</span><span class="sxs-lookup"><span data-stu-id="9083f-303">You may need to define new VNets and subnets to support your NSG design and deploy your new resources to your new subnets.</span></span> <span data-ttu-id="9083f-304">You could then define a migration strategy to move existing resources to the new subnets.</span><span class="sxs-lookup"><span data-stu-id="9083f-304">You could then define a migration strategy to move existing resources to the new subnets.</span></span> 

### <a name="special-rules"></a><span data-ttu-id="9083f-305">Special rules</span><span class="sxs-lookup"><span data-stu-id="9083f-305">Special rules</span></span>
<span data-ttu-id="9083f-306">If you block traffic allowed by the following rules, your infrastructure can't communicate with essential Azure services:</span><span class="sxs-lookup"><span data-stu-id="9083f-306">If you block traffic allowed by the following rules, your infrastructure can't communicate with essential Azure services:</span></span>

* <span data-ttu-id="9083f-307">**Virtual IP of the host node:** Basic infrastructure services such as DHCP, DNS, and health monitoring are provided through the virtualized host IP address 168.63.129.16.</span><span class="sxs-lookup"><span data-stu-id="9083f-307">**Virtual IP of the host node:** Basic infrastructure services such as DHCP, DNS, and health monitoring are provided through the virtualized host IP address 168.63.129.16.</span></span> <span data-ttu-id="9083f-308">This public IP address belongs to Microsoft and is the only virtualized IP address used in all regions for this purpose.</span><span class="sxs-lookup"><span data-stu-id="9083f-308">This public IP address belongs to Microsoft and is the only virtualized IP address used in all regions for this purpose.</span></span> <span data-ttu-id="9083f-309">This IP address maps to the physical IP address of the server machine (host node) hosting the VM.</span><span class="sxs-lookup"><span data-stu-id="9083f-309">This IP address maps to the physical IP address of the server machine (host node) hosting the VM.</span></span> <span data-ttu-id="9083f-310">The host node acts as the DHCP relay, the DNS recursive resolver, and the probe source for the load balancer health probe and the machine health probe.</span><span class="sxs-lookup"><span data-stu-id="9083f-310">The host node acts as the DHCP relay, the DNS recursive resolver, and the probe source for the load balancer health probe and the machine health probe.</span></span> <span data-ttu-id="9083f-311">Communication to this IP address is not an attack.</span><span class="sxs-lookup"><span data-stu-id="9083f-311">Communication to this IP address is not an attack.</span></span>
* <span data-ttu-id="9083f-312">**Licensing (Key Management Service):** Windows images running in VMs must be licensed.</span><span class="sxs-lookup"><span data-stu-id="9083f-312">**Licensing (Key Management Service):** Windows images running in VMs must be licensed.</span></span> <span data-ttu-id="9083f-313">To ensure licensing, a request is sent to the Key Management Service host servers that handle such queries.</span><span class="sxs-lookup"><span data-stu-id="9083f-313">To ensure licensing, a request is sent to the Key Management Service host servers that handle such queries.</span></span> <span data-ttu-id="9083f-314">The request is made outbound through port 1688.</span><span class="sxs-lookup"><span data-stu-id="9083f-314">The request is made outbound through port 1688.</span></span>

### <a name="icmp-traffic"></a><span data-ttu-id="9083f-315">ICMP traffic</span><span class="sxs-lookup"><span data-stu-id="9083f-315">ICMP traffic</span></span>
<span data-ttu-id="9083f-316">The current NSG rules only allow for protocols *TCP* or *UDP*.</span><span class="sxs-lookup"><span data-stu-id="9083f-316">The current NSG rules only allow for protocols *TCP* or *UDP*.</span></span> <span data-ttu-id="9083f-317">There is not a specific tag for *ICMP*.</span><span class="sxs-lookup"><span data-stu-id="9083f-317">There is not a specific tag for *ICMP*.</span></span> <span data-ttu-id="9083f-318">However, ICMP traffic is allowed within a VNet by the AllowVNetInBound default rule, that allows traffic to and from any port and protocol within the VNet.</span><span class="sxs-lookup"><span data-stu-id="9083f-318">However, ICMP traffic is allowed within a VNet by the AllowVNetInBound default rule, that allows traffic to and from any port and protocol within the VNet.</span></span>

### <a name="subnets"></a><span data-ttu-id="9083f-319">Subnets</span><span class="sxs-lookup"><span data-stu-id="9083f-319">Subnets</span></span>
* <span data-ttu-id="9083f-320">Consider the number of tiers your workload requires.</span><span class="sxs-lookup"><span data-stu-id="9083f-320">Consider the number of tiers your workload requires.</span></span> <span data-ttu-id="9083f-321">Each tier can be isolated by using a subnet, with an NSG applied to the subnet.</span><span class="sxs-lookup"><span data-stu-id="9083f-321">Each tier can be isolated by using a subnet, with an NSG applied to the subnet.</span></span> 
* <span data-ttu-id="9083f-322">If you need to implement a subnet for a VPN gateway, or ExpressRoute circuit, do **not** apply an NSG to that subnet.</span><span class="sxs-lookup"><span data-stu-id="9083f-322">If you need to implement a subnet for a VPN gateway, or ExpressRoute circuit, do **not** apply an NSG to that subnet.</span></span> <span data-ttu-id="9083f-323">If you do so, cross-VNet or cross-premises connectivity may fail.</span><span class="sxs-lookup"><span data-stu-id="9083f-323">If you do so, cross-VNet or cross-premises connectivity may fail.</span></span> 
* <span data-ttu-id="9083f-324">If you need to implement a network virtual appliance (NVA), connect the NVA to its own subnet and create user-defined routes (UDR) to and from the NVA.</span><span class="sxs-lookup"><span data-stu-id="9083f-324">If you need to implement a network virtual appliance (NVA), connect the NVA to its own subnet and create user-defined routes (UDR) to and from the NVA.</span></span> <span data-ttu-id="9083f-325">You can implement a subnet level NSG to filter traffic in and out of this subnet.</span><span class="sxs-lookup"><span data-stu-id="9083f-325">You can implement a subnet level NSG to filter traffic in and out of this subnet.</span></span> <span data-ttu-id="9083f-326">To learn more about UDRs, read the [User-defined routes](virtual-networks-udr-overview.md) article.</span><span class="sxs-lookup"><span data-stu-id="9083f-326">To learn more about UDRs, read the [User-defined routes](virtual-networks-udr-overview.md) article.</span></span>

### <a name="load-balancers"></a><span data-ttu-id="9083f-327">Load balancers</span><span class="sxs-lookup"><span data-stu-id="9083f-327">Load balancers</span></span>
* <span data-ttu-id="9083f-328">Consider the load balancing and network address translation (NAT) rules for each load balancer used by each of your workloads.</span><span class="sxs-lookup"><span data-stu-id="9083f-328">Consider the load balancing and network address translation (NAT) rules for each load balancer used by each of your workloads.</span></span> <span data-ttu-id="9083f-329">NAT rules are bound to a back-end pool that contains NICs (Resource Manager) or VMs/Cloud Services role instances (classic).</span><span class="sxs-lookup"><span data-stu-id="9083f-329">NAT rules are bound to a back-end pool that contains NICs (Resource Manager) or VMs/Cloud Services role instances (classic).</span></span> <span data-ttu-id="9083f-330">Consider creating an NSG for each back-end pool, allowing only traffic mapped through the rules implemented in the load balancers.</span><span class="sxs-lookup"><span data-stu-id="9083f-330">Consider creating an NSG for each back-end pool, allowing only traffic mapped through the rules implemented in the load balancers.</span></span> <span data-ttu-id="9083f-331">Creating an NSG for each back-end pool guarantees that traffic coming to the back-end pool directly (rather than through the load balancer), is also filtered.</span><span class="sxs-lookup"><span data-stu-id="9083f-331">Creating an NSG for each back-end pool guarantees that traffic coming to the back-end pool directly (rather than through the load balancer), is also filtered.</span></span>
* <span data-ttu-id="9083f-332">In classic deployments, you create endpoints that map ports on a load balancer to ports on your VMs or role instances.</span><span class="sxs-lookup"><span data-stu-id="9083f-332">In classic deployments, you create endpoints that map ports on a load balancer to ports on your VMs or role instances.</span></span> <span data-ttu-id="9083f-333">You can also create your own individual public-facing load balancer through Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="9083f-333">You can also create your own individual public-facing load balancer through Resource Manager.</span></span> <span data-ttu-id="9083f-334">The destination port for incoming traffic is the actual port in the VM or role instance, not the port exposed by a load balancer.</span><span class="sxs-lookup"><span data-stu-id="9083f-334">The destination port for incoming traffic is the actual port in the VM or role instance, not the port exposed by a load balancer.</span></span> <span data-ttu-id="9083f-335">The source port and address for the connection to the VM is a port and address on the remote computer in the Internet, not the port and address exposed by the load balancer.</span><span class="sxs-lookup"><span data-stu-id="9083f-335">The source port and address for the connection to the VM is a port and address on the remote computer in the Internet, not the port and address exposed by the load balancer.</span></span>
* <span data-ttu-id="9083f-336">When you create NSGs to filter traffic coming through an internal load balancer (ILB), the source port and address range applied are  from the originating computer, not the load balancer.</span><span class="sxs-lookup"><span data-stu-id="9083f-336">When you create NSGs to filter traffic coming through an internal load balancer (ILB), the source port and address range applied are  from the originating computer, not the load balancer.</span></span> <span data-ttu-id="9083f-337">The destination port and address range are those of the destination computer, not the load balancer.</span><span class="sxs-lookup"><span data-stu-id="9083f-337">The destination port and address range are those of the destination computer, not the load balancer.</span></span>

### <a name="other"></a><span data-ttu-id="9083f-338">Other</span><span class="sxs-lookup"><span data-stu-id="9083f-338">Other</span></span>
* <span data-ttu-id="9083f-339">Endpoint-based access control lists (ACL) and NSGs are not supported on the same VM instance.</span><span class="sxs-lookup"><span data-stu-id="9083f-339">Endpoint-based access control lists (ACL) and NSGs are not supported on the same VM instance.</span></span> <span data-ttu-id="9083f-340">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span><span class="sxs-lookup"><span data-stu-id="9083f-340">If you want to use an NSG and have an endpoint ACL already in place, first remove the endpoint ACL.</span></span> <span data-ttu-id="9083f-341">For information about how to remove an endpoint ACL, see the [Manage endpoint ACLs](virtual-networks-acl-powershell.md) article.</span><span class="sxs-lookup"><span data-stu-id="9083f-341">For information about how to remove an endpoint ACL, see the [Manage endpoint ACLs](virtual-networks-acl-powershell.md) article.</span></span>
* <span data-ttu-id="9083f-342">In Resource Manager, you can use an NSG associated to a NIC for VMs with multiple NICs to enable management (remote access) on a per NIC basis.</span><span class="sxs-lookup"><span data-stu-id="9083f-342">In Resource Manager, you can use an NSG associated to a NIC for VMs with multiple NICs to enable management (remote access) on a per NIC basis.</span></span> <span data-ttu-id="9083f-343">Associating unique NSGs to each NIC enables separation of traffic types across NICs.</span><span class="sxs-lookup"><span data-stu-id="9083f-343">Associating unique NSGs to each NIC enables separation of traffic types across NICs.</span></span>
* <span data-ttu-id="9083f-344">Similar to the use of load balancers, when filtering traffic from other VNets, you must use the source address range of the remote computer, not the gateway connecting the VNets.</span><span class="sxs-lookup"><span data-stu-id="9083f-344">Similar to the use of load balancers, when filtering traffic from other VNets, you must use the source address range of the remote computer, not the gateway connecting the VNets.</span></span>
* <span data-ttu-id="9083f-345">Many Azure services cannot be connected to VNets.</span><span class="sxs-lookup"><span data-stu-id="9083f-345">Many Azure services cannot be connected to VNets.</span></span> <span data-ttu-id="9083f-346">If an Azure resource is not connected to a VNet, you cannot use an NSG to filter traffic to the resource.</span><span class="sxs-lookup"><span data-stu-id="9083f-346">If an Azure resource is not connected to a VNet, you cannot use an NSG to filter traffic to the resource.</span></span>  <span data-ttu-id="9083f-347">Read the documentation for the services you use to determine whether the service can be connected to a VNet.</span><span class="sxs-lookup"><span data-stu-id="9083f-347">Read the documentation for the services you use to determine whether the service can be connected to a VNet.</span></span>

## <a name="sample-deployment"></a><span data-ttu-id="9083f-348">Sample deployment</span><span class="sxs-lookup"><span data-stu-id="9083f-348">Sample deployment</span></span>
<span data-ttu-id="9083f-349">To illustrate the application of the information in this article, consider a common scenario of a two tier application shown in the following picture:</span><span class="sxs-lookup"><span data-stu-id="9083f-349">To illustrate the application of the information in this article, consider a common scenario of a two tier application shown in the following picture:</span></span>

![NSGs](https://docstestmedia1.blob.core.windows.net/azure-media/articles/virtual-network/media/virtual-network-nsg-overview/figure1.png)

<span data-ttu-id="9083f-351">As shown in the diagram, the *Web1* and *Web2* VMs are connected to the *FrontEnd* subnet, and the *DB1* and *DB2* VMs are connected to the *BackEnd* subnet.</span><span class="sxs-lookup"><span data-stu-id="9083f-351">As shown in the diagram, the *Web1* and *Web2* VMs are connected to the *FrontEnd* subnet, and the *DB1* and *DB2* VMs are connected to the *BackEnd* subnet.</span></span>  <span data-ttu-id="9083f-352">Both subnets are part of the *TestVNet* VNet.</span><span class="sxs-lookup"><span data-stu-id="9083f-352">Both subnets are part of the *TestVNet* VNet.</span></span> <span data-ttu-id="9083f-353">The application components each run within an Azure VM connected to a VNet.</span><span class="sxs-lookup"><span data-stu-id="9083f-353">The application components each run within an Azure VM connected to a VNet.</span></span> <span data-ttu-id="9083f-354">The scenario has the following requirements:</span><span class="sxs-lookup"><span data-stu-id="9083f-354">The scenario has the following requirements:</span></span>

1. <span data-ttu-id="9083f-355">Separation of traffic between the WEB and DB servers.</span><span class="sxs-lookup"><span data-stu-id="9083f-355">Separation of traffic between the WEB and DB servers.</span></span>
2. <span data-ttu-id="9083f-356">Load balancing rules forward traffic from the load balancer to all web servers on port 80.</span><span class="sxs-lookup"><span data-stu-id="9083f-356">Load balancing rules forward traffic from the load balancer to all web servers on port 80.</span></span>
3. <span data-ttu-id="9083f-357">Load balancer NAT rules forward traffic coming into the load balancer on port 50001 to port 3389 on the WEB1 VM.</span><span class="sxs-lookup"><span data-stu-id="9083f-357">Load balancer NAT rules forward traffic coming into the load balancer on port 50001 to port 3389 on the WEB1 VM.</span></span>
4. <span data-ttu-id="9083f-358">No access to the front-end or back-end VMs from the Internet, except requirements 1 and 3.</span><span class="sxs-lookup"><span data-stu-id="9083f-358">No access to the front-end or back-end VMs from the Internet, except requirements 1 and 3.</span></span>
5. <span data-ttu-id="9083f-359">No outbound Internet access from the WEB or DB servers.</span><span class="sxs-lookup"><span data-stu-id="9083f-359">No outbound Internet access from the WEB or DB servers.</span></span>
6. <span data-ttu-id="9083f-360">Access from the FrontEnd subnet is allowed to port 3389 of any web server.</span><span class="sxs-lookup"><span data-stu-id="9083f-360">Access from the FrontEnd subnet is allowed to port 3389 of any web server.</span></span>
7. <span data-ttu-id="9083f-361">Access from the FrontEnd subnet is allowed to port 3389 of any DB server.</span><span class="sxs-lookup"><span data-stu-id="9083f-361">Access from the FrontEnd subnet is allowed to port 3389 of any DB server.</span></span>
8. <span data-ttu-id="9083f-362">Access from the FrontEnd subnet is allowed to port 1433 of all DB servers.</span><span class="sxs-lookup"><span data-stu-id="9083f-362">Access from the FrontEnd subnet is allowed to port 1433 of all DB servers.</span></span>
9. <span data-ttu-id="9083f-363">Separation of management traffic (port 3389) and database traffic (1433) on different NICs in DB servers.</span><span class="sxs-lookup"><span data-stu-id="9083f-363">Separation of management traffic (port 3389) and database traffic (1433) on different NICs in DB servers.</span></span>

<span data-ttu-id="9083f-364">Requirements 1-6 (except requirements 3 and 4) are all confined to subnet spaces.</span><span class="sxs-lookup"><span data-stu-id="9083f-364">Requirements 1-6 (except requirements 3 and 4) are all confined to subnet spaces.</span></span> <span data-ttu-id="9083f-365">The following NSGs meet the previous requirements, while minimizing the number of NSGs required:</span><span class="sxs-lookup"><span data-stu-id="9083f-365">The following NSGs meet the previous requirements, while minimizing the number of NSGs required:</span></span>

### <a name="frontend"></a><span data-ttu-id="9083f-366">FrontEnd</span><span class="sxs-lookup"><span data-stu-id="9083f-366">FrontEnd</span></span>
<span data-ttu-id="9083f-367">**Inbound rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-367">**Inbound rules**</span></span>

| <span data-ttu-id="9083f-368">Rule</span><span class="sxs-lookup"><span data-stu-id="9083f-368">Rule</span></span> | <span data-ttu-id="9083f-369">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-369">Access</span></span> | <span data-ttu-id="9083f-370">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-370">Priority</span></span> | <span data-ttu-id="9083f-371">Source address range</span><span class="sxs-lookup"><span data-stu-id="9083f-371">Source address range</span></span> | <span data-ttu-id="9083f-372">Source port</span><span class="sxs-lookup"><span data-stu-id="9083f-372">Source port</span></span> | <span data-ttu-id="9083f-373">Destination address range</span><span class="sxs-lookup"><span data-stu-id="9083f-373">Destination address range</span></span> | <span data-ttu-id="9083f-374">Destination port</span><span class="sxs-lookup"><span data-stu-id="9083f-374">Destination port</span></span> | <span data-ttu-id="9083f-375">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-375">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-376">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-376">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="9083f-377">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-377">Allow</span></span> | <span data-ttu-id="9083f-378">100</span><span class="sxs-lookup"><span data-stu-id="9083f-378">100</span></span> | <span data-ttu-id="9083f-379">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-379">Internet</span></span> | * | * | <span data-ttu-id="9083f-380">80</span><span class="sxs-lookup"><span data-stu-id="9083f-380">80</span></span> | <span data-ttu-id="9083f-381">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-381">TCP</span></span> |
| <span data-ttu-id="9083f-382">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-382">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="9083f-383">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-383">Allow</span></span> | <span data-ttu-id="9083f-384">200</span><span class="sxs-lookup"><span data-stu-id="9083f-384">200</span></span> | <span data-ttu-id="9083f-385">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-385">Internet</span></span> | * | * | <span data-ttu-id="9083f-386">3389</span><span class="sxs-lookup"><span data-stu-id="9083f-386">3389</span></span> | <span data-ttu-id="9083f-387">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-387">TCP</span></span> |
| <span data-ttu-id="9083f-388">Deny-Inbound-All</span><span class="sxs-lookup"><span data-stu-id="9083f-388">Deny-Inbound-All</span></span> | <span data-ttu-id="9083f-389">Deny</span><span class="sxs-lookup"><span data-stu-id="9083f-389">Deny</span></span> | <span data-ttu-id="9083f-390">300</span><span class="sxs-lookup"><span data-stu-id="9083f-390">300</span></span> | <span data-ttu-id="9083f-391">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-391">Internet</span></span> | * | * | * | <span data-ttu-id="9083f-392">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-392">TCP</span></span> |

<span data-ttu-id="9083f-393">**Outbound rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-393">**Outbound rules**</span></span>

| <span data-ttu-id="9083f-394">Rule</span><span class="sxs-lookup"><span data-stu-id="9083f-394">Rule</span></span> | <span data-ttu-id="9083f-395">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-395">Access</span></span> | <span data-ttu-id="9083f-396">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-396">Priority</span></span> | <span data-ttu-id="9083f-397">Source address range</span><span class="sxs-lookup"><span data-stu-id="9083f-397">Source address range</span></span> | <span data-ttu-id="9083f-398">Source port</span><span class="sxs-lookup"><span data-stu-id="9083f-398">Source port</span></span> | <span data-ttu-id="9083f-399">Destination address range</span><span class="sxs-lookup"><span data-stu-id="9083f-399">Destination address range</span></span> | <span data-ttu-id="9083f-400">Destination port</span><span class="sxs-lookup"><span data-stu-id="9083f-400">Destination port</span></span> | <span data-ttu-id="9083f-401">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-401">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-402">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="9083f-402">Deny-Internet-All</span></span> |<span data-ttu-id="9083f-403">Deny</span><span class="sxs-lookup"><span data-stu-id="9083f-403">Deny</span></span> |<span data-ttu-id="9083f-404">100</span><span class="sxs-lookup"><span data-stu-id="9083f-404">100</span></span> | * | * | <span data-ttu-id="9083f-405">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-405">Internet</span></span> | * | * |

### <a name="backend"></a><span data-ttu-id="9083f-406">BackEnd</span><span class="sxs-lookup"><span data-stu-id="9083f-406">BackEnd</span></span>
<span data-ttu-id="9083f-407">**Inbound rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-407">**Inbound rules**</span></span>

| <span data-ttu-id="9083f-408">Rule</span><span class="sxs-lookup"><span data-stu-id="9083f-408">Rule</span></span> | <span data-ttu-id="9083f-409">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-409">Access</span></span> | <span data-ttu-id="9083f-410">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-410">Priority</span></span> | <span data-ttu-id="9083f-411">Source address range</span><span class="sxs-lookup"><span data-stu-id="9083f-411">Source address range</span></span> | <span data-ttu-id="9083f-412">Source port</span><span class="sxs-lookup"><span data-stu-id="9083f-412">Source port</span></span> | <span data-ttu-id="9083f-413">Destination address range</span><span class="sxs-lookup"><span data-stu-id="9083f-413">Destination address range</span></span> | <span data-ttu-id="9083f-414">Destination port</span><span class="sxs-lookup"><span data-stu-id="9083f-414">Destination port</span></span> | <span data-ttu-id="9083f-415">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-415">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-416">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="9083f-416">Deny-Internet-All</span></span> | <span data-ttu-id="9083f-417">Deny</span><span class="sxs-lookup"><span data-stu-id="9083f-417">Deny</span></span> | <span data-ttu-id="9083f-418">100</span><span class="sxs-lookup"><span data-stu-id="9083f-418">100</span></span> | <span data-ttu-id="9083f-419">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-419">Internet</span></span> | * | * | * | * |

<span data-ttu-id="9083f-420">**Outbound rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-420">**Outbound rules**</span></span>

| <span data-ttu-id="9083f-421">Rule</span><span class="sxs-lookup"><span data-stu-id="9083f-421">Rule</span></span> | <span data-ttu-id="9083f-422">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-422">Access</span></span> | <span data-ttu-id="9083f-423">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-423">Priority</span></span> | <span data-ttu-id="9083f-424">Source address range</span><span class="sxs-lookup"><span data-stu-id="9083f-424">Source address range</span></span> | <span data-ttu-id="9083f-425">Source port</span><span class="sxs-lookup"><span data-stu-id="9083f-425">Source port</span></span> | <span data-ttu-id="9083f-426">Destination address range</span><span class="sxs-lookup"><span data-stu-id="9083f-426">Destination address range</span></span> | <span data-ttu-id="9083f-427">Destination port</span><span class="sxs-lookup"><span data-stu-id="9083f-427">Destination port</span></span> | <span data-ttu-id="9083f-428">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-428">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-429">Deny-Internet-All</span><span class="sxs-lookup"><span data-stu-id="9083f-429">Deny-Internet-All</span></span> | <span data-ttu-id="9083f-430">Deny</span><span class="sxs-lookup"><span data-stu-id="9083f-430">Deny</span></span> | <span data-ttu-id="9083f-431">100</span><span class="sxs-lookup"><span data-stu-id="9083f-431">100</span></span> | * | * | <span data-ttu-id="9083f-432">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-432">Internet</span></span> | * | * |

<span data-ttu-id="9083f-433">The following NSGs are created and associated to NICs in the following VMs:</span><span class="sxs-lookup"><span data-stu-id="9083f-433">The following NSGs are created and associated to NICs in the following VMs:</span></span>

### <a name="web1"></a><span data-ttu-id="9083f-434">WEB1</span><span class="sxs-lookup"><span data-stu-id="9083f-434">WEB1</span></span>
<span data-ttu-id="9083f-435">**Inbound rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-435">**Inbound rules**</span></span>

| <span data-ttu-id="9083f-436">Rule</span><span class="sxs-lookup"><span data-stu-id="9083f-436">Rule</span></span> | <span data-ttu-id="9083f-437">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-437">Access</span></span> | <span data-ttu-id="9083f-438">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-438">Priority</span></span> | <span data-ttu-id="9083f-439">Source address range</span><span class="sxs-lookup"><span data-stu-id="9083f-439">Source address range</span></span> | <span data-ttu-id="9083f-440">Source port</span><span class="sxs-lookup"><span data-stu-id="9083f-440">Source port</span></span> | <span data-ttu-id="9083f-441">Destination address range</span><span class="sxs-lookup"><span data-stu-id="9083f-441">Destination address range</span></span> | <span data-ttu-id="9083f-442">Destination port</span><span class="sxs-lookup"><span data-stu-id="9083f-442">Destination port</span></span> | <span data-ttu-id="9083f-443">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-443">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-444">Allow-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-444">Allow-Inbound-RDP-Internet</span></span> | <span data-ttu-id="9083f-445">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-445">Allow</span></span> | <span data-ttu-id="9083f-446">100</span><span class="sxs-lookup"><span data-stu-id="9083f-446">100</span></span> | <span data-ttu-id="9083f-447">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-447">Internet</span></span> | * | * | <span data-ttu-id="9083f-448">3389</span><span class="sxs-lookup"><span data-stu-id="9083f-448">3389</span></span> | <span data-ttu-id="9083f-449">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-449">TCP</span></span> |
| <span data-ttu-id="9083f-450">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-450">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="9083f-451">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-451">Allow</span></span> | <span data-ttu-id="9083f-452">200</span><span class="sxs-lookup"><span data-stu-id="9083f-452">200</span></span> | <span data-ttu-id="9083f-453">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-453">Internet</span></span> | * | * | <span data-ttu-id="9083f-454">80</span><span class="sxs-lookup"><span data-stu-id="9083f-454">80</span></span> | <span data-ttu-id="9083f-455">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-455">TCP</span></span> |

> [!NOTE]
> <span data-ttu-id="9083f-456">The source address range for the previous rules is **Internet**, not the virtual IP address of for the load balancer.</span><span class="sxs-lookup"><span data-stu-id="9083f-456">The source address range for the previous rules is **Internet**, not the virtual IP address of for the load balancer.</span></span> <span data-ttu-id="9083f-457">The source port is \*, not 500001.</span><span class="sxs-lookup"><span data-stu-id="9083f-457">The source port is \*, not 500001.</span></span> <span data-ttu-id="9083f-458">NAT rules for load balancers are not the same as NSG security rules.</span><span class="sxs-lookup"><span data-stu-id="9083f-458">NAT rules for load balancers are not the same as NSG security rules.</span></span> <span data-ttu-id="9083f-459">NSG security rules are always related to the original source and final destination of traffic, **not** the load balancer between the two.</span><span class="sxs-lookup"><span data-stu-id="9083f-459">NSG security rules are always related to the original source and final destination of traffic, **not** the load balancer between the two.</span></span> 
> 
> 

### <a name="web2"></a><span data-ttu-id="9083f-460">WEB2</span><span class="sxs-lookup"><span data-stu-id="9083f-460">WEB2</span></span>
<span data-ttu-id="9083f-461">**Inbound rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-461">**Inbound rules**</span></span>

| <span data-ttu-id="9083f-462">Rule</span><span class="sxs-lookup"><span data-stu-id="9083f-462">Rule</span></span> | <span data-ttu-id="9083f-463">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-463">Access</span></span> | <span data-ttu-id="9083f-464">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-464">Priority</span></span> | <span data-ttu-id="9083f-465">Source address range</span><span class="sxs-lookup"><span data-stu-id="9083f-465">Source address range</span></span> | <span data-ttu-id="9083f-466">Source port</span><span class="sxs-lookup"><span data-stu-id="9083f-466">Source port</span></span> | <span data-ttu-id="9083f-467">Destination address range</span><span class="sxs-lookup"><span data-stu-id="9083f-467">Destination address range</span></span> | <span data-ttu-id="9083f-468">Destination port</span><span class="sxs-lookup"><span data-stu-id="9083f-468">Destination port</span></span> | <span data-ttu-id="9083f-469">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-469">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-470">Deny-Inbound-RDP-Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-470">Deny-Inbound-RDP-Internet</span></span> | <span data-ttu-id="9083f-471">Deny</span><span class="sxs-lookup"><span data-stu-id="9083f-471">Deny</span></span> | <span data-ttu-id="9083f-472">100</span><span class="sxs-lookup"><span data-stu-id="9083f-472">100</span></span> | <span data-ttu-id="9083f-473">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-473">Internet</span></span> | * | * | <span data-ttu-id="9083f-474">3389</span><span class="sxs-lookup"><span data-stu-id="9083f-474">3389</span></span> | <span data-ttu-id="9083f-475">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-475">TCP</span></span> |
| <span data-ttu-id="9083f-476">Allow-Inbound-HTTP-Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-476">Allow-Inbound-HTTP-Internet</span></span> | <span data-ttu-id="9083f-477">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-477">Allow</span></span> | <span data-ttu-id="9083f-478">200</span><span class="sxs-lookup"><span data-stu-id="9083f-478">200</span></span> | <span data-ttu-id="9083f-479">Internet</span><span class="sxs-lookup"><span data-stu-id="9083f-479">Internet</span></span> | * | * | <span data-ttu-id="9083f-480">80</span><span class="sxs-lookup"><span data-stu-id="9083f-480">80</span></span> | <span data-ttu-id="9083f-481">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-481">TCP</span></span> |

### <a name="db-servers-management-nic"></a><span data-ttu-id="9083f-482">DB servers (Management NIC)</span><span class="sxs-lookup"><span data-stu-id="9083f-482">DB servers (Management NIC)</span></span>
<span data-ttu-id="9083f-483">**Inbound rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-483">**Inbound rules**</span></span>

| <span data-ttu-id="9083f-484">Rule</span><span class="sxs-lookup"><span data-stu-id="9083f-484">Rule</span></span> | <span data-ttu-id="9083f-485">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-485">Access</span></span> | <span data-ttu-id="9083f-486">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-486">Priority</span></span> | <span data-ttu-id="9083f-487">Source address range</span><span class="sxs-lookup"><span data-stu-id="9083f-487">Source address range</span></span> | <span data-ttu-id="9083f-488">Source port</span><span class="sxs-lookup"><span data-stu-id="9083f-488">Source port</span></span> | <span data-ttu-id="9083f-489">Destination address range</span><span class="sxs-lookup"><span data-stu-id="9083f-489">Destination address range</span></span> | <span data-ttu-id="9083f-490">Destination port</span><span class="sxs-lookup"><span data-stu-id="9083f-490">Destination port</span></span> | <span data-ttu-id="9083f-491">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-491">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-492">Allow-Inbound-RDP-Front-end</span><span class="sxs-lookup"><span data-stu-id="9083f-492">Allow-Inbound-RDP-Front-end</span></span> | <span data-ttu-id="9083f-493">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-493">Allow</span></span> | <span data-ttu-id="9083f-494">100</span><span class="sxs-lookup"><span data-stu-id="9083f-494">100</span></span> | <span data-ttu-id="9083f-495">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="9083f-495">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="9083f-496">3389</span><span class="sxs-lookup"><span data-stu-id="9083f-496">3389</span></span> | <span data-ttu-id="9083f-497">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-497">TCP</span></span> |

### <a name="db-servers-database-traffic-nic"></a><span data-ttu-id="9083f-498">DB servers (Database traffic NIC)</span><span class="sxs-lookup"><span data-stu-id="9083f-498">DB servers (Database traffic NIC)</span></span>
<span data-ttu-id="9083f-499">**Inbound rules**</span><span class="sxs-lookup"><span data-stu-id="9083f-499">**Inbound rules**</span></span>

| <span data-ttu-id="9083f-500">Rule</span><span class="sxs-lookup"><span data-stu-id="9083f-500">Rule</span></span> | <span data-ttu-id="9083f-501">Access</span><span class="sxs-lookup"><span data-stu-id="9083f-501">Access</span></span> | <span data-ttu-id="9083f-502">Priority</span><span class="sxs-lookup"><span data-stu-id="9083f-502">Priority</span></span> | <span data-ttu-id="9083f-503">Source address range</span><span class="sxs-lookup"><span data-stu-id="9083f-503">Source address range</span></span> | <span data-ttu-id="9083f-504">Source port</span><span class="sxs-lookup"><span data-stu-id="9083f-504">Source port</span></span> | <span data-ttu-id="9083f-505">Destination address range</span><span class="sxs-lookup"><span data-stu-id="9083f-505">Destination address range</span></span> | <span data-ttu-id="9083f-506">Destination port</span><span class="sxs-lookup"><span data-stu-id="9083f-506">Destination port</span></span> | <span data-ttu-id="9083f-507">Protocol</span><span class="sxs-lookup"><span data-stu-id="9083f-507">Protocol</span></span> |
| --- | --- | --- | --- | --- | --- | --- | --- |
| <span data-ttu-id="9083f-508">Allow-Inbound-SQL-Front-end</span><span class="sxs-lookup"><span data-stu-id="9083f-508">Allow-Inbound-SQL-Front-end</span></span> | <span data-ttu-id="9083f-509">Allow</span><span class="sxs-lookup"><span data-stu-id="9083f-509">Allow</span></span> | <span data-ttu-id="9083f-510">100</span><span class="sxs-lookup"><span data-stu-id="9083f-510">100</span></span> | <span data-ttu-id="9083f-511">192.168.1.0/24</span><span class="sxs-lookup"><span data-stu-id="9083f-511">192.168.1.0/24</span></span> | * | * | <span data-ttu-id="9083f-512">1433</span><span class="sxs-lookup"><span data-stu-id="9083f-512">1433</span></span> | <span data-ttu-id="9083f-513">TCP</span><span class="sxs-lookup"><span data-stu-id="9083f-513">TCP</span></span> |

<span data-ttu-id="9083f-514">Since some of the NSGs are associated to individual NICs, the rules are for resources deployed through Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="9083f-514">Since some of the NSGs are associated to individual NICs, the rules are for resources deployed through Resource Manager.</span></span> <span data-ttu-id="9083f-515">Rules are combined for subnet and NIC, depending on how they are associated.</span><span class="sxs-lookup"><span data-stu-id="9083f-515">Rules are combined for subnet and NIC, depending on how they are associated.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="9083f-516">Next steps</span><span class="sxs-lookup"><span data-stu-id="9083f-516">Next steps</span></span>
* <span data-ttu-id="9083f-517">[Deploy NSGs (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span><span class="sxs-lookup"><span data-stu-id="9083f-517">[Deploy NSGs (Resource Manager)](virtual-networks-create-nsg-arm-pportal.md).</span></span>
* <span data-ttu-id="9083f-518">[Deploy NSGs (classic)](virtual-networks-create-nsg-classic-ps.md).</span><span class="sxs-lookup"><span data-stu-id="9083f-518">[Deploy NSGs (classic)](virtual-networks-create-nsg-classic-ps.md).</span></span>
* <span data-ttu-id="9083f-519">[Manage NSG logs](virtual-network-nsg-manage-log.md).</span><span class="sxs-lookup"><span data-stu-id="9083f-519">[Manage NSG logs](virtual-network-nsg-manage-log.md).</span></span>
* <span data-ttu-id="9083f-520">[Troubleshoot NSGs] (virtual-network-nsg-troubleshoot-portal.md)</span><span class="sxs-lookup"><span data-stu-id="9083f-520">[Troubleshoot NSGs] (virtual-network-nsg-troubleshoot-portal.md)</span></span>


