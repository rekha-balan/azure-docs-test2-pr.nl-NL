---
title: Request units and estimating throughput - Azure Cosmos DB | Microsoft Docs
description: Learn about how to understand, specify, and estimate request unit requirements in Azure Cosmos DB.
services: cosmos-db
author: rimman
manager: kfile
ms.service: cosmos-db
ms.devlang: na
ms.topic: conceptual
ms.date: 06/26/2018
ms.author: rimman
ms.openlocfilehash: 66beeb2cc724f75d17a4c155f1cdb888153e8fbf
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44865566"
---
# <a name="request-units-in-azure-cosmos-db"></a><span data-ttu-id="7f7cd-103">Request units in Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="7f7cd-103">Request units in Azure Cosmos DB</span></span>

<span data-ttu-id="7f7cd-104">[Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) is the Microsoft globally distributed multimodel database.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-104">[Azure Cosmos DB](https://azure.microsoft.com/services/cosmos-db/) is the Microsoft globally distributed multimodel database.</span></span> <span data-ttu-id="7f7cd-105">With Azure Cosmos DB, you don't have to rent virtual machines, deploy software, or monitor databases.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-105">With Azure Cosmos DB, you don't have to rent virtual machines, deploy software, or monitor databases.</span></span> <span data-ttu-id="7f7cd-106">Azure Cosmos DB is operated and continuously monitored by Microsoft top engineers to deliver world-class availability, performance, and data protection.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-106">Azure Cosmos DB is operated and continuously monitored by Microsoft top engineers to deliver world-class availability, performance, and data protection.</span></span> <span data-ttu-id="7f7cd-107">You can access your data by using APIs of your choice, like the [SQL](documentdb-introduction.md), [MongoDB](mongodb-introduction.md), and [Table](table-introduction.md) APIs, and graph via the [Gremlin API](graph-introduction.md).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-107">You can access your data by using APIs of your choice, like the [SQL](documentdb-introduction.md), [MongoDB](mongodb-introduction.md), and [Table](table-introduction.md) APIs, and graph via the [Gremlin API](graph-introduction.md).</span></span> <span data-ttu-id="7f7cd-108">All APIs are all natively supported.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-108">All APIs are all natively supported.</span></span> 

<span data-ttu-id="7f7cd-109">The currency of Azure Cosmos DB is the *request unit (RU)*.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-109">The currency of Azure Cosmos DB is the *request unit (RU)*.</span></span> <span data-ttu-id="7f7cd-110">With request units, you don't need to reserve read/write capacities or provision CPU, memory, and IOPS.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-110">With request units, you don't need to reserve read/write capacities or provision CPU, memory, and IOPS.</span></span> <span data-ttu-id="7f7cd-111">Azure Cosmos DB supports various APIs that have different operations, ranging from simple reads and writes to complex graph queries.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-111">Azure Cosmos DB supports various APIs that have different operations, ranging from simple reads and writes to complex graph queries.</span></span> <span data-ttu-id="7f7cd-112">Because not all requests are equal, requests are assigned a normalized quantity of request units based on the amount of computation required to serve the request.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-112">Because not all requests are equal, requests are assigned a normalized quantity of request units based on the amount of computation required to serve the request.</span></span> <span data-ttu-id="7f7cd-113">The number of request units for an operation is deterministic.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-113">The number of request units for an operation is deterministic.</span></span> <span data-ttu-id="7f7cd-114">You can track the number of request units that are consumed by any operation in Azure Cosmos DB via a response header.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-114">You can track the number of request units that are consumed by any operation in Azure Cosmos DB via a response header.</span></span> 

<span data-ttu-id="7f7cd-115">To provide predictable performance, reserve throughput in units of 100 RU/second.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-115">To provide predictable performance, reserve throughput in units of 100 RU/second.</span></span> <span data-ttu-id="7f7cd-116">You can [estimate your throughput needs](request-units.md#estimating-throughput-needs) by using the Azure Cosmos DB [request unit calculator](https://www.documentdb.com/capacityplanner).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-116">You can [estimate your throughput needs](request-units.md#estimating-throughput-needs) by using the Azure Cosmos DB [request unit calculator](https://www.documentdb.com/capacityplanner).</span></span>

![Throughput calculator][5]

<span data-ttu-id="7f7cd-118">After reading this article, you'll be able to answer the following questions:</span><span class="sxs-lookup"><span data-stu-id="7f7cd-118">After reading this article, you'll be able to answer the following questions:</span></span>

* <span data-ttu-id="7f7cd-119">What are request units and request charges in Azure Cosmos DB?</span><span class="sxs-lookup"><span data-stu-id="7f7cd-119">What are request units and request charges in Azure Cosmos DB?</span></span>
* <span data-ttu-id="7f7cd-120">How do I specify request unit capacity for a container or set of containers in Azure Cosmos DB?</span><span class="sxs-lookup"><span data-stu-id="7f7cd-120">How do I specify request unit capacity for a container or set of containers in Azure Cosmos DB?</span></span>
* <span data-ttu-id="7f7cd-121">How do I estimate my application's request unit needs?</span><span class="sxs-lookup"><span data-stu-id="7f7cd-121">How do I estimate my application's request unit needs?</span></span>
* <span data-ttu-id="7f7cd-122">What happens if I exceed request unit capacity for a container or set of containers in Azure Cosmos DB?</span><span class="sxs-lookup"><span data-stu-id="7f7cd-122">What happens if I exceed request unit capacity for a container or set of containers in Azure Cosmos DB?</span></span>

<span data-ttu-id="7f7cd-123">Because Azure Cosmos DB is a multimodel database, it's important to note that this article is applicable to all data models and APIs in Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-123">Because Azure Cosmos DB is a multimodel database, it's important to note that this article is applicable to all data models and APIs in Azure Cosmos DB.</span></span> <span data-ttu-id="7f7cd-124">This article uses generic terms like *container* to refer generically to a collection or graph and *item* to refer generically to a table, document, node, or entity.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-124">This article uses generic terms like *container* to refer generically to a collection or graph and *item* to refer generically to a table, document, node, or entity.</span></span>

## <a name="request-units-and-request-charges"></a><span data-ttu-id="7f7cd-125">Request units and request charges</span><span class="sxs-lookup"><span data-stu-id="7f7cd-125">Request units and request charges</span></span>

<span data-ttu-id="7f7cd-126">Azure Cosmos DB delivers fast, predictable performance by reserving resources to satisfy the throughput needs of your application.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-126">Azure Cosmos DB delivers fast, predictable performance by reserving resources to satisfy the throughput needs of your application.</span></span> <span data-ttu-id="7f7cd-127">Application load and access patterns change over time.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-127">Application load and access patterns change over time.</span></span> <span data-ttu-id="7f7cd-128">Azure Cosmos DB can help you easily increase or decrease the amount of reserved throughput available to your application.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-128">Azure Cosmos DB can help you easily increase or decrease the amount of reserved throughput available to your application.</span></span>

<span data-ttu-id="7f7cd-129">With Azure Cosmos DB, reserved throughput is specified in terms of request unit processing per second.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-129">With Azure Cosmos DB, reserved throughput is specified in terms of request unit processing per second.</span></span> <span data-ttu-id="7f7cd-130">You can think of request units as throughput currency.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-130">You can think of request units as throughput currency.</span></span> <span data-ttu-id="7f7cd-131">You reserve a number of guaranteed request units to be available to your application on a per-second basis.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-131">You reserve a number of guaranteed request units to be available to your application on a per-second basis.</span></span> <span data-ttu-id="7f7cd-132">Each operation in Azure Cosmos DB, including writing a document, performing a query, and updating a document, consumes CPU, memory, and IOPS.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-132">Each operation in Azure Cosmos DB, including writing a document, performing a query, and updating a document, consumes CPU, memory, and IOPS.</span></span> <span data-ttu-id="7f7cd-133">That is, each operation incurs a request charge, which is expressed in request units.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-133">That is, each operation incurs a request charge, which is expressed in request units.</span></span> <span data-ttu-id="7f7cd-134">When you understand the factors that affect request unit charges and your application's throughput requirements, you can run your application as cost effectively as possible.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-134">When you understand the factors that affect request unit charges and your application's throughput requirements, you can run your application as cost effectively as possible.</span></span> 

## <a name="throughput-isolation-in-globally-distributed-databases"></a><span data-ttu-id="7f7cd-135">Throughput isolation in globally distributed databases</span><span class="sxs-lookup"><span data-stu-id="7f7cd-135">Throughput isolation in globally distributed databases</span></span>

<span data-ttu-id="7f7cd-136">If you replicate your database to more than one region, Azure Cosmos DB provides throughput isolation to ensure that request unit usage in one region doesn't affect request unit usage in another region.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-136">If you replicate your database to more than one region, Azure Cosmos DB provides throughput isolation to ensure that request unit usage in one region doesn't affect request unit usage in another region.</span></span> <span data-ttu-id="7f7cd-137">For example, if you write data to one region and read data from another region, the request units that are used to perform the write operation in region A don't take away from the request units that are used for the read operation in region B. Request units aren't split across the regions in which you've deployed your database.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-137">For example, if you write data to one region and read data from another region, the request units that are used to perform the write operation in region A don't take away from the request units that are used for the read operation in region B. Request units aren't split across the regions in which you've deployed your database.</span></span> <span data-ttu-id="7f7cd-138">Each region in which the database is replicated has the full number of request units provisioned.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-138">Each region in which the database is replicated has the full number of request units provisioned.</span></span> <span data-ttu-id="7f7cd-139">For more information about global replication, see [How to distribute data globally with Azure Cosmos DB](distribute-data-globally.md).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-139">For more information about global replication, see [How to distribute data globally with Azure Cosmos DB](distribute-data-globally.md).</span></span>

## <a name="request-unit-considerations"></a><span data-ttu-id="7f7cd-140">Request unit considerations</span><span class="sxs-lookup"><span data-stu-id="7f7cd-140">Request unit considerations</span></span>
<span data-ttu-id="7f7cd-141">When you estimate the number of request units to provision, it's important to consider the following variables:</span><span class="sxs-lookup"><span data-stu-id="7f7cd-141">When you estimate the number of request units to provision, it's important to consider the following variables:</span></span>

* <span data-ttu-id="7f7cd-142">**Item size**.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-142">**Item size**.</span></span> <span data-ttu-id="7f7cd-143">As size increases, the number of request units consumed to read or write the data also increases.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-143">As size increases, the number of request units consumed to read or write the data also increases.</span></span>
* <span data-ttu-id="7f7cd-144">**Item property count**.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-144">**Item property count**.</span></span> <span data-ttu-id="7f7cd-145">Assuming default indexing of all properties, the units consumed to write a document, node, or entity increase as the property count increases.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-145">Assuming default indexing of all properties, the units consumed to write a document, node, or entity increase as the property count increases.</span></span>
* <span data-ttu-id="7f7cd-146">**Data consistency**.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-146">**Data consistency**.</span></span> <span data-ttu-id="7f7cd-147">When you use data consistency models like Strong or Bounded Staleness, additional request units are consumed to read items.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-147">When you use data consistency models like Strong or Bounded Staleness, additional request units are consumed to read items.</span></span>
* <span data-ttu-id="7f7cd-148">**Indexed properties**.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-148">**Indexed properties**.</span></span> <span data-ttu-id="7f7cd-149">An index policy on each container determines which properties are indexed by default.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-149">An index policy on each container determines which properties are indexed by default.</span></span> <span data-ttu-id="7f7cd-150">You can reduce your request unit consumption for write operations by limiting the number of indexed properties or by enabling lazy indexing.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-150">You can reduce your request unit consumption for write operations by limiting the number of indexed properties or by enabling lazy indexing.</span></span>
* <span data-ttu-id="7f7cd-151">**Document indexing**.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-151">**Document indexing**.</span></span> <span data-ttu-id="7f7cd-152">By default, each item is automatically indexed.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-152">By default, each item is automatically indexed.</span></span> <span data-ttu-id="7f7cd-153">You consume fewer request units if you choose to not index some of your items.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-153">You consume fewer request units if you choose to not index some of your items.</span></span>
* <span data-ttu-id="7f7cd-154">**Query patterns**.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-154">**Query patterns**.</span></span> <span data-ttu-id="7f7cd-155">The complexity of a query affects how many request units are consumed for an operation.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-155">The complexity of a query affects how many request units are consumed for an operation.</span></span> <span data-ttu-id="7f7cd-156">The number of query results, the number of predicates, the nature of the predicates, the number of user-defined functions, the size of the source data, and projections all affect the cost of query operations.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-156">The number of query results, the number of predicates, the nature of the predicates, the number of user-defined functions, the size of the source data, and projections all affect the cost of query operations.</span></span>
* <span data-ttu-id="7f7cd-157">**Script usage**.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-157">**Script usage**.</span></span> <span data-ttu-id="7f7cd-158">As with queries, stored procedures and triggers consume request units based on the complexity of the operations being performed.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-158">As with queries, stored procedures and triggers consume request units based on the complexity of the operations being performed.</span></span> <span data-ttu-id="7f7cd-159">As you develop your application, inspect the request charge header to better understand how each operation consumes request unit capacity.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-159">As you develop your application, inspect the request charge header to better understand how each operation consumes request unit capacity.</span></span>

## <a name="estimating-throughput-needs"></a><span data-ttu-id="7f7cd-160">Estimating throughput needs</span><span class="sxs-lookup"><span data-stu-id="7f7cd-160">Estimating throughput needs</span></span>
<span data-ttu-id="7f7cd-161">A request unit is a normalized measure of request processing cost.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-161">A request unit is a normalized measure of request processing cost.</span></span> <span data-ttu-id="7f7cd-162">A single request unit represents the processing capacity that's required to read (via self link or ID) a single 1-KB item that consists of 10 unique property values (excluding system properties).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-162">A single request unit represents the processing capacity that's required to read (via self link or ID) a single 1-KB item that consists of 10 unique property values (excluding system properties).</span></span> <span data-ttu-id="7f7cd-163">A request to create (insert), replace, or delete the same item consumes more processing from the service and thereby requires more request units.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-163">A request to create (insert), replace, or delete the same item consumes more processing from the service and thereby requires more request units.</span></span> 

> [!NOTE]
> <span data-ttu-id="7f7cd-164">The baseline of 1 request unit for a 1-KB item corresponds to a simple GET by self link or ID of the item.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-164">The baseline of 1 request unit for a 1-KB item corresponds to a simple GET by self link or ID of the item.</span></span>
> 
> 

<span data-ttu-id="7f7cd-165">For example, here's a table that shows how many request units to provision for items with three different sizes (1 KB, 4 KB, and 64 KB) and at two different performance levels (500 reads/second + 100 writes/second and 500 reads/second + 500 writes/second).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-165">For example, here's a table that shows how many request units to provision for items with three different sizes (1 KB, 4 KB, and 64 KB) and at two different performance levels (500 reads/second + 100 writes/second and 500 reads/second + 500 writes/second).</span></span> <span data-ttu-id="7f7cd-166">In this example, the data consistency is set to **Session**, and the indexing policy is set to **None**.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-166">In this example, the data consistency is set to **Session**, and the indexing policy is set to **None**.</span></span>

| <span data-ttu-id="7f7cd-167">Item size</span><span class="sxs-lookup"><span data-stu-id="7f7cd-167">Item size</span></span> | <span data-ttu-id="7f7cd-168">Reads/second</span><span class="sxs-lookup"><span data-stu-id="7f7cd-168">Reads/second</span></span> | <span data-ttu-id="7f7cd-169">Writes/second</span><span class="sxs-lookup"><span data-stu-id="7f7cd-169">Writes/second</span></span> | <span data-ttu-id="7f7cd-170">Request units</span><span class="sxs-lookup"><span data-stu-id="7f7cd-170">Request units</span></span>
| --- | --- | --- | --- |
| <span data-ttu-id="7f7cd-171">1 KB</span><span class="sxs-lookup"><span data-stu-id="7f7cd-171">1 KB</span></span> | <span data-ttu-id="7f7cd-172">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-172">500</span></span> | <span data-ttu-id="7f7cd-173">100</span><span class="sxs-lookup"><span data-stu-id="7f7cd-173">100</span></span> | <span data-ttu-id="7f7cd-174">(500 \* 1) + (100 \* 5) = 1,000 RU/s</span><span class="sxs-lookup"><span data-stu-id="7f7cd-174">(500 \* 1) + (100 \* 5) = 1,000 RU/s</span></span>
| <span data-ttu-id="7f7cd-175">1 KB</span><span class="sxs-lookup"><span data-stu-id="7f7cd-175">1 KB</span></span> | <span data-ttu-id="7f7cd-176">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-176">500</span></span> | <span data-ttu-id="7f7cd-177">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-177">500</span></span> | <span data-ttu-id="7f7cd-178">(500 \* 1) + (500 \* 5) = 3,000 RU/s</span><span class="sxs-lookup"><span data-stu-id="7f7cd-178">(500 \* 1) + (500 \* 5) = 3,000 RU/s</span></span>
| <span data-ttu-id="7f7cd-179">4 KB</span><span class="sxs-lookup"><span data-stu-id="7f7cd-179">4 KB</span></span> | <span data-ttu-id="7f7cd-180">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-180">500</span></span> | <span data-ttu-id="7f7cd-181">100</span><span class="sxs-lookup"><span data-stu-id="7f7cd-181">100</span></span> | <span data-ttu-id="7f7cd-182">(500 \* 1.3) + (100 \* 7) = 1,350 RU/s</span><span class="sxs-lookup"><span data-stu-id="7f7cd-182">(500 \* 1.3) + (100 \* 7) = 1,350 RU/s</span></span>
| <span data-ttu-id="7f7cd-183">4 KB</span><span class="sxs-lookup"><span data-stu-id="7f7cd-183">4 KB</span></span> | <span data-ttu-id="7f7cd-184">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-184">500</span></span> | <span data-ttu-id="7f7cd-185">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-185">500</span></span> | <span data-ttu-id="7f7cd-186">(500 \* 1.3) + (500 \* 7) = 4,150 RU/s</span><span class="sxs-lookup"><span data-stu-id="7f7cd-186">(500 \* 1.3) + (500 \* 7) = 4,150 RU/s</span></span>
| <span data-ttu-id="7f7cd-187">64 KB</span><span class="sxs-lookup"><span data-stu-id="7f7cd-187">64 KB</span></span> | <span data-ttu-id="7f7cd-188">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-188">500</span></span> | <span data-ttu-id="7f7cd-189">100</span><span class="sxs-lookup"><span data-stu-id="7f7cd-189">100</span></span> | <span data-ttu-id="7f7cd-190">(500 \* 10) + (100 \* 48) = 9,800 RU/s</span><span class="sxs-lookup"><span data-stu-id="7f7cd-190">(500 \* 10) + (100 \* 48) = 9,800 RU/s</span></span>
| <span data-ttu-id="7f7cd-191">64 KB</span><span class="sxs-lookup"><span data-stu-id="7f7cd-191">64 KB</span></span> | <span data-ttu-id="7f7cd-192">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-192">500</span></span> | <span data-ttu-id="7f7cd-193">500</span><span class="sxs-lookup"><span data-stu-id="7f7cd-193">500</span></span> | <span data-ttu-id="7f7cd-194">(500 \* 10) + (500 \* 48) = 29,000 RU/s</span><span class="sxs-lookup"><span data-stu-id="7f7cd-194">(500 \* 10) + (500 \* 48) = 29,000 RU/s</span></span>


### <a name="use-the-request-unit-calculator"></a><span data-ttu-id="7f7cd-195">Use the request unit calculator</span><span class="sxs-lookup"><span data-stu-id="7f7cd-195">Use the request unit calculator</span></span>
<span data-ttu-id="7f7cd-196">To help you fine-tune your throughput estimations, you can use a web-based [request unit calculator](https://www.documentdb.com/capacityplanner).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-196">To help you fine-tune your throughput estimations, you can use a web-based [request unit calculator](https://www.documentdb.com/capacityplanner).</span></span> <span data-ttu-id="7f7cd-197">The calculator can help your estimate the request unit requirements for typical operations, including:</span><span class="sxs-lookup"><span data-stu-id="7f7cd-197">The calculator can help your estimate the request unit requirements for typical operations, including:</span></span>

* <span data-ttu-id="7f7cd-198">Item creates (writes)</span><span class="sxs-lookup"><span data-stu-id="7f7cd-198">Item creates (writes)</span></span>
* <span data-ttu-id="7f7cd-199">Item reads</span><span class="sxs-lookup"><span data-stu-id="7f7cd-199">Item reads</span></span>
* <span data-ttu-id="7f7cd-200">Item deletes</span><span class="sxs-lookup"><span data-stu-id="7f7cd-200">Item deletes</span></span>
* <span data-ttu-id="7f7cd-201">Item updates</span><span class="sxs-lookup"><span data-stu-id="7f7cd-201">Item updates</span></span>

<span data-ttu-id="7f7cd-202">The tool also includes support for estimating data storage needs based on the sample items that you provide.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-202">The tool also includes support for estimating data storage needs based on the sample items that you provide.</span></span>

<span data-ttu-id="7f7cd-203">To use the tool:</span><span class="sxs-lookup"><span data-stu-id="7f7cd-203">To use the tool:</span></span>

1. <span data-ttu-id="7f7cd-204">Upload one or more representative items (for example, a sample JSON document).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-204">Upload one or more representative items (for example, a sample JSON document).</span></span>
   
    ![Upload items to the request unit calculator][2]
2. <span data-ttu-id="7f7cd-206">To estimate the data storage requirements, enter the total number of items (for example, documents, rows, or vertices) that you expect to store.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-206">To estimate the data storage requirements, enter the total number of items (for example, documents, rows, or vertices) that you expect to store.</span></span>
3. <span data-ttu-id="7f7cd-207">Enter the number of create, read, update, and delete operations that you require (on a per-second basis).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-207">Enter the number of create, read, update, and delete operations that you require (on a per-second basis).</span></span> <span data-ttu-id="7f7cd-208">To estimate the request unit charges of item update operations, upload a copy of the sample item from step 1 that includes typical field updates.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-208">To estimate the request unit charges of item update operations, upload a copy of the sample item from step 1 that includes typical field updates.</span></span> <span data-ttu-id="7f7cd-209">For example, if item updates typically modify two properties named *lastLogin* and *userVisits*, copy a sample item, update the values for those two properties, and then upload the copied item.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-209">For example, if item updates typically modify two properties named *lastLogin* and *userVisits*, copy a sample item, update the values for those two properties, and then upload the copied item.</span></span>
   
    ![Enter throughput requirements in the request unit calculator][3]
4. <span data-ttu-id="7f7cd-211">Select **Calculate**, and then examine the results.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-211">Select **Calculate**, and then examine the results.</span></span>
   
    ![Request unit calculator results][4]

> [!NOTE]
> <span data-ttu-id="7f7cd-213">If you have item types that differ dramatically in terms of size and the number of indexed properties, upload a sample of each *type* of typical item to the tool, and then calculate the results.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-213">If you have item types that differ dramatically in terms of size and the number of indexed properties, upload a sample of each *type* of typical item to the tool, and then calculate the results.</span></span>
> 
> 

### <a name="use-the-azure-cosmos-db-request-charge-response-header"></a><span data-ttu-id="7f7cd-214">Use the Azure Cosmos DB request charge response header</span><span class="sxs-lookup"><span data-stu-id="7f7cd-214">Use the Azure Cosmos DB request charge response header</span></span>
<span data-ttu-id="7f7cd-215">Every response from the Azure Cosmos DB service includes a custom header (`x-ms-request-charge`) that contains the request units consumed for a given request.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-215">Every response from the Azure Cosmos DB service includes a custom header (`x-ms-request-charge`) that contains the request units consumed for a given request.</span></span> <span data-ttu-id="7f7cd-216">You can also access this header through the Azure Cosmos DB SDKs.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-216">You can also access this header through the Azure Cosmos DB SDKs.</span></span> <span data-ttu-id="7f7cd-217">In the .NET SDK, **RequestCharge** is a property of the **ResourceResponse** object.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-217">In the .NET SDK, **RequestCharge** is a property of the **ResourceResponse** object.</span></span> <span data-ttu-id="7f7cd-218">For queries, the Azure Cosmos DB Data Explorer in the Azure portal provides request charge information for executed queries.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-218">For queries, the Azure Cosmos DB Data Explorer in the Azure portal provides request charge information for executed queries.</span></span> <span data-ttu-id="7f7cd-219">To learn about how to get and set throughput by using different multi-model APIs see [set and get throughput in Azure Cosmos DB](set-throughput.md) article.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-219">To learn about how to get and set throughput by using different multi-model APIs see [set and get throughput in Azure Cosmos DB](set-throughput.md) article.</span></span>

<span data-ttu-id="7f7cd-220">One method for estimating the amount of reserved throughput required by your application is to record the request unit charge associated with running typical operations against a representative item that's used by your application.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-220">One method for estimating the amount of reserved throughput required by your application is to record the request unit charge associated with running typical operations against a representative item that's used by your application.</span></span> <span data-ttu-id="7f7cd-221">Then, estimate the number of operations you anticipate to perform each second.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-221">Then, estimate the number of operations you anticipate to perform each second.</span></span> <span data-ttu-id="7f7cd-222">Be sure to also measure and include typical queries and Azure Cosmos DB script usage.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-222">Be sure to also measure and include typical queries and Azure Cosmos DB script usage.</span></span>

> [!NOTE]
> <span data-ttu-id="7f7cd-223">If you have item types that differ dramatically in terms of size and the number of indexed properties, record the applicable operation request unit charge associated with each *type* of typical item.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-223">If you have item types that differ dramatically in terms of size and the number of indexed properties, record the applicable operation request unit charge associated with each *type* of typical item.</span></span>
> 
> 

<span data-ttu-id="7f7cd-224">For example, these are the steps you might take:</span><span class="sxs-lookup"><span data-stu-id="7f7cd-224">For example, these are the steps you might take:</span></span>

1. <span data-ttu-id="7f7cd-225">Record the request unit charge of creating (inserting) a typical item.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-225">Record the request unit charge of creating (inserting) a typical item.</span></span> 
2. <span data-ttu-id="7f7cd-226">Record the request unit charge of reading a typical item.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-226">Record the request unit charge of reading a typical item.</span></span>
3. <span data-ttu-id="7f7cd-227">Record the request unit charge of updating a typical item.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-227">Record the request unit charge of updating a typical item.</span></span>
4. <span data-ttu-id="7f7cd-228">Record the request unit charge of typical, common item queries.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-228">Record the request unit charge of typical, common item queries.</span></span>
5. <span data-ttu-id="7f7cd-229">Record the request unit charge of any custom scripts (stored procedures, triggers, user-defined functions) that the application uses.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-229">Record the request unit charge of any custom scripts (stored procedures, triggers, user-defined functions) that the application uses.</span></span>
6. <span data-ttu-id="7f7cd-230">Calculate the required request units given the estimated number of operations you anticipate to run each second.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-230">Calculate the required request units given the estimated number of operations you anticipate to run each second.</span></span>

## <a name="a-request-unit-estimate-example"></a><span data-ttu-id="7f7cd-231">A request unit estimate example</span><span class="sxs-lookup"><span data-stu-id="7f7cd-231">A request unit estimate example</span></span>
<span data-ttu-id="7f7cd-232">Consider the following document, which is approximately 1 KB in size:</span><span class="sxs-lookup"><span data-stu-id="7f7cd-232">Consider the following document, which is approximately 1 KB in size:</span></span>

```json
{
 "id": "08259",
  "description": "Cereals ready-to-eat, KELLOGG, KELLOGG'S CRISPIX",
  "tags": [
    {
      "name": "cereals ready-to-eat"
    },
    {
      "name": "kellogg"
    },
    {
      "name": "kellogg's crispix"
    }
  ],
  "version": 1,
  "commonName": "Includes USDA Commodity B855",
  "manufacturerName": "Kellogg, Co.",
  "isFromSurvey": false,
  "foodGroup": "Breakfast Cereals",
  "nutrients": [
    {
      "id": "262",
      "description": "Caffeine",
      "nutritionValue": 0,
      "units": "mg"
    },
    {
      "id": "307",
      "description": "Sodium, Na",
      "nutritionValue": 611,
      "units": "mg"
    },
    {
      "id": "309",
      "description": "Zinc, Zn",
      "nutritionValue": 5.2,
      "units": "mg"
    }
  ],
  "servings": [
    {
      "amount": 1,
      "description": "cup (1 NLEA serving)",
      "weightInGrams": 29
    }
  ]
}
```

> [!NOTE]
> <span data-ttu-id="7f7cd-233">Documents are minified in Azure Cosmos DB, so the system-calculated size of the document above is slightly less than 1 KB.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-233">Documents are minified in Azure Cosmos DB, so the system-calculated size of the document above is slightly less than 1 KB.</span></span>
> 
> 

<span data-ttu-id="7f7cd-234">The following table shows approximate request unit charges for typical operations on this item.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-234">The following table shows approximate request unit charges for typical operations on this item.</span></span> <span data-ttu-id="7f7cd-235">(The approximate request unit charge assumes that the account consistency level is set to **Session** and that all items are automatically indexed.)</span><span class="sxs-lookup"><span data-stu-id="7f7cd-235">(The approximate request unit charge assumes that the account consistency level is set to **Session** and that all items are automatically indexed.)</span></span>

| <span data-ttu-id="7f7cd-236">Operation</span><span class="sxs-lookup"><span data-stu-id="7f7cd-236">Operation</span></span> | <span data-ttu-id="7f7cd-237">Request unit charge</span><span class="sxs-lookup"><span data-stu-id="7f7cd-237">Request unit charge</span></span> |
| --- | --- |
| <span data-ttu-id="7f7cd-238">Create item</span><span class="sxs-lookup"><span data-stu-id="7f7cd-238">Create item</span></span> |<span data-ttu-id="7f7cd-239">~15 RU</span><span class="sxs-lookup"><span data-stu-id="7f7cd-239">~15 RU</span></span> |
| <span data-ttu-id="7f7cd-240">Read item</span><span class="sxs-lookup"><span data-stu-id="7f7cd-240">Read item</span></span> |<span data-ttu-id="7f7cd-241">~1 RU</span><span class="sxs-lookup"><span data-stu-id="7f7cd-241">~1 RU</span></span> |
| <span data-ttu-id="7f7cd-242">Query item by ID</span><span class="sxs-lookup"><span data-stu-id="7f7cd-242">Query item by ID</span></span> |<span data-ttu-id="7f7cd-243">~2.5 RU</span><span class="sxs-lookup"><span data-stu-id="7f7cd-243">~2.5 RU</span></span> |

<span data-ttu-id="7f7cd-244">The following table shows approximate request unit charges for typical queries used in the application:</span><span class="sxs-lookup"><span data-stu-id="7f7cd-244">The following table shows approximate request unit charges for typical queries used in the application:</span></span>

| <span data-ttu-id="7f7cd-245">Query</span><span class="sxs-lookup"><span data-stu-id="7f7cd-245">Query</span></span> | <span data-ttu-id="7f7cd-246">Request unit charge</span><span class="sxs-lookup"><span data-stu-id="7f7cd-246">Request unit charge</span></span> | <span data-ttu-id="7f7cd-247"># of returned items</span><span class="sxs-lookup"><span data-stu-id="7f7cd-247"># of returned items</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7f7cd-248">Select food by ID</span><span class="sxs-lookup"><span data-stu-id="7f7cd-248">Select food by ID</span></span> |<span data-ttu-id="7f7cd-249">~2.5 RU</span><span class="sxs-lookup"><span data-stu-id="7f7cd-249">~2.5 RU</span></span> |<span data-ttu-id="7f7cd-250">1</span><span class="sxs-lookup"><span data-stu-id="7f7cd-250">1</span></span> |
| <span data-ttu-id="7f7cd-251">Select foods by manufacturer</span><span class="sxs-lookup"><span data-stu-id="7f7cd-251">Select foods by manufacturer</span></span> |<span data-ttu-id="7f7cd-252">~7 RU</span><span class="sxs-lookup"><span data-stu-id="7f7cd-252">~7 RU</span></span> |<span data-ttu-id="7f7cd-253">7</span><span class="sxs-lookup"><span data-stu-id="7f7cd-253">7</span></span> |
| <span data-ttu-id="7f7cd-254">Select by food group and order by weight</span><span class="sxs-lookup"><span data-stu-id="7f7cd-254">Select by food group and order by weight</span></span> |<span data-ttu-id="7f7cd-255">~70 RU</span><span class="sxs-lookup"><span data-stu-id="7f7cd-255">~70 RU</span></span> |<span data-ttu-id="7f7cd-256">100</span><span class="sxs-lookup"><span data-stu-id="7f7cd-256">100</span></span> |
| <span data-ttu-id="7f7cd-257">Select top 10 foods in a food group</span><span class="sxs-lookup"><span data-stu-id="7f7cd-257">Select top 10 foods in a food group</span></span> |<span data-ttu-id="7f7cd-258">~10 RU</span><span class="sxs-lookup"><span data-stu-id="7f7cd-258">~10 RU</span></span> |<span data-ttu-id="7f7cd-259">10</span><span class="sxs-lookup"><span data-stu-id="7f7cd-259">10</span></span> |

> [!NOTE]
> <span data-ttu-id="7f7cd-260">Request unit charges vary based on the number of items returned.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-260">Request unit charges vary based on the number of items returned.</span></span>
> 
> 

<span data-ttu-id="7f7cd-261">With this information, you can estimate the request unit requirements for this application given the number of operations and queries that you expect per second:</span><span class="sxs-lookup"><span data-stu-id="7f7cd-261">With this information, you can estimate the request unit requirements for this application given the number of operations and queries that you expect per second:</span></span>

| <span data-ttu-id="7f7cd-262">Operation/query</span><span class="sxs-lookup"><span data-stu-id="7f7cd-262">Operation/query</span></span> | <span data-ttu-id="7f7cd-263">Estimated number per second</span><span class="sxs-lookup"><span data-stu-id="7f7cd-263">Estimated number per second</span></span> | <span data-ttu-id="7f7cd-264">Required request units</span><span class="sxs-lookup"><span data-stu-id="7f7cd-264">Required request units</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7f7cd-265">Create item</span><span class="sxs-lookup"><span data-stu-id="7f7cd-265">Create item</span></span> |<span data-ttu-id="7f7cd-266">10</span><span class="sxs-lookup"><span data-stu-id="7f7cd-266">10</span></span> |<span data-ttu-id="7f7cd-267">150</span><span class="sxs-lookup"><span data-stu-id="7f7cd-267">150</span></span> |
| <span data-ttu-id="7f7cd-268">Read item</span><span class="sxs-lookup"><span data-stu-id="7f7cd-268">Read item</span></span> |<span data-ttu-id="7f7cd-269">100</span><span class="sxs-lookup"><span data-stu-id="7f7cd-269">100</span></span> |<span data-ttu-id="7f7cd-270">100</span><span class="sxs-lookup"><span data-stu-id="7f7cd-270">100</span></span> |
| <span data-ttu-id="7f7cd-271">Select foods by manufacturer</span><span class="sxs-lookup"><span data-stu-id="7f7cd-271">Select foods by manufacturer</span></span> |<span data-ttu-id="7f7cd-272">25</span><span class="sxs-lookup"><span data-stu-id="7f7cd-272">25</span></span> |<span data-ttu-id="7f7cd-273">175</span><span class="sxs-lookup"><span data-stu-id="7f7cd-273">175</span></span> |
| <span data-ttu-id="7f7cd-274">Select by food group</span><span class="sxs-lookup"><span data-stu-id="7f7cd-274">Select by food group</span></span> |<span data-ttu-id="7f7cd-275">10</span><span class="sxs-lookup"><span data-stu-id="7f7cd-275">10</span></span> |<span data-ttu-id="7f7cd-276">700</span><span class="sxs-lookup"><span data-stu-id="7f7cd-276">700</span></span> |
| <span data-ttu-id="7f7cd-277">Select top 10</span><span class="sxs-lookup"><span data-stu-id="7f7cd-277">Select top 10</span></span> |<span data-ttu-id="7f7cd-278">15</span><span class="sxs-lookup"><span data-stu-id="7f7cd-278">15</span></span> |<span data-ttu-id="7f7cd-279">150 Total</span><span class="sxs-lookup"><span data-stu-id="7f7cd-279">150 Total</span></span> |

<span data-ttu-id="7f7cd-280">In this case, you expect an average throughput requirement of 1,275 RU/second.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-280">In this case, you expect an average throughput requirement of 1,275 RU/second.</span></span> <span data-ttu-id="7f7cd-281">Rounding up to the nearest 100, you would provision 1,300 RU/second for this application's container (or set of containers).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-281">Rounding up to the nearest 100, you would provision 1,300 RU/second for this application's container (or set of containers).</span></span>

## <a id="RequestRateTooLarge"></a> <span data-ttu-id="7f7cd-282">Exceeding reserved throughput limits in Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="7f7cd-282">Exceeding reserved throughput limits in Azure Cosmos DB</span></span>
<span data-ttu-id="7f7cd-283">Request unit consumption is evaluated at a per-second rate.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-283">Request unit consumption is evaluated at a per-second rate.</span></span> <span data-ttu-id="7f7cd-284">For applications that exceed the provisioned request unit rate, requests are rate-limited until the rate drops below the provisioned throughput level.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-284">For applications that exceed the provisioned request unit rate, requests are rate-limited until the rate drops below the provisioned throughput level.</span></span> <span data-ttu-id="7f7cd-285">When a request is rate-limited, the server preemptively ends the request with `RequestRateTooLargeException` (HTTP status code 429) and returns the `x-ms-retry-after-ms` header.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-285">When a request is rate-limited, the server preemptively ends the request with `RequestRateTooLargeException` (HTTP status code 429) and returns the `x-ms-retry-after-ms` header.</span></span> <span data-ttu-id="7f7cd-286">The header indicates the amount of time, in milliseconds, that the user must wait before retrying the request.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-286">The header indicates the amount of time, in milliseconds, that the user must wait before retrying the request.</span></span>

    HTTP Status 429
    Status Line: RequestRateTooLarge
    x-ms-retry-after-ms :100

<span data-ttu-id="7f7cd-287">If you use the .NET Client SDK and LINQ queries, most of the time, you never have to deal with this exception.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-287">If you use the .NET Client SDK and LINQ queries, most of the time, you never have to deal with this exception.</span></span> <span data-ttu-id="7f7cd-288">The current version of the .NET Client SDK implicitly catches this response, respects the server-specified retry-after header, and automatically retries the request.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-288">The current version of the .NET Client SDK implicitly catches this response, respects the server-specified retry-after header, and automatically retries the request.</span></span> <span data-ttu-id="7f7cd-289">Unless your account is being accessed concurrently by multiple clients, the next retry will succeed.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-289">Unless your account is being accessed concurrently by multiple clients, the next retry will succeed.</span></span>

<span data-ttu-id="7f7cd-290">If you have more than one client cumulatively operating above the request rate, the default retry behavior might be insufficient, and the client throws a `DocumentClientException` with status code 429 to the application.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-290">If you have more than one client cumulatively operating above the request rate, the default retry behavior might be insufficient, and the client throws a `DocumentClientException` with status code 429 to the application.</span></span> <span data-ttu-id="7f7cd-291">In cases like this, you might want to consider handling the retry behavior and logic in your application's error-handling routines or increase the throughput provisioned for the container (or set of containers).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-291">In cases like this, you might want to consider handling the retry behavior and logic in your application's error-handling routines or increase the throughput provisioned for the container (or set of containers).</span></span>

## <a name="next-steps"></a><span data-ttu-id="7f7cd-292">Next steps</span><span class="sxs-lookup"><span data-stu-id="7f7cd-292">Next steps</span></span>
 
- <span data-ttu-id="7f7cd-293">Learn how to [set and get throughput in Azure Cosmos DB](set-throughput.md) by using Azure portal and SDKs.</span><span class="sxs-lookup"><span data-stu-id="7f7cd-293">Learn how to [set and get throughput in Azure Cosmos DB](set-throughput.md) by using Azure portal and SDKs.</span></span>
- <span data-ttu-id="7f7cd-294">Learn about [performance and scale testing with Azure Cosmos DB](performance-testing.md).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-294">Learn about [performance and scale testing with Azure Cosmos DB](performance-testing.md).</span></span>
- <span data-ttu-id="7f7cd-295">To learn more about reserved throughput with Azure Cosmos DB databases, see [Azure Cosmos DB pricing](https://azure.microsoft.com/pricing/details/cosmos-db/) and [Partitioning data in Azure Cosmos DB](partition-data.md).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-295">To learn more about reserved throughput with Azure Cosmos DB databases, see [Azure Cosmos DB pricing](https://azure.microsoft.com/pricing/details/cosmos-db/) and [Partitioning data in Azure Cosmos DB](partition-data.md).</span></span>
- <span data-ttu-id="7f7cd-296">To learn more about Azure Cosmos DB, see the [Azure Cosmos DB documentation](https://azure.microsoft.com/documentation/services/cosmos-db/).</span><span class="sxs-lookup"><span data-stu-id="7f7cd-296">To learn more about Azure Cosmos DB, see the [Azure Cosmos DB documentation](https://azure.microsoft.com/documentation/services/cosmos-db/).</span></span> 

[2]: ./media/request-units/RUEstimatorUpload.png
[3]: ./media/request-units/RUEstimatorDocuments.png
[4]: ./media/request-units/RUEstimatorResults.png
[5]: ./media/request-units/RUCalculator2.png

