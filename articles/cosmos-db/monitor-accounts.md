---
title: Monitor Azure Cosmos DB requests and storage | Microsoft Docs
description: Learn how to monitor your Azure Cosmos DB account for performance metrics, such as requests and server errors, and usage metrics, such as storage consumption.
services: cosmos-db
author: SnehaGunda
manager: kfile
ms.service: cosmos-db
ms.devlang: na
ms.topic: conceptual
ms.date: 09/19/2017
ms.author: sngun
ms.openlocfilehash: 1e5dba722f240bd6535ba64494912a153e9224c0
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44867151"
---
# <a name="monitor-azure-cosmos-db"></a><span data-ttu-id="fb947-103">Monitor Azure Cosmos DB</span><span class="sxs-lookup"><span data-stu-id="fb947-103">Monitor Azure Cosmos DB</span></span>
<span data-ttu-id="fb947-104">You can monitor your Azure Cosmos DB accounts in the [Azure portal](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="fb947-104">You can monitor your Azure Cosmos DB accounts in the [Azure portal](https://portal.azure.com/).</span></span> <span data-ttu-id="fb947-105">For each Azure Cosmos DB account, a full suite of metrics is available to monitor throughput, storage, availability, latency, and consistency.</span><span class="sxs-lookup"><span data-stu-id="fb947-105">For each Azure Cosmos DB account, a full suite of metrics is available to monitor throughput, storage, availability, latency, and consistency.</span></span>

<span data-ttu-id="fb947-106">Metrics can be reviewed on the Account page, the new Metrics page, or in Azure Monitor.</span><span class="sxs-lookup"><span data-stu-id="fb947-106">Metrics can be reviewed on the Account page, the new Metrics page, or in Azure Monitor.</span></span>

## <a name="view-performance-metrics-on-the-metrics-page"></a><span data-ttu-id="fb947-107">View performance metrics on the Metrics page</span><span class="sxs-lookup"><span data-stu-id="fb947-107">View performance metrics on the Metrics page</span></span>
1. <span data-ttu-id="fb947-108">In the [Azure portal](https://portal.azure.com/), click **All services**, scroll to **Databases**, click **Azure Cosmos DB**, and then click the name of the Azure Cosmos DB account for which you would like to view performance metrics.</span><span class="sxs-lookup"><span data-stu-id="fb947-108">In the [Azure portal](https://portal.azure.com/), click **All services**, scroll to **Databases**, click **Azure Cosmos DB**, and then click the name of the Azure Cosmos DB account for which you would like to view performance metrics.</span></span>
2. <span data-ttu-id="fb947-109">When the new page loads, in the resource menu, under **Monitoring**, click **Metrics**.</span><span class="sxs-lookup"><span data-stu-id="fb947-109">When the new page loads, in the resource menu, under **Monitoring**, click **Metrics**.</span></span>
3. <span data-ttu-id="fb947-110">When the Metrics page opens, select the collection to review from the **Collection(s)** drop-down.</span><span class="sxs-lookup"><span data-stu-id="fb947-110">When the Metrics page opens, select the collection to review from the **Collection(s)** drop-down.</span></span>

   <span data-ttu-id="fb947-111">The Azure portal displays the suite of collection metrics available.</span><span class="sxs-lookup"><span data-stu-id="fb947-111">The Azure portal displays the suite of collection metrics available.</span></span> <span data-ttu-id="fb947-112">Note that throughput, storage, availability, latency, and consistency metrics are provided on separate tabs.</span><span class="sxs-lookup"><span data-stu-id="fb947-112">Note that throughput, storage, availability, latency, and consistency metrics are provided on separate tabs.</span></span> <span data-ttu-id="fb947-113">To get additional detail on the metrics provided, click on the double-arrow in the top right of each metrics pane.</span><span class="sxs-lookup"><span data-stu-id="fb947-113">To get additional detail on the metrics provided, click on the double-arrow in the top right of each metrics pane.</span></span>

   ![Screen shot of the Monitoring lens that shows the metrics suite](./media/monitor-accounts/metrics-suite.png)

## <a name="view-performance-metrics-by-using-azure-monitoring"></a><span data-ttu-id="fb947-115">View performance metrics by using Azure Monitoring</span><span class="sxs-lookup"><span data-stu-id="fb947-115">View performance metrics by using Azure Monitoring</span></span>
1. <span data-ttu-id="fb947-116">In the [Azure portal](https://portal.azure.com/), click **Monitor** on the left bar.</span><span class="sxs-lookup"><span data-stu-id="fb947-116">In the [Azure portal](https://portal.azure.com/), click **Monitor** on the left bar.</span></span>
2. <span data-ttu-id="fb947-117">In the resource menu, click **Metrics**.</span><span class="sxs-lookup"><span data-stu-id="fb947-117">In the resource menu, click **Metrics**.</span></span>
3. <span data-ttu-id="fb947-118">In the **Monitor - Metrics** window, in the **Resource group** drop-down menu, select the resource group associated with the Azure Cosmos DB account that you'd like to monitor.</span><span class="sxs-lookup"><span data-stu-id="fb947-118">In the **Monitor - Metrics** window, in the **Resource group** drop-down menu, select the resource group associated with the Azure Cosmos DB account that you'd like to monitor.</span></span> 
4. <span data-ttu-id="fb947-119">In the **Resource** drop-down menu, select the database account to monitor.</span><span class="sxs-lookup"><span data-stu-id="fb947-119">In the **Resource** drop-down menu, select the database account to monitor.</span></span>
5. <span data-ttu-id="fb947-120">In the list of **Available metrics**, select the metrics to display.</span><span class="sxs-lookup"><span data-stu-id="fb947-120">In the list of **Available metrics**, select the metrics to display.</span></span> <span data-ttu-id="fb947-121">Use the CTRL button to multi-select.</span><span class="sxs-lookup"><span data-stu-id="fb947-121">Use the CTRL button to multi-select.</span></span> 

## <a name="view-performance-metrics-on-the-account-page"></a><span data-ttu-id="fb947-122">View performance metrics on the account page</span><span class="sxs-lookup"><span data-stu-id="fb947-122">View performance metrics on the account page</span></span>
1. <span data-ttu-id="fb947-123">In the [Azure portal](https://portal.azure.com/), click **All services**, scroll to **Databases**, click **Azure Cosmos DB**, and then click the name of the Azure Cosmos DB account for which you would like to view performance metrics.</span><span class="sxs-lookup"><span data-stu-id="fb947-123">In the [Azure portal](https://portal.azure.com/), click **All services**, scroll to **Databases**, click **Azure Cosmos DB**, and then click the name of the Azure Cosmos DB account for which you would like to view performance metrics.</span></span>
2. <span data-ttu-id="fb947-124">The **Monitoring** lens displays the following tiles by default:</span><span class="sxs-lookup"><span data-stu-id="fb947-124">The **Monitoring** lens displays the following tiles by default:</span></span>
   
   * <span data-ttu-id="fb947-125">Total requests for the current day.</span><span class="sxs-lookup"><span data-stu-id="fb947-125">Total requests for the current day.</span></span>
   * <span data-ttu-id="fb947-126">Storage used.</span><span class="sxs-lookup"><span data-stu-id="fb947-126">Storage used.</span></span>
   
   ![Screen shot of the Monitoring lens that shows the requests and the storage usage](./media/monitor-accounts/documentdb-total-requests-and-usage.png)
3. <span data-ttu-id="fb947-128">Clicking on the double-arrow in the top-right of the **Requests** tile opens a detailed **Metric** page.</span><span class="sxs-lookup"><span data-stu-id="fb947-128">Clicking on the double-arrow in the top-right of the **Requests** tile opens a detailed **Metric** page.</span></span>
4. <span data-ttu-id="fb947-129">The **Metric** page shows you details about the total requests.</span><span class="sxs-lookup"><span data-stu-id="fb947-129">The **Metric** page shows you details about the total requests.</span></span> 

## <a name="set-up-alerts-in-the-portal"></a><span data-ttu-id="fb947-130">Set up alerts in the portal</span><span class="sxs-lookup"><span data-stu-id="fb947-130">Set up alerts in the portal</span></span>
1. <span data-ttu-id="fb947-131">In the [Azure portal](https://portal.azure.com/), click **All services**, click **Azure Cosmos DB**, and then click the name of the Azure Cosmos DB account for which you would like to set up performance metric alerts.</span><span class="sxs-lookup"><span data-stu-id="fb947-131">In the [Azure portal](https://portal.azure.com/), click **All services**, click **Azure Cosmos DB**, and then click the name of the Azure Cosmos DB account for which you would like to set up performance metric alerts.</span></span>
2. <span data-ttu-id="fb947-132">In the resource menu, click **Alert Rules** to open the Alert rules page.</span><span class="sxs-lookup"><span data-stu-id="fb947-132">In the resource menu, click **Alert Rules** to open the Alert rules page.</span></span>  
   <span data-ttu-id="fb947-133">![Screen shot of the Alert rules part selected](./media/monitor-accounts/madocdb10.5.png)</span><span class="sxs-lookup"><span data-stu-id="fb947-133">![Screen shot of the Alert rules part selected](./media/monitor-accounts/madocdb10.5.png)</span></span>
3. <span data-ttu-id="fb947-134">In the **Alert rules** page, click **Add alert**.</span><span class="sxs-lookup"><span data-stu-id="fb947-134">In the **Alert rules** page, click **Add alert**.</span></span>  
   <span data-ttu-id="fb947-135">![Screenshot of the Alert Rules page, with the Add Alert button highlighted](./media/monitor-accounts/madocdb11.png)</span><span class="sxs-lookup"><span data-stu-id="fb947-135">![Screenshot of the Alert Rules page, with the Add Alert button highlighted](./media/monitor-accounts/madocdb11.png)</span></span>
4. <span data-ttu-id="fb947-136">In the **Add an alert rule** page, specify:</span><span class="sxs-lookup"><span data-stu-id="fb947-136">In the **Add an alert rule** page, specify:</span></span>
   
   * <span data-ttu-id="fb947-137">The name of the alert rule you are setting up.</span><span class="sxs-lookup"><span data-stu-id="fb947-137">The name of the alert rule you are setting up.</span></span>
   * <span data-ttu-id="fb947-138">A description of the new alert rule.</span><span class="sxs-lookup"><span data-stu-id="fb947-138">A description of the new alert rule.</span></span>
   * <span data-ttu-id="fb947-139">The metric for the alert rule.</span><span class="sxs-lookup"><span data-stu-id="fb947-139">The metric for the alert rule.</span></span>
   * <span data-ttu-id="fb947-140">The condition, threshold, and period that determine when the alert activates.</span><span class="sxs-lookup"><span data-stu-id="fb947-140">The condition, threshold, and period that determine when the alert activates.</span></span> <span data-ttu-id="fb947-141">For example, a server error count greater than 5 over the last 15 minutes.</span><span class="sxs-lookup"><span data-stu-id="fb947-141">For example, a server error count greater than 5 over the last 15 minutes.</span></span>
   * <span data-ttu-id="fb947-142">Whether the service administrator and coadministrators are emailed when the alert fires.</span><span class="sxs-lookup"><span data-stu-id="fb947-142">Whether the service administrator and coadministrators are emailed when the alert fires.</span></span>
   * <span data-ttu-id="fb947-143">Additional email addresses for alert notifications.</span><span class="sxs-lookup"><span data-stu-id="fb947-143">Additional email addresses for alert notifications.</span></span>  
     ![Screen shot of the Add an alert rule page](./media/monitor-accounts/madocdb12.png)

## <a name="monitor-azure-cosmos-db-programmatically"></a><span data-ttu-id="fb947-145">Monitor Azure Cosmos DB programmatically</span><span class="sxs-lookup"><span data-stu-id="fb947-145">Monitor Azure Cosmos DB programmatically</span></span>
<span data-ttu-id="fb947-146">The account level metrics available in the portal, such as account storage usage and total requests, are not available via the SQL APIs.</span><span class="sxs-lookup"><span data-stu-id="fb947-146">The account level metrics available in the portal, such as account storage usage and total requests, are not available via the SQL APIs.</span></span> <span data-ttu-id="fb947-147">However, you can retrieve usage data at the collection level by using the SQL APIs.</span><span class="sxs-lookup"><span data-stu-id="fb947-147">However, you can retrieve usage data at the collection level by using the SQL APIs.</span></span> <span data-ttu-id="fb947-148">To retrieve collection level data, do the following:</span><span class="sxs-lookup"><span data-stu-id="fb947-148">To retrieve collection level data, do the following:</span></span>

* <span data-ttu-id="fb947-149">To use the REST API, [perform a GET on the collection](https://msdn.microsoft.com/library/mt489073.aspx).</span><span class="sxs-lookup"><span data-stu-id="fb947-149">To use the REST API, [perform a GET on the collection](https://msdn.microsoft.com/library/mt489073.aspx).</span></span> <span data-ttu-id="fb947-150">The quota and usage information for the collection is returned in the x-ms-resource-quota and x-ms-resource-usage headers in the response.</span><span class="sxs-lookup"><span data-stu-id="fb947-150">The quota and usage information for the collection is returned in the x-ms-resource-quota and x-ms-resource-usage headers in the response.</span></span>
* <span data-ttu-id="fb947-151">To use the .NET SDK, use the [DocumentClient.ReadDocumentCollectionAsync](https://msdn.microsoft.com/library/microsoft.azure.documents.client.documentclient.readdocumentcollectionasync.aspx) method, which returns a [ResourceResponse](https://msdn.microsoft.com/library/dn799209.aspx) that contains a number of usage properties such as **CollectionSizeUsage**, **DatabaseUsage**, **DocumentUsage**, and more.</span><span class="sxs-lookup"><span data-stu-id="fb947-151">To use the .NET SDK, use the [DocumentClient.ReadDocumentCollectionAsync](https://msdn.microsoft.com/library/microsoft.azure.documents.client.documentclient.readdocumentcollectionasync.aspx) method, which returns a [ResourceResponse](https://msdn.microsoft.com/library/dn799209.aspx) that contains a number of usage properties such as **CollectionSizeUsage**, **DatabaseUsage**, **DocumentUsage**, and more.</span></span>

<span data-ttu-id="fb947-152">To access additional metrics, use the [Azure Monitor SDK](https://www.nuget.org/packages/Microsoft.Azure.Insights).</span><span class="sxs-lookup"><span data-stu-id="fb947-152">To access additional metrics, use the [Azure Monitor SDK](https://www.nuget.org/packages/Microsoft.Azure.Insights).</span></span> <span data-ttu-id="fb947-153">Available metric definitions can be retrieved by calling:</span><span class="sxs-lookup"><span data-stu-id="fb947-153">Available metric definitions can be retrieved by calling:</span></span>

    https://management.azure.com/subscriptions/{SubscriptionId}/resourceGroups/{ResourceGroup}/providers/Microsoft.DocumentDb/databaseAccounts/{DocumentDBAccountName}/metricDefinitions?api-version=2015-04-08

<span data-ttu-id="fb947-154">Queries to retrieve individual metrics use the following format:</span><span class="sxs-lookup"><span data-stu-id="fb947-154">Queries to retrieve individual metrics use the following format:</span></span>

    https://management.azure.com/subscriptions/{SubecriptionId}/resourceGroups/{ResourceGroup}/providers/Microsoft.DocumentDb/databaseAccounts/{DocumentDBAccountName}/metrics?api-version=2015-04-08&$filter=%28name.value%20eq%20%27Total%20Requests%27%29%20and%20timeGrain%20eq%20duration%27PT5M%27%20and%20startTime%20eq%202016-06-03T03%3A26%3A00.0000000Z%20and%20endTime%20eq%202016-06-10T03%3A26%3A00.0000000Z

<span data-ttu-id="fb947-155">For more information, see [Retrieving Resource Metrics via the Azure Monitor REST API](https://blogs.msdn.microsoft.com/cloud_solution_architect/2016/02/23/retrieving-resource-metrics-via-the-azure-insights-api/).</span><span class="sxs-lookup"><span data-stu-id="fb947-155">For more information, see [Retrieving Resource Metrics via the Azure Monitor REST API](https://blogs.msdn.microsoft.com/cloud_solution_architect/2016/02/23/retrieving-resource-metrics-via-the-azure-insights-api/).</span></span> <span data-ttu-id="fb947-156">Note that "Azure Insights" was renamed "Azure Monitor".</span><span class="sxs-lookup"><span data-stu-id="fb947-156">Note that "Azure Insights" was renamed "Azure Monitor".</span></span>  <span data-ttu-id="fb947-157">This blog entry refers to the older name.</span><span class="sxs-lookup"><span data-stu-id="fb947-157">This blog entry refers to the older name.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fb947-158">Next steps</span><span class="sxs-lookup"><span data-stu-id="fb947-158">Next steps</span></span>
<span data-ttu-id="fb947-159">To learn more about Azure Cosmos DB capacity planning, see the [Azure Cosmos DB capacity planner calculator](https://www.documentdb.com/capacityplanner).</span><span class="sxs-lookup"><span data-stu-id="fb947-159">To learn more about Azure Cosmos DB capacity planning, see the [Azure Cosmos DB capacity planner calculator](https://www.documentdb.com/capacityplanner).</span></span>

