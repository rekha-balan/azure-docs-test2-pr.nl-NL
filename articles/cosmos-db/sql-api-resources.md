---
title: Azure Cosmos DB resource model and concepts | Microsoft Docs
description: Learn about Azure Cosmos DB’s hierarchical model of databases, collections, user defined function (UDF), documents, permissions to manage resources, and more.
keywords: Hierarchical model, cosmosdb, azure, Microsoft azure
services: cosmos-db
author: rafats
manager: kfile
ms.service: cosmos-db
ms.component: cosmosdb-sql
ms.devlang: na
ms.topic: conceptual
ms.date: 05/07/2018
ms.author: rafats
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 0869881ace689d12272affb38d3689965e107e8f
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44866555"
---
# <a name="azure-cosmos-db-hierarchical-resource-model-and-core-concepts"></a><span data-ttu-id="6ec83-104">Azure Cosmos DB hierarchical resource model and core concepts</span><span class="sxs-lookup"><span data-stu-id="6ec83-104">Azure Cosmos DB hierarchical resource model and core concepts</span></span>

<span data-ttu-id="6ec83-105">The database entities that Azure Cosmos DB manages are referred to as **resources**.</span><span class="sxs-lookup"><span data-stu-id="6ec83-105">The database entities that Azure Cosmos DB manages are referred to as **resources**.</span></span> <span data-ttu-id="6ec83-106">Each resource is uniquely identified by a logical URI.</span><span class="sxs-lookup"><span data-stu-id="6ec83-106">Each resource is uniquely identified by a logical URI.</span></span> <span data-ttu-id="6ec83-107">You can interact with the resources using standard HTTP verbs, request/response headers, and status codes.</span><span class="sxs-lookup"><span data-stu-id="6ec83-107">You can interact with the resources using standard HTTP verbs, request/response headers, and status codes.</span></span> 

<span data-ttu-id="6ec83-108">This article answers the following questions:</span><span class="sxs-lookup"><span data-stu-id="6ec83-108">This article answers the following questions:</span></span>

* <span data-ttu-id="6ec83-109">What is Azure Cosmos DB's resource model?</span><span class="sxs-lookup"><span data-stu-id="6ec83-109">What is Azure Cosmos DB's resource model?</span></span>
* <span data-ttu-id="6ec83-110">What are system defined resources as opposed to user-defined resources?</span><span class="sxs-lookup"><span data-stu-id="6ec83-110">What are system defined resources as opposed to user-defined resources?</span></span>
* <span data-ttu-id="6ec83-111">How do I address a resource?</span><span class="sxs-lookup"><span data-stu-id="6ec83-111">How do I address a resource?</span></span>
* <span data-ttu-id="6ec83-112">How do I work with collections?</span><span class="sxs-lookup"><span data-stu-id="6ec83-112">How do I work with collections?</span></span>
* <span data-ttu-id="6ec83-113">How do I work with stored procedures, triggers and User-Defined Functions (UDFs)?</span><span class="sxs-lookup"><span data-stu-id="6ec83-113">How do I work with stored procedures, triggers and User-Defined Functions (UDFs)?</span></span>

## <a name="hierarchical-resource-model"></a><span data-ttu-id="6ec83-114">Hierarchical resource model</span><span class="sxs-lookup"><span data-stu-id="6ec83-114">Hierarchical resource model</span></span>
<span data-ttu-id="6ec83-115">As the following diagram illustrates, the Azure Cosmos DB hierarchical **resource model** consists of sets of resources under a database account, each addressable via a logical and stable URI.</span><span class="sxs-lookup"><span data-stu-id="6ec83-115">As the following diagram illustrates, the Azure Cosmos DB hierarchical **resource model** consists of sets of resources under a database account, each addressable via a logical and stable URI.</span></span> <span data-ttu-id="6ec83-116">A set of resources are referred to as a **feed** in this article.</span><span class="sxs-lookup"><span data-stu-id="6ec83-116">A set of resources are referred to as a **feed** in this article.</span></span> 

> [!NOTE]
> <span data-ttu-id="6ec83-117">Azure Cosmos DB offers a highly efficient TCP protocol, which is also RESTful in its communication model, available through the [SQL .NET client API](sql-api-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-117">Azure Cosmos DB offers a highly efficient TCP protocol, which is also RESTful in its communication model, available through the [SQL .NET client API](sql-api-sdk-dotnet.md).</span></span>
> 
> 

<span data-ttu-id="6ec83-118">![Azure Cosmos DB hierarchical resource model][1]</span><span class="sxs-lookup"><span data-stu-id="6ec83-118">![Azure Cosmos DB hierarchical resource model][1]</span></span>  
<span data-ttu-id="6ec83-119">**Hierarchical resource model**</span><span class="sxs-lookup"><span data-stu-id="6ec83-119">**Hierarchical resource model**</span></span>   

<span data-ttu-id="6ec83-120">To start working with resources, you must [create a database account](create-sql-api-dotnet.md) using your Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="6ec83-120">To start working with resources, you must [create a database account](create-sql-api-dotnet.md) using your Azure subscription.</span></span> <span data-ttu-id="6ec83-121">A database account can consist of a set of **databases**, each containing multiple **collections**, each of which in turn contain **stored procedures, triggers, UDFs, documents, and related attachments**.</span><span class="sxs-lookup"><span data-stu-id="6ec83-121">A database account can consist of a set of **databases**, each containing multiple **collections**, each of which in turn contain **stored procedures, triggers, UDFs, documents, and related attachments**.</span></span> <span data-ttu-id="6ec83-122">A database also has associated **users**, each with a set of **permissions** to access collections, stored procedures, triggers, UDFs, documents, or attachments.</span><span class="sxs-lookup"><span data-stu-id="6ec83-122">A database also has associated **users**, each with a set of **permissions** to access collections, stored procedures, triggers, UDFs, documents, or attachments.</span></span> <span data-ttu-id="6ec83-123">While databases, users, permissions, and collections are system-defined resources with well-known schemas, documents, and attachments contain arbitrary, user-defined JSON content.</span><span class="sxs-lookup"><span data-stu-id="6ec83-123">While databases, users, permissions, and collections are system-defined resources with well-known schemas, documents, and attachments contain arbitrary, user-defined JSON content.</span></span>  

| <span data-ttu-id="6ec83-124">Resource</span><span class="sxs-lookup"><span data-stu-id="6ec83-124">Resource</span></span> | <span data-ttu-id="6ec83-125">Description</span><span class="sxs-lookup"><span data-stu-id="6ec83-125">Description</span></span> |
| --- | --- |
| <span data-ttu-id="6ec83-126">Database account</span><span class="sxs-lookup"><span data-stu-id="6ec83-126">Database account</span></span> |<span data-ttu-id="6ec83-127">A database account is associated with a set of databases and a fixed amount of blob storage for attachments.</span><span class="sxs-lookup"><span data-stu-id="6ec83-127">A database account is associated with a set of databases and a fixed amount of blob storage for attachments.</span></span> <span data-ttu-id="6ec83-128">You can create one or more database accounts using your Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="6ec83-128">You can create one or more database accounts using your Azure subscription.</span></span> <span data-ttu-id="6ec83-129">For more information, visit the [pricing page](https://azure.microsoft.com/pricing/details/cosmos-db/).</span><span class="sxs-lookup"><span data-stu-id="6ec83-129">For more information, visit the [pricing page](https://azure.microsoft.com/pricing/details/cosmos-db/).</span></span> |
| <span data-ttu-id="6ec83-130">Database</span><span class="sxs-lookup"><span data-stu-id="6ec83-130">Database</span></span> |<span data-ttu-id="6ec83-131">A database is a logical container of document storage partitioned across collections.</span><span class="sxs-lookup"><span data-stu-id="6ec83-131">A database is a logical container of document storage partitioned across collections.</span></span> <span data-ttu-id="6ec83-132">It is also a users container.</span><span class="sxs-lookup"><span data-stu-id="6ec83-132">It is also a users container.</span></span> |
| <span data-ttu-id="6ec83-133">User</span><span class="sxs-lookup"><span data-stu-id="6ec83-133">User</span></span> |<span data-ttu-id="6ec83-134">The logical namespace for scoping permissions.</span><span class="sxs-lookup"><span data-stu-id="6ec83-134">The logical namespace for scoping permissions.</span></span> |
| <span data-ttu-id="6ec83-135">Permission</span><span class="sxs-lookup"><span data-stu-id="6ec83-135">Permission</span></span> |<span data-ttu-id="6ec83-136">An authorization token associated with a user for access to a specific resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-136">An authorization token associated with a user for access to a specific resource.</span></span> |
| <span data-ttu-id="6ec83-137">Collection</span><span class="sxs-lookup"><span data-stu-id="6ec83-137">Collection</span></span> |<span data-ttu-id="6ec83-138">A collection is a container of JSON documents and the associated JavaScript application logic.</span><span class="sxs-lookup"><span data-stu-id="6ec83-138">A collection is a container of JSON documents and the associated JavaScript application logic.</span></span> <span data-ttu-id="6ec83-139">Collections can span one or more partitions/servers and can scale to handle practically unlimited volumes of storage or throughput.</span><span class="sxs-lookup"><span data-stu-id="6ec83-139">Collections can span one or more partitions/servers and can scale to handle practically unlimited volumes of storage or throughput.</span></span> |
| <span data-ttu-id="6ec83-140">Stored Procedure</span><span class="sxs-lookup"><span data-stu-id="6ec83-140">Stored Procedure</span></span> |<span data-ttu-id="6ec83-141">Application logic written in JavaScript, which is registered with a collection and transactionally executed within the database engine.</span><span class="sxs-lookup"><span data-stu-id="6ec83-141">Application logic written in JavaScript, which is registered with a collection and transactionally executed within the database engine.</span></span> |
| <span data-ttu-id="6ec83-142">Trigger</span><span class="sxs-lookup"><span data-stu-id="6ec83-142">Trigger</span></span> |<span data-ttu-id="6ec83-143">Application logic written in JavaScript executed before or after either an insert, replace, or delete operation.</span><span class="sxs-lookup"><span data-stu-id="6ec83-143">Application logic written in JavaScript executed before or after either an insert, replace, or delete operation.</span></span> |
| <span data-ttu-id="6ec83-144">UDF</span><span class="sxs-lookup"><span data-stu-id="6ec83-144">UDF</span></span> |<span data-ttu-id="6ec83-145">Application logic written in JavaScript.</span><span class="sxs-lookup"><span data-stu-id="6ec83-145">Application logic written in JavaScript.</span></span> <span data-ttu-id="6ec83-146">UDFs enable you to model a custom query operator and thereby extend the core SQL API query language.</span><span class="sxs-lookup"><span data-stu-id="6ec83-146">UDFs enable you to model a custom query operator and thereby extend the core SQL API query language.</span></span> |
| <span data-ttu-id="6ec83-147">Document</span><span class="sxs-lookup"><span data-stu-id="6ec83-147">Document</span></span> |<span data-ttu-id="6ec83-148">User defined (arbitrary) JSON content.</span><span class="sxs-lookup"><span data-stu-id="6ec83-148">User defined (arbitrary) JSON content.</span></span> <span data-ttu-id="6ec83-149">By default, no schema needs to be defined nor do secondary indices need to be provided for all the documents added to a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-149">By default, no schema needs to be defined nor do secondary indices need to be provided for all the documents added to a collection.</span></span> |
| <span data-ttu-id="6ec83-150">Attachment</span><span class="sxs-lookup"><span data-stu-id="6ec83-150">Attachment</span></span> |<span data-ttu-id="6ec83-151">An attachment is a special document containing references and associated metadata for external blob/media.</span><span class="sxs-lookup"><span data-stu-id="6ec83-151">An attachment is a special document containing references and associated metadata for external blob/media.</span></span> <span data-ttu-id="6ec83-152">The developer can choose to have the blob managed by Cosmos DB or store it with an external blob service provider such as OneDrive, Dropbox, etc.</span><span class="sxs-lookup"><span data-stu-id="6ec83-152">The developer can choose to have the blob managed by Cosmos DB or store it with an external blob service provider such as OneDrive, Dropbox, etc.</span></span> |

## <a name="system-vs-user-defined-resources"></a><span data-ttu-id="6ec83-153">System vs. user-defined resources</span><span class="sxs-lookup"><span data-stu-id="6ec83-153">System vs. user-defined resources</span></span>
<span data-ttu-id="6ec83-154">Resources such as database accounts, databases, collections, users, permissions, stored procedures, triggers, and UDFs - all have a fixed schema and are called system resources.</span><span class="sxs-lookup"><span data-stu-id="6ec83-154">Resources such as database accounts, databases, collections, users, permissions, stored procedures, triggers, and UDFs - all have a fixed schema and are called system resources.</span></span> <span data-ttu-id="6ec83-155">In contrast, resources such as documents and attachments have no restrictions on the schema and are examples of user-defined resources.</span><span class="sxs-lookup"><span data-stu-id="6ec83-155">In contrast, resources such as documents and attachments have no restrictions on the schema and are examples of user-defined resources.</span></span> <span data-ttu-id="6ec83-156">In Cosmos DB, both system and user-defined resources are represented and managed as standard-compliant JSON.</span><span class="sxs-lookup"><span data-stu-id="6ec83-156">In Cosmos DB, both system and user-defined resources are represented and managed as standard-compliant JSON.</span></span> <span data-ttu-id="6ec83-157">All resources, system, or user defined, have the following common properties:</span><span class="sxs-lookup"><span data-stu-id="6ec83-157">All resources, system, or user defined, have the following common properties:</span></span>

> [!NOTE]
> <span data-ttu-id="6ec83-158">All system generated properties in a resource are prefixed with an underscore (_) in their JSON representation.</span><span class="sxs-lookup"><span data-stu-id="6ec83-158">All system generated properties in a resource are prefixed with an underscore (_) in their JSON representation.</span></span>
> 
> 

<table>
    <tbody>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-159"><strong>Property</strong></span><span class="sxs-lookup"><span data-stu-id="6ec83-159"><strong>Property</strong></span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-160"><strong>User settable or system generated?</strong></span><span class="sxs-lookup"><span data-stu-id="6ec83-160"><strong>User settable or system generated?</strong></span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-161"><strong>Purpose</strong></span><span class="sxs-lookup"><span data-stu-id="6ec83-161"><strong>Purpose</strong></span></span></p></td>
        </tr>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-162">_rid</span><span class="sxs-lookup"><span data-stu-id="6ec83-162">_rid</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-163">System generated</span><span class="sxs-lookup"><span data-stu-id="6ec83-163">System generated</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-164">System generated, unique, and hierarchical identifier of the resource</span><span class="sxs-lookup"><span data-stu-id="6ec83-164">System generated, unique, and hierarchical identifier of the resource</span></span></p></td>
        </tr>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-165">_etag</span><span class="sxs-lookup"><span data-stu-id="6ec83-165">_etag</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-166">System generated</span><span class="sxs-lookup"><span data-stu-id="6ec83-166">System generated</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-167">etag of the resource required for optimistic concurrency control</span><span class="sxs-lookup"><span data-stu-id="6ec83-167">etag of the resource required for optimistic concurrency control</span></span></p></td>
        </tr>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-168">_ts</span><span class="sxs-lookup"><span data-stu-id="6ec83-168">_ts</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-169">System generated</span><span class="sxs-lookup"><span data-stu-id="6ec83-169">System generated</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-170">Last updated timestamp of the resource</span><span class="sxs-lookup"><span data-stu-id="6ec83-170">Last updated timestamp of the resource</span></span></p></td>
        </tr>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-171">_self</span><span class="sxs-lookup"><span data-stu-id="6ec83-171">_self</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-172">System generated</span><span class="sxs-lookup"><span data-stu-id="6ec83-172">System generated</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-173">Unique addressable URI of the resource</span><span class="sxs-lookup"><span data-stu-id="6ec83-173">Unique addressable URI of the resource</span></span></p></td>
        </tr>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-174">id</span><span class="sxs-lookup"><span data-stu-id="6ec83-174">id</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-175">Either</span><span class="sxs-lookup"><span data-stu-id="6ec83-175">Either</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-176">User-defined unique name of the resource (with the same partition key value).</span><span class="sxs-lookup"><span data-stu-id="6ec83-176">User-defined unique name of the resource (with the same partition key value).</span></span> <span data-ttu-id="6ec83-177">If the user does not specify an id, an id is system generated</span><span class="sxs-lookup"><span data-stu-id="6ec83-177">If the user does not specify an id, an id is system generated</span></span></p></td>
        </tr>
    </tbody>
</table>

### <a name="wire-representation-of-resources"></a><span data-ttu-id="6ec83-178">Wire representation of resources</span><span class="sxs-lookup"><span data-stu-id="6ec83-178">Wire representation of resources</span></span>
<span data-ttu-id="6ec83-179">Cosmos DB does not mandate any proprietary extensions to the JSON standard or special encodings; it works with standard compliant JSON documents.</span><span class="sxs-lookup"><span data-stu-id="6ec83-179">Cosmos DB does not mandate any proprietary extensions to the JSON standard or special encodings; it works with standard compliant JSON documents.</span></span>  

### <a name="addressing-a-resource"></a><span data-ttu-id="6ec83-180">Addressing a resource</span><span class="sxs-lookup"><span data-stu-id="6ec83-180">Addressing a resource</span></span>
<span data-ttu-id="6ec83-181">All resources are URI addressable.</span><span class="sxs-lookup"><span data-stu-id="6ec83-181">All resources are URI addressable.</span></span> <span data-ttu-id="6ec83-182">The value of the **_self** property of a resource represents the relative URI of the resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-182">The value of the **_self** property of a resource represents the relative URI of the resource.</span></span> <span data-ttu-id="6ec83-183">The format of the URI consists of the /\<feed\>/{_rid} path segments:</span><span class="sxs-lookup"><span data-stu-id="6ec83-183">The format of the URI consists of the /\<feed\>/{_rid} path segments:</span></span>  

| <span data-ttu-id="6ec83-184">Value of the _self</span><span class="sxs-lookup"><span data-stu-id="6ec83-184">Value of the _self</span></span> | <span data-ttu-id="6ec83-185">Description</span><span class="sxs-lookup"><span data-stu-id="6ec83-185">Description</span></span> |
| --- | --- |
| <span data-ttu-id="6ec83-186">/dbs</span><span class="sxs-lookup"><span data-stu-id="6ec83-186">/dbs</span></span> |<span data-ttu-id="6ec83-187">Feed of databases under a database account</span><span class="sxs-lookup"><span data-stu-id="6ec83-187">Feed of databases under a database account</span></span> |
| <span data-ttu-id="6ec83-188">/dbs/{dbName}</span><span class="sxs-lookup"><span data-stu-id="6ec83-188">/dbs/{dbName}</span></span> |<span data-ttu-id="6ec83-189">Database with an id matching the value {dbName}</span><span class="sxs-lookup"><span data-stu-id="6ec83-189">Database with an id matching the value {dbName}</span></span> |
| <span data-ttu-id="6ec83-190">/dbs/{dbName}/colls/</span><span class="sxs-lookup"><span data-stu-id="6ec83-190">/dbs/{dbName}/colls/</span></span> |<span data-ttu-id="6ec83-191">Feed of collections under a database</span><span class="sxs-lookup"><span data-stu-id="6ec83-191">Feed of collections under a database</span></span> |
| <span data-ttu-id="6ec83-192">/dbs/{dbName}/colls/{collName}</span><span class="sxs-lookup"><span data-stu-id="6ec83-192">/dbs/{dbName}/colls/{collName}</span></span> |<span data-ttu-id="6ec83-193">Collection with an id matching the value {collName}</span><span class="sxs-lookup"><span data-stu-id="6ec83-193">Collection with an id matching the value {collName}</span></span> |
| <span data-ttu-id="6ec83-194">/dbs/{dbName}/colls/{collName}/docs</span><span class="sxs-lookup"><span data-stu-id="6ec83-194">/dbs/{dbName}/colls/{collName}/docs</span></span> |<span data-ttu-id="6ec83-195">Feed of documents under a collection</span><span class="sxs-lookup"><span data-stu-id="6ec83-195">Feed of documents under a collection</span></span> |
| <span data-ttu-id="6ec83-196">/dbs/{dbName}/colls/{collName}/docs/{docId}</span><span class="sxs-lookup"><span data-stu-id="6ec83-196">/dbs/{dbName}/colls/{collName}/docs/{docId}</span></span> |<span data-ttu-id="6ec83-197">Document with an id matching the value {doc}</span><span class="sxs-lookup"><span data-stu-id="6ec83-197">Document with an id matching the value {doc}</span></span> |
| <span data-ttu-id="6ec83-198">/dbs/{dbName}/users/</span><span class="sxs-lookup"><span data-stu-id="6ec83-198">/dbs/{dbName}/users/</span></span> |<span data-ttu-id="6ec83-199">Feed of users under a database</span><span class="sxs-lookup"><span data-stu-id="6ec83-199">Feed of users under a database</span></span> |
| <span data-ttu-id="6ec83-200">/dbs/{dbName}/users/{userId}</span><span class="sxs-lookup"><span data-stu-id="6ec83-200">/dbs/{dbName}/users/{userId}</span></span> |<span data-ttu-id="6ec83-201">User with an id matching the value {user}</span><span class="sxs-lookup"><span data-stu-id="6ec83-201">User with an id matching the value {user}</span></span> |
| <span data-ttu-id="6ec83-202">/dbs/{dbName}/users/{userId}/permissions</span><span class="sxs-lookup"><span data-stu-id="6ec83-202">/dbs/{dbName}/users/{userId}/permissions</span></span> |<span data-ttu-id="6ec83-203">Feed of permissions under a user</span><span class="sxs-lookup"><span data-stu-id="6ec83-203">Feed of permissions under a user</span></span> |
| <span data-ttu-id="6ec83-204">/dbs/{dbName}/users/{userId}/permissions/{permissionId}</span><span class="sxs-lookup"><span data-stu-id="6ec83-204">/dbs/{dbName}/users/{userId}/permissions/{permissionId}</span></span> |<span data-ttu-id="6ec83-205">Permission with an id matching the value {permission}</span><span class="sxs-lookup"><span data-stu-id="6ec83-205">Permission with an id matching the value {permission}</span></span> |

<span data-ttu-id="6ec83-206">Each resource has a unique user-defined name exposed via the id property.</span><span class="sxs-lookup"><span data-stu-id="6ec83-206">Each resource has a unique user-defined name exposed via the id property.</span></span> <span data-ttu-id="6ec83-207">Note: for documents, if the user does not specify an id, the SDKs automatically generate a unique id for the document.</span><span class="sxs-lookup"><span data-stu-id="6ec83-207">Note: for documents, if the user does not specify an id, the SDKs automatically generate a unique id for the document.</span></span> <span data-ttu-id="6ec83-208">The id is a user-defined string, of up to 256 characters that is unique within the context of a specific parent resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-208">The id is a user-defined string, of up to 256 characters that is unique within the context of a specific parent resource.</span></span> 

<span data-ttu-id="6ec83-209">Each resource also has a system generated hierarchical resource identifier (also referred to as an RID), which is available via the _rid property.</span><span class="sxs-lookup"><span data-stu-id="6ec83-209">Each resource also has a system generated hierarchical resource identifier (also referred to as an RID), which is available via the _rid property.</span></span> <span data-ttu-id="6ec83-210">The RID encodes the entire hierarchy of a given resource and it is a convenient internal representation used to enforce referential integrity in a distributed manner.</span><span class="sxs-lookup"><span data-stu-id="6ec83-210">The RID encodes the entire hierarchy of a given resource and it is a convenient internal representation used to enforce referential integrity in a distributed manner.</span></span> <span data-ttu-id="6ec83-211">The RID is unique within a database account and it is internally used by Cosmos DB for efficient routing without requiring cross partition lookups.</span><span class="sxs-lookup"><span data-stu-id="6ec83-211">The RID is unique within a database account and it is internally used by Cosmos DB for efficient routing without requiring cross partition lookups.</span></span> <span data-ttu-id="6ec83-212">The values of the _self and the  _rid properties are both alternate and canonical representations of a resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-212">The values of the _self and the  _rid properties are both alternate and canonical representations of a resource.</span></span> 

<span data-ttu-id="6ec83-213">The REST APIs support addressing of resources and routing of requests by both the id and the _rid properties.</span><span class="sxs-lookup"><span data-stu-id="6ec83-213">The REST APIs support addressing of resources and routing of requests by both the id and the _rid properties.</span></span>

## <a name="database-accounts"></a><span data-ttu-id="6ec83-214">Database accounts</span><span class="sxs-lookup"><span data-stu-id="6ec83-214">Database accounts</span></span>
<span data-ttu-id="6ec83-215">You can provision one or more Cosmos DB database accounts using your Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="6ec83-215">You can provision one or more Cosmos DB database accounts using your Azure subscription.</span></span>

<span data-ttu-id="6ec83-216">You can create and manage Cosmos DB database accounts via the Azure portal at [http://portal.azure.com/](https://portal.azure.com/).</span><span class="sxs-lookup"><span data-stu-id="6ec83-216">You can create and manage Cosmos DB database accounts via the Azure portal at [http://portal.azure.com/](https://portal.azure.com/).</span></span> <span data-ttu-id="6ec83-217">Creating and managing a database account requires administrative access and can only be performed under your Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="6ec83-217">Creating and managing a database account requires administrative access and can only be performed under your Azure subscription.</span></span> 

### <a name="database-account-properties"></a><span data-ttu-id="6ec83-218">Database account properties</span><span class="sxs-lookup"><span data-stu-id="6ec83-218">Database account properties</span></span>
<span data-ttu-id="6ec83-219">As part of provisioning and managing a database account you can configure and read the following properties:</span><span class="sxs-lookup"><span data-stu-id="6ec83-219">As part of provisioning and managing a database account you can configure and read the following properties:</span></span>  

<table border="0" cellspacing="0" cellpadding="0">
    <tbody>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-220"><strong>Property Name</strong></span><span class="sxs-lookup"><span data-stu-id="6ec83-220"><strong>Property Name</strong></span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-221"><strong>Description</strong></span><span class="sxs-lookup"><span data-stu-id="6ec83-221"><strong>Description</strong></span></span></p></td>
        </tr>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-222">Consistency Policy</span><span class="sxs-lookup"><span data-stu-id="6ec83-222">Consistency Policy</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-223">Set this property to configure the default consistency level for all the collections under your database account.</span><span class="sxs-lookup"><span data-stu-id="6ec83-223">Set this property to configure the default consistency level for all the collections under your database account.</span></span> <span data-ttu-id="6ec83-224">You can override the consistency level on a per request basis using the [x-ms-consistency-level] request header.</span><span class="sxs-lookup"><span data-stu-id="6ec83-224">You can override the consistency level on a per request basis using the [x-ms-consistency-level] request header.</span></span> <p><p><span data-ttu-id="6ec83-225">This property only applies to the <i>user-defined resources</i>.</span><span class="sxs-lookup"><span data-stu-id="6ec83-225">This property only applies to the <i>user-defined resources</i>.</span></span> <span data-ttu-id="6ec83-226">All system defined resources are configured to support reads/queries with strong consistency.</span><span class="sxs-lookup"><span data-stu-id="6ec83-226">All system defined resources are configured to support reads/queries with strong consistency.</span></span></p></td>
        </tr>
        <tr>
            <td valign="top"><p><span data-ttu-id="6ec83-227">Authorization Keys</span><span class="sxs-lookup"><span data-stu-id="6ec83-227">Authorization Keys</span></span></p></td>
            <td valign="top"><p><span data-ttu-id="6ec83-228">The primary and secondary master and readonly keys that provide administrative access to all of the resources under the database account.</span><span class="sxs-lookup"><span data-stu-id="6ec83-228">The primary and secondary master and readonly keys that provide administrative access to all of the resources under the database account.</span></span></p></td>
        </tr>
    </tbody>
</table>

<span data-ttu-id="6ec83-229">In addition to provisioning, configuring and managing your database account from the Azure portal, you can also programmatically create and manage Cosmos DB database accounts by using the [Azure Cosmos DB REST APIs](/rest/api/cosmos-db/) as well as [client SDKs](sql-api-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-229">In addition to provisioning, configuring and managing your database account from the Azure portal, you can also programmatically create and manage Cosmos DB database accounts by using the [Azure Cosmos DB REST APIs](/rest/api/cosmos-db/) as well as [client SDKs](sql-api-sdk-dotnet.md).</span></span>  

## <a name="databases"></a><span data-ttu-id="6ec83-230">Databases</span><span class="sxs-lookup"><span data-stu-id="6ec83-230">Databases</span></span>
<span data-ttu-id="6ec83-231">A Cosmos DB database is a logical container of one or more collections and users, as shown in the following diagram.</span><span class="sxs-lookup"><span data-stu-id="6ec83-231">A Cosmos DB database is a logical container of one or more collections and users, as shown in the following diagram.</span></span> <span data-ttu-id="6ec83-232">You can create any number of databases under a Cosmos DB database account subject to offer limits.</span><span class="sxs-lookup"><span data-stu-id="6ec83-232">You can create any number of databases under a Cosmos DB database account subject to offer limits.</span></span>  

<span data-ttu-id="6ec83-233">![Database account and collections hierarchical model][2]</span><span class="sxs-lookup"><span data-stu-id="6ec83-233">![Database account and collections hierarchical model][2]</span></span>  
<span data-ttu-id="6ec83-234">**A Database is a logical container of users and collections**</span><span class="sxs-lookup"><span data-stu-id="6ec83-234">**A Database is a logical container of users and collections**</span></span>

<span data-ttu-id="6ec83-235">A database can contain unlimited document storage partitioned within collections.</span><span class="sxs-lookup"><span data-stu-id="6ec83-235">A database can contain unlimited document storage partitioned within collections.</span></span>

### <a name="elastic-scale-of-an-azure-cosmos-db-database"></a><span data-ttu-id="6ec83-236">Elastic scale of an Azure Cosmos DB database</span><span class="sxs-lookup"><span data-stu-id="6ec83-236">Elastic scale of an Azure Cosmos DB database</span></span>
<span data-ttu-id="6ec83-237">A Cosmos DB database is elastic by default – ranging from a few GB to petabytes of SSD backed document storage and provisioned throughput.</span><span class="sxs-lookup"><span data-stu-id="6ec83-237">A Cosmos DB database is elastic by default – ranging from a few GB to petabytes of SSD backed document storage and provisioned throughput.</span></span> 

<span data-ttu-id="6ec83-238">Unlike a database in traditional RDBMS, a database in Cosmos DB is not scoped to a single machine.</span><span class="sxs-lookup"><span data-stu-id="6ec83-238">Unlike a database in traditional RDBMS, a database in Cosmos DB is not scoped to a single machine.</span></span> <span data-ttu-id="6ec83-239">With Cosmos DB, as your application’s scale needs to grow, you can create more collections, databases, or both.</span><span class="sxs-lookup"><span data-stu-id="6ec83-239">With Cosmos DB, as your application’s scale needs to grow, you can create more collections, databases, or both.</span></span> <span data-ttu-id="6ec83-240">Indeed, various first party applications within Microsoft have been using Azure Cosmos DB at a consumer scale by creating extremely large Azure Cosmos DB databases each containing thousands of collections with terabytes of document storage.</span><span class="sxs-lookup"><span data-stu-id="6ec83-240">Indeed, various first party applications within Microsoft have been using Azure Cosmos DB at a consumer scale by creating extremely large Azure Cosmos DB databases each containing thousands of collections with terabytes of document storage.</span></span> <span data-ttu-id="6ec83-241">You can grow or shrink a database by adding or removing collections to meet your application’s scale requirements.</span><span class="sxs-lookup"><span data-stu-id="6ec83-241">You can grow or shrink a database by adding or removing collections to meet your application’s scale requirements.</span></span> 

<span data-ttu-id="6ec83-242">You can create any number of collections within a database subject to the offer.</span><span class="sxs-lookup"><span data-stu-id="6ec83-242">You can create any number of collections within a database subject to the offer.</span></span> <span data-ttu-id="6ec83-243">Each collection, or set of collections (within a database), has SSD backed storage and throughput provisioned for you depending on the selected offer.</span><span class="sxs-lookup"><span data-stu-id="6ec83-243">Each collection, or set of collections (within a database), has SSD backed storage and throughput provisioned for you depending on the selected offer.</span></span>

<span data-ttu-id="6ec83-244">An Azure Cosmos DB database is also a container of users.</span><span class="sxs-lookup"><span data-stu-id="6ec83-244">An Azure Cosmos DB database is also a container of users.</span></span> <span data-ttu-id="6ec83-245">A user, in-turn, is a logical namespace for a set of permissions that provides fine-grained authorization and access to collections, documents, and attachments.</span><span class="sxs-lookup"><span data-stu-id="6ec83-245">A user, in-turn, is a logical namespace for a set of permissions that provides fine-grained authorization and access to collections, documents, and attachments.</span></span>  

<span data-ttu-id="6ec83-246">As with other resources in the Azure Cosmos DB resource model, databases can be created, replaced, deleted, read, or enumerated easily using either the [REST APIs](/rest/api/cosmos-db/) or any of the [client SDKs](sql-api-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-246">As with other resources in the Azure Cosmos DB resource model, databases can be created, replaced, deleted, read, or enumerated easily using either the [REST APIs](/rest/api/cosmos-db/) or any of the [client SDKs](sql-api-sdk-dotnet.md).</span></span> <span data-ttu-id="6ec83-247">Azure Cosmos DB guarantees strong consistency for reading or querying the metadata of a database resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-247">Azure Cosmos DB guarantees strong consistency for reading or querying the metadata of a database resource.</span></span> <span data-ttu-id="6ec83-248">Deleting a database automatically ensures that you cannot access any of the collections or users contained within it.</span><span class="sxs-lookup"><span data-stu-id="6ec83-248">Deleting a database automatically ensures that you cannot access any of the collections or users contained within it.</span></span>   

## <a name="collections"></a><span data-ttu-id="6ec83-249">Collections</span><span class="sxs-lookup"><span data-stu-id="6ec83-249">Collections</span></span>
<span data-ttu-id="6ec83-250">A Cosmos DB collection is a container for your JSON documents.</span><span class="sxs-lookup"><span data-stu-id="6ec83-250">A Cosmos DB collection is a container for your JSON documents.</span></span> 

### <a name="elastic-ssd-backed-document-storage"></a><span data-ttu-id="6ec83-251">Elastic SSD backed document storage</span><span class="sxs-lookup"><span data-stu-id="6ec83-251">Elastic SSD backed document storage</span></span>
<span data-ttu-id="6ec83-252">A collection is intrinsically elastic - it automatically grows and shrinks as you add or remove documents.</span><span class="sxs-lookup"><span data-stu-id="6ec83-252">A collection is intrinsically elastic - it automatically grows and shrinks as you add or remove documents.</span></span> <span data-ttu-id="6ec83-253">Collections are logical resources and can span one or more physical partitions or servers.</span><span class="sxs-lookup"><span data-stu-id="6ec83-253">Collections are logical resources and can span one or more physical partitions or servers.</span></span> <span data-ttu-id="6ec83-254">The number of partitions assigned to a collection is determined by Cosmos DB based on the storage size and the throughput provisioned for the collection or a set of collections.</span><span class="sxs-lookup"><span data-stu-id="6ec83-254">The number of partitions assigned to a collection is determined by Cosmos DB based on the storage size and the throughput provisioned for the collection or a set of collections.</span></span> <span data-ttu-id="6ec83-255">Every partition in Cosmos DB has a fixed amount of SSD-backed storage associated with it, and is replicated for high availability.</span><span class="sxs-lookup"><span data-stu-id="6ec83-255">Every partition in Cosmos DB has a fixed amount of SSD-backed storage associated with it, and is replicated for high availability.</span></span> <span data-ttu-id="6ec83-256">Partition management is fully managed by Azure Cosmos DB, and you do not have to write complex code or manage your partitions.</span><span class="sxs-lookup"><span data-stu-id="6ec83-256">Partition management is fully managed by Azure Cosmos DB, and you do not have to write complex code or manage your partitions.</span></span> <span data-ttu-id="6ec83-257">Cosmos DB collections are **unlimited** in terms of storage and throughput.</span><span class="sxs-lookup"><span data-stu-id="6ec83-257">Cosmos DB collections are **unlimited** in terms of storage and throughput.</span></span> 

### <a name="automatic-indexing-of-collections"></a><span data-ttu-id="6ec83-258">Automatic indexing of collections</span><span class="sxs-lookup"><span data-stu-id="6ec83-258">Automatic indexing of collections</span></span>
<span data-ttu-id="6ec83-259">Azure Cosmos DB is a true schema-free database system.</span><span class="sxs-lookup"><span data-stu-id="6ec83-259">Azure Cosmos DB is a true schema-free database system.</span></span> <span data-ttu-id="6ec83-260">It does not assume or require any schema for the JSON documents.</span><span class="sxs-lookup"><span data-stu-id="6ec83-260">It does not assume or require any schema for the JSON documents.</span></span> <span data-ttu-id="6ec83-261">As you add documents to a collection, Azure Cosmos DB automatically indexes them and they are available for you to query.</span><span class="sxs-lookup"><span data-stu-id="6ec83-261">As you add documents to a collection, Azure Cosmos DB automatically indexes them and they are available for you to query.</span></span> <span data-ttu-id="6ec83-262">Automatic indexing of documents without requiring schema or secondary indexes is a key capability of Azure Cosmos DB and is enabled by write-optimized, lock-free, and log-structured index maintenance techniques.</span><span class="sxs-lookup"><span data-stu-id="6ec83-262">Automatic indexing of documents without requiring schema or secondary indexes is a key capability of Azure Cosmos DB and is enabled by write-optimized, lock-free, and log-structured index maintenance techniques.</span></span> <span data-ttu-id="6ec83-263">Azure Cosmos DB supports sustained volume of extremely fast writes while still serving consistent queries.</span><span class="sxs-lookup"><span data-stu-id="6ec83-263">Azure Cosmos DB supports sustained volume of extremely fast writes while still serving consistent queries.</span></span> <span data-ttu-id="6ec83-264">Both document and index storage are used to calculate the storage consumed by each collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-264">Both document and index storage are used to calculate the storage consumed by each collection.</span></span> <span data-ttu-id="6ec83-265">You can control the storage and performance trade-offs associated with indexing by configuring the indexing policy for a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-265">You can control the storage and performance trade-offs associated with indexing by configuring the indexing policy for a collection.</span></span> 

### <a name="configuring-the-indexing-policy-of-a-collection"></a><span data-ttu-id="6ec83-266">Configuring the indexing policy of a collection</span><span class="sxs-lookup"><span data-stu-id="6ec83-266">Configuring the indexing policy of a collection</span></span>
<span data-ttu-id="6ec83-267">The indexing policy of each collection allows you to make performance and storage trade-offs associated with indexing.</span><span class="sxs-lookup"><span data-stu-id="6ec83-267">The indexing policy of each collection allows you to make performance and storage trade-offs associated with indexing.</span></span> <span data-ttu-id="6ec83-268">The following options are available to you as part of indexing configuration:</span><span class="sxs-lookup"><span data-stu-id="6ec83-268">The following options are available to you as part of indexing configuration:</span></span>  

* <span data-ttu-id="6ec83-269">Choose whether the collection automatically indexes all of the documents or not.</span><span class="sxs-lookup"><span data-stu-id="6ec83-269">Choose whether the collection automatically indexes all of the documents or not.</span></span> <span data-ttu-id="6ec83-270">By default, all documents are automatically indexed.</span><span class="sxs-lookup"><span data-stu-id="6ec83-270">By default, all documents are automatically indexed.</span></span> <span data-ttu-id="6ec83-271">You can choose to turn off automatic indexing and selectively add only specific documents to the index.</span><span class="sxs-lookup"><span data-stu-id="6ec83-271">You can choose to turn off automatic indexing and selectively add only specific documents to the index.</span></span> <span data-ttu-id="6ec83-272">Conversely, you can selectively choose to exclude only specific documents.</span><span class="sxs-lookup"><span data-stu-id="6ec83-272">Conversely, you can selectively choose to exclude only specific documents.</span></span> <span data-ttu-id="6ec83-273">You can achieve this by setting the automatic property to be true or false on the indexingPolicy of a collection and using the [x-ms-indexingdirective] request header while inserting, replacing, or deleting a document.</span><span class="sxs-lookup"><span data-stu-id="6ec83-273">You can achieve this by setting the automatic property to be true or false on the indexingPolicy of a collection and using the [x-ms-indexingdirective] request header while inserting, replacing, or deleting a document.</span></span>  
* <span data-ttu-id="6ec83-274">Choose whether to include or exclude specific paths or patterns in your documents from the index.</span><span class="sxs-lookup"><span data-stu-id="6ec83-274">Choose whether to include or exclude specific paths or patterns in your documents from the index.</span></span> <span data-ttu-id="6ec83-275">You can achieve this by setting includedPaths and excludedPaths on the indexingPolicy of a collection respectively.</span><span class="sxs-lookup"><span data-stu-id="6ec83-275">You can achieve this by setting includedPaths and excludedPaths on the indexingPolicy of a collection respectively.</span></span> <span data-ttu-id="6ec83-276">You can also configure the storage and performance trade-offs for range and hash queries for specific path patterns.</span><span class="sxs-lookup"><span data-stu-id="6ec83-276">You can also configure the storage and performance trade-offs for range and hash queries for specific path patterns.</span></span> 
* <span data-ttu-id="6ec83-277">Choose between synchronous (consistent) and asynchronous (lazy) index updates.</span><span class="sxs-lookup"><span data-stu-id="6ec83-277">Choose between synchronous (consistent) and asynchronous (lazy) index updates.</span></span> <span data-ttu-id="6ec83-278">By default, the index is updated synchronously on each insert, replace or delete of a document to the collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-278">By default, the index is updated synchronously on each insert, replace or delete of a document to the collection.</span></span> <span data-ttu-id="6ec83-279">This enables the queries to honor the same consistency level as that of the document reads.</span><span class="sxs-lookup"><span data-stu-id="6ec83-279">This enables the queries to honor the same consistency level as that of the document reads.</span></span> <span data-ttu-id="6ec83-280">While Azure Cosmos DB is write optimized and supports sustained volumes of document writes along with synchronous index maintenance and serving consistent queries, you can configure certain collections to update their index lazily.</span><span class="sxs-lookup"><span data-stu-id="6ec83-280">While Azure Cosmos DB is write optimized and supports sustained volumes of document writes along with synchronous index maintenance and serving consistent queries, you can configure certain collections to update their index lazily.</span></span> <span data-ttu-id="6ec83-281">Lazy indexing boosts the write performance further and is ideal for bulk ingestion scenarios for primarily read-heavy collections.</span><span class="sxs-lookup"><span data-stu-id="6ec83-281">Lazy indexing boosts the write performance further and is ideal for bulk ingestion scenarios for primarily read-heavy collections.</span></span>

<span data-ttu-id="6ec83-282">The indexing policy can be changed by executing a PUT on the collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-282">The indexing policy can be changed by executing a PUT on the collection.</span></span> <span data-ttu-id="6ec83-283">This can be achieved either through the [client SDK](sql-api-sdk-dotnet.md), the [Azure portal](https://portal.azure.com), or the [REST APIs](/rest/api/cosmos-db/).</span><span class="sxs-lookup"><span data-stu-id="6ec83-283">This can be achieved either through the [client SDK](sql-api-sdk-dotnet.md), the [Azure portal](https://portal.azure.com), or the [REST APIs](/rest/api/cosmos-db/).</span></span>

### <a name="querying-a-collection"></a><span data-ttu-id="6ec83-284">Querying a collection</span><span class="sxs-lookup"><span data-stu-id="6ec83-284">Querying a collection</span></span>
<span data-ttu-id="6ec83-285">The documents within a collection can have arbitrary schemas and you can query documents within a collection without providing any schema or secondary indices upfront.</span><span class="sxs-lookup"><span data-stu-id="6ec83-285">The documents within a collection can have arbitrary schemas and you can query documents within a collection without providing any schema or secondary indices upfront.</span></span> <span data-ttu-id="6ec83-286">You can query the collection using the [Azure Cosmos DB SQL syntax reference](https://msdn.microsoft.com/library/azure/dn782250.aspx), which provides rich hierarchical, relational, and spatial operators and extensibility via JavaScript-based UDFs.</span><span class="sxs-lookup"><span data-stu-id="6ec83-286">You can query the collection using the [Azure Cosmos DB SQL syntax reference](https://msdn.microsoft.com/library/azure/dn782250.aspx), which provides rich hierarchical, relational, and spatial operators and extensibility via JavaScript-based UDFs.</span></span> <span data-ttu-id="6ec83-287">JSON grammar allows for modeling JSON documents as trees with labels as the tree nodes.</span><span class="sxs-lookup"><span data-stu-id="6ec83-287">JSON grammar allows for modeling JSON documents as trees with labels as the tree nodes.</span></span> <span data-ttu-id="6ec83-288">This is exploited both by SQL API’s automatic indexing techniques as well as Azure Cosmos DB's SQL dialect.</span><span class="sxs-lookup"><span data-stu-id="6ec83-288">This is exploited both by SQL API’s automatic indexing techniques as well as Azure Cosmos DB's SQL dialect.</span></span> <span data-ttu-id="6ec83-289">The SQL query language consists of three main aspects:</span><span class="sxs-lookup"><span data-stu-id="6ec83-289">The SQL query language consists of three main aspects:</span></span>   

1. <span data-ttu-id="6ec83-290">A small set of query operations that map naturally to the tree structure including hierarchical queries and projections.</span><span class="sxs-lookup"><span data-stu-id="6ec83-290">A small set of query operations that map naturally to the tree structure including hierarchical queries and projections.</span></span> 
2. <span data-ttu-id="6ec83-291">A subset of relational operations including composition, filter, projections, aggregates, and self joins.</span><span class="sxs-lookup"><span data-stu-id="6ec83-291">A subset of relational operations including composition, filter, projections, aggregates, and self joins.</span></span> 
3. <span data-ttu-id="6ec83-292">Pure JavaScript based UDFs that work with (1) and (2).</span><span class="sxs-lookup"><span data-stu-id="6ec83-292">Pure JavaScript based UDFs that work with (1) and (2).</span></span>  

<span data-ttu-id="6ec83-293">The Azure Cosmos DB query model attempts to strike a balance between functionality, efficiency, and simplicity.</span><span class="sxs-lookup"><span data-stu-id="6ec83-293">The Azure Cosmos DB query model attempts to strike a balance between functionality, efficiency, and simplicity.</span></span> <span data-ttu-id="6ec83-294">The Azure Cosmos DB database engine natively compiles and executes the SQL query statements.</span><span class="sxs-lookup"><span data-stu-id="6ec83-294">The Azure Cosmos DB database engine natively compiles and executes the SQL query statements.</span></span> <span data-ttu-id="6ec83-295">You can query a collection using the [REST APIs](/rest/api/cosmos-db/) or any of the [client SDKs](sql-api-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-295">You can query a collection using the [REST APIs](/rest/api/cosmos-db/) or any of the [client SDKs](sql-api-sdk-dotnet.md).</span></span> <span data-ttu-id="6ec83-296">The .NET SDK comes with a LINQ provider.</span><span class="sxs-lookup"><span data-stu-id="6ec83-296">The .NET SDK comes with a LINQ provider.</span></span>

> [!TIP]
> <span data-ttu-id="6ec83-297">You can try out the SQL API and run SQL queries against our dataset in the [Query Playground](https://www.documentdb.com/sql/demo).</span><span class="sxs-lookup"><span data-stu-id="6ec83-297">You can try out the SQL API and run SQL queries against our dataset in the [Query Playground](https://www.documentdb.com/sql/demo).</span></span>
> 
> 

## <a name="multi-document-transactions"></a><span data-ttu-id="6ec83-298">Multi-document transactions</span><span class="sxs-lookup"><span data-stu-id="6ec83-298">Multi-document transactions</span></span>
<span data-ttu-id="6ec83-299">Database transactions provide a safe and predictable programming model for dealing with concurrent changes to the data.</span><span class="sxs-lookup"><span data-stu-id="6ec83-299">Database transactions provide a safe and predictable programming model for dealing with concurrent changes to the data.</span></span> <span data-ttu-id="6ec83-300">In RDBMS, the traditional way to write business logic is to write **stored-procedures** and/or **triggers** and ship it to the database server for transactional execution.</span><span class="sxs-lookup"><span data-stu-id="6ec83-300">In RDBMS, the traditional way to write business logic is to write **stored-procedures** and/or **triggers** and ship it to the database server for transactional execution.</span></span> <span data-ttu-id="6ec83-301">In RDBMS, the application programmer is required to deal with two disparate programming languages:</span><span class="sxs-lookup"><span data-stu-id="6ec83-301">In RDBMS, the application programmer is required to deal with two disparate programming languages:</span></span> 

* <span data-ttu-id="6ec83-302">The (non-transactional) application programming language (for example, JavaScript, Python, C#, Java, etc.)</span><span class="sxs-lookup"><span data-stu-id="6ec83-302">The (non-transactional) application programming language (for example, JavaScript, Python, C#, Java, etc.)</span></span>
* <span data-ttu-id="6ec83-303">T-SQL, the transactional programming language that is natively executed by the database</span><span class="sxs-lookup"><span data-stu-id="6ec83-303">T-SQL, the transactional programming language that is natively executed by the database</span></span>

<span data-ttu-id="6ec83-304">By virtue of its deep commitment to JavaScript and JSON directly within the database engine, Azure Cosmos DB provides an intuitive programming model for executing JavaScript based application logic directly on the collections in terms of stored procedures and triggers.</span><span class="sxs-lookup"><span data-stu-id="6ec83-304">By virtue of its deep commitment to JavaScript and JSON directly within the database engine, Azure Cosmos DB provides an intuitive programming model for executing JavaScript based application logic directly on the collections in terms of stored procedures and triggers.</span></span> <span data-ttu-id="6ec83-305">This allows for both of the following:</span><span class="sxs-lookup"><span data-stu-id="6ec83-305">This allows for both of the following:</span></span>

* <span data-ttu-id="6ec83-306">Efficient implementation of concurrency control, recovery, automatic indexing of the JSON object graphs directly in the database engine</span><span class="sxs-lookup"><span data-stu-id="6ec83-306">Efficient implementation of concurrency control, recovery, automatic indexing of the JSON object graphs directly in the database engine</span></span>
* <span data-ttu-id="6ec83-307">Naturally expressing control flow, variable scoping, assignment, and integration of exception handling primitives with database transactions directly in terms of the JavaScript programming language</span><span class="sxs-lookup"><span data-stu-id="6ec83-307">Naturally expressing control flow, variable scoping, assignment, and integration of exception handling primitives with database transactions directly in terms of the JavaScript programming language</span></span>

<span data-ttu-id="6ec83-308">The JavaScript logic registered at a collection level can then issue database operations on the documents of the given collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-308">The JavaScript logic registered at a collection level can then issue database operations on the documents of the given collection.</span></span> <span data-ttu-id="6ec83-309">Azure Cosmos DB implicitly wraps the JavaScript based stored procedures and triggers within an ambient ACID transaction with snapshot isolation across documents within a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-309">Azure Cosmos DB implicitly wraps the JavaScript based stored procedures and triggers within an ambient ACID transaction with snapshot isolation across documents within a collection.</span></span> <span data-ttu-id="6ec83-310">During the course of its execution, if the JavaScript throws an exception, then the entire transaction is aborted.</span><span class="sxs-lookup"><span data-stu-id="6ec83-310">During the course of its execution, if the JavaScript throws an exception, then the entire transaction is aborted.</span></span> <span data-ttu-id="6ec83-311">The resulting programming model is simple yet powerful.</span><span class="sxs-lookup"><span data-stu-id="6ec83-311">The resulting programming model is simple yet powerful.</span></span> <span data-ttu-id="6ec83-312">JavaScript developers get a "durable" programming model while still using their familiar language constructs and library primitives.</span><span class="sxs-lookup"><span data-stu-id="6ec83-312">JavaScript developers get a "durable" programming model while still using their familiar language constructs and library primitives.</span></span>   

<span data-ttu-id="6ec83-313">The ability to execute JavaScript directly within the database engine in the same address space as the buffer pool enables performant and transactional execution of database operations against the documents of a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-313">The ability to execute JavaScript directly within the database engine in the same address space as the buffer pool enables performant and transactional execution of database operations against the documents of a collection.</span></span> <span data-ttu-id="6ec83-314">Furthermore, Cosmos DB database engine makes a deep commitment to the JSON and JavaScript eliminates any impedance mismatch between the type systems of application and the database.</span><span class="sxs-lookup"><span data-stu-id="6ec83-314">Furthermore, Cosmos DB database engine makes a deep commitment to the JSON and JavaScript eliminates any impedance mismatch between the type systems of application and the database.</span></span>   

<span data-ttu-id="6ec83-315">After creating a collection, you can register stored procedures, triggers, and UDFs with a collection using the [REST APIs](/rest/api/cosmos-db/) or any of the [client SDKs](sql-api-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-315">After creating a collection, you can register stored procedures, triggers, and UDFs with a collection using the [REST APIs](/rest/api/cosmos-db/) or any of the [client SDKs](sql-api-sdk-dotnet.md).</span></span> <span data-ttu-id="6ec83-316">After registration, you can reference and execute them.</span><span class="sxs-lookup"><span data-stu-id="6ec83-316">After registration, you can reference and execute them.</span></span> <span data-ttu-id="6ec83-317">Consider the following stored procedure written entirely in JavaScript, the code below takes two arguments (book name and author name) and creates a new document, queries for a document and then updates it – all within an implicit ACID transaction.</span><span class="sxs-lookup"><span data-stu-id="6ec83-317">Consider the following stored procedure written entirely in JavaScript, the code below takes two arguments (book name and author name) and creates a new document, queries for a document and then updates it – all within an implicit ACID transaction.</span></span> <span data-ttu-id="6ec83-318">At any point during the execution, if a JavaScript exception is thrown, the entire transaction aborts.</span><span class="sxs-lookup"><span data-stu-id="6ec83-318">At any point during the execution, if a JavaScript exception is thrown, the entire transaction aborts.</span></span>

    function businessLogic(name, author) {
        var context = getContext();
        var collectionManager = context.getCollection();        
        var collectionLink = collectionManager.getSelfLink()

        // create a new document.
        collectionManager.createDocument(collectionLink,
            {id: name, author: author},
            function(err, documentCreated) {
                if(err) throw new Error(err.message);

                // filter documents by author
                var filterQuery = "SELECT * from root r WHERE r.author = 'George R.'";
                collectionManager.queryDocuments(collectionLink,
                    filterQuery,
                    function(err, matchingDocuments) {
                        if(err) throw new Error(err.message);

                        context.getResponse().setBody(matchingDocuments.length);

                        // Replace the author name for all documents that satisfied the query.
                        for (var i = 0; i < matchingDocuments.length; i++) {
                            matchingDocuments[i].author = "George R. R. Martin";
                            // we don’t need to execute a callback because they are in parallel
                            collectionManager.replaceDocument(matchingDocuments[i]._self,
                                matchingDocuments[i]);   
                        }
                    })
            })
    };

<span data-ttu-id="6ec83-319">The client can "ship" the above JavaScript logic to the database for transactional execution via HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="6ec83-319">The client can "ship" the above JavaScript logic to the database for transactional execution via HTTP POST.</span></span> <span data-ttu-id="6ec83-320">For more information about using HTTP methods, see [RESTful interactions with Azure Cosmos DB resources](https://msdn.microsoft.com/library/azure/mt622086.aspx).</span><span class="sxs-lookup"><span data-stu-id="6ec83-320">For more information about using HTTP methods, see [RESTful interactions with Azure Cosmos DB resources](https://msdn.microsoft.com/library/azure/mt622086.aspx).</span></span> 

    client.createStoredProcedureAsync(collection._self, {id: "CRUDProc", body: businessLogic})
       .then(function(createdStoredProcedure) {
            return client.executeStoredProcedureAsync(createdStoredProcedure.resource._self,
                "NoSQL Distilled",
                "Martin Fowler");
        })
        .then(function(result) {
            console.log(result);
        },
        function(error) {
            console.log(error);
        });


<span data-ttu-id="6ec83-321">Notice that because the database natively understands JSON and JavaScript, there is no type system mismatch, no "OR mapping" or code generation magic required.</span><span class="sxs-lookup"><span data-stu-id="6ec83-321">Notice that because the database natively understands JSON and JavaScript, there is no type system mismatch, no "OR mapping" or code generation magic required.</span></span>   

<span data-ttu-id="6ec83-322">Stored procedures and triggers interact with a collection and the documents in a collection through a well-defined object model, which exposes the current collection context.</span><span class="sxs-lookup"><span data-stu-id="6ec83-322">Stored procedures and triggers interact with a collection and the documents in a collection through a well-defined object model, which exposes the current collection context.</span></span>  

<span data-ttu-id="6ec83-323">Collections in the SQL API can be created, deleted, read, or enumerated easily using either the [REST APIs](/rest/api/cosmos-db/) or any of the [client SDKs](sql-api-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-323">Collections in the SQL API can be created, deleted, read, or enumerated easily using either the [REST APIs](/rest/api/cosmos-db/) or any of the [client SDKs](sql-api-sdk-dotnet.md).</span></span> <span data-ttu-id="6ec83-324">The SQL API always provides strong consistency for reading or querying the metadata of a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-324">The SQL API always provides strong consistency for reading or querying the metadata of a collection.</span></span> <span data-ttu-id="6ec83-325">Deleting a collection automatically ensures that you cannot access any of the documents, attachments, stored procedures, triggers, and UDFs contained within it.</span><span class="sxs-lookup"><span data-stu-id="6ec83-325">Deleting a collection automatically ensures that you cannot access any of the documents, attachments, stored procedures, triggers, and UDFs contained within it.</span></span>   

## <a name="stored-procedures-triggers-and-user-defined-functions-udf"></a><span data-ttu-id="6ec83-326">Stored procedures, triggers, and User Defined Functions (UDF)</span><span class="sxs-lookup"><span data-stu-id="6ec83-326">Stored procedures, triggers, and User Defined Functions (UDF)</span></span>
<span data-ttu-id="6ec83-327">As described in the previous section, you can write application logic to run directly within a transaction inside of the database engine.</span><span class="sxs-lookup"><span data-stu-id="6ec83-327">As described in the previous section, you can write application logic to run directly within a transaction inside of the database engine.</span></span> <span data-ttu-id="6ec83-328">The application logic can be written entirely in JavaScript and can be modeled as a stored procedure, trigger, or a UDF.</span><span class="sxs-lookup"><span data-stu-id="6ec83-328">The application logic can be written entirely in JavaScript and can be modeled as a stored procedure, trigger, or a UDF.</span></span> <span data-ttu-id="6ec83-329">The JavaScript code within a stored procedure or a trigger can insert, replace, delete, read, or query documents within a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-329">The JavaScript code within a stored procedure or a trigger can insert, replace, delete, read, or query documents within a collection.</span></span> <span data-ttu-id="6ec83-330">On the other hand, the JavaScript within a UDF cannot insert, replace, or delete documents.</span><span class="sxs-lookup"><span data-stu-id="6ec83-330">On the other hand, the JavaScript within a UDF cannot insert, replace, or delete documents.</span></span> <span data-ttu-id="6ec83-331">UDFs enumerate the documents of a query's result set and produce another result set.</span><span class="sxs-lookup"><span data-stu-id="6ec83-331">UDFs enumerate the documents of a query's result set and produce another result set.</span></span> <span data-ttu-id="6ec83-332">For multi-tenancy, Azure Cosmos DB enforces a strict reservation-based resource governance.</span><span class="sxs-lookup"><span data-stu-id="6ec83-332">For multi-tenancy, Azure Cosmos DB enforces a strict reservation-based resource governance.</span></span> <span data-ttu-id="6ec83-333">Each stored procedure, trigger, or a UDF gets a fixed quantum of operating system resources to do its work.</span><span class="sxs-lookup"><span data-stu-id="6ec83-333">Each stored procedure, trigger, or a UDF gets a fixed quantum of operating system resources to do its work.</span></span> <span data-ttu-id="6ec83-334">Furthermore, stored procedures, triggers, or UDFs cannot link against external JavaScript libraries and are blacklisted if they exceed the resource budgets allocated to them.</span><span class="sxs-lookup"><span data-stu-id="6ec83-334">Furthermore, stored procedures, triggers, or UDFs cannot link against external JavaScript libraries and are blacklisted if they exceed the resource budgets allocated to them.</span></span> <span data-ttu-id="6ec83-335">You can register, unregister stored procedures, triggers, or UDFs with a collection by using the REST APIs.</span><span class="sxs-lookup"><span data-stu-id="6ec83-335">You can register, unregister stored procedures, triggers, or UDFs with a collection by using the REST APIs.</span></span>  <span data-ttu-id="6ec83-336">Upon registration a stored procedure, trigger, or a UDF is pre-compiled and stored as byte code, which gets executed later.</span><span class="sxs-lookup"><span data-stu-id="6ec83-336">Upon registration a stored procedure, trigger, or a UDF is pre-compiled and stored as byte code, which gets executed later.</span></span> <span data-ttu-id="6ec83-337">The following section illustrates how you can use the Azure Cosmos DB JavaScript SDK to register, execute, and unregister a stored procedure, trigger, and a UDF.</span><span class="sxs-lookup"><span data-stu-id="6ec83-337">The following section illustrates how you can use the Azure Cosmos DB JavaScript SDK to register, execute, and unregister a stored procedure, trigger, and a UDF.</span></span> <span data-ttu-id="6ec83-338">The JavaScript SDK is a simple wrapper over the [REST APIs](/rest/api/cosmos-db/).</span><span class="sxs-lookup"><span data-stu-id="6ec83-338">The JavaScript SDK is a simple wrapper over the [REST APIs](/rest/api/cosmos-db/).</span></span> 

### <a name="registering-a-stored-procedure"></a><span data-ttu-id="6ec83-339">Registering a stored procedure</span><span class="sxs-lookup"><span data-stu-id="6ec83-339">Registering a stored procedure</span></span>
<span data-ttu-id="6ec83-340">Registration of a stored procedure creates a new stored procedure resource on a collection via HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="6ec83-340">Registration of a stored procedure creates a new stored procedure resource on a collection via HTTP POST.</span></span>  

    var storedProc = {
        id: "validateAndCreate",
        body: function (documentToCreate) {
            documentToCreate.id = documentToCreate.id.toUpperCase();

            var collectionManager = getContext().getCollection();
            collectionManager.createDocument(collectionManager.getSelfLink(),
                documentToCreate,
                function(err, documentCreated) {
                    if(err) throw new Error('Error while creating document: ' + err.message;
                    getContext().getResponse().setBody('success - created ' + 
                            documentCreated.name);
                });
        }
    };

    client.createStoredProcedureAsync(collection._self, storedProc)
        .then(function (createdStoredProcedure) {
            console.log("Successfully created stored procedure");
        }, function(error) {
            console.log("Error");
        });

### <a name="executing-a-stored-procedure"></a><span data-ttu-id="6ec83-341">Executing a stored procedure</span><span class="sxs-lookup"><span data-stu-id="6ec83-341">Executing a stored procedure</span></span>
<span data-ttu-id="6ec83-342">Execution of a stored procedure is done by issuing an HTTP POST against an existing stored procedure resource by passing parameters to the procedure in the request body.</span><span class="sxs-lookup"><span data-stu-id="6ec83-342">Execution of a stored procedure is done by issuing an HTTP POST against an existing stored procedure resource by passing parameters to the procedure in the request body.</span></span>

    var inputDocument = {id : "document1", author: "G. G. Marquez"};
    client.executeStoredProcedureAsync(createdStoredProcedure.resource._self, inputDocument)
        .then(function(executionResult) {
            assert.equal(executionResult, "success - created DOCUMENT1");
        }, function(error) {
            console.log("Error");
        });

### <a name="unregistering-a-stored-procedure"></a><span data-ttu-id="6ec83-343">Unregistering a stored procedure</span><span class="sxs-lookup"><span data-stu-id="6ec83-343">Unregistering a stored procedure</span></span>
<span data-ttu-id="6ec83-344">Unregistering a stored procedure is done by issuing an HTTP DELETE against an existing stored procedure resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-344">Unregistering a stored procedure is done by issuing an HTTP DELETE against an existing stored procedure resource.</span></span>   

    client.deleteStoredProcedureAsync(createdStoredProcedure.resource._self)
        .then(function (response) {
            return;
        }, function(error) {
            console.log("Error");
        });


### <a name="registering-a-pre-trigger"></a><span data-ttu-id="6ec83-345">Registering a pre-trigger</span><span class="sxs-lookup"><span data-stu-id="6ec83-345">Registering a pre-trigger</span></span>
<span data-ttu-id="6ec83-346">Registration of a trigger is done by creating a new trigger resource on a collection via HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="6ec83-346">Registration of a trigger is done by creating a new trigger resource on a collection via HTTP POST.</span></span> <span data-ttu-id="6ec83-347">You can specify if the trigger is a pre or a post trigger and the type of operation it can be associated with (for example, Create, Replace, Delete, or All).</span><span class="sxs-lookup"><span data-stu-id="6ec83-347">You can specify if the trigger is a pre or a post trigger and the type of operation it can be associated with (for example, Create, Replace, Delete, or All).</span></span>   

    var preTrigger = {
        id: "upperCaseId",
        body: function() {
                var item = getContext().getRequest().getBody();
                item.id = item.id.toUpperCase();
                getContext().getRequest().setBody(item);
        },
        triggerType: TriggerType.Pre,
        triggerOperation: TriggerOperation.All
    }

    client.createTriggerAsync(collection._self, preTrigger)
        .then(function (createdPreTrigger) {
            console.log("Successfully created trigger");
        }, function(error) {
            console.log("Error");
        });

### <a name="executing-a-pre-trigger"></a><span data-ttu-id="6ec83-348">Executing a pre-trigger</span><span class="sxs-lookup"><span data-stu-id="6ec83-348">Executing a pre-trigger</span></span>
<span data-ttu-id="6ec83-349">Execution of a trigger is done by specifying the name of an existing trigger at the time of issuing the POST/PUT/DELETE request of a document resource via the request header.</span><span class="sxs-lookup"><span data-stu-id="6ec83-349">Execution of a trigger is done by specifying the name of an existing trigger at the time of issuing the POST/PUT/DELETE request of a document resource via the request header.</span></span>  

    client.createDocumentAsync(collection._self, { id: "doc1", key: "Love in the Time of Cholera" }, { preTriggerInclude: "upperCaseId" })
        .then(function(createdDocument) {
            assert.equal(createdDocument.resource.id, "DOC1");
        }, function(error) {
            console.log("Error");
        });

### <a name="unregistering-a-pre-trigger"></a><span data-ttu-id="6ec83-350">Unregistering a pre-trigger</span><span class="sxs-lookup"><span data-stu-id="6ec83-350">Unregistering a pre-trigger</span></span>
<span data-ttu-id="6ec83-351">Unregistering a trigger is done via issuing an HTTP DELETE against an existing trigger resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-351">Unregistering a trigger is done via issuing an HTTP DELETE against an existing trigger resource.</span></span>  

    client.deleteTriggerAsync(createdPreTrigger._self);
        .then(function(response) {
            return;
        }, function(error) {
            console.log("Error");
        });

### <a name="registering-a-udf"></a><span data-ttu-id="6ec83-352">Registering a UDF</span><span class="sxs-lookup"><span data-stu-id="6ec83-352">Registering a UDF</span></span>
<span data-ttu-id="6ec83-353">Registration of a UDF is done by creating a new UDF resource on a collection via HTTP POST.</span><span class="sxs-lookup"><span data-stu-id="6ec83-353">Registration of a UDF is done by creating a new UDF resource on a collection via HTTP POST.</span></span>  

    var udf = { 
        id: "mathSqrt",
        body: function(number) {
                return Math.sqrt(number);
        },
    };
    client.createUserDefinedFunctionAsync(collection._self, udf)
        .then(function (createdUdf) {
            console.log("Successfully created stored procedure");
        }, function(error) {
            console.log("Error");
        });

### <a name="executing-a-udf-as-part-of-the-query"></a><span data-ttu-id="6ec83-354">Executing a UDF as part of the query</span><span class="sxs-lookup"><span data-stu-id="6ec83-354">Executing a UDF as part of the query</span></span>
<span data-ttu-id="6ec83-355">A UDF can be specified as part of the SQL query and is used as a way to extend the core [SQL query language](sql-api-sql-query-reference.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-355">A UDF can be specified as part of the SQL query and is used as a way to extend the core [SQL query language](sql-api-sql-query-reference.md).</span></span>

    var filterQuery = "SELECT udf.mathSqrt(r.Age) AS sqrtAge FROM root r WHERE r.FirstName='John'";
    client.queryDocuments(collection._self, filterQuery).toArrayAsync();
        .then(function(queryResponse) {
            var queryResponseDocuments = queryResponse.feed;
        }, function(error) {
            console.log("Error");
        });

### <a name="unregistering-a-udf"></a><span data-ttu-id="6ec83-356">Unregistering a UDF</span><span class="sxs-lookup"><span data-stu-id="6ec83-356">Unregistering a UDF</span></span>
<span data-ttu-id="6ec83-357">Unregistering a UDF is simply done by issuing an HTTP DELETE against an existing UDF resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-357">Unregistering a UDF is simply done by issuing an HTTP DELETE against an existing UDF resource.</span></span>  

    client.deleteUserDefinedFunctionAsync(createdUdf._self)
        .then(function(response) {
            return;
        }, function(error) {
            console.log("Error");
        });

<span data-ttu-id="6ec83-358">Although the snippets above showed the registration (POST), unregistration (PUT), read/list (GET), and execution (POST) via the [JavaScript SDK](https://github.com/Azure/azure-documentdb-js), you can also use the [REST APIs](/rest/api/cosmos-db/) or other [client SDKs](sql-api-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-358">Although the snippets above showed the registration (POST), unregistration (PUT), read/list (GET), and execution (POST) via the [JavaScript SDK](https://github.com/Azure/azure-documentdb-js), you can also use the [REST APIs](/rest/api/cosmos-db/) or other [client SDKs](sql-api-sdk-dotnet.md).</span></span> 

## <a name="documents"></a><span data-ttu-id="6ec83-359">Documents</span><span class="sxs-lookup"><span data-stu-id="6ec83-359">Documents</span></span>
<span data-ttu-id="6ec83-360">You can insert, replace, delete, read, enumerate, and query arbitrary JSON documents in a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-360">You can insert, replace, delete, read, enumerate, and query arbitrary JSON documents in a collection.</span></span> <span data-ttu-id="6ec83-361">Azure Cosmos DB does not mandate any schema and does not require secondary indexes in order to support querying over documents in a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-361">Azure Cosmos DB does not mandate any schema and does not require secondary indexes in order to support querying over documents in a collection.</span></span> <span data-ttu-id="6ec83-362">The maximum size for a document is 2 MB.</span><span class="sxs-lookup"><span data-stu-id="6ec83-362">The maximum size for a document is 2 MB.</span></span>   

<span data-ttu-id="6ec83-363">Being a truly open database service, Azure Cosmos DB does not invent any specialized data types (for example, date time) or specific encodings for JSON documents.</span><span class="sxs-lookup"><span data-stu-id="6ec83-363">Being a truly open database service, Azure Cosmos DB does not invent any specialized data types (for example, date time) or specific encodings for JSON documents.</span></span> <span data-ttu-id="6ec83-364">Azure Cosmos DB does not require any special JSON conventions to codify the relationships among various documents; the SQL syntax of Azure Cosmos DB provides powerful hierarchical and relational query operators to query and project documents without any special annotations or need to codify relationships among documents using distinguished properties.</span><span class="sxs-lookup"><span data-stu-id="6ec83-364">Azure Cosmos DB does not require any special JSON conventions to codify the relationships among various documents; the SQL syntax of Azure Cosmos DB provides powerful hierarchical and relational query operators to query and project documents without any special annotations or need to codify relationships among documents using distinguished properties.</span></span>  

<span data-ttu-id="6ec83-365">As with all other resources, documents can be created, replaced, deleted, read, enumerated, and queried easily using either REST APIs or any of the [client SDKs](sql-api-sdk-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="6ec83-365">As with all other resources, documents can be created, replaced, deleted, read, enumerated, and queried easily using either REST APIs or any of the [client SDKs](sql-api-sdk-dotnet.md).</span></span> <span data-ttu-id="6ec83-366">Deleting a document instantly frees up the quota corresponding to all of the nested attachments.</span><span class="sxs-lookup"><span data-stu-id="6ec83-366">Deleting a document instantly frees up the quota corresponding to all of the nested attachments.</span></span> <span data-ttu-id="6ec83-367">The read consistency level of documents follows the consistency policy on the database account.</span><span class="sxs-lookup"><span data-stu-id="6ec83-367">The read consistency level of documents follows the consistency policy on the database account.</span></span> <span data-ttu-id="6ec83-368">This policy can be overridden on a per-request basis depending on data consistency requirements of your application.</span><span class="sxs-lookup"><span data-stu-id="6ec83-368">This policy can be overridden on a per-request basis depending on data consistency requirements of your application.</span></span> <span data-ttu-id="6ec83-369">When querying documents, the read consistency follows the indexing mode set on the collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-369">When querying documents, the read consistency follows the indexing mode set on the collection.</span></span> <span data-ttu-id="6ec83-370">For "consistent", this follows the account’s consistency policy.</span><span class="sxs-lookup"><span data-stu-id="6ec83-370">For "consistent", this follows the account’s consistency policy.</span></span> 

## <a name="attachments-and-media"></a><span data-ttu-id="6ec83-371">Attachments and media</span><span class="sxs-lookup"><span data-stu-id="6ec83-371">Attachments and media</span></span>
<span data-ttu-id="6ec83-372">Azure Cosmos DB allows you to store binary blobs/media either with Azure Cosmos DB (maximum of 2 GB per account) or to your own remote media store.</span><span class="sxs-lookup"><span data-stu-id="6ec83-372">Azure Cosmos DB allows you to store binary blobs/media either with Azure Cosmos DB (maximum of 2 GB per account) or to your own remote media store.</span></span> <span data-ttu-id="6ec83-373">It also allows you to represent the metadata of a media in terms of a special document called attachment.</span><span class="sxs-lookup"><span data-stu-id="6ec83-373">It also allows you to represent the metadata of a media in terms of a special document called attachment.</span></span> <span data-ttu-id="6ec83-374">An attachment in Azure Cosmos DB is a special (JSON) document that references the media/blob stored elsewhere.</span><span class="sxs-lookup"><span data-stu-id="6ec83-374">An attachment in Azure Cosmos DB is a special (JSON) document that references the media/blob stored elsewhere.</span></span> <span data-ttu-id="6ec83-375">An attachment is simply a special document that captures the metadata (for example, location, author etc.) of a media stored in a remote media storage.</span><span class="sxs-lookup"><span data-stu-id="6ec83-375">An attachment is simply a special document that captures the metadata (for example, location, author etc.) of a media stored in a remote media storage.</span></span> 

<span data-ttu-id="6ec83-376">Consider a social reading application that uses Azure Cosmos DB to store ink annotations, and metadata including comments, highlights, bookmarks, ratings, likes/dislikes etc. associated for an e-book of a given user.</span><span class="sxs-lookup"><span data-stu-id="6ec83-376">Consider a social reading application that uses Azure Cosmos DB to store ink annotations, and metadata including comments, highlights, bookmarks, ratings, likes/dislikes etc. associated for an e-book of a given user.</span></span>   

* <span data-ttu-id="6ec83-377">The content of the book itself is stored in the media storage either available as part of Azure Cosmos DB database account or a remote media store.</span><span class="sxs-lookup"><span data-stu-id="6ec83-377">The content of the book itself is stored in the media storage either available as part of Azure Cosmos DB database account or a remote media store.</span></span> 
* <span data-ttu-id="6ec83-378">An application may store each user’s metadata as a distinct document -- for example, Joe’s metadata for book1 is stored in a document referenced by /colls/joe/docs/book1.</span><span class="sxs-lookup"><span data-stu-id="6ec83-378">An application may store each user’s metadata as a distinct document -- for example, Joe’s metadata for book1 is stored in a document referenced by /colls/joe/docs/book1.</span></span> 
* <span data-ttu-id="6ec83-379">Attachments pointing to the content pages of a given book of a user are stored under the corresponding document, for example, /colls/joe/docs/book1/chapter1, /colls/joe/docs/book1/chapter2 etc.</span><span class="sxs-lookup"><span data-stu-id="6ec83-379">Attachments pointing to the content pages of a given book of a user are stored under the corresponding document, for example, /colls/joe/docs/book1/chapter1, /colls/joe/docs/book1/chapter2 etc.</span></span> 

<span data-ttu-id="6ec83-380">The examples listed above use friendly ids to convey the resource hierarchy.</span><span class="sxs-lookup"><span data-stu-id="6ec83-380">The examples listed above use friendly ids to convey the resource hierarchy.</span></span> <span data-ttu-id="6ec83-381">Resources are accessed via the REST APIs through unique resource ids.</span><span class="sxs-lookup"><span data-stu-id="6ec83-381">Resources are accessed via the REST APIs through unique resource ids.</span></span> 

<span data-ttu-id="6ec83-382">For the media that is managed by Azure Cosmos DB, the _media property of the attachment references the media by its URI.</span><span class="sxs-lookup"><span data-stu-id="6ec83-382">For the media that is managed by Azure Cosmos DB, the _media property of the attachment references the media by its URI.</span></span> <span data-ttu-id="6ec83-383">Azure Cosmos DB will ensure to garbage collect the media when all of the outstanding references are dropped.</span><span class="sxs-lookup"><span data-stu-id="6ec83-383">Azure Cosmos DB will ensure to garbage collect the media when all of the outstanding references are dropped.</span></span> <span data-ttu-id="6ec83-384">Azure Cosmos DB automatically generates the attachment when you upload the new media and populates the _media to point to the newly added media.</span><span class="sxs-lookup"><span data-stu-id="6ec83-384">Azure Cosmos DB automatically generates the attachment when you upload the new media and populates the _media to point to the newly added media.</span></span> <span data-ttu-id="6ec83-385">If you choose to store the media in a remote blob store managed by you (for example, OneDrive, Azure Storage, DropBox, etc.), you can still use attachments to reference the media.</span><span class="sxs-lookup"><span data-stu-id="6ec83-385">If you choose to store the media in a remote blob store managed by you (for example, OneDrive, Azure Storage, DropBox, etc.), you can still use attachments to reference the media.</span></span> <span data-ttu-id="6ec83-386">In this case, you will create the attachment yourself and populate its _media property.</span><span class="sxs-lookup"><span data-stu-id="6ec83-386">In this case, you will create the attachment yourself and populate its _media property.</span></span>   

<span data-ttu-id="6ec83-387">As with all other resources, attachments can be created, replaced, deleted, read, or enumerated easily using either REST APIs or any of the client SDKs.</span><span class="sxs-lookup"><span data-stu-id="6ec83-387">As with all other resources, attachments can be created, replaced, deleted, read, or enumerated easily using either REST APIs or any of the client SDKs.</span></span> <span data-ttu-id="6ec83-388">As with documents, the read consistency level of attachments follows the consistency policy on the database account.</span><span class="sxs-lookup"><span data-stu-id="6ec83-388">As with documents, the read consistency level of attachments follows the consistency policy on the database account.</span></span> <span data-ttu-id="6ec83-389">This policy can be overridden on a per-request basis depending on data consistency requirements of your application.</span><span class="sxs-lookup"><span data-stu-id="6ec83-389">This policy can be overridden on a per-request basis depending on data consistency requirements of your application.</span></span> <span data-ttu-id="6ec83-390">When querying for attachments, the read consistency follows the indexing mode set on the collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-390">When querying for attachments, the read consistency follows the indexing mode set on the collection.</span></span> <span data-ttu-id="6ec83-391">For "consistent", this follows the account’s consistency policy.</span><span class="sxs-lookup"><span data-stu-id="6ec83-391">For "consistent", this follows the account’s consistency policy.</span></span> 
 

## <a name="users"></a><span data-ttu-id="6ec83-392">Users</span><span class="sxs-lookup"><span data-stu-id="6ec83-392">Users</span></span>
<span data-ttu-id="6ec83-393">An Azure Cosmos DB user represents a logical namespace for grouping permissions.</span><span class="sxs-lookup"><span data-stu-id="6ec83-393">An Azure Cosmos DB user represents a logical namespace for grouping permissions.</span></span> <span data-ttu-id="6ec83-394">An Azure Cosmos DB user may correspond to a user in an identity management system or a predefined application role.</span><span class="sxs-lookup"><span data-stu-id="6ec83-394">An Azure Cosmos DB user may correspond to a user in an identity management system or a predefined application role.</span></span> <span data-ttu-id="6ec83-395">For Azure Cosmos DB, a user simply represents an abstraction to group a set of permissions under a database.</span><span class="sxs-lookup"><span data-stu-id="6ec83-395">For Azure Cosmos DB, a user simply represents an abstraction to group a set of permissions under a database.</span></span>   

<span data-ttu-id="6ec83-396">For implementing multi-tenancy in your application, you can create users in Azure Cosmos DB, which corresponds to your actual users or the tenants of your application.</span><span class="sxs-lookup"><span data-stu-id="6ec83-396">For implementing multi-tenancy in your application, you can create users in Azure Cosmos DB, which corresponds to your actual users or the tenants of your application.</span></span> <span data-ttu-id="6ec83-397">You can then create permissions for a given user that correspond to the access control over various collections, documents, attachments, etc.</span><span class="sxs-lookup"><span data-stu-id="6ec83-397">You can then create permissions for a given user that correspond to the access control over various collections, documents, attachments, etc.</span></span>   

<span data-ttu-id="6ec83-398">As your applications need to scale with your user growth, you can adopt various ways to shard your data.</span><span class="sxs-lookup"><span data-stu-id="6ec83-398">As your applications need to scale with your user growth, you can adopt various ways to shard your data.</span></span> <span data-ttu-id="6ec83-399">You can model each of your users as follows:</span><span class="sxs-lookup"><span data-stu-id="6ec83-399">You can model each of your users as follows:</span></span>   

* <span data-ttu-id="6ec83-400">Each user maps to a database.</span><span class="sxs-lookup"><span data-stu-id="6ec83-400">Each user maps to a database.</span></span>
* <span data-ttu-id="6ec83-401">Each user maps to a collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-401">Each user maps to a collection.</span></span> 
* <span data-ttu-id="6ec83-402">Documents corresponding to multiple users go to a dedicated collection.</span><span class="sxs-lookup"><span data-stu-id="6ec83-402">Documents corresponding to multiple users go to a dedicated collection.</span></span> 
* <span data-ttu-id="6ec83-403">Documents corresponding to multiple users go to a set of collections.</span><span class="sxs-lookup"><span data-stu-id="6ec83-403">Documents corresponding to multiple users go to a set of collections.</span></span>   

<span data-ttu-id="6ec83-404">Regardless of the specific sharding strategy you choose, you can model your actual users as users in Azure Cosmos DB database and associate fine grained permissions to each user.</span><span class="sxs-lookup"><span data-stu-id="6ec83-404">Regardless of the specific sharding strategy you choose, you can model your actual users as users in Azure Cosmos DB database and associate fine grained permissions to each user.</span></span>  

<span data-ttu-id="6ec83-405">![User collections][3]</span><span class="sxs-lookup"><span data-stu-id="6ec83-405">![User collections][3]</span></span>  
<span data-ttu-id="6ec83-406">**Sharding strategies and modeling users**</span><span class="sxs-lookup"><span data-stu-id="6ec83-406">**Sharding strategies and modeling users**</span></span>

<span data-ttu-id="6ec83-407">Like all other resources, users in Azure Cosmos DB can be created, replaced, deleted, read, or enumerated easily using either REST APIs or any of the client SDKs.</span><span class="sxs-lookup"><span data-stu-id="6ec83-407">Like all other resources, users in Azure Cosmos DB can be created, replaced, deleted, read, or enumerated easily using either REST APIs or any of the client SDKs.</span></span> <span data-ttu-id="6ec83-408">Azure Cosmos DB always provides strong consistency for reading or querying the metadata of a user resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-408">Azure Cosmos DB always provides strong consistency for reading or querying the metadata of a user resource.</span></span> <span data-ttu-id="6ec83-409">It is worth pointing out that deleting a user automatically ensures that you cannot access any of the permissions contained within it.</span><span class="sxs-lookup"><span data-stu-id="6ec83-409">It is worth pointing out that deleting a user automatically ensures that you cannot access any of the permissions contained within it.</span></span> <span data-ttu-id="6ec83-410">Even though the Azure Cosmos DB reclaims the quota of the permissions as part of the deleted user in the background, the deleted permissions is available instantly again for you to use.</span><span class="sxs-lookup"><span data-stu-id="6ec83-410">Even though the Azure Cosmos DB reclaims the quota of the permissions as part of the deleted user in the background, the deleted permissions is available instantly again for you to use.</span></span>  

## <a name="permissions"></a><span data-ttu-id="6ec83-411">Permissions</span><span class="sxs-lookup"><span data-stu-id="6ec83-411">Permissions</span></span>
<span data-ttu-id="6ec83-412">From an access control perspective, resources such as database accounts, databases, users, and permission are considered *administrative* resources since these require administrative permissions.</span><span class="sxs-lookup"><span data-stu-id="6ec83-412">From an access control perspective, resources such as database accounts, databases, users, and permission are considered *administrative* resources since these require administrative permissions.</span></span> <span data-ttu-id="6ec83-413">On the other hand, resources including the collections, documents, attachments, stored procedures, triggers, and UDFs are scoped under a given database and considered *application resources*.</span><span class="sxs-lookup"><span data-stu-id="6ec83-413">On the other hand, resources including the collections, documents, attachments, stored procedures, triggers, and UDFs are scoped under a given database and considered *application resources*.</span></span> <span data-ttu-id="6ec83-414">Corresponding to the two types of resources and the roles that access them (namely the administrator and user), the authorization model defines two types of *access keys*: *master key* and *resource key*.</span><span class="sxs-lookup"><span data-stu-id="6ec83-414">Corresponding to the two types of resources and the roles that access them (namely the administrator and user), the authorization model defines two types of *access keys*: *master key* and *resource key*.</span></span> <span data-ttu-id="6ec83-415">The master key is a part of the database account and is provided to the developer (or administrator) who is provisioning the database account.</span><span class="sxs-lookup"><span data-stu-id="6ec83-415">The master key is a part of the database account and is provided to the developer (or administrator) who is provisioning the database account.</span></span> <span data-ttu-id="6ec83-416">This master key has administrator semantics, in that it can be used to authorize access to both administrative and application resources.</span><span class="sxs-lookup"><span data-stu-id="6ec83-416">This master key has administrator semantics, in that it can be used to authorize access to both administrative and application resources.</span></span> <span data-ttu-id="6ec83-417">In contrast, a resource key is a granular access key that allows access to a *specific* application resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-417">In contrast, a resource key is a granular access key that allows access to a *specific* application resource.</span></span> <span data-ttu-id="6ec83-418">Thus, it captures the relationship between the user of a database and the permissions the user has for a specific resource (for example, collection, document, attachment, stored procedure, trigger, or UDF).</span><span class="sxs-lookup"><span data-stu-id="6ec83-418">Thus, it captures the relationship between the user of a database and the permissions the user has for a specific resource (for example, collection, document, attachment, stored procedure, trigger, or UDF).</span></span>   

<span data-ttu-id="6ec83-419">The only way to obtain a resource key is by creating a permission resource under a given user.</span><span class="sxs-lookup"><span data-stu-id="6ec83-419">The only way to obtain a resource key is by creating a permission resource under a given user.</span></span> <span data-ttu-id="6ec83-420">In order to create or retrieve a permission, a master key must be presented in the authorization header.</span><span class="sxs-lookup"><span data-stu-id="6ec83-420">In order to create or retrieve a permission, a master key must be presented in the authorization header.</span></span> <span data-ttu-id="6ec83-421">A permission resource ties the resource, its access, and the user.</span><span class="sxs-lookup"><span data-stu-id="6ec83-421">A permission resource ties the resource, its access, and the user.</span></span> <span data-ttu-id="6ec83-422">After creating a permission resource, the user only needs to present the associated resource key in order to gain access to the relevant resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-422">After creating a permission resource, the user only needs to present the associated resource key in order to gain access to the relevant resource.</span></span> <span data-ttu-id="6ec83-423">Hence, a resource key can be viewed as a logical and compact representation of the permission resource.</span><span class="sxs-lookup"><span data-stu-id="6ec83-423">Hence, a resource key can be viewed as a logical and compact representation of the permission resource.</span></span>  

<span data-ttu-id="6ec83-424">As with all other resources, permissions in Azure Cosmos DB can be created, replaced, deleted, read, or enumerated easily using either REST APIs or any of the client SDKs.</span><span class="sxs-lookup"><span data-stu-id="6ec83-424">As with all other resources, permissions in Azure Cosmos DB can be created, replaced, deleted, read, or enumerated easily using either REST APIs or any of the client SDKs.</span></span> <span data-ttu-id="6ec83-425">Azure Cosmos DB always provides strong consistency for reading or querying the metadata of a permission.</span><span class="sxs-lookup"><span data-stu-id="6ec83-425">Azure Cosmos DB always provides strong consistency for reading or querying the metadata of a permission.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="6ec83-426">Next steps</span><span class="sxs-lookup"><span data-stu-id="6ec83-426">Next steps</span></span>
<span data-ttu-id="6ec83-427">Learn more about working with resources by using HTTP commands in [RESTful interactions with Azure Cosmos DB resources](https://msdn.microsoft.com/library/azure/mt622086.aspx).</span><span class="sxs-lookup"><span data-stu-id="6ec83-427">Learn more about working with resources by using HTTP commands in [RESTful interactions with Azure Cosmos DB resources](https://msdn.microsoft.com/library/azure/mt622086.aspx).</span></span>

[1]: media/sql-api-resources/resources1.png
[2]: media/sql-api-resources/resources2.png
[3]: media/sql-api-resources/resources3.png

