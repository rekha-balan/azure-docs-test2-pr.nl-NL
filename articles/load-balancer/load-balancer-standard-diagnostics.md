---
title: Azure Standard Load Balancer diagnostics | Microsoft Docs
description: Use the available metrics and health information for diagnostics for Azure Standard Load Balancer.
services: load-balancer
documentationcenter: na
author: KumudD
manager: jeconnoc
editor: ''
tags: azure-resource-manager
ms.assetid: 46b152c5-6a27-4bfc-bea3-05de9ce06a57
ms.service: load-balancer
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 08/27/2018
ms.author: Kumud
ms.openlocfilehash: 43945dc8810151eb701aa9e1aa1be47d4fbb0491
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44867331"
---
# <a name="metrics-and-health-diagnostics-for-standard-load-balancer"></a><span data-ttu-id="6b645-103">Metrics and health diagnostics for Standard Load Balancer</span><span class="sxs-lookup"><span data-stu-id="6b645-103">Metrics and health diagnostics for Standard Load Balancer</span></span>

<span data-ttu-id="6b645-104">Azure Standard Load Balancer gives your resources the following diagnostic capabilities:</span><span class="sxs-lookup"><span data-stu-id="6b645-104">Azure Standard Load Balancer gives your resources the following diagnostic capabilities:</span></span>
* <span data-ttu-id="6b645-105">**Multi-dimensional metrics**: Provides new multi-dimensional diagnostic capabilities for both public and internal load balancer configurations.</span><span class="sxs-lookup"><span data-stu-id="6b645-105">**Multi-dimensional metrics**: Provides new multi-dimensional diagnostic capabilities for both public and internal load balancer configurations.</span></span> <span data-ttu-id="6b645-106">You can monitor, manage, and troubleshoot your load balancer resources.</span><span class="sxs-lookup"><span data-stu-id="6b645-106">You can monitor, manage, and troubleshoot your load balancer resources.</span></span>

* <span data-ttu-id="6b645-107">**Resource health**: The Load Balancer page in the Azure portal and the Resource Health page (under Monitor) expose the Resource Health section for the public load balancer configuration of Standard Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="6b645-107">**Resource health**: The Load Balancer page in the Azure portal and the Resource Health page (under Monitor) expose the Resource Health section for the public load balancer configuration of Standard Load Balancer.</span></span>

<span data-ttu-id="6b645-108">This article provides a quick tour of these capabilities, and it offers ways to use them for Standard Load Balancer.</span><span class="sxs-lookup"><span data-stu-id="6b645-108">This article provides a quick tour of these capabilities, and it offers ways to use them for Standard Load Balancer.</span></span>

## <a name = "MultiDimensionalMetrics"></a><span data-ttu-id="6b645-109">Multi-dimensional metrics</span><span class="sxs-lookup"><span data-stu-id="6b645-109">Multi-dimensional metrics</span></span>

<span data-ttu-id="6b645-110">Azure Load Balancer provides new multi-dimensional metrics via the new Azure Metrics (preview) in the Azure portal, and it helps you get real-time diagnostic insights into your load balancer resources.</span><span class="sxs-lookup"><span data-stu-id="6b645-110">Azure Load Balancer provides new multi-dimensional metrics via the new Azure Metrics (preview) in the Azure portal, and it helps you get real-time diagnostic insights into your load balancer resources.</span></span> 

<span data-ttu-id="6b645-111">The various Standard Load Balancer configurations provide the following metrics:</span><span class="sxs-lookup"><span data-stu-id="6b645-111">The various Standard Load Balancer configurations provide the following metrics:</span></span>

| <span data-ttu-id="6b645-112">Metric</span><span class="sxs-lookup"><span data-stu-id="6b645-112">Metric</span></span> | <span data-ttu-id="6b645-113">Resource type</span><span class="sxs-lookup"><span data-stu-id="6b645-113">Resource type</span></span> | <span data-ttu-id="6b645-114">Description</span><span class="sxs-lookup"><span data-stu-id="6b645-114">Description</span></span> | <span data-ttu-id="6b645-115">Recommended aggregation</span><span class="sxs-lookup"><span data-stu-id="6b645-115">Recommended aggregation</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="6b645-116">VIP availability (data path availability)</span><span class="sxs-lookup"><span data-stu-id="6b645-116">VIP availability (data path availability)</span></span> | <span data-ttu-id="6b645-117">Public load balancer</span><span class="sxs-lookup"><span data-stu-id="6b645-117">Public load balancer</span></span> | <span data-ttu-id="6b645-118">Standard Load Balancer continuously exercises the data path from within a region to the load balancer front end, all the way to the SDN stack that supports your VM.</span><span class="sxs-lookup"><span data-stu-id="6b645-118">Standard Load Balancer continuously exercises the data path from within a region to the load balancer front end, all the way to the SDN stack that supports your VM.</span></span> <span data-ttu-id="6b645-119">As long as healthy instances remain, the measurement follows the same path as your application's load-balanced traffic.</span><span class="sxs-lookup"><span data-stu-id="6b645-119">As long as healthy instances remain, the measurement follows the same path as your application's load-balanced traffic.</span></span> <span data-ttu-id="6b645-120">The data path that your customers use is also validated.</span><span class="sxs-lookup"><span data-stu-id="6b645-120">The data path that your customers use is also validated.</span></span> <span data-ttu-id="6b645-121">The measurement is invisible to your application and does not interfere with other operations.</span><span class="sxs-lookup"><span data-stu-id="6b645-121">The measurement is invisible to your application and does not interfere with other operations.</span></span>| <span data-ttu-id="6b645-122">Average</span><span class="sxs-lookup"><span data-stu-id="6b645-122">Average</span></span> |
| <span data-ttu-id="6b645-123">DIP availability (health probe status)</span><span class="sxs-lookup"><span data-stu-id="6b645-123">DIP availability (health probe status)</span></span> |  <span data-ttu-id="6b645-124">Public and internal load balancer</span><span class="sxs-lookup"><span data-stu-id="6b645-124">Public and internal load balancer</span></span> | <span data-ttu-id="6b645-125">Standard Load Balancer uses a distributed health-probing service that monitors your application endpoint's health according to your configuration settings.</span><span class="sxs-lookup"><span data-stu-id="6b645-125">Standard Load Balancer uses a distributed health-probing service that monitors your application endpoint's health according to your configuration settings.</span></span> <span data-ttu-id="6b645-126">This metric provides an aggregate or per-endpoint filtered view of each instance endpoint in the load balancer pool.</span><span class="sxs-lookup"><span data-stu-id="6b645-126">This metric provides an aggregate or per-endpoint filtered view of each instance endpoint in the load balancer pool.</span></span> <span data-ttu-id="6b645-127">You can see how Load Balancer views the health of your application, as indicated by your health probe configuration.</span><span class="sxs-lookup"><span data-stu-id="6b645-127">You can see how Load Balancer views the health of your application, as indicated by your health probe configuration.</span></span> |  <span data-ttu-id="6b645-128">Average</span><span class="sxs-lookup"><span data-stu-id="6b645-128">Average</span></span> |
| <span data-ttu-id="6b645-129">SYN (synchronize) packets</span><span class="sxs-lookup"><span data-stu-id="6b645-129">SYN (synchronize) packets</span></span> |  <span data-ttu-id="6b645-130">Public load balancer</span><span class="sxs-lookup"><span data-stu-id="6b645-130">Public load balancer</span></span> | <span data-ttu-id="6b645-131">Standard Load Balancer does not terminate Transmission Control Protocol (TCP) connections or interact with TCP or UDP packet flows.</span><span class="sxs-lookup"><span data-stu-id="6b645-131">Standard Load Balancer does not terminate Transmission Control Protocol (TCP) connections or interact with TCP or UDP packet flows.</span></span> <span data-ttu-id="6b645-132">Flows and their handshakes are always between the source and the VM instance.</span><span class="sxs-lookup"><span data-stu-id="6b645-132">Flows and their handshakes are always between the source and the VM instance.</span></span> <span data-ttu-id="6b645-133">To better troubleshoot your TCP protocol scenarios, you can make use of SYN packets counters to understand how many TCP connection attempts are made.</span><span class="sxs-lookup"><span data-stu-id="6b645-133">To better troubleshoot your TCP protocol scenarios, you can make use of SYN packets counters to understand how many TCP connection attempts are made.</span></span> <span data-ttu-id="6b645-134">The metric reports the number of TCP SYN packets that were received.</span><span class="sxs-lookup"><span data-stu-id="6b645-134">The metric reports the number of TCP SYN packets that were received.</span></span>| <span data-ttu-id="6b645-135">Average</span><span class="sxs-lookup"><span data-stu-id="6b645-135">Average</span></span> |
| <span data-ttu-id="6b645-136">SNAT connections</span><span class="sxs-lookup"><span data-stu-id="6b645-136">SNAT connections</span></span> |  <span data-ttu-id="6b645-137">Public Load Balancer</span><span class="sxs-lookup"><span data-stu-id="6b645-137">Public Load Balancer</span></span> |<span data-ttu-id="6b645-138">Standard Load Balancer reports the number of outbound flows that are masqueraded to the Public IP address front end.</span><span class="sxs-lookup"><span data-stu-id="6b645-138">Standard Load Balancer reports the number of outbound flows that are masqueraded to the Public IP address front end.</span></span> <span data-ttu-id="6b645-139">Source network address translation (SNAT) ports are an exhaustible resource.</span><span class="sxs-lookup"><span data-stu-id="6b645-139">Source network address translation (SNAT) ports are an exhaustible resource.</span></span> <span data-ttu-id="6b645-140">This metric can give an indication of how heavily your application is relying on SNAT for outbound originated flows.</span><span class="sxs-lookup"><span data-stu-id="6b645-140">This metric can give an indication of how heavily your application is relying on SNAT for outbound originated flows.</span></span> <span data-ttu-id="6b645-141">Counters for successful and failed outbound SNAT flows are reported and can be used to troubleshoot and understand the health of your outbound flows.</span><span class="sxs-lookup"><span data-stu-id="6b645-141">Counters for successful and failed outbound SNAT flows are reported and can be used to troubleshoot and understand the health of your outbound flows.</span></span>| <span data-ttu-id="6b645-142">Average</span><span class="sxs-lookup"><span data-stu-id="6b645-142">Average</span></span> |
| <span data-ttu-id="6b645-143">Byte counters</span><span class="sxs-lookup"><span data-stu-id="6b645-143">Byte counters</span></span> |  <span data-ttu-id="6b645-144">Public and internal load balancer</span><span class="sxs-lookup"><span data-stu-id="6b645-144">Public and internal load balancer</span></span> | <span data-ttu-id="6b645-145">Standard Load Balancer reports the data processed per front end.</span><span class="sxs-lookup"><span data-stu-id="6b645-145">Standard Load Balancer reports the data processed per front end.</span></span>| <span data-ttu-id="6b645-146">Average</span><span class="sxs-lookup"><span data-stu-id="6b645-146">Average</span></span> |
| <span data-ttu-id="6b645-147">Packet counters</span><span class="sxs-lookup"><span data-stu-id="6b645-147">Packet counters</span></span> |  <span data-ttu-id="6b645-148">Public and internal load balancer</span><span class="sxs-lookup"><span data-stu-id="6b645-148">Public and internal load balancer</span></span> | <span data-ttu-id="6b645-149">Standard Load Balancer reports the packets processed per front end.</span><span class="sxs-lookup"><span data-stu-id="6b645-149">Standard Load Balancer reports the packets processed per front end.</span></span>| <span data-ttu-id="6b645-150">Average</span><span class="sxs-lookup"><span data-stu-id="6b645-150">Average</span></span> |

### <a name="view-your-load-balancer-metrics-in-the-azure-portal"></a><span data-ttu-id="6b645-151">View your load balancer metrics in the Azure portal</span><span class="sxs-lookup"><span data-stu-id="6b645-151">View your load balancer metrics in the Azure portal</span></span>

<span data-ttu-id="6b645-152">The Azure portal exposes the load balancer metrics via the Metrics (preview) page, which is available on both the load balancer resource page for a particular resource and the Azure Monitor page.</span><span class="sxs-lookup"><span data-stu-id="6b645-152">The Azure portal exposes the load balancer metrics via the Metrics (preview) page, which is available on both the load balancer resource page for a particular resource and the Azure Monitor page.</span></span> 

<span data-ttu-id="6b645-153">To view the metrics for your Standard Load Balancer resources:</span><span class="sxs-lookup"><span data-stu-id="6b645-153">To view the metrics for your Standard Load Balancer resources:</span></span>
1. <span data-ttu-id="6b645-154">Go to the Metrics (preview) page and do either of the following:</span><span class="sxs-lookup"><span data-stu-id="6b645-154">Go to the Metrics (preview) page and do either of the following:</span></span>
   * <span data-ttu-id="6b645-155">On the load balancer resource page, select the metric type in the drop-down list.</span><span class="sxs-lookup"><span data-stu-id="6b645-155">On the load balancer resource page, select the metric type in the drop-down list.</span></span>
   * <span data-ttu-id="6b645-156">On the Azure Monitor page, select the load balancer resource.</span><span class="sxs-lookup"><span data-stu-id="6b645-156">On the Azure Monitor page, select the load balancer resource.</span></span>
2. <span data-ttu-id="6b645-157">Set the appropriate aggregation type.</span><span class="sxs-lookup"><span data-stu-id="6b645-157">Set the appropriate aggregation type.</span></span>
3. <span data-ttu-id="6b645-158">Optionally, configure the required filtering and grouping.</span><span class="sxs-lookup"><span data-stu-id="6b645-158">Optionally, configure the required filtering and grouping.</span></span>

![Metrics preview for Standard Load Balancer](./media/load-balancer-standard-diagnostics/LBMetrics1.png)

<span data-ttu-id="6b645-160">*Figure: DIP availability and health probe status metric for Standard Load Balancer*</span><span class="sxs-lookup"><span data-stu-id="6b645-160">*Figure: DIP availability and health probe status metric for Standard Load Balancer*</span></span>

### <a name="retrieve-multi-dimensional-metrics-programmatically-via-apis"></a><span data-ttu-id="6b645-161">Retrieve multi-dimensional metrics programmatically via APIs</span><span class="sxs-lookup"><span data-stu-id="6b645-161">Retrieve multi-dimensional metrics programmatically via APIs</span></span>

<span data-ttu-id="6b645-162">For API guidance for retrieving multi-dimensional metric definitions and values, see [Azure Monitoring REST API walkthrough](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-rest-api-walkthrough#retrieve-metric-definitions-multi-dimensional-api).</span><span class="sxs-lookup"><span data-stu-id="6b645-162">For API guidance for retrieving multi-dimensional metric definitions and values, see [Azure Monitoring REST API walkthrough](https://docs.microsoft.com/azure/monitoring-and-diagnostics/monitoring-rest-api-walkthrough#retrieve-metric-definitions-multi-dimensional-api).</span></span>

### <a name = "DiagnosticScenarios"></a><span data-ttu-id="6b645-163">Common diagnostic scenarios and recommended views</span><span class="sxs-lookup"><span data-stu-id="6b645-163">Common diagnostic scenarios and recommended views</span></span>

#### <a name="is-the-data-path-up-and-available-for-my-load-balancer-vip"></a><span data-ttu-id="6b645-164">Is the data path up and available for my load balancer VIP?</span><span class="sxs-lookup"><span data-stu-id="6b645-164">Is the data path up and available for my load balancer VIP?</span></span>

<span data-ttu-id="6b645-165">The VIP availability metric describes the health of the data path within the region to the compute host where your VMs are located.</span><span class="sxs-lookup"><span data-stu-id="6b645-165">The VIP availability metric describes the health of the data path within the region to the compute host where your VMs are located.</span></span> <span data-ttu-id="6b645-166">The metric is a reflection of the health of the Azure infrastructure.</span><span class="sxs-lookup"><span data-stu-id="6b645-166">The metric is a reflection of the health of the Azure infrastructure.</span></span> <span data-ttu-id="6b645-167">You can use the metric to:</span><span class="sxs-lookup"><span data-stu-id="6b645-167">You can use the metric to:</span></span>
- <span data-ttu-id="6b645-168">Monitor the external availability of your service</span><span class="sxs-lookup"><span data-stu-id="6b645-168">Monitor the external availability of your service</span></span>
- <span data-ttu-id="6b645-169">Dig deeper and understand whether the platform on which your service is deployed is healthy or whether your guest OS or application instance is healthy.</span><span class="sxs-lookup"><span data-stu-id="6b645-169">Dig deeper and understand whether the platform on which your service is deployed is healthy or whether your guest OS or application instance is healthy.</span></span>
- <span data-ttu-id="6b645-170">Isolate whether an event is related to your service or the underlying data plane.</span><span class="sxs-lookup"><span data-stu-id="6b645-170">Isolate whether an event is related to your service or the underlying data plane.</span></span> <span data-ttu-id="6b645-171">Do not confuse this metric with the health probe status ("DIP availability").</span><span class="sxs-lookup"><span data-stu-id="6b645-171">Do not confuse this metric with the health probe status ("DIP availability").</span></span>

<span data-ttu-id="6b645-172">To get the VIP availability for your Standard Load Balancer resources:</span><span class="sxs-lookup"><span data-stu-id="6b645-172">To get the VIP availability for your Standard Load Balancer resources:</span></span>
1. <span data-ttu-id="6b645-173">Make sure the correct load balancer resource is selected.</span><span class="sxs-lookup"><span data-stu-id="6b645-173">Make sure the correct load balancer resource is selected.</span></span> 
2. <span data-ttu-id="6b645-174">In the **Metric** drop-down list, select **VIP Availability**.</span><span class="sxs-lookup"><span data-stu-id="6b645-174">In the **Metric** drop-down list, select **VIP Availability**.</span></span> 
3. <span data-ttu-id="6b645-175">In the **Aggregation** drop-down list, select **Avg**.</span><span class="sxs-lookup"><span data-stu-id="6b645-175">In the **Aggregation** drop-down list, select **Avg**.</span></span> 
4. <span data-ttu-id="6b645-176">Additionally, add a filter on the VIP address or VIP port as the dimension with the required front-end IP address or front-end port, and then group them by the selected dimension.</span><span class="sxs-lookup"><span data-stu-id="6b645-176">Additionally, add a filter on the VIP address or VIP port as the dimension with the required front-end IP address or front-end port, and then group them by the selected dimension.</span></span>

![VIP probing](./media/load-balancer-standard-diagnostics/LBMetrics-VIPProbing.png)

<span data-ttu-id="6b645-178">*Figure: Load Balancer VIP probing details*</span><span class="sxs-lookup"><span data-stu-id="6b645-178">*Figure: Load Balancer VIP probing details*</span></span>

<span data-ttu-id="6b645-179">The metric is generated by an active, in-band measurement.</span><span class="sxs-lookup"><span data-stu-id="6b645-179">The metric is generated by an active, in-band measurement.</span></span> <span data-ttu-id="6b645-180">A probing service within the region originates traffic for the measurement.</span><span class="sxs-lookup"><span data-stu-id="6b645-180">A probing service within the region originates traffic for the measurement.</span></span> <span data-ttu-id="6b645-181">The service is activated as soon as you create a deployment with a public front end, and it continues until you remove the front end.</span><span class="sxs-lookup"><span data-stu-id="6b645-181">The service is activated as soon as you create a deployment with a public front end, and it continues until you remove the front end.</span></span> 

>[!NOTE]
><span data-ttu-id="6b645-182">Internal front ends are not supported at this time.</span><span class="sxs-lookup"><span data-stu-id="6b645-182">Internal front ends are not supported at this time.</span></span> 

<span data-ttu-id="6b645-183">A packet matching your deployment's front end and rule is generated periodically.</span><span class="sxs-lookup"><span data-stu-id="6b645-183">A packet matching your deployment's front end and rule is generated periodically.</span></span> <span data-ttu-id="6b645-184">It traverses the region from the source to the host where a VM in the back-end pool is located.</span><span class="sxs-lookup"><span data-stu-id="6b645-184">It traverses the region from the source to the host where a VM in the back-end pool is located.</span></span> <span data-ttu-id="6b645-185">The load balancer infrastructure performs the same load balancing and translation operations as it does for all other traffic.</span><span class="sxs-lookup"><span data-stu-id="6b645-185">The load balancer infrastructure performs the same load balancing and translation operations as it does for all other traffic.</span></span> <span data-ttu-id="6b645-186">This probe is in-band on your load-balanced endpoint.</span><span class="sxs-lookup"><span data-stu-id="6b645-186">This probe is in-band on your load-balanced endpoint.</span></span> <span data-ttu-id="6b645-187">After the probe arrives on the compute host, where a healthy VM in the back-end pool is located, the compute host generates a response to the probing service.</span><span class="sxs-lookup"><span data-stu-id="6b645-187">After the probe arrives on the compute host, where a healthy VM in the back-end pool is located, the compute host generates a response to the probing service.</span></span> <span data-ttu-id="6b645-188">Your VM does not see this traffic.</span><span class="sxs-lookup"><span data-stu-id="6b645-188">Your VM does not see this traffic.</span></span>

<span data-ttu-id="6b645-189">VIP availability fails for the following reasons:</span><span class="sxs-lookup"><span data-stu-id="6b645-189">VIP availability fails for the following reasons:</span></span>
- <span data-ttu-id="6b645-190">Your deployment has no healthy VMs remaining in the back-end pool.</span><span class="sxs-lookup"><span data-stu-id="6b645-190">Your deployment has no healthy VMs remaining in the back-end pool.</span></span> 
- <span data-ttu-id="6b645-191">An infrastructure outage has occurred.</span><span class="sxs-lookup"><span data-stu-id="6b645-191">An infrastructure outage has occurred.</span></span>

<span data-ttu-id="6b645-192">For diagnostic purposes, you can use the [VIP availability metric together with the health probe status](#vipavailabilityandhealthprobes).</span><span class="sxs-lookup"><span data-stu-id="6b645-192">For diagnostic purposes, you can use the [VIP availability metric together with the health probe status](#vipavailabilityandhealthprobes).</span></span>

<span data-ttu-id="6b645-193">Use **Average** as the aggregation for most scenarios.</span><span class="sxs-lookup"><span data-stu-id="6b645-193">Use **Average** as the aggregation for most scenarios.</span></span>

#### <a name="are-the-back-end-instances-for-my-vip-responding-to-probes"></a><span data-ttu-id="6b645-194">Are the back-end instances for my VIP responding to probes?</span><span class="sxs-lookup"><span data-stu-id="6b645-194">Are the back-end instances for my VIP responding to probes?</span></span>

<span data-ttu-id="6b645-195">The health probe status metric describes the health of your application deployment as configured by you when you configure the health probe of your load balancer.</span><span class="sxs-lookup"><span data-stu-id="6b645-195">The health probe status metric describes the health of your application deployment as configured by you when you configure the health probe of your load balancer.</span></span> <span data-ttu-id="6b645-196">The load balancer uses the status of the health probe to determine where to send new flows.</span><span class="sxs-lookup"><span data-stu-id="6b645-196">The load balancer uses the status of the health probe to determine where to send new flows.</span></span> <span data-ttu-id="6b645-197">Health probes originate from an Azure infrastructure address and are visible within the guest OS of the VM.</span><span class="sxs-lookup"><span data-stu-id="6b645-197">Health probes originate from an Azure infrastructure address and are visible within the guest OS of the VM.</span></span>

<span data-ttu-id="6b645-198">To get the DIP availability for your Standard Load Balancer resources:</span><span class="sxs-lookup"><span data-stu-id="6b645-198">To get the DIP availability for your Standard Load Balancer resources:</span></span>
1. <span data-ttu-id="6b645-199">Select the **DIP Availability** metric with **Avg** aggregation type.</span><span class="sxs-lookup"><span data-stu-id="6b645-199">Select the **DIP Availability** metric with **Avg** aggregation type.</span></span> 
2. <span data-ttu-id="6b645-200">Apply a filter on the required VIP IP address or port (or both).</span><span class="sxs-lookup"><span data-stu-id="6b645-200">Apply a filter on the required VIP IP address or port (or both).</span></span>

![DIP availability](./media/load-balancer-standard-diagnostics/LBMetrics-DIPAvailability.png)

<span data-ttu-id="6b645-202">*Figure: Load Balancer VIP availability*</span><span class="sxs-lookup"><span data-stu-id="6b645-202">*Figure: Load Balancer VIP availability*</span></span>

<span data-ttu-id="6b645-203">Health probes fail for the following reasons:</span><span class="sxs-lookup"><span data-stu-id="6b645-203">Health probes fail for the following reasons:</span></span>
- <span data-ttu-id="6b645-204">You configure a health probe to a port that is not listening or not responding or is using the wrong protocol.</span><span class="sxs-lookup"><span data-stu-id="6b645-204">You configure a health probe to a port that is not listening or not responding or is using the wrong protocol.</span></span> <span data-ttu-id="6b645-205">If your service is using direct server return (DSR, or floating IP) rules, make sure that the service is listening on the IP address of the NIC's IP configuration and not just on the loopback that's configured with the front-end IP address.</span><span class="sxs-lookup"><span data-stu-id="6b645-205">If your service is using direct server return (DSR, or floating IP) rules, make sure that the service is listening on the IP address of the NIC's IP configuration and not just on the loopback that's configured with the front-end IP address.</span></span>
- <span data-ttu-id="6b645-206">Your probe is not permitted by the Network Security Group, the VM's guest OS firewall, or the application layer filters.</span><span class="sxs-lookup"><span data-stu-id="6b645-206">Your probe is not permitted by the Network Security Group, the VM's guest OS firewall, or the application layer filters.</span></span>

<span data-ttu-id="6b645-207">Use **Average** as the aggregation for most scenarios.</span><span class="sxs-lookup"><span data-stu-id="6b645-207">Use **Average** as the aggregation for most scenarios.</span></span>

#### <a name="how-do-i-check-my-outbound-connection-statistics"></a><span data-ttu-id="6b645-208">How do I check my outbound connection statistics?</span><span class="sxs-lookup"><span data-stu-id="6b645-208">How do I check my outbound connection statistics?</span></span> 

<span data-ttu-id="6b645-209">The SNAT connections metric describes the volume of successful and failed connections for [outbound flows](https://aka.ms/lboutbound).</span><span class="sxs-lookup"><span data-stu-id="6b645-209">The SNAT connections metric describes the volume of successful and failed connections for [outbound flows](https://aka.ms/lboutbound).</span></span>

<span data-ttu-id="6b645-210">A failed connections volume of greater than zero indicates SNAT port exhaustion.</span><span class="sxs-lookup"><span data-stu-id="6b645-210">A failed connections volume of greater than zero indicates SNAT port exhaustion.</span></span> <span data-ttu-id="6b645-211">You must investigate further to determine what may be causing these failures.</span><span class="sxs-lookup"><span data-stu-id="6b645-211">You must investigate further to determine what may be causing these failures.</span></span> <span data-ttu-id="6b645-212">SNAT port exhaustion manifests as a failure to establish an [outbound flow](https://aka.ms/lboutbound).</span><span class="sxs-lookup"><span data-stu-id="6b645-212">SNAT port exhaustion manifests as a failure to establish an [outbound flow](https://aka.ms/lboutbound).</span></span> <span data-ttu-id="6b645-213">Review the article about outbound connections to understand the scenarios and mechanisms at work, and to learn how to mitigate and design to avoid SNAT port exhaustion.</span><span class="sxs-lookup"><span data-stu-id="6b645-213">Review the article about outbound connections to understand the scenarios and mechanisms at work, and to learn how to mitigate and design to avoid SNAT port exhaustion.</span></span> 

<span data-ttu-id="6b645-214">To get SNAT connection statistics:</span><span class="sxs-lookup"><span data-stu-id="6b645-214">To get SNAT connection statistics:</span></span>
1. <span data-ttu-id="6b645-215">Select **SNAT Connections** metric type and **Sum** as aggregation.</span><span class="sxs-lookup"><span data-stu-id="6b645-215">Select **SNAT Connections** metric type and **Sum** as aggregation.</span></span> 
2. <span data-ttu-id="6b645-216">Group by **Connection State** for successful and failed SNAT connection counts that are represented by different lines.</span><span class="sxs-lookup"><span data-stu-id="6b645-216">Group by **Connection State** for successful and failed SNAT connection counts that are represented by different lines.</span></span> 

![SNAT connection](./media/load-balancer-standard-diagnostics/LBMetrics-SNATConnection.png)

<span data-ttu-id="6b645-218">*Figure: Load Balancer SNAT connection count*</span><span class="sxs-lookup"><span data-stu-id="6b645-218">*Figure: Load Balancer SNAT connection count*</span></span>


#### <a name="how-do-i-check-inboundoutbound-connection-attempts-for-my-service"></a><span data-ttu-id="6b645-219">How do I check inbound/outbound connection attempts for my service?</span><span class="sxs-lookup"><span data-stu-id="6b645-219">How do I check inbound/outbound connection attempts for my service?</span></span>

<span data-ttu-id="6b645-220">A SYN packets metric describes the volume of TCP SYN packets, which have arrived or were sent (for [outbound flows](https://aka.ms/lboutbound)) that are associated with a specific front end.</span><span class="sxs-lookup"><span data-stu-id="6b645-220">A SYN packets metric describes the volume of TCP SYN packets, which have arrived or were sent (for [outbound flows](https://aka.ms/lboutbound)) that are associated with a specific front end.</span></span> <span data-ttu-id="6b645-221">You can use this metric to understand TCP connection attempts to your service.</span><span class="sxs-lookup"><span data-stu-id="6b645-221">You can use this metric to understand TCP connection attempts to your service.</span></span>

<span data-ttu-id="6b645-222">Use **Total** as the aggregation for most scenarios.</span><span class="sxs-lookup"><span data-stu-id="6b645-222">Use **Total** as the aggregation for most scenarios.</span></span>

![SYN connection](./media/load-balancer-standard-diagnostics/LBMetrics-SYNCount.png)

<span data-ttu-id="6b645-224">*Figure: Load Balancer SYN count*</span><span class="sxs-lookup"><span data-stu-id="6b645-224">*Figure: Load Balancer SYN count*</span></span>


#### <a name="how-do-i-check-my-network-bandwidth-consumption"></a><span data-ttu-id="6b645-225">How do I check my network bandwidth consumption?</span><span class="sxs-lookup"><span data-stu-id="6b645-225">How do I check my network bandwidth consumption?</span></span> 

<span data-ttu-id="6b645-226">The bytes and packet counters metric describes the volume of bytes and packets that are sent or received by your service on a per-front-end basis.</span><span class="sxs-lookup"><span data-stu-id="6b645-226">The bytes and packet counters metric describes the volume of bytes and packets that are sent or received by your service on a per-front-end basis.</span></span>

<span data-ttu-id="6b645-227">Use **Total** as the aggregation for most scenarios.</span><span class="sxs-lookup"><span data-stu-id="6b645-227">Use **Total** as the aggregation for most scenarios.</span></span>

<span data-ttu-id="6b645-228">To get byte or packet count statistics:</span><span class="sxs-lookup"><span data-stu-id="6b645-228">To get byte or packet count statistics:</span></span>
1. <span data-ttu-id="6b645-229">Select the **Bytes Count** and/or **Packet Count** metric type, with **Avg** as the aggregation.</span><span class="sxs-lookup"><span data-stu-id="6b645-229">Select the **Bytes Count** and/or **Packet Count** metric type, with **Avg** as the aggregation.</span></span> 
2. <span data-ttu-id="6b645-230">Do either of the following:</span><span class="sxs-lookup"><span data-stu-id="6b645-230">Do either of the following:</span></span>
   * <span data-ttu-id="6b645-231">Apply a filter on a specific front-end IP, front-end port, back-end IP, or back-end port.</span><span class="sxs-lookup"><span data-stu-id="6b645-231">Apply a filter on a specific front-end IP, front-end port, back-end IP, or back-end port.</span></span>
   * <span data-ttu-id="6b645-232">Get overall statistics for your load balancer resource without any filtering.</span><span class="sxs-lookup"><span data-stu-id="6b645-232">Get overall statistics for your load balancer resource without any filtering.</span></span>

![Byte count](./media/load-balancer-standard-diagnostics/LBMetrics-ByteCount.png)

<span data-ttu-id="6b645-234">*Figure: Load Balancer byte count*</span><span class="sxs-lookup"><span data-stu-id="6b645-234">*Figure: Load Balancer byte count*</span></span>

#### <a name = "vipavailabilityandhealthprobes"></a><span data-ttu-id="6b645-235">How do I diagnose my load balancer deployment?</span><span class="sxs-lookup"><span data-stu-id="6b645-235">How do I diagnose my load balancer deployment?</span></span>

<span data-ttu-id="6b645-236">By using a combination of the VIP availability and health probe metrics on a single chart you can identify where to look for the problem and resolve the problem.</span><span class="sxs-lookup"><span data-stu-id="6b645-236">By using a combination of the VIP availability and health probe metrics on a single chart you can identify where to look for the problem and resolve the problem.</span></span> <span data-ttu-id="6b645-237">You can gain assurance that Azure is working correctly and use this knowledge to conclusively determine that the configuration or application is the root cause.</span><span class="sxs-lookup"><span data-stu-id="6b645-237">You can gain assurance that Azure is working correctly and use this knowledge to conclusively determine that the configuration or application is the root cause.</span></span>

<span data-ttu-id="6b645-238">You can use health probe metrics to understand how Azure views the health of your deployment as per the configuration you have provided.</span><span class="sxs-lookup"><span data-stu-id="6b645-238">You can use health probe metrics to understand how Azure views the health of your deployment as per the configuration you have provided.</span></span> <span data-ttu-id="6b645-239">Looking at health probes is always a great first step in monitoring or determining a cause.</span><span class="sxs-lookup"><span data-stu-id="6b645-239">Looking at health probes is always a great first step in monitoring or determining a cause.</span></span>

<span data-ttu-id="6b645-240">You can take it a step further and use VIP availability metrics to gain insight into how Azure views the health of the underlying data plane that's responsible for your specific deployment.</span><span class="sxs-lookup"><span data-stu-id="6b645-240">You can take it a step further and use VIP availability metrics to gain insight into how Azure views the health of the underlying data plane that's responsible for your specific deployment.</span></span> <span data-ttu-id="6b645-241">When you combine both metrics, you can isolate where the fault might be, as illustrated in this example:</span><span class="sxs-lookup"><span data-stu-id="6b645-241">When you combine both metrics, you can isolate where the fault might be, as illustrated in this example:</span></span>

![VIP diagnostics](./media/load-balancer-standard-diagnostics/LBMetrics-DIPnVIPAvailability.png)

<span data-ttu-id="6b645-243">*Figure: Combining DIP and VIP availability metrics*</span><span class="sxs-lookup"><span data-stu-id="6b645-243">*Figure: Combining DIP and VIP availability metrics*</span></span>

<span data-ttu-id="6b645-244">The chart displays the following information:</span><span class="sxs-lookup"><span data-stu-id="6b645-244">The chart displays the following information:</span></span>
- <span data-ttu-id="6b645-245">The infrastructure itself was healthy, the infrastructure hosting your VMs was reachable, and more than one VM was placed in the back end.</span><span class="sxs-lookup"><span data-stu-id="6b645-245">The infrastructure itself was healthy, the infrastructure hosting your VMs was reachable, and more than one VM was placed in the back end.</span></span> <span data-ttu-id="6b645-246">This information is indicated by the blue trace for VIP availability, which is 100 percent.</span><span class="sxs-lookup"><span data-stu-id="6b645-246">This information is indicated by the blue trace for VIP availability, which is 100 percent.</span></span> 
- <span data-ttu-id="6b645-247">However, the health probe status (DIP availability) is at 0 percent at the beginning of the chart, as indicated by the orange trace.</span><span class="sxs-lookup"><span data-stu-id="6b645-247">However, the health probe status (DIP availability) is at 0 percent at the beginning of the chart, as indicated by the orange trace.</span></span> <span data-ttu-id="6b645-248">The circled area in green highlights where the status (DIP availability) became healthy, and at which point the customer's deployment was able to accept new flows.</span><span class="sxs-lookup"><span data-stu-id="6b645-248">The circled area in green highlights where the status (DIP availability) became healthy, and at which point the customer's deployment was able to accept new flows.</span></span>

<span data-ttu-id="6b645-249">The chart allows customers to troubleshoot the deployment on their own without having to guess or ask support whether other issues are occurring.</span><span class="sxs-lookup"><span data-stu-id="6b645-249">The chart allows customers to troubleshoot the deployment on their own without having to guess or ask support whether other issues are occurring.</span></span> <span data-ttu-id="6b645-250">The service was unavailable because health probes were failing due to either a misconfiguration or a failed application.</span><span class="sxs-lookup"><span data-stu-id="6b645-250">The service was unavailable because health probes were failing due to either a misconfiguration or a failed application.</span></span>

### <a name = "Limitations"></a><span data-ttu-id="6b645-251">Limitations</span><span class="sxs-lookup"><span data-stu-id="6b645-251">Limitations</span></span>

<span data-ttu-id="6b645-252">VIP availability is currently available only for public front ends.</span><span class="sxs-lookup"><span data-stu-id="6b645-252">VIP availability is currently available only for public front ends.</span></span>

## <a name = "ResourceHealth"></a><span data-ttu-id="6b645-253">Resource health status</span><span class="sxs-lookup"><span data-stu-id="6b645-253">Resource health status</span></span>

<span data-ttu-id="6b645-254">Health status for the Standard Load Balancer resources is exposed via the existing **Resource health** under **Monitor > Service Health**.</span><span class="sxs-lookup"><span data-stu-id="6b645-254">Health status for the Standard Load Balancer resources is exposed via the existing **Resource health** under **Monitor > Service Health**.</span></span>

>[!NOTE]
><span data-ttu-id="6b645-255">Resource health status for Load Balancer is currently available for public configuration of Standard Load Balancer only.</span><span class="sxs-lookup"><span data-stu-id="6b645-255">Resource health status for Load Balancer is currently available for public configuration of Standard Load Balancer only.</span></span> <span data-ttu-id="6b645-256">Internal load balancer resources or Basic SKUs of Load Balancer resources do not expose resource health.</span><span class="sxs-lookup"><span data-stu-id="6b645-256">Internal load balancer resources or Basic SKUs of Load Balancer resources do not expose resource health.</span></span>

<span data-ttu-id="6b645-257">To view the health of your public Standard Load Balancer resources:</span><span class="sxs-lookup"><span data-stu-id="6b645-257">To view the health of your public Standard Load Balancer resources:</span></span>
1. <span data-ttu-id="6b645-258">Select  **Monitor** > **Service Health**.</span><span class="sxs-lookup"><span data-stu-id="6b645-258">Select  **Monitor** > **Service Health**.</span></span>

   ![Monitor page](./media/load-balancer-standard-diagnostics/LBHealth1.png)

   <span data-ttu-id="6b645-260">*Figure: The Service Health link on Azure Monitor*</span><span class="sxs-lookup"><span data-stu-id="6b645-260">*Figure: The Service Health link on Azure Monitor*</span></span>

2. <span data-ttu-id="6b645-261">Select **Resource Health**, and then make sure that **Subscription ID** and **Resource Type = Load Balancer** are selected.</span><span class="sxs-lookup"><span data-stu-id="6b645-261">Select **Resource Health**, and then make sure that **Subscription ID** and **Resource Type = Load Balancer** are selected.</span></span>

   ![Resource health status](./media/load-balancer-standard-diagnostics/LBHealth3.png)

   <span data-ttu-id="6b645-263">*Figure: Select resource for health view*</span><span class="sxs-lookup"><span data-stu-id="6b645-263">*Figure: Select resource for health view*</span></span>

3. <span data-ttu-id="6b645-264">In the list, select the Load Balancer resource to view its historical health status.</span><span class="sxs-lookup"><span data-stu-id="6b645-264">In the list, select the Load Balancer resource to view its historical health status.</span></span>

    ![Load Balancer health status](./media/load-balancer-standard-diagnostics/LBHealth4.png)

   <span data-ttu-id="6b645-266">*Figure: Load Balancer resource health view*</span><span class="sxs-lookup"><span data-stu-id="6b645-266">*Figure: Load Balancer resource health view*</span></span>
 
<span data-ttu-id="6b645-267">The various resource health statuses and their descriptions are listed in the following table:</span><span class="sxs-lookup"><span data-stu-id="6b645-267">The various resource health statuses and their descriptions are listed in the following table:</span></span> 

| <span data-ttu-id="6b645-268">Resource health status</span><span class="sxs-lookup"><span data-stu-id="6b645-268">Resource health status</span></span> | <span data-ttu-id="6b645-269">Description</span><span class="sxs-lookup"><span data-stu-id="6b645-269">Description</span></span> |
| --- | --- |
| <span data-ttu-id="6b645-270">Available</span><span class="sxs-lookup"><span data-stu-id="6b645-270">Available</span></span> | <span data-ttu-id="6b645-271">Your public standard load balancer resource is healthy and available.</span><span class="sxs-lookup"><span data-stu-id="6b645-271">Your public standard load balancer resource is healthy and available.</span></span> |
| <span data-ttu-id="6b645-272">Unavailable</span><span class="sxs-lookup"><span data-stu-id="6b645-272">Unavailable</span></span> | <span data-ttu-id="6b645-273">Your public standard load balancer resource is not healthy.</span><span class="sxs-lookup"><span data-stu-id="6b645-273">Your public standard load balancer resource is not healthy.</span></span> <span data-ttu-id="6b645-274">Diagnose the health by selecting **Azure Monitor** > **Metrics**.</span><span class="sxs-lookup"><span data-stu-id="6b645-274">Diagnose the health by selecting **Azure Monitor** > **Metrics**.</span></span><br><span data-ttu-id="6b645-275">(*Unavailable* status might also mean that the resource is not connected with your public standard load balancer.)</span><span class="sxs-lookup"><span data-stu-id="6b645-275">(*Unavailable* status might also mean that the resource is not connected with your public standard load balancer.)</span></span> |
| <span data-ttu-id="6b645-276">Unknown</span><span class="sxs-lookup"><span data-stu-id="6b645-276">Unknown</span></span> | <span data-ttu-id="6b645-277">Resource health status for your public standard load balancer resource has not been updated yet.</span><span class="sxs-lookup"><span data-stu-id="6b645-277">Resource health status for your public standard load balancer resource has not been updated yet.</span></span><br><span data-ttu-id="6b645-278">(*Unknown* status might also mean that the resource is not connected with your public standard load balancer.)</span><span class="sxs-lookup"><span data-stu-id="6b645-278">(*Unknown* status might also mean that the resource is not connected with your public standard load balancer.)</span></span>  |

## <a name="next-steps"></a><span data-ttu-id="6b645-279">Next steps</span><span class="sxs-lookup"><span data-stu-id="6b645-279">Next steps</span></span>

- <span data-ttu-id="6b645-280">Learn more about [Standard Load Balancer](load-balancer-standard-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6b645-280">Learn more about [Standard Load Balancer](load-balancer-standard-overview.md).</span></span>
- <span data-ttu-id="6b645-281">Learn more about your [Load balancer outbound connectivity](https://aka.ms/lboutbound).</span><span class="sxs-lookup"><span data-stu-id="6b645-281">Learn more about your [Load balancer outbound connectivity](https://aka.ms/lboutbound).</span></span>
- <span data-ttu-id="6b645-282">Learn about the [Azure Monitor Metrics REST API](https://docs.microsoft.com/rest/api/monitor/metrics/).</span><span class="sxs-lookup"><span data-stu-id="6b645-282">Learn about the [Azure Monitor Metrics REST API](https://docs.microsoft.com/rest/api/monitor/metrics/).</span></span>


