---
title: Troubleshoot common Azure Kubernetes Service problems
description: Learn how to troubleshoot and resolve common problems when using Azure Kubernetes Service (AKS)
services: container-service
author: sauryadas
ms.service: container-service
ms.topic: troubleshooting
ms.date: 08/13/2018
ms.author: saudas
ms.openlocfilehash: 9f082c5f198ebd7123058bd250d3fef55494d553
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44864854"
---
# <a name="aks-troubleshooting"></a><span data-ttu-id="0c78e-103">AKS troubleshooting</span><span class="sxs-lookup"><span data-stu-id="0c78e-103">AKS troubleshooting</span></span>
<span data-ttu-id="0c78e-104">When you create or manager AKS clusters, you may occasionally encounter issues.</span><span class="sxs-lookup"><span data-stu-id="0c78e-104">When you create or manager AKS clusters, you may occasionally encounter issues.</span></span> <span data-ttu-id="0c78e-105">This article details some common issues and troubleshooting steps.</span><span class="sxs-lookup"><span data-stu-id="0c78e-105">This article details some common issues and troubleshooting steps.</span></span>

### <a name="in-general-where-do-i-find-information-about-debugging-kubernetes-issues"></a><span data-ttu-id="0c78e-106">In general, where do I find information about debugging Kubernetes issues?</span><span class="sxs-lookup"><span data-stu-id="0c78e-106">In general, where do I find information about debugging Kubernetes issues?</span></span>

<span data-ttu-id="0c78e-107">[Here] (https://kubernetes.io/docs/tasks/debug-application-cluster/troubleshooting/) is an official link to troubleshooting kubernetes clusters.</span><span class="sxs-lookup"><span data-stu-id="0c78e-107">[Here] (https://kubernetes.io/docs/tasks/debug-application-cluster/troubleshooting/) is an official link to troubleshooting kubernetes clusters.</span></span>
<span data-ttu-id="0c78e-108">[Here](https://github.com/feiskyer/kubernetes-handbook/blob/master/en/troubleshooting/index.md) is a link to a troubleshooting guide published by a Microsoft engineer around troubleshooting pods, nodes, clusters, etc.</span><span class="sxs-lookup"><span data-stu-id="0c78e-108">[Here](https://github.com/feiskyer/kubernetes-handbook/blob/master/en/troubleshooting/index.md) is a link to a troubleshooting guide published by a Microsoft engineer around troubleshooting pods, nodes, clusters, etc.</span></span>

### <a name="i-am-getting-a-quota-exceeded-error-during-create-or-upgrade-what-should-i-do"></a><span data-ttu-id="0c78e-109">I am getting a quota exceeded error during create or upgrade.</span><span class="sxs-lookup"><span data-stu-id="0c78e-109">I am getting a quota exceeded error during create or upgrade.</span></span> <span data-ttu-id="0c78e-110">What should I do?</span><span class="sxs-lookup"><span data-stu-id="0c78e-110">What should I do?</span></span> 

<span data-ttu-id="0c78e-111">You will need to request cores [here](https://docs.microsoft.com/azure/azure-supportability/resource-manager-core-quotas-request).</span><span class="sxs-lookup"><span data-stu-id="0c78e-111">You will need to request cores [here](https://docs.microsoft.com/azure/azure-supportability/resource-manager-core-quotas-request).</span></span>

### <a name="what-is-the-max-pods-per-node-setting-for-aks"></a><span data-ttu-id="0c78e-112">What is the max pods per node setting for AKS?</span><span class="sxs-lookup"><span data-stu-id="0c78e-112">What is the max pods per node setting for AKS?</span></span>

<span data-ttu-id="0c78e-113">The max pods per node are set to 30 by default if you deploy an AKS cluster in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="0c78e-113">The max pods per node are set to 30 by default if you deploy an AKS cluster in the Azure portal.</span></span>
<span data-ttu-id="0c78e-114">The max pods per node are set to 110 by default if you deploy an AKS cluster in the Azure CLI.</span><span class="sxs-lookup"><span data-stu-id="0c78e-114">The max pods per node are set to 110 by default if you deploy an AKS cluster in the Azure CLI.</span></span> <span data-ttu-id="0c78e-115">(Ensure you are using the latest version of the Azure CLI).</span><span class="sxs-lookup"><span data-stu-id="0c78e-115">(Ensure you are using the latest version of the Azure CLI).</span></span> <span data-ttu-id="0c78e-116">This default setting can be changed using the –max-nodes-per-pod flag in the az aks create command.</span><span class="sxs-lookup"><span data-stu-id="0c78e-116">This default setting can be changed using the –max-nodes-per-pod flag in the az aks create command.</span></span>

### <a name="i-am-getting-insufficientsubnetsize-error-while-deploying-an-aks-cluster-with-advanced-networking-what-should-i-do"></a><span data-ttu-id="0c78e-117">I am getting “insufficientSubnetSize” error while deploying an AKS cluster with Advanced networking.</span><span class="sxs-lookup"><span data-stu-id="0c78e-117">I am getting “insufficientSubnetSize” error while deploying an AKS cluster with Advanced networking.</span></span> <span data-ttu-id="0c78e-118">What should I do?</span><span class="sxs-lookup"><span data-stu-id="0c78e-118">What should I do?</span></span>

<span data-ttu-id="0c78e-119">In Custom VNET option selected for networking during AKS creates, the Azure CNI is used for IPAM.</span><span class="sxs-lookup"><span data-stu-id="0c78e-119">In Custom VNET option selected for networking during AKS creates, the Azure CNI is used for IPAM.</span></span> <span data-ttu-id="0c78e-120">The number of nodes in an AKS cluster can be anywhere between 1 and 100.</span><span class="sxs-lookup"><span data-stu-id="0c78e-120">The number of nodes in an AKS cluster can be anywhere between 1 and 100.</span></span> <span data-ttu-id="0c78e-121">Based upon 2) above the subnet size should be greater than product of the number of nodes and the max pod per node Subnet size > no of nodes in the cluster \* max pods per node.</span><span class="sxs-lookup"><span data-stu-id="0c78e-121">Based upon 2) above the subnet size should be greater than product of the number of nodes and the max pod per node Subnet size > no of nodes in the cluster \* max pods per node.</span></span>

### <a name="my-pod-is-stuck-in-crashloopbackoff-mode-what-should-i-do"></a><span data-ttu-id="0c78e-122">My pod is stuck in ‘CrashLoopBackOff’ mode.</span><span class="sxs-lookup"><span data-stu-id="0c78e-122">My pod is stuck in ‘CrashLoopBackOff’ mode.</span></span> <span data-ttu-id="0c78e-123">What should I do?</span><span class="sxs-lookup"><span data-stu-id="0c78e-123">What should I do?</span></span>

<span data-ttu-id="0c78e-124">There might be various reasons for the pod being stuck in that mode.</span><span class="sxs-lookup"><span data-stu-id="0c78e-124">There might be various reasons for the pod being stuck in that mode.</span></span> <span data-ttu-id="0c78e-125">You might want to look into the</span><span class="sxs-lookup"><span data-stu-id="0c78e-125">You might want to look into the</span></span> 
* <span data-ttu-id="0c78e-126">The pod itself using `kubectl describe pod <pod-name>`</span><span class="sxs-lookup"><span data-stu-id="0c78e-126">The pod itself using `kubectl describe pod <pod-name>`</span></span>
* <span data-ttu-id="0c78e-127">The logs using  `kubectl log <pod-name>`</span><span class="sxs-lookup"><span data-stu-id="0c78e-127">The logs using  `kubectl log <pod-name>`</span></span>

### <a name="i-am-trying-to-enable-rbac-on-an-existing-cluster-can-you-tell-me-how-i-can-do-that"></a><span data-ttu-id="0c78e-128">I am trying to enable RBAC on an existing cluster.</span><span class="sxs-lookup"><span data-stu-id="0c78e-128">I am trying to enable RBAC on an existing cluster.</span></span> <span data-ttu-id="0c78e-129">Can you tell me how I can do that?</span><span class="sxs-lookup"><span data-stu-id="0c78e-129">Can you tell me how I can do that?</span></span>

<span data-ttu-id="0c78e-130">Unfortunately enabling RBAC on existing clusters is not supported at this time.</span><span class="sxs-lookup"><span data-stu-id="0c78e-130">Unfortunately enabling RBAC on existing clusters is not supported at this time.</span></span> <span data-ttu-id="0c78e-131">You will need to explicitly create new clusters.</span><span class="sxs-lookup"><span data-stu-id="0c78e-131">You will need to explicitly create new clusters.</span></span> <span data-ttu-id="0c78e-132">If you use the CLI, RBAC is enabled by default whereas a toggle button to enable it is available in the AKS portal create workflow.</span><span class="sxs-lookup"><span data-stu-id="0c78e-132">If you use the CLI, RBAC is enabled by default whereas a toggle button to enable it is available in the AKS portal create workflow.</span></span>

### <a name="i-created-a-cluster-using-the-azure-cli-with-defaults-or-the-azure-portal-with-rbac-enabled-and-numerous-warnings-in-the-kubernetes-dashboard-the-dashboard-used-to-work-before-without-any-warnings-what-should-i-do"></a><span data-ttu-id="0c78e-133">I created a cluster using the Azure CLI with defaults or the Azure portal with RBAC enabled and numerous warnings in the kubernetes dashboard.</span><span class="sxs-lookup"><span data-stu-id="0c78e-133">I created a cluster using the Azure CLI with defaults or the Azure portal with RBAC enabled and numerous warnings in the kubernetes dashboard.</span></span> <span data-ttu-id="0c78e-134">The dashboard used to work before without any warnings.</span><span class="sxs-lookup"><span data-stu-id="0c78e-134">The dashboard used to work before without any warnings.</span></span> <span data-ttu-id="0c78e-135">What should I do?</span><span class="sxs-lookup"><span data-stu-id="0c78e-135">What should I do?</span></span>

<span data-ttu-id="0c78e-136">The reason for getting warnings on the dashboard is that now it is enabled with RBAC'ed and access to it has been disabled by default.</span><span class="sxs-lookup"><span data-stu-id="0c78e-136">The reason for getting warnings on the dashboard is that now it is enabled with RBAC'ed and access to it has been disabled by default.</span></span> <span data-ttu-id="0c78e-137">In general, this approach is considered good practice since the default exposure of the dashboard to all users of the cluster can lead to security threats.</span><span class="sxs-lookup"><span data-stu-id="0c78e-137">In general, this approach is considered good practice since the default exposure of the dashboard to all users of the cluster can lead to security threats.</span></span> <span data-ttu-id="0c78e-138">If you still want to enable the dashboard, follow this [blog](https://pascalnaber.wordpress.com/2018/06/17/access-dashboard-on-aks-with-rbac-enabled/) to enable it.</span><span class="sxs-lookup"><span data-stu-id="0c78e-138">If you still want to enable the dashboard, follow this [blog](https://pascalnaber.wordpress.com/2018/06/17/access-dashboard-on-aks-with-rbac-enabled/) to enable it.</span></span>

### <a name="i-cant-seem-to-connect-to-the-dashboard-what-should-i-do"></a><span data-ttu-id="0c78e-139">I can’t seem to connect to the dashboard.</span><span class="sxs-lookup"><span data-stu-id="0c78e-139">I can’t seem to connect to the dashboard.</span></span> <span data-ttu-id="0c78e-140">What should I do?</span><span class="sxs-lookup"><span data-stu-id="0c78e-140">What should I do?</span></span>

<span data-ttu-id="0c78e-141">The easiest way to access your service outside the cluster is to run kubectl proxy, which will proxy requests to your localhost port 8001 to the Kubernetes API server.</span><span class="sxs-lookup"><span data-stu-id="0c78e-141">The easiest way to access your service outside the cluster is to run kubectl proxy, which will proxy requests to your localhost port 8001 to the Kubernetes API server.</span></span> <span data-ttu-id="0c78e-142">From there, the apiserver can proxy to your service: http://localhost:8001/api/v1/namespaces/kube-system/services/kubernetes-dashboard/proxy/#!/node?namespace=default</span><span class="sxs-lookup"><span data-stu-id="0c78e-142">From there, the apiserver can proxy to your service: http://localhost:8001/api/v1/namespaces/kube-system/services/kubernetes-dashboard/proxy/#!/node?namespace=default</span></span>

<span data-ttu-id="0c78e-143">If you don’t see the kubernetes dashboard, then check if the kube-proxy pod is running in the kube-system namespace.</span><span class="sxs-lookup"><span data-stu-id="0c78e-143">If you don’t see the kubernetes dashboard, then check if the kube-proxy pod is running in the kube-system namespace.</span></span> <span data-ttu-id="0c78e-144">If it is not in running state, delete the pod and it will restart.</span><span class="sxs-lookup"><span data-stu-id="0c78e-144">If it is not in running state, delete the pod and it will restart.</span></span>

### <a name="i-could-not-get-logs-using-kubectl-logs-or-cannot-connect-to-the-api-server-getting-the-error-from-server-error-dialing-backend-dial-tcp-what-should-i-do"></a><span data-ttu-id="0c78e-145">I could not get logs using Kubectl logs or cannot connect to the api server getting the “Error from server: error dialing backend: dial tcp…”.</span><span class="sxs-lookup"><span data-stu-id="0c78e-145">I could not get logs using Kubectl logs or cannot connect to the api server getting the “Error from server: error dialing backend: dial tcp…”.</span></span> <span data-ttu-id="0c78e-146">What should I do?</span><span class="sxs-lookup"><span data-stu-id="0c78e-146">What should I do?</span></span>

<span data-ttu-id="0c78e-147">Make sure that the default NSG is not modified and port 22 is open for connection to the API server.</span><span class="sxs-lookup"><span data-stu-id="0c78e-147">Make sure that the default NSG is not modified and port 22 is open for connection to the API server.</span></span> <span data-ttu-id="0c78e-148">Check if the tunnelfront pod is running in the kube-system namespace.</span><span class="sxs-lookup"><span data-stu-id="0c78e-148">Check if the tunnelfront pod is running in the kube-system namespace.</span></span> <span data-ttu-id="0c78e-149">If it is not, force delete it and it will restart.</span><span class="sxs-lookup"><span data-stu-id="0c78e-149">If it is not, force delete it and it will restart.</span></span>

### <a name="i-am-trying-to-upgrade-or-scale-and-am-getting-message-changing-property-imagereference-is-not-allowed-error--how-do-i-fix-this-issue"></a><span data-ttu-id="0c78e-150">I am trying to upgrade or scale and am getting "message": "Changing property 'imageReference' is not allowed."</span><span class="sxs-lookup"><span data-stu-id="0c78e-150">I am trying to upgrade or scale and am getting "message": "Changing property 'imageReference' is not allowed."</span></span> <span data-ttu-id="0c78e-151">Error.</span><span class="sxs-lookup"><span data-stu-id="0c78e-151">Error.</span></span>  <span data-ttu-id="0c78e-152">How do I fix this issue?</span><span class="sxs-lookup"><span data-stu-id="0c78e-152">How do I fix this issue?</span></span>

<span data-ttu-id="0c78e-153">It is possible that you are getting this error because you have modified the tags in the agent nodes inside the AKS cluster.</span><span class="sxs-lookup"><span data-stu-id="0c78e-153">It is possible that you are getting this error because you have modified the tags in the agent nodes inside the AKS cluster.</span></span> <span data-ttu-id="0c78e-154">Modifying and deleting tags and other properties of resources in the MC_\* resource group can lead to unexpected results.</span><span class="sxs-lookup"><span data-stu-id="0c78e-154">Modifying and deleting tags and other properties of resources in the MC_\* resource group can lead to unexpected results.</span></span> <span data-ttu-id="0c78e-155">Modifying the resources under the MC_\* in the AKS cluster breaks the SLO.</span><span class="sxs-lookup"><span data-stu-id="0c78e-155">Modifying the resources under the MC_\* in the AKS cluster breaks the SLO.</span></span>


