---
title: Diagnose On-Premises connectivity via VPN gateway with Azure Network Watcher | Microsoft Docs
description: This article describes how to diagnose on-premises connectivity via VPN gateway with Azure Network Watcher resource troubleshooting.
services: network-watcher
documentationcenter: na
author: georgewallace
manager: timlt
editor: ''
ms.assetid: aeffbf3d-fd19-4d61-831d-a7114f7534f9
ms.service: network-watcher
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 02/22/2017
ms.author: gwallace
ms.openlocfilehash: f262d586605701e5af9681a2491a176a1ebd819e
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44662571"
---
# <a name="diagnose-on-premise-connectivity-via-vpn-gateways"></a><span data-ttu-id="ad970-103">Diagnose on-premise connectivity via VPN gateways</span><span class="sxs-lookup"><span data-stu-id="ad970-103">Diagnose on-premise connectivity via VPN gateways</span></span>

<span data-ttu-id="ad970-104">Azure VPN Gateway enables you to create hybrid solution that address the need for a secure connection between your on-premises network and your Azure virtual network.</span><span class="sxs-lookup"><span data-stu-id="ad970-104">Azure VPN Gateway enables you to create hybrid solution that address the need for a secure connection between your on-premises network and your Azure virtual network.</span></span> <span data-ttu-id="ad970-105">As your requirements are unique, so is the choice of on-premises VPN device.</span><span class="sxs-lookup"><span data-stu-id="ad970-105">As your requirements are unique, so is the choice of on-premises VPN device.</span></span> <span data-ttu-id="ad970-106">Azure currently supports [several VPN devices](../vpn-gateway/vpn-gateway-about-vpn-devices.md#a-namedevicetableavalidated-vpn-devices-and-device-configuration-guides) that are constantly validated in partnership with the device vendors.</span><span class="sxs-lookup"><span data-stu-id="ad970-106">Azure currently supports [several VPN devices](../vpn-gateway/vpn-gateway-about-vpn-devices.md#a-namedevicetableavalidated-vpn-devices-and-device-configuration-guides) that are constantly validated in partnership with the device vendors.</span></span> <span data-ttu-id="ad970-107">Review the device-specific configuration settings before configuring your on-premises VPN device.</span><span class="sxs-lookup"><span data-stu-id="ad970-107">Review the device-specific configuration settings before configuring your on-premises VPN device.</span></span> <span data-ttu-id="ad970-108">Similarly, Azure VPN Gateway is configured with a set of [supported IPsec parameters](../vpn-gateway/vpn-gateway-about-vpn-devices.md#a-nameipsecaipsecike-parameters) that are used for establishing connections.</span><span class="sxs-lookup"><span data-stu-id="ad970-108">Similarly, Azure VPN Gateway is configured with a set of [supported IPsec parameters](../vpn-gateway/vpn-gateway-about-vpn-devices.md#a-nameipsecaipsecike-parameters) that are used for establishing connections.</span></span> <span data-ttu-id="ad970-109">Currently there is no way for you to specify or select a specific combination of IPsec parameters from the Azure VPN Gateway.</span><span class="sxs-lookup"><span data-stu-id="ad970-109">Currently there is no way for you to specify or select a specific combination of IPsec parameters from the Azure VPN Gateway.</span></span> <span data-ttu-id="ad970-110">For establishing a successful connection between on-premises and Azure, the on-premises VPN device settings must be in accordance with the IPsec parameters prescribed by Azure VPN Gateway.</span><span class="sxs-lookup"><span data-stu-id="ad970-110">For establishing a successful connection between on-premises and Azure, the on-premises VPN device settings must be in accordance with the IPsec parameters prescribed by Azure VPN Gateway.</span></span> <span data-ttu-id="ad970-111">Failure to do so results in loss of connectivity and until now troubleshooting these issues was not trivial and usually took hours to identify and fix the issue.</span><span class="sxs-lookup"><span data-stu-id="ad970-111">Failure to do so results in loss of connectivity and until now troubleshooting these issues was not trivial and usually took hours to identify and fix the issue.</span></span>

<span data-ttu-id="ad970-112">With the Azure Network Watcher troubleshoot feature, you are able to diagnose any issues with your Gateway and Connections and within minutes have enough information to make an informed decision to rectify the issue.</span><span class="sxs-lookup"><span data-stu-id="ad970-112">With the Azure Network Watcher troubleshoot feature, you are able to diagnose any issues with your Gateway and Connections and within minutes have enough information to make an informed decision to rectify the issue.</span></span>

## <a name="scenario"></a><span data-ttu-id="ad970-113">Scenario</span><span class="sxs-lookup"><span data-stu-id="ad970-113">Scenario</span></span>

<span data-ttu-id="ad970-114">You want to configure a site-to-site connection between Azure and on-premises using Cisco ASA as the on-premises VPN Gateway.</span><span class="sxs-lookup"><span data-stu-id="ad970-114">You want to configure a site-to-site connection between Azure and on-premises using Cisco ASA as the on-premises VPN Gateway.</span></span> <span data-ttu-id="ad970-115">To achieve this scenario, you would require the following setup:</span><span class="sxs-lookup"><span data-stu-id="ad970-115">To achieve this scenario, you would require the following setup:</span></span>

1. <span data-ttu-id="ad970-116">Virtual Network Gateway - The VPN Gateway on Azure</span><span class="sxs-lookup"><span data-stu-id="ad970-116">Virtual Network Gateway - The VPN Gateway on Azure</span></span>
1. <span data-ttu-id="ad970-117">Local Network Gateway - The [on-premises (CISCO ASA) VPN Gateway](../vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md#LocalNetworkGateway) representation in Azure cloud</span><span class="sxs-lookup"><span data-stu-id="ad970-117">Local Network Gateway - The [on-premises (CISCO ASA) VPN Gateway](../vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md#LocalNetworkGateway) representation in Azure cloud</span></span>
1. <span data-ttu-id="ad970-118">Site-to-site connection (policy based) - [Connection between the VPN Gateway and the on-premises CISCO ASA](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md#a-namecreateconnectiona8-create-a-site-to-site-vpn-connection)</span><span class="sxs-lookup"><span data-stu-id="ad970-118">Site-to-site connection (policy based) - [Connection between the VPN Gateway and the on-premises CISCO ASA](https://docs.microsoft.com/en-us/azure/vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md#a-namecreateconnectiona8-create-a-site-to-site-vpn-connection)</span></span>
1. [<span data-ttu-id="ad970-119">Configuring CISCO ASA</span><span class="sxs-lookup"><span data-stu-id="ad970-119">Configuring CISCO ASA</span></span>](https://github.com/Azure/Azure-vpn-config-samples/tree/master/Cisco/Current/ASA)

<span data-ttu-id="ad970-120">Detailed step by step guidance for configuring a Site-to-Site configuration can be found by visiting: [Create a VNet with a Site-to-Site connection using the Azure portal](../vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md).</span><span class="sxs-lookup"><span data-stu-id="ad970-120">Detailed step by step guidance for configuring a Site-to-Site configuration can be found by visiting: [Create a VNet with a Site-to-Site connection using the Azure portal](../vpn-gateway/vpn-gateway-howto-site-to-site-resource-manager-portal.md).</span></span>

<span data-ttu-id="ad970-121">One of the critical configuration steps is configuring the IPsec communication parameters, any misconfiguration leads to loss of connectivity between the on-premises network and Azure.</span><span class="sxs-lookup"><span data-stu-id="ad970-121">One of the critical configuration steps is configuring the IPsec communication parameters, any misconfiguration leads to loss of connectivity between the on-premises network and Azure.</span></span> <span data-ttu-id="ad970-122">Currently Azure VPN Gateways are configured to support the following IPsec parameters for Phase 1.</span><span class="sxs-lookup"><span data-stu-id="ad970-122">Currently Azure VPN Gateways are configured to support the following IPsec parameters for Phase 1.</span></span> <span data-ttu-id="ad970-123">Note, as mentioned earlier these settings cannot be modified.</span><span class="sxs-lookup"><span data-stu-id="ad970-123">Note, as mentioned earlier these settings cannot be modified.</span></span>  <span data-ttu-id="ad970-124">As you can see in the table below, the encryption algorithms supported by Azure VPN Gateway are AES256, AES128, and 3DES.</span><span class="sxs-lookup"><span data-stu-id="ad970-124">As you can see in the table below, the encryption algorithms supported by Azure VPN Gateway are AES256, AES128, and 3DES.</span></span>

### <a name="ike-phase-1-setup"></a><span data-ttu-id="ad970-125">IKE phase 1 setup</span><span class="sxs-lookup"><span data-stu-id="ad970-125">IKE phase 1 setup</span></span>

| <span data-ttu-id="ad970-126">**Property**</span><span class="sxs-lookup"><span data-stu-id="ad970-126">**Property**</span></span> | <span data-ttu-id="ad970-127">**PolicyBased**</span><span class="sxs-lookup"><span data-stu-id="ad970-127">**PolicyBased**</span></span> | <span data-ttu-id="ad970-128">**RouteBased and Standard or High-Performance VPN gateway**</span><span class="sxs-lookup"><span data-stu-id="ad970-128">**RouteBased and Standard or High-Performance VPN gateway**</span></span> |
| --- | --- | --- |
| <span data-ttu-id="ad970-129">IKE Version</span><span class="sxs-lookup"><span data-stu-id="ad970-129">IKE Version</span></span> |<span data-ttu-id="ad970-130">IKEv1</span><span class="sxs-lookup"><span data-stu-id="ad970-130">IKEv1</span></span> |<span data-ttu-id="ad970-131">IKEv2</span><span class="sxs-lookup"><span data-stu-id="ad970-131">IKEv2</span></span> |
| <span data-ttu-id="ad970-132">Diffie-Hellman Group</span><span class="sxs-lookup"><span data-stu-id="ad970-132">Diffie-Hellman Group</span></span> |<span data-ttu-id="ad970-133">Group 2 (1024 bit)</span><span class="sxs-lookup"><span data-stu-id="ad970-133">Group 2 (1024 bit)</span></span> |<span data-ttu-id="ad970-134">Group 2 (1024 bit)</span><span class="sxs-lookup"><span data-stu-id="ad970-134">Group 2 (1024 bit)</span></span> |
| <span data-ttu-id="ad970-135">Authentication Method</span><span class="sxs-lookup"><span data-stu-id="ad970-135">Authentication Method</span></span> |<span data-ttu-id="ad970-136">Pre-Shared Key</span><span class="sxs-lookup"><span data-stu-id="ad970-136">Pre-Shared Key</span></span> |<span data-ttu-id="ad970-137">Pre-Shared Key</span><span class="sxs-lookup"><span data-stu-id="ad970-137">Pre-Shared Key</span></span> |
| <span data-ttu-id="ad970-138">Encryption Algorithms</span><span class="sxs-lookup"><span data-stu-id="ad970-138">Encryption Algorithms</span></span> |<span data-ttu-id="ad970-139">AES256 AES128 3DES</span><span class="sxs-lookup"><span data-stu-id="ad970-139">AES256 AES128 3DES</span></span> |<span data-ttu-id="ad970-140">AES256 3DES</span><span class="sxs-lookup"><span data-stu-id="ad970-140">AES256 3DES</span></span> |
| <span data-ttu-id="ad970-141">Hashing Algorithm</span><span class="sxs-lookup"><span data-stu-id="ad970-141">Hashing Algorithm</span></span> |<span data-ttu-id="ad970-142">SHA1(SHA128)</span><span class="sxs-lookup"><span data-stu-id="ad970-142">SHA1(SHA128)</span></span> |<span data-ttu-id="ad970-143">SHA1(SHA128), SHA2(SHA256)</span><span class="sxs-lookup"><span data-stu-id="ad970-143">SHA1(SHA128), SHA2(SHA256)</span></span> |
| <span data-ttu-id="ad970-144">Phase 1 Security Association (SA) Lifetime (Time)</span><span class="sxs-lookup"><span data-stu-id="ad970-144">Phase 1 Security Association (SA) Lifetime (Time)</span></span> |<span data-ttu-id="ad970-145">28,800 seconds</span><span class="sxs-lookup"><span data-stu-id="ad970-145">28,800 seconds</span></span> |<span data-ttu-id="ad970-146">10,800 seconds</span><span class="sxs-lookup"><span data-stu-id="ad970-146">10,800 seconds</span></span> |

<span data-ttu-id="ad970-147">As a user, you would be required to configure your Cisco ASA, a sample configuration can be found on [GitHub](https://github.com/Azure/Azure-vpn-config-samples/blob/master/Cisco/Current/ASA/ASA_9.1_and_above_Show_running-config.txt).</span><span class="sxs-lookup"><span data-stu-id="ad970-147">As a user, you would be required to configure your Cisco ASA, a sample configuration can be found on [GitHub](https://github.com/Azure/Azure-vpn-config-samples/blob/master/Cisco/Current/ASA/ASA_9.1_and_above_Show_running-config.txt).</span></span> <span data-ttu-id="ad970-148">Among other configurations, you would also need to specify the hashing algorithm.</span><span class="sxs-lookup"><span data-stu-id="ad970-148">Among other configurations, you would also need to specify the hashing algorithm.</span></span> <span data-ttu-id="ad970-149">Cisco ASA supports more [encryption and hashing algorithms](http://www.cisco.com/c/en/us/about/security-center/next-generation-cryptography.html) than Azure VPN Gateway.</span><span class="sxs-lookup"><span data-stu-id="ad970-149">Cisco ASA supports more [encryption and hashing algorithms](http://www.cisco.com/c/en/us/about/security-center/next-generation-cryptography.html) than Azure VPN Gateway.</span></span> <span data-ttu-id="ad970-150">Unknowingly you configured your Cisco ASA to use SHA-512 as the hashing algorithm.</span><span class="sxs-lookup"><span data-stu-id="ad970-150">Unknowingly you configured your Cisco ASA to use SHA-512 as the hashing algorithm.</span></span> <span data-ttu-id="ad970-151">As this algorithm is not a supported algorithm for policy-based connections, your VPN connection does work.</span><span class="sxs-lookup"><span data-stu-id="ad970-151">As this algorithm is not a supported algorithm for policy-based connections, your VPN connection does work.</span></span>

<span data-ttu-id="ad970-152">These issues are hard to troubleshoot and root causes are often non-intuitive.</span><span class="sxs-lookup"><span data-stu-id="ad970-152">These issues are hard to troubleshoot and root causes are often non-intuitive.</span></span> <span data-ttu-id="ad970-153">In this case you can open a support ticket to get help on resolving the issue.</span><span class="sxs-lookup"><span data-stu-id="ad970-153">In this case you can open a support ticket to get help on resolving the issue.</span></span> <span data-ttu-id="ad970-154">But with Azure Network Watcher troubleshoot API, you can identify these issues on your own.</span><span class="sxs-lookup"><span data-stu-id="ad970-154">But with Azure Network Watcher troubleshoot API, you can identify these issues on your own.</span></span>

## <a name="troubleshooting-using-azure-network-watcher"></a><span data-ttu-id="ad970-155">Troubleshooting using Azure Network Watcher</span><span class="sxs-lookup"><span data-stu-id="ad970-155">Troubleshooting using Azure Network Watcher</span></span>

<span data-ttu-id="ad970-156">To diagnose your connection, connect to Azure PowerShell and initiate the `Start-AzureRmNetworkWatcherResourceTroubleshooting` cmdlet.</span><span class="sxs-lookup"><span data-stu-id="ad970-156">To diagnose your connection, connect to Azure PowerShell and initiate the `Start-AzureRmNetworkWatcherResourceTroubleshooting` cmdlet.</span></span> <span data-ttu-id="ad970-157">You can find the details on using this cmdlet at [Troubleshoot Virtual Network Gateway and connections - PowerShell](network-watcher-troubleshoot-manage-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="ad970-157">You can find the details on using this cmdlet at [Troubleshoot Virtual Network Gateway and connections - PowerShell](network-watcher-troubleshoot-manage-powershell.md).</span></span> <span data-ttu-id="ad970-158">This cmdlet may take up to few minutes to complete.</span><span class="sxs-lookup"><span data-stu-id="ad970-158">This cmdlet may take up to few minutes to complete.</span></span>

<span data-ttu-id="ad970-159">Once the cmdlet completes, you can navigate to the storage location specified in the cmdlet to get detailed information on about the issue and logs.</span><span class="sxs-lookup"><span data-stu-id="ad970-159">Once the cmdlet completes, you can navigate to the storage location specified in the cmdlet to get detailed information on about the issue and logs.</span></span> <span data-ttu-id="ad970-160">Azure Network Watcher creates a zip folder that contains the following log files:</span><span class="sxs-lookup"><span data-stu-id="ad970-160">Azure Network Watcher creates a zip folder that contains the following log files:</span></span>

![1][1]

<span data-ttu-id="ad970-162">Open the file called IKEErrors.txt and it displays the following error, indicating an issue with on-premises IKE setting misconfiguration.</span><span class="sxs-lookup"><span data-stu-id="ad970-162">Open the file called IKEErrors.txt and it displays the following error, indicating an issue with on-premises IKE setting misconfiguration.</span></span>

```
Error: On-premises device rejected Quick Mode settings. Check values.
     based on log : Peer sent NO_PROPOSAL_CHOSEN notify
```

<span data-ttu-id="ad970-163">You can get detailed information from the Scrubbed-wfpdiag.txt about the error, as in this case it mentions that there was `ERROR_IPSEC_IKE_POLICY_MATCH` that lead to connection not working properly.</span><span class="sxs-lookup"><span data-stu-id="ad970-163">You can get detailed information from the Scrubbed-wfpdiag.txt about the error, as in this case it mentions that there was `ERROR_IPSEC_IKE_POLICY_MATCH` that lead to connection not working properly.</span></span>

<span data-ttu-id="ad970-164">Another common misconfiguration is the specifying incorrect shared keys.</span><span class="sxs-lookup"><span data-stu-id="ad970-164">Another common misconfiguration is the specifying incorrect shared keys.</span></span> <span data-ttu-id="ad970-165">If in the preceding example you had specified different shared keys, the IKEErrors.txt shows the following error: `Error: Authentication failed. Check shared key`.</span><span class="sxs-lookup"><span data-stu-id="ad970-165">If in the preceding example you had specified different shared keys, the IKEErrors.txt shows the following error: `Error: Authentication failed. Check shared key`.</span></span>

<span data-ttu-id="ad970-166">Azure Network Watcher troubleshoot feature enables you to diagnose and troubleshoot your VPN Gateway and Connection with the ease of a simple PowerShell cmdlet.</span><span class="sxs-lookup"><span data-stu-id="ad970-166">Azure Network Watcher troubleshoot feature enables you to diagnose and troubleshoot your VPN Gateway and Connection with the ease of a simple PowerShell cmdlet.</span></span> <span data-ttu-id="ad970-167">Currently we support diagnosing the following conditions and are working towards adding more condition.</span><span class="sxs-lookup"><span data-stu-id="ad970-167">Currently we support diagnosing the following conditions and are working towards adding more condition.</span></span>

### <a name="gateway"></a><span data-ttu-id="ad970-168">Gateway</span><span class="sxs-lookup"><span data-stu-id="ad970-168">Gateway</span></span>

| <span data-ttu-id="ad970-169">Fault Type</span><span class="sxs-lookup"><span data-stu-id="ad970-169">Fault Type</span></span> | <span data-ttu-id="ad970-170">Reason</span><span class="sxs-lookup"><span data-stu-id="ad970-170">Reason</span></span> | <span data-ttu-id="ad970-171">Log</span><span class="sxs-lookup"><span data-stu-id="ad970-171">Log</span></span>|
|---|---|---|
| <span data-ttu-id="ad970-172">NoFault</span><span class="sxs-lookup"><span data-stu-id="ad970-172">NoFault</span></span> | <span data-ttu-id="ad970-173">When no error is detected.</span><span class="sxs-lookup"><span data-stu-id="ad970-173">When no error is detected.</span></span> |<span data-ttu-id="ad970-174">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-174">Yes</span></span>|
| <span data-ttu-id="ad970-175">GatewayNotFound</span><span class="sxs-lookup"><span data-stu-id="ad970-175">GatewayNotFound</span></span> | <span data-ttu-id="ad970-176">Cannot find Gateway or Gateway is not provisioned.</span><span class="sxs-lookup"><span data-stu-id="ad970-176">Cannot find Gateway or Gateway is not provisioned.</span></span> |<span data-ttu-id="ad970-177">No</span><span class="sxs-lookup"><span data-stu-id="ad970-177">No</span></span>|
| <span data-ttu-id="ad970-178">PlannedMaintenance</span><span class="sxs-lookup"><span data-stu-id="ad970-178">PlannedMaintenance</span></span> |  <span data-ttu-id="ad970-179">Gateway instance is under maintenance.</span><span class="sxs-lookup"><span data-stu-id="ad970-179">Gateway instance is under maintenance.</span></span>  |<span data-ttu-id="ad970-180">No</span><span class="sxs-lookup"><span data-stu-id="ad970-180">No</span></span>|
| <span data-ttu-id="ad970-181">UserDrivenUpdate</span><span class="sxs-lookup"><span data-stu-id="ad970-181">UserDrivenUpdate</span></span> | <span data-ttu-id="ad970-182">When a user update is in progress.</span><span class="sxs-lookup"><span data-stu-id="ad970-182">When a user update is in progress.</span></span> <span data-ttu-id="ad970-183">This could be a resize operation.</span><span class="sxs-lookup"><span data-stu-id="ad970-183">This could be a resize operation.</span></span> | <span data-ttu-id="ad970-184">No</span><span class="sxs-lookup"><span data-stu-id="ad970-184">No</span></span> |
| <span data-ttu-id="ad970-185">VipUnResponsive</span><span class="sxs-lookup"><span data-stu-id="ad970-185">VipUnResponsive</span></span> | <span data-ttu-id="ad970-186">Cannot reach the primary instance of the Gateway.</span><span class="sxs-lookup"><span data-stu-id="ad970-186">Cannot reach the primary instance of the Gateway.</span></span> <span data-ttu-id="ad970-187">This happens when the health probe fails.</span><span class="sxs-lookup"><span data-stu-id="ad970-187">This happens when the health probe fails.</span></span> | <span data-ttu-id="ad970-188">No</span><span class="sxs-lookup"><span data-stu-id="ad970-188">No</span></span> |
| <span data-ttu-id="ad970-189">PlatformInActive</span><span class="sxs-lookup"><span data-stu-id="ad970-189">PlatformInActive</span></span> | <span data-ttu-id="ad970-190">There is an issue with the platform.</span><span class="sxs-lookup"><span data-stu-id="ad970-190">There is an issue with the platform.</span></span> | <span data-ttu-id="ad970-191">No</span><span class="sxs-lookup"><span data-stu-id="ad970-191">No</span></span>|
| <span data-ttu-id="ad970-192">ServiceNotRunning</span><span class="sxs-lookup"><span data-stu-id="ad970-192">ServiceNotRunning</span></span> | <span data-ttu-id="ad970-193">The underlying service is not running.</span><span class="sxs-lookup"><span data-stu-id="ad970-193">The underlying service is not running.</span></span> | <span data-ttu-id="ad970-194">No</span><span class="sxs-lookup"><span data-stu-id="ad970-194">No</span></span>|
| <span data-ttu-id="ad970-195">NoConnectionsFoundForGateway</span><span class="sxs-lookup"><span data-stu-id="ad970-195">NoConnectionsFoundForGateway</span></span> | <span data-ttu-id="ad970-196">No Connections exists on the gateway.</span><span class="sxs-lookup"><span data-stu-id="ad970-196">No Connections exists on the gateway.</span></span> <span data-ttu-id="ad970-197">This is only a warning.</span><span class="sxs-lookup"><span data-stu-id="ad970-197">This is only a warning.</span></span>| <span data-ttu-id="ad970-198">No</span><span class="sxs-lookup"><span data-stu-id="ad970-198">No</span></span>|
| <span data-ttu-id="ad970-199">ConnectionsNotConnected</span><span class="sxs-lookup"><span data-stu-id="ad970-199">ConnectionsNotConnected</span></span> | <span data-ttu-id="ad970-200">None of the Connections are not connected.</span><span class="sxs-lookup"><span data-stu-id="ad970-200">None of the Connections are not connected.</span></span> <span data-ttu-id="ad970-201">This is only a warning.</span><span class="sxs-lookup"><span data-stu-id="ad970-201">This is only a warning.</span></span>| <span data-ttu-id="ad970-202">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-202">Yes</span></span>|
| <span data-ttu-id="ad970-203">GatewayCPUUsageExceeded</span><span class="sxs-lookup"><span data-stu-id="ad970-203">GatewayCPUUsageExceeded</span></span> | <span data-ttu-id="ad970-204">The current Gateway usage CPU usage is > 95%.</span><span class="sxs-lookup"><span data-stu-id="ad970-204">The current Gateway usage CPU usage is > 95%.</span></span> | <span data-ttu-id="ad970-205">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-205">Yes</span></span> |

### <a name="connection"></a><span data-ttu-id="ad970-206">Connection</span><span class="sxs-lookup"><span data-stu-id="ad970-206">Connection</span></span>

| <span data-ttu-id="ad970-207">Fault Type</span><span class="sxs-lookup"><span data-stu-id="ad970-207">Fault Type</span></span> | <span data-ttu-id="ad970-208">Reason</span><span class="sxs-lookup"><span data-stu-id="ad970-208">Reason</span></span> | <span data-ttu-id="ad970-209">Log</span><span class="sxs-lookup"><span data-stu-id="ad970-209">Log</span></span>|
|---|---|---|
| <span data-ttu-id="ad970-210">NoFault</span><span class="sxs-lookup"><span data-stu-id="ad970-210">NoFault</span></span> | <span data-ttu-id="ad970-211">When no error is detected.</span><span class="sxs-lookup"><span data-stu-id="ad970-211">When no error is detected.</span></span> |<span data-ttu-id="ad970-212">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-212">Yes</span></span>|
| <span data-ttu-id="ad970-213">GatewayNotFound</span><span class="sxs-lookup"><span data-stu-id="ad970-213">GatewayNotFound</span></span> | <span data-ttu-id="ad970-214">Cannot find Gateway or Gateway is not provisioned.</span><span class="sxs-lookup"><span data-stu-id="ad970-214">Cannot find Gateway or Gateway is not provisioned.</span></span> |<span data-ttu-id="ad970-215">No</span><span class="sxs-lookup"><span data-stu-id="ad970-215">No</span></span>|
| <span data-ttu-id="ad970-216">PlannedMaintenance</span><span class="sxs-lookup"><span data-stu-id="ad970-216">PlannedMaintenance</span></span> | <span data-ttu-id="ad970-217">Gateway instance is under maintenance.</span><span class="sxs-lookup"><span data-stu-id="ad970-217">Gateway instance is under maintenance.</span></span>  |<span data-ttu-id="ad970-218">No</span><span class="sxs-lookup"><span data-stu-id="ad970-218">No</span></span>|
| <span data-ttu-id="ad970-219">UserDrivenUpdate</span><span class="sxs-lookup"><span data-stu-id="ad970-219">UserDrivenUpdate</span></span> | <span data-ttu-id="ad970-220">When a user update is in progress.</span><span class="sxs-lookup"><span data-stu-id="ad970-220">When a user update is in progress.</span></span> <span data-ttu-id="ad970-221">This could be a resize operation.</span><span class="sxs-lookup"><span data-stu-id="ad970-221">This could be a resize operation.</span></span>  | <span data-ttu-id="ad970-222">No</span><span class="sxs-lookup"><span data-stu-id="ad970-222">No</span></span> |
| <span data-ttu-id="ad970-223">VipUnResponsive</span><span class="sxs-lookup"><span data-stu-id="ad970-223">VipUnResponsive</span></span> | <span data-ttu-id="ad970-224">Cannot reach the primary instance of the Gateway.</span><span class="sxs-lookup"><span data-stu-id="ad970-224">Cannot reach the primary instance of the Gateway.</span></span> <span data-ttu-id="ad970-225">It happens when the health probe fails.</span><span class="sxs-lookup"><span data-stu-id="ad970-225">It happens when the health probe fails.</span></span> | <span data-ttu-id="ad970-226">No</span><span class="sxs-lookup"><span data-stu-id="ad970-226">No</span></span> |
| <span data-ttu-id="ad970-227">ConnectionEntityNotFound</span><span class="sxs-lookup"><span data-stu-id="ad970-227">ConnectionEntityNotFound</span></span> | <span data-ttu-id="ad970-228">Connection configuration is missing.</span><span class="sxs-lookup"><span data-stu-id="ad970-228">Connection configuration is missing.</span></span> | <span data-ttu-id="ad970-229">No</span><span class="sxs-lookup"><span data-stu-id="ad970-229">No</span></span> |
| <span data-ttu-id="ad970-230">ConnectionIsMarkedDisconnected</span><span class="sxs-lookup"><span data-stu-id="ad970-230">ConnectionIsMarkedDisconnected</span></span> | <span data-ttu-id="ad970-231">The Connection is marked "disconnected".</span><span class="sxs-lookup"><span data-stu-id="ad970-231">The Connection is marked "disconnected".</span></span> |<span data-ttu-id="ad970-232">No</span><span class="sxs-lookup"><span data-stu-id="ad970-232">No</span></span>|
| <span data-ttu-id="ad970-233">ConnectionNotConfiguredOnGateway</span><span class="sxs-lookup"><span data-stu-id="ad970-233">ConnectionNotConfiguredOnGateway</span></span> | <span data-ttu-id="ad970-234">The underlying service does not have the Connection configured.</span><span class="sxs-lookup"><span data-stu-id="ad970-234">The underlying service does not have the Connection configured.</span></span> | <span data-ttu-id="ad970-235">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-235">Yes</span></span> |
| <span data-ttu-id="ad970-236">ConnectionMarkedStandy</span><span class="sxs-lookup"><span data-stu-id="ad970-236">ConnectionMarkedStandy</span></span> | <span data-ttu-id="ad970-237">The underlying service is marked as standby.</span><span class="sxs-lookup"><span data-stu-id="ad970-237">The underlying service is marked as standby.</span></span>| <span data-ttu-id="ad970-238">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-238">Yes</span></span>|
| <span data-ttu-id="ad970-239">Authentication</span><span class="sxs-lookup"><span data-stu-id="ad970-239">Authentication</span></span> | <span data-ttu-id="ad970-240">Preshared Key mismatch.</span><span class="sxs-lookup"><span data-stu-id="ad970-240">Preshared Key mismatch.</span></span> | <span data-ttu-id="ad970-241">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-241">Yes</span></span>|
| <span data-ttu-id="ad970-242">PeerReachability</span><span class="sxs-lookup"><span data-stu-id="ad970-242">PeerReachability</span></span> | <span data-ttu-id="ad970-243">The peer gateway is not reachable.</span><span class="sxs-lookup"><span data-stu-id="ad970-243">The peer gateway is not reachable.</span></span> | <span data-ttu-id="ad970-244">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-244">Yes</span></span>|
| <span data-ttu-id="ad970-245">IkePolicyMismatch</span><span class="sxs-lookup"><span data-stu-id="ad970-245">IkePolicyMismatch</span></span> | <span data-ttu-id="ad970-246">The peer gateway has IKE policies that are not supported by Azure.</span><span class="sxs-lookup"><span data-stu-id="ad970-246">The peer gateway has IKE policies that are not supported by Azure.</span></span> | <span data-ttu-id="ad970-247">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-247">Yes</span></span>|
| <span data-ttu-id="ad970-248">WfpParse Error</span><span class="sxs-lookup"><span data-stu-id="ad970-248">WfpParse Error</span></span> | <span data-ttu-id="ad970-249">An error occurred parsing the WFP log.</span><span class="sxs-lookup"><span data-stu-id="ad970-249">An error occurred parsing the WFP log.</span></span> |<span data-ttu-id="ad970-250">Yes</span><span class="sxs-lookup"><span data-stu-id="ad970-250">Yes</span></span>|

## <a name="next-steps"></a><span data-ttu-id="ad970-251">Next steps</span><span class="sxs-lookup"><span data-stu-id="ad970-251">Next steps</span></span>

<span data-ttu-id="ad970-252">Learn to check VPN Gateway connectivity with PowerShell and Azure Automation by visiting [Monitor VPN gateways with Azure Network Watcher troubleshooting](network-watcher-monitor-with-azure-automation.md)</span><span class="sxs-lookup"><span data-stu-id="ad970-252">Learn to check VPN Gateway connectivity with PowerShell and Azure Automation by visiting [Monitor VPN gateways with Azure Network Watcher troubleshooting](network-watcher-monitor-with-azure-automation.md)</span></span>

[1]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/network-watcher/media/network-watcher-diagnose-on-premises-connectivity/figure1.png

