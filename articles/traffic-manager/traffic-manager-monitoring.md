---
title: Azure Traffic Manager endpoint monitoring | Microsoft Docs
description: This article can help you understand how Traffic Manager uses endpoint monitoring and automatic endpoint failover to help Azure customers deploy high-availability applications
services: traffic-manager
documentationcenter: ''
author: kumudd
manager: timlt
editor: ''
ms.assetid: fff25ac3-d13a-4af9-8916-7c72e3d64bc7
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 03/16/2017
ms.author: kumud
ms.openlocfilehash: 96511b1d20f5a712a4a8817e6298116f38fbaee3
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44660730"
---
# <a name="traffic-manager-endpoint-monitoring"></a><span data-ttu-id="eb109-103">Traffic Manager endpoint monitoring</span><span class="sxs-lookup"><span data-stu-id="eb109-103">Traffic Manager endpoint monitoring</span></span>

<span data-ttu-id="eb109-104">Azure Traffic Manager includes built-in endpoint monitoring and automatic endpoint failover.</span><span class="sxs-lookup"><span data-stu-id="eb109-104">Azure Traffic Manager includes built-in endpoint monitoring and automatic endpoint failover.</span></span> <span data-ttu-id="eb109-105">This feature helps you deliver high-availability applications that are resilient to endpoint failure, including Azure region failures.</span><span class="sxs-lookup"><span data-stu-id="eb109-105">This feature helps you deliver high-availability applications that are resilient to endpoint failure, including Azure region failures.</span></span>

## <a name="configure-endpoint-monitoring"></a><span data-ttu-id="eb109-106">Configure endpoint monitoring</span><span class="sxs-lookup"><span data-stu-id="eb109-106">Configure endpoint monitoring</span></span>

<span data-ttu-id="eb109-107">To configure endpoint monitoring, you must specify the following settings on your Traffic Manager profile:</span><span class="sxs-lookup"><span data-stu-id="eb109-107">To configure endpoint monitoring, you must specify the following settings on your Traffic Manager profile:</span></span>

* <span data-ttu-id="eb109-108">**Protocol**.</span><span class="sxs-lookup"><span data-stu-id="eb109-108">**Protocol**.</span></span> <span data-ttu-id="eb109-109">Choose HTTP or HTTPS.</span><span class="sxs-lookup"><span data-stu-id="eb109-109">Choose HTTP or HTTPS.</span></span> <span data-ttu-id="eb109-110">It's important to note that HTTPS monitoring does not verify whether your SSL certificate is valid--it only checks that the certificate is present.</span><span class="sxs-lookup"><span data-stu-id="eb109-110">It's important to note that HTTPS monitoring does not verify whether your SSL certificate is valid--it only checks that the certificate is present.</span></span>
* <span data-ttu-id="eb109-111">**Port**.</span><span class="sxs-lookup"><span data-stu-id="eb109-111">**Port**.</span></span> <span data-ttu-id="eb109-112">Choose the port used for the request.</span><span class="sxs-lookup"><span data-stu-id="eb109-112">Choose the port used for the request.</span></span>
* <span data-ttu-id="eb109-113">**Path**.</span><span class="sxs-lookup"><span data-stu-id="eb109-113">**Path**.</span></span> <span data-ttu-id="eb109-114">Give the relative path and the name of the webpage or file that the monitoring accesses.</span><span class="sxs-lookup"><span data-stu-id="eb109-114">Give the relative path and the name of the webpage or file that the monitoring accesses.</span></span> <span data-ttu-id="eb109-115">A forward slash (/) is a valid entry for the relative path.</span><span class="sxs-lookup"><span data-stu-id="eb109-115">A forward slash (/) is a valid entry for the relative path.</span></span> <span data-ttu-id="eb109-116">This value implies that the file is in the root directory (default).</span><span class="sxs-lookup"><span data-stu-id="eb109-116">This value implies that the file is in the root directory (default).</span></span>

<span data-ttu-id="eb109-117">To check the health of each endpoint, Traffic Manager makes a GET request to the endpoint using the protocol, port, and relative path given.</span><span class="sxs-lookup"><span data-stu-id="eb109-117">To check the health of each endpoint, Traffic Manager makes a GET request to the endpoint using the protocol, port, and relative path given.</span></span>

<span data-ttu-id="eb109-118">A common practice is to implement a custom page within your application, for example, /health.aspx.</span><span class="sxs-lookup"><span data-stu-id="eb109-118">A common practice is to implement a custom page within your application, for example, /health.aspx.</span></span> <span data-ttu-id="eb109-119">Using this path for monitoring, you can perform application-specific checks, such as checking performance counters or verifying database availability.</span><span class="sxs-lookup"><span data-stu-id="eb109-119">Using this path for monitoring, you can perform application-specific checks, such as checking performance counters or verifying database availability.</span></span> <span data-ttu-id="eb109-120">Based on these custom checks, the page returns an appropriate HTTP status code.</span><span class="sxs-lookup"><span data-stu-id="eb109-120">Based on these custom checks, the page returns an appropriate HTTP status code.</span></span>

<span data-ttu-id="eb109-121">All endpoints in a Traffic Manager profile share monitoring settings.</span><span class="sxs-lookup"><span data-stu-id="eb109-121">All endpoints in a Traffic Manager profile share monitoring settings.</span></span> <span data-ttu-id="eb109-122">If you need to use different monitoring settings for different endpoints, you can create [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span><span class="sxs-lookup"><span data-stu-id="eb109-122">If you need to use different monitoring settings for different endpoints, you can create [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span></span>

## <a name="endpoint-and-profile-status"></a><span data-ttu-id="eb109-123">Endpoint and profile status</span><span class="sxs-lookup"><span data-stu-id="eb109-123">Endpoint and profile status</span></span>

<span data-ttu-id="eb109-124">You can enable and disable Traffic Manager profiles and endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-124">You can enable and disable Traffic Manager profiles and endpoints.</span></span> <span data-ttu-id="eb109-125">However, a change in endpoint status also might occur as a result of Traffic Manager automated settings and processes.</span><span class="sxs-lookup"><span data-stu-id="eb109-125">However, a change in endpoint status also might occur as a result of Traffic Manager automated settings and processes.</span></span>

### <a name="endpoint-status"></a><span data-ttu-id="eb109-126">Endpoint status</span><span class="sxs-lookup"><span data-stu-id="eb109-126">Endpoint status</span></span>

<span data-ttu-id="eb109-127">You can enable or disable a specific endpoint.</span><span class="sxs-lookup"><span data-stu-id="eb109-127">You can enable or disable a specific endpoint.</span></span> <span data-ttu-id="eb109-128">The underlying service, which might still be healthy, is unaffected.</span><span class="sxs-lookup"><span data-stu-id="eb109-128">The underlying service, which might still be healthy, is unaffected.</span></span> <span data-ttu-id="eb109-129">Changing the endpoint status controls the availability of the endpoint in the Traffic Manager profile.</span><span class="sxs-lookup"><span data-stu-id="eb109-129">Changing the endpoint status controls the availability of the endpoint in the Traffic Manager profile.</span></span> <span data-ttu-id="eb109-130">When an endpoint status is disabled, Traffic Manager does not check its health and the endpoint is not included in a DNS response.</span><span class="sxs-lookup"><span data-stu-id="eb109-130">When an endpoint status is disabled, Traffic Manager does not check its health and the endpoint is not included in a DNS response.</span></span>

### <a name="profile-status"></a><span data-ttu-id="eb109-131">Profile status</span><span class="sxs-lookup"><span data-stu-id="eb109-131">Profile status</span></span>

<span data-ttu-id="eb109-132">Using the profile status setting, you can enable or disable a specific profile.</span><span class="sxs-lookup"><span data-stu-id="eb109-132">Using the profile status setting, you can enable or disable a specific profile.</span></span> <span data-ttu-id="eb109-133">While endpoint status affects a single endpoint, profile status affects the entire profile, including all endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-133">While endpoint status affects a single endpoint, profile status affects the entire profile, including all endpoints.</span></span> <span data-ttu-id="eb109-134">When you disable a profile, the endpoints are not checked for health and no endpoints are included in a DNS response.</span><span class="sxs-lookup"><span data-stu-id="eb109-134">When you disable a profile, the endpoints are not checked for health and no endpoints are included in a DNS response.</span></span> <span data-ttu-id="eb109-135">An [NXDOMAIN](https://tools.ietf.org/html/rfc2308) response code is returned for the DNS query.</span><span class="sxs-lookup"><span data-stu-id="eb109-135">An [NXDOMAIN](https://tools.ietf.org/html/rfc2308) response code is returned for the DNS query.</span></span>

### <a name="endpoint-monitor-status"></a><span data-ttu-id="eb109-136">Endpoint monitor status</span><span class="sxs-lookup"><span data-stu-id="eb109-136">Endpoint monitor status</span></span>

<span data-ttu-id="eb109-137">Endpoint monitor status is a Traffic Manager-generated value that shows the status of the endpoint.</span><span class="sxs-lookup"><span data-stu-id="eb109-137">Endpoint monitor status is a Traffic Manager-generated value that shows the status of the endpoint.</span></span> <span data-ttu-id="eb109-138">You cannot change this setting manually.</span><span class="sxs-lookup"><span data-stu-id="eb109-138">You cannot change this setting manually.</span></span> <span data-ttu-id="eb109-139">The endpoint monitor status is a combination of the results of endpoint monitoring and the configured endpoint status.</span><span class="sxs-lookup"><span data-stu-id="eb109-139">The endpoint monitor status is a combination of the results of endpoint monitoring and the configured endpoint status.</span></span> <span data-ttu-id="eb109-140">The possible values of endpoint monitor status are shown in the following table:</span><span class="sxs-lookup"><span data-stu-id="eb109-140">The possible values of endpoint monitor status are shown in the following table:</span></span>

| <span data-ttu-id="eb109-141">Profile status</span><span class="sxs-lookup"><span data-stu-id="eb109-141">Profile status</span></span> | <span data-ttu-id="eb109-142">Endpoint status</span><span class="sxs-lookup"><span data-stu-id="eb109-142">Endpoint status</span></span> | <span data-ttu-id="eb109-143">Endpoint monitor status</span><span class="sxs-lookup"><span data-stu-id="eb109-143">Endpoint monitor status</span></span> | <span data-ttu-id="eb109-144">Notes</span><span class="sxs-lookup"><span data-stu-id="eb109-144">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="eb109-145">Disabled</span><span class="sxs-lookup"><span data-stu-id="eb109-145">Disabled</span></span> |<span data-ttu-id="eb109-146">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-146">Enabled</span></span> |<span data-ttu-id="eb109-147">Inactive</span><span class="sxs-lookup"><span data-stu-id="eb109-147">Inactive</span></span> |<span data-ttu-id="eb109-148">The profile has been disabled.</span><span class="sxs-lookup"><span data-stu-id="eb109-148">The profile has been disabled.</span></span> <span data-ttu-id="eb109-149">Although the endpoint status is Enabled, the profile status (Disabled) takes precedence.</span><span class="sxs-lookup"><span data-stu-id="eb109-149">Although the endpoint status is Enabled, the profile status (Disabled) takes precedence.</span></span> <span data-ttu-id="eb109-150">Endpoints in disabled profiles are not monitored.</span><span class="sxs-lookup"><span data-stu-id="eb109-150">Endpoints in disabled profiles are not monitored.</span></span> <span data-ttu-id="eb109-151">An NXDOMAIN response code is returned for the DNS query.</span><span class="sxs-lookup"><span data-stu-id="eb109-151">An NXDOMAIN response code is returned for the DNS query.</span></span> |
| <span data-ttu-id="eb109-152">&lt;any&gt;</span><span class="sxs-lookup"><span data-stu-id="eb109-152">&lt;any&gt;</span></span> |<span data-ttu-id="eb109-153">Disabled</span><span class="sxs-lookup"><span data-stu-id="eb109-153">Disabled</span></span> |<span data-ttu-id="eb109-154">Disabled</span><span class="sxs-lookup"><span data-stu-id="eb109-154">Disabled</span></span> |<span data-ttu-id="eb109-155">The endpoint has been disabled.</span><span class="sxs-lookup"><span data-stu-id="eb109-155">The endpoint has been disabled.</span></span> <span data-ttu-id="eb109-156">Disabled endpoints are not monitored.</span><span class="sxs-lookup"><span data-stu-id="eb109-156">Disabled endpoints are not monitored.</span></span> <span data-ttu-id="eb109-157">The endpoint is not included in DNS responses, therefore, it does not receive traffic.</span><span class="sxs-lookup"><span data-stu-id="eb109-157">The endpoint is not included in DNS responses, therefore, it does not receive traffic.</span></span> |
| <span data-ttu-id="eb109-158">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-158">Enabled</span></span> |<span data-ttu-id="eb109-159">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-159">Enabled</span></span> |<span data-ttu-id="eb109-160">Online</span><span class="sxs-lookup"><span data-stu-id="eb109-160">Online</span></span> |<span data-ttu-id="eb109-161">The endpoint is monitored and is healthy.</span><span class="sxs-lookup"><span data-stu-id="eb109-161">The endpoint is monitored and is healthy.</span></span> <span data-ttu-id="eb109-162">It is included in DNS responses and can receive traffic.</span><span class="sxs-lookup"><span data-stu-id="eb109-162">It is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="eb109-163">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-163">Enabled</span></span> |<span data-ttu-id="eb109-164">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-164">Enabled</span></span> |<span data-ttu-id="eb109-165">Degraded</span><span class="sxs-lookup"><span data-stu-id="eb109-165">Degraded</span></span> |<span data-ttu-id="eb109-166">Endpoint monitoring health checks are failing.</span><span class="sxs-lookup"><span data-stu-id="eb109-166">Endpoint monitoring health checks are failing.</span></span> <span data-ttu-id="eb109-167">The endpoint is not included in DNS responses and does not receive traffic.</span><span class="sxs-lookup"><span data-stu-id="eb109-167">The endpoint is not included in DNS responses and does not receive traffic.</span></span> |
| <span data-ttu-id="eb109-168">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-168">Enabled</span></span> |<span data-ttu-id="eb109-169">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-169">Enabled</span></span> |<span data-ttu-id="eb109-170">CheckingEndpoint</span><span class="sxs-lookup"><span data-stu-id="eb109-170">CheckingEndpoint</span></span> |<span data-ttu-id="eb109-171">The endpoint is monitored, but the results of the first probe have not been received yet.</span><span class="sxs-lookup"><span data-stu-id="eb109-171">The endpoint is monitored, but the results of the first probe have not been received yet.</span></span> <span data-ttu-id="eb109-172">CheckingEndpoint is a temporary state that usually occurs immediately after adding or enabling an endpoint in the profile.</span><span class="sxs-lookup"><span data-stu-id="eb109-172">CheckingEndpoint is a temporary state that usually occurs immediately after adding or enabling an endpoint in the profile.</span></span> <span data-ttu-id="eb109-173">An endpoint in this state is included in DNS responses and can receive traffic.</span><span class="sxs-lookup"><span data-stu-id="eb109-173">An endpoint in this state is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="eb109-174">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-174">Enabled</span></span> |<span data-ttu-id="eb109-175">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-175">Enabled</span></span> |<span data-ttu-id="eb109-176">Stopped</span><span class="sxs-lookup"><span data-stu-id="eb109-176">Stopped</span></span> |<span data-ttu-id="eb109-177">The cloud service or web app that the endpoint points to is not running.</span><span class="sxs-lookup"><span data-stu-id="eb109-177">The cloud service or web app that the endpoint points to is not running.</span></span> <span data-ttu-id="eb109-178">Check the cloud service or web app settings.</span><span class="sxs-lookup"><span data-stu-id="eb109-178">Check the cloud service or web app settings.</span></span> <span data-ttu-id="eb109-179">An endpoint with a Stopped status is not monitored.</span><span class="sxs-lookup"><span data-stu-id="eb109-179">An endpoint with a Stopped status is not monitored.</span></span> <span data-ttu-id="eb109-180">It is not included in DNS responses and does not receive traffic.</span><span class="sxs-lookup"><span data-stu-id="eb109-180">It is not included in DNS responses and does not receive traffic.</span></span> |

<span data-ttu-id="eb109-181">For details about how endpoint monitor status is calculated for nested endpoints, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="eb109-181">For details about how endpoint monitor status is calculated for nested endpoints, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>

### <a name="profile-monitor-status"></a><span data-ttu-id="eb109-182">Profile monitor status</span><span class="sxs-lookup"><span data-stu-id="eb109-182">Profile monitor status</span></span>

<span data-ttu-id="eb109-183">The profile monitor status is a combination of the configured profile status and the endpoint monitor status values for all endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-183">The profile monitor status is a combination of the configured profile status and the endpoint monitor status values for all endpoints.</span></span> <span data-ttu-id="eb109-184">The possible values are described in the following table:</span><span class="sxs-lookup"><span data-stu-id="eb109-184">The possible values are described in the following table:</span></span>

| <span data-ttu-id="eb109-185">Profile status (as configured)</span><span class="sxs-lookup"><span data-stu-id="eb109-185">Profile status (as configured)</span></span> | <span data-ttu-id="eb109-186">Endpoint monitor status</span><span class="sxs-lookup"><span data-stu-id="eb109-186">Endpoint monitor status</span></span> | <span data-ttu-id="eb109-187">Profile monitor status</span><span class="sxs-lookup"><span data-stu-id="eb109-187">Profile monitor status</span></span> | <span data-ttu-id="eb109-188">Notes</span><span class="sxs-lookup"><span data-stu-id="eb109-188">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="eb109-189">Disabled</span><span class="sxs-lookup"><span data-stu-id="eb109-189">Disabled</span></span> |<span data-ttu-id="eb109-190">&lt;any&gt; or a profile with no defined endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-190">&lt;any&gt; or a profile with no defined endpoints.</span></span> |<span data-ttu-id="eb109-191">Disabled</span><span class="sxs-lookup"><span data-stu-id="eb109-191">Disabled</span></span> |<span data-ttu-id="eb109-192">The profile has been disabled.</span><span class="sxs-lookup"><span data-stu-id="eb109-192">The profile has been disabled.</span></span> |
| <span data-ttu-id="eb109-193">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-193">Enabled</span></span> |<span data-ttu-id="eb109-194">The status of at least one endpoint is Degraded.</span><span class="sxs-lookup"><span data-stu-id="eb109-194">The status of at least one endpoint is Degraded.</span></span> |<span data-ttu-id="eb109-195">Degraded</span><span class="sxs-lookup"><span data-stu-id="eb109-195">Degraded</span></span> |<span data-ttu-id="eb109-196">Review the individual endpoint status values to determine which endpoints require further attention.</span><span class="sxs-lookup"><span data-stu-id="eb109-196">Review the individual endpoint status values to determine which endpoints require further attention.</span></span> |
| <span data-ttu-id="eb109-197">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-197">Enabled</span></span> |<span data-ttu-id="eb109-198">The status of at least one endpoint is Online.</span><span class="sxs-lookup"><span data-stu-id="eb109-198">The status of at least one endpoint is Online.</span></span> <span data-ttu-id="eb109-199">No endpoints have a Degraded status.</span><span class="sxs-lookup"><span data-stu-id="eb109-199">No endpoints have a Degraded status.</span></span> |<span data-ttu-id="eb109-200">Online</span><span class="sxs-lookup"><span data-stu-id="eb109-200">Online</span></span> |<span data-ttu-id="eb109-201">The service is accepting traffic.</span><span class="sxs-lookup"><span data-stu-id="eb109-201">The service is accepting traffic.</span></span> <span data-ttu-id="eb109-202">No further action is required.</span><span class="sxs-lookup"><span data-stu-id="eb109-202">No further action is required.</span></span> |
| <span data-ttu-id="eb109-203">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-203">Enabled</span></span> |<span data-ttu-id="eb109-204">The status of at least one endpoint is CheckingEndpoint.</span><span class="sxs-lookup"><span data-stu-id="eb109-204">The status of at least one endpoint is CheckingEndpoint.</span></span> <span data-ttu-id="eb109-205">No endpoints are in Online or Degraded status.</span><span class="sxs-lookup"><span data-stu-id="eb109-205">No endpoints are in Online or Degraded status.</span></span> |<span data-ttu-id="eb109-206">CheckingEndpoints</span><span class="sxs-lookup"><span data-stu-id="eb109-206">CheckingEndpoints</span></span> |<span data-ttu-id="eb109-207">This transition state occurs when a profile if created or enabled.</span><span class="sxs-lookup"><span data-stu-id="eb109-207">This transition state occurs when a profile if created or enabled.</span></span> <span data-ttu-id="eb109-208">The endpoint health is being checked for the first time.</span><span class="sxs-lookup"><span data-stu-id="eb109-208">The endpoint health is being checked for the first time.</span></span> |
| <span data-ttu-id="eb109-209">Enabled</span><span class="sxs-lookup"><span data-stu-id="eb109-209">Enabled</span></span> |<span data-ttu-id="eb109-210">The statuses of all endpoints in the profile are either Disabled or Stopped, or the profile has no defined endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-210">The statuses of all endpoints in the profile are either Disabled or Stopped, or the profile has no defined endpoints.</span></span> |<span data-ttu-id="eb109-211">Inactive</span><span class="sxs-lookup"><span data-stu-id="eb109-211">Inactive</span></span> |<span data-ttu-id="eb109-212">No endpoints are active, but the profile is still Enabled.</span><span class="sxs-lookup"><span data-stu-id="eb109-212">No endpoints are active, but the profile is still Enabled.</span></span> |

## <a name="endpoint-failover-and-recovery"></a><span data-ttu-id="eb109-213">Endpoint failover and recovery</span><span class="sxs-lookup"><span data-stu-id="eb109-213">Endpoint failover and recovery</span></span>

<span data-ttu-id="eb109-214">Traffic Manager periodically checks the health of every endpoint, including unhealthy endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-214">Traffic Manager periodically checks the health of every endpoint, including unhealthy endpoints.</span></span> <span data-ttu-id="eb109-215">Traffic Manager detects when an endpoint becomes healthy and brings it back into rotation.</span><span class="sxs-lookup"><span data-stu-id="eb109-215">Traffic Manager detects when an endpoint becomes healthy and brings it back into rotation.</span></span>

> [!NOTE]
> <span data-ttu-id="eb109-216">Traffic Manager only considers an endpoint to be online if the return message is 200 OK.</span><span class="sxs-lookup"><span data-stu-id="eb109-216">Traffic Manager only considers an endpoint to be online if the return message is 200 OK.</span></span> <span data-ttu-id="eb109-217">An endpoint is unhealthy when any of the following events occur:</span><span class="sxs-lookup"><span data-stu-id="eb109-217">An endpoint is unhealthy when any of the following events occur:</span></span>
>
> * <span data-ttu-id="eb109-218">A non-200 response is received (including a different 2xx code, or a 301/302 redirect)</span><span class="sxs-lookup"><span data-stu-id="eb109-218">A non-200 response is received (including a different 2xx code, or a 301/302 redirect)</span></span>
> * <span data-ttu-id="eb109-219">Request for client authentication</span><span class="sxs-lookup"><span data-stu-id="eb109-219">Request for client authentication</span></span>
> * <span data-ttu-id="eb109-220">Timeout (the timeout threshold is 10 seconds)</span><span class="sxs-lookup"><span data-stu-id="eb109-220">Timeout (the timeout threshold is 10 seconds)</span></span>
> * <span data-ttu-id="eb109-221">Unable to connect</span><span class="sxs-lookup"><span data-stu-id="eb109-221">Unable to connect</span></span>
>
> <span data-ttu-id="eb109-222">For more information about troubleshooting failed checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="eb109-222">For more information about troubleshooting failed checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span>

<span data-ttu-id="eb109-223">The following timeline is a detailed description of the monitoring process.</span><span class="sxs-lookup"><span data-stu-id="eb109-223">The following timeline is a detailed description of the monitoring process.</span></span>

![Traffic Manager endpoint failover and failback sequence](https://docstestmedia1.blob.core.windows.net/azure-media/articles/traffic-manager/media/traffic-manager-monitoring/timeline.png)

1. <span data-ttu-id="eb109-225">**GET**.</span><span class="sxs-lookup"><span data-stu-id="eb109-225">**GET**.</span></span> <span data-ttu-id="eb109-226">For each endpoint, the Traffic Manager monitoring system performs a GET request on the path and file specified in the monitoring settings.</span><span class="sxs-lookup"><span data-stu-id="eb109-226">For each endpoint, the Traffic Manager monitoring system performs a GET request on the path and file specified in the monitoring settings.</span></span>
2. <span data-ttu-id="eb109-227">**200 OK**.</span><span class="sxs-lookup"><span data-stu-id="eb109-227">**200 OK**.</span></span> <span data-ttu-id="eb109-228">The monitoring system expects an HTTP 200 OK message to be returned within 10 seconds.</span><span class="sxs-lookup"><span data-stu-id="eb109-228">The monitoring system expects an HTTP 200 OK message to be returned within 10 seconds.</span></span> <span data-ttu-id="eb109-229">When it receives this response, it recognizes that the service is available.</span><span class="sxs-lookup"><span data-stu-id="eb109-229">When it receives this response, it recognizes that the service is available.</span></span>
3. <span data-ttu-id="eb109-230">**30 seconds between checks**.</span><span class="sxs-lookup"><span data-stu-id="eb109-230">**30 seconds between checks**.</span></span> <span data-ttu-id="eb109-231">The endpoint health check is repeated every 30 seconds.</span><span class="sxs-lookup"><span data-stu-id="eb109-231">The endpoint health check is repeated every 30 seconds.</span></span>
4. <span data-ttu-id="eb109-232">**Service unavailable**.</span><span class="sxs-lookup"><span data-stu-id="eb109-232">**Service unavailable**.</span></span> <span data-ttu-id="eb109-233">The service becomes unavailable.</span><span class="sxs-lookup"><span data-stu-id="eb109-233">The service becomes unavailable.</span></span> <span data-ttu-id="eb109-234">Traffic Manager will not know until the next health check.</span><span class="sxs-lookup"><span data-stu-id="eb109-234">Traffic Manager will not know until the next health check.</span></span>
5. <span data-ttu-id="eb109-235">**Attempts to access monitoring file (four tries)**.</span><span class="sxs-lookup"><span data-stu-id="eb109-235">**Attempts to access monitoring file (four tries)**.</span></span> <span data-ttu-id="eb109-236">The monitoring system performs a GET request, but does not receive a response within the timeout period of 10 seconds (alternatively, a non-200 response may be received).</span><span class="sxs-lookup"><span data-stu-id="eb109-236">The monitoring system performs a GET request, but does not receive a response within the timeout period of 10 seconds (alternatively, a non-200 response may be received).</span></span> <span data-ttu-id="eb109-237">It then tries three more times, at 30-second intervals.</span><span class="sxs-lookup"><span data-stu-id="eb109-237">It then tries three more times, at 30-second intervals.</span></span> <span data-ttu-id="eb109-238">If one of the tries is successful, then the number of tries is reset.</span><span class="sxs-lookup"><span data-stu-id="eb109-238">If one of the tries is successful, then the number of tries is reset.</span></span>
6. <span data-ttu-id="eb109-239">**Status set to Degraded**.</span><span class="sxs-lookup"><span data-stu-id="eb109-239">**Status set to Degraded**.</span></span> <span data-ttu-id="eb109-240">After a fourth consecutive failure, the monitoring system marks the unavailable endpoint status as Degraded.</span><span class="sxs-lookup"><span data-stu-id="eb109-240">After a fourth consecutive failure, the monitoring system marks the unavailable endpoint status as Degraded.</span></span>
7. <span data-ttu-id="eb109-241">**Traffic is diverted to other endpoints**.</span><span class="sxs-lookup"><span data-stu-id="eb109-241">**Traffic is diverted to other endpoints**.</span></span> <span data-ttu-id="eb109-242">The Traffic Manager DNS name servers are updated and Traffic Manager no longer returns the endpoint in response to DNS queries.</span><span class="sxs-lookup"><span data-stu-id="eb109-242">The Traffic Manager DNS name servers are updated and Traffic Manager no longer returns the endpoint in response to DNS queries.</span></span> <span data-ttu-id="eb109-243">New connections are directed to other, available endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-243">New connections are directed to other, available endpoints.</span></span> <span data-ttu-id="eb109-244">However, previous DNS responses that include this endpoint may still be cached by recursive DNS servers and DNS clients.</span><span class="sxs-lookup"><span data-stu-id="eb109-244">However, previous DNS responses that include this endpoint may still be cached by recursive DNS servers and DNS clients.</span></span> <span data-ttu-id="eb109-245">Clients continue to use the endpoint until the DNS cache expires.</span><span class="sxs-lookup"><span data-stu-id="eb109-245">Clients continue to use the endpoint until the DNS cache expires.</span></span> <span data-ttu-id="eb109-246">As the DNS cache expires, clients make new DNS queries and are directed to different endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-246">As the DNS cache expires, clients make new DNS queries and are directed to different endpoints.</span></span> <span data-ttu-id="eb109-247">The cache duration is controlled by the TTL setting in the Traffic Manager profile, for example, 30 seconds.</span><span class="sxs-lookup"><span data-stu-id="eb109-247">The cache duration is controlled by the TTL setting in the Traffic Manager profile, for example, 30 seconds.</span></span>
8. <span data-ttu-id="eb109-248">**Health checks continue**.</span><span class="sxs-lookup"><span data-stu-id="eb109-248">**Health checks continue**.</span></span> <span data-ttu-id="eb109-249">Traffic Manager continues to check the health of the endpoint while it has a Degraded status.</span><span class="sxs-lookup"><span data-stu-id="eb109-249">Traffic Manager continues to check the health of the endpoint while it has a Degraded status.</span></span> <span data-ttu-id="eb109-250">Traffic Manager detects when the endpoint returns to health.</span><span class="sxs-lookup"><span data-stu-id="eb109-250">Traffic Manager detects when the endpoint returns to health.</span></span>
9. <span data-ttu-id="eb109-251">**Service comes back online**.</span><span class="sxs-lookup"><span data-stu-id="eb109-251">**Service comes back online**.</span></span> <span data-ttu-id="eb109-252">The service becomes available.</span><span class="sxs-lookup"><span data-stu-id="eb109-252">The service becomes available.</span></span> <span data-ttu-id="eb109-253">The endpoint retains its Degraded status in Traffic Manager until the monitoring system performs its next health check.</span><span class="sxs-lookup"><span data-stu-id="eb109-253">The endpoint retains its Degraded status in Traffic Manager until the monitoring system performs its next health check.</span></span>
10. <span data-ttu-id="eb109-254">**Traffic to service resumes**.</span><span class="sxs-lookup"><span data-stu-id="eb109-254">**Traffic to service resumes**.</span></span> <span data-ttu-id="eb109-255">Traffic Manager sends a GET request and receives a 200 OK status response.</span><span class="sxs-lookup"><span data-stu-id="eb109-255">Traffic Manager sends a GET request and receives a 200 OK status response.</span></span> <span data-ttu-id="eb109-256">The service has returned to a healthy state.</span><span class="sxs-lookup"><span data-stu-id="eb109-256">The service has returned to a healthy state.</span></span> <span data-ttu-id="eb109-257">The Traffic Manager name servers are updated, and they begin to hand out the service's DNS name in DNS responses.</span><span class="sxs-lookup"><span data-stu-id="eb109-257">The Traffic Manager name servers are updated, and they begin to hand out the service's DNS name in DNS responses.</span></span> <span data-ttu-id="eb109-258">Traffic returns to the endpoint as cached DNS responses that return other endpoints expire, and as existing connections to other endpoints are terminated.</span><span class="sxs-lookup"><span data-stu-id="eb109-258">Traffic returns to the endpoint as cached DNS responses that return other endpoints expire, and as existing connections to other endpoints are terminated.</span></span>

> [!NOTE]
> <span data-ttu-id="eb109-259">Because Traffic Manager works at the DNS level, it cannot influence existing connections to any endpoint.</span><span class="sxs-lookup"><span data-stu-id="eb109-259">Because Traffic Manager works at the DNS level, it cannot influence existing connections to any endpoint.</span></span> <span data-ttu-id="eb109-260">When it directs traffic between endpoints (either by changed profile settings, or during failover or failback), Traffic Manager directs new connections to available endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-260">When it directs traffic between endpoints (either by changed profile settings, or during failover or failback), Traffic Manager directs new connections to available endpoints.</span></span> <span data-ttu-id="eb109-261">However, other endpoints might continue to receive traffic via existing connections until those sessions are terminated.</span><span class="sxs-lookup"><span data-stu-id="eb109-261">However, other endpoints might continue to receive traffic via existing connections until those sessions are terminated.</span></span> <span data-ttu-id="eb109-262">To enable traffic to drain from existing connections, applications should limit the session duration used with each endpoint.</span><span class="sxs-lookup"><span data-stu-id="eb109-262">To enable traffic to drain from existing connections, applications should limit the session duration used with each endpoint.</span></span>

## <a name="traffic-routing-methods"></a><span data-ttu-id="eb109-263">Traffic-routing methods</span><span class="sxs-lookup"><span data-stu-id="eb109-263">Traffic-routing methods</span></span>

<span data-ttu-id="eb109-264">When an endpoint has a Degraded status, it is no longer returned in response to DNS queries.</span><span class="sxs-lookup"><span data-stu-id="eb109-264">When an endpoint has a Degraded status, it is no longer returned in response to DNS queries.</span></span> <span data-ttu-id="eb109-265">Instead, an alternative endpoint is chosen and returned.</span><span class="sxs-lookup"><span data-stu-id="eb109-265">Instead, an alternative endpoint is chosen and returned.</span></span> <span data-ttu-id="eb109-266">The traffic-routing method configured in the profile determines how the alternative endpoint is chosen.</span><span class="sxs-lookup"><span data-stu-id="eb109-266">The traffic-routing method configured in the profile determines how the alternative endpoint is chosen.</span></span>

* <span data-ttu-id="eb109-267">**Priority**.</span><span class="sxs-lookup"><span data-stu-id="eb109-267">**Priority**.</span></span> <span data-ttu-id="eb109-268">Endpoints form a prioritized list.</span><span class="sxs-lookup"><span data-stu-id="eb109-268">Endpoints form a prioritized list.</span></span> <span data-ttu-id="eb109-269">The first available endpoint on the list is always returned.</span><span class="sxs-lookup"><span data-stu-id="eb109-269">The first available endpoint on the list is always returned.</span></span> <span data-ttu-id="eb109-270">If an endpoint status is Degraded, then the next available endpoint is returned.</span><span class="sxs-lookup"><span data-stu-id="eb109-270">If an endpoint status is Degraded, then the next available endpoint is returned.</span></span>
* <span data-ttu-id="eb109-271">**Weighted**.</span><span class="sxs-lookup"><span data-stu-id="eb109-271">**Weighted**.</span></span> <span data-ttu-id="eb109-272">Any available endpoint is chosen at random based on their assigned weights and the weights of the other available endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-272">Any available endpoint is chosen at random based on their assigned weights and the weights of the other available endpoints.</span></span>
* <span data-ttu-id="eb109-273">**Performance**.</span><span class="sxs-lookup"><span data-stu-id="eb109-273">**Performance**.</span></span> <span data-ttu-id="eb109-274">The endpoint closest to the end user is returned.</span><span class="sxs-lookup"><span data-stu-id="eb109-274">The endpoint closest to the end user is returned.</span></span> <span data-ttu-id="eb109-275">If that endpoint is unavailable, an endpoint is randomly chosen from all the other available endpoints.</span><span class="sxs-lookup"><span data-stu-id="eb109-275">If that endpoint is unavailable, an endpoint is randomly chosen from all the other available endpoints.</span></span> <span data-ttu-id="eb109-276">Choosing a random endpoint avoids a cascading failure that can occur when the next-closest endpoint becomes overloaded.</span><span class="sxs-lookup"><span data-stu-id="eb109-276">Choosing a random endpoint avoids a cascading failure that can occur when the next-closest endpoint becomes overloaded.</span></span> <span data-ttu-id="eb109-277">You can configure alternative failover plans for performance traffic-routing by using [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span><span class="sxs-lookup"><span data-stu-id="eb109-277">You can configure alternative failover plans for performance traffic-routing by using [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span></span>

<span data-ttu-id="eb109-278">For more information, see [Traffic Manager traffic-routing methods](traffic-manager-routing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="eb109-278">For more information, see [Traffic Manager traffic-routing methods](traffic-manager-routing-methods.md).</span></span>

> [!NOTE]
> <span data-ttu-id="eb109-279">One exception to normal traffic-routing behavior occurs when all eligible endpoints have a degraded status.</span><span class="sxs-lookup"><span data-stu-id="eb109-279">One exception to normal traffic-routing behavior occurs when all eligible endpoints have a degraded status.</span></span> <span data-ttu-id="eb109-280">Traffic Manager makes a "best effort" attempt and *responds as if all the Degraded status endpoints actually are in an online state*.</span><span class="sxs-lookup"><span data-stu-id="eb109-280">Traffic Manager makes a "best effort" attempt and *responds as if all the Degraded status endpoints actually are in an online state*.</span></span> <span data-ttu-id="eb109-281">This behavior is preferable to the alternative, which would be to not return any endpoint in the DNS response.</span><span class="sxs-lookup"><span data-stu-id="eb109-281">This behavior is preferable to the alternative, which would be to not return any endpoint in the DNS response.</span></span> <span data-ttu-id="eb109-282">Disabled or Stopped endpoints are not monitored, therefore, they are not considered eligible for traffic.</span><span class="sxs-lookup"><span data-stu-id="eb109-282">Disabled or Stopped endpoints are not monitored, therefore, they are not considered eligible for traffic.</span></span>
>
> <span data-ttu-id="eb109-283">This condition is commonly caused by improper configuration of the service, such as:</span><span class="sxs-lookup"><span data-stu-id="eb109-283">This condition is commonly caused by improper configuration of the service, such as:</span></span>
>
> * <span data-ttu-id="eb109-284">An access control list [ACL] blocking the Traffic Manager health checks</span><span class="sxs-lookup"><span data-stu-id="eb109-284">An access control list [ACL] blocking the Traffic Manager health checks</span></span>
> * <span data-ttu-id="eb109-285">An improper configuration of the monitoring path in the Traffic manager profile</span><span class="sxs-lookup"><span data-stu-id="eb109-285">An improper configuration of the monitoring path in the Traffic manager profile</span></span>
>
> <span data-ttu-id="eb109-286">The consequence of this behavior is that if Traffic Manager health checks are not configured correctly, it might appear from the traffic routing as though Traffic Manager *is* working properly.</span><span class="sxs-lookup"><span data-stu-id="eb109-286">The consequence of this behavior is that if Traffic Manager health checks are not configured correctly, it might appear from the traffic routing as though Traffic Manager *is* working properly.</span></span> <span data-ttu-id="eb109-287">However, in this case, endpoint failover cannot happen which affects overall application availability.</span><span class="sxs-lookup"><span data-stu-id="eb109-287">However, in this case, endpoint failover cannot happen which affects overall application availability.</span></span> <span data-ttu-id="eb109-288">It is important to check that the profile shows an Online status, not a Degraded status.</span><span class="sxs-lookup"><span data-stu-id="eb109-288">It is important to check that the profile shows an Online status, not a Degraded status.</span></span> <span data-ttu-id="eb109-289">An Online status indicates that the Traffic Manager health checks are working as expected.</span><span class="sxs-lookup"><span data-stu-id="eb109-289">An Online status indicates that the Traffic Manager health checks are working as expected.</span></span>

<span data-ttu-id="eb109-290">For more information about troubleshooting failed health checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="eb109-290">For more information about troubleshooting failed health checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span>



## <a name="next-steps"></a><span data-ttu-id="eb109-291">Next steps</span><span class="sxs-lookup"><span data-stu-id="eb109-291">Next steps</span></span>

<span data-ttu-id="eb109-292">Learn [how Traffic Manager works](traffic-manager-how-traffic-manager-works.md)</span><span class="sxs-lookup"><span data-stu-id="eb109-292">Learn [how Traffic Manager works](traffic-manager-how-traffic-manager-works.md)</span></span>

<span data-ttu-id="eb109-293">Learn more about the [traffic-routing methods](traffic-manager-routing-methods.md) supported by Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="eb109-293">Learn more about the [traffic-routing methods](traffic-manager-routing-methods.md) supported by Traffic Manager</span></span>

<span data-ttu-id="eb109-294">Learn how to [create a Traffic Manager profile](traffic-manager-manage-profiles.md)</span><span class="sxs-lookup"><span data-stu-id="eb109-294">Learn how to [create a Traffic Manager profile](traffic-manager-manage-profiles.md)</span></span>

<span data-ttu-id="eb109-295">[Troubleshoot Degraded status](traffic-manager-troubleshooting-degraded.md) on a Traffic Manager endpoint</span><span class="sxs-lookup"><span data-stu-id="eb109-295">[Troubleshoot Degraded status](traffic-manager-troubleshooting-degraded.md) on a Traffic Manager endpoint</span></span>

