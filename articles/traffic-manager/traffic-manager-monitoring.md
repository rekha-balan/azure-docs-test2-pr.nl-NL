---
title: Azure Traffic Manager endpoint monitoring | Microsoft Docs
description: This article can help you understand how Traffic Manager uses endpoint monitoring and automatic endpoint failover to help Azure customers deploy high-availability applications
services: traffic-manager
documentationcenter: ''
author: kumudd
manager: timlt
editor: ''
ms.assetid: fff25ac3-d13a-4af9-8916-7c72e3d64bc7
ms.service: traffic-manager
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: infrastructure-services
ms.date: 06/22/2017
ms.author: kumud
ms.openlocfilehash: 0124c70916d1c9a6f6b818a68f13d7a189a1b70f
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44829179"
---
# <a name="traffic-manager-endpoint-monitoring"></a><span data-ttu-id="1aa96-103">Traffic Manager endpoint monitoring</span><span class="sxs-lookup"><span data-stu-id="1aa96-103">Traffic Manager endpoint monitoring</span></span>

<span data-ttu-id="1aa96-104">Azure Traffic Manager includes built-in endpoint monitoring and automatic endpoint failover.</span><span class="sxs-lookup"><span data-stu-id="1aa96-104">Azure Traffic Manager includes built-in endpoint monitoring and automatic endpoint failover.</span></span> <span data-ttu-id="1aa96-105">This feature helps you deliver high-availability applications that are resilient to endpoint failure, including Azure region failures.</span><span class="sxs-lookup"><span data-stu-id="1aa96-105">This feature helps you deliver high-availability applications that are resilient to endpoint failure, including Azure region failures.</span></span>

## <a name="configure-endpoint-monitoring"></a><span data-ttu-id="1aa96-106">Configure endpoint monitoring</span><span class="sxs-lookup"><span data-stu-id="1aa96-106">Configure endpoint monitoring</span></span>

<span data-ttu-id="1aa96-107">To configure endpoint monitoring, you must specify the following settings on your Traffic Manager profile:</span><span class="sxs-lookup"><span data-stu-id="1aa96-107">To configure endpoint monitoring, you must specify the following settings on your Traffic Manager profile:</span></span>

* <span data-ttu-id="1aa96-108">**Protocol**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-108">**Protocol**.</span></span> <span data-ttu-id="1aa96-109">Choose HTTP, HTTPS, or TCP as the protocol that Traffic Manager uses when probing your endpoint to check its health.</span><span class="sxs-lookup"><span data-stu-id="1aa96-109">Choose HTTP, HTTPS, or TCP as the protocol that Traffic Manager uses when probing your endpoint to check its health.</span></span> <span data-ttu-id="1aa96-110">HTTPS monitoring does not verify whether your SSL certificate is valid--it only checks that the certificate is present.</span><span class="sxs-lookup"><span data-stu-id="1aa96-110">HTTPS monitoring does not verify whether your SSL certificate is valid--it only checks that the certificate is present.</span></span>
* <span data-ttu-id="1aa96-111">**Port**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-111">**Port**.</span></span> <span data-ttu-id="1aa96-112">Choose the port used for the request.</span><span class="sxs-lookup"><span data-stu-id="1aa96-112">Choose the port used for the request.</span></span>
* <span data-ttu-id="1aa96-113">**Path**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-113">**Path**.</span></span> <span data-ttu-id="1aa96-114">This configuration setting is valid only for the HTTP and HTTPS protocols, for which specifying the path setting is required.</span><span class="sxs-lookup"><span data-stu-id="1aa96-114">This configuration setting is valid only for the HTTP and HTTPS protocols, for which specifying the path setting is required.</span></span> <span data-ttu-id="1aa96-115">Providing this setting for the TCP monitoring protocol results in an error.</span><span class="sxs-lookup"><span data-stu-id="1aa96-115">Providing this setting for the TCP monitoring protocol results in an error.</span></span> <span data-ttu-id="1aa96-116">For  HTTP and HTTPS protocol, give the relative path and the name of the webpage or the file that the monitoring accesses.</span><span class="sxs-lookup"><span data-stu-id="1aa96-116">For  HTTP and HTTPS protocol, give the relative path and the name of the webpage or the file that the monitoring accesses.</span></span> <span data-ttu-id="1aa96-117">A forward slash (/) is a valid entry for the relative path.</span><span class="sxs-lookup"><span data-stu-id="1aa96-117">A forward slash (/) is a valid entry for the relative path.</span></span> <span data-ttu-id="1aa96-118">This value implies that the file is in the root directory (default).</span><span class="sxs-lookup"><span data-stu-id="1aa96-118">This value implies that the file is in the root directory (default).</span></span>
* <span data-ttu-id="1aa96-119">**Probing Interval**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-119">**Probing Interval**.</span></span> <span data-ttu-id="1aa96-120">This value specifies how often an endpoint is checked for its health from a Traffic Manager probing agent.</span><span class="sxs-lookup"><span data-stu-id="1aa96-120">This value specifies how often an endpoint is checked for its health from a Traffic Manager probing agent.</span></span> <span data-ttu-id="1aa96-121">You can specify two values here: 30 seconds (normal probing) and 10 seconds (fast probing).</span><span class="sxs-lookup"><span data-stu-id="1aa96-121">You can specify two values here: 30 seconds (normal probing) and 10 seconds (fast probing).</span></span> <span data-ttu-id="1aa96-122">If no values are provided, the profile sets to a default value of 30 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-122">If no values are provided, the profile sets to a default value of 30 seconds.</span></span> <span data-ttu-id="1aa96-123">Visit the [Traffic Manager Pricing](https://azure.microsoft.com/pricing/details/traffic-manager) page to learn more about fast probing pricing.</span><span class="sxs-lookup"><span data-stu-id="1aa96-123">Visit the [Traffic Manager Pricing](https://azure.microsoft.com/pricing/details/traffic-manager) page to learn more about fast probing pricing.</span></span>
* <span data-ttu-id="1aa96-124">**Tolerated Number of Failures**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-124">**Tolerated Number of Failures**.</span></span> <span data-ttu-id="1aa96-125">This value specifies how many failures a Traffic Manager probing agent tolerates before marking that endpoint as unhealthy.</span><span class="sxs-lookup"><span data-stu-id="1aa96-125">This value specifies how many failures a Traffic Manager probing agent tolerates before marking that endpoint as unhealthy.</span></span> <span data-ttu-id="1aa96-126">Its value can range between 0 and 9.</span><span class="sxs-lookup"><span data-stu-id="1aa96-126">Its value can range between 0 and 9.</span></span> <span data-ttu-id="1aa96-127">A value of 0 means a single monitoring failure can cause that endpoint to be marked as unhealthy.</span><span class="sxs-lookup"><span data-stu-id="1aa96-127">A value of 0 means a single monitoring failure can cause that endpoint to be marked as unhealthy.</span></span> <span data-ttu-id="1aa96-128">If no value is specified, it uses the default value of 3.</span><span class="sxs-lookup"><span data-stu-id="1aa96-128">If no value is specified, it uses the default value of 3.</span></span>
* <span data-ttu-id="1aa96-129">**Monitoring Timeout**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-129">**Monitoring Timeout**.</span></span> <span data-ttu-id="1aa96-130">This property specifies the amount of time the Traffic Manager probing agent should wait before considering that check a failure when a health check probe is sent to the endpoint.</span><span class="sxs-lookup"><span data-stu-id="1aa96-130">This property specifies the amount of time the Traffic Manager probing agent should wait before considering that check a failure when a health check probe is sent to the endpoint.</span></span> <span data-ttu-id="1aa96-131">If the Probing Interval is set to 30 seconds, then you can set the Timeout value between 5 and 10 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-131">If the Probing Interval is set to 30 seconds, then you can set the Timeout value between 5 and 10 seconds.</span></span> <span data-ttu-id="1aa96-132">If no value is specified, it uses a default value of 10 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-132">If no value is specified, it uses a default value of 10 seconds.</span></span> <span data-ttu-id="1aa96-133">If the Probing Interval is set to 10 seconds, then you can set the Timeout value between 5 and 9 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-133">If the Probing Interval is set to 10 seconds, then you can set the Timeout value between 5 and 9 seconds.</span></span> <span data-ttu-id="1aa96-134">If no Timeout value is specified, it uses a default value of 9 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-134">If no Timeout value is specified, it uses a default value of 9 seconds.</span></span>

![Traffic Manager endpoint monitoring](./media/traffic-manager-monitoring/endpoint-monitoring-settings.png)

<span data-ttu-id="1aa96-136">**Figure 1:  Traffic Manager endpoint monitoring**</span><span class="sxs-lookup"><span data-stu-id="1aa96-136">**Figure 1:  Traffic Manager endpoint monitoring**</span></span>

## <a name="how-endpoint-monitoring-works"></a><span data-ttu-id="1aa96-137">How endpoint monitoring works</span><span class="sxs-lookup"><span data-stu-id="1aa96-137">How endpoint monitoring works</span></span>

<span data-ttu-id="1aa96-138">If the monitoring protocol is set as HTTP or HTTPS, the Traffic Manager probing agent makes a GET request to the endpoint using the protocol, port, and relative path given.</span><span class="sxs-lookup"><span data-stu-id="1aa96-138">If the monitoring protocol is set as HTTP or HTTPS, the Traffic Manager probing agent makes a GET request to the endpoint using the protocol, port, and relative path given.</span></span> <span data-ttu-id="1aa96-139">If it gets back a 200-OK response, then that endpoint is considered healthy.</span><span class="sxs-lookup"><span data-stu-id="1aa96-139">If it gets back a 200-OK response, then that endpoint is considered healthy.</span></span> <span data-ttu-id="1aa96-140">If the response is a different value, or, if no response is received within the timeout period specified, then the Traffic Manager probing agent re-attempts according to the Tolerated Number of Failures setting (no re-attempts are done if this setting is 0).</span><span class="sxs-lookup"><span data-stu-id="1aa96-140">If the response is a different value, or, if no response is received within the timeout period specified, then the Traffic Manager probing agent re-attempts according to the Tolerated Number of Failures setting (no re-attempts are done if this setting is 0).</span></span> <span data-ttu-id="1aa96-141">If the number of consecutive failures is higher than the Tolerated Number of Failures setting, then that endpoint is marked as unhealthy.</span><span class="sxs-lookup"><span data-stu-id="1aa96-141">If the number of consecutive failures is higher than the Tolerated Number of Failures setting, then that endpoint is marked as unhealthy.</span></span> 

<span data-ttu-id="1aa96-142">If the monitoring protocol is TCP, the Traffic Manager probing agent initiates a TCP connection request using the port specified.</span><span class="sxs-lookup"><span data-stu-id="1aa96-142">If the monitoring protocol is TCP, the Traffic Manager probing agent initiates a TCP connection request using the port specified.</span></span> <span data-ttu-id="1aa96-143">If the endpoint responds to the request with a response to establish the connection, that health check is marked as a success and the Traffic Manager probing agent resets the TCP connection.</span><span class="sxs-lookup"><span data-stu-id="1aa96-143">If the endpoint responds to the request with a response to establish the connection, that health check is marked as a success and the Traffic Manager probing agent resets the TCP connection.</span></span> <span data-ttu-id="1aa96-144">If the response is a different value, or if no response is received within the timeout period specified, the Traffic Manager probing agent re-attempts according to the Tolerated Number of Failures setting (no re-attempts are made if this setting is 0).</span><span class="sxs-lookup"><span data-stu-id="1aa96-144">If the response is a different value, or if no response is received within the timeout period specified, the Traffic Manager probing agent re-attempts according to the Tolerated Number of Failures setting (no re-attempts are made if this setting is 0).</span></span> <span data-ttu-id="1aa96-145">If the number of consecutive failures is higher than the Tolerated Number of Failures setting, then that endpoint is marked unhealthy.</span><span class="sxs-lookup"><span data-stu-id="1aa96-145">If the number of consecutive failures is higher than the Tolerated Number of Failures setting, then that endpoint is marked unhealthy.</span></span>

<span data-ttu-id="1aa96-146">In all cases, Traffic Manager probes from multiple locations and the consecutive failure determination happens within each region.</span><span class="sxs-lookup"><span data-stu-id="1aa96-146">In all cases, Traffic Manager probes from multiple locations and the consecutive failure determination happens within each region.</span></span> <span data-ttu-id="1aa96-147">This also means that endpoints are receiving health probes from Traffic Manager with a higher frequency than the setting used for Probing Interval.</span><span class="sxs-lookup"><span data-stu-id="1aa96-147">This also means that endpoints are receiving health probes from Traffic Manager with a higher frequency than the setting used for Probing Interval.</span></span>

>[!NOTE]
><span data-ttu-id="1aa96-148">For HTTP or HTTPS monitoring protocol, a common practice on the endpoint side is to implement a custom page within your application - for example, /health.aspx.</span><span class="sxs-lookup"><span data-stu-id="1aa96-148">For HTTP or HTTPS monitoring protocol, a common practice on the endpoint side is to implement a custom page within your application - for example, /health.aspx.</span></span> <span data-ttu-id="1aa96-149">Using this path for monitoring, you can perform application-specific checks, such as checking performance counters or verifying database availability.</span><span class="sxs-lookup"><span data-stu-id="1aa96-149">Using this path for monitoring, you can perform application-specific checks, such as checking performance counters or verifying database availability.</span></span> <span data-ttu-id="1aa96-150">Based on these custom checks, the page returns an appropriate HTTP status code.</span><span class="sxs-lookup"><span data-stu-id="1aa96-150">Based on these custom checks, the page returns an appropriate HTTP status code.</span></span>

<span data-ttu-id="1aa96-151">All endpoints in a Traffic Manager profile share monitoring settings.</span><span class="sxs-lookup"><span data-stu-id="1aa96-151">All endpoints in a Traffic Manager profile share monitoring settings.</span></span> <span data-ttu-id="1aa96-152">If you need to use different monitoring settings for different endpoints, you can create [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span><span class="sxs-lookup"><span data-stu-id="1aa96-152">If you need to use different monitoring settings for different endpoints, you can create [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-5-per-endpoint-monitoring-settings).</span></span>

## <a name="endpoint-and-profile-status"></a><span data-ttu-id="1aa96-153">Endpoint and profile status</span><span class="sxs-lookup"><span data-stu-id="1aa96-153">Endpoint and profile status</span></span>

<span data-ttu-id="1aa96-154">You can enable and disable Traffic Manager profiles and endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-154">You can enable and disable Traffic Manager profiles and endpoints.</span></span> <span data-ttu-id="1aa96-155">However, a change in endpoint status also might occur as a result of Traffic Manager automated settings and processes.</span><span class="sxs-lookup"><span data-stu-id="1aa96-155">However, a change in endpoint status also might occur as a result of Traffic Manager automated settings and processes.</span></span>

### <a name="endpoint-status"></a><span data-ttu-id="1aa96-156">Endpoint status</span><span class="sxs-lookup"><span data-stu-id="1aa96-156">Endpoint status</span></span>

<span data-ttu-id="1aa96-157">You can enable or disable a specific endpoint.</span><span class="sxs-lookup"><span data-stu-id="1aa96-157">You can enable or disable a specific endpoint.</span></span> <span data-ttu-id="1aa96-158">The underlying service, which might still be healthy, is unaffected.</span><span class="sxs-lookup"><span data-stu-id="1aa96-158">The underlying service, which might still be healthy, is unaffected.</span></span> <span data-ttu-id="1aa96-159">Changing the endpoint status controls the availability of the endpoint in the Traffic Manager profile.</span><span class="sxs-lookup"><span data-stu-id="1aa96-159">Changing the endpoint status controls the availability of the endpoint in the Traffic Manager profile.</span></span> <span data-ttu-id="1aa96-160">When an endpoint status is disabled, Traffic Manager does not check its health and the endpoint is not included in a DNS response.</span><span class="sxs-lookup"><span data-stu-id="1aa96-160">When an endpoint status is disabled, Traffic Manager does not check its health and the endpoint is not included in a DNS response.</span></span>

### <a name="profile-status"></a><span data-ttu-id="1aa96-161">Profile status</span><span class="sxs-lookup"><span data-stu-id="1aa96-161">Profile status</span></span>

<span data-ttu-id="1aa96-162">Using the profile status setting, you can enable or disable a specific profile.</span><span class="sxs-lookup"><span data-stu-id="1aa96-162">Using the profile status setting, you can enable or disable a specific profile.</span></span> <span data-ttu-id="1aa96-163">While endpoint status affects a single endpoint, profile status affects the entire profile, including all endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-163">While endpoint status affects a single endpoint, profile status affects the entire profile, including all endpoints.</span></span> <span data-ttu-id="1aa96-164">When you disable a profile, the endpoints are not checked for health and no endpoints are included in a DNS response.</span><span class="sxs-lookup"><span data-stu-id="1aa96-164">When you disable a profile, the endpoints are not checked for health and no endpoints are included in a DNS response.</span></span> <span data-ttu-id="1aa96-165">An [NXDOMAIN](https://tools.ietf.org/html/rfc2308) response code is returned for the DNS query.</span><span class="sxs-lookup"><span data-stu-id="1aa96-165">An [NXDOMAIN](https://tools.ietf.org/html/rfc2308) response code is returned for the DNS query.</span></span>

### <a name="endpoint-monitor-status"></a><span data-ttu-id="1aa96-166">Endpoint monitor status</span><span class="sxs-lookup"><span data-stu-id="1aa96-166">Endpoint monitor status</span></span>

<span data-ttu-id="1aa96-167">Endpoint monitor status is a Traffic Manager-generated value that shows the status of the endpoint.</span><span class="sxs-lookup"><span data-stu-id="1aa96-167">Endpoint monitor status is a Traffic Manager-generated value that shows the status of the endpoint.</span></span> <span data-ttu-id="1aa96-168">You cannot change this setting manually.</span><span class="sxs-lookup"><span data-stu-id="1aa96-168">You cannot change this setting manually.</span></span> <span data-ttu-id="1aa96-169">The endpoint monitor status is a combination of the results of endpoint monitoring and the configured endpoint status.</span><span class="sxs-lookup"><span data-stu-id="1aa96-169">The endpoint monitor status is a combination of the results of endpoint monitoring and the configured endpoint status.</span></span> <span data-ttu-id="1aa96-170">The possible values of endpoint monitor status are shown in the following table:</span><span class="sxs-lookup"><span data-stu-id="1aa96-170">The possible values of endpoint monitor status are shown in the following table:</span></span>

| <span data-ttu-id="1aa96-171">Profile status</span><span class="sxs-lookup"><span data-stu-id="1aa96-171">Profile status</span></span> | <span data-ttu-id="1aa96-172">Endpoint status</span><span class="sxs-lookup"><span data-stu-id="1aa96-172">Endpoint status</span></span> | <span data-ttu-id="1aa96-173">Endpoint monitor status</span><span class="sxs-lookup"><span data-stu-id="1aa96-173">Endpoint monitor status</span></span> | <span data-ttu-id="1aa96-174">Notes</span><span class="sxs-lookup"><span data-stu-id="1aa96-174">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="1aa96-175">Disabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-175">Disabled</span></span> |<span data-ttu-id="1aa96-176">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-176">Enabled</span></span> |<span data-ttu-id="1aa96-177">Inactive</span><span class="sxs-lookup"><span data-stu-id="1aa96-177">Inactive</span></span> |<span data-ttu-id="1aa96-178">The profile has been disabled.</span><span class="sxs-lookup"><span data-stu-id="1aa96-178">The profile has been disabled.</span></span> <span data-ttu-id="1aa96-179">Although the endpoint status is Enabled, the profile status (Disabled) takes precedence.</span><span class="sxs-lookup"><span data-stu-id="1aa96-179">Although the endpoint status is Enabled, the profile status (Disabled) takes precedence.</span></span> <span data-ttu-id="1aa96-180">Endpoints in disabled profiles are not monitored.</span><span class="sxs-lookup"><span data-stu-id="1aa96-180">Endpoints in disabled profiles are not monitored.</span></span> <span data-ttu-id="1aa96-181">An NXDOMAIN response code is returned for the DNS query.</span><span class="sxs-lookup"><span data-stu-id="1aa96-181">An NXDOMAIN response code is returned for the DNS query.</span></span> |
| <span data-ttu-id="1aa96-182">&lt;any&gt;</span><span class="sxs-lookup"><span data-stu-id="1aa96-182">&lt;any&gt;</span></span> |<span data-ttu-id="1aa96-183">Disabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-183">Disabled</span></span> |<span data-ttu-id="1aa96-184">Disabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-184">Disabled</span></span> |<span data-ttu-id="1aa96-185">The endpoint has been disabled.</span><span class="sxs-lookup"><span data-stu-id="1aa96-185">The endpoint has been disabled.</span></span> <span data-ttu-id="1aa96-186">Disabled endpoints are not monitored.</span><span class="sxs-lookup"><span data-stu-id="1aa96-186">Disabled endpoints are not monitored.</span></span> <span data-ttu-id="1aa96-187">The endpoint is not included in DNS responses, therefore, it does not receive traffic.</span><span class="sxs-lookup"><span data-stu-id="1aa96-187">The endpoint is not included in DNS responses, therefore, it does not receive traffic.</span></span> |
| <span data-ttu-id="1aa96-188">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-188">Enabled</span></span> |<span data-ttu-id="1aa96-189">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-189">Enabled</span></span> |<span data-ttu-id="1aa96-190">Online</span><span class="sxs-lookup"><span data-stu-id="1aa96-190">Online</span></span> |<span data-ttu-id="1aa96-191">The endpoint is monitored and is healthy.</span><span class="sxs-lookup"><span data-stu-id="1aa96-191">The endpoint is monitored and is healthy.</span></span> <span data-ttu-id="1aa96-192">It is included in DNS responses and can receive traffic.</span><span class="sxs-lookup"><span data-stu-id="1aa96-192">It is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="1aa96-193">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-193">Enabled</span></span> |<span data-ttu-id="1aa96-194">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-194">Enabled</span></span> |<span data-ttu-id="1aa96-195">Degraded</span><span class="sxs-lookup"><span data-stu-id="1aa96-195">Degraded</span></span> |<span data-ttu-id="1aa96-196">Endpoint monitoring health checks are failing.</span><span class="sxs-lookup"><span data-stu-id="1aa96-196">Endpoint monitoring health checks are failing.</span></span> <span data-ttu-id="1aa96-197">The endpoint is not included in DNS responses and does not receive traffic.</span><span class="sxs-lookup"><span data-stu-id="1aa96-197">The endpoint is not included in DNS responses and does not receive traffic.</span></span> <br><span data-ttu-id="1aa96-198">An exception to this is if all endpoints are degraded, in which case all of them are considered to be returned in the query response).</span><span class="sxs-lookup"><span data-stu-id="1aa96-198">An exception to this is if all endpoints are degraded, in which case all of them are considered to be returned in the query response).</span></span></br>|
| <span data-ttu-id="1aa96-199">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-199">Enabled</span></span> |<span data-ttu-id="1aa96-200">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-200">Enabled</span></span> |<span data-ttu-id="1aa96-201">CheckingEndpoint</span><span class="sxs-lookup"><span data-stu-id="1aa96-201">CheckingEndpoint</span></span> |<span data-ttu-id="1aa96-202">The endpoint is monitored, but the results of the first probe have not been received yet.</span><span class="sxs-lookup"><span data-stu-id="1aa96-202">The endpoint is monitored, but the results of the first probe have not been received yet.</span></span> <span data-ttu-id="1aa96-203">CheckingEndpoint is a temporary state that usually occurs immediately after adding or enabling an endpoint in the profile.</span><span class="sxs-lookup"><span data-stu-id="1aa96-203">CheckingEndpoint is a temporary state that usually occurs immediately after adding or enabling an endpoint in the profile.</span></span> <span data-ttu-id="1aa96-204">An endpoint in this state is included in DNS responses and can receive traffic.</span><span class="sxs-lookup"><span data-stu-id="1aa96-204">An endpoint in this state is included in DNS responses and can receive traffic.</span></span> |
| <span data-ttu-id="1aa96-205">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-205">Enabled</span></span> |<span data-ttu-id="1aa96-206">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-206">Enabled</span></span> |<span data-ttu-id="1aa96-207">Stopped</span><span class="sxs-lookup"><span data-stu-id="1aa96-207">Stopped</span></span> |<span data-ttu-id="1aa96-208">The cloud service or web app that the endpoint points to is not running.</span><span class="sxs-lookup"><span data-stu-id="1aa96-208">The cloud service or web app that the endpoint points to is not running.</span></span> <span data-ttu-id="1aa96-209">Check the cloud service or web app settings.</span><span class="sxs-lookup"><span data-stu-id="1aa96-209">Check the cloud service or web app settings.</span></span> <span data-ttu-id="1aa96-210">This can also happen if the endpoint is of type nested endpoint and the child profile is disabled or is inactive.</span><span class="sxs-lookup"><span data-stu-id="1aa96-210">This can also happen if the endpoint is of type nested endpoint and the child profile is disabled or is inactive.</span></span> <br><span data-ttu-id="1aa96-211">An endpoint with a Stopped status is not monitored.</span><span class="sxs-lookup"><span data-stu-id="1aa96-211">An endpoint with a Stopped status is not monitored.</span></span> <span data-ttu-id="1aa96-212">It is not included in DNS responses and does not receive traffic.</span><span class="sxs-lookup"><span data-stu-id="1aa96-212">It is not included in DNS responses and does not receive traffic.</span></span> <span data-ttu-id="1aa96-213">An exception to this is if all endpoints are degraded, in which case all of them will be considered to be returned in the query response.</span><span class="sxs-lookup"><span data-stu-id="1aa96-213">An exception to this is if all endpoints are degraded, in which case all of them will be considered to be returned in the query response.</span></span></br>|

<span data-ttu-id="1aa96-214">For details about how endpoint monitor status is calculated for nested endpoints, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span><span class="sxs-lookup"><span data-stu-id="1aa96-214">For details about how endpoint monitor status is calculated for nested endpoints, see [nested Traffic Manager profiles](traffic-manager-nested-profiles.md).</span></span>

>[!NOTE]
> <span data-ttu-id="1aa96-215">A Stopped Endpoint monitor status can happen on App Service if your web application is not running in the Standard tier or above.</span><span class="sxs-lookup"><span data-stu-id="1aa96-215">A Stopped Endpoint monitor status can happen on App Service if your web application is not running in the Standard tier or above.</span></span> <span data-ttu-id="1aa96-216">For more information, see [Traffic Manager integration with App Service](/azure/app-service/web-sites-traffic-manager).</span><span class="sxs-lookup"><span data-stu-id="1aa96-216">For more information, see [Traffic Manager integration with App Service](/azure/app-service/web-sites-traffic-manager).</span></span>

### <a name="profile-monitor-status"></a><span data-ttu-id="1aa96-217">Profile monitor status</span><span class="sxs-lookup"><span data-stu-id="1aa96-217">Profile monitor status</span></span>

<span data-ttu-id="1aa96-218">The profile monitor status is a combination of the configured profile status and the endpoint monitor status values for all endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-218">The profile monitor status is a combination of the configured profile status and the endpoint monitor status values for all endpoints.</span></span> <span data-ttu-id="1aa96-219">The possible values are described in the following table:</span><span class="sxs-lookup"><span data-stu-id="1aa96-219">The possible values are described in the following table:</span></span>

| <span data-ttu-id="1aa96-220">Profile status (as configured)</span><span class="sxs-lookup"><span data-stu-id="1aa96-220">Profile status (as configured)</span></span> | <span data-ttu-id="1aa96-221">Endpoint monitor status</span><span class="sxs-lookup"><span data-stu-id="1aa96-221">Endpoint monitor status</span></span> | <span data-ttu-id="1aa96-222">Profile monitor status</span><span class="sxs-lookup"><span data-stu-id="1aa96-222">Profile monitor status</span></span> | <span data-ttu-id="1aa96-223">Notes</span><span class="sxs-lookup"><span data-stu-id="1aa96-223">Notes</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="1aa96-224">Disabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-224">Disabled</span></span> |<span data-ttu-id="1aa96-225">&lt;any&gt; or a profile with no defined endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-225">&lt;any&gt; or a profile with no defined endpoints.</span></span> |<span data-ttu-id="1aa96-226">Disabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-226">Disabled</span></span> |<span data-ttu-id="1aa96-227">The profile has been disabled.</span><span class="sxs-lookup"><span data-stu-id="1aa96-227">The profile has been disabled.</span></span> |
| <span data-ttu-id="1aa96-228">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-228">Enabled</span></span> |<span data-ttu-id="1aa96-229">The status of at least one endpoint is Degraded.</span><span class="sxs-lookup"><span data-stu-id="1aa96-229">The status of at least one endpoint is Degraded.</span></span> |<span data-ttu-id="1aa96-230">Degraded</span><span class="sxs-lookup"><span data-stu-id="1aa96-230">Degraded</span></span> |<span data-ttu-id="1aa96-231">Review the individual endpoint status values to determine which endpoints require further attention.</span><span class="sxs-lookup"><span data-stu-id="1aa96-231">Review the individual endpoint status values to determine which endpoints require further attention.</span></span> |
| <span data-ttu-id="1aa96-232">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-232">Enabled</span></span> |<span data-ttu-id="1aa96-233">The status of at least one endpoint is Online.</span><span class="sxs-lookup"><span data-stu-id="1aa96-233">The status of at least one endpoint is Online.</span></span> <span data-ttu-id="1aa96-234">No endpoints have a Degraded status.</span><span class="sxs-lookup"><span data-stu-id="1aa96-234">No endpoints have a Degraded status.</span></span> |<span data-ttu-id="1aa96-235">Online</span><span class="sxs-lookup"><span data-stu-id="1aa96-235">Online</span></span> |<span data-ttu-id="1aa96-236">The service is accepting traffic.</span><span class="sxs-lookup"><span data-stu-id="1aa96-236">The service is accepting traffic.</span></span> <span data-ttu-id="1aa96-237">No further action is required.</span><span class="sxs-lookup"><span data-stu-id="1aa96-237">No further action is required.</span></span> |
| <span data-ttu-id="1aa96-238">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-238">Enabled</span></span> |<span data-ttu-id="1aa96-239">The status of at least one endpoint is CheckingEndpoint.</span><span class="sxs-lookup"><span data-stu-id="1aa96-239">The status of at least one endpoint is CheckingEndpoint.</span></span> <span data-ttu-id="1aa96-240">No endpoints are in Online or Degraded status.</span><span class="sxs-lookup"><span data-stu-id="1aa96-240">No endpoints are in Online or Degraded status.</span></span> |<span data-ttu-id="1aa96-241">CheckingEndpoints</span><span class="sxs-lookup"><span data-stu-id="1aa96-241">CheckingEndpoints</span></span> |<span data-ttu-id="1aa96-242">This transition state occurs when a profile if created or enabled.</span><span class="sxs-lookup"><span data-stu-id="1aa96-242">This transition state occurs when a profile if created or enabled.</span></span> <span data-ttu-id="1aa96-243">The endpoint health is being checked for the first time.</span><span class="sxs-lookup"><span data-stu-id="1aa96-243">The endpoint health is being checked for the first time.</span></span> |
| <span data-ttu-id="1aa96-244">Enabled</span><span class="sxs-lookup"><span data-stu-id="1aa96-244">Enabled</span></span> |<span data-ttu-id="1aa96-245">The statuses of all endpoints in the profile are either Disabled or Stopped, or the profile has no defined endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-245">The statuses of all endpoints in the profile are either Disabled or Stopped, or the profile has no defined endpoints.</span></span> |<span data-ttu-id="1aa96-246">Inactive</span><span class="sxs-lookup"><span data-stu-id="1aa96-246">Inactive</span></span> |<span data-ttu-id="1aa96-247">No endpoints are active, but the profile is still Enabled.</span><span class="sxs-lookup"><span data-stu-id="1aa96-247">No endpoints are active, but the profile is still Enabled.</span></span> |

## <a name="endpoint-failover-and-recovery"></a><span data-ttu-id="1aa96-248">Endpoint failover and recovery</span><span class="sxs-lookup"><span data-stu-id="1aa96-248">Endpoint failover and recovery</span></span>

<span data-ttu-id="1aa96-249">Traffic Manager periodically checks the health of every endpoint, including unhealthy endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-249">Traffic Manager periodically checks the health of every endpoint, including unhealthy endpoints.</span></span> <span data-ttu-id="1aa96-250">Traffic Manager detects when an endpoint becomes healthy and brings it back into rotation.</span><span class="sxs-lookup"><span data-stu-id="1aa96-250">Traffic Manager detects when an endpoint becomes healthy and brings it back into rotation.</span></span>

<span data-ttu-id="1aa96-251">An endpoint is unhealthy when any of the following events occur:</span><span class="sxs-lookup"><span data-stu-id="1aa96-251">An endpoint is unhealthy when any of the following events occur:</span></span>
- <span data-ttu-id="1aa96-252">If the monitoring protocol is HTTP or HTTPS:</span><span class="sxs-lookup"><span data-stu-id="1aa96-252">If the monitoring protocol is HTTP or HTTPS:</span></span>
    - <span data-ttu-id="1aa96-253">A non-200 response is received (including a different 2xx code, or a 301/302 redirect).</span><span class="sxs-lookup"><span data-stu-id="1aa96-253">A non-200 response is received (including a different 2xx code, or a 301/302 redirect).</span></span>
- <span data-ttu-id="1aa96-254">If the monitoring protocol is TCP:</span><span class="sxs-lookup"><span data-stu-id="1aa96-254">If the monitoring protocol is TCP:</span></span> 
    - <span data-ttu-id="1aa96-255">A response other than ACK or SYN-ACK is received in response to the SYNC request sent by Traffic Manager to attempt a connection establishment.</span><span class="sxs-lookup"><span data-stu-id="1aa96-255">A response other than ACK or SYN-ACK is received in response to the SYNC request sent by Traffic Manager to attempt a connection establishment.</span></span>
- <span data-ttu-id="1aa96-256">Timeout.</span><span class="sxs-lookup"><span data-stu-id="1aa96-256">Timeout.</span></span> 
- <span data-ttu-id="1aa96-257">Any other connection issue resulting in the endpoint being not reachable.</span><span class="sxs-lookup"><span data-stu-id="1aa96-257">Any other connection issue resulting in the endpoint being not reachable.</span></span>

<span data-ttu-id="1aa96-258">For more information about troubleshooting failed checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="1aa96-258">For more information about troubleshooting failed checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span> 

<span data-ttu-id="1aa96-259">The following timeline in Figure 2 is a detailed description of the monitoring process of Traffic Manager endpoint that has the following settings: monitoring protocol is HTTP, probing interval is 30 seconds, number of tolerated failures is 3, timeout value is 10 seconds, and DNS TTL is 30 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-259">The following timeline in Figure 2 is a detailed description of the monitoring process of Traffic Manager endpoint that has the following settings: monitoring protocol is HTTP, probing interval is 30 seconds, number of tolerated failures is 3, timeout value is 10 seconds, and DNS TTL is 30 seconds.</span></span>

![Traffic Manager endpoint failover and failback sequence](./media/traffic-manager-monitoring/timeline.png)

<span data-ttu-id="1aa96-261">**Figure 2:  Traffic manager endpoint failover and recovery sequence**</span><span class="sxs-lookup"><span data-stu-id="1aa96-261">**Figure 2:  Traffic manager endpoint failover and recovery sequence**</span></span>

1. <span data-ttu-id="1aa96-262">**GET**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-262">**GET**.</span></span> <span data-ttu-id="1aa96-263">For each endpoint, the Traffic Manager monitoring system performs a GET request on the path specified in the monitoring settings.</span><span class="sxs-lookup"><span data-stu-id="1aa96-263">For each endpoint, the Traffic Manager monitoring system performs a GET request on the path specified in the monitoring settings.</span></span>
2. <span data-ttu-id="1aa96-264">**200 OK**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-264">**200 OK**.</span></span> <span data-ttu-id="1aa96-265">The monitoring system expects an HTTP 200 OK message to be returned within 10 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-265">The monitoring system expects an HTTP 200 OK message to be returned within 10 seconds.</span></span> <span data-ttu-id="1aa96-266">When it receives this response, it recognizes that the service is available.</span><span class="sxs-lookup"><span data-stu-id="1aa96-266">When it receives this response, it recognizes that the service is available.</span></span>
3. <span data-ttu-id="1aa96-267">**30 seconds between checks**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-267">**30 seconds between checks**.</span></span> <span data-ttu-id="1aa96-268">The endpoint health check is repeated every 30 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-268">The endpoint health check is repeated every 30 seconds.</span></span>
4. <span data-ttu-id="1aa96-269">**Service unavailable**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-269">**Service unavailable**.</span></span> <span data-ttu-id="1aa96-270">The service becomes unavailable.</span><span class="sxs-lookup"><span data-stu-id="1aa96-270">The service becomes unavailable.</span></span> <span data-ttu-id="1aa96-271">Traffic Manager will not know until the next health check.</span><span class="sxs-lookup"><span data-stu-id="1aa96-271">Traffic Manager will not know until the next health check.</span></span>
5. <span data-ttu-id="1aa96-272">**Attempts to access the monitoring path**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-272">**Attempts to access the monitoring path**.</span></span> <span data-ttu-id="1aa96-273">The monitoring system performs a GET request, but does not receive a response within the timeout period of 10 seconds (alternatively, a non-200 response may be received).</span><span class="sxs-lookup"><span data-stu-id="1aa96-273">The monitoring system performs a GET request, but does not receive a response within the timeout period of 10 seconds (alternatively, a non-200 response may be received).</span></span> <span data-ttu-id="1aa96-274">It then tries three more times, at 30-second intervals.</span><span class="sxs-lookup"><span data-stu-id="1aa96-274">It then tries three more times, at 30-second intervals.</span></span> <span data-ttu-id="1aa96-275">If one of the tries is successful, then the number of tries is reset.</span><span class="sxs-lookup"><span data-stu-id="1aa96-275">If one of the tries is successful, then the number of tries is reset.</span></span>
6. <span data-ttu-id="1aa96-276">**Status set to Degraded**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-276">**Status set to Degraded**.</span></span> <span data-ttu-id="1aa96-277">After a fourth consecutive failure, the monitoring system marks the unavailable endpoint status as Degraded.</span><span class="sxs-lookup"><span data-stu-id="1aa96-277">After a fourth consecutive failure, the monitoring system marks the unavailable endpoint status as Degraded.</span></span>
7. <span data-ttu-id="1aa96-278">**Traffic is diverted to other endpoints**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-278">**Traffic is diverted to other endpoints**.</span></span> <span data-ttu-id="1aa96-279">The Traffic Manager DNS name servers are updated and Traffic Manager no longer returns the endpoint in response to DNS queries.</span><span class="sxs-lookup"><span data-stu-id="1aa96-279">The Traffic Manager DNS name servers are updated and Traffic Manager no longer returns the endpoint in response to DNS queries.</span></span> <span data-ttu-id="1aa96-280">New connections are directed to other, available endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-280">New connections are directed to other, available endpoints.</span></span> <span data-ttu-id="1aa96-281">However, previous DNS responses that include this endpoint may still be cached by recursive DNS servers and DNS clients.</span><span class="sxs-lookup"><span data-stu-id="1aa96-281">However, previous DNS responses that include this endpoint may still be cached by recursive DNS servers and DNS clients.</span></span> <span data-ttu-id="1aa96-282">Clients continue to use the endpoint until the DNS cache expires.</span><span class="sxs-lookup"><span data-stu-id="1aa96-282">Clients continue to use the endpoint until the DNS cache expires.</span></span> <span data-ttu-id="1aa96-283">As the DNS cache expires, clients make new DNS queries and are directed to different endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-283">As the DNS cache expires, clients make new DNS queries and are directed to different endpoints.</span></span> <span data-ttu-id="1aa96-284">The cache duration is controlled by the TTL setting in the Traffic Manager profile, for example, 30 seconds.</span><span class="sxs-lookup"><span data-stu-id="1aa96-284">The cache duration is controlled by the TTL setting in the Traffic Manager profile, for example, 30 seconds.</span></span>
8. <span data-ttu-id="1aa96-285">**Health checks continue**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-285">**Health checks continue**.</span></span> <span data-ttu-id="1aa96-286">Traffic Manager continues to check the health of the endpoint while it has a Degraded status.</span><span class="sxs-lookup"><span data-stu-id="1aa96-286">Traffic Manager continues to check the health of the endpoint while it has a Degraded status.</span></span> <span data-ttu-id="1aa96-287">Traffic Manager detects when the endpoint returns to health.</span><span class="sxs-lookup"><span data-stu-id="1aa96-287">Traffic Manager detects when the endpoint returns to health.</span></span>
9. <span data-ttu-id="1aa96-288">**Service comes back online**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-288">**Service comes back online**.</span></span> <span data-ttu-id="1aa96-289">The service becomes available.</span><span class="sxs-lookup"><span data-stu-id="1aa96-289">The service becomes available.</span></span> <span data-ttu-id="1aa96-290">The endpoint retains its Degraded status in Traffic Manager until the monitoring system performs its next health check.</span><span class="sxs-lookup"><span data-stu-id="1aa96-290">The endpoint retains its Degraded status in Traffic Manager until the monitoring system performs its next health check.</span></span>
10. <span data-ttu-id="1aa96-291">**Traffic to service resumes**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-291">**Traffic to service resumes**.</span></span> <span data-ttu-id="1aa96-292">Traffic Manager sends a GET request and receives a 200 OK status response.</span><span class="sxs-lookup"><span data-stu-id="1aa96-292">Traffic Manager sends a GET request and receives a 200 OK status response.</span></span> <span data-ttu-id="1aa96-293">The service has returned to a healthy state.</span><span class="sxs-lookup"><span data-stu-id="1aa96-293">The service has returned to a healthy state.</span></span> <span data-ttu-id="1aa96-294">The Traffic Manager name servers are updated, and they begin to hand out the service's DNS name in DNS responses.</span><span class="sxs-lookup"><span data-stu-id="1aa96-294">The Traffic Manager name servers are updated, and they begin to hand out the service's DNS name in DNS responses.</span></span> <span data-ttu-id="1aa96-295">Traffic returns to the endpoint as cached DNS responses that return other endpoints expire, and as existing connections to other endpoints are terminated.</span><span class="sxs-lookup"><span data-stu-id="1aa96-295">Traffic returns to the endpoint as cached DNS responses that return other endpoints expire, and as existing connections to other endpoints are terminated.</span></span>

    > [!NOTE]
    > <span data-ttu-id="1aa96-296">Because Traffic Manager works at the DNS level, it cannot influence existing connections to any endpoint.</span><span class="sxs-lookup"><span data-stu-id="1aa96-296">Because Traffic Manager works at the DNS level, it cannot influence existing connections to any endpoint.</span></span> <span data-ttu-id="1aa96-297">When it directs traffic between endpoints (either by changed profile settings, or during failover or failback), Traffic Manager directs new connections to available endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-297">When it directs traffic between endpoints (either by changed profile settings, or during failover or failback), Traffic Manager directs new connections to available endpoints.</span></span> <span data-ttu-id="1aa96-298">However, other endpoints might continue to receive traffic via existing connections until those sessions are terminated.</span><span class="sxs-lookup"><span data-stu-id="1aa96-298">However, other endpoints might continue to receive traffic via existing connections until those sessions are terminated.</span></span> <span data-ttu-id="1aa96-299">To enable traffic to drain from existing connections, applications should limit the session duration used with each endpoint.</span><span class="sxs-lookup"><span data-stu-id="1aa96-299">To enable traffic to drain from existing connections, applications should limit the session duration used with each endpoint.</span></span>

## <a name="traffic-routing-methods"></a><span data-ttu-id="1aa96-300">Traffic-routing methods</span><span class="sxs-lookup"><span data-stu-id="1aa96-300">Traffic-routing methods</span></span>

<span data-ttu-id="1aa96-301">When an endpoint has a Degraded status, it is no longer returned in response to DNS queries.</span><span class="sxs-lookup"><span data-stu-id="1aa96-301">When an endpoint has a Degraded status, it is no longer returned in response to DNS queries.</span></span> <span data-ttu-id="1aa96-302">Instead, an alternative endpoint is chosen and returned.</span><span class="sxs-lookup"><span data-stu-id="1aa96-302">Instead, an alternative endpoint is chosen and returned.</span></span> <span data-ttu-id="1aa96-303">The traffic-routing method configured in the profile determines how the alternative endpoint is chosen.</span><span class="sxs-lookup"><span data-stu-id="1aa96-303">The traffic-routing method configured in the profile determines how the alternative endpoint is chosen.</span></span>

* <span data-ttu-id="1aa96-304">**Priority**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-304">**Priority**.</span></span> <span data-ttu-id="1aa96-305">Endpoints form a prioritized list.</span><span class="sxs-lookup"><span data-stu-id="1aa96-305">Endpoints form a prioritized list.</span></span> <span data-ttu-id="1aa96-306">The first available endpoint on the list is always returned.</span><span class="sxs-lookup"><span data-stu-id="1aa96-306">The first available endpoint on the list is always returned.</span></span> <span data-ttu-id="1aa96-307">If an endpoint status is Degraded, then the next available endpoint is returned.</span><span class="sxs-lookup"><span data-stu-id="1aa96-307">If an endpoint status is Degraded, then the next available endpoint is returned.</span></span>
* <span data-ttu-id="1aa96-308">**Weighted**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-308">**Weighted**.</span></span> <span data-ttu-id="1aa96-309">Any available endpoint is chosen at random based on their assigned weights and the weights of the other available endpoints.</span><span class="sxs-lookup"><span data-stu-id="1aa96-309">Any available endpoint is chosen at random based on their assigned weights and the weights of the other available endpoints.</span></span>
* <span data-ttu-id="1aa96-310">**Performance**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-310">**Performance**.</span></span> <span data-ttu-id="1aa96-311">The endpoint closest to the end user is returned.</span><span class="sxs-lookup"><span data-stu-id="1aa96-311">The endpoint closest to the end user is returned.</span></span> <span data-ttu-id="1aa96-312">If that endpoint is unavailable, Traffic Manager moves traffic to the endpoints in the next closest Azure region.</span><span class="sxs-lookup"><span data-stu-id="1aa96-312">If that endpoint is unavailable, Traffic Manager moves traffic to the endpoints in the next closest Azure region.</span></span> <span data-ttu-id="1aa96-313">You can configure alternative failover plans for performance traffic-routing by using [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span><span class="sxs-lookup"><span data-stu-id="1aa96-313">You can configure alternative failover plans for performance traffic-routing by using [nested Traffic Manager profiles](traffic-manager-nested-profiles.md#example-4-controlling-performance-traffic-routing-between-multiple-endpoints-in-the-same-region).</span></span>
* <span data-ttu-id="1aa96-314">**Geographic**.</span><span class="sxs-lookup"><span data-stu-id="1aa96-314">**Geographic**.</span></span> <span data-ttu-id="1aa96-315">The endpoint mapped to serve the geographic location based on the query request IPs is returned.</span><span class="sxs-lookup"><span data-stu-id="1aa96-315">The endpoint mapped to serve the geographic location based on the query request IPs is returned.</span></span> <span data-ttu-id="1aa96-316">If that endpoint is unavailable, another endpoint will not be selected to failover to, since a geographic location can be mapped only to one endpoint in a profile (more details are in the [FAQ](traffic-manager-FAQs.md#traffic-manager-geographic-traffic-routing-method)).</span><span class="sxs-lookup"><span data-stu-id="1aa96-316">If that endpoint is unavailable, another endpoint will not be selected to failover to, since a geographic location can be mapped only to one endpoint in a profile (more details are in the [FAQ](traffic-manager-FAQs.md#traffic-manager-geographic-traffic-routing-method)).</span></span> <span data-ttu-id="1aa96-317">As a best practice, when using geographic routing, we recommend customers to use nested Traffic Manager profiles with more than one endpoint as the endpoints of the profile.</span><span class="sxs-lookup"><span data-stu-id="1aa96-317">As a best practice, when using geographic routing, we recommend customers to use nested Traffic Manager profiles with more than one endpoint as the endpoints of the profile.</span></span>

<span data-ttu-id="1aa96-318">For more information, see [Traffic Manager traffic-routing methods](traffic-manager-routing-methods.md).</span><span class="sxs-lookup"><span data-stu-id="1aa96-318">For more information, see [Traffic Manager traffic-routing methods](traffic-manager-routing-methods.md).</span></span>

> [!NOTE]
> <span data-ttu-id="1aa96-319">One exception to normal traffic-routing behavior occurs when all eligible endpoints have a degraded status.</span><span class="sxs-lookup"><span data-stu-id="1aa96-319">One exception to normal traffic-routing behavior occurs when all eligible endpoints have a degraded status.</span></span> <span data-ttu-id="1aa96-320">Traffic Manager makes a "best effort" attempt and *responds as if all the Degraded status endpoints actually are in an online state*.</span><span class="sxs-lookup"><span data-stu-id="1aa96-320">Traffic Manager makes a "best effort" attempt and *responds as if all the Degraded status endpoints actually are in an online state*.</span></span> <span data-ttu-id="1aa96-321">This behavior is preferable to the alternative, which would be to not return any endpoint in the DNS response.</span><span class="sxs-lookup"><span data-stu-id="1aa96-321">This behavior is preferable to the alternative, which would be to not return any endpoint in the DNS response.</span></span> <span data-ttu-id="1aa96-322">Disabled or Stopped endpoints are not monitored, therefore, they are not considered eligible for traffic.</span><span class="sxs-lookup"><span data-stu-id="1aa96-322">Disabled or Stopped endpoints are not monitored, therefore, they are not considered eligible for traffic.</span></span>
>
> <span data-ttu-id="1aa96-323">This condition is commonly caused by improper configuration of the service, such as:</span><span class="sxs-lookup"><span data-stu-id="1aa96-323">This condition is commonly caused by improper configuration of the service, such as:</span></span>
>
> * <span data-ttu-id="1aa96-324">An access control list [ACL] blocking the Traffic Manager health checks.</span><span class="sxs-lookup"><span data-stu-id="1aa96-324">An access control list [ACL] blocking the Traffic Manager health checks.</span></span>
> * <span data-ttu-id="1aa96-325">An improper configuration of the monitoring port or protocol in the Traffic manager profile.</span><span class="sxs-lookup"><span data-stu-id="1aa96-325">An improper configuration of the monitoring port or protocol in the Traffic manager profile.</span></span>
>
> <span data-ttu-id="1aa96-326">The consequence of this behavior is that if Traffic Manager health checks are not configured correctly, it might appear from the traffic routing as though Traffic Manager *is* working properly.</span><span class="sxs-lookup"><span data-stu-id="1aa96-326">The consequence of this behavior is that if Traffic Manager health checks are not configured correctly, it might appear from the traffic routing as though Traffic Manager *is* working properly.</span></span> <span data-ttu-id="1aa96-327">However, in this case, endpoint failover cannot happen which affects overall application availability.</span><span class="sxs-lookup"><span data-stu-id="1aa96-327">However, in this case, endpoint failover cannot happen which affects overall application availability.</span></span> <span data-ttu-id="1aa96-328">It is important to check that the profile shows an Online status, not a Degraded status.</span><span class="sxs-lookup"><span data-stu-id="1aa96-328">It is important to check that the profile shows an Online status, not a Degraded status.</span></span> <span data-ttu-id="1aa96-329">An Online status indicates that the Traffic Manager health checks are working as expected.</span><span class="sxs-lookup"><span data-stu-id="1aa96-329">An Online status indicates that the Traffic Manager health checks are working as expected.</span></span>

<span data-ttu-id="1aa96-330">For more information about troubleshooting failed health checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span><span class="sxs-lookup"><span data-stu-id="1aa96-330">For more information about troubleshooting failed health checks, see [Troubleshooting Degraded status on Azure Traffic Manager](traffic-manager-troubleshooting-degraded.md).</span></span>



## <a name="next-steps"></a><span data-ttu-id="1aa96-331">Next steps</span><span class="sxs-lookup"><span data-stu-id="1aa96-331">Next steps</span></span>

<span data-ttu-id="1aa96-332">Learn [how Traffic Manager works](traffic-manager-how-it-works.md)</span><span class="sxs-lookup"><span data-stu-id="1aa96-332">Learn [how Traffic Manager works](traffic-manager-how-it-works.md)</span></span>

<span data-ttu-id="1aa96-333">Learn more about the [traffic-routing methods](traffic-manager-routing-methods.md) supported by Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="1aa96-333">Learn more about the [traffic-routing methods](traffic-manager-routing-methods.md) supported by Traffic Manager</span></span>

<span data-ttu-id="1aa96-334">Learn how to [create a Traffic Manager profile](traffic-manager-manage-profiles.md)</span><span class="sxs-lookup"><span data-stu-id="1aa96-334">Learn how to [create a Traffic Manager profile](traffic-manager-manage-profiles.md)</span></span>

<span data-ttu-id="1aa96-335">[Troubleshoot Degraded status](traffic-manager-troubleshooting-degraded.md) on a Traffic Manager endpoint</span><span class="sxs-lookup"><span data-stu-id="1aa96-335">[Troubleshoot Degraded status](traffic-manager-troubleshooting-degraded.md) on a Traffic Manager endpoint</span></span>
