---
title: Infrastructure Backup Service best practices for Azure Stack | Microsoft Docs
description: You can follow set of best practices when you deploy and manage Azure Stack in your datacenter to help mitigate data loss if there is a catastrophic failure.
services: azure-stack
documentationcenter: ''
author: jeffgilb
manager: femila
editor: ''
ms.assetid: 221FDE40-3EF8-4F54-A075-0C4D66EECE1A
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/01/2018
ms.author: jeffgilb
ms.reviewer: hectorl
ms.openlocfilehash: 08d8822410545fb0ae3a2a99de00b38566c9834c
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44868966"
---
# <a name="infrastructure-backup-service-best-practices"></a><span data-ttu-id="82435-103">Infrastructure Backup Service best practices</span><span class="sxs-lookup"><span data-stu-id="82435-103">Infrastructure Backup Service best practices</span></span>

<span data-ttu-id="82435-104">*Applies to: Azure Stack integrated systems and Azure Stack Development Kit*</span><span class="sxs-lookup"><span data-stu-id="82435-104">*Applies to: Azure Stack integrated systems and Azure Stack Development Kit*</span></span>

<span data-ttu-id="82435-105">You can follow best practices when you deploy and manage Azure Stack in your datacenter to help mitigate data loss in the event of a catastrophic failure.</span><span class="sxs-lookup"><span data-stu-id="82435-105">You can follow best practices when you deploy and manage Azure Stack in your datacenter to help mitigate data loss in the event of a catastrophic failure.</span></span>

<span data-ttu-id="82435-106">You should review the best practices at a regular interval to verify that your installation is still in compliance when changes are made to the operation flow.</span><span class="sxs-lookup"><span data-stu-id="82435-106">You should review the best practices at a regular interval to verify that your installation is still in compliance when changes are made to the operation flow.</span></span> <span data-ttu-id="82435-107">Should you encounter any issues while implementing these best practices, contact Microsoft Support for help.</span><span class="sxs-lookup"><span data-stu-id="82435-107">Should you encounter any issues while implementing these best practices, contact Microsoft Support for help.</span></span>

## <a name="configuration-best-practices"></a><span data-ttu-id="82435-108">Configuration best practices</span><span class="sxs-lookup"><span data-stu-id="82435-108">Configuration best practices</span></span>

### <a name="deployment"></a><span data-ttu-id="82435-109">Deployment</span><span class="sxs-lookup"><span data-stu-id="82435-109">Deployment</span></span>

<span data-ttu-id="82435-110">Enable Infrastructure Backup after deployment of each Azure Stack Cloud.</span><span class="sxs-lookup"><span data-stu-id="82435-110">Enable Infrastructure Backup after deployment of each Azure Stack Cloud.</span></span> <span data-ttu-id="82435-111">Using Azure Stack PowerShell you can schedule backups from any client/server with access to the operator management API endpoint.</span><span class="sxs-lookup"><span data-stu-id="82435-111">Using Azure Stack PowerShell you can schedule backups from any client/server with access to the operator management API endpoint.</span></span>

### <a name="networking"></a><span data-ttu-id="82435-112">Networking</span><span class="sxs-lookup"><span data-stu-id="82435-112">Networking</span></span>

<span data-ttu-id="82435-113">The Universal Naming Convention (UNC) string for the path must use a fully qualified domain name (FQDN).</span><span class="sxs-lookup"><span data-stu-id="82435-113">The Universal Naming Convention (UNC) string for the path must use a fully qualified domain name (FQDN).</span></span> <span data-ttu-id="82435-114">IP address is possible if name resolution is not possible.</span><span class="sxs-lookup"><span data-stu-id="82435-114">IP address is possible if name resolution is not possible.</span></span> <span data-ttu-id="82435-115">A UNC string specifies the location of resources such as shared files or devices.</span><span class="sxs-lookup"><span data-stu-id="82435-115">A UNC string specifies the location of resources such as shared files or devices.</span></span>

### <a name="encryption"></a><span data-ttu-id="82435-116">Encryption</span><span class="sxs-lookup"><span data-stu-id="82435-116">Encryption</span></span>

<span data-ttu-id="82435-117">The encryption key is used to encrypt backup data that gets exported to external storage.</span><span class="sxs-lookup"><span data-stu-id="82435-117">The encryption key is used to encrypt backup data that gets exported to external storage.</span></span> <span data-ttu-id="82435-118">The key is generated as part of [enabling backup for Azure Stack with PowerShell](azure-stack-backup-enable-backup-powershell.md).</span><span class="sxs-lookup"><span data-stu-id="82435-118">The key is generated as part of [enabling backup for Azure Stack with PowerShell](azure-stack-backup-enable-backup-powershell.md).</span></span>

<span data-ttu-id="82435-119">The key must be stored in a secure location (for example, public Azure Key Vault secret).</span><span class="sxs-lookup"><span data-stu-id="82435-119">The key must be stored in a secure location (for example, public Azure Key Vault secret).</span></span> <span data-ttu-id="82435-120">This key must be used during redeployment of Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="82435-120">This key must be used during redeployment of Azure Stack.</span></span> 

![Stored the key a secure location.](media\azure-stack-backup\azure-stack-backup-encryption2.png)

## <a name="operational-best-practices"></a><span data-ttu-id="82435-122">Operational best practices</span><span class="sxs-lookup"><span data-stu-id="82435-122">Operational best practices</span></span>

### <a name="backups"></a><span data-ttu-id="82435-123">Backups</span><span class="sxs-lookup"><span data-stu-id="82435-123">Backups</span></span>

 - <span data-ttu-id="82435-124">Infrastructure Backup Controller needs to be triggered on demand.</span><span class="sxs-lookup"><span data-stu-id="82435-124">Infrastructure Backup Controller needs to be triggered on demand.</span></span> <span data-ttu-id="82435-125">Recommendation is to backup at least two times per day.</span><span class="sxs-lookup"><span data-stu-id="82435-125">Recommendation is to backup at least two times per day.</span></span>
 - <span data-ttu-id="82435-126">Backup jobs execute while the system is running so there is no downtime to the management experiences or user applications.</span><span class="sxs-lookup"><span data-stu-id="82435-126">Backup jobs execute while the system is running so there is no downtime to the management experiences or user applications.</span></span> <span data-ttu-id="82435-127">Expect the backup jobs to take 20-40 minutes for a solution that is under reasonable load.</span><span class="sxs-lookup"><span data-stu-id="82435-127">Expect the backup jobs to take 20-40 minutes for a solution that is under reasonable load.</span></span>
 - <span data-ttu-id="82435-128">Using OEM provided instruction, manually backup network switches and the hardware lifecycle host (HLH) should be stored on the same backup share where the Infrastructure Backup Controller stores control plane backup data.</span><span class="sxs-lookup"><span data-stu-id="82435-128">Using OEM provided instruction, manually backup network switches and the hardware lifecycle host (HLH) should be stored on the same backup share where the Infrastructure Backup Controller stores control plane backup data.</span></span> <span data-ttu-id="82435-129">Consider storing switch and HLH configurations in the region folder.</span><span class="sxs-lookup"><span data-stu-id="82435-129">Consider storing switch and HLH configurations in the region folder.</span></span> <span data-ttu-id="82435-130">If you have multiple Azure Stack instances in the same region, consider using an identifier for each configuration that belongs to a scale unit.</span><span class="sxs-lookup"><span data-stu-id="82435-130">If you have multiple Azure Stack instances in the same region, consider using an identifier for each configuration that belongs to a scale unit.</span></span>

### <a name="folder-names"></a><span data-ttu-id="82435-131">Folder Names</span><span class="sxs-lookup"><span data-stu-id="82435-131">Folder Names</span></span>

 - <span data-ttu-id="82435-132">Infrastructure creates MASBACKUP folder automatically.</span><span class="sxs-lookup"><span data-stu-id="82435-132">Infrastructure creates MASBACKUP folder automatically.</span></span> <span data-ttu-id="82435-133">This is a Microsoft-managed share.</span><span class="sxs-lookup"><span data-stu-id="82435-133">This is a Microsoft-managed share.</span></span> <span data-ttu-id="82435-134">You can create shares at the same level as MASBACKUP.</span><span class="sxs-lookup"><span data-stu-id="82435-134">You can create shares at the same level as MASBACKUP.</span></span> <span data-ttu-id="82435-135">It is not recommended creating folders or storage data inside of MASBACKUP that Azure Stack does not create.</span><span class="sxs-lookup"><span data-stu-id="82435-135">It is not recommended creating folders or storage data inside of MASBACKUP that Azure Stack does not create.</span></span> 
 -  <span data-ttu-id="82435-136">User FQDN and region in your folder name to differentiate backup data from different clouds.</span><span class="sxs-lookup"><span data-stu-id="82435-136">User FQDN and region in your folder name to differentiate backup data from different clouds.</span></span> <span data-ttu-id="82435-137">The fully qualified domain name (FQDN) of your Azure Stack deployment and endpoints is the combination of the Region parameter and the External Domain Name parameter.</span><span class="sxs-lookup"><span data-stu-id="82435-137">The fully qualified domain name (FQDN) of your Azure Stack deployment and endpoints is the combination of the Region parameter and the External Domain Name parameter.</span></span> <span data-ttu-id="82435-138">For  more information, see [Azure Stack datacenter integration - DNS](azure-stack-integrate-dns.md).</span><span class="sxs-lookup"><span data-stu-id="82435-138">For  more information, see [Azure Stack datacenter integration - DNS](azure-stack-integrate-dns.md).</span></span>

<span data-ttu-id="82435-139">For example, the backup share is AzSBackups hosted on fileserver01.contoso.com.</span><span class="sxs-lookup"><span data-stu-id="82435-139">For example, the backup share is AzSBackups hosted on fileserver01.contoso.com.</span></span> <span data-ttu-id="82435-140">In that file share there may be a folder per Azure Stack deployment using the external domain name and a subfolder that uses the region name.</span><span class="sxs-lookup"><span data-stu-id="82435-140">In that file share there may be a folder per Azure Stack deployment using the external domain name and a subfolder that uses the region name.</span></span> 

<span data-ttu-id="82435-141">FQDN: contoso.com</span><span class="sxs-lookup"><span data-stu-id="82435-141">FQDN: contoso.com</span></span>  
<span data-ttu-id="82435-142">Region: nyc</span><span class="sxs-lookup"><span data-stu-id="82435-142">Region: nyc</span></span>


    \\fileserver01.contoso.com\AzSBackups
    \\fileserver01.contoso.com\AzSBackups\contoso.com
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\MASBackup

<span data-ttu-id="82435-143">MASBackup folder is where Azure Stack stores its backup data.</span><span class="sxs-lookup"><span data-stu-id="82435-143">MASBackup folder is where Azure Stack stores its backup data.</span></span> <span data-ttu-id="82435-144">You should not use this folder to store your own data.</span><span class="sxs-lookup"><span data-stu-id="82435-144">You should not use this folder to store your own data.</span></span> <span data-ttu-id="82435-145">OEM should not use this folder to store any backup data either.</span><span class="sxs-lookup"><span data-stu-id="82435-145">OEM should not use this folder to store any backup data either.</span></span> 

<span data-ttu-id="82435-146">OEMs are encouraged to store backup data for their components under the region folder.</span><span class="sxs-lookup"><span data-stu-id="82435-146">OEMs are encouraged to store backup data for their components under the region folder.</span></span> <span data-ttu-id="82435-147">Each network switches, hardware lifecycle host (HLH), and so on may be stored in its own subfolder.</span><span class="sxs-lookup"><span data-stu-id="82435-147">Each network switches, hardware lifecycle host (HLH), and so on may be stored in its own subfolder.</span></span> <span data-ttu-id="82435-148">For example:</span><span class="sxs-lookup"><span data-stu-id="82435-148">For example:</span></span>

    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\HLH
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\Switches
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\DeploymentData
    \\fileserver01.contoso.com\AzSBackups\contoso.com\nyc\Registration

### <a name="monitoring"></a><span data-ttu-id="82435-149">Monitoring</span><span class="sxs-lookup"><span data-stu-id="82435-149">Monitoring</span></span>

<span data-ttu-id="82435-150">The following alerts are supported by the system:</span><span class="sxs-lookup"><span data-stu-id="82435-150">The following alerts are supported by the system:</span></span>

| <span data-ttu-id="82435-151">Alert</span><span class="sxs-lookup"><span data-stu-id="82435-151">Alert</span></span>                                                   | <span data-ttu-id="82435-152">Description</span><span class="sxs-lookup"><span data-stu-id="82435-152">Description</span></span>                                                                                     | <span data-ttu-id="82435-153">Remediation</span><span class="sxs-lookup"><span data-stu-id="82435-153">Remediation</span></span>                                                                                                                                |
|---------------------------------------------------------|-------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="82435-154">Backup failed because the file share is out of capacity</span><span class="sxs-lookup"><span data-stu-id="82435-154">Backup failed because the file share is out of capacity</span></span> | <span data-ttu-id="82435-155">File share is out of capacity and backup controller cannot export backup files to the location.</span><span class="sxs-lookup"><span data-stu-id="82435-155">File share is out of capacity and backup controller cannot export backup files to the location.</span></span> | <span data-ttu-id="82435-156">Add more storage capacity and try back up again.</span><span class="sxs-lookup"><span data-stu-id="82435-156">Add more storage capacity and try back up again.</span></span> <span data-ttu-id="82435-157">Delete existing backups (starting from oldest first) to free up space.</span><span class="sxs-lookup"><span data-stu-id="82435-157">Delete existing backups (starting from oldest first) to free up space.</span></span>                    |
| <span data-ttu-id="82435-158">Backup failed due to connectivity problems.</span><span class="sxs-lookup"><span data-stu-id="82435-158">Backup failed due to connectivity problems.</span></span>             | <span data-ttu-id="82435-159">Network between Azure Stack and the file share is experiencing issues.</span><span class="sxs-lookup"><span data-stu-id="82435-159">Network between Azure Stack and the file share is experiencing issues.</span></span>                          | <span data-ttu-id="82435-160">Address the network issue and try backup again.</span><span class="sxs-lookup"><span data-stu-id="82435-160">Address the network issue and try backup again.</span></span>                                                                                            |
| <span data-ttu-id="82435-161">Backup failed due to a fault in the path</span><span class="sxs-lookup"><span data-stu-id="82435-161">Backup failed due to a fault in the path</span></span>                | <span data-ttu-id="82435-162">The file share path cannot be resolved</span><span class="sxs-lookup"><span data-stu-id="82435-162">The file share path cannot be resolved</span></span>                                                          | <span data-ttu-id="82435-163">Map the share from a different computer to ensure the share is accessible.</span><span class="sxs-lookup"><span data-stu-id="82435-163">Map the share from a different computer to ensure the share is accessible.</span></span> <span data-ttu-id="82435-164">You may need to update the path if it is no longer valid.</span><span class="sxs-lookup"><span data-stu-id="82435-164">You may need to update the path if it is no longer valid.</span></span>       |
| <span data-ttu-id="82435-165">Backup failed due to authentication issue</span><span class="sxs-lookup"><span data-stu-id="82435-165">Backup failed due to authentication issue</span></span>               | <span data-ttu-id="82435-166">There might be an issue with the credentials or a network issue that impacts authentication.</span><span class="sxs-lookup"><span data-stu-id="82435-166">There might be an issue with the credentials or a network issue that impacts authentication.</span></span>    | <span data-ttu-id="82435-167">Map the share from a different computer to ensure the share is accessible.</span><span class="sxs-lookup"><span data-stu-id="82435-167">Map the share from a different computer to ensure the share is accessible.</span></span> <span data-ttu-id="82435-168">You may need to update credentials if they are no longer valid.</span><span class="sxs-lookup"><span data-stu-id="82435-168">You may need to update credentials if they are no longer valid.</span></span> |
| <span data-ttu-id="82435-169">Backup failed due to a general fault</span><span class="sxs-lookup"><span data-stu-id="82435-169">Backup failed due to a general fault</span></span>                    | <span data-ttu-id="82435-170">The failed request could be due to an intermittent issue.</span><span class="sxs-lookup"><span data-stu-id="82435-170">The failed request could be due to an intermittent issue.</span></span> <span data-ttu-id="82435-171">Try back up again.</span><span class="sxs-lookup"><span data-stu-id="82435-171">Try back up again.</span></span>                    | <span data-ttu-id="82435-172">Call support</span><span class="sxs-lookup"><span data-stu-id="82435-172">Call support</span></span>                                                                                                                               |

## <a name="next-steps"></a><span data-ttu-id="82435-173">Next steps</span><span class="sxs-lookup"><span data-stu-id="82435-173">Next steps</span></span>

 - <span data-ttu-id="82435-174">Review the reference material for the [Infrastructure Backup Service](azure-stack-backup-reference.md).</span><span class="sxs-lookup"><span data-stu-id="82435-174">Review the reference material for the [Infrastructure Backup Service](azure-stack-backup-reference.md).</span></span>  
 - <span data-ttu-id="82435-175">Enable the [Infrastructure Backup Service](azure-stack-backup-enable-backup-console.md).</span><span class="sxs-lookup"><span data-stu-id="82435-175">Enable the [Infrastructure Backup Service](azure-stack-backup-enable-backup-console.md).</span></span>
