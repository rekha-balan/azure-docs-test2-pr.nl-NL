---
title: Overview of identity for Azure Stack | Microsoft Docs
description: Learn about the identity systems you can use with Azure Stack.
services: azure-stack
documentationcenter: ''
author: brenduns
manager: femila
editor: ''
ms.assetid: ''
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 2/22/2018
ms.author: brenduns
ms.reviewer: ''
ms.openlocfilehash: 9a5390b51b3b901b159f99e757ca4db1aaf8258e
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44870046"
---
# <a name="overview-of-identity-for-azure-stack"></a><span data-ttu-id="175ca-103">Overview of identity for Azure Stack</span><span class="sxs-lookup"><span data-stu-id="175ca-103">Overview of identity for Azure Stack</span></span>

<span data-ttu-id="175ca-104">Azure Stack requires Azure Active Directory (Azure AD) or Active Directory Federation Services (AD FS), backed by Active Directory as an identity provider.</span><span class="sxs-lookup"><span data-stu-id="175ca-104">Azure Stack requires Azure Active Directory (Azure AD) or Active Directory Federation Services (AD FS), backed by Active Directory as an identity provider.</span></span> <span data-ttu-id="175ca-105">The choice of a provider is a one-time decision that you make when you first deploy Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="175ca-105">The choice of a provider is a one-time decision that you make when you first deploy Azure Stack.</span></span> <span data-ttu-id="175ca-106">The concepts and authorization details in this article can help you choose between identity providers.</span><span class="sxs-lookup"><span data-stu-id="175ca-106">The concepts and authorization details in this article can help you choose between identity providers.</span></span> 

<span data-ttu-id="175ca-107">Your choice of either Azure AD or AD FS might be determined by the mode in which you deploy Azure Stack:</span><span class="sxs-lookup"><span data-stu-id="175ca-107">Your choice of either Azure AD or AD FS might be determined by the mode in which you deploy Azure Stack:</span></span> 
- <span data-ttu-id="175ca-108">When you deploy it in a connected mode, you can use either Azure AD or AD FS.</span><span class="sxs-lookup"><span data-stu-id="175ca-108">When you deploy it in a connected mode, you can use either Azure AD or AD FS.</span></span> 
- <span data-ttu-id="175ca-109">When you deploy it in a disconnected mode, without a connection to the internet, only AD FS is supported.</span><span class="sxs-lookup"><span data-stu-id="175ca-109">When you deploy it in a disconnected mode, without a connection to the internet, only AD FS is supported.</span></span>

<span data-ttu-id="175ca-110">For more information about your options, which depend on your Azure Stack environment, see the following articles:</span><span class="sxs-lookup"><span data-stu-id="175ca-110">For more information about your options, which depend on your Azure Stack environment, see the following articles:</span></span>
- <span data-ttu-id="175ca-111">Azure Stack deployment kit: [Identity considerations](azure-stack-datacenter-integration.md#identity-considerations).</span><span class="sxs-lookup"><span data-stu-id="175ca-111">Azure Stack deployment kit: [Identity considerations](azure-stack-datacenter-integration.md#identity-considerations).</span></span>
- <span data-ttu-id="175ca-112">Azure Stack integrated systems: [Deployment planning decisions for Azure Stack integrated systems](azure-stack-deployment-decisions.md).</span><span class="sxs-lookup"><span data-stu-id="175ca-112">Azure Stack integrated systems: [Deployment planning decisions for Azure Stack integrated systems](azure-stack-deployment-decisions.md).</span></span>

 
## <a name="common-concepts-for-identity"></a><span data-ttu-id="175ca-113">Common concepts for identity</span><span class="sxs-lookup"><span data-stu-id="175ca-113">Common concepts for identity</span></span>
<span data-ttu-id="175ca-114">The next sections discuss common concepts about identity providers and their use in Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="175ca-114">The next sections discuss common concepts about identity providers and their use in Azure Stack.</span></span>

![Terminology for identity providers](media/azure-stack-identity-overview/terminology.png)

### <a name="directory-tenants-and-organizations"></a><span data-ttu-id="175ca-116">Directory tenants and organizations</span><span class="sxs-lookup"><span data-stu-id="175ca-116">Directory tenants and organizations</span></span>
<span data-ttu-id="175ca-117">A directory is a container that holds information about *users*, *applications*, *groups*, and *service principals*.</span><span class="sxs-lookup"><span data-stu-id="175ca-117">A directory is a container that holds information about *users*, *applications*, *groups*, and *service principals*.</span></span>
 
<span data-ttu-id="175ca-118">A directory tenant is an *organization*, such as Microsoft or your own company.</span><span class="sxs-lookup"><span data-stu-id="175ca-118">A directory tenant is an *organization*, such as Microsoft or your own company.</span></span> 
- <span data-ttu-id="175ca-119">Azure AD supports multiple tenants, and it can support multiple organizations, each in its own directory.</span><span class="sxs-lookup"><span data-stu-id="175ca-119">Azure AD supports multiple tenants, and it can support multiple organizations, each in its own directory.</span></span> <span data-ttu-id="175ca-120">If you use Azure AD and have multiple tenants, you can grant applications and users from one tenant access to other tenants of that same directory.</span><span class="sxs-lookup"><span data-stu-id="175ca-120">If you use Azure AD and have multiple tenants, you can grant applications and users from one tenant access to other tenants of that same directory.</span></span>
- <span data-ttu-id="175ca-121">AD FS supports only a single tenant and, therefore, only a single organization.</span><span class="sxs-lookup"><span data-stu-id="175ca-121">AD FS supports only a single tenant and, therefore, only a single organization.</span></span> 

### <a name="users-and-groups"></a><span data-ttu-id="175ca-122">Users and groups</span><span class="sxs-lookup"><span data-stu-id="175ca-122">Users and groups</span></span>
<span data-ttu-id="175ca-123">User accounts (identities) are standard accounts that authenticate individuals by using a user ID and password.</span><span class="sxs-lookup"><span data-stu-id="175ca-123">User accounts (identities) are standard accounts that authenticate individuals by using a user ID and password.</span></span> <span data-ttu-id="175ca-124">Groups can include users or other groups.</span><span class="sxs-lookup"><span data-stu-id="175ca-124">Groups can include users or other groups.</span></span> 

<span data-ttu-id="175ca-125">How you create and manage users and groups depends on the identity solution you use.</span><span class="sxs-lookup"><span data-stu-id="175ca-125">How you create and manage users and groups depends on the identity solution you use.</span></span> 

<span data-ttu-id="175ca-126">In Azure Stack, user accounts:</span><span class="sxs-lookup"><span data-stu-id="175ca-126">In Azure Stack, user accounts:</span></span> 
- <span data-ttu-id="175ca-127">Are created in the *username@domain* format.</span><span class="sxs-lookup"><span data-stu-id="175ca-127">Are created in the *username@domain* format.</span></span> <span data-ttu-id="175ca-128">Although AD FS maps user accounts to an Active Directory instance, AD FS does not support the use of the *\<domain>\<alias>* format.</span><span class="sxs-lookup"><span data-stu-id="175ca-128">Although AD FS maps user accounts to an Active Directory instance, AD FS does not support the use of the *\<domain>\<alias>* format.</span></span> 
- <span data-ttu-id="175ca-129">Can be set up to use multi-factor authentication.</span><span class="sxs-lookup"><span data-stu-id="175ca-129">Can be set up to use multi-factor authentication.</span></span> 
- <span data-ttu-id="175ca-130">Are restricted to the directory where they first register, which is their organization's directory.</span><span class="sxs-lookup"><span data-stu-id="175ca-130">Are restricted to the directory where they first register, which is their organization's directory.</span></span>
- <span data-ttu-id="175ca-131">Can be imported from your on-premises directories.</span><span class="sxs-lookup"><span data-stu-id="175ca-131">Can be imported from your on-premises directories.</span></span> <span data-ttu-id="175ca-132">For more information, see  [Integrate your on-premises directories with Azure Active Directory](/azure/active-directory/connect/active-directory-aadconnect).</span><span class="sxs-lookup"><span data-stu-id="175ca-132">For more information, see  [Integrate your on-premises directories with Azure Active Directory](/azure/active-directory/connect/active-directory-aadconnect).</span></span> 

<span data-ttu-id="175ca-133">When you sign in to your organization's tenant portal, you use the *https://portal.local.azurestack.external* URL.</span><span class="sxs-lookup"><span data-stu-id="175ca-133">When you sign in to your organization's tenant portal, you use the *https://portal.local.azurestack.external* URL.</span></span> 

### <a name="guest-users"></a><span data-ttu-id="175ca-134">Guest users</span><span class="sxs-lookup"><span data-stu-id="175ca-134">Guest users</span></span>
<span data-ttu-id="175ca-135">Guest users are user accounts from other directory tenants that have been granted access to resources in your directory.</span><span class="sxs-lookup"><span data-stu-id="175ca-135">Guest users are user accounts from other directory tenants that have been granted access to resources in your directory.</span></span> <span data-ttu-id="175ca-136">To support guest users, you use Azure AD and enable support for multi-tenancy.</span><span class="sxs-lookup"><span data-stu-id="175ca-136">To support guest users, you use Azure AD and enable support for multi-tenancy.</span></span> <span data-ttu-id="175ca-137">When support is enabled, you can invite guest users to access resources in your directory tenant, which in turn enables their collaboration with outside organizations.</span><span class="sxs-lookup"><span data-stu-id="175ca-137">When support is enabled, you can invite guest users to access resources in your directory tenant, which in turn enables their collaboration with outside organizations.</span></span> 

<span data-ttu-id="175ca-138">To invite guest users, cloud operators and users can use [Azure AD B2B collaboration](/azure/active-directory/active-directory-b2b-what-is-azure-ad-b2b).</span><span class="sxs-lookup"><span data-stu-id="175ca-138">To invite guest users, cloud operators and users can use [Azure AD B2B collaboration](/azure/active-directory/active-directory-b2b-what-is-azure-ad-b2b).</span></span> <span data-ttu-id="175ca-139">Invited users get access to documents, resources, and applications from your directory, and you maintain control over your own resources and data.</span><span class="sxs-lookup"><span data-stu-id="175ca-139">Invited users get access to documents, resources, and applications from your directory, and you maintain control over your own resources and data.</span></span> 

<span data-ttu-id="175ca-140">As a guest user, you can sign in to another organization's directory tenant.</span><span class="sxs-lookup"><span data-stu-id="175ca-140">As a guest user, you can sign in to another organization's directory tenant.</span></span> <span data-ttu-id="175ca-141">To do so, you append that organization's directory name to the portal URL.</span><span class="sxs-lookup"><span data-stu-id="175ca-141">To do so, you append that organization's directory name to the portal URL.</span></span> <span data-ttu-id="175ca-142">For example, if you belong to the Contoso organization and want to sign in to the Fabrikam directory, you use https://portal.local.azurestack.external/fabrikam.onmicrosoft.com.</span><span class="sxs-lookup"><span data-stu-id="175ca-142">For example, if you belong to the Contoso organization and want to sign in to the Fabrikam directory, you use https://portal.local.azurestack.external/fabrikam.onmicrosoft.com.</span></span>

### <a name="applications"></a><span data-ttu-id="175ca-143">Applications</span><span class="sxs-lookup"><span data-stu-id="175ca-143">Applications</span></span>
<span data-ttu-id="175ca-144">You can register applications to Azure AD or AD FS, and then offer the applications to users in your organization.</span><span class="sxs-lookup"><span data-stu-id="175ca-144">You can register applications to Azure AD or AD FS, and then offer the applications to users in your organization.</span></span> 

<span data-ttu-id="175ca-145">Applications include:</span><span class="sxs-lookup"><span data-stu-id="175ca-145">Applications include:</span></span>
- <span data-ttu-id="175ca-146">**Web application**: Examples include the Azure portal and Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="175ca-146">**Web application**: Examples include the Azure portal and Azure Resource Manager.</span></span> <span data-ttu-id="175ca-147">They support Web API calls.</span><span class="sxs-lookup"><span data-stu-id="175ca-147">They support Web API calls.</span></span> 
- <span data-ttu-id="175ca-148">**Native client**: Examples include Azure PowerShell, Visual Studio, and Azure CLI.</span><span class="sxs-lookup"><span data-stu-id="175ca-148">**Native client**: Examples include Azure PowerShell, Visual Studio, and Azure CLI.</span></span>

<span data-ttu-id="175ca-149">Applications can support two types of tenancy:</span><span class="sxs-lookup"><span data-stu-id="175ca-149">Applications can support two types of tenancy:</span></span> 
- <span data-ttu-id="175ca-150">**Single-tenant**: Supports users and services only from the same directory where the application is registered.</span><span class="sxs-lookup"><span data-stu-id="175ca-150">**Single-tenant**: Supports users and services only from the same directory where the application is registered.</span></span> 

  > [!NOTE]    
  > <span data-ttu-id="175ca-151">Because AD FS supports only a single directory, applications you create in an AD FS topology are, by design, single-tenant applications.</span><span class="sxs-lookup"><span data-stu-id="175ca-151">Because AD FS supports only a single directory, applications you create in an AD FS topology are, by design, single-tenant applications.</span></span>

- <span data-ttu-id="175ca-152">**Multi-tenant**: Supports use by users and services from both the directory where the application is registered and additional tenant directories.</span><span class="sxs-lookup"><span data-stu-id="175ca-152">**Multi-tenant**: Supports use by users and services from both the directory where the application is registered and additional tenant directories.</span></span> <span data-ttu-id="175ca-153">With multi-tenant applications, users of another tenant directory (another Azure AD tenant) can sign in to your application.</span><span class="sxs-lookup"><span data-stu-id="175ca-153">With multi-tenant applications, users of another tenant directory (another Azure AD tenant) can sign in to your application.</span></span> 

  <span data-ttu-id="175ca-154">For more information about multi-tenancy, see [Enable multi-tenancy](azure-stack-enable-multitenancy.md).</span><span class="sxs-lookup"><span data-stu-id="175ca-154">For more information about multi-tenancy, see [Enable multi-tenancy](azure-stack-enable-multitenancy.md).</span></span> 

  <span data-ttu-id="175ca-155">For more information about developing a multi-tenant app, see [Multi-tenant apps](/azure/active-directory/develop/active-directory-devhowto-multi-tenant-overview).</span><span class="sxs-lookup"><span data-stu-id="175ca-155">For more information about developing a multi-tenant app, see [Multi-tenant apps](/azure/active-directory/develop/active-directory-devhowto-multi-tenant-overview).</span></span>

<span data-ttu-id="175ca-156">When you register an application, you create two objects:</span><span class="sxs-lookup"><span data-stu-id="175ca-156">When you register an application, you create two objects:</span></span>

- <span data-ttu-id="175ca-157">**Application object**: The global representation of the application across all tenants.</span><span class="sxs-lookup"><span data-stu-id="175ca-157">**Application object**: The global representation of the application across all tenants.</span></span> <span data-ttu-id="175ca-158">This relationship is one-to-one with the software application and exists only in the directory where the application is first registered.</span><span class="sxs-lookup"><span data-stu-id="175ca-158">This relationship is one-to-one with the software application and exists only in the directory where the application is first registered.</span></span>

- <span data-ttu-id="175ca-159">**Service principal object**: A credential that is created for an application in the directory where the application is first registered.</span><span class="sxs-lookup"><span data-stu-id="175ca-159">**Service principal object**: A credential that is created for an application in the directory where the application is first registered.</span></span> <span data-ttu-id="175ca-160">A service principal is also created in the directory of each additional tenant where that application is used.</span><span class="sxs-lookup"><span data-stu-id="175ca-160">A service principal is also created in the directory of each additional tenant where that application is used.</span></span> <span data-ttu-id="175ca-161">This relationship can be one-to-many with the software application.</span><span class="sxs-lookup"><span data-stu-id="175ca-161">This relationship can be one-to-many with the software application.</span></span> 

<span data-ttu-id="175ca-162">To learn more about application and service principal objects, see [Application and service principal objects in Azure Active Directory](/azure/active-directory/develop/active-directory-application-objects).</span><span class="sxs-lookup"><span data-stu-id="175ca-162">To learn more about application and service principal objects, see [Application and service principal objects in Azure Active Directory](/azure/active-directory/develop/active-directory-application-objects).</span></span> 

### <a name="service-principals"></a><span data-ttu-id="175ca-163">Service principals</span><span class="sxs-lookup"><span data-stu-id="175ca-163">Service principals</span></span> 
<span data-ttu-id="175ca-164">A service principal is a set of *credentials* for an application or service that grant access to resources in Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="175ca-164">A service principal is a set of *credentials* for an application or service that grant access to resources in Azure Stack.</span></span> <span data-ttu-id="175ca-165">The use of a service principal separates the application permissions from the permissions of the user of the application.</span><span class="sxs-lookup"><span data-stu-id="175ca-165">The use of a service principal separates the application permissions from the permissions of the user of the application.</span></span>

<span data-ttu-id="175ca-166">A service principal is created in each tenant where the application is used.</span><span class="sxs-lookup"><span data-stu-id="175ca-166">A service principal is created in each tenant where the application is used.</span></span> <span data-ttu-id="175ca-167">The service principal establishes an identity for sign-in and access to resources (such as users) that are secured by that tenant.</span><span class="sxs-lookup"><span data-stu-id="175ca-167">The service principal establishes an identity for sign-in and access to resources (such as users) that are secured by that tenant.</span></span> 

- <span data-ttu-id="175ca-168">A single-tenant application has only one service principal, in the directory where it is first created.</span><span class="sxs-lookup"><span data-stu-id="175ca-168">A single-tenant application has only one service principal, in the directory where it is first created.</span></span> <span data-ttu-id="175ca-169">This service principal is created and consents to being used during registration of the application.</span><span class="sxs-lookup"><span data-stu-id="175ca-169">This service principal is created and consents to being used during registration of the application.</span></span> 
- <span data-ttu-id="175ca-170">A multi-tenant web application or API has a service principal that's created in each tenant where a user from that tenant consents to the use of the application.</span><span class="sxs-lookup"><span data-stu-id="175ca-170">A multi-tenant web application or API has a service principal that's created in each tenant where a user from that tenant consents to the use of the application.</span></span> 

<span data-ttu-id="175ca-171">Credentials for service principals can be either a key that's generated through the Azure portal or a certificate.</span><span class="sxs-lookup"><span data-stu-id="175ca-171">Credentials for service principals can be either a key that's generated through the Azure portal or a certificate.</span></span> <span data-ttu-id="175ca-172">The use of a certificate is suited for automation because certificates are considered more secure than keys.</span><span class="sxs-lookup"><span data-stu-id="175ca-172">The use of a certificate is suited for automation because certificates are considered more secure than keys.</span></span> 


> [!NOTE]    
> <span data-ttu-id="175ca-173">When you use AD FS with Azure Stack, only the administrator can create service principals.</span><span class="sxs-lookup"><span data-stu-id="175ca-173">When you use AD FS with Azure Stack, only the administrator can create service principals.</span></span> <span data-ttu-id="175ca-174">With AD FS, service principals require certificates and are created through the privileged endpoint (PEP).</span><span class="sxs-lookup"><span data-stu-id="175ca-174">With AD FS, service principals require certificates and are created through the privileged endpoint (PEP).</span></span> <span data-ttu-id="175ca-175">For more information, see [Provide applications access to Azure Stack](azure-stack-create-service-principals.md).</span><span class="sxs-lookup"><span data-stu-id="175ca-175">For more information, see [Provide applications access to Azure Stack](azure-stack-create-service-principals.md).</span></span>

<span data-ttu-id="175ca-176">To learn about service principals for Azure Stack, see [Create service principals](azure-stack-create-service-principals.md).</span><span class="sxs-lookup"><span data-stu-id="175ca-176">To learn about service principals for Azure Stack, see [Create service principals](azure-stack-create-service-principals.md).</span></span>


### <a name="services"></a><span data-ttu-id="175ca-177">Services</span><span class="sxs-lookup"><span data-stu-id="175ca-177">Services</span></span>
<span data-ttu-id="175ca-178">Services in Azure Stack that interact with the identity provider are registered as applications with the identity provider.</span><span class="sxs-lookup"><span data-stu-id="175ca-178">Services in Azure Stack that interact with the identity provider are registered as applications with the identity provider.</span></span> <span data-ttu-id="175ca-179">Like applications, registration enables a service to authenticate with the identity system.</span><span class="sxs-lookup"><span data-stu-id="175ca-179">Like applications, registration enables a service to authenticate with the identity system.</span></span> 

<span data-ttu-id="175ca-180">All Azure services use [OpenID Connect](/azure/active-directory/develop/active-directory-protocols-openid-connect-code) protocols and [JSON Web Tokens](/azure/active-directory/develop/active-directory-token-and-claims) to establish their identity.</span><span class="sxs-lookup"><span data-stu-id="175ca-180">All Azure services use [OpenID Connect](/azure/active-directory/develop/active-directory-protocols-openid-connect-code) protocols and [JSON Web Tokens](/azure/active-directory/develop/active-directory-token-and-claims) to establish their identity.</span></span> <span data-ttu-id="175ca-181">Because Azure AD and AD FS use protocols consistently, you can use [Azure Active Directory Authentication Library](/azure/active-directory/develop/active-directory-authentication-libraries) (ADAL) to authenticate on-premises or to Azure (in a connected scenario).</span><span class="sxs-lookup"><span data-stu-id="175ca-181">Because Azure AD and AD FS use protocols consistently, you can use [Azure Active Directory Authentication Library](/azure/active-directory/develop/active-directory-authentication-libraries) (ADAL) to authenticate on-premises or to Azure (in a connected scenario).</span></span> <span data-ttu-id="175ca-182">With ADAL, you can also use tools such as Azure PowerShell and Azure CLI for cross-cloud and on-premises resource management.</span><span class="sxs-lookup"><span data-stu-id="175ca-182">With ADAL, you can also use tools such as Azure PowerShell and Azure CLI for cross-cloud and on-premises resource management.</span></span> 


### <a name="identities-and-your-identity-system"></a><span data-ttu-id="175ca-183">Identities and your identity system</span><span class="sxs-lookup"><span data-stu-id="175ca-183">Identities and your identity system</span></span> 
<span data-ttu-id="175ca-184">Identities for Azure Stack include user accounts, groups, and service principals.</span><span class="sxs-lookup"><span data-stu-id="175ca-184">Identities for Azure Stack include user accounts, groups, and service principals.</span></span> 

<span data-ttu-id="175ca-185">When you install Azure Stack, several built-in applications and services automatically register with your identity provider in the directory tenant.</span><span class="sxs-lookup"><span data-stu-id="175ca-185">When you install Azure Stack, several built-in applications and services automatically register with your identity provider in the directory tenant.</span></span> <span data-ttu-id="175ca-186">Some services that register are used for administration.</span><span class="sxs-lookup"><span data-stu-id="175ca-186">Some services that register are used for administration.</span></span> <span data-ttu-id="175ca-187">Other services are available for users.</span><span class="sxs-lookup"><span data-stu-id="175ca-187">Other services are available for users.</span></span> <span data-ttu-id="175ca-188">The default registrations give core services identities that can interact both with each other and with identities that you add later.</span><span class="sxs-lookup"><span data-stu-id="175ca-188">The default registrations give core services identities that can interact both with each other and with identities that you add later.</span></span>

<span data-ttu-id="175ca-189">If you set up Azure AD with multi-tenancy, some applications propagate to the new directories.</span><span class="sxs-lookup"><span data-stu-id="175ca-189">If you set up Azure AD with multi-tenancy, some applications propagate to the new directories.</span></span> 

## <a name="authentication-and-authorization"></a><span data-ttu-id="175ca-190">Authentication and authorization</span><span class="sxs-lookup"><span data-stu-id="175ca-190">Authentication and authorization</span></span>
 

### <a name="authentication-by-applications-and-users"></a><span data-ttu-id="175ca-191">Authentication by applications and users</span><span class="sxs-lookup"><span data-stu-id="175ca-191">Authentication by applications and users</span></span>
  
![Identity between layers of Azure Stack](media/azure-stack-identity-overview/identity-layers.png)

<span data-ttu-id="175ca-193">For applications and users, the architecture of Azure Stack is described by four layers.</span><span class="sxs-lookup"><span data-stu-id="175ca-193">For applications and users, the architecture of Azure Stack is described by four layers.</span></span> <span data-ttu-id="175ca-194">Interactions between each of these layers can use different types of authentication.</span><span class="sxs-lookup"><span data-stu-id="175ca-194">Interactions between each of these layers can use different types of authentication.</span></span>


|<span data-ttu-id="175ca-195">Layer</span><span class="sxs-lookup"><span data-stu-id="175ca-195">Layer</span></span>    |<span data-ttu-id="175ca-196">Authentication between layers</span><span class="sxs-lookup"><span data-stu-id="175ca-196">Authentication between layers</span></span>  |
|---------|---------|
|<span data-ttu-id="175ca-197">Tools and clients, such as the Admin portal</span><span class="sxs-lookup"><span data-stu-id="175ca-197">Tools and clients, such as the Admin portal</span></span>     | <span data-ttu-id="175ca-198">To access or modify a resource in Azure Stack, tools and clients use a [JSON Web Token](/azure/active-directory/develop/active-directory-token-and-claims) to place a call to Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="175ca-198">To access or modify a resource in Azure Stack, tools and clients use a [JSON Web Token](/azure/active-directory/develop/active-directory-token-and-claims) to place a call to Azure Resource Manager.</span></span> <br><span data-ttu-id="175ca-199">Azure Resource Manager validates the JSON Web Token and peeks at the *claims* in the issued token to estimate the level of authorization that user or service principal has in Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="175ca-199">Azure Resource Manager validates the JSON Web Token and peeks at the *claims* in the issued token to estimate the level of authorization that user or service principal has in Azure Stack.</span></span> |
|<span data-ttu-id="175ca-200">Azure Resource Manager and its core services</span><span class="sxs-lookup"><span data-stu-id="175ca-200">Azure Resource Manager and its core services</span></span>     |<span data-ttu-id="175ca-201">Azure Resource Manager communicates with resource providers to transfer communication from users.</span><span class="sxs-lookup"><span data-stu-id="175ca-201">Azure Resource Manager communicates with resource providers to transfer communication from users.</span></span> <br> <span data-ttu-id="175ca-202">Transfers use *direct imperative* calls or *declarative* calls via [Azure Resource Manager templates](/azure/azure-stack/user/azure-stack-arm-templates).</span><span class="sxs-lookup"><span data-stu-id="175ca-202">Transfers use *direct imperative* calls or *declarative* calls via [Azure Resource Manager templates](/azure/azure-stack/user/azure-stack-arm-templates).</span></span>|
|<span data-ttu-id="175ca-203">Resource providers</span><span class="sxs-lookup"><span data-stu-id="175ca-203">Resource providers</span></span>     |<span data-ttu-id="175ca-204">Calls that are passed to resource providers are secured with certificate-based authentication.</span><span class="sxs-lookup"><span data-stu-id="175ca-204">Calls that are passed to resource providers are secured with certificate-based authentication.</span></span> <br><span data-ttu-id="175ca-205">Azure Resource Manager and the resource provider then stay in communication through an API.</span><span class="sxs-lookup"><span data-stu-id="175ca-205">Azure Resource Manager and the resource provider then stay in communication through an API.</span></span> <span data-ttu-id="175ca-206">For every call that's received from Azure Resource Manager, the resource provider validates the call with that certificate.</span><span class="sxs-lookup"><span data-stu-id="175ca-206">For every call that's received from Azure Resource Manager, the resource provider validates the call with that certificate.</span></span>|
|<span data-ttu-id="175ca-207">Infrastructure and business logic</span><span class="sxs-lookup"><span data-stu-id="175ca-207">Infrastructure and business logic</span></span>     |<span data-ttu-id="175ca-208">Resource providers communicate with business logic and infrastructure by using an authentication mode of their choice.</span><span class="sxs-lookup"><span data-stu-id="175ca-208">Resource providers communicate with business logic and infrastructure by using an authentication mode of their choice.</span></span> <span data-ttu-id="175ca-209">The default resource providers that ship with Azure Stack use Windows Authentication to secure this communication.</span><span class="sxs-lookup"><span data-stu-id="175ca-209">The default resource providers that ship with Azure Stack use Windows Authentication to secure this communication.</span></span>|

![Information needed for authentication](media/azure-stack-identity-overview/authentication.png)


### <a name="authenticate-to-azure-resource-manager"></a><span data-ttu-id="175ca-211">Authenticate to Azure Resource Manager</span><span class="sxs-lookup"><span data-stu-id="175ca-211">Authenticate to Azure Resource Manager</span></span>
<span data-ttu-id="175ca-212">To authenticate with the identity provider and receive a JSON Web Token, you must have the following information:</span><span class="sxs-lookup"><span data-stu-id="175ca-212">To authenticate with the identity provider and receive a JSON Web Token, you must have the following information:</span></span> 
1.  <span data-ttu-id="175ca-213">**URL for the identity system (Authority)**: The URL at which your identity provider can be reached.</span><span class="sxs-lookup"><span data-stu-id="175ca-213">**URL for the identity system (Authority)**: The URL at which your identity provider can be reached.</span></span> <span data-ttu-id="175ca-214">For example, *https://login.windows.net*.</span><span class="sxs-lookup"><span data-stu-id="175ca-214">For example, *https://login.windows.net*.</span></span> 
2.  <span data-ttu-id="175ca-215">**App ID URI for Azure Resource Manager**:  The unique identifier for Azure Resource Manager that is registered with your identity provider.</span><span class="sxs-lookup"><span data-stu-id="175ca-215">**App ID URI for Azure Resource Manager**:  The unique identifier for Azure Resource Manager that is registered with your identity provider.</span></span> <span data-ttu-id="175ca-216">It is also unique to each Azure Stack installation.</span><span class="sxs-lookup"><span data-stu-id="175ca-216">It is also unique to each Azure Stack installation.</span></span>
3.  <span data-ttu-id="175ca-217">**Credentials**: The credential you use to authenticate with the identity provider.</span><span class="sxs-lookup"><span data-stu-id="175ca-217">**Credentials**: The credential you use to authenticate with the identity provider.</span></span> 
4.  <span data-ttu-id="175ca-218">**URL for Azure Resource Manager**: The URL is the location of the Azure Resource Manager service.</span><span class="sxs-lookup"><span data-stu-id="175ca-218">**URL for Azure Resource Manager**: The URL is the location of the Azure Resource Manager service.</span></span> <span data-ttu-id="175ca-219">For example, *https://management.azure.com* or *https://management.local.azurestack.external*.</span><span class="sxs-lookup"><span data-stu-id="175ca-219">For example, *https://management.azure.com* or *https://management.local.azurestack.external*.</span></span>

<span data-ttu-id="175ca-220">When a principal (a client, application, or user) makes an authentication request to access a resource, the request must include:</span><span class="sxs-lookup"><span data-stu-id="175ca-220">When a principal (a client, application, or user) makes an authentication request to access a resource, the request must include:</span></span>
- <span data-ttu-id="175ca-221">The principal’s credentials.</span><span class="sxs-lookup"><span data-stu-id="175ca-221">The principal’s credentials.</span></span>
- <span data-ttu-id="175ca-222">The app ID URI of the resource that the principal wants to access.</span><span class="sxs-lookup"><span data-stu-id="175ca-222">The app ID URI of the resource that the principal wants to access.</span></span> 

<span data-ttu-id="175ca-223">The credentials are validated by the identity provider.</span><span class="sxs-lookup"><span data-stu-id="175ca-223">The credentials are validated by the identity provider.</span></span> <span data-ttu-id="175ca-224">The identity provider also validates that the app ID URI is for a registered application, and that the principal has the correct privileges to obtain a token for that resource.</span><span class="sxs-lookup"><span data-stu-id="175ca-224">The identity provider also validates that the app ID URI is for a registered application, and that the principal has the correct privileges to obtain a token for that resource.</span></span> <span data-ttu-id="175ca-225">If the request is valid, a JSON Web Token is granted.</span><span class="sxs-lookup"><span data-stu-id="175ca-225">If the request is valid, a JSON Web Token is granted.</span></span> 

<span data-ttu-id="175ca-226">The token must then pass in the header of a request to Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="175ca-226">The token must then pass in the header of a request to Azure Resource Manager.</span></span> <span data-ttu-id="175ca-227">Azure Resource Manager does the following, in no specific order:</span><span class="sxs-lookup"><span data-stu-id="175ca-227">Azure Resource Manager does the following, in no specific order:</span></span>
- <span data-ttu-id="175ca-228">Validates the *issuer* (iss) claim to confirm that the token is from the correct identity provider.</span><span class="sxs-lookup"><span data-stu-id="175ca-228">Validates the *issuer* (iss) claim to confirm that the token is from the correct identity provider.</span></span> 
- <span data-ttu-id="175ca-229">Validates the *audience* (aud) claim to confirm that the token was issued to Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="175ca-229">Validates the *audience* (aud) claim to confirm that the token was issued to Azure Resource Manager.</span></span> 
- <span data-ttu-id="175ca-230">Validates that the JSON Web Token is signed with a certificate that is configured through OpenID is known to Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="175ca-230">Validates that the JSON Web Token is signed with a certificate that is configured through OpenID is known to Azure Resource Manager.</span></span> 
- <span data-ttu-id="175ca-231">Review the *issued at* (iat) and *expiration* (exp) claims to confirm that the token is active and can be accepted.</span><span class="sxs-lookup"><span data-stu-id="175ca-231">Review the *issued at* (iat) and *expiration* (exp) claims to confirm that the token is active and can be accepted.</span></span> 

<span data-ttu-id="175ca-232">When all validations are complete, Azure Resource Manager uses the *objected* (oid) and the *groups* claims to make a list of resources that the principal can access.</span><span class="sxs-lookup"><span data-stu-id="175ca-232">When all validations are complete, Azure Resource Manager uses the *objected* (oid) and the *groups* claims to make a list of resources that the principal can access.</span></span> 

![Diagram of the token exchange protocol](media/azure-stack-identity-overview/token-exchange.png)


### <a name="use-role-based-access-control"></a><span data-ttu-id="175ca-234">Use Role-Based Access Control</span><span class="sxs-lookup"><span data-stu-id="175ca-234">Use Role-Based Access Control</span></span>  
<span data-ttu-id="175ca-235">Role-Based Access Control (RBAC) in Azure Stack is consistent with the implementation in Microsoft Azure.</span><span class="sxs-lookup"><span data-stu-id="175ca-235">Role-Based Access Control (RBAC) in Azure Stack is consistent with the implementation in Microsoft Azure.</span></span> <span data-ttu-id="175ca-236">You can manage access to resources by assigning the appropriate RBAC role to users, groups, and applications.</span><span class="sxs-lookup"><span data-stu-id="175ca-236">You can manage access to resources by assigning the appropriate RBAC role to users, groups, and applications.</span></span> <span data-ttu-id="175ca-237">For information about how to use RBAC with Azure Stack, see the following articles:</span><span class="sxs-lookup"><span data-stu-id="175ca-237">For information about how to use RBAC with Azure Stack, see the following articles:</span></span>
- <span data-ttu-id="175ca-238">[Get started with Role-Based Access Control in the Azure portal](/azure/role-based-access-control/overview).</span><span class="sxs-lookup"><span data-stu-id="175ca-238">[Get started with Role-Based Access Control in the Azure portal](/azure/role-based-access-control/overview).</span></span>
- <span data-ttu-id="175ca-239">[Use Role-Based Access Control to manage access to your Azure subscription resources](/azure/role-based-access-control/role-assignments-portal).</span><span class="sxs-lookup"><span data-stu-id="175ca-239">[Use Role-Based Access Control to manage access to your Azure subscription resources](/azure/role-based-access-control/role-assignments-portal).</span></span>
- <span data-ttu-id="175ca-240">[Create custom roles for Azure Role-Based Access Control](/azure/role-based-access-control/custom-roles).</span><span class="sxs-lookup"><span data-stu-id="175ca-240">[Create custom roles for Azure Role-Based Access Control](/azure/role-based-access-control/custom-roles).</span></span>
- <span data-ttu-id="175ca-241">[Manage Role-Based Access Control](azure-stack-manage-permissions.md) in Azure Stack.</span><span class="sxs-lookup"><span data-stu-id="175ca-241">[Manage Role-Based Access Control](azure-stack-manage-permissions.md) in Azure Stack.</span></span>


### <a name="authenticate-with-azure-powershell"></a><span data-ttu-id="175ca-242">Authenticate with Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="175ca-242">Authenticate with Azure PowerShell</span></span>  
<span data-ttu-id="175ca-243">Details about using Azure PowerShell to authenticate with Azure Stack can be found at [Configure the Azure Stack user's PowerShell environment](azure-stack-powershell-configure-user.md).</span><span class="sxs-lookup"><span data-stu-id="175ca-243">Details about using Azure PowerShell to authenticate with Azure Stack can be found at [Configure the Azure Stack user's PowerShell environment](azure-stack-powershell-configure-user.md).</span></span>

### <a name="authenticate-with-azure-cli"></a><span data-ttu-id="175ca-244">Authenticate with Azure CLI</span><span class="sxs-lookup"><span data-stu-id="175ca-244">Authenticate with Azure CLI</span></span>
<span data-ttu-id="175ca-245">For information about using Azure PowerShell to authenticate with Azure Stack, see [Install and configure Azure CLI for use with Azure Stack](/azure/azure-stack/user/azure-stack-connect-cli).</span><span class="sxs-lookup"><span data-stu-id="175ca-245">For information about using Azure PowerShell to authenticate with Azure Stack, see [Install and configure Azure CLI for use with Azure Stack](/azure/azure-stack/user/azure-stack-connect-cli).</span></span>

## <a name="next-steps"></a><span data-ttu-id="175ca-246">Next steps</span><span class="sxs-lookup"><span data-stu-id="175ca-246">Next steps</span></span>
- [<span data-ttu-id="175ca-247">Identity architecture</span><span class="sxs-lookup"><span data-stu-id="175ca-247">Identity architecture</span></span>](azure-stack-identity-architecture.md)   
- [<span data-ttu-id="175ca-248">Datacenter integration - identity</span><span class="sxs-lookup"><span data-stu-id="175ca-248">Datacenter integration - identity</span></span>](azure-stack-integrate-identity.md)




