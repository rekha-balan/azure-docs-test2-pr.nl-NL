---
title: Connect Excel to Hadoop with the Hive ODBC Driver - Azure HDInsight
description: Learn how to set up and use the Microsoft Hive ODBC driver for Excel to query data in HDInsight clusters from Microsoft Excel.
keywords: hadoop excel,hive excel,hive odbc
services: hdinsight
author: jasonwhowell
ms.reviewer: jasonh
ms.service: hdinsight
ms.custom: hdinsightactive,hdiseo17may2017
ms.topic: conceptual
ms.date: 05/16/2018
ms.author: jasonh
ms.openlocfilehash: b21863d7a91c14f9795d72a13575e33485ba7d2b
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44871584"
---
# <a name="connect-excel-to-hadoop-in-azure-hdinsight-with-the-microsoft-hive-odbc-driver"></a><span data-ttu-id="31ae2-104">Connect Excel to Hadoop in Azure HDInsight with the Microsoft Hive ODBC driver</span><span class="sxs-lookup"><span data-stu-id="31ae2-104">Connect Excel to Hadoop in Azure HDInsight with the Microsoft Hive ODBC driver</span></span>

[!INCLUDE [ODBC-JDBC-selector](../../../includes/hdinsight-selector-odbc-jdbc.md)]

<span data-ttu-id="31ae2-105">Microsoft's Big Data solution integrates Microsoft Business Intelligence (BI) components with Apache Hadoop clusters that have been deployed by the Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="31ae2-105">Microsoft's Big Data solution integrates Microsoft Business Intelligence (BI) components with Apache Hadoop clusters that have been deployed by the Azure HDInsight.</span></span> <span data-ttu-id="31ae2-106">An example of this integration is the ability to connect Excel to the Hive data warehouse of a Hadoop cluster in HDInsight using the Microsoft Hive Open Database Connectivity (ODBC) Driver.</span><span class="sxs-lookup"><span data-stu-id="31ae2-106">An example of this integration is the ability to connect Excel to the Hive data warehouse of a Hadoop cluster in HDInsight using the Microsoft Hive Open Database Connectivity (ODBC) Driver.</span></span>

<span data-ttu-id="31ae2-107">It is also possible to connect the data associated with an HDInsight cluster and other data sources, including other (non-HDInsight) Hadoop clusters, from Excel using the Microsoft Power Query add-in for Excel.</span><span class="sxs-lookup"><span data-stu-id="31ae2-107">It is also possible to connect the data associated with an HDInsight cluster and other data sources, including other (non-HDInsight) Hadoop clusters, from Excel using the Microsoft Power Query add-in for Excel.</span></span> <span data-ttu-id="31ae2-108">For information on installing and using Power Query, see [Connect Excel to HDInsight with Power Query][hdinsight-power-query].</span><span class="sxs-lookup"><span data-stu-id="31ae2-108">For information on installing and using Power Query, see [Connect Excel to HDInsight with Power Query][hdinsight-power-query].</span></span>



<span data-ttu-id="31ae2-109">**Prerequisites**:</span><span class="sxs-lookup"><span data-stu-id="31ae2-109">**Prerequisites**:</span></span>

<span data-ttu-id="31ae2-110">Before you begin this article, you must have the following items:</span><span class="sxs-lookup"><span data-stu-id="31ae2-110">Before you begin this article, you must have the following items:</span></span>

* <span data-ttu-id="31ae2-111">**An HDInsight cluster**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-111">**An HDInsight cluster**.</span></span> <span data-ttu-id="31ae2-112">To create one, see [Get started with Azure HDInsight](apache-hadoop-linux-tutorial-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="31ae2-112">To create one, see [Get started with Azure HDInsight](apache-hadoop-linux-tutorial-get-started.md).</span></span>
* <span data-ttu-id="31ae2-113">**A workstation** with Office 2013 Professional Plus, Office 365 Pro Plus, Excel 2013 Standalone, or Office 2010 Professional Plus.</span><span class="sxs-lookup"><span data-stu-id="31ae2-113">**A workstation** with Office 2013 Professional Plus, Office 365 Pro Plus, Excel 2013 Standalone, or Office 2010 Professional Plus.</span></span>

## <a name="install-microsoft-hive-odbc-driver"></a><span data-ttu-id="31ae2-114">Install Microsoft Hive ODBC driver</span><span class="sxs-lookup"><span data-stu-id="31ae2-114">Install Microsoft Hive ODBC driver</span></span>
<span data-ttu-id="31ae2-115">Download and install Microsoft Hive ODBC Driver from the [Download Center][hive-odbc-driver-download].</span><span class="sxs-lookup"><span data-stu-id="31ae2-115">Download and install Microsoft Hive ODBC Driver from the [Download Center][hive-odbc-driver-download].</span></span>

<span data-ttu-id="31ae2-116">This driver can be installed on 32-bit or 64-bit versions of Windows 7, Windows 8, Windows 10, Windows Server 2008 R2, and Windows Server 2012.</span><span class="sxs-lookup"><span data-stu-id="31ae2-116">This driver can be installed on 32-bit or 64-bit versions of Windows 7, Windows 8, Windows 10, Windows Server 2008 R2, and Windows Server 2012.</span></span> <span data-ttu-id="31ae2-117">The driver allows connection to Azure HDInsight.</span><span class="sxs-lookup"><span data-stu-id="31ae2-117">The driver allows connection to Azure HDInsight.</span></span> <span data-ttu-id="31ae2-118">You shall install the version that matches the version of the application where you use the ODBC driver.</span><span class="sxs-lookup"><span data-stu-id="31ae2-118">You shall install the version that matches the version of the application where you use the ODBC driver.</span></span> <span data-ttu-id="31ae2-119">For this tutorial, the driver is used from Office Excel.</span><span class="sxs-lookup"><span data-stu-id="31ae2-119">For this tutorial, the driver is used from Office Excel.</span></span>

## <a name="create-hive-odbc-data-source"></a><span data-ttu-id="31ae2-120">Create Hive ODBC data source</span><span class="sxs-lookup"><span data-stu-id="31ae2-120">Create Hive ODBC data source</span></span>
<span data-ttu-id="31ae2-121">The following steps show you how to create a Hive ODBC Data Source.</span><span class="sxs-lookup"><span data-stu-id="31ae2-121">The following steps show you how to create a Hive ODBC Data Source.</span></span>

1. <span data-ttu-id="31ae2-122">From Windows 8 or Windows 10, press the Windows key to open the Start screen, and then type **data sources**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-122">From Windows 8 or Windows 10, press the Windows key to open the Start screen, and then type **data sources**.</span></span>
2. <span data-ttu-id="31ae2-123">Click **Set up ODBC Data sources (32-bit)** or **Set up ODBC Data Sources (64-bit)** depending on your Office version.</span><span class="sxs-lookup"><span data-stu-id="31ae2-123">Click **Set up ODBC Data sources (32-bit)** or **Set up ODBC Data Sources (64-bit)** depending on your Office version.</span></span> <span data-ttu-id="31ae2-124">If you are using Windows 7, choose **ODBC Data Sources (32 bit)** or **ODBC Data Sources (64 bit)** from **Administrative Tools**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-124">If you are using Windows 7, choose **ODBC Data Sources (32 bit)** or **ODBC Data Sources (64 bit)** from **Administrative Tools**.</span></span> <span data-ttu-id="31ae2-125">You shall see the **ODBC Data Source Administrator** dialog.</span><span class="sxs-lookup"><span data-stu-id="31ae2-125">You shall see the **ODBC Data Source Administrator** dialog.</span></span>
   
    <span data-ttu-id="31ae2-126">![OBDC data source administrator](./media/apache-hadoop-connect-excel-hive-odbc-driver/HDI.SimbaHiveOdbc.DataSourceAdmin1.png "Configure a DSN using ODBC Data Source Administrator")</span><span class="sxs-lookup"><span data-stu-id="31ae2-126">![OBDC data source administrator](./media/apache-hadoop-connect-excel-hive-odbc-driver/HDI.SimbaHiveOdbc.DataSourceAdmin1.png "Configure a DSN using ODBC Data Source Administrator")</span></span>

3. <span data-ttu-id="31ae2-127">From User DNS, click **Add** to open the **Create New Data Source** wizard.</span><span class="sxs-lookup"><span data-stu-id="31ae2-127">From User DNS, click **Add** to open the **Create New Data Source** wizard.</span></span>
4. <span data-ttu-id="31ae2-128">Select **Microsoft Hive ODBC Driver**, and then click **Finish**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-128">Select **Microsoft Hive ODBC Driver**, and then click **Finish**.</span></span> <span data-ttu-id="31ae2-129">You shall see the **Microsoft Hive ODBC Driver DNS Setup** dialog.</span><span class="sxs-lookup"><span data-stu-id="31ae2-129">You shall see the **Microsoft Hive ODBC Driver DNS Setup** dialog.</span></span>
5. <span data-ttu-id="31ae2-130">Type or select the following values:</span><span class="sxs-lookup"><span data-stu-id="31ae2-130">Type or select the following values:</span></span>
   
   | <span data-ttu-id="31ae2-131">Property</span><span class="sxs-lookup"><span data-stu-id="31ae2-131">Property</span></span> | <span data-ttu-id="31ae2-132">Description</span><span class="sxs-lookup"><span data-stu-id="31ae2-132">Description</span></span> |
   | --- | --- |
   |  <span data-ttu-id="31ae2-133">Data Source Name</span><span class="sxs-lookup"><span data-stu-id="31ae2-133">Data Source Name</span></span> |<span data-ttu-id="31ae2-134">Give a name to your data source</span><span class="sxs-lookup"><span data-stu-id="31ae2-134">Give a name to your data source</span></span> |
   |  <span data-ttu-id="31ae2-135">Host</span><span class="sxs-lookup"><span data-stu-id="31ae2-135">Host</span></span> |<span data-ttu-id="31ae2-136">Enter &lt;HDInsightClusterName>.azurehdinsight.net.</span><span class="sxs-lookup"><span data-stu-id="31ae2-136">Enter &lt;HDInsightClusterName>.azurehdinsight.net.</span></span> <span data-ttu-id="31ae2-137">For example, myHDICluster.azurehdinsight.net</span><span class="sxs-lookup"><span data-stu-id="31ae2-137">For example, myHDICluster.azurehdinsight.net</span></span> |
   |  <span data-ttu-id="31ae2-138">Port</span><span class="sxs-lookup"><span data-stu-id="31ae2-138">Port</span></span> |<span data-ttu-id="31ae2-139">Use <strong>443</strong>.</span><span class="sxs-lookup"><span data-stu-id="31ae2-139">Use <strong>443</strong>.</span></span> <span data-ttu-id="31ae2-140">(This port has been changed from 563 to 443.)</span><span class="sxs-lookup"><span data-stu-id="31ae2-140">(This port has been changed from 563 to 443.)</span></span> |
   |  <span data-ttu-id="31ae2-141">Database</span><span class="sxs-lookup"><span data-stu-id="31ae2-141">Database</span></span> |<span data-ttu-id="31ae2-142">Use <strong>Default</strong>.</span><span class="sxs-lookup"><span data-stu-id="31ae2-142">Use <strong>Default</strong>.</span></span> |
   |  <span data-ttu-id="31ae2-143">Mechanism</span><span class="sxs-lookup"><span data-stu-id="31ae2-143">Mechanism</span></span> |<span data-ttu-id="31ae2-144">Select <strong>Azure HDInsight Service</strong></span><span class="sxs-lookup"><span data-stu-id="31ae2-144">Select <strong>Azure HDInsight Service</strong></span></span> |
   |  <span data-ttu-id="31ae2-145">User Name</span><span class="sxs-lookup"><span data-stu-id="31ae2-145">User Name</span></span> |<span data-ttu-id="31ae2-146">Enter HDInsight cluster HTTP user username.</span><span class="sxs-lookup"><span data-stu-id="31ae2-146">Enter HDInsight cluster HTTP user username.</span></span> <span data-ttu-id="31ae2-147">The default username is <strong>admin</strong>.</span><span class="sxs-lookup"><span data-stu-id="31ae2-147">The default username is <strong>admin</strong>.</span></span> |
   |  <span data-ttu-id="31ae2-148">Password</span><span class="sxs-lookup"><span data-stu-id="31ae2-148">Password</span></span> |<span data-ttu-id="31ae2-149">Enter HDInsight cluster user password.</span><span class="sxs-lookup"><span data-stu-id="31ae2-149">Enter HDInsight cluster user password.</span></span> |
   
    </table>
   
    <span data-ttu-id="31ae2-150">There are some important parameters to be aware of when you click **Advanced Options**:</span><span class="sxs-lookup"><span data-stu-id="31ae2-150">There are some important parameters to be aware of when you click **Advanced Options**:</span></span>
   
   | <span data-ttu-id="31ae2-151">Parameter</span><span class="sxs-lookup"><span data-stu-id="31ae2-151">Parameter</span></span> | <span data-ttu-id="31ae2-152">Description</span><span class="sxs-lookup"><span data-stu-id="31ae2-152">Description</span></span> |
   | --- | --- |
   |  <span data-ttu-id="31ae2-153">Use Native Query</span><span class="sxs-lookup"><span data-stu-id="31ae2-153">Use Native Query</span></span> |<span data-ttu-id="31ae2-154">When it is selected, the ODBC driver does NOT try to convert TSQL into HiveQL.</span><span class="sxs-lookup"><span data-stu-id="31ae2-154">When it is selected, the ODBC driver does NOT try to convert TSQL into HiveQL.</span></span> <span data-ttu-id="31ae2-155">You shall use it only if you are 100% sure you are submitting pure HiveQL statements.</span><span class="sxs-lookup"><span data-stu-id="31ae2-155">You shall use it only if you are 100% sure you are submitting pure HiveQL statements.</span></span> <span data-ttu-id="31ae2-156">When connecting to SQL Server or Azure SQL Database, you should leave it unchecked.</span><span class="sxs-lookup"><span data-stu-id="31ae2-156">When connecting to SQL Server or Azure SQL Database, you should leave it unchecked.</span></span> |
   |  <span data-ttu-id="31ae2-157">Rows fetched per block</span><span class="sxs-lookup"><span data-stu-id="31ae2-157">Rows fetched per block</span></span> |<span data-ttu-id="31ae2-158">When fetching a large number of records, tuning this parameter may be required to ensure optimal performances.</span><span class="sxs-lookup"><span data-stu-id="31ae2-158">When fetching a large number of records, tuning this parameter may be required to ensure optimal performances.</span></span> |
   |  <span data-ttu-id="31ae2-159">Default string column length, Binary column length, Decimal column scale</span><span class="sxs-lookup"><span data-stu-id="31ae2-159">Default string column length, Binary column length, Decimal column scale</span></span> |<span data-ttu-id="31ae2-160">The data type lengths and precisions may affect how data is returned.</span><span class="sxs-lookup"><span data-stu-id="31ae2-160">The data type lengths and precisions may affect how data is returned.</span></span> <span data-ttu-id="31ae2-161">They cause incorrect information to be returned due to loss of precision and/or truncation.</span><span class="sxs-lookup"><span data-stu-id="31ae2-161">They cause incorrect information to be returned due to loss of precision and/or truncation.</span></span> |

    <span data-ttu-id="31ae2-162">![Advanced options](./media/apache-hadoop-connect-excel-hive-odbc-driver/HDI.HiveOdbc.DataSource.AdvancedOptions1.png "Advanced DSN configuration options")</span><span class="sxs-lookup"><span data-stu-id="31ae2-162">![Advanced options](./media/apache-hadoop-connect-excel-hive-odbc-driver/HDI.HiveOdbc.DataSource.AdvancedOptions1.png "Advanced DSN configuration options")</span></span>

1. <span data-ttu-id="31ae2-163">Click **Test** to test the data source.</span><span class="sxs-lookup"><span data-stu-id="31ae2-163">Click **Test** to test the data source.</span></span> <span data-ttu-id="31ae2-164">When the data source is configured correctly, it shows *TESTS COMPLETED SUCCESSFULLY!*.</span><span class="sxs-lookup"><span data-stu-id="31ae2-164">When the data source is configured correctly, it shows *TESTS COMPLETED SUCCESSFULLY!*.</span></span>
2. <span data-ttu-id="31ae2-165">Click **OK** to close the Test dialog.</span><span class="sxs-lookup"><span data-stu-id="31ae2-165">Click **OK** to close the Test dialog.</span></span> <span data-ttu-id="31ae2-166">The new data source shall be listed on the **ODBC Data Source Administrator**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-166">The new data source shall be listed on the **ODBC Data Source Administrator**.</span></span>
3. <span data-ttu-id="31ae2-167">Click **OK** to exit the wizard.</span><span class="sxs-lookup"><span data-stu-id="31ae2-167">Click **OK** to exit the wizard.</span></span>

## <a name="import-data-into-excel-from-hdinsight"></a><span data-ttu-id="31ae2-168">Import data into Excel from HDInsight</span><span class="sxs-lookup"><span data-stu-id="31ae2-168">Import data into Excel from HDInsight</span></span>
<span data-ttu-id="31ae2-169">The following steps describe the way to import data from a Hive table into an Excel workbook using the ODBC data source that you created in the previous section.</span><span class="sxs-lookup"><span data-stu-id="31ae2-169">The following steps describe the way to import data from a Hive table into an Excel workbook using the ODBC data source that you created in the previous section.</span></span>

1. <span data-ttu-id="31ae2-170">Open a new or existing workbook in Excel.</span><span class="sxs-lookup"><span data-stu-id="31ae2-170">Open a new or existing workbook in Excel.</span></span>
2. <span data-ttu-id="31ae2-171">From the **Data** tab, click **Get Data**, click **From Other Sources**, and then click **From ODBC** to launch the **Data Connection Wizard**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-171">From the **Data** tab, click **Get Data**, click **From Other Sources**, and then click **From ODBC** to launch the **Data Connection Wizard**.</span></span>
   
    <span data-ttu-id="31ae2-172">![Open data connection wizard](./media/apache-hadoop-connect-excel-hive-odbc-driver/HDI.SimbaHiveOdbc.Excel.DataConnection1.png "Open data connection wizard")</span><span class="sxs-lookup"><span data-stu-id="31ae2-172">![Open data connection wizard](./media/apache-hadoop-connect-excel-hive-odbc-driver/HDI.SimbaHiveOdbc.Excel.DataConnection1.png "Open data connection wizard")</span></span>
4. <span data-ttu-id="31ae2-173">Select the data source name that you created in the last section, and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-173">Select the data source name that you created in the last section, and then click **OK**.</span></span>
5. <span data-ttu-id="31ae2-174">Enter Hadoop user name (the default name is admin) and the password, and then click **Connect**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-174">Enter Hadoop user name (the default name is admin) and the password, and then click **Connect**.</span></span>
6. <span data-ttu-id="31ae2-175">On Navigator, expand **HIVE**, expand **default**, click **hivesampletable**, and then click **Load**.</span><span class="sxs-lookup"><span data-stu-id="31ae2-175">On Navigator, expand **HIVE**, expand **default**, click **hivesampletable**, and then click **Load**.</span></span> <span data-ttu-id="31ae2-176">It takes a few seconds before data gets imported to Excel.</span><span class="sxs-lookup"><span data-stu-id="31ae2-176">It takes a few seconds before data gets imported to Excel.</span></span>

    <span data-ttu-id="31ae2-177">![HDInsight Hive ODBC navigator](./media/apache-hadoop-connect-excel-hive-odbc-driver/hdinsight.hive.odbc.navigator.png "Open data connection wizard")</span><span class="sxs-lookup"><span data-stu-id="31ae2-177">![HDInsight Hive ODBC navigator](./media/apache-hadoop-connect-excel-hive-odbc-driver/hdinsight.hive.odbc.navigator.png "Open data connection wizard")</span></span>


## <a name="next-steps"></a><span data-ttu-id="31ae2-178">Next steps</span><span class="sxs-lookup"><span data-stu-id="31ae2-178">Next steps</span></span>
<span data-ttu-id="31ae2-179">In this article, you learned how to use the Microsoft Hive ODBC driver to retrieve data from the HDInsight Service into Excel.</span><span class="sxs-lookup"><span data-stu-id="31ae2-179">In this article, you learned how to use the Microsoft Hive ODBC driver to retrieve data from the HDInsight Service into Excel.</span></span> <span data-ttu-id="31ae2-180">Similarly, you can retrieve data from the HDInsight Service into SQL Database.</span><span class="sxs-lookup"><span data-stu-id="31ae2-180">Similarly, you can retrieve data from the HDInsight Service into SQL Database.</span></span> <span data-ttu-id="31ae2-181">It is also possible to upload data into an HDInsight Service.</span><span class="sxs-lookup"><span data-stu-id="31ae2-181">It is also possible to upload data into an HDInsight Service.</span></span> <span data-ttu-id="31ae2-182">To learn more, see:</span><span class="sxs-lookup"><span data-stu-id="31ae2-182">To learn more, see:</span></span>

* <span data-ttu-id="31ae2-183">[Visualize Hive data with Microsoft Power BI in Azure HDInsight](apache-hadoop-connect-hive-power-bi.md).</span><span class="sxs-lookup"><span data-stu-id="31ae2-183">[Visualize Hive data with Microsoft Power BI in Azure HDInsight](apache-hadoop-connect-hive-power-bi.md).</span></span>
* <span data-ttu-id="31ae2-184">[Visualize Interactive Query Hive data with Power BI in Azure HDInsight](../interactive-query/apache-hadoop-connect-hive-power-bi-directquery.md).</span><span class="sxs-lookup"><span data-stu-id="31ae2-184">[Visualize Interactive Query Hive data with Power BI in Azure HDInsight](../interactive-query/apache-hadoop-connect-hive-power-bi-directquery.md).</span></span>
* <span data-ttu-id="31ae2-185">[Use Zeppelin to run Hive queries in Azure HDInsight ](./../hdinsight-connect-hive-zeppelin.md).</span><span class="sxs-lookup"><span data-stu-id="31ae2-185">[Use Zeppelin to run Hive queries in Azure HDInsight ](./../hdinsight-connect-hive-zeppelin.md).</span></span>
* <span data-ttu-id="31ae2-186">[Connect Excel to Hadoop by using Power Query](apache-hadoop-connect-excel-power-query.md).</span><span class="sxs-lookup"><span data-stu-id="31ae2-186">[Connect Excel to Hadoop by using Power Query](apache-hadoop-connect-excel-power-query.md).</span></span>
* <span data-ttu-id="31ae2-187">[Connect to Azure HDInsight and run Hive queries using Data Lake Tools for Visual Studio](apache-hadoop-visual-studio-tools-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="31ae2-187">[Connect to Azure HDInsight and run Hive queries using Data Lake Tools for Visual Studio](apache-hadoop-visual-studio-tools-get-started.md).</span></span>
* <span data-ttu-id="31ae2-188">[Use Azure HDInsight Tool for Visual Studio Code](../hdinsight-for-vscode.md).</span><span class="sxs-lookup"><span data-stu-id="31ae2-188">[Use Azure HDInsight Tool for Visual Studio Code](../hdinsight-for-vscode.md).</span></span>
* <span data-ttu-id="31ae2-189">[Upload data to HDInsight](./../hdinsight-upload-data.md).</span><span class="sxs-lookup"><span data-stu-id="31ae2-189">[Upload data to HDInsight](./../hdinsight-upload-data.md).</span></span>

[hdinsight-use-sqoop]:hdinsight-use-sqoop.md
[hdinsight-analyze-flight-data]: hdinsight-analyze-flight-delay-data.md
[hdinsight-use-hive]:hdinsight-use-hive.md
[hdinsight-upload-data]: ../hdinsight-upload-data.md
[hdinsight-power-query]: ../hdinsight-connect-excel-power-query.md
[hive-odbc-driver-download]: http://go.microsoft.com/fwlink/?LinkID=286698


