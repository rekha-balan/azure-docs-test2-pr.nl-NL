---
title: Use Log Analytics to monitor Azure HDInsight clusters
description: Learn how to use Azure Log Analytics to monitor jobs running in an HDInsight cluster.
services: hdinsight
author: jasonwhowell
ms.reviewer: jasonh
ms.service: hdinsight
ms.custom: hdinsightactive
ms.topic: conceptual
ms.date: 06/15/2018
ms.author: jasonh
ms.openlocfilehash: 87d1593327ab45f064c6f6b19dfbe3882baaa446
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44870700"
---
# <a name="use-azure-log-analytics-to-monitor-hdinsight-clusters"></a><span data-ttu-id="11ccf-103">Use Azure Log Analytics to monitor HDInsight clusters</span><span class="sxs-lookup"><span data-stu-id="11ccf-103">Use Azure Log Analytics to monitor HDInsight clusters</span></span>

<span data-ttu-id="11ccf-104">Learn how to enable Azure Log Analytics to monitor Hadoop cluster operations in HDInsight, and how to add an HDInisght monitoring solution.</span><span class="sxs-lookup"><span data-stu-id="11ccf-104">Learn how to enable Azure Log Analytics to monitor Hadoop cluster operations in HDInsight, and how to add an HDInisght monitoring solution.</span></span>

<span data-ttu-id="11ccf-105">[Log Analytics](../log-analytics/log-analytics-overview.md) is a service that monitors your cloud and on-premises environments to maintain their availability and performance.</span><span class="sxs-lookup"><span data-stu-id="11ccf-105">[Log Analytics](../log-analytics/log-analytics-overview.md) is a service that monitors your cloud and on-premises environments to maintain their availability and performance.</span></span> <span data-ttu-id="11ccf-106">It collects data generated by resources in your cloud and on-premises environments and from other monitoring tools to provide analysis across multiple sources.</span><span class="sxs-lookup"><span data-stu-id="11ccf-106">It collects data generated by resources in your cloud and on-premises environments and from other monitoring tools to provide analysis across multiple sources.</span></span>

<span data-ttu-id="11ccf-107">If you don't have an Azure subscription, [create a free account](https://azure.microsoft.com/free/) before you begin.</span><span class="sxs-lookup"><span data-stu-id="11ccf-107">If you don't have an Azure subscription, [create a free account](https://azure.microsoft.com/free/) before you begin.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="11ccf-108">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="11ccf-108">Prerequisites</span></span>

* <span data-ttu-id="11ccf-109">**A Log Analytics workspace**.</span><span class="sxs-lookup"><span data-stu-id="11ccf-109">**A Log Analytics workspace**.</span></span> <span data-ttu-id="11ccf-110">You can think of this workspace as a unique Log Analytics environment with its own data repository, data sources, and solutions.</span><span class="sxs-lookup"><span data-stu-id="11ccf-110">You can think of this workspace as a unique Log Analytics environment with its own data repository, data sources, and solutions.</span></span> <span data-ttu-id="11ccf-111">For the instructions, see [Create a Log Analytics workspace](../log-analytics/log-analytics-quick-collect-azurevm.md#create-a-workspace).</span><span class="sxs-lookup"><span data-stu-id="11ccf-111">For the instructions, see [Create a Log Analytics workspace](../log-analytics/log-analytics-quick-collect-azurevm.md#create-a-workspace).</span></span>

* <span data-ttu-id="11ccf-112">**An Azure HDInsight cluster**.</span><span class="sxs-lookup"><span data-stu-id="11ccf-112">**An Azure HDInsight cluster**.</span></span> <span data-ttu-id="11ccf-113">Currently, you can use Log Analytics with the following HDInsight cluster types:</span><span class="sxs-lookup"><span data-stu-id="11ccf-113">Currently, you can use Log Analytics with the following HDInsight cluster types:</span></span>

  * <span data-ttu-id="11ccf-114">Hadoop</span><span class="sxs-lookup"><span data-stu-id="11ccf-114">Hadoop</span></span>
  * <span data-ttu-id="11ccf-115">HBase</span><span class="sxs-lookup"><span data-stu-id="11ccf-115">HBase</span></span>
  * <span data-ttu-id="11ccf-116">Interactive Query</span><span class="sxs-lookup"><span data-stu-id="11ccf-116">Interactive Query</span></span>
  * <span data-ttu-id="11ccf-117">Kafka</span><span class="sxs-lookup"><span data-stu-id="11ccf-117">Kafka</span></span>
  * <span data-ttu-id="11ccf-118">Spark</span><span class="sxs-lookup"><span data-stu-id="11ccf-118">Spark</span></span>
  * <span data-ttu-id="11ccf-119">Storm</span><span class="sxs-lookup"><span data-stu-id="11ccf-119">Storm</span></span>

  <span data-ttu-id="11ccf-120">For the instructions on how to create an HDInsight cluster, see [Get started with Azure HDInsight](hadoop/apache-hadoop-linux-tutorial-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="11ccf-120">For the instructions on how to create an HDInsight cluster, see [Get started with Azure HDInsight](hadoop/apache-hadoop-linux-tutorial-get-started.md).</span></span>

> [!NOTE]
> <span data-ttu-id="11ccf-121">It is recommended to place both the HDInsight cluster and the Log Analytics workspace in the same region for better performance.</span><span class="sxs-lookup"><span data-stu-id="11ccf-121">It is recommended to place both the HDInsight cluster and the Log Analytics workspace in the same region for better performance.</span></span> <span data-ttu-id="11ccf-122">Note Azure Log Analytics is not available in all Azure regions.</span><span class="sxs-lookup"><span data-stu-id="11ccf-122">Note Azure Log Analytics is not available in all Azure regions.</span></span>

## <a name="enable-log-analytics-by-using-the-portal"></a><span data-ttu-id="11ccf-123">Enable Log Analytics by using the portal</span><span class="sxs-lookup"><span data-stu-id="11ccf-123">Enable Log Analytics by using the portal</span></span>

<span data-ttu-id="11ccf-124">In this section, you configure an existing HDInsight Hadoop cluster to use an Azure Log Analytics workspace to monitor jobs, debug logs, etc.</span><span class="sxs-lookup"><span data-stu-id="11ccf-124">In this section, you configure an existing HDInsight Hadoop cluster to use an Azure Log Analytics workspace to monitor jobs, debug logs, etc.</span></span>

1. <span data-ttu-id="11ccf-125">Open an HDInsight cluster in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="11ccf-125">Open an HDInsight cluster in the Azure portal.</span></span>
2. <span data-ttu-id="11ccf-126">In the left pane, select **Monitoring**.</span><span class="sxs-lookup"><span data-stu-id="11ccf-126">In the left pane, select **Monitoring**.</span></span>
3. <span data-ttu-id="11ccf-127">In the right pane, select **Enable**, select an existing Log Analytics workspace, and then select **Save**.</span><span class="sxs-lookup"><span data-stu-id="11ccf-127">In the right pane, select **Enable**, select an existing Log Analytics workspace, and then select **Save**.</span></span>

    <span data-ttu-id="11ccf-128">![Enable monitoring for HDInsight clusters](./media/hdinsight-hadoop-oms-log-analytics-tutorial/hdinsight-enable-monitoring.png "Enable monitoring for HDInsight clusters")</span><span class="sxs-lookup"><span data-stu-id="11ccf-128">![Enable monitoring for HDInsight clusters](./media/hdinsight-hadoop-oms-log-analytics-tutorial/hdinsight-enable-monitoring.png "Enable monitoring for HDInsight clusters")</span></span>

    <span data-ttu-id="11ccf-129">It takes a few moments to save the setting.</span><span class="sxs-lookup"><span data-stu-id="11ccf-129">It takes a few moments to save the setting.</span></span>

## <a name="enable-log-analytics-by-using-azure-powershell"></a><span data-ttu-id="11ccf-130">Enable Log Analytics by using Azure PowerShell</span><span class="sxs-lookup"><span data-stu-id="11ccf-130">Enable Log Analytics by using Azure PowerShell</span></span>

<span data-ttu-id="11ccf-131">You can enable Log Analytics using Azure PowerShell.</span><span class="sxs-lookup"><span data-stu-id="11ccf-131">You can enable Log Analytics using Azure PowerShell.</span></span> <span data-ttu-id="11ccf-132">The cmdlet is:</span><span class="sxs-lookup"><span data-stu-id="11ccf-132">The cmdlet is:</span></span>

```powershell
Enable-AzureRmHDInsightOperationsManagementSuite
      [-Name] <CLUSTER NAME>
      [-WorkspaceId] <LOG ANALYTICS WORKSPACE NAME>
      [-PrimaryKey] <LOG ANALYTICS WORKSPACE PRIMARY KEY>
      [-ResourceGroupName] <RESOURCE GROUIP NAME>
```

<span data-ttu-id="11ccf-133">See [Enable-AzureRmHDInsightOperationsManagementSuite](https://docs.microsoft.com/powershell/module/azurerm.hdinsight/Enable-AzureRmHDInsightOperationsManagementSuite?view=azurermps-5.0.0).</span><span class="sxs-lookup"><span data-stu-id="11ccf-133">See [Enable-AzureRmHDInsightOperationsManagementSuite](https://docs.microsoft.com/powershell/module/azurerm.hdinsight/Enable-AzureRmHDInsightOperationsManagementSuite?view=azurermps-5.0.0).</span></span>

<span data-ttu-id="11ccf-134">To disable, the cmdlet is:</span><span class="sxs-lookup"><span data-stu-id="11ccf-134">To disable, the cmdlet is:</span></span>

```powershell
Disable-AzureRmHDInsightOperationsManagementSuite
       [-Name] <CLUSTER NAME>
       [-ResourceGroupName] <RESOURCE GROUP NAME>
```

<span data-ttu-id="11ccf-135">See [Disable-AzureRmHDInsightOperationsManagementSuite](https://docs.microsoft.com/powershell/module/azurerm.hdinsight/disable-azurermhdinsightoperationsmanagementsuite?view=azurermps-5.0.0).</span><span class="sxs-lookup"><span data-stu-id="11ccf-135">See [Disable-AzureRmHDInsightOperationsManagementSuite](https://docs.microsoft.com/powershell/module/azurerm.hdinsight/disable-azurermhdinsightoperationsmanagementsuite?view=azurermps-5.0.0).</span></span>

## <a name="install-hdinsight-cluster-management-solutions"></a><span data-ttu-id="11ccf-136">Install HDInsight cluster management solutions</span><span class="sxs-lookup"><span data-stu-id="11ccf-136">Install HDInsight cluster management solutions</span></span>

<span data-ttu-id="11ccf-137">HDInsight provides cluster-specific management solutions that you can add for Azure Log Analytics.</span><span class="sxs-lookup"><span data-stu-id="11ccf-137">HDInsight provides cluster-specific management solutions that you can add for Azure Log Analytics.</span></span> <span data-ttu-id="11ccf-138">[Management solutions](../log-analytics/log-analytics-add-solutions.md) add functionality to Log Analytics, providing additional data and analysis tools.</span><span class="sxs-lookup"><span data-stu-id="11ccf-138">[Management solutions](../log-analytics/log-analytics-add-solutions.md) add functionality to Log Analytics, providing additional data and analysis tools.</span></span> <span data-ttu-id="11ccf-139">These solutions collect important performance metrics from your HDInsight clusters and provide the tools to search the metrics.</span><span class="sxs-lookup"><span data-stu-id="11ccf-139">These solutions collect important performance metrics from your HDInsight clusters and provide the tools to search the metrics.</span></span> <span data-ttu-id="11ccf-140">These solutions also provide visualizations and dashboards for most cluster types supported in HDInsight.</span><span class="sxs-lookup"><span data-stu-id="11ccf-140">These solutions also provide visualizations and dashboards for most cluster types supported in HDInsight.</span></span> <span data-ttu-id="11ccf-141">By using the metrics that you collect with the solution, you can create custom monitoring rules and alerts.</span><span class="sxs-lookup"><span data-stu-id="11ccf-141">By using the metrics that you collect with the solution, you can create custom monitoring rules and alerts.</span></span>

<span data-ttu-id="11ccf-142">These are the available HDInsight solutions:</span><span class="sxs-lookup"><span data-stu-id="11ccf-142">These are the available HDInsight solutions:</span></span>

* <span data-ttu-id="11ccf-143">HDInsight Hadoop Monitoring</span><span class="sxs-lookup"><span data-stu-id="11ccf-143">HDInsight Hadoop Monitoring</span></span>
* <span data-ttu-id="11ccf-144">HDInsight HBase Monitoring</span><span class="sxs-lookup"><span data-stu-id="11ccf-144">HDInsight HBase Monitoring</span></span>
* <span data-ttu-id="11ccf-145">HDInsight Interactive Query Monitoring</span><span class="sxs-lookup"><span data-stu-id="11ccf-145">HDInsight Interactive Query Monitoring</span></span>
* <span data-ttu-id="11ccf-146">HDInsight Kafka Monitoring</span><span class="sxs-lookup"><span data-stu-id="11ccf-146">HDInsight Kafka Monitoring</span></span>
* <span data-ttu-id="11ccf-147">HDInsight Spark Monitoring</span><span class="sxs-lookup"><span data-stu-id="11ccf-147">HDInsight Spark Monitoring</span></span>
* <span data-ttu-id="11ccf-148">HDInsight Storm Monitoring</span><span class="sxs-lookup"><span data-stu-id="11ccf-148">HDInsight Storm Monitoring</span></span>

<span data-ttu-id="11ccf-149">For the instructions to install a management solution, see [Management solutions in Azure](../monitoring/monitoring-solutions.md#install-a-management-solution).</span><span class="sxs-lookup"><span data-stu-id="11ccf-149">For the instructions to install a management solution, see [Management solutions in Azure](../monitoring/monitoring-solutions.md#install-a-management-solution).</span></span> <span data-ttu-id="11ccf-150">To experiment, install a HDInsight Hadoop Monotiring solution.</span><span class="sxs-lookup"><span data-stu-id="11ccf-150">To experiment, install a HDInsight Hadoop Monotiring solution.</span></span> <span data-ttu-id="11ccf-151">When it is done, you see an **HDInsightHadoop** tile listed under **Summary**.</span><span class="sxs-lookup"><span data-stu-id="11ccf-151">When it is done, you see an **HDInsightHadoop** tile listed under **Summary**.</span></span> <span data-ttu-id="11ccf-152">Select the **HDInsightHadoop** tile.</span><span class="sxs-lookup"><span data-stu-id="11ccf-152">Select the **HDInsightHadoop** tile.</span></span> <span data-ttu-id="11ccf-153">The HDInsightHadoop solution looks like:</span><span class="sxs-lookup"><span data-stu-id="11ccf-153">The HDInsightHadoop solution looks like:</span></span>

![HDInsight OMS Hadoop monitoring solution view](media/hdinsight-hadoop-oms-log-analytics-tutorial/hdinsight-oms-hdinsight-hadoop-monitoring-solution.png)

<span data-ttu-id="11ccf-155">Because the cluster is a brand new cluster, the report doesn't show any activities.</span><span class="sxs-lookup"><span data-stu-id="11ccf-155">Because the cluster is a brand new cluster, the report doesn't show any activities.</span></span>

## <a name="next-steps"></a><span data-ttu-id="11ccf-156">Next steps</span><span class="sxs-lookup"><span data-stu-id="11ccf-156">Next steps</span></span>

* [<span data-ttu-id="11ccf-157">Query Azure Log Analytics to monitor HDInsight clusters</span><span class="sxs-lookup"><span data-stu-id="11ccf-157">Query Azure Log Analytics to monitor HDInsight clusters</span></span>](hdinsight-hadoop-oms-log-analytics-use-queries.md)
