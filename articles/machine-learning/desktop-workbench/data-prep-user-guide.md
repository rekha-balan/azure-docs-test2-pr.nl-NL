---
title: In-depth guide on how to use Azure Machine Learning Data Preparations | Microsoft Docs
description: This document provides an overview and details about how to solve data problems with Azure Machine Learning Data Preparations
services: machine-learning
author: euangMS
ms.author: euang
manager: lanceo
ms.reviewer: jmartens, jasonwhowell, mldocs
ms.service: machine-learning
ms.component: core
ms.workload: data-services
ms.custom: ''
ms.devlang: ''
ms.topic: article
ms.date: 02/01/2018
ms.openlocfilehash: e4db8d70d2a96fe3ad24797d7a32d75e1a792e32
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44868186"
---
# <a name="data-preparations-user-guide"></a><span data-ttu-id="d8ded-103">Data Preparations user guide</span><span class="sxs-lookup"><span data-stu-id="d8ded-103">Data Preparations user guide</span></span> 
<span data-ttu-id="d8ded-104">The Azure Machine Learning Data Preparations experience provides a lot of rich functionality.</span><span class="sxs-lookup"><span data-stu-id="d8ded-104">The Azure Machine Learning Data Preparations experience provides a lot of rich functionality.</span></span> <span data-ttu-id="d8ded-105">This article documents the deepest parts of the experience.</span><span class="sxs-lookup"><span data-stu-id="d8ded-105">This article documents the deepest parts of the experience.</span></span>

### <a name="step-execution-history-and-caching"></a><span data-ttu-id="d8ded-106">Step execution, history, and caching</span><span class="sxs-lookup"><span data-stu-id="d8ded-106">Step execution, history, and caching</span></span> 
<span data-ttu-id="d8ded-107">Data Preparations step history maintains a series of caches for performance reasons.</span><span class="sxs-lookup"><span data-stu-id="d8ded-107">Data Preparations step history maintains a series of caches for performance reasons.</span></span> <span data-ttu-id="d8ded-108">If you select a step and it hits a cache, it doesn't re-execute.</span><span class="sxs-lookup"><span data-stu-id="d8ded-108">If you select a step and it hits a cache, it doesn't re-execute.</span></span> <span data-ttu-id="d8ded-109">If you have a write block at the end of the step history and you flip back and forth on the steps but make no changes, the write isn't triggered after the first time.</span><span class="sxs-lookup"><span data-stu-id="d8ded-109">If you have a write block at the end of the step history and you flip back and forth on the steps but make no changes, the write isn't triggered after the first time.</span></span> <span data-ttu-id="d8ded-110">A new write occurs and overwrites the previous one, if you:</span><span class="sxs-lookup"><span data-stu-id="d8ded-110">A new write occurs and overwrites the previous one, if you:</span></span>

- <span data-ttu-id="d8ded-111">Make changes to the write block.</span><span class="sxs-lookup"><span data-stu-id="d8ded-111">Make changes to the write block.</span></span>
- <span data-ttu-id="d8ded-112">Add a new transform block and move it above the write block, which generates a cache invalidation.</span><span class="sxs-lookup"><span data-stu-id="d8ded-112">Add a new transform block and move it above the write block, which generates a cache invalidation.</span></span>
- <span data-ttu-id="d8ded-113">Change the properties of a block above the write block, which generates a cache invalidation.</span><span class="sxs-lookup"><span data-stu-id="d8ded-113">Change the properties of a block above the write block, which generates a cache invalidation.</span></span>
- <span data-ttu-id="d8ded-114">Select refresh on a sample (thus invalidating all the caches).</span><span class="sxs-lookup"><span data-stu-id="d8ded-114">Select refresh on a sample (thus invalidating all the caches).</span></span>

### <a name="error-values"></a><span data-ttu-id="d8ded-115">Error values</span><span class="sxs-lookup"><span data-stu-id="d8ded-115">Error values</span></span>

<span data-ttu-id="d8ded-116">Data transformations might fail for an input value because that value can't be handled appropriately.</span><span class="sxs-lookup"><span data-stu-id="d8ded-116">Data transformations might fail for an input value because that value can't be handled appropriately.</span></span> <span data-ttu-id="d8ded-117">For example, in the case of type coercion operations, the coercion fails if the input string value can't be cast to the specified target type.</span><span class="sxs-lookup"><span data-stu-id="d8ded-117">For example, in the case of type coercion operations, the coercion fails if the input string value can't be cast to the specified target type.</span></span> <span data-ttu-id="d8ded-118">A type coercion operation might be converting a column of string type to a numeric or Boolean type or attempting to duplicate a column that doesn't exist.</span><span class="sxs-lookup"><span data-stu-id="d8ded-118">A type coercion operation might be converting a column of string type to a numeric or Boolean type or attempting to duplicate a column that doesn't exist.</span></span> <span data-ttu-id="d8ded-119">(This failure occurs as the result of moving the *delete column X* operation before the *duplicate column X* operation.)</span><span class="sxs-lookup"><span data-stu-id="d8ded-119">(This failure occurs as the result of moving the *delete column X* operation before the *duplicate column X* operation.)</span></span>

<span data-ttu-id="d8ded-120">In these cases, Data Preparations produces an error value as the output.</span><span class="sxs-lookup"><span data-stu-id="d8ded-120">In these cases, Data Preparations produces an error value as the output.</span></span> <span data-ttu-id="d8ded-121">Error values indicate that a previous operation failed for the given value.</span><span class="sxs-lookup"><span data-stu-id="d8ded-121">Error values indicate that a previous operation failed for the given value.</span></span> <span data-ttu-id="d8ded-122">Internally, they're treated as a first-class value type, but their presence doesn't alter the underlying type of a column, even if a column consists entirely of error values.</span><span class="sxs-lookup"><span data-stu-id="d8ded-122">Internally, they're treated as a first-class value type, but their presence doesn't alter the underlying type of a column, even if a column consists entirely of error values.</span></span>

<span data-ttu-id="d8ded-123">Error values are easy to identify.</span><span class="sxs-lookup"><span data-stu-id="d8ded-123">Error values are easy to identify.</span></span> <span data-ttu-id="d8ded-124">They're highlighted in red and read "Error."</span><span class="sxs-lookup"><span data-stu-id="d8ded-124">They're highlighted in red and read "Error."</span></span> <span data-ttu-id="d8ded-125">To determine the reason for the error, hover over an error value to see a text description for the failure.</span><span class="sxs-lookup"><span data-stu-id="d8ded-125">To determine the reason for the error, hover over an error value to see a text description for the failure.</span></span>

<span data-ttu-id="d8ded-126">Error values propagate.</span><span class="sxs-lookup"><span data-stu-id="d8ded-126">Error values propagate.</span></span> <span data-ttu-id="d8ded-127">After an error value occurs, it propagates in most cases as an error through most operations.</span><span class="sxs-lookup"><span data-stu-id="d8ded-127">After an error value occurs, it propagates in most cases as an error through most operations.</span></span> <span data-ttu-id="d8ded-128">There are three ways to replace or remove them:</span><span class="sxs-lookup"><span data-stu-id="d8ded-128">There are three ways to replace or remove them:</span></span>

* <span data-ttu-id="d8ded-129">Replace</span><span class="sxs-lookup"><span data-stu-id="d8ded-129">Replace</span></span>
    -  <span data-ttu-id="d8ded-130">Right-click a column, and select **Replace Error Values**.</span><span class="sxs-lookup"><span data-stu-id="d8ded-130">Right-click a column, and select **Replace Error Values**.</span></span> <span data-ttu-id="d8ded-131">You can then choose a replacement value for each error value found in the column.</span><span class="sxs-lookup"><span data-stu-id="d8ded-131">You can then choose a replacement value for each error value found in the column.</span></span>

* <span data-ttu-id="d8ded-132">Remove</span><span class="sxs-lookup"><span data-stu-id="d8ded-132">Remove</span></span>
    - <span data-ttu-id="d8ded-133">Data Preparations includes interactive filters to preserve or remove error values.</span><span class="sxs-lookup"><span data-stu-id="d8ded-133">Data Preparations includes interactive filters to preserve or remove error values.</span></span>
    - <span data-ttu-id="d8ded-134">Right-click a column, and select **Filter Column**.</span><span class="sxs-lookup"><span data-stu-id="d8ded-134">Right-click a column, and select **Filter Column**.</span></span> <span data-ttu-id="d8ded-135">To preserve or remove error values, create a conditional with the condition *"is error"* or *"is not error."*</span><span class="sxs-lookup"><span data-stu-id="d8ded-135">To preserve or remove error values, create a conditional with the condition *"is error"* or *"is not error."*</span></span>

* <span data-ttu-id="d8ded-136">Use a Python expression to conditionally operate on error values.</span><span class="sxs-lookup"><span data-stu-id="d8ded-136">Use a Python expression to conditionally operate on error values.</span></span> <span data-ttu-id="d8ded-137">For more information, see the [section on Python extensions](data-prep-python-extensibility-overview.md).</span><span class="sxs-lookup"><span data-stu-id="d8ded-137">For more information, see the [section on Python extensions](data-prep-python-extensibility-overview.md).</span></span>

### <a name="sampling"></a><span data-ttu-id="d8ded-138">Sampling</span><span class="sxs-lookup"><span data-stu-id="d8ded-138">Sampling</span></span>
<span data-ttu-id="d8ded-139">A Data Sources file takes in raw data from one or more sources, either from the local file system or a remote location.</span><span class="sxs-lookup"><span data-stu-id="d8ded-139">A Data Sources file takes in raw data from one or more sources, either from the local file system or a remote location.</span></span> <span data-ttu-id="d8ded-140">The Sample block allows you to specify whether to work with a subset of the data by generating samples.</span><span class="sxs-lookup"><span data-stu-id="d8ded-140">The Sample block allows you to specify whether to work with a subset of the data by generating samples.</span></span> <span data-ttu-id="d8ded-141">Operating on a sample of the data rather than a large dataset often leads to better performance when you carry out operations in later steps.</span><span class="sxs-lookup"><span data-stu-id="d8ded-141">Operating on a sample of the data rather than a large dataset often leads to better performance when you carry out operations in later steps.</span></span>

<span data-ttu-id="d8ded-142">For each Data Sources file, multiple samples can be generated and stored.</span><span class="sxs-lookup"><span data-stu-id="d8ded-142">For each Data Sources file, multiple samples can be generated and stored.</span></span> <span data-ttu-id="d8ded-143">However, only one sample can be set as the active sample.</span><span class="sxs-lookup"><span data-stu-id="d8ded-143">However, only one sample can be set as the active sample.</span></span> <span data-ttu-id="d8ded-144">You can create, edit, or delete samples in the Data Source wizard or by editing the Sample block.</span><span class="sxs-lookup"><span data-stu-id="d8ded-144">You can create, edit, or delete samples in the Data Source wizard or by editing the Sample block.</span></span> <span data-ttu-id="d8ded-145">Any Data Preparations files that reference a data source inherently use the sample specified in the Data Sources file.</span><span class="sxs-lookup"><span data-stu-id="d8ded-145">Any Data Preparations files that reference a data source inherently use the sample specified in the Data Sources file.</span></span>

<span data-ttu-id="d8ded-146">There are a number of sampling strategies available, each with different configurable parameters.</span><span class="sxs-lookup"><span data-stu-id="d8ded-146">There are a number of sampling strategies available, each with different configurable parameters.</span></span>

#### <a name="top"></a><span data-ttu-id="d8ded-147">Top</span><span class="sxs-lookup"><span data-stu-id="d8ded-147">Top</span></span>
<span data-ttu-id="d8ded-148">This strategy can be applied to either local or remote files.</span><span class="sxs-lookup"><span data-stu-id="d8ded-148">This strategy can be applied to either local or remote files.</span></span> <span data-ttu-id="d8ded-149">It takes the first N rows (specified by Count) into the data source.</span><span class="sxs-lookup"><span data-stu-id="d8ded-149">It takes the first N rows (specified by Count) into the data source.</span></span>

#### <a name="random-n"></a><span data-ttu-id="d8ded-150">Random N</span><span class="sxs-lookup"><span data-stu-id="d8ded-150">Random N</span></span> 
<span data-ttu-id="d8ded-151">This strategy can be applied only to local files.</span><span class="sxs-lookup"><span data-stu-id="d8ded-151">This strategy can be applied only to local files.</span></span> <span data-ttu-id="d8ded-152">It takes random N rows (specified by Count) into the data source.</span><span class="sxs-lookup"><span data-stu-id="d8ded-152">It takes random N rows (specified by Count) into the data source.</span></span> <span data-ttu-id="d8ded-153">You can provide a specific seed to ensure that the same sample is generated, provided that Count is also the same.</span><span class="sxs-lookup"><span data-stu-id="d8ded-153">You can provide a specific seed to ensure that the same sample is generated, provided that Count is also the same.</span></span>

#### <a name="random-"></a><span data-ttu-id="d8ded-154">Random %</span><span class="sxs-lookup"><span data-stu-id="d8ded-154">Random %</span></span> 
<span data-ttu-id="d8ded-155">This strategy can be applied to either local or remote files.</span><span class="sxs-lookup"><span data-stu-id="d8ded-155">This strategy can be applied to either local or remote files.</span></span> <span data-ttu-id="d8ded-156">In both cases, a probability and a seed must be provided, similar to the Random N strategy.</span><span class="sxs-lookup"><span data-stu-id="d8ded-156">In both cases, a probability and a seed must be provided, similar to the Random N strategy.</span></span>

<span data-ttu-id="d8ded-157">For samples of remote files, additional parameters need to be provided:</span><span class="sxs-lookup"><span data-stu-id="d8ded-157">For samples of remote files, additional parameters need to be provided:</span></span>

- <span data-ttu-id="d8ded-158">Sample generator</span><span class="sxs-lookup"><span data-stu-id="d8ded-158">Sample generator</span></span> 
  - <span data-ttu-id="d8ded-159">Select a Spark cluster or remote Docker compute target to be used for the sample generation.</span><span class="sxs-lookup"><span data-stu-id="d8ded-159">Select a Spark cluster or remote Docker compute target to be used for the sample generation.</span></span> <span data-ttu-id="d8ded-160">The compute target must be created for the project beforehand for it to appear in this list.</span><span class="sxs-lookup"><span data-stu-id="d8ded-160">The compute target must be created for the project beforehand for it to appear in this list.</span></span> <span data-ttu-id="d8ded-161">Follow the steps in the section "Create a new compute target" in [How to use GPU in Azure Machine Learning](how-to-use-gpu.md) to create compute targets.</span><span class="sxs-lookup"><span data-stu-id="d8ded-161">Follow the steps in the section "Create a new compute target" in [How to use GPU in Azure Machine Learning](how-to-use-gpu.md) to create compute targets.</span></span>
- <span data-ttu-id="d8ded-162">Sample storage</span><span class="sxs-lookup"><span data-stu-id="d8ded-162">Sample storage</span></span> 
  - <span data-ttu-id="d8ded-163">Provide an intermediate storage location to store the remote sample.</span><span class="sxs-lookup"><span data-stu-id="d8ded-163">Provide an intermediate storage location to store the remote sample.</span></span> <span data-ttu-id="d8ded-164">This path must be a different directory from the input file location.</span><span class="sxs-lookup"><span data-stu-id="d8ded-164">This path must be a different directory from the input file location.</span></span>

#### <a name="full-file"></a><span data-ttu-id="d8ded-165">Full file</span><span class="sxs-lookup"><span data-stu-id="d8ded-165">Full file</span></span> 
<span data-ttu-id="d8ded-166">This strategy can be applied only to local files, taking the full file into the data source.</span><span class="sxs-lookup"><span data-stu-id="d8ded-166">This strategy can be applied only to local files, taking the full file into the data source.</span></span> <span data-ttu-id="d8ded-167">If the file is too large, this option might slow down future operations in the app.</span><span class="sxs-lookup"><span data-stu-id="d8ded-167">If the file is too large, this option might slow down future operations in the app.</span></span> <span data-ttu-id="d8ded-168">You might find it more appropriate to use a different sampling strategy.</span><span class="sxs-lookup"><span data-stu-id="d8ded-168">You might find it more appropriate to use a different sampling strategy.</span></span>


### <a name="fork-merge-and-append"></a><span data-ttu-id="d8ded-169">Fork, merge, and append</span><span class="sxs-lookup"><span data-stu-id="d8ded-169">Fork, merge, and append</span></span>

<span data-ttu-id="d8ded-170">When you apply a filter over a dataset, the operation splits the data into two result sets: one set represents records that succeed in the filter, and another set is for the records that fail.</span><span class="sxs-lookup"><span data-stu-id="d8ded-170">When you apply a filter over a dataset, the operation splits the data into two result sets: one set represents records that succeed in the filter, and another set is for the records that fail.</span></span> <span data-ttu-id="d8ded-171">In either case, the user can choose which result set to display.</span><span class="sxs-lookup"><span data-stu-id="d8ded-171">In either case, the user can choose which result set to display.</span></span> <span data-ttu-id="d8ded-172">The user can discard the other dataset or place it in a new data flow.</span><span class="sxs-lookup"><span data-stu-id="d8ded-172">The user can discard the other dataset or place it in a new data flow.</span></span> <span data-ttu-id="d8ded-173">The latter option is referred to as forking.</span><span class="sxs-lookup"><span data-stu-id="d8ded-173">The latter option is referred to as forking.</span></span>

<span data-ttu-id="d8ded-174">To fork:</span><span class="sxs-lookup"><span data-stu-id="d8ded-174">To fork:</span></span> 
1. <span data-ttu-id="d8ded-175">Select a column, right-click, and select the **Filter** column.</span><span class="sxs-lookup"><span data-stu-id="d8ded-175">Select a column, right-click, and select the **Filter** column.</span></span>

2. <span data-ttu-id="d8ded-176">Under **I Want To**, select **Keep Rows** to display the result set that passes the filter.</span><span class="sxs-lookup"><span data-stu-id="d8ded-176">Under **I Want To**, select **Keep Rows** to display the result set that passes the filter.</span></span>

3. <span data-ttu-id="d8ded-177">Select **Remove Rows** to display the failed set.</span><span class="sxs-lookup"><span data-stu-id="d8ded-177">Select **Remove Rows** to display the failed set.</span></span>

4. <span data-ttu-id="d8ded-178">After **Conditions**, select **Create Dataflow Containing the Filtered Out Rows** to fork the non-display result set into a new data flow.</span><span class="sxs-lookup"><span data-stu-id="d8ded-178">After **Conditions**, select **Create Dataflow Containing the Filtered Out Rows** to fork the non-display result set into a new data flow.</span></span>


<span data-ttu-id="d8ded-179">This practice is often used to separate out a set of data that requires additional preparation.</span><span class="sxs-lookup"><span data-stu-id="d8ded-179">This practice is often used to separate out a set of data that requires additional preparation.</span></span> <span data-ttu-id="d8ded-180">After you prepared the forked dataset, it's common to merge the data with the result set in the original data flow.</span><span class="sxs-lookup"><span data-stu-id="d8ded-180">After you prepared the forked dataset, it's common to merge the data with the result set in the original data flow.</span></span> <span data-ttu-id="d8ded-181">To perform a merge (the reverse of a fork operation), use one of the following actions:</span><span class="sxs-lookup"><span data-stu-id="d8ded-181">To perform a merge (the reverse of a fork operation), use one of the following actions:</span></span>

- <span data-ttu-id="d8ded-182">**Append Rows**.</span><span class="sxs-lookup"><span data-stu-id="d8ded-182">**Append Rows**.</span></span> <span data-ttu-id="d8ded-183">Merge two or more data flows vertically (row-wise).</span><span class="sxs-lookup"><span data-stu-id="d8ded-183">Merge two or more data flows vertically (row-wise).</span></span> 
- <span data-ttu-id="d8ded-184">**Append Columns**.</span><span class="sxs-lookup"><span data-stu-id="d8ded-184">**Append Columns**.</span></span> <span data-ttu-id="d8ded-185">Merge two or more data flows horizontally (column-wise).</span><span class="sxs-lookup"><span data-stu-id="d8ded-185">Merge two or more data flows horizontally (column-wise).</span></span>


>[!NOTE]
><span data-ttu-id="d8ded-186">Append Columns fails if a column collision occurs.</span><span class="sxs-lookup"><span data-stu-id="d8ded-186">Append Columns fails if a column collision occurs.</span></span>


<span data-ttu-id="d8ded-187">After a merge operation, one or more data flows are referenced by a source data flow.</span><span class="sxs-lookup"><span data-stu-id="d8ded-187">After a merge operation, one or more data flows are referenced by a source data flow.</span></span> <span data-ttu-id="d8ded-188">Data Preparations notifies you with a notification in the lower-right corner of the app, beneath the list of steps.</span><span class="sxs-lookup"><span data-stu-id="d8ded-188">Data Preparations notifies you with a notification in the lower-right corner of the app, beneath the list of steps.</span></span>


<span data-ttu-id="d8ded-189">Any operation on the referenced data flow requires the parent data flow to refresh the sample used from the referenced data flow.</span><span class="sxs-lookup"><span data-stu-id="d8ded-189">Any operation on the referenced data flow requires the parent data flow to refresh the sample used from the referenced data flow.</span></span> <span data-ttu-id="d8ded-190">In that event, a confirmation dialog box replaces the data flow reference notification in the lower-right corner.</span><span class="sxs-lookup"><span data-stu-id="d8ded-190">In that event, a confirmation dialog box replaces the data flow reference notification in the lower-right corner.</span></span> <span data-ttu-id="d8ded-191">That dialog box confirms that you need to refresh the data flow to synchronize with changes to any dependency data flows.</span><span class="sxs-lookup"><span data-stu-id="d8ded-191">That dialog box confirms that you need to refresh the data flow to synchronize with changes to any dependency data flows.</span></span>

### <a name="list-of-appendices"></a><span data-ttu-id="d8ded-192">List of appendices</span><span class="sxs-lookup"><span data-stu-id="d8ded-192">List of appendices</span></span> 
* [<span data-ttu-id="d8ded-193">Supported data sources</span><span class="sxs-lookup"><span data-stu-id="d8ded-193">Supported data sources</span></span>](data-prep-appendix2-supported-data-sources.md)  
* [<span data-ttu-id="d8ded-194">Supported transforms</span><span class="sxs-lookup"><span data-stu-id="d8ded-194">Supported transforms</span></span>](data-prep-appendix3-supported-transforms.md)  
* [<span data-ttu-id="d8ded-195">Supported inspectors</span><span class="sxs-lookup"><span data-stu-id="d8ded-195">Supported inspectors</span></span>](data-prep-appendix4-supported-inspectors.md)  
* [<span data-ttu-id="d8ded-196">Supported destinations</span><span class="sxs-lookup"><span data-stu-id="d8ded-196">Supported destinations</span></span>](data-prep-appendix5-supported-destinations.md)  
* [<span data-ttu-id="d8ded-197">Sample filter expressions in Python</span><span class="sxs-lookup"><span data-stu-id="d8ded-197">Sample filter expressions in Python</span></span>](data-prep-appendix6-sample-filter-expressions-python.md)  
* [<span data-ttu-id="d8ded-198">Sample transform data flow expressions in Python</span><span class="sxs-lookup"><span data-stu-id="d8ded-198">Sample transform data flow expressions in Python</span></span>](data-prep-appendix7-sample-transform-data-flow-python.md)  
* [<span data-ttu-id="d8ded-199">Sample data sources in Python</span><span class="sxs-lookup"><span data-stu-id="d8ded-199">Sample data sources in Python</span></span>](data-prep-appendix8-sample-source-connections-python.md)  
* [<span data-ttu-id="d8ded-200">Sample destination connections in Python</span><span class="sxs-lookup"><span data-stu-id="d8ded-200">Sample destination connections in Python</span></span>](data-prep-appendix9-sample-destination-connections-python.md)  
* [<span data-ttu-id="d8ded-201">Sample column transforms in Python</span><span class="sxs-lookup"><span data-stu-id="d8ded-201">Sample column transforms in Python</span></span>](data-prep-appendix10-sample-custom-column-transforms-python.md)  
