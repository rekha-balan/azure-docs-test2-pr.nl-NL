---
title: How to create a custom template image for Azure RemoteApp | Microsoft Docs
description: Learn how to create a custom template image for Azure RemoteApp. You can use this template with either a hybrid or cloud collection.
services: remoteapp
documentationcenter: ''
author: msmbaldwin
manager: mbaldwin
editor: ''
ms.assetid: b9ec5b51-f7cd-470b-8545-d0fd714c5982
ms.service: remoteapp
ms.workload: compute
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 11/23/2016
ms.author: mbaldwin
ms.openlocfilehash: c5b87c3a814b816e8bdc28d3e22b64c2197579af
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44552668"
---
# <a name="how-to-create-a-custom-template-image-for-azure-remoteapp"></a><span data-ttu-id="2cb86-104">How to create a custom template image for Azure RemoteApp</span><span class="sxs-lookup"><span data-stu-id="2cb86-104">How to create a custom template image for Azure RemoteApp</span></span>
> [!IMPORTANT]
> <span data-ttu-id="2cb86-105">Azure RemoteApp is being discontinued on August 31, 2017.</span><span class="sxs-lookup"><span data-stu-id="2cb86-105">Azure RemoteApp is being discontinued on August 31, 2017.</span></span> <span data-ttu-id="2cb86-106">Read the [announcement](https://go.microsoft.com/fwlink/?linkid=821148) for details.</span><span class="sxs-lookup"><span data-stu-id="2cb86-106">Read the [announcement](https://go.microsoft.com/fwlink/?linkid=821148) for details.</span></span>
> 
> 

<span data-ttu-id="2cb86-107">Azure RemoteApp uses a Windows Server 2012 R2 template image to host all the programs that you want to share with your users.</span><span class="sxs-lookup"><span data-stu-id="2cb86-107">Azure RemoteApp uses a Windows Server 2012 R2 template image to host all the programs that you want to share with your users.</span></span> <span data-ttu-id="2cb86-108">To create a custom RemoteApp template image, you can start with an existing image or create a new one.</span><span class="sxs-lookup"><span data-stu-id="2cb86-108">To create a custom RemoteApp template image, you can start with an existing image or create a new one.</span></span> 

> [!TIP]
> <span data-ttu-id="2cb86-109">Did you know you can create an image from an Azure VM?</span><span class="sxs-lookup"><span data-stu-id="2cb86-109">Did you know you can create an image from an Azure VM?</span></span> <span data-ttu-id="2cb86-110">True story, and it cuts down on the amount of time it takes to import the image.</span><span class="sxs-lookup"><span data-stu-id="2cb86-110">True story, and it cuts down on the amount of time it takes to import the image.</span></span> <span data-ttu-id="2cb86-111">Check out the steps [here](remoteapp-image-on-azurevm.md).</span><span class="sxs-lookup"><span data-stu-id="2cb86-111">Check out the steps [here](remoteapp-image-on-azurevm.md).</span></span>
> 
> 

<span data-ttu-id="2cb86-112">The requirements for the image that can be uploaded for use with Azure RemoteApp are:</span><span class="sxs-lookup"><span data-stu-id="2cb86-112">The requirements for the image that can be uploaded for use with Azure RemoteApp are:</span></span>

* <span data-ttu-id="2cb86-113">The image size should be a multiple of MBs.</span><span class="sxs-lookup"><span data-stu-id="2cb86-113">The image size should be a multiple of MBs.</span></span> <span data-ttu-id="2cb86-114">If you try to upload an image that is not an exact multiple, the upload will fail.</span><span class="sxs-lookup"><span data-stu-id="2cb86-114">If you try to upload an image that is not an exact multiple, the upload will fail.</span></span>
* <span data-ttu-id="2cb86-115">The image size must be 127 GB or smaller.</span><span class="sxs-lookup"><span data-stu-id="2cb86-115">The image size must be 127 GB or smaller.</span></span>
* <span data-ttu-id="2cb86-116">It must be on a VHD file (VHDX files [Hyper-V virtual hard drives] are not currently supported).</span><span class="sxs-lookup"><span data-stu-id="2cb86-116">It must be on a VHD file (VHDX files [Hyper-V virtual hard drives] are not currently supported).</span></span>
* <span data-ttu-id="2cb86-117">The VHD must not be a generation 2 virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2cb86-117">The VHD must not be a generation 2 virtual machine.</span></span>
* <span data-ttu-id="2cb86-118">The VHD can be either fixed-size or dynamically expanding.</span><span class="sxs-lookup"><span data-stu-id="2cb86-118">The VHD can be either fixed-size or dynamically expanding.</span></span> <span data-ttu-id="2cb86-119">A dynamically expanding VHD is recommended because it takes less time to upload to Azure than a fixed-size VHD file.</span><span class="sxs-lookup"><span data-stu-id="2cb86-119">A dynamically expanding VHD is recommended because it takes less time to upload to Azure than a fixed-size VHD file.</span></span>
* <span data-ttu-id="2cb86-120">The disk must be initialized using the Master Boot Record (MBR) partitioning style.</span><span class="sxs-lookup"><span data-stu-id="2cb86-120">The disk must be initialized using the Master Boot Record (MBR) partitioning style.</span></span> <span data-ttu-id="2cb86-121">The GUID partition table (GPT) partition style is not supported.</span><span class="sxs-lookup"><span data-stu-id="2cb86-121">The GUID partition table (GPT) partition style is not supported.</span></span>
* <span data-ttu-id="2cb86-122">The VHD must contain a single installation of Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="2cb86-122">The VHD must contain a single installation of Windows Server 2012 R2.</span></span> <span data-ttu-id="2cb86-123">It can contain multiple volumes, but only one that contains an installation of Windows.</span><span class="sxs-lookup"><span data-stu-id="2cb86-123">It can contain multiple volumes, but only one that contains an installation of Windows.</span></span>
* <span data-ttu-id="2cb86-124">The Remote Desktop Session Host (RDSH) role and the Desktop Experience feature must be installed.</span><span class="sxs-lookup"><span data-stu-id="2cb86-124">The Remote Desktop Session Host (RDSH) role and the Desktop Experience feature must be installed.</span></span>
* <span data-ttu-id="2cb86-125">The Remote Desktop Connection Broker role must *not* be installed.</span><span class="sxs-lookup"><span data-stu-id="2cb86-125">The Remote Desktop Connection Broker role must *not* be installed.</span></span>
* <span data-ttu-id="2cb86-126">The Encrypting File System (EFS) must be disabled.</span><span class="sxs-lookup"><span data-stu-id="2cb86-126">The Encrypting File System (EFS) must be disabled.</span></span>
* <span data-ttu-id="2cb86-127">The image must be SYSPREPed using the parameters **/oobe /generalize /shutdown** (DO NOT use the **/mode:vm** parameter).</span><span class="sxs-lookup"><span data-stu-id="2cb86-127">The image must be SYSPREPed using the parameters **/oobe /generalize /shutdown** (DO NOT use the **/mode:vm** parameter).</span></span>
* <span data-ttu-id="2cb86-128">Uploading your VHD from a snapshot chain is not supported.</span><span class="sxs-lookup"><span data-stu-id="2cb86-128">Uploading your VHD from a snapshot chain is not supported.</span></span>

<span data-ttu-id="2cb86-129">**Before you begin**</span><span class="sxs-lookup"><span data-stu-id="2cb86-129">**Before you begin**</span></span>

<span data-ttu-id="2cb86-130">You need to do the following before creating the service:</span><span class="sxs-lookup"><span data-stu-id="2cb86-130">You need to do the following before creating the service:</span></span>

* <span data-ttu-id="2cb86-131">[Sign up](https://azure.microsoft.com/services/remoteapp/) for RemoteApp.</span><span class="sxs-lookup"><span data-stu-id="2cb86-131">[Sign up](https://azure.microsoft.com/services/remoteapp/) for RemoteApp.</span></span>
* <span data-ttu-id="2cb86-132">Create a user account in Active Directory to use as the RemoteApp service account.</span><span class="sxs-lookup"><span data-stu-id="2cb86-132">Create a user account in Active Directory to use as the RemoteApp service account.</span></span> <span data-ttu-id="2cb86-133">Restrict the permissions for this account so that it can only join machines to the domain.</span><span class="sxs-lookup"><span data-stu-id="2cb86-133">Restrict the permissions for this account so that it can only join machines to the domain.</span></span> <span data-ttu-id="2cb86-134">See [Configure Azure Active Directory for RemoteApp](remoteapp-ad.md) for more information.</span><span class="sxs-lookup"><span data-stu-id="2cb86-134">See [Configure Azure Active Directory for RemoteApp](remoteapp-ad.md) for more information.</span></span>
* <span data-ttu-id="2cb86-135">Gather information about your on-premises network: IP address information and VPN device details.</span><span class="sxs-lookup"><span data-stu-id="2cb86-135">Gather information about your on-premises network: IP address information and VPN device details.</span></span>
* <span data-ttu-id="2cb86-136">Install the [Azure PowerShell](/powershell/azureps-cmdlets-docs) module.</span><span class="sxs-lookup"><span data-stu-id="2cb86-136">Install the [Azure PowerShell](/powershell/azureps-cmdlets-docs) module.</span></span>
* <span data-ttu-id="2cb86-137">Gather information about the users that you want to grant access to.</span><span class="sxs-lookup"><span data-stu-id="2cb86-137">Gather information about the users that you want to grant access to.</span></span> <span data-ttu-id="2cb86-138">This can be either Microsoft account information or Active Directory work account information for users.</span><span class="sxs-lookup"><span data-stu-id="2cb86-138">This can be either Microsoft account information or Active Directory work account information for users.</span></span>

## <a name="create-a-template-image"></a><span data-ttu-id="2cb86-139">Create a template image</span><span class="sxs-lookup"><span data-stu-id="2cb86-139">Create a template image</span></span>
<span data-ttu-id="2cb86-140">These are the high level steps to create a new template image from scratch:</span><span class="sxs-lookup"><span data-stu-id="2cb86-140">These are the high level steps to create a new template image from scratch:</span></span>

1. <span data-ttu-id="2cb86-141">Locate a Windows Server 2012 R2 Update DVD or ISO image.</span><span class="sxs-lookup"><span data-stu-id="2cb86-141">Locate a Windows Server 2012 R2 Update DVD or ISO image.</span></span>
2. <span data-ttu-id="2cb86-142">Create a VHD file.</span><span class="sxs-lookup"><span data-stu-id="2cb86-142">Create a VHD file.</span></span>
3. <span data-ttu-id="2cb86-143">Install Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="2cb86-143">Install Windows Server 2012 R2.</span></span>
4. <span data-ttu-id="2cb86-144">Install the Remote Desktop Session Host (RDSH) role and the Desktop Experience feature.</span><span class="sxs-lookup"><span data-stu-id="2cb86-144">Install the Remote Desktop Session Host (RDSH) role and the Desktop Experience feature.</span></span>
5. <span data-ttu-id="2cb86-145">Install additional features required by your applications.</span><span class="sxs-lookup"><span data-stu-id="2cb86-145">Install additional features required by your applications.</span></span>
6. <span data-ttu-id="2cb86-146">Install and configure your applications.</span><span class="sxs-lookup"><span data-stu-id="2cb86-146">Install and configure your applications.</span></span> <span data-ttu-id="2cb86-147">To make sharing apps easier, add any apps or programs that you want to share to the **Start** menu of the image, specifically in \*\*%systemdrive%\ProgramData\Microsoft\Windows\Start Menu\Programs.</span><span class="sxs-lookup"><span data-stu-id="2cb86-147">To make sharing apps easier, add any apps or programs that you want to share to the **Start** menu of the image, specifically in \*\*%systemdrive%\ProgramData\Microsoft\Windows\Start Menu\Programs.</span></span>
7. <span data-ttu-id="2cb86-148">Perform any additional Windows configurations required by your applications.</span><span class="sxs-lookup"><span data-stu-id="2cb86-148">Perform any additional Windows configurations required by your applications.</span></span>
8. <span data-ttu-id="2cb86-149">Disable the Encrypting File System (EFS).</span><span class="sxs-lookup"><span data-stu-id="2cb86-149">Disable the Encrypting File System (EFS).</span></span>
9. <span data-ttu-id="2cb86-150">**REQUIRED:** Go to Windows Update and install all important updates.</span><span class="sxs-lookup"><span data-stu-id="2cb86-150">**REQUIRED:** Go to Windows Update and install all important updates.</span></span>
10. <span data-ttu-id="2cb86-151">SYSPREP the image.</span><span class="sxs-lookup"><span data-stu-id="2cb86-151">SYSPREP the image.</span></span>

<span data-ttu-id="2cb86-152">The detailed steps for creating a new image are:</span><span class="sxs-lookup"><span data-stu-id="2cb86-152">The detailed steps for creating a new image are:</span></span>

1. <span data-ttu-id="2cb86-153">Locate a Windows Server 2012 R2 Update DVD or ISO image.</span><span class="sxs-lookup"><span data-stu-id="2cb86-153">Locate a Windows Server 2012 R2 Update DVD or ISO image.</span></span>
2. <span data-ttu-id="2cb86-154">Create a VHD file by using Disk Management.</span><span class="sxs-lookup"><span data-stu-id="2cb86-154">Create a VHD file by using Disk Management.</span></span>
   
   1. <span data-ttu-id="2cb86-155">Launch Disk Management (diskmgmt.msc).</span><span class="sxs-lookup"><span data-stu-id="2cb86-155">Launch Disk Management (diskmgmt.msc).</span></span>
   2. <span data-ttu-id="2cb86-156">Create a dynamically expanding VHD of 40 GB or more in size.</span><span class="sxs-lookup"><span data-stu-id="2cb86-156">Create a dynamically expanding VHD of 40 GB or more in size.</span></span> <span data-ttu-id="2cb86-157">(Estimate the amount of space needed for Windows, your applications, and customizations.</span><span class="sxs-lookup"><span data-stu-id="2cb86-157">(Estimate the amount of space needed for Windows, your applications, and customizations.</span></span> <span data-ttu-id="2cb86-158">Windows Server with the RDSH role and Desktop Experience feature installed will require about 10 GB of space).</span><span class="sxs-lookup"><span data-stu-id="2cb86-158">Windows Server with the RDSH role and Desktop Experience feature installed will require about 10 GB of space).</span></span>
      
      1. <span data-ttu-id="2cb86-159">Click **Action > Create VHD**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-159">Click **Action > Create VHD**.</span></span>
      2. <span data-ttu-id="2cb86-160">Specify the location, size, and VHD format.</span><span class="sxs-lookup"><span data-stu-id="2cb86-160">Specify the location, size, and VHD format.</span></span> <span data-ttu-id="2cb86-161">Select **Dynamically expanding**, and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-161">Select **Dynamically expanding**, and then click **OK**.</span></span>
      
      <span data-ttu-id="2cb86-162">This will run for several seconds.</span><span class="sxs-lookup"><span data-stu-id="2cb86-162">This will run for several seconds.</span></span> <span data-ttu-id="2cb86-163">When the VHD creation is complete, you should see a new disk without any drive letter and in “Not initialized" state in the Disk Management console.</span><span class="sxs-lookup"><span data-stu-id="2cb86-163">When the VHD creation is complete, you should see a new disk without any drive letter and in “Not initialized" state in the Disk Management console.</span></span>
      
      * <span data-ttu-id="2cb86-164">Right-click the disk (not the unallocated space), and then click **Initialize Disk**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-164">Right-click the disk (not the unallocated space), and then click **Initialize Disk**.</span></span> <span data-ttu-id="2cb86-165">Select **MBR** (Master Boot Record) as the partition style, and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-165">Select **MBR** (Master Boot Record) as the partition style, and then click **OK**.</span></span>
      * <span data-ttu-id="2cb86-166">Create a new volume: right-click the unallocated space, and then click **New Simple Volume**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-166">Create a new volume: right-click the unallocated space, and then click **New Simple Volume**.</span></span> <span data-ttu-id="2cb86-167">You can accept the defaults in the wizard, but make sure you assign a drive letter to avoid potential problems when you upload the template image.</span><span class="sxs-lookup"><span data-stu-id="2cb86-167">You can accept the defaults in the wizard, but make sure you assign a drive letter to avoid potential problems when you upload the template image.</span></span>
      * <span data-ttu-id="2cb86-168">Right-click the disk, and then click **Detach VHD**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-168">Right-click the disk, and then click **Detach VHD**.</span></span>
3. <span data-ttu-id="2cb86-169">Install Windows Server 2012 R2:</span><span class="sxs-lookup"><span data-stu-id="2cb86-169">Install Windows Server 2012 R2:</span></span>
   
   1. <span data-ttu-id="2cb86-170">Create a new virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2cb86-170">Create a new virtual machine.</span></span> <span data-ttu-id="2cb86-171">Use the New Virtual Machine Wizard in Hyper-V Manager or Client Hyper-V.</span><span class="sxs-lookup"><span data-stu-id="2cb86-171">Use the New Virtual Machine Wizard in Hyper-V Manager or Client Hyper-V.</span></span>
      1. <span data-ttu-id="2cb86-172">On the Specify Generation page, choose  **Generation 1**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-172">On the Specify Generation page, choose  **Generation 1**.</span></span>
      2. <span data-ttu-id="2cb86-173">On the Connect Virtual Hard Disk page, select **Use an existing virtual hard disk**, and browse to the VHD you created in the previous step.</span><span class="sxs-lookup"><span data-stu-id="2cb86-173">On the Connect Virtual Hard Disk page, select **Use an existing virtual hard disk**, and browse to the VHD you created in the previous step.</span></span>
      3. <span data-ttu-id="2cb86-174">On the Installation Options page, select **Install an operating system from a boot CD/DVD_ROM**, and then select the location of your Windows Server 2012 R2 installation media.</span><span class="sxs-lookup"><span data-stu-id="2cb86-174">On the Installation Options page, select **Install an operating system from a boot CD/DVD_ROM**, and then select the location of your Windows Server 2012 R2 installation media.</span></span>
      4. <span data-ttu-id="2cb86-175">Choose other options in the wizard necessary to install Windows and your applications.</span><span class="sxs-lookup"><span data-stu-id="2cb86-175">Choose other options in the wizard necessary to install Windows and your applications.</span></span> <span data-ttu-id="2cb86-176">Finish the wizard.</span><span class="sxs-lookup"><span data-stu-id="2cb86-176">Finish the wizard.</span></span>
   2. <span data-ttu-id="2cb86-177">After the wizard finishes, edit the settings of the virtual machine and make any other changes necessary to install Windows and your programs, such as the number of virtual processors, and then click **OK**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-177">After the wizard finishes, edit the settings of the virtual machine and make any other changes necessary to install Windows and your programs, such as the number of virtual processors, and then click **OK**.</span></span>
   3. <span data-ttu-id="2cb86-178">Connect to the virtual machine and install Windows Server 2012 R2.</span><span class="sxs-lookup"><span data-stu-id="2cb86-178">Connect to the virtual machine and install Windows Server 2012 R2.</span></span>
4. <span data-ttu-id="2cb86-179">Install the Remote Desktop Session Host (RDSH) role and the Desktop Experience feature:</span><span class="sxs-lookup"><span data-stu-id="2cb86-179">Install the Remote Desktop Session Host (RDSH) role and the Desktop Experience feature:</span></span>
   1. <span data-ttu-id="2cb86-180">Launch Server Manager.</span><span class="sxs-lookup"><span data-stu-id="2cb86-180">Launch Server Manager.</span></span>
   2. <span data-ttu-id="2cb86-181">Click **Add Roles and features** on the Welcome screen or from the **Manage** menu.</span><span class="sxs-lookup"><span data-stu-id="2cb86-181">Click **Add Roles and features** on the Welcome screen or from the **Manage** menu.</span></span>
   3. <span data-ttu-id="2cb86-182">Click **Next** on the Before You Begin page.</span><span class="sxs-lookup"><span data-stu-id="2cb86-182">Click **Next** on the Before You Begin page.</span></span>
   4. <span data-ttu-id="2cb86-183">Select **Role-based or feature-based installation**, and then click **Next**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-183">Select **Role-based or feature-based installation**, and then click **Next**.</span></span>
   5. <span data-ttu-id="2cb86-184">Select the local machine from the list, and then click **Next**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-184">Select the local machine from the list, and then click **Next**.</span></span>
   6. <span data-ttu-id="2cb86-185">Select **Remote Desktop Services**, and then click **Next**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-185">Select **Remote Desktop Services**, and then click **Next**.</span></span>
   7. <span data-ttu-id="2cb86-186">Expand **User Interfaces and Infrastructure** and select **Desktop Experience**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-186">Expand **User Interfaces and Infrastructure** and select **Desktop Experience**.</span></span>
   8. <span data-ttu-id="2cb86-187">Click **Add Features**, and then click **Next**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-187">Click **Add Features**, and then click **Next**.</span></span>
   9. <span data-ttu-id="2cb86-188">On the Remote Desktop Services page, click **Next**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-188">On the Remote Desktop Services page, click **Next**.</span></span>
   10. <span data-ttu-id="2cb86-189">Click **Remote Desktop Session Host**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-189">Click **Remote Desktop Session Host**.</span></span>
   11. <span data-ttu-id="2cb86-190">Click **Add Features**, and then click **Next**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-190">Click **Add Features**, and then click **Next**.</span></span>
   12. <span data-ttu-id="2cb86-191">On the Confirm installation selections page, select **Restart the destination server automatically if required**, and then click **Yes** on the restart warning.</span><span class="sxs-lookup"><span data-stu-id="2cb86-191">On the Confirm installation selections page, select **Restart the destination server automatically if required**, and then click **Yes** on the restart warning.</span></span>
   13. <span data-ttu-id="2cb86-192">Click **Install**.</span><span class="sxs-lookup"><span data-stu-id="2cb86-192">Click **Install**.</span></span> <span data-ttu-id="2cb86-193">The computer will restart.</span><span class="sxs-lookup"><span data-stu-id="2cb86-193">The computer will restart.</span></span>
5. <span data-ttu-id="2cb86-194">Install additional features required by your applications, such as the .NET Framework 3.5.</span><span class="sxs-lookup"><span data-stu-id="2cb86-194">Install additional features required by your applications, such as the .NET Framework 3.5.</span></span> <span data-ttu-id="2cb86-195">To install the features, run the Add Roles and Features Wizard.</span><span class="sxs-lookup"><span data-stu-id="2cb86-195">To install the features, run the Add Roles and Features Wizard.</span></span>
6. <span data-ttu-id="2cb86-196">Install and configure the programs and applications you want to publish through RemoteApp.</span><span class="sxs-lookup"><span data-stu-id="2cb86-196">Install and configure the programs and applications you want to publish through RemoteApp.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="2cb86-197">Install the RDSH role before installing applications to ensure that any issues with application compatibility are discovered before the image is uploaded to RemoteApp.</span><span class="sxs-lookup"><span data-stu-id="2cb86-197">Install the RDSH role before installing applications to ensure that any issues with application compatibility are discovered before the image is uploaded to RemoteApp.</span></span>
> 
> <span data-ttu-id="2cb86-198">Make sure a shortcut to your application (**.lnk** file) appears in the **Start** menu for all users (%systemdrive%\ProgramData\Microsoft\Windows\Start Menu\Programs).</span><span class="sxs-lookup"><span data-stu-id="2cb86-198">Make sure a shortcut to your application (**.lnk** file) appears in the **Start** menu for all users (%systemdrive%\ProgramData\Microsoft\Windows\Start Menu\Programs).</span></span> <span data-ttu-id="2cb86-199">Also ensure that the icon you see in the **Start** menu is what you want users to see.</span><span class="sxs-lookup"><span data-stu-id="2cb86-199">Also ensure that the icon you see in the **Start** menu is what you want users to see.</span></span> <span data-ttu-id="2cb86-200">If not, change it.</span><span class="sxs-lookup"><span data-stu-id="2cb86-200">If not, change it.</span></span> <span data-ttu-id="2cb86-201">(You do not *have* to add the application to the Start menu, but it makes it much easier to publish the application in RemoteApp.</span><span class="sxs-lookup"><span data-stu-id="2cb86-201">(You do not *have* to add the application to the Start menu, but it makes it much easier to publish the application in RemoteApp.</span></span> <span data-ttu-id="2cb86-202">Otherwise, you have to provide the installation path for the application when you publish the app.)</span><span class="sxs-lookup"><span data-stu-id="2cb86-202">Otherwise, you have to provide the installation path for the application when you publish the app.)</span></span>
> 
> 

1. <span data-ttu-id="2cb86-203">Perform any additional Windows configurations required by your applications.</span><span class="sxs-lookup"><span data-stu-id="2cb86-203">Perform any additional Windows configurations required by your applications.</span></span>
2. <span data-ttu-id="2cb86-204">Disable the Encrypting File System (EFS).</span><span class="sxs-lookup"><span data-stu-id="2cb86-204">Disable the Encrypting File System (EFS).</span></span> <span data-ttu-id="2cb86-205">Run the following command at an elevated command window:</span><span class="sxs-lookup"><span data-stu-id="2cb86-205">Run the following command at an elevated command window:</span></span>
   
     <span data-ttu-id="2cb86-206">Fsutil behavior set disableencryption 1</span><span class="sxs-lookup"><span data-stu-id="2cb86-206">Fsutil behavior set disableencryption 1</span></span>
   
   <span data-ttu-id="2cb86-207">Alternatively, you can set or add the following DWORD value in the registry:</span><span class="sxs-lookup"><span data-stu-id="2cb86-207">Alternatively, you can set or add the following DWORD value in the registry:</span></span>
   
     <span data-ttu-id="2cb86-208">HKLM\System\CurrentControlSet\Control\FileSystem\NtfsDisableEncryption = 1</span><span class="sxs-lookup"><span data-stu-id="2cb86-208">HKLM\System\CurrentControlSet\Control\FileSystem\NtfsDisableEncryption = 1</span></span>
3. <span data-ttu-id="2cb86-209">If you are building your image inside an Azure virtual machine, rename the **\%windir%\Panther\Unattend.xml** file, as this will block the upload script used later from working.</span><span class="sxs-lookup"><span data-stu-id="2cb86-209">If you are building your image inside an Azure virtual machine, rename the **\%windir%\Panther\Unattend.xml** file, as this will block the upload script used later from working.</span></span> <span data-ttu-id="2cb86-210">Change the name of this file to Unattend.old so that you will still have the file in case you need to revert your deployment.</span><span class="sxs-lookup"><span data-stu-id="2cb86-210">Change the name of this file to Unattend.old so that you will still have the file in case you need to revert your deployment.</span></span>
4. <span data-ttu-id="2cb86-211">Go to Windows Update and install all important updates.</span><span class="sxs-lookup"><span data-stu-id="2cb86-211">Go to Windows Update and install all important updates.</span></span> <span data-ttu-id="2cb86-212">You might need to run Windows Update multiple times to get all updates.</span><span class="sxs-lookup"><span data-stu-id="2cb86-212">You might need to run Windows Update multiple times to get all updates.</span></span> <span data-ttu-id="2cb86-213">(Sometimes you install an update, and that update itself requires an update.)</span><span class="sxs-lookup"><span data-stu-id="2cb86-213">(Sometimes you install an update, and that update itself requires an update.)</span></span>
5. <span data-ttu-id="2cb86-214">SYSPREP the image.</span><span class="sxs-lookup"><span data-stu-id="2cb86-214">SYSPREP the image.</span></span> <span data-ttu-id="2cb86-215">At an elevated command prompt, run the following command:</span><span class="sxs-lookup"><span data-stu-id="2cb86-215">At an elevated command prompt, run the following command:</span></span>
   
   <span data-ttu-id="2cb86-216">**C:\Windows\System32\sysprep\sysprep.exe /generalize /oobe /shutdown**</span><span class="sxs-lookup"><span data-stu-id="2cb86-216">**C:\Windows\System32\sysprep\sysprep.exe /generalize /oobe /shutdown**</span></span>
   
   <span data-ttu-id="2cb86-217">**Note:** Do not use the **/mode:vm** switch of the SYSPREP command even though this is a virtual machine.</span><span class="sxs-lookup"><span data-stu-id="2cb86-217">**Note:** Do not use the **/mode:vm** switch of the SYSPREP command even though this is a virtual machine.</span></span>

## <a name="next-steps"></a><span data-ttu-id="2cb86-218">Next steps</span><span class="sxs-lookup"><span data-stu-id="2cb86-218">Next steps</span></span>
<span data-ttu-id="2cb86-219">Now that you have your custom template image, you need to upload that image to your RemoteApp collection.</span><span class="sxs-lookup"><span data-stu-id="2cb86-219">Now that you have your custom template image, you need to upload that image to your RemoteApp collection.</span></span> <span data-ttu-id="2cb86-220">Use the information in the following articles to create your collection:</span><span class="sxs-lookup"><span data-stu-id="2cb86-220">Use the information in the following articles to create your collection:</span></span>

* [<span data-ttu-id="2cb86-221">How to create a hybrid collection of RemoteApp</span><span class="sxs-lookup"><span data-stu-id="2cb86-221">How to create a hybrid collection of RemoteApp</span></span>](remoteapp-create-hybrid-deployment.md)
* [<span data-ttu-id="2cb86-222">How to create a cloud collection of RemoteApp</span><span class="sxs-lookup"><span data-stu-id="2cb86-222">How to create a cloud collection of RemoteApp</span></span>](remoteapp-create-cloud-deployment.md)

