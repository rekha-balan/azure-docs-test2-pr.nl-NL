---
title: Protect your content with Azure Media Services | Microsoft Docs
description: This articles give an overview of content protection with Media Services.
services: media-services
documentationcenter: ''
author: Juliako
manager: cfowler
editor: ''
ms.service: media-services
ms.workload: media
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 07/30/2018
ms.author: juliako
ms.openlocfilehash: 2a3e94d37a926bd36b780b45eb3d6cb29fb73597
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44967378"
---
# <a name="content-protection-overview"></a><span data-ttu-id="1c2f4-103">Content protection overview</span><span class="sxs-lookup"><span data-stu-id="1c2f4-103">Content protection overview</span></span>

<span data-ttu-id="1c2f4-104">You can use Azure Media Services to secure your media from the time it leaves your computer through storage, processing, and delivery.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-104">You can use Azure Media Services to secure your media from the time it leaves your computer through storage, processing, and delivery.</span></span> <span data-ttu-id="1c2f4-105">With Media Services, you can deliver your live and on-demand content encrypted dynamically with Advanced Encryption Standard (AES-128) or any of the three major digital rights management (DRM) systems: Microsoft PlayReady, Google Widevine, and Apple FairPlay.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-105">With Media Services, you can deliver your live and on-demand content encrypted dynamically with Advanced Encryption Standard (AES-128) or any of the three major digital rights management (DRM) systems: Microsoft PlayReady, Google Widevine, and Apple FairPlay.</span></span> <span data-ttu-id="1c2f4-106">Media Services also provides a service for delivering AES keys and DRM (PlayReady, Widevine, and FairPlay) licenses to authorized clients.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-106">Media Services also provides a service for delivering AES keys and DRM (PlayReady, Widevine, and FairPlay) licenses to authorized clients.</span></span> 

<span data-ttu-id="1c2f4-107">The following image illustrates the Media Services content protection workflow:</span><span class="sxs-lookup"><span data-stu-id="1c2f4-107">The following image illustrates the Media Services content protection workflow:</span></span> 

![Protect content](./media/content-protection/content-protection.png)

<span data-ttu-id="1c2f4-109">&#42; *dynamic encryption supports AES-128 "clear key", CBCS, and CENC. For details see the support matrix [here](#streaming-protocols-and-encryption-types).*</span><span class="sxs-lookup"><span data-stu-id="1c2f4-109">&#42; *dynamic encryption supports AES-128 "clear key", CBCS, and CENC. For details see the support matrix [here](#streaming-protocols-and-encryption-types).*</span></span>

<span data-ttu-id="1c2f4-110">This article explains concepts and terminology relevant to understanding content protection with Media Services.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-110">This article explains concepts and terminology relevant to understanding content protection with Media Services.</span></span> <span data-ttu-id="1c2f4-111">The article also has the [FAQ](#faq) section and provides links to articles that show how to protect content.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-111">The article also has the [FAQ](#faq) section and provides links to articles that show how to protect content.</span></span> 

## <a name="main-components-of-the-content-protection-system"></a><span data-ttu-id="1c2f4-112">Main components of the content protection system</span><span class="sxs-lookup"><span data-stu-id="1c2f4-112">Main components of the content protection system</span></span>

<span data-ttu-id="1c2f4-113">To successfully complete your "content protection" system/application design, you need to fully understanding the scope of the effort.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-113">To successfully complete your "content protection" system/application design, you need to fully understanding the scope of the effort.</span></span> <span data-ttu-id="1c2f4-114">The following list gives an overview of three parts you would need to implement.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-114">The following list gives an overview of three parts you would need to implement.</span></span> 

1. <span data-ttu-id="1c2f4-115">Azure Media Services code</span><span class="sxs-lookup"><span data-stu-id="1c2f4-115">Azure Media Services code</span></span>
  
  * <span data-ttu-id="1c2f4-116">License templates for PlayReady, Widevine and/or FairPlay.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-116">License templates for PlayReady, Widevine and/or FairPlay.</span></span> <span data-ttu-id="1c2f4-117">The templates let you configure rights and permissions for each of the used DRMs</span><span class="sxs-lookup"><span data-stu-id="1c2f4-117">The templates let you configure rights and permissions for each of the used DRMs</span></span>
  * <span data-ttu-id="1c2f4-118">License delivery authorization, specifying the logic of authorization check based on claims in JWT</span><span class="sxs-lookup"><span data-stu-id="1c2f4-118">License delivery authorization, specifying the logic of authorization check based on claims in JWT</span></span>
  * <span data-ttu-id="1c2f4-119">Content keys, streaming protocols and corresponding DRMs applied, defining DRM encryption</span><span class="sxs-lookup"><span data-stu-id="1c2f4-119">Content keys, streaming protocols and corresponding DRMs applied, defining DRM encryption</span></span>

  > [!NOTE]
  > <span data-ttu-id="1c2f4-120">You can encrypt each asset with multiple encryption types (AES-128, PlayReady, Widevine, FairPlay).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-120">You can encrypt each asset with multiple encryption types (AES-128, PlayReady, Widevine, FairPlay).</span></span> <span data-ttu-id="1c2f4-121">See [Streaming protocols and encryption types](#streaming-protocols-and-encryption-types), to see what makes sense to combine.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-121">See [Streaming protocols and encryption types](#streaming-protocols-and-encryption-types), to see what makes sense to combine.</span></span>
  
  <span data-ttu-id="1c2f4-122">The following articles show steps for encrypting content with AES and/or DRM:</span><span class="sxs-lookup"><span data-stu-id="1c2f4-122">The following articles show steps for encrypting content with AES and/or DRM:</span></span> 
  
  * [<span data-ttu-id="1c2f4-123">Protect with AES encryption</span><span class="sxs-lookup"><span data-stu-id="1c2f4-123">Protect with AES encryption</span></span>](protect-with-aes128.md)
  * [<span data-ttu-id="1c2f4-124">Protect with DRM</span><span class="sxs-lookup"><span data-stu-id="1c2f4-124">Protect with DRM</span></span>](protect-with-drm.md)

2. <span data-ttu-id="1c2f4-125">Player with AES or DRM client.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-125">Player with AES or DRM client.</span></span> <span data-ttu-id="1c2f4-126">A video player app based on a player SDK (either native or browser-based) needs to meet the following requirements:</span><span class="sxs-lookup"><span data-stu-id="1c2f4-126">A video player app based on a player SDK (either native or browser-based) needs to meet the following requirements:</span></span>
  * <span data-ttu-id="1c2f4-127">The player SDK supports the needed DRM clients</span><span class="sxs-lookup"><span data-stu-id="1c2f4-127">The player SDK supports the needed DRM clients</span></span>
  * <span data-ttu-id="1c2f4-128">The player SDK supports the required streaming protocols: Smooth, DASH, and/or HLS</span><span class="sxs-lookup"><span data-stu-id="1c2f4-128">The player SDK supports the required streaming protocols: Smooth, DASH, and/or HLS</span></span>
  * <span data-ttu-id="1c2f4-129">The player SDK needs to be able to handle passing a JWT token in license acquisition request</span><span class="sxs-lookup"><span data-stu-id="1c2f4-129">The player SDK needs to be able to handle passing a JWT token in license acquisition request</span></span>
  
    <span data-ttu-id="1c2f4-130">You can create a player by using the [Azure Media Player API](http://amp.azure.net/libs/amp/latest/docs/).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-130">You can create a player by using the [Azure Media Player API](http://amp.azure.net/libs/amp/latest/docs/).</span></span> <span data-ttu-id="1c2f4-131">Use the [Azure Media Player ProtectionInfo API](http://amp.azure.net/libs/amp/latest/docs/) to specify which DRM technology to use on different DRM platforms.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-131">Use the [Azure Media Player ProtectionInfo API](http://amp.azure.net/libs/amp/latest/docs/) to specify which DRM technology to use on different DRM platforms.</span></span>

    <span data-ttu-id="1c2f4-132">For testing AES or CENC (Widevine and/or PlayReady) encrypted content, you can use [Azure Media Player](https://ampdemo.azureedge.net/azuremediaplayer.html).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-132">For testing AES or CENC (Widevine and/or PlayReady) encrypted content, you can use [Azure Media Player](https://ampdemo.azureedge.net/azuremediaplayer.html).</span></span> <span data-ttu-id="1c2f4-133">Make sure you click on "Advanced options" and check your encryption options.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-133">Make sure you click on "Advanced options" and check your encryption options.</span></span>

    <span data-ttu-id="1c2f4-134">If you want to test FairPlay encrypted content, use [this test player](http://aka.ms/amtest).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-134">If you want to test FairPlay encrypted content, use [this test player](http://aka.ms/amtest).</span></span> <span data-ttu-id="1c2f4-135">The player supports Widevine, PlayReady, and FairPlay DRMs as well as AES-128 clear key encryption.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-135">The player supports Widevine, PlayReady, and FairPlay DRMs as well as AES-128 clear key encryption.</span></span> <span data-ttu-id="1c2f4-136">You need to choose the right browser to test different DRMs: Chrome/Opera/Firefox for Widevine, MS Edge/IE11 for PlayReady, Safari on macOS for FairPlay.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-136">You need to choose the right browser to test different DRMs: Chrome/Opera/Firefox for Widevine, MS Edge/IE11 for PlayReady, Safari on macOS for FairPlay.</span></span>

3. <span data-ttu-id="1c2f4-137">Secure Token Service (STS), which issues JSON Web Token (JWT) as access token for backend resource access.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-137">Secure Token Service (STS), which issues JSON Web Token (JWT) as access token for backend resource access.</span></span> <span data-ttu-id="1c2f4-138">You can use the AMS license delivery services as the backend resource.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-138">You can use the AMS license delivery services as the backend resource.</span></span> <span data-ttu-id="1c2f4-139">An STS has to define the following:</span><span class="sxs-lookup"><span data-stu-id="1c2f4-139">An STS has to define the following:</span></span>

  * <span data-ttu-id="1c2f4-140">Issuer and audience (or scope)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-140">Issuer and audience (or scope)</span></span>
  * <span data-ttu-id="1c2f4-141">Claims, which are dependent on business requirements in content protection</span><span class="sxs-lookup"><span data-stu-id="1c2f4-141">Claims, which are dependent on business requirements in content protection</span></span>
  * <span data-ttu-id="1c2f4-142">Symmetric or asymmetric verification for signature verification</span><span class="sxs-lookup"><span data-stu-id="1c2f4-142">Symmetric or asymmetric verification for signature verification</span></span>
  * <span data-ttu-id="1c2f4-143">Key rollover support (if necessary)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-143">Key rollover support (if necessary)</span></span>

    <span data-ttu-id="1c2f4-144">You can use [this STS tool](https://openidconnectweb.azurewebsites.net/DRMTool/Jwt) to test STS, which supports all 3 types of verification key: symmetric, asymmetric, or AAD with key rollover.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-144">You can use [this STS tool](https://openidconnectweb.azurewebsites.net/DRMTool/Jwt) to test STS, which supports all 3 types of verification key: symmetric, asymmetric, or AAD with key rollover.</span></span> 

> [!NOTE]
> <span data-ttu-id="1c2f4-145">It is highly recommended to focus and fully test each part (described above) before moving onto the next part.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-145">It is highly recommended to focus and fully test each part (described above) before moving onto the next part.</span></span> <span data-ttu-id="1c2f4-146">To test your "content protection" system, use the tools specified in the list above.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-146">To test your "content protection" system, use the tools specified in the list above.</span></span>  

## <a name="streaming-protocols-and-encryption-types"></a><span data-ttu-id="1c2f4-147">Streaming protocols and encryption types</span><span class="sxs-lookup"><span data-stu-id="1c2f4-147">Streaming protocols and encryption types</span></span>

<span data-ttu-id="1c2f4-148">You can use Media Services to deliver your content encrypted dynamically with AES clear key or DRM encryption by using PlayReady, Widevine, or FairPlay.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-148">You can use Media Services to deliver your content encrypted dynamically with AES clear key or DRM encryption by using PlayReady, Widevine, or FairPlay.</span></span> <span data-ttu-id="1c2f4-149">Currently, you can encrypt the HTTP Live Streaming (HLS), MPEG DASH, and Smooth Streaming formats.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-149">Currently, you can encrypt the HTTP Live Streaming (HLS), MPEG DASH, and Smooth Streaming formats.</span></span> <span data-ttu-id="1c2f4-150">Each protocol supports the following encryption methods:</span><span class="sxs-lookup"><span data-stu-id="1c2f4-150">Each protocol supports the following encryption methods:</span></span>

|<span data-ttu-id="1c2f4-151">Protocol</span><span class="sxs-lookup"><span data-stu-id="1c2f4-151">Protocol</span></span>|<span data-ttu-id="1c2f4-152">Container format</span><span class="sxs-lookup"><span data-stu-id="1c2f4-152">Container format</span></span>|<span data-ttu-id="1c2f4-153">Encryption scheme</span><span class="sxs-lookup"><span data-stu-id="1c2f4-153">Encryption scheme</span></span>|
|---|---|---|---|
|<span data-ttu-id="1c2f4-154">MPEG-DASH</span><span class="sxs-lookup"><span data-stu-id="1c2f4-154">MPEG-DASH</span></span>|<span data-ttu-id="1c2f4-155">All</span><span class="sxs-lookup"><span data-stu-id="1c2f4-155">All</span></span>|<span data-ttu-id="1c2f4-156">AES</span><span class="sxs-lookup"><span data-stu-id="1c2f4-156">AES</span></span>|
||<span data-ttu-id="1c2f4-157">CSF(fmp4)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-157">CSF(fmp4)</span></span> |<span data-ttu-id="1c2f4-158">CENC (Widevine + PlayReady)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-158">CENC (Widevine + PlayReady)</span></span> |
||<span data-ttu-id="1c2f4-159">CMAF(fmp4)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-159">CMAF(fmp4)</span></span>|<span data-ttu-id="1c2f4-160">CENC (Widevine + PlayReady)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-160">CENC (Widevine + PlayReady)</span></span>|
|<span data-ttu-id="1c2f4-161">HLS</span><span class="sxs-lookup"><span data-stu-id="1c2f4-161">HLS</span></span>|<span data-ttu-id="1c2f4-162">All</span><span class="sxs-lookup"><span data-stu-id="1c2f4-162">All</span></span>|<span data-ttu-id="1c2f4-163">AES</span><span class="sxs-lookup"><span data-stu-id="1c2f4-163">AES</span></span>|
||<span data-ttu-id="1c2f4-164">MPG2-TS</span><span class="sxs-lookup"><span data-stu-id="1c2f4-164">MPG2-TS</span></span> |<span data-ttu-id="1c2f4-165">CBCS (Fairplay)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-165">CBCS (Fairplay)</span></span> |
||<span data-ttu-id="1c2f4-166">MPG2-TS</span><span class="sxs-lookup"><span data-stu-id="1c2f4-166">MPG2-TS</span></span> |<span data-ttu-id="1c2f4-167">CENC (PlayReady)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-167">CENC (PlayReady)</span></span> |
||<span data-ttu-id="1c2f4-168">CMAF(fmp4)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-168">CMAF(fmp4)</span></span> |<span data-ttu-id="1c2f4-169">CENC (PlayReady)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-169">CENC (PlayReady)</span></span> |
|<span data-ttu-id="1c2f4-170">Smooth Streaming</span><span class="sxs-lookup"><span data-stu-id="1c2f4-170">Smooth Streaming</span></span>|<span data-ttu-id="1c2f4-171">fMP4</span><span class="sxs-lookup"><span data-stu-id="1c2f4-171">fMP4</span></span>|<span data-ttu-id="1c2f4-172">AES</span><span class="sxs-lookup"><span data-stu-id="1c2f4-172">AES</span></span>|
||<span data-ttu-id="1c2f4-173">fMP4</span><span class="sxs-lookup"><span data-stu-id="1c2f4-173">fMP4</span></span> | <span data-ttu-id="1c2f4-174">CENC (PlayReady)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-174">CENC (PlayReady)</span></span> |

## <a name="dynamic-encryption"></a><span data-ttu-id="1c2f4-175">Dynamic encryption</span><span class="sxs-lookup"><span data-stu-id="1c2f4-175">Dynamic encryption</span></span>

<span data-ttu-id="1c2f4-176">In Media Services v3, a content key is associated with StreamingLocator (see [this example](protect-with-aes128.md)).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-176">In Media Services v3, a content key is associated with StreamingLocator (see [this example](protect-with-aes128.md)).</span></span> <span data-ttu-id="1c2f4-177">If using the Media Services key delivery service, you should auto generate the content key.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-177">If using the Media Services key delivery service, you should auto generate the content key.</span></span> <span data-ttu-id="1c2f4-178">You should generate the content key yourself if you are using you own key delivery service, or if you need to handle a high availability scenario where you need to have the same content key in two datacenters.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-178">You should generate the content key yourself if you are using you own key delivery service, or if you need to handle a high availability scenario where you need to have the same content key in two datacenters.</span></span>

<span data-ttu-id="1c2f4-179">When a stream is requested by a player, Media Services uses the specified key to dynamically encrypt your content by using AES clear key or DRM encryption.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-179">When a stream is requested by a player, Media Services uses the specified key to dynamically encrypt your content by using AES clear key or DRM encryption.</span></span> <span data-ttu-id="1c2f4-180">To decrypt the stream, the player requests the key from Media Services key delivery service or the key delivery service you specified.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-180">To decrypt the stream, the player requests the key from Media Services key delivery service or the key delivery service you specified.</span></span> <span data-ttu-id="1c2f4-181">To decide whether or not the user is authorized to get the key, the service evaluates the content key policy that you specified for the key.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-181">To decide whether or not the user is authorized to get the key, the service evaluates the content key policy that you specified for the key.</span></span>

## <a name="aes-128-clear-key-vs-drm"></a><span data-ttu-id="1c2f4-182">AES-128 clear key vs. DRM</span><span class="sxs-lookup"><span data-stu-id="1c2f4-182">AES-128 clear key vs. DRM</span></span>

<span data-ttu-id="1c2f4-183">Customers often wonder whether they should use AES encryption or a DRM system.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-183">Customers often wonder whether they should use AES encryption or a DRM system.</span></span> <span data-ttu-id="1c2f4-184">The primary difference between the two systems is that with AES encryption the content key is transmitted to the client in an unencrypted format ("in the clear").</span><span class="sxs-lookup"><span data-stu-id="1c2f4-184">The primary difference between the two systems is that with AES encryption the content key is transmitted to the client in an unencrypted format ("in the clear").</span></span> <span data-ttu-id="1c2f4-185">As a result, the key used to encrypt the content can be viewed in a network trace on the client in plain text.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-185">As a result, the key used to encrypt the content can be viewed in a network trace on the client in plain text.</span></span> <span data-ttu-id="1c2f4-186">AES-128 clear key encryption is suitable for use cases where the viewer is a trusted party (for example, encrypting corporate videos distributed within a company to be viewed by employees).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-186">AES-128 clear key encryption is suitable for use cases where the viewer is a trusted party (for example, encrypting corporate videos distributed within a company to be viewed by employees).</span></span>

<span data-ttu-id="1c2f4-187">PlayReady, Widevine, and FairPlay all provide a higher level of encryption compared to AES-128 clear key encryption.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-187">PlayReady, Widevine, and FairPlay all provide a higher level of encryption compared to AES-128 clear key encryption.</span></span> <span data-ttu-id="1c2f4-188">The content key is transmitted in an encrypted format.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-188">The content key is transmitted in an encrypted format.</span></span> <span data-ttu-id="1c2f4-189">Additionally, decryption is handled in a secure environment at the operating system level, where it's more difficult for a malicious user to attack.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-189">Additionally, decryption is handled in a secure environment at the operating system level, where it's more difficult for a malicious user to attack.</span></span> <span data-ttu-id="1c2f4-190">DRM is recommended for use cases where the viewer might not be a trusted party and you require the highest level of security.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-190">DRM is recommended for use cases where the viewer might not be a trusted party and you require the highest level of security.</span></span>

## <a name="storage-side-encryption"></a><span data-ttu-id="1c2f4-191">Storage side encryption</span><span class="sxs-lookup"><span data-stu-id="1c2f4-191">Storage side encryption</span></span>

<span data-ttu-id="1c2f4-192">To protect your Assets at rest, the assets should be encrypted by the storage side encryption.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-192">To protect your Assets at rest, the assets should be encrypted by the storage side encryption.</span></span> <span data-ttu-id="1c2f4-193">The following table shows how the storage side encryption works in Media Services v3:</span><span class="sxs-lookup"><span data-stu-id="1c2f4-193">The following table shows how the storage side encryption works in Media Services v3:</span></span>

|<span data-ttu-id="1c2f4-194">Encryption option</span><span class="sxs-lookup"><span data-stu-id="1c2f4-194">Encryption option</span></span>|<span data-ttu-id="1c2f4-195">Description</span><span class="sxs-lookup"><span data-stu-id="1c2f4-195">Description</span></span>|<span data-ttu-id="1c2f4-196">Media Services v3</span><span class="sxs-lookup"><span data-stu-id="1c2f4-196">Media Services v3</span></span>|
|---|---|---|---|
|<span data-ttu-id="1c2f4-197">Media Services Storage Encryption</span><span class="sxs-lookup"><span data-stu-id="1c2f4-197">Media Services Storage Encryption</span></span>| <span data-ttu-id="1c2f4-198">AES-256 encryption, key managed by Media Services</span><span class="sxs-lookup"><span data-stu-id="1c2f4-198">AES-256 encryption, key managed by Media Services</span></span>|<span data-ttu-id="1c2f4-199">Not supported<sup>(1)</sup></span><span class="sxs-lookup"><span data-stu-id="1c2f4-199">Not supported<sup>(1)</sup></span></span>|
|[<span data-ttu-id="1c2f4-200">Storage Service Encryption for Data at Rest</span><span class="sxs-lookup"><span data-stu-id="1c2f4-200">Storage Service Encryption for Data at Rest</span></span>](https://docs.microsoft.com/azure/storage/common/storage-service-encryption)|<span data-ttu-id="1c2f4-201">Server-side encryption offered by Azure Storage, key managed by Azure or by customer</span><span class="sxs-lookup"><span data-stu-id="1c2f4-201">Server-side encryption offered by Azure Storage, key managed by Azure or by customer</span></span>|<span data-ttu-id="1c2f4-202">Supported</span><span class="sxs-lookup"><span data-stu-id="1c2f4-202">Supported</span></span>|
|[<span data-ttu-id="1c2f4-203">Storage Client-Side Encryption</span><span class="sxs-lookup"><span data-stu-id="1c2f4-203">Storage Client-Side Encryption</span></span>](https://docs.microsoft.com/azure/storage/common/storage-client-side-encryption)|<span data-ttu-id="1c2f4-204">Client-side encryption offered by Azure storage, key managed by customer in Key Vault</span><span class="sxs-lookup"><span data-stu-id="1c2f4-204">Client-side encryption offered by Azure storage, key managed by customer in Key Vault</span></span>|<span data-ttu-id="1c2f4-205">Not supported</span><span class="sxs-lookup"><span data-stu-id="1c2f4-205">Not supported</span></span>|

<span data-ttu-id="1c2f4-206"><sup>1</sup> In Media Services v3, storage encryption (AES-256 encryption) is only supported for backwards compatibility when your Assets were created with Media Services v2.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-206"><sup>1</sup> In Media Services v3, storage encryption (AES-256 encryption) is only supported for backwards compatibility when your Assets were created with Media Services v2.</span></span> <span data-ttu-id="1c2f4-207">Meaning v3 works with existing storage encrypted assets but will not allow creation of new ones.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-207">Meaning v3 works with existing storage encrypted assets but will not allow creation of new ones.</span></span>

## <a name="licenses-and-keys-delivery-service"></a><span data-ttu-id="1c2f4-208">Licenses and keys delivery service</span><span class="sxs-lookup"><span data-stu-id="1c2f4-208">Licenses and keys delivery service</span></span>

<span data-ttu-id="1c2f4-209">Media Services provides a key delivery service for delivering DRM (PlayReady, Widevine, FairPlay) licenses and AES keys to authorized clients.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-209">Media Services provides a key delivery service for delivering DRM (PlayReady, Widevine, FairPlay) licenses and AES keys to authorized clients.</span></span> <span data-ttu-id="1c2f4-210">You can use the REST API, or a Media Services client library to configure authorization and authentication policies for your licenses and keys.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-210">You can use the REST API, or a Media Services client library to configure authorization and authentication policies for your licenses and keys.</span></span>

## <a name="control-content-access"></a><span data-ttu-id="1c2f4-211">Control content access</span><span class="sxs-lookup"><span data-stu-id="1c2f4-211">Control content access</span></span>

<span data-ttu-id="1c2f4-212">You can control who has access to your content by configuring the content key policy.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-212">You can control who has access to your content by configuring the content key policy.</span></span> <span data-ttu-id="1c2f4-213">Media Services supports multiple ways of authenticating users who make key requests.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-213">Media Services supports multiple ways of authenticating users who make key requests.</span></span> <span data-ttu-id="1c2f4-214">You must configure the content key policy.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-214">You must configure the content key policy.</span></span> <span data-ttu-id="1c2f4-215">The client (player) must meet the policy before the key can be delivered to the client.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-215">The client (player) must meet the policy before the key can be delivered to the client.</span></span> <span data-ttu-id="1c2f4-216">The content key policy can have **open** or **token** restriction.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-216">The content key policy can have **open** or **token** restriction.</span></span> 

<span data-ttu-id="1c2f4-217">With a token-restricted content key policy, the content key is sent only to a client that presents a valid JSON Web Token (JWT) or simple web token (SWT) in the key/license request.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-217">With a token-restricted content key policy, the content key is sent only to a client that presents a valid JSON Web Token (JWT) or simple web token (SWT) in the key/license request.</span></span> <span data-ttu-id="1c2f4-218">This token must be issued by a security token service (STS).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-218">This token must be issued by a security token service (STS).</span></span> <span data-ttu-id="1c2f4-219">You can use Azure Active Directory as an STS or deploy a custom STS.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-219">You can use Azure Active Directory as an STS or deploy a custom STS.</span></span> <span data-ttu-id="1c2f4-220">The STS must be configured to create a token signed with the specified key and issue claims that you specified in the token restriction configuration.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-220">The STS must be configured to create a token signed with the specified key and issue claims that you specified in the token restriction configuration.</span></span> <span data-ttu-id="1c2f4-221">The Media Services key delivery service returns the requested key/license to the client if the token is valid and the claims in the token match those configured for the key/license.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-221">The Media Services key delivery service returns the requested key/license to the client if the token is valid and the claims in the token match those configured for the key/license.</span></span>

<span data-ttu-id="1c2f4-222">When you configure the token restricted policy, you must specify the primary verification key, issuer, and audience parameters.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-222">When you configure the token restricted policy, you must specify the primary verification key, issuer, and audience parameters.</span></span> <span data-ttu-id="1c2f4-223">The primary verification key contains the key that the token was signed with.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-223">The primary verification key contains the key that the token was signed with.</span></span> <span data-ttu-id="1c2f4-224">The issuer is the secure token service that issues the token.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-224">The issuer is the secure token service that issues the token.</span></span> <span data-ttu-id="1c2f4-225">The audience, sometimes called scope, describes the intent of the token or the resource the token authorizes access to.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-225">The audience, sometimes called scope, describes the intent of the token or the resource the token authorizes access to.</span></span> <span data-ttu-id="1c2f4-226">The Media Services key delivery service validates that these values in the token match the values in the template.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-226">The Media Services key delivery service validates that these values in the token match the values in the template.</span></span>

## <a name="a-idfaqfrequently-asked-questions"></a><span data-ttu-id="1c2f4-227"><a id="faq"/>Frequently asked questions</span><span class="sxs-lookup"><span data-stu-id="1c2f4-227"><a id="faq"/>Frequently asked questions</span></span>

### <a name="question"></a><span data-ttu-id="1c2f4-228">Question</span><span class="sxs-lookup"><span data-stu-id="1c2f4-228">Question</span></span>

<span data-ttu-id="1c2f4-229">How to implement multi-DRM (PlayReady, Widevine, and FairPlay) system using Azure Media Services (AMS) v3 and also use AMS license/key delivery service?</span><span class="sxs-lookup"><span data-stu-id="1c2f4-229">How to implement multi-DRM (PlayReady, Widevine, and FairPlay) system using Azure Media Services (AMS) v3 and also use AMS license/key delivery service?</span></span>

### <a name="answer"></a><span data-ttu-id="1c2f4-230">Answer</span><span class="sxs-lookup"><span data-stu-id="1c2f4-230">Answer</span></span>

<span data-ttu-id="1c2f4-231">For end-to-end scenario, see the [following code example](https://github.com/Azure-Samples/media-services-v3-dotnet-tutorials/blob/master/AMSV3Tutorials/EncryptWithDRM/Program.cs).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-231">For end-to-end scenario, see the [following code example](https://github.com/Azure-Samples/media-services-v3-dotnet-tutorials/blob/master/AMSV3Tutorials/EncryptWithDRM/Program.cs).</span></span> 

<span data-ttu-id="1c2f4-232">The example shows how to:</span><span class="sxs-lookup"><span data-stu-id="1c2f4-232">The example shows how to:</span></span>

1. <span data-ttu-id="1c2f4-233">Create and configure ContentKeyPolicies.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-233">Create and configure ContentKeyPolicies.</span></span>

  <span data-ttu-id="1c2f4-234">The sample contains functions that configure [PlayReady](playready-license-template-overview.md), [Widevine](widevine-license-template-overview.md), and [FairPlay](fairplay-license-overview.md) licenses.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-234">The sample contains functions that configure [PlayReady](playready-license-template-overview.md), [Widevine](widevine-license-template-overview.md), and [FairPlay](fairplay-license-overview.md) licenses.</span></span>

    ```
    ContentKeyPolicyPlayReadyConfiguration playReadyConfig = ConfigurePlayReadyLicenseTemplate();
    ContentKeyPolicyWidevineConfiguration widevineConfig = ConfigureWidevineLicenseTempate();
    ContentKeyPolicyFairPlayConfiguration fairPlayConfig = ConfigureFairPlayPolicyOptions();
    ```

2. <span data-ttu-id="1c2f4-235">Create a StreamingLocator that is configured to stream an encrypted asset.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-235">Create a StreamingLocator that is configured to stream an encrypted asset.</span></span> 

  <span data-ttu-id="1c2f4-236">In the case of this example, we set **StreamingPolicyName** to **PredefinedStreamingPolicy.SecureStreaming** which supports envelope and cenc encryption and sets two content keys on the StreamingLocator.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-236">In the case of this example, we set **StreamingPolicyName** to **PredefinedStreamingPolicy.SecureStreaming** which supports envelope and cenc encryption and sets two content keys on the StreamingLocator.</span></span> 

  <span data-ttu-id="1c2f4-237">If you also want to encrypt with FairPlay, set the **StreamingPolicyName** to **PredefinedStreamingPolicy.SecureStreamingWithFairPlay**.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-237">If you also want to encrypt with FairPlay, set the **StreamingPolicyName** to **PredefinedStreamingPolicy.SecureStreamingWithFairPlay**.</span></span>

3. <span data-ttu-id="1c2f4-238">Create a test token.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-238">Create a test token.</span></span>

  <span data-ttu-id="1c2f4-239">The **GetTokenAsync** method shows how to create a test token.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-239">The **GetTokenAsync** method shows how to create a test token.</span></span>
  
4. <span data-ttu-id="1c2f4-240">Build the streaming URL.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-240">Build the streaming URL.</span></span>

  <span data-ttu-id="1c2f4-241">The **GetDASHStreamingUrlAsync** method shows how to build the streaming URL.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-241">The **GetDASHStreamingUrlAsync** method shows how to build the streaming URL.</span></span> <span data-ttu-id="1c2f4-242">In this case, the URL streams the **DASH** content.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-242">In this case, the URL streams the **DASH** content.</span></span>

### <a name="question"></a><span data-ttu-id="1c2f4-243">Question</span><span class="sxs-lookup"><span data-stu-id="1c2f4-243">Question</span></span>

<span data-ttu-id="1c2f4-244">How and where to get JWT token before using it to request license or key?</span><span class="sxs-lookup"><span data-stu-id="1c2f4-244">How and where to get JWT token before using it to request license or key?</span></span>

### <a name="answer"></a><span data-ttu-id="1c2f4-245">Answer</span><span class="sxs-lookup"><span data-stu-id="1c2f4-245">Answer</span></span>

1. <span data-ttu-id="1c2f4-246">For production, you need to have a Secure Token Services (STS) (web service) which issues JWT token upon a HTTPS request.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-246">For production, you need to have a Secure Token Services (STS) (web service) which issues JWT token upon a HTTPS request.</span></span> <span data-ttu-id="1c2f4-247">For test, you could use the code shown in **GetTokenAsync** method defined in [Program.cs](https://github.com/Azure-Samples/media-services-v3-dotnet-tutorials/blob/master/AMSV3Tutorials/EncryptWithDRM/Program.cs).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-247">For test, you could use the code shown in **GetTokenAsync** method defined in [Program.cs](https://github.com/Azure-Samples/media-services-v3-dotnet-tutorials/blob/master/AMSV3Tutorials/EncryptWithDRM/Program.cs).</span></span>
2. <span data-ttu-id="1c2f4-248">Player will need to make a request, after a user is authenticated, to the STS for such a token and assign it as the value of the token.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-248">Player will need to make a request, after a user is authenticated, to the STS for such a token and assign it as the value of the token.</span></span> <span data-ttu-id="1c2f4-249">You can use the [Azure Media Player API](https://amp.azure.net/libs/amp/latest/docs/).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-249">You can use the [Azure Media Player API](https://amp.azure.net/libs/amp/latest/docs/).</span></span>

* <span data-ttu-id="1c2f4-250">For an example of running STS, with either symmetric and asymmetric key, please see [http://aka.ms/jwt](http://aka.ms/jwt).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-250">For an example of running STS, with either symmetric and asymmetric key, please see [http://aka.ms/jwt](http://aka.ms/jwt).</span></span> 
* <span data-ttu-id="1c2f4-251">For an example of a player based on Azure Media Player using such JWT token, see [http://aka.ms/amtest](http://aka.ms/amtest) (expand "player_settings" link to see the token input).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-251">For an example of a player based on Azure Media Player using such JWT token, see [http://aka.ms/amtest](http://aka.ms/amtest) (expand "player_settings" link to see the token input).</span></span>

### <a name="question"></a><span data-ttu-id="1c2f4-252">Question</span><span class="sxs-lookup"><span data-stu-id="1c2f4-252">Question</span></span>

<span data-ttu-id="1c2f4-253">How do you authorize requests to stream videos with AES encryption?</span><span class="sxs-lookup"><span data-stu-id="1c2f4-253">How do you authorize requests to stream videos with AES encryption?</span></span>

### <a name="answer"></a><span data-ttu-id="1c2f4-254">Answer</span><span class="sxs-lookup"><span data-stu-id="1c2f4-254">Answer</span></span>

<span data-ttu-id="1c2f4-255">The correct approach is to leverage STS (Secure Token Service):</span><span class="sxs-lookup"><span data-stu-id="1c2f4-255">The correct approach is to leverage STS (Secure Token Service):</span></span>

<span data-ttu-id="1c2f4-256">In STS, depending on user profile, add different claims (such as “Premium User”, “Basic User”, “Free Trial User”).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-256">In STS, depending on user profile, add different claims (such as “Premium User”, “Basic User”, “Free Trial User”).</span></span> <span data-ttu-id="1c2f4-257">With different claims in a JWT, the user can see different contents.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-257">With different claims in a JWT, the user can see different contents.</span></span> <span data-ttu-id="1c2f4-258">Of course, for different content/asset, the ContentKeyPolicyRestriction will have the corresponding RequiredClaims.</span><span class="sxs-lookup"><span data-stu-id="1c2f4-258">Of course, for different content/asset, the ContentKeyPolicyRestriction will have the corresponding RequiredClaims.</span></span>

<span data-ttu-id="1c2f4-259">Use Azure Media Services APIs for configuring license/key delivery and encrypting your assets (as shown in [this sample](https://github.com/Azure-Samples/media-services-v3-dotnet-tutorials/blob/master/AMSV3Tutorials/EncryptWithAES/Program.cs).</span><span class="sxs-lookup"><span data-stu-id="1c2f4-259">Use Azure Media Services APIs for configuring license/key delivery and encrypting your assets (as shown in [this sample](https://github.com/Azure-Samples/media-services-v3-dotnet-tutorials/blob/master/AMSV3Tutorials/EncryptWithAES/Program.cs).</span></span>

## <a name="next-steps"></a><span data-ttu-id="1c2f4-260">Next steps</span><span class="sxs-lookup"><span data-stu-id="1c2f4-260">Next steps</span></span>

<span data-ttu-id="1c2f4-261">Check out the following articles:</span><span class="sxs-lookup"><span data-stu-id="1c2f4-261">Check out the following articles:</span></span>

  * [<span data-ttu-id="1c2f4-262">Protect with AES encryption</span><span class="sxs-lookup"><span data-stu-id="1c2f4-262">Protect with AES encryption</span></span>](protect-with-aes128.md)
  * [<span data-ttu-id="1c2f4-263">Protect with DRM</span><span class="sxs-lookup"><span data-stu-id="1c2f4-263">Protect with DRM</span></span>](protect-with-drm.md)

<span data-ttu-id="1c2f4-264">Additional information can be found in [Design multi-drm content protection system with access control](design-multi-drm-system-with-access-control.md)</span><span class="sxs-lookup"><span data-stu-id="1c2f4-264">Additional information can be found in [Design multi-drm content protection system with access control](design-multi-drm-system-with-access-control.md)</span></span>


