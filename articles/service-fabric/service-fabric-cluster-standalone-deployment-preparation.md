---
title: Azure Service Fabric Standalone Cluster Deployment Preparation | Microsoft Docs
description: Documentation related to preparing the environment and creating the cluster configuration, to be considered prior to deploying a cluster intended for handling a production workload.
services: service-fabric
documentationcenter: .net
author: dkkapur
manager: timlt
editor: ''
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: conceptual
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 9/11/2018
ms.author: dekapur
ms.openlocfilehash: 7357577ea7aff467288578673110b1a6dda7ccef
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44798283"
---
<a id="preparemachines"></a>

# <a name="plan-and-prepare-your-service-fabric-standalone-cluster-deployment"></a><span data-ttu-id="dd2d5-103">Plan and prepare your Service Fabric Standalone cluster deployment</span><span class="sxs-lookup"><span data-stu-id="dd2d5-103">Plan and prepare your Service Fabric Standalone cluster deployment</span></span>
<span data-ttu-id="dd2d5-104">Perform the following steps before you create your cluster.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-104">Perform the following steps before you create your cluster.</span></span>

## <a name="plan-your-cluster-infrastructure"></a><span data-ttu-id="dd2d5-105">Plan your cluster infrastructure</span><span class="sxs-lookup"><span data-stu-id="dd2d5-105">Plan your cluster infrastructure</span></span>
<span data-ttu-id="dd2d5-106">You are about to create a Service Fabric cluster on machines you "own", so you can decide what kinds of failures you want the cluster to survive.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-106">You are about to create a Service Fabric cluster on machines you "own", so you can decide what kinds of failures you want the cluster to survive.</span></span> <span data-ttu-id="dd2d5-107">For example, do you need separate power lines or Internet connections supplied to these machines?</span><span class="sxs-lookup"><span data-stu-id="dd2d5-107">For example, do you need separate power lines or Internet connections supplied to these machines?</span></span> <span data-ttu-id="dd2d5-108">In addition, consider the physical security of these machines.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-108">In addition, consider the physical security of these machines.</span></span> <span data-ttu-id="dd2d5-109">Where are the machines located and who needs access to them?</span><span class="sxs-lookup"><span data-stu-id="dd2d5-109">Where are the machines located and who needs access to them?</span></span> <span data-ttu-id="dd2d5-110">After you make these decisions, you can logically map the machines to various fault domains (see next step).</span><span class="sxs-lookup"><span data-stu-id="dd2d5-110">After you make these decisions, you can logically map the machines to various fault domains (see next step).</span></span> <span data-ttu-id="dd2d5-111">The infrastructure planning for production clusters is more involved than for test clusters.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-111">The infrastructure planning for production clusters is more involved than for test clusters.</span></span>

## <a name="determine-the-number-of-fault-domains-and-upgrade-domains"></a><span data-ttu-id="dd2d5-112">Determine the number of fault domains and upgrade domains</span><span class="sxs-lookup"><span data-stu-id="dd2d5-112">Determine the number of fault domains and upgrade domains</span></span>
<span data-ttu-id="dd2d5-113">A [*fault domain* (FD)](service-fabric-cluster-resource-manager-cluster-description.md) is a physical unit of failure and is directly related to the physical infrastructure in the data centers.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-113">A [*fault domain* (FD)](service-fabric-cluster-resource-manager-cluster-description.md) is a physical unit of failure and is directly related to the physical infrastructure in the data centers.</span></span> <span data-ttu-id="dd2d5-114">A fault domain consists of hardware components (computers, switches, networks, and more) that share a single point of failure.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-114">A fault domain consists of hardware components (computers, switches, networks, and more) that share a single point of failure.</span></span> <span data-ttu-id="dd2d5-115">Although there is no 1:1 mapping between fault domains and racks, loosely speaking, each rack can be considered a fault domain.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-115">Although there is no 1:1 mapping between fault domains and racks, loosely speaking, each rack can be considered a fault domain.</span></span>

<span data-ttu-id="dd2d5-116">When you specify FDs in ClusterConfig.json, you can choose the name for each FD.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-116">When you specify FDs in ClusterConfig.json, you can choose the name for each FD.</span></span> <span data-ttu-id="dd2d5-117">Service Fabric supports hierarchical FDs, so you can reflect your infrastructure topology in them.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-117">Service Fabric supports hierarchical FDs, so you can reflect your infrastructure topology in them.</span></span>  <span data-ttu-id="dd2d5-118">For example, the following FDs are valid:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-118">For example, the following FDs are valid:</span></span>

* <span data-ttu-id="dd2d5-119">"faultDomain": "fd:/Room1/Rack1/Machine1"</span><span class="sxs-lookup"><span data-stu-id="dd2d5-119">"faultDomain": "fd:/Room1/Rack1/Machine1"</span></span>
* <span data-ttu-id="dd2d5-120">"faultDomain": "fd:/FD1"</span><span class="sxs-lookup"><span data-stu-id="dd2d5-120">"faultDomain": "fd:/FD1"</span></span>
* <span data-ttu-id="dd2d5-121">"faultDomain": "fd:/Room1/Rack1/PDU1/M1"</span><span class="sxs-lookup"><span data-stu-id="dd2d5-121">"faultDomain": "fd:/Room1/Rack1/PDU1/M1"</span></span>

<span data-ttu-id="dd2d5-122">An *upgrade domain* (UD) is a logical unit of nodes.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-122">An *upgrade domain* (UD) is a logical unit of nodes.</span></span> <span data-ttu-id="dd2d5-123">During Service Fabric orchestrated upgrades (either an application upgrade or a cluster upgrade), all nodes in a UD are taken down to perform the upgrade while nodes in other UDs remain available to serve requests.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-123">During Service Fabric orchestrated upgrades (either an application upgrade or a cluster upgrade), all nodes in a UD are taken down to perform the upgrade while nodes in other UDs remain available to serve requests.</span></span> <span data-ttu-id="dd2d5-124">The firmware upgrades you perform on your machines do not honor UDs, so you must do them one machine at a time.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-124">The firmware upgrades you perform on your machines do not honor UDs, so you must do them one machine at a time.</span></span>

<span data-ttu-id="dd2d5-125">The simplest way to think about these concepts is to consider FDs as the unit of unplanned failure and UDs as the unit of planned maintenance.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-125">The simplest way to think about these concepts is to consider FDs as the unit of unplanned failure and UDs as the unit of planned maintenance.</span></span>

<span data-ttu-id="dd2d5-126">When you specify UDs in ClusterConfig.json, you can choose the name for each UD.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-126">When you specify UDs in ClusterConfig.json, you can choose the name for each UD.</span></span> <span data-ttu-id="dd2d5-127">For example, the following names are valid:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-127">For example, the following names are valid:</span></span>

* <span data-ttu-id="dd2d5-128">"upgradeDomain": "UD0"</span><span class="sxs-lookup"><span data-stu-id="dd2d5-128">"upgradeDomain": "UD0"</span></span>
* <span data-ttu-id="dd2d5-129">"upgradeDomain": "UD1A"</span><span class="sxs-lookup"><span data-stu-id="dd2d5-129">"upgradeDomain": "UD1A"</span></span>
* <span data-ttu-id="dd2d5-130">"upgradeDomain": "DomainRed"</span><span class="sxs-lookup"><span data-stu-id="dd2d5-130">"upgradeDomain": "DomainRed"</span></span>
* <span data-ttu-id="dd2d5-131">"upgradeDomain": "Blue"</span><span class="sxs-lookup"><span data-stu-id="dd2d5-131">"upgradeDomain": "Blue"</span></span>

<span data-ttu-id="dd2d5-132">For more detailed information on FDs and UDs, see [Describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md).</span><span class="sxs-lookup"><span data-stu-id="dd2d5-132">For more detailed information on FDs and UDs, see [Describing a Service Fabric cluster](service-fabric-cluster-resource-manager-cluster-description.md).</span></span>

<span data-ttu-id="dd2d5-133">A cluster in production should span at least three FDs in order to be supported in a production environment, if you have full control over the maintenance and management of the nodes, that is, you are responsible for updating and replacing machines.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-133">A cluster in production should span at least three FDs in order to be supported in a production environment, if you have full control over the maintenance and management of the nodes, that is, you are responsible for updating and replacing machines.</span></span> <span data-ttu-id="dd2d5-134">For clusters running in environments (that is, Amazon Web Services VM instances) where you do not have full control over the machines, you should have a minimum of five FDs in your cluster.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-134">For clusters running in environments (that is, Amazon Web Services VM instances) where you do not have full control over the machines, you should have a minimum of five FDs in your cluster.</span></span> <span data-ttu-id="dd2d5-135">Each FD can have one or more nodes.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-135">Each FD can have one or more nodes.</span></span> <span data-ttu-id="dd2d5-136">This is to prevent issues caused by machine upgrades and updates, which depending on their timing, can interfere with the running of applications and services in clusters.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-136">This is to prevent issues caused by machine upgrades and updates, which depending on their timing, can interfere with the running of applications and services in clusters.</span></span>

## <a name="determine-the-initial-cluster-size"></a><span data-ttu-id="dd2d5-137">Determine the initial cluster size</span><span class="sxs-lookup"><span data-stu-id="dd2d5-137">Determine the initial cluster size</span></span>

<span data-ttu-id="dd2d5-138">Generally, the number of nodes in your cluster is determined based on your business needs, that is, how many services and containers will be running on the cluster and how many resources do you need to sustain your workloads.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-138">Generally, the number of nodes in your cluster is determined based on your business needs, that is, how many services and containers will be running on the cluster and how many resources do you need to sustain your workloads.</span></span> <span data-ttu-id="dd2d5-139">For production clusters, we recommend having at least five nodes in your cluster, spanning 5 FDs.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-139">For production clusters, we recommend having at least five nodes in your cluster, spanning 5 FDs.</span></span> <span data-ttu-id="dd2d5-140">However, as described above, if you have full control over your nodes and can span three FDs, then three nodes should also do the job.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-140">However, as described above, if you have full control over your nodes and can span three FDs, then three nodes should also do the job.</span></span>

<span data-ttu-id="dd2d5-141">Test clusters running stateful workloads should have three nodes, whereas test clusters only running stateless workloads only need one node.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-141">Test clusters running stateful workloads should have three nodes, whereas test clusters only running stateless workloads only need one node.</span></span> <span data-ttu-id="dd2d5-142">It should also be noted that for development purposes, you can have more than one node on a given machine.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-142">It should also be noted that for development purposes, you can have more than one node on a given machine.</span></span> <span data-ttu-id="dd2d5-143">In a production environment however, Service Fabric supports only one node per physical or virtual machine.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-143">In a production environment however, Service Fabric supports only one node per physical or virtual machine.</span></span>

## <a name="prepare-the-machines-that-will-serve-as-nodes"></a><span data-ttu-id="dd2d5-144">Prepare the machines that will serve as nodes</span><span class="sxs-lookup"><span data-stu-id="dd2d5-144">Prepare the machines that will serve as nodes</span></span>

<span data-ttu-id="dd2d5-145">Here are some recommended specs for each machine that you want to add to the cluster:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-145">Here are some recommended specs for each machine that you want to add to the cluster:</span></span>

* <span data-ttu-id="dd2d5-146">A minimum of 16 GB of RAM</span><span class="sxs-lookup"><span data-stu-id="dd2d5-146">A minimum of 16 GB of RAM</span></span>
* <span data-ttu-id="dd2d5-147">A minimum of 40 of GB available disk space</span><span class="sxs-lookup"><span data-stu-id="dd2d5-147">A minimum of 40 of GB available disk space</span></span>
* <span data-ttu-id="dd2d5-148">A 4 core or greater CPU</span><span class="sxs-lookup"><span data-stu-id="dd2d5-148">A 4 core or greater CPU</span></span>
* <span data-ttu-id="dd2d5-149">Connectivity to a secure network or networks for all machines</span><span class="sxs-lookup"><span data-stu-id="dd2d5-149">Connectivity to a secure network or networks for all machines</span></span>
* <span data-ttu-id="dd2d5-150">Windows Server OS installed (valid versions: 2012 R2, 2016, 1709, or 1803)</span><span class="sxs-lookup"><span data-stu-id="dd2d5-150">Windows Server OS installed (valid versions: 2012 R2, 2016, 1709, or 1803)</span></span>
* <span data-ttu-id="dd2d5-151">[.NET Framework 4.5.1 or higher](https://www.microsoft.com/download/details.aspx?id=40773), full install</span><span class="sxs-lookup"><span data-stu-id="dd2d5-151">[.NET Framework 4.5.1 or higher](https://www.microsoft.com/download/details.aspx?id=40773), full install</span></span>
* [<span data-ttu-id="dd2d5-152">Windows PowerShell 3.0</span><span class="sxs-lookup"><span data-stu-id="dd2d5-152">Windows PowerShell 3.0</span></span>](https://msdn.microsoft.com/powershell/scripting/setup/installing-windows-powershell)
* <span data-ttu-id="dd2d5-153">The [RemoteRegistry service](https://technet.microsoft.com/library/cc754820) should be running on all the machines</span><span class="sxs-lookup"><span data-stu-id="dd2d5-153">The [RemoteRegistry service](https://technet.microsoft.com/library/cc754820) should be running on all the machines</span></span>

<span data-ttu-id="dd2d5-154">The cluster administrator deploying and configuring the cluster must have [administrator privileges](https://social.technet.microsoft.com/wiki/contents/articles/13436.windows-server-2012-how-to-add-an-account-to-a-local-administrator-group.aspx) on each of the machines.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-154">The cluster administrator deploying and configuring the cluster must have [administrator privileges](https://social.technet.microsoft.com/wiki/contents/articles/13436.windows-server-2012-how-to-add-an-account-to-a-local-administrator-group.aspx) on each of the machines.</span></span> <span data-ttu-id="dd2d5-155">You cannot install Service Fabric on a domain controller.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-155">You cannot install Service Fabric on a domain controller.</span></span>

## <a name="download-the-service-fabric-standalone-package-for-windows-server"></a><span data-ttu-id="dd2d5-156">Download the Service Fabric standalone package for Windows Server</span><span class="sxs-lookup"><span data-stu-id="dd2d5-156">Download the Service Fabric standalone package for Windows Server</span></span>
<span data-ttu-id="dd2d5-157">[Download Link - Service Fabric Standalone Package - Windows Server](http://go.microsoft.com/fwlink/?LinkId=730690) and unzip the package, either to a deployment machine that is not part of the cluster, or to one of the machines that will be a part of your cluster.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-157">[Download Link - Service Fabric Standalone Package - Windows Server](http://go.microsoft.com/fwlink/?LinkId=730690) and unzip the package, either to a deployment machine that is not part of the cluster, or to one of the machines that will be a part of your cluster.</span></span>

## <a name="modify-cluster-configuration"></a><span data-ttu-id="dd2d5-158">Modify cluster configuration</span><span class="sxs-lookup"><span data-stu-id="dd2d5-158">Modify cluster configuration</span></span>
<span data-ttu-id="dd2d5-159">To create a standalone cluster you have to create a standalone cluster configuration ClusterConfig.json file, which describes the specification of the cluster.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-159">To create a standalone cluster you have to create a standalone cluster configuration ClusterConfig.json file, which describes the specification of the cluster.</span></span> <span data-ttu-id="dd2d5-160">You can base the configuration file on the templates found at the below link.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-160">You can base the configuration file on the templates found at the below link.</span></span> <br>
[<span data-ttu-id="dd2d5-161">Standalone Cluster Configurations</span><span class="sxs-lookup"><span data-stu-id="dd2d5-161">Standalone Cluster Configurations</span></span>](https://github.com/Azure-Samples/service-fabric-dotnet-standalone-cluster-configuration/tree/master/Samples)

<span data-ttu-id="dd2d5-162">For details on the sections in this file, see [Configuration settings for standalone Windows cluster](service-fabric-cluster-manifest.md).</span><span class="sxs-lookup"><span data-stu-id="dd2d5-162">For details on the sections in this file, see [Configuration settings for standalone Windows cluster](service-fabric-cluster-manifest.md).</span></span>

<span data-ttu-id="dd2d5-163">Open one of the ClusterConfig.json files from the package you downloaded and modify the following settings:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-163">Open one of the ClusterConfig.json files from the package you downloaded and modify the following settings:</span></span>
| <span data-ttu-id="dd2d5-164">**Configuration Setting**</span><span class="sxs-lookup"><span data-stu-id="dd2d5-164">**Configuration Setting**</span></span> | <span data-ttu-id="dd2d5-165">**Description**</span><span class="sxs-lookup"><span data-stu-id="dd2d5-165">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="dd2d5-166">**NodeTypes**</span><span class="sxs-lookup"><span data-stu-id="dd2d5-166">**NodeTypes**</span></span> |<span data-ttu-id="dd2d5-167">Node types allow you to separate your cluster nodes into various groups.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-167">Node types allow you to separate your cluster nodes into various groups.</span></span> <span data-ttu-id="dd2d5-168">A cluster must have at least one NodeType.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-168">A cluster must have at least one NodeType.</span></span> <span data-ttu-id="dd2d5-169">All nodes in a group have the following common characteristics:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-169">All nodes in a group have the following common characteristics:</span></span> <br> <span data-ttu-id="dd2d5-170">**Name** - This is the node type name.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-170">**Name** - This is the node type name.</span></span> <br><span data-ttu-id="dd2d5-171">**Endpoint Ports** - These are various named end points (ports) that are associated with this node type.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-171">**Endpoint Ports** - These are various named end points (ports) that are associated with this node type.</span></span> <span data-ttu-id="dd2d5-172">You can use any port number that you wish, as long as they do not conflict with anything else in this manifest and are not already in use by any other application running on the machine/VM.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-172">You can use any port number that you wish, as long as they do not conflict with anything else in this manifest and are not already in use by any other application running on the machine/VM.</span></span> <br> <span data-ttu-id="dd2d5-173">**Placement Properties** - These describe properties for this node type that you use as placement constraints for the system services or your services.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-173">**Placement Properties** - These describe properties for this node type that you use as placement constraints for the system services or your services.</span></span> <span data-ttu-id="dd2d5-174">These properties are user-defined key/value pairs that provide extra meta data for a given node.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-174">These properties are user-defined key/value pairs that provide extra meta data for a given node.</span></span> <span data-ttu-id="dd2d5-175">Examples of node properties would be whether the node has a hard drive or graphics card, the number of spindles in its hard drive, cores, and other physical properties.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-175">Examples of node properties would be whether the node has a hard drive or graphics card, the number of spindles in its hard drive, cores, and other physical properties.</span></span> <br> <span data-ttu-id="dd2d5-176">**Capacities** - Node capacities define the name and amount of a particular resource that a particular node has available for consumption.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-176">**Capacities** - Node capacities define the name and amount of a particular resource that a particular node has available for consumption.</span></span> <span data-ttu-id="dd2d5-177">For example, a node may define that it has capacity for a metric called “MemoryInMb” and that it has 2048 MB available by default.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-177">For example, a node may define that it has capacity for a metric called “MemoryInMb” and that it has 2048 MB available by default.</span></span> <span data-ttu-id="dd2d5-178">These capacities are used at runtime to ensure that services that require particular amounts of resources are placed on the nodes that have those resources available in the required amounts.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-178">These capacities are used at runtime to ensure that services that require particular amounts of resources are placed on the nodes that have those resources available in the required amounts.</span></span><br><span data-ttu-id="dd2d5-179">**IsPrimary** - If you have more than one NodeType defined ensure that only one is set to primary with the value *true*, which is where the system services run.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-179">**IsPrimary** - If you have more than one NodeType defined ensure that only one is set to primary with the value *true*, which is where the system services run.</span></span> <span data-ttu-id="dd2d5-180">All other node types should be set to the value *false*</span><span class="sxs-lookup"><span data-stu-id="dd2d5-180">All other node types should be set to the value *false*</span></span> |
| <span data-ttu-id="dd2d5-181">**Nodes**</span><span class="sxs-lookup"><span data-stu-id="dd2d5-181">**Nodes**</span></span> |<span data-ttu-id="dd2d5-182">These are the details for each of the nodes that are part of the cluster (node type, node name, IP address, fault domain, and upgrade domain of the node).</span><span class="sxs-lookup"><span data-stu-id="dd2d5-182">These are the details for each of the nodes that are part of the cluster (node type, node name, IP address, fault domain, and upgrade domain of the node).</span></span> <span data-ttu-id="dd2d5-183">The machines you want the cluster to be created on need to be listed here with their IP addresses.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-183">The machines you want the cluster to be created on need to be listed here with their IP addresses.</span></span> <br> <span data-ttu-id="dd2d5-184">If you use the same IP address for all the nodes, then a one-box cluster is created, which you can use for testing purposes.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-184">If you use the same IP address for all the nodes, then a one-box cluster is created, which you can use for testing purposes.</span></span> <span data-ttu-id="dd2d5-185">Do not use One-box clusters for deploying production workloads.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-185">Do not use One-box clusters for deploying production workloads.</span></span> |

<span data-ttu-id="dd2d5-186">After the cluster configuration has had all settings configured to the environment, it can be tested against the cluster environment (step 7).</span><span class="sxs-lookup"><span data-stu-id="dd2d5-186">After the cluster configuration has had all settings configured to the environment, it can be tested against the cluster environment (step 7).</span></span>

<a id="environmentsetup"></a>

## <a name="environment-setup"></a><span data-ttu-id="dd2d5-187">Environment setup</span><span class="sxs-lookup"><span data-stu-id="dd2d5-187">Environment setup</span></span>

<span data-ttu-id="dd2d5-188">When a cluster administrator configures a Service Fabric standalone cluster, the environment needs to be set up with the following criteria:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-188">When a cluster administrator configures a Service Fabric standalone cluster, the environment needs to be set up with the following criteria:</span></span> <br>
1. <span data-ttu-id="dd2d5-189">The user creating the cluster should have administrator-level security privileges to all machines that are listed as nodes in the cluster configuration file.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-189">The user creating the cluster should have administrator-level security privileges to all machines that are listed as nodes in the cluster configuration file.</span></span>
2. <span data-ttu-id="dd2d5-190">Machine from which the cluster is created, as well as each cluster node machine must:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-190">Machine from which the cluster is created, as well as each cluster node machine must:</span></span>
* <span data-ttu-id="dd2d5-191">Have Service Fabric SDK uninstalled</span><span class="sxs-lookup"><span data-stu-id="dd2d5-191">Have Service Fabric SDK uninstalled</span></span>
* <span data-ttu-id="dd2d5-192">Have Service Fabric runtime uninstalled</span><span class="sxs-lookup"><span data-stu-id="dd2d5-192">Have Service Fabric runtime uninstalled</span></span> 
* <span data-ttu-id="dd2d5-193">Have the Windows Firewall service (mpssvc) enabled</span><span class="sxs-lookup"><span data-stu-id="dd2d5-193">Have the Windows Firewall service (mpssvc) enabled</span></span>
* <span data-ttu-id="dd2d5-194">Have the Remote Registry Service (remote registry) enabled</span><span class="sxs-lookup"><span data-stu-id="dd2d5-194">Have the Remote Registry Service (remote registry) enabled</span></span>
* <span data-ttu-id="dd2d5-195">Have file sharing (SMB) enabled</span><span class="sxs-lookup"><span data-stu-id="dd2d5-195">Have file sharing (SMB) enabled</span></span>
* <span data-ttu-id="dd2d5-196">Have necessary ports opened, based on cluster configuration ports</span><span class="sxs-lookup"><span data-stu-id="dd2d5-196">Have necessary ports opened, based on cluster configuration ports</span></span>
* <span data-ttu-id="dd2d5-197">Have necessary ports opened for Windows SMB and Remote Registry service: 135, 137, 138, 139, and 445</span><span class="sxs-lookup"><span data-stu-id="dd2d5-197">Have necessary ports opened for Windows SMB and Remote Registry service: 135, 137, 138, 139, and 445</span></span>
* <span data-ttu-id="dd2d5-198">Have network connectivity to one another</span><span class="sxs-lookup"><span data-stu-id="dd2d5-198">Have network connectivity to one another</span></span>
3. <span data-ttu-id="dd2d5-199">None of the cluster node machines should be a Domain Controller.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-199">None of the cluster node machines should be a Domain Controller.</span></span>
4. <span data-ttu-id="dd2d5-200">If the cluster to be deployed is a secure cluster, validate the necessary security prerequisites are in place, and are configured correctly against the configuration.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-200">If the cluster to be deployed is a secure cluster, validate the necessary security prerequisites are in place, and are configured correctly against the configuration.</span></span>
5. <span data-ttu-id="dd2d5-201">If the cluster machines are not internet-accessible, set the following in the cluster configuration:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-201">If the cluster machines are not internet-accessible, set the following in the cluster configuration:</span></span>
* <span data-ttu-id="dd2d5-202">Disable telemetry:   Under *properties* set   *"enableTelemetry": false*</span><span class="sxs-lookup"><span data-stu-id="dd2d5-202">Disable telemetry:   Under *properties* set   *"enableTelemetry": false*</span></span>
* <span data-ttu-id="dd2d5-203">Disable automatic Fabric version downloading & notifications that the current cluster version is nearing end of support:   Under *properties* set   *"fabricClusterAutoupgradeEnabled": false*</span><span class="sxs-lookup"><span data-stu-id="dd2d5-203">Disable automatic Fabric version downloading & notifications that the current cluster version is nearing end of support:   Under *properties* set   *"fabricClusterAutoupgradeEnabled": false*</span></span>
* <span data-ttu-id="dd2d5-204">Alternatively, if network internet access is limited to white-listed domains, the domains below are required for automatic upgrade:   go.microsoft.com   download.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="dd2d5-204">Alternatively, if network internet access is limited to white-listed domains, the domains below are required for automatic upgrade:   go.microsoft.com   download.microsoft.com</span></span>

6. <span data-ttu-id="dd2d5-205">Set appropriate Service Fabric antivirus exclusions:</span><span class="sxs-lookup"><span data-stu-id="dd2d5-205">Set appropriate Service Fabric antivirus exclusions:</span></span>

| <span data-ttu-id="dd2d5-206">**Antivirus Excluded directories**</span><span class="sxs-lookup"><span data-stu-id="dd2d5-206">**Antivirus Excluded directories**</span></span> |
| --- |
| <span data-ttu-id="dd2d5-207">Program Files\Microsoft Service Fabric</span><span class="sxs-lookup"><span data-stu-id="dd2d5-207">Program Files\Microsoft Service Fabric</span></span> |
| <span data-ttu-id="dd2d5-208">FabricDataRoot (from cluster configuration)</span><span class="sxs-lookup"><span data-stu-id="dd2d5-208">FabricDataRoot (from cluster configuration)</span></span> |
| <span data-ttu-id="dd2d5-209">FabricLogRoot (from cluster configuration)</span><span class="sxs-lookup"><span data-stu-id="dd2d5-209">FabricLogRoot (from cluster configuration)</span></span> |

| <span data-ttu-id="dd2d5-210">**Antivirus Excluded processes**</span><span class="sxs-lookup"><span data-stu-id="dd2d5-210">**Antivirus Excluded processes**</span></span> |
| --- |
| <span data-ttu-id="dd2d5-211">Fabric.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-211">Fabric.exe</span></span> |
| <span data-ttu-id="dd2d5-212">FabricHost.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-212">FabricHost.exe</span></span> |
| <span data-ttu-id="dd2d5-213">FabricInstallerService.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-213">FabricInstallerService.exe</span></span> |
| <span data-ttu-id="dd2d5-214">FabricSetup.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-214">FabricSetup.exe</span></span> |
| <span data-ttu-id="dd2d5-215">FabricDeployer.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-215">FabricDeployer.exe</span></span> |
| <span data-ttu-id="dd2d5-216">ImageBuilder.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-216">ImageBuilder.exe</span></span> |
| <span data-ttu-id="dd2d5-217">FabricGateway.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-217">FabricGateway.exe</span></span> |
| <span data-ttu-id="dd2d5-218">FabricDCA.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-218">FabricDCA.exe</span></span> |
| <span data-ttu-id="dd2d5-219">FabricFAS.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-219">FabricFAS.exe</span></span> |
| <span data-ttu-id="dd2d5-220">FabricUOS.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-220">FabricUOS.exe</span></span> |
| <span data-ttu-id="dd2d5-221">FabricRM.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-221">FabricRM.exe</span></span> |
| <span data-ttu-id="dd2d5-222">FileStoreService.exe</span><span class="sxs-lookup"><span data-stu-id="dd2d5-222">FileStoreService.exe</span></span> |

## <a name="validate-environment-using-testconfiguration-script"></a><span data-ttu-id="dd2d5-223">Validate environment using TestConfiguration script</span><span class="sxs-lookup"><span data-stu-id="dd2d5-223">Validate environment using TestConfiguration script</span></span>
<span data-ttu-id="dd2d5-224">The TestConfiguration.ps1 script can be found in the standalone package.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-224">The TestConfiguration.ps1 script can be found in the standalone package.</span></span> <span data-ttu-id="dd2d5-225">It is used as a Best Practices Analyzer to validate some of the criteria above and should be used as a sanity check to validate whether a cluster can be deployed on a given environment.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-225">It is used as a Best Practices Analyzer to validate some of the criteria above and should be used as a sanity check to validate whether a cluster can be deployed on a given environment.</span></span> <span data-ttu-id="dd2d5-226">If there is any failure, refer to the list under [Environment Setup](service-fabric-cluster-standalone-deployment-preparation.md) for troubleshooting.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-226">If there is any failure, refer to the list under [Environment Setup](service-fabric-cluster-standalone-deployment-preparation.md) for troubleshooting.</span></span> 

<span data-ttu-id="dd2d5-227">This script can be run on any machine that has administrator access to all the machines that are listed as nodes in the cluster configuration file.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-227">This script can be run on any machine that has administrator access to all the machines that are listed as nodes in the cluster configuration file.</span></span> <span data-ttu-id="dd2d5-228">The machine that this script is run on does not have to be part of the cluster.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-228">The machine that this script is run on does not have to be part of the cluster.</span></span>

```powershell
PS C:\temp\Microsoft.Azure.ServiceFabric.WindowsServer> .\TestConfiguration.ps1 -ClusterConfigFilePath .\ClusterConfig.Unsecure.DevCluster.json
Trace folder already exists. Traces will be written to existing trace folder: C:\temp\Microsoft.Azure.ServiceFabric.WindowsServer\DeploymentTraces
Running Best Practices Analyzer...
Best Practices Analyzer completed successfully.


LocalAdminPrivilege        : True
IsJsonValid                : True
IsCabValid                 : True
RequiredPortsOpen          : True
RemoteRegistryAvailable    : True
FirewallAvailable          : True
RpcCheckPassed             : True
NoConflictingInstallations : True
FabricInstallable          : True
Passed                     : True
```

<span data-ttu-id="dd2d5-229">Currently this configuration testing module does not validate the security configuration so this has to be done independently.</span><span class="sxs-lookup"><span data-stu-id="dd2d5-229">Currently this configuration testing module does not validate the security configuration so this has to be done independently.</span></span>  

> [!NOTE]
> <span data-ttu-id="dd2d5-230">We are continually making improvements to make this module more robust, so if there is a faulty or missing case which you believe isn't currently caught by TestConfiguration, please let us know through our [support channels](https://docs.microsoft.com/azure/service-fabric/service-fabric-support).</span><span class="sxs-lookup"><span data-stu-id="dd2d5-230">We are continually making improvements to make this module more robust, so if there is a faulty or missing case which you believe isn't currently caught by TestConfiguration, please let us know through our [support channels](https://docs.microsoft.com/azure/service-fabric/service-fabric-support).</span></span>   
> 
> 

## <a name="next-steps"></a><span data-ttu-id="dd2d5-231">Next steps</span><span class="sxs-lookup"><span data-stu-id="dd2d5-231">Next steps</span></span>
* [<span data-ttu-id="dd2d5-232">Create a standalone cluster running on Windows Server</span><span class="sxs-lookup"><span data-stu-id="dd2d5-232">Create a standalone cluster running on Windows Server</span></span>](service-fabric-cluster-creation-for-windows-server.md)
