---
title: Service Fabric app upgrade tutorial| Microsoft Docs
description: This article walks through the experience of deploying a Service Fabric application, changing the code, and rolling out an upgrade by using Visual Studio.
services: service-fabric
documentationcenter: .net
author: mani-ramaswamy
manager: timlt
editor: ''
ms.assetid: a3181a7a-9ab1-4216-b07a-05b79bd826a4
ms.service: service-fabric
ms.devlang: dotnet
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: NA
ms.date: 04/07/2017
ms.author: subramar
ms.openlocfilehash: d9c4a20125f0a0f58016d8a41bd1965c30b0b667
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44551820"
---
# <a name="service-fabric-application-upgrade-tutorial-using-visual-studio"></a><span data-ttu-id="e63d8-103">Service Fabric application upgrade tutorial using Visual Studio</span><span class="sxs-lookup"><span data-stu-id="e63d8-103">Service Fabric application upgrade tutorial using Visual Studio</span></span>
> [!div class="op_single_selector"]
> * [PowerShell](service-fabric-application-upgrade-tutorial-powershell.md)
> * [Visual Studio](service-fabric-application-upgrade-tutorial.md)
> 
> 

<br/>

<span data-ttu-id="e63d8-106">Azure Service Fabric simplifies the process of upgrading cloud applications by ensuring that only changed services are upgraded, and that application health is monitored throughout the upgrade process.</span><span class="sxs-lookup"><span data-stu-id="e63d8-106">Azure Service Fabric simplifies the process of upgrading cloud applications by ensuring that only changed services are upgraded, and that application health is monitored throughout the upgrade process.</span></span> <span data-ttu-id="e63d8-107">It also automatically rolls back the application to the previous version upon encountering issues.</span><span class="sxs-lookup"><span data-stu-id="e63d8-107">It also automatically rolls back the application to the previous version upon encountering issues.</span></span> <span data-ttu-id="e63d8-108">Service Fabric application upgrades are *Zero Downtime*, since the application can be upgraded with no downtime.</span><span class="sxs-lookup"><span data-stu-id="e63d8-108">Service Fabric application upgrades are *Zero Downtime*, since the application can be upgraded with no downtime.</span></span> <span data-ttu-id="e63d8-109">This tutorial covers how to complete a rolling upgrade from Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e63d8-109">This tutorial covers how to complete a rolling upgrade from Visual Studio.</span></span>

## <a name="step-1-build-and-publish-the-visual-objects-sample"></a><span data-ttu-id="e63d8-110">Step 1: Build and publish the Visual Objects sample</span><span class="sxs-lookup"><span data-stu-id="e63d8-110">Step 1: Build and publish the Visual Objects sample</span></span>
<span data-ttu-id="e63d8-111">First, download the [Visual Objects](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started/tree/classic/Actors/VisualObjects) application from GitHub.</span><span class="sxs-lookup"><span data-stu-id="e63d8-111">First, download the [Visual Objects](https://github.com/Azure-Samples/service-fabric-dotnet-getting-started/tree/classic/Actors/VisualObjects) application from GitHub.</span></span> <span data-ttu-id="e63d8-112">Then, build and publish the application by right-clicking on the application project, **VisualObjects**, and selecting the **Publish** command in the Service Fabric menu item.</span><span class="sxs-lookup"><span data-stu-id="e63d8-112">Then, build and publish the application by right-clicking on the application project, **VisualObjects**, and selecting the **Publish** command in the Service Fabric menu item.</span></span>

![Context menu for a Service Fabric application][image1]

<span data-ttu-id="e63d8-114">Selecting **Publish** brings up a popup, and you can set the **Target profile** to **PublishProfiles\Local.xml**.</span><span class="sxs-lookup"><span data-stu-id="e63d8-114">Selecting **Publish** brings up a popup, and you can set the **Target profile** to **PublishProfiles\Local.xml**.</span></span> <span data-ttu-id="e63d8-115">The window should look like the following before you click **Publish**.</span><span class="sxs-lookup"><span data-stu-id="e63d8-115">The window should look like the following before you click **Publish**.</span></span>

![Publishing a Service Fabric application][image2]

<span data-ttu-id="e63d8-117">Now you can click **Publish** in the dialog box.</span><span class="sxs-lookup"><span data-stu-id="e63d8-117">Now you can click **Publish** in the dialog box.</span></span> <span data-ttu-id="e63d8-118">You can use [Service Fabric Explorer to view the cluster and the application](service-fabric-visualizing-your-cluster.md).</span><span class="sxs-lookup"><span data-stu-id="e63d8-118">You can use [Service Fabric Explorer to view the cluster and the application](service-fabric-visualizing-your-cluster.md).</span></span> <span data-ttu-id="e63d8-119">The Visual Objects application has a web service that you can go to by typing [http://localhost:8082/visualobjects/](http://localhost:8082/visualobjects/) in the address bar of your browser.</span><span class="sxs-lookup"><span data-stu-id="e63d8-119">The Visual Objects application has a web service that you can go to by typing [http://localhost:8082/visualobjects/](http://localhost:8082/visualobjects/) in the address bar of your browser.</span></span>  <span data-ttu-id="e63d8-120">You should see 10 floating visual objects moving around on the screen.</span><span class="sxs-lookup"><span data-stu-id="e63d8-120">You should see 10 floating visual objects moving around on the screen.</span></span>

## <a name="step-2-update-the-visual-objects-sample"></a><span data-ttu-id="e63d8-121">Step 2: Update the Visual Objects sample</span><span class="sxs-lookup"><span data-stu-id="e63d8-121">Step 2: Update the Visual Objects sample</span></span>
<span data-ttu-id="e63d8-122">You might notice that with the version that was deployed in step 1, the visual objects do not rotate.</span><span class="sxs-lookup"><span data-stu-id="e63d8-122">You might notice that with the version that was deployed in step 1, the visual objects do not rotate.</span></span> <span data-ttu-id="e63d8-123">Let's upgrade this application to one where the visual objects also rotate.</span><span class="sxs-lookup"><span data-stu-id="e63d8-123">Let's upgrade this application to one where the visual objects also rotate.</span></span>

<span data-ttu-id="e63d8-124">Select the VisualObjects.ActorService project within the VisualObjects solution, and open the **VisualObjectActor.cs** file.</span><span class="sxs-lookup"><span data-stu-id="e63d8-124">Select the VisualObjects.ActorService project within the VisualObjects solution, and open the **VisualObjectActor.cs** file.</span></span> <span data-ttu-id="e63d8-125">Within that file, go to the method `MoveObject`, comment out `visualObject.Move(false)`, and uncomment `visualObject.Move(true)`.</span><span class="sxs-lookup"><span data-stu-id="e63d8-125">Within that file, go to the method `MoveObject`, comment out `visualObject.Move(false)`, and uncomment `visualObject.Move(true)`.</span></span> <span data-ttu-id="e63d8-126">This code change rotates the objects after the service is upgraded.</span><span class="sxs-lookup"><span data-stu-id="e63d8-126">This code change rotates the objects after the service is upgraded.</span></span>  <span data-ttu-id="e63d8-127">**Now you can build (not rebuild) the solution**, which builds the modified projects.</span><span class="sxs-lookup"><span data-stu-id="e63d8-127">**Now you can build (not rebuild) the solution**, which builds the modified projects.</span></span> <span data-ttu-id="e63d8-128">If you select *Rebuild all*, you have to update the versions for all the projects.</span><span class="sxs-lookup"><span data-stu-id="e63d8-128">If you select *Rebuild all*, you have to update the versions for all the projects.</span></span>

<span data-ttu-id="e63d8-129">We also need to version our application.</span><span class="sxs-lookup"><span data-stu-id="e63d8-129">We also need to version our application.</span></span> <span data-ttu-id="e63d8-130">To make the version changes after you right-click on the **VisualObjects** project, you can use the Visual Studio **Edit Manifest Versions** option.</span><span class="sxs-lookup"><span data-stu-id="e63d8-130">To make the version changes after you right-click on the **VisualObjects** project, you can use the Visual Studio **Edit Manifest Versions** option.</span></span> <span data-ttu-id="e63d8-131">Selecting this option brings up the dialog box for edition versions as follows:</span><span class="sxs-lookup"><span data-stu-id="e63d8-131">Selecting this option brings up the dialog box for edition versions as follows:</span></span>

![Versioning dialog box][image3]

<span data-ttu-id="e63d8-133">Update the versions for the modified projects and their code packages, along with the application to version 2.0.0.</span><span class="sxs-lookup"><span data-stu-id="e63d8-133">Update the versions for the modified projects and their code packages, along with the application to version 2.0.0.</span></span> <span data-ttu-id="e63d8-134">After the changes are made, the manifest should look like the following (bold portions show the changes):</span><span class="sxs-lookup"><span data-stu-id="e63d8-134">After the changes are made, the manifest should look like the following (bold portions show the changes):</span></span>

![Updating versions][image4]

<span data-ttu-id="e63d8-136">The Visual Studio tools can do automatic rollups of versions upon selecting **Automatically update application and service versions**.</span><span class="sxs-lookup"><span data-stu-id="e63d8-136">The Visual Studio tools can do automatic rollups of versions upon selecting **Automatically update application and service versions**.</span></span> <span data-ttu-id="e63d8-137">If you use [SemVer](http://www.semver.org), you need to update the code and/or configuration package version alone if that option is selected.</span><span class="sxs-lookup"><span data-stu-id="e63d8-137">If you use [SemVer](http://www.semver.org), you need to update the code and/or configuration package version alone if that option is selected.</span></span>

<span data-ttu-id="e63d8-138">Save the changes, and now check the **Upgrade the Application** box.</span><span class="sxs-lookup"><span data-stu-id="e63d8-138">Save the changes, and now check the **Upgrade the Application** box.</span></span>

## <a name="step-3--upgrade-your-application"></a><span data-ttu-id="e63d8-139">Step 3:  Upgrade your application</span><span class="sxs-lookup"><span data-stu-id="e63d8-139">Step 3:  Upgrade your application</span></span>
<span data-ttu-id="e63d8-140">Familiarize yourself with the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and the [upgrade process](service-fabric-application-upgrade.md) to get a good understanding of the various upgrade parameters, time-outs, and health criterion that can be applied.</span><span class="sxs-lookup"><span data-stu-id="e63d8-140">Familiarize yourself with the [application upgrade parameters](service-fabric-application-upgrade-parameters.md) and the [upgrade process](service-fabric-application-upgrade.md) to get a good understanding of the various upgrade parameters, time-outs, and health criterion that can be applied.</span></span> <span data-ttu-id="e63d8-141">For this walkthrough, the service health evaluation criterion is set to the default (unmonitored mode).</span><span class="sxs-lookup"><span data-stu-id="e63d8-141">For this walkthrough, the service health evaluation criterion is set to the default (unmonitored mode).</span></span> <span data-ttu-id="e63d8-142">You can configure these settings by selecting **Configure Upgrade Settings** and then modifying the parameters as desired.</span><span class="sxs-lookup"><span data-stu-id="e63d8-142">You can configure these settings by selecting **Configure Upgrade Settings** and then modifying the parameters as desired.</span></span>

<span data-ttu-id="e63d8-143">Now we are all set to start the application upgrade by selecting **Publish**.</span><span class="sxs-lookup"><span data-stu-id="e63d8-143">Now we are all set to start the application upgrade by selecting **Publish**.</span></span> <span data-ttu-id="e63d8-144">This option upgrades your application to version 2.0.0, in which the objects rotate.</span><span class="sxs-lookup"><span data-stu-id="e63d8-144">This option upgrades your application to version 2.0.0, in which the objects rotate.</span></span> <span data-ttu-id="e63d8-145">Service Fabric upgrades one update domain at a time (some objects are updated first, followed by others), and the service remains accessible during the upgrade.</span><span class="sxs-lookup"><span data-stu-id="e63d8-145">Service Fabric upgrades one update domain at a time (some objects are updated first, followed by others), and the service remains accessible during the upgrade.</span></span> <span data-ttu-id="e63d8-146">Access to the service can be checked through your client (browser).</span><span class="sxs-lookup"><span data-stu-id="e63d8-146">Access to the service can be checked through your client (browser).</span></span>  

<span data-ttu-id="e63d8-147">Now, as the application upgrade proceeds, you can monitor it with Service Fabric Explorer, by using the **Upgrades in Progress** tab under the applications.</span><span class="sxs-lookup"><span data-stu-id="e63d8-147">Now, as the application upgrade proceeds, you can monitor it with Service Fabric Explorer, by using the **Upgrades in Progress** tab under the applications.</span></span>

<span data-ttu-id="e63d8-148">In a few minutes, all update domains should be upgraded (completed), and the Visual Studio output window should also state that the upgrade is completed.</span><span class="sxs-lookup"><span data-stu-id="e63d8-148">In a few minutes, all update domains should be upgraded (completed), and the Visual Studio output window should also state that the upgrade is completed.</span></span> <span data-ttu-id="e63d8-149">And you should find that *all* the visual objects in your browser window are now rotating!</span><span class="sxs-lookup"><span data-stu-id="e63d8-149">And you should find that *all* the visual objects in your browser window are now rotating!</span></span>

<span data-ttu-id="e63d8-150">You may want to try changing the versions, and moving from version 2.0.0 to version 3.0.0 as an exercise, or even from version 2.0.0 back to version 1.0.0.</span><span class="sxs-lookup"><span data-stu-id="e63d8-150">You may want to try changing the versions, and moving from version 2.0.0 to version 3.0.0 as an exercise, or even from version 2.0.0 back to version 1.0.0.</span></span> <span data-ttu-id="e63d8-151">Play with time-outs and health policies to make yourself familiar with them.</span><span class="sxs-lookup"><span data-stu-id="e63d8-151">Play with time-outs and health policies to make yourself familiar with them.</span></span> <span data-ttu-id="e63d8-152">When deploying to an Azure cluster as opposed to a local cluster, the parameters used may have to differ.</span><span class="sxs-lookup"><span data-stu-id="e63d8-152">When deploying to an Azure cluster as opposed to a local cluster, the parameters used may have to differ.</span></span> <span data-ttu-id="e63d8-153">We recommend that you set the time-outs conservatively.</span><span class="sxs-lookup"><span data-stu-id="e63d8-153">We recommend that you set the time-outs conservatively.</span></span>

## <a name="next-steps"></a><span data-ttu-id="e63d8-154">Next steps</span><span class="sxs-lookup"><span data-stu-id="e63d8-154">Next steps</span></span>
<span data-ttu-id="e63d8-155">[Upgrading your application using PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span><span class="sxs-lookup"><span data-stu-id="e63d8-155">[Upgrading your application using PowerShell](service-fabric-application-upgrade-tutorial-powershell.md) walks you through an application upgrade using PowerShell.</span></span>

<span data-ttu-id="e63d8-156">Control how your application is upgraded by using [upgrade parameters](service-fabric-application-upgrade-parameters.md).</span><span class="sxs-lookup"><span data-stu-id="e63d8-156">Control how your application is upgraded by using [upgrade parameters](service-fabric-application-upgrade-parameters.md).</span></span>

<span data-ttu-id="e63d8-157">Make your application upgrades compatible by learning how to use [data serialization](service-fabric-application-upgrade-data-serialization.md).</span><span class="sxs-lookup"><span data-stu-id="e63d8-157">Make your application upgrades compatible by learning how to use [data serialization](service-fabric-application-upgrade-data-serialization.md).</span></span>

<span data-ttu-id="e63d8-158">Learn how to use advanced functionality while upgrading your application by referring to [Advanced topics](service-fabric-application-upgrade-advanced.md).</span><span class="sxs-lookup"><span data-stu-id="e63d8-158">Learn how to use advanced functionality while upgrading your application by referring to [Advanced topics](service-fabric-application-upgrade-advanced.md).</span></span>

<span data-ttu-id="e63d8-159">Fix common problems in application upgrades by referring to the steps in [Troubleshooting application upgrades](service-fabric-application-upgrade-troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="e63d8-159">Fix common problems in application upgrades by referring to the steps in [Troubleshooting application upgrades](service-fabric-application-upgrade-troubleshooting.md).</span></span>

[image1]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/service-fabric/media/service-fabric-application-upgrade-tutorial/upgrade7.png
[image2]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/service-fabric/media/service-fabric-application-upgrade-tutorial/upgrade1.png
[image3]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/service-fabric/media/service-fabric-application-upgrade-tutorial/upgrade5.png
[image4]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/service-fabric/media/service-fabric-application-upgrade-tutorial/upgrade6.png




