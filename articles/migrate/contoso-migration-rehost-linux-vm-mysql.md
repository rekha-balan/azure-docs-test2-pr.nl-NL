---
title: Rehost a Contoso Linux service desk app to Azure and Azure MySQL | Microsoft Docs
description: Learn how Contoso rehosts an on-premises Linux app by migrating it to Azure VMs and Azure MySQL.
author: rayne-wiselman
ms.service: site-recovery
ms.topic: conceptual
ms.date: 09/05/2018
ms.author: raynew
ms.openlocfilehash: 49667251cbce4a3f71d71a6508793a2d4c7aac38
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44869001"
---
# <a name="contoso-migration-rehost-an-on-premises-linux-app-to-azure-vms-and-azure-mysql"></a><span data-ttu-id="0c498-103">Contoso migration: Rehost an on-premises Linux app to Azure VMs and Azure MySQL</span><span class="sxs-lookup"><span data-stu-id="0c498-103">Contoso migration: Rehost an on-premises Linux app to Azure VMs and Azure MySQL</span></span>

<span data-ttu-id="0c498-104">This article shows how Contoso rehosts its on-premises two-tier Linux service desk app (osTicket), by migrating it to Azure and Azure MySQL.</span><span class="sxs-lookup"><span data-stu-id="0c498-104">This article shows how Contoso rehosts its on-premises two-tier Linux service desk app (osTicket), by migrating it to Azure and Azure MySQL.</span></span>

<span data-ttu-id="0c498-105">This document is one in a series of articles that show how the fictitious company Contoso migrates its on-premises resources to the Microsoft Azure cloud.</span><span class="sxs-lookup"><span data-stu-id="0c498-105">This document is one in a series of articles that show how the fictitious company Contoso migrates its on-premises resources to the Microsoft Azure cloud.</span></span> <span data-ttu-id="0c498-106">The series includes background information, and scenarios that illustrate how to set up a migration infrastructure, and run different types of migrations.</span><span class="sxs-lookup"><span data-stu-id="0c498-106">The series includes background information, and scenarios that illustrate how to set up a migration infrastructure, and run different types of migrations.</span></span> <span data-ttu-id="0c498-107">Scenarios grow in complexity.</span><span class="sxs-lookup"><span data-stu-id="0c498-107">Scenarios grow in complexity.</span></span> <span data-ttu-id="0c498-108">We'll add additional articles over time.</span><span class="sxs-lookup"><span data-stu-id="0c498-108">We'll add additional articles over time.</span></span>

<span data-ttu-id="0c498-109">**Article**</span><span class="sxs-lookup"><span data-stu-id="0c498-109">**Article**</span></span> | <span data-ttu-id="0c498-110">**Details**</span><span class="sxs-lookup"><span data-stu-id="0c498-110">**Details**</span></span> | <span data-ttu-id="0c498-111">**Status**</span><span class="sxs-lookup"><span data-stu-id="0c498-111">**Status**</span></span>
--- | --- | ---
[<span data-ttu-id="0c498-112">Article 1: Overview</span><span class="sxs-lookup"><span data-stu-id="0c498-112">Article 1: Overview</span></span>](contoso-migration-overview.md) | <span data-ttu-id="0c498-113">Overview of the article series, Contoso's migration strategy, and the sample apps that are used in the series.</span><span class="sxs-lookup"><span data-stu-id="0c498-113">Overview of the article series, Contoso's migration strategy, and the sample apps that are used in the series.</span></span> | <span data-ttu-id="0c498-114">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-114">Available</span></span>
[<span data-ttu-id="0c498-115">Article 2: Deploy Azure infrastructure</span><span class="sxs-lookup"><span data-stu-id="0c498-115">Article 2: Deploy Azure infrastructure</span></span>](contoso-migration-infrastructure.md) | <span data-ttu-id="0c498-116">Contoso prepares its on-premises infrastructure and its Azure infrastructure for migration.</span><span class="sxs-lookup"><span data-stu-id="0c498-116">Contoso prepares its on-premises infrastructure and its Azure infrastructure for migration.</span></span> <span data-ttu-id="0c498-117">The same infrastructure is used for all migration articles in the series.</span><span class="sxs-lookup"><span data-stu-id="0c498-117">The same infrastructure is used for all migration articles in the series.</span></span> | <span data-ttu-id="0c498-118">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-118">Available</span></span>
[<span data-ttu-id="0c498-119">Article 3: Assess on-premises resources for migration to Azure</span><span class="sxs-lookup"><span data-stu-id="0c498-119">Article 3: Assess on-premises resources for migration to Azure</span></span>](contoso-migration-assessment.md)  | <span data-ttu-id="0c498-120">Contoso runs an assessment of its on-premises SmartHotel360 app running on VMware.</span><span class="sxs-lookup"><span data-stu-id="0c498-120">Contoso runs an assessment of its on-premises SmartHotel360 app running on VMware.</span></span> <span data-ttu-id="0c498-121">Contoso assesses app VMs using the Azure Migrate service, and the app SQL Server database using Data Migration Assistant.</span><span class="sxs-lookup"><span data-stu-id="0c498-121">Contoso assesses app VMs using the Azure Migrate service, and the app SQL Server database using Data Migration Assistant.</span></span> | <span data-ttu-id="0c498-122">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-122">Available</span></span>
[<span data-ttu-id="0c498-123">Article 4: Rehost an app on an Azure VM and SQL Database Managed Instance</span><span class="sxs-lookup"><span data-stu-id="0c498-123">Article 4: Rehost an app on an Azure VM and SQL Database Managed Instance</span></span>](contoso-migration-rehost-vm-sql-managed-instance.md) | <span data-ttu-id="0c498-124">Contoso runs a lift-and-shift migration to Azure for its on-premises SmartHotel360 app.</span><span class="sxs-lookup"><span data-stu-id="0c498-124">Contoso runs a lift-and-shift migration to Azure for its on-premises SmartHotel360 app.</span></span> <span data-ttu-id="0c498-125">Contoso migrates the app front-end VM using [Azure Site Recovery](https://docs.microsoft.com/azure/site-recovery/site-recovery-overview).</span><span class="sxs-lookup"><span data-stu-id="0c498-125">Contoso migrates the app front-end VM using [Azure Site Recovery](https://docs.microsoft.com/azure/site-recovery/site-recovery-overview).</span></span> <span data-ttu-id="0c498-126">Contoso migrates the app database to an Azure SQL Database Managed Instance using the [Azure Database Migration Service](https://docs.microsoft.com/azure/dms/dms-overview).</span><span class="sxs-lookup"><span data-stu-id="0c498-126">Contoso migrates the app database to an Azure SQL Database Managed Instance using the [Azure Database Migration Service](https://docs.microsoft.com/azure/dms/dms-overview).</span></span> | <span data-ttu-id="0c498-127">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-127">Available</span></span>   
[<span data-ttu-id="0c498-128">Article 5: Rehost an app on Azure VMs</span><span class="sxs-lookup"><span data-stu-id="0c498-128">Article 5: Rehost an app on Azure VMs</span></span>](contoso-migration-rehost-vm.md) | <span data-ttu-id="0c498-129">Contoso migrates its SmartHotel360 app VMs to Azure VMs using the Site Recovery service.</span><span class="sxs-lookup"><span data-stu-id="0c498-129">Contoso migrates its SmartHotel360 app VMs to Azure VMs using the Site Recovery service.</span></span> | <span data-ttu-id="0c498-130">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-130">Available</span></span>
[<span data-ttu-id="0c498-131">Article 6: Rehost an app on Azure VMs and in a  SQL Server AlwaysOn availability group</span><span class="sxs-lookup"><span data-stu-id="0c498-131">Article 6: Rehost an app on Azure VMs and in a  SQL Server AlwaysOn availability group</span></span>](contoso-migration-rehost-vm-sql-ag.md) | <span data-ttu-id="0c498-132">Contoso migrates the SmartHotel360 app.</span><span class="sxs-lookup"><span data-stu-id="0c498-132">Contoso migrates the SmartHotel360 app.</span></span> <span data-ttu-id="0c498-133">Contoso uses Site Recovery to migrate the app VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-133">Contoso uses Site Recovery to migrate the app VMs.</span></span> <span data-ttu-id="0c498-134">It uses the Database Migration Service to migrate the app database to a SQL Server cluster that's protected by an AlwaysOn availability group.</span><span class="sxs-lookup"><span data-stu-id="0c498-134">It uses the Database Migration Service to migrate the app database to a SQL Server cluster that's protected by an AlwaysOn availability group.</span></span> | <span data-ttu-id="0c498-135">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-135">Available</span></span> 
[<span data-ttu-id="0c498-136">Article 7: Rehost a Linux app on Azure VMs</span><span class="sxs-lookup"><span data-stu-id="0c498-136">Article 7: Rehost a Linux app on Azure VMs</span></span>](contoso-migration-rehost-linux-vm.md) | <span data-ttu-id="0c498-137">Contoso completes a lift-and-shift migration of the Linux osTicket app to Azure VMs, using Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="0c498-137">Contoso completes a lift-and-shift migration of the Linux osTicket app to Azure VMs, using Azure Site Recovery</span></span> | <span data-ttu-id="0c498-138">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-138">Available</span></span>
<span data-ttu-id="0c498-139">Article 8: Rehost a Linux app on Azure VMs and Azure MySQL</span><span class="sxs-lookup"><span data-stu-id="0c498-139">Article 8: Rehost a Linux app on Azure VMs and Azure MySQL</span></span> | <span data-ttu-id="0c498-140">Contoso migrates the Linux osTicket app to Azure VMs using Azure Site Recovery, and migrates the app database to an Azure MySQL Server instance using MySQL Workbench.</span><span class="sxs-lookup"><span data-stu-id="0c498-140">Contoso migrates the Linux osTicket app to Azure VMs using Azure Site Recovery, and migrates the app database to an Azure MySQL Server instance using MySQL Workbench.</span></span> | <span data-ttu-id="0c498-141">This article</span><span class="sxs-lookup"><span data-stu-id="0c498-141">This article</span></span>
[<span data-ttu-id="0c498-142">Article 9: Refactor an app on Azure Web Apps and Azure SQL database</span><span class="sxs-lookup"><span data-stu-id="0c498-142">Article 9: Refactor an app on Azure Web Apps and Azure SQL database</span></span>](contoso-migration-refactor-web-app-sql.md) | <span data-ttu-id="0c498-143">Contoso migrates the SmartHotel360 app to an Azure Web App, and migrates the app database to an Azure SQL Server instance with Database Migration Assistant</span><span class="sxs-lookup"><span data-stu-id="0c498-143">Contoso migrates the SmartHotel360 app to an Azure Web App, and migrates the app database to an Azure SQL Server instance with Database Migration Assistant</span></span> | <span data-ttu-id="0c498-144">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-144">Available</span></span>
[<span data-ttu-id="0c498-145">Article 10: Refactor a Linux app on Azure Web Apps and Azure MySQL</span><span class="sxs-lookup"><span data-stu-id="0c498-145">Article 10: Refactor a Linux app on Azure Web Apps and Azure MySQL</span></span>](contoso-migration-refactor-linux-app-service-mysql.md) | <span data-ttu-id="0c498-146">Contoso migrates its Linux osTicket app to an Azure web app on multiple Azure regions using Azure Traffic Manager, integrated with GitHub for continuous delivery.</span><span class="sxs-lookup"><span data-stu-id="0c498-146">Contoso migrates its Linux osTicket app to an Azure web app on multiple Azure regions using Azure Traffic Manager, integrated with GitHub for continuous delivery.</span></span> <span data-ttu-id="0c498-147">Contoso migrates the app database to an Azure Database for MySQL instance.</span><span class="sxs-lookup"><span data-stu-id="0c498-147">Contoso migrates the app database to an Azure Database for MySQL instance.</span></span> | <span data-ttu-id="0c498-148">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-148">Available</span></span> 
[<span data-ttu-id="0c498-149">Article 11: Refactor TFS on Azure DevOps Services</span><span class="sxs-lookup"><span data-stu-id="0c498-149">Article 11: Refactor TFS on Azure DevOps Services</span></span>](contoso-migration-tfs-vsts.md) | <span data-ttu-id="0c498-150">Contoso migrates its on-premises Team Foundation Server deployment to Azure DevOps Services in Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-150">Contoso migrates its on-premises Team Foundation Server deployment to Azure DevOps Services in Azure.</span></span> | <span data-ttu-id="0c498-151">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-151">Available</span></span>
[<span data-ttu-id="0c498-152">Article 12: Rearchitect an app on Azure containers and Azure SQL Database</span><span class="sxs-lookup"><span data-stu-id="0c498-152">Article 12: Rearchitect an app on Azure containers and Azure SQL Database</span></span>](contoso-migration-rearchitect-container-sql.md) | <span data-ttu-id="0c498-153">Contoso migrates its SmartHotel app to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-153">Contoso migrates its SmartHotel app to Azure.</span></span> <span data-ttu-id="0c498-154">Then, it rearchitects the app web tier as a Windows container running in Azure Service Fabric, and the database with Azure SQL Database.</span><span class="sxs-lookup"><span data-stu-id="0c498-154">Then, it rearchitects the app web tier as a Windows container running in Azure Service Fabric, and the database with Azure SQL Database.</span></span> | <span data-ttu-id="0c498-155">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-155">Available</span></span>
[<span data-ttu-id="0c498-156">Article 13: Rebuild an app in Azure</span><span class="sxs-lookup"><span data-stu-id="0c498-156">Article 13: Rebuild an app in Azure</span></span>](contoso-migration-rebuild.md) | <span data-ttu-id="0c498-157">Contoso rebuilds its SmartHotel app by using a range of Azure capabilities and services, including Azure App Service, Azure Kubernetes Service (AKS), Azure Functions, Azure Cognitive Services, and Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="0c498-157">Contoso rebuilds its SmartHotel app by using a range of Azure capabilities and services, including Azure App Service, Azure Kubernetes Service (AKS), Azure Functions, Azure Cognitive Services, and Azure Cosmos DB.</span></span> | <span data-ttu-id="0c498-158">Available</span><span class="sxs-lookup"><span data-stu-id="0c498-158">Available</span></span>


<span data-ttu-id="0c498-159">In this article, Contoso migrates a two-tier Linux Apache MySQL PHP (LAMP) service desk app (osTicket) to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-159">In this article, Contoso migrates a two-tier Linux Apache MySQL PHP (LAMP) service desk app (osTicket) to Azure.</span></span> <span data-ttu-id="0c498-160">If you'd like to use this open-source app, you can download it from [GitHub](https://github.com/osTicket/osTicket).</span><span class="sxs-lookup"><span data-stu-id="0c498-160">If you'd like to use this open-source app, you can download it from [GitHub](https://github.com/osTicket/osTicket).</span></span>



## <a name="business-drivers"></a><span data-ttu-id="0c498-161">Business drivers</span><span class="sxs-lookup"><span data-stu-id="0c498-161">Business drivers</span></span>

<span data-ttu-id="0c498-162">The IT Leadership team has worked closely with business partners to understand what they want to achieve:</span><span class="sxs-lookup"><span data-stu-id="0c498-162">The IT Leadership team has worked closely with business partners to understand what they want to achieve:</span></span>

- <span data-ttu-id="0c498-163">**Address business growth**: Contoso is growing, and as a result there's pressure on the on-premises systems and infrastructure.</span><span class="sxs-lookup"><span data-stu-id="0c498-163">**Address business growth**: Contoso is growing, and as a result there's pressure on the on-premises systems and infrastructure.</span></span>
- <span data-ttu-id="0c498-164">**Limit risk**: The service desk app is critical for the business.</span><span class="sxs-lookup"><span data-stu-id="0c498-164">**Limit risk**: The service desk app is critical for the business.</span></span> <span data-ttu-id="0c498-165">Contoso wants to move it to Azure with zero risk.</span><span class="sxs-lookup"><span data-stu-id="0c498-165">Contoso wants to move it to Azure with zero risk.</span></span>
- <span data-ttu-id="0c498-166">**Extend**:  Contoso doesn't want to change the app right now.</span><span class="sxs-lookup"><span data-stu-id="0c498-166">**Extend**:  Contoso doesn't want to change the app right now.</span></span> <span data-ttu-id="0c498-167">It simply wants to keep the app stable.</span><span class="sxs-lookup"><span data-stu-id="0c498-167">It simply wants to keep the app stable.</span></span>


## <a name="migration-goals"></a><span data-ttu-id="0c498-168">Migration goals</span><span class="sxs-lookup"><span data-stu-id="0c498-168">Migration goals</span></span>

<span data-ttu-id="0c498-169">The Contoso cloud team has pinned down goals for this migration, in order to determine the best migration method:</span><span class="sxs-lookup"><span data-stu-id="0c498-169">The Contoso cloud team has pinned down goals for this migration, in order to determine the best migration method:</span></span>

- <span data-ttu-id="0c498-170">After migration, the app in Azure should have the same performance capabilities as it does today in their on-premises VMWare environment.</span><span class="sxs-lookup"><span data-stu-id="0c498-170">After migration, the app in Azure should have the same performance capabilities as it does today in their on-premises VMWare environment.</span></span>  <span data-ttu-id="0c498-171">The app will remain as critical in the cloud as it is on-premises.</span><span class="sxs-lookup"><span data-stu-id="0c498-171">The app will remain as critical in the cloud as it is on-premises.</span></span> 
- <span data-ttu-id="0c498-172">Contoso doesn’t want to invest in this app.</span><span class="sxs-lookup"><span data-stu-id="0c498-172">Contoso doesn’t want to invest in this app.</span></span>  <span data-ttu-id="0c498-173">It's important to the business, but in its current form Contoso simply want to move it safely to the cloud.</span><span class="sxs-lookup"><span data-stu-id="0c498-173">It's important to the business, but in its current form Contoso simply want to move it safely to the cloud.</span></span>
- <span data-ttu-id="0c498-174">Having completed a couple of Windows app migrations, Contoso wants to learn how to use a Linux-based infrastructure in Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-174">Having completed a couple of Windows app migrations, Contoso wants to learn how to use a Linux-based infrastructure in Azure.</span></span>
- <span data-ttu-id="0c498-175">Contoso wants to minimize database admin tasks after the application is moved to the cloud.</span><span class="sxs-lookup"><span data-stu-id="0c498-175">Contoso wants to minimize database admin tasks after the application is moved to the cloud.</span></span>

## <a name="proposed-architecture"></a><span data-ttu-id="0c498-176">Proposed architecture</span><span class="sxs-lookup"><span data-stu-id="0c498-176">Proposed architecture</span></span>

<span data-ttu-id="0c498-177">In this scenario:</span><span class="sxs-lookup"><span data-stu-id="0c498-177">In this scenario:</span></span>

- <span data-ttu-id="0c498-178">The app is tiered across two VMs (OSTICKETWEB and OSTICKETMYSQL).</span><span class="sxs-lookup"><span data-stu-id="0c498-178">The app is tiered across two VMs (OSTICKETWEB and OSTICKETMYSQL).</span></span>
- <span data-ttu-id="0c498-179">The VMs are located on VMware ESXi host **contosohost1.contoso.com** (version 6.5).</span><span class="sxs-lookup"><span data-stu-id="0c498-179">The VMs are located on VMware ESXi host **contosohost1.contoso.com** (version 6.5).</span></span>
- <span data-ttu-id="0c498-180">The VMware environment is managed by vCenter Server 6.5 (**vcenter.contoso.com**), running on a VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-180">The VMware environment is managed by vCenter Server 6.5 (**vcenter.contoso.com**), running on a VM.</span></span>
- <span data-ttu-id="0c498-181">Contoso has an on-premises datacenter (contoso-datacenter), with an on-premises domain controller (**contosodc1**).</span><span class="sxs-lookup"><span data-stu-id="0c498-181">Contoso has an on-premises datacenter (contoso-datacenter), with an on-premises domain controller (**contosodc1**).</span></span>
- <span data-ttu-id="0c498-182">The web tier app on OSTICKETWEB will be migrated to an Azure IaaS VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-182">The web tier app on OSTICKETWEB will be migrated to an Azure IaaS VM.</span></span>
- <span data-ttu-id="0c498-183">The app database will be migrated to the Azure Database for MySQL PaaS service.</span><span class="sxs-lookup"><span data-stu-id="0c498-183">The app database will be migrated to the Azure Database for MySQL PaaS service.</span></span>
- <span data-ttu-id="0c498-184">Since Contoso is migrating a production workload, the resources will reside in the production resource group **ContosoRG**.</span><span class="sxs-lookup"><span data-stu-id="0c498-184">Since Contoso is migrating a production workload, the resources will reside in the production resource group **ContosoRG**.</span></span>
- <span data-ttu-id="0c498-185">The resources will be replicated to the primary region (East US 2), and placed in the production network (VNET-PROD-EUS2):</span><span class="sxs-lookup"><span data-stu-id="0c498-185">The resources will be replicated to the primary region (East US 2), and placed in the production network (VNET-PROD-EUS2):</span></span>
    - <span data-ttu-id="0c498-186">The web VM will reside in the frontend subnet (PROD-FE-EUS2).</span><span class="sxs-lookup"><span data-stu-id="0c498-186">The web VM will reside in the frontend subnet (PROD-FE-EUS2).</span></span>
    - <span data-ttu-id="0c498-187">The database instance will reside in the database subnet (PROD-DB-EUS2).</span><span class="sxs-lookup"><span data-stu-id="0c498-187">The database instance will reside in the database subnet (PROD-DB-EUS2).</span></span>
- <span data-ttu-id="0c498-188">The app database will be migrated to Azure MySQL using MySQL tools.</span><span class="sxs-lookup"><span data-stu-id="0c498-188">The app database will be migrated to Azure MySQL using MySQL tools.</span></span>
- <span data-ttu-id="0c498-189">The on-premises VMs in the Contoso datacenter will be decommissioned after the migration is done.</span><span class="sxs-lookup"><span data-stu-id="0c498-189">The on-premises VMs in the Contoso datacenter will be decommissioned after the migration is done.</span></span>


![Scenario architecture](./media/contoso-migration-rehost-linux-vm-mysql/architecture.png) 


## <a name="migration-process"></a><span data-ttu-id="0c498-191">Migration process</span><span class="sxs-lookup"><span data-stu-id="0c498-191">Migration process</span></span>

<span data-ttu-id="0c498-192">Contoso will complete the migration process as follows:</span><span class="sxs-lookup"><span data-stu-id="0c498-192">Contoso will complete the migration process as follows:</span></span>

<span data-ttu-id="0c498-193">To migrate the web VM:</span><span class="sxs-lookup"><span data-stu-id="0c498-193">To migrate the web VM:</span></span>

1. <span data-ttu-id="0c498-194">As a first step, Contoso sets up the Azure and on-premises infrastructure needed to deploy Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="0c498-194">As a first step, Contoso sets up the Azure and on-premises infrastructure needed to deploy Site Recovery.</span></span>
2. <span data-ttu-id="0c498-195">After preparing the Azure and on-premises components, Contoso sets up and enables replication for the web VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-195">After preparing the Azure and on-premises components, Contoso sets up and enables replication for the web VM.</span></span>
3. <span data-ttu-id="0c498-196">After replication is up-and-running, Contoso migrates the VM by failing it over to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-196">After replication is up-and-running, Contoso migrates the VM by failing it over to Azure.</span></span>

<span data-ttu-id="0c498-197">To migrate the database:</span><span class="sxs-lookup"><span data-stu-id="0c498-197">To migrate the database:</span></span>

1. <span data-ttu-id="0c498-198">Contoso provisions a MySQL instance in Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-198">Contoso provisions a MySQL instance in Azure.</span></span>
2. <span data-ttu-id="0c498-199">Contoso sets up MySQL workbench, and backs up the database locally.</span><span class="sxs-lookup"><span data-stu-id="0c498-199">Contoso sets up MySQL workbench, and backs up the database locally.</span></span>
3. <span data-ttu-id="0c498-200">Contoso then restore the database from the local backup to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-200">Contoso then restore the database from the local backup to Azure.</span></span>

![Migration process](./media/contoso-migration-rehost-linux-vm-mysql/migration-process.png) 


### <a name="azure-services"></a><span data-ttu-id="0c498-202">Azure services</span><span class="sxs-lookup"><span data-stu-id="0c498-202">Azure services</span></span>

<span data-ttu-id="0c498-203">**Service**</span><span class="sxs-lookup"><span data-stu-id="0c498-203">**Service**</span></span> | <span data-ttu-id="0c498-204">**Description**</span><span class="sxs-lookup"><span data-stu-id="0c498-204">**Description**</span></span> | <span data-ttu-id="0c498-205">**Cost**</span><span class="sxs-lookup"><span data-stu-id="0c498-205">**Cost**</span></span>
--- | --- | ---
[<span data-ttu-id="0c498-206">Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="0c498-206">Azure Site Recovery</span></span>](https://docs.microsoft.com/azure/site-recovery/) | <span data-ttu-id="0c498-207">The service orchestrates and manages migration and disaster recovery for Azure VMs, and on-premises VMs and physical servers.</span><span class="sxs-lookup"><span data-stu-id="0c498-207">The service orchestrates and manages migration and disaster recovery for Azure VMs, and on-premises VMs and physical servers.</span></span>  | <span data-ttu-id="0c498-208">During replication to Azure, Azure Storage charges are incurred.</span><span class="sxs-lookup"><span data-stu-id="0c498-208">During replication to Azure, Azure Storage charges are incurred.</span></span>  <span data-ttu-id="0c498-209">Azure VMs are created, and incur charges, when failover occurs.</span><span class="sxs-lookup"><span data-stu-id="0c498-209">Azure VMs are created, and incur charges, when failover occurs.</span></span> <span data-ttu-id="0c498-210">[Learn more](https://azure.microsoft.com/pricing/details/site-recovery/) about charges and pricing.</span><span class="sxs-lookup"><span data-stu-id="0c498-210">[Learn more](https://azure.microsoft.com/pricing/details/site-recovery/) about charges and pricing.</span></span>
[<span data-ttu-id="0c498-211">Azure Database for MySQL</span><span class="sxs-lookup"><span data-stu-id="0c498-211">Azure Database for MySQL</span></span>](https://docs.microsoft.com/azure/mysql/) | <span data-ttu-id="0c498-212">The database is based on the open-source MySQL Server engine.</span><span class="sxs-lookup"><span data-stu-id="0c498-212">The database is based on the open-source MySQL Server engine.</span></span> <span data-ttu-id="0c498-213">It provides a fully-managed, enterprise-ready community MySQL database, as a service for app development and deployment.</span><span class="sxs-lookup"><span data-stu-id="0c498-213">It provides a fully-managed, enterprise-ready community MySQL database, as a service for app development and deployment.</span></span> 

 
## <a name="prerequisites"></a><span data-ttu-id="0c498-214">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="0c498-214">Prerequisites</span></span>

<span data-ttu-id="0c498-215">Here's what Contoso needs for this scenario.</span><span class="sxs-lookup"><span data-stu-id="0c498-215">Here's what Contoso needs for this scenario.</span></span>

<span data-ttu-id="0c498-216">**Requirements**</span><span class="sxs-lookup"><span data-stu-id="0c498-216">**Requirements**</span></span> | <span data-ttu-id="0c498-217">**Details**</span><span class="sxs-lookup"><span data-stu-id="0c498-217">**Details**</span></span>
--- | ---
<span data-ttu-id="0c498-218">**Azure subscription**</span><span class="sxs-lookup"><span data-stu-id="0c498-218">**Azure subscription**</span></span> | <span data-ttu-id="0c498-219">Contoso created subscriptions during an earlier article.</span><span class="sxs-lookup"><span data-stu-id="0c498-219">Contoso created subscriptions during an earlier article.</span></span> <span data-ttu-id="0c498-220">If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/pricing/free-trial/).</span><span class="sxs-lookup"><span data-stu-id="0c498-220">If you don't have an Azure subscription, create a [free account](https://azure.microsoft.com/pricing/free-trial/).</span></span><br/><br/> <span data-ttu-id="0c498-221">If you create a free account, you're the administrator of your subscription and can perform all actions.</span><span class="sxs-lookup"><span data-stu-id="0c498-221">If you create a free account, you're the administrator of your subscription and can perform all actions.</span></span><br/><br/> <span data-ttu-id="0c498-222">If you use an existing subscription and you're not the administrator, you need to work with the admin to assign you Owner or Contributor permissions.</span><span class="sxs-lookup"><span data-stu-id="0c498-222">If you use an existing subscription and you're not the administrator, you need to work with the admin to assign you Owner or Contributor permissions.</span></span><br/><br/> <span data-ttu-id="0c498-223">If you need more granular permissions, review [this article](../site-recovery/site-recovery-role-based-linked-access-control.md).</span><span class="sxs-lookup"><span data-stu-id="0c498-223">If you need more granular permissions, review [this article](../site-recovery/site-recovery-role-based-linked-access-control.md).</span></span> 
<span data-ttu-id="0c498-224">**Azure infrastructure**</span><span class="sxs-lookup"><span data-stu-id="0c498-224">**Azure infrastructure**</span></span> | <span data-ttu-id="0c498-225">Contoso set up the Azure infrastructure as described in [Azure infrastructure for migration](contoso-migration-infrastructure.md).</span><span class="sxs-lookup"><span data-stu-id="0c498-225">Contoso set up the Azure infrastructure as described in [Azure infrastructure for migration](contoso-migration-infrastructure.md).</span></span><br/><br/> <span data-ttu-id="0c498-226">Learn more about specific [network](https://docs.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix#network) and [storage](https://docs.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix#storage) requirements for Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="0c498-226">Learn more about specific [network](https://docs.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix#network) and [storage](https://docs.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix#storage) requirements for Site Recovery.</span></span>
<span data-ttu-id="0c498-227">**On-premises servers**</span><span class="sxs-lookup"><span data-stu-id="0c498-227">**On-premises servers**</span></span> | <span data-ttu-id="0c498-228">The on-premises vCenter server should be running version 5.5, 6.0, or 6.5</span><span class="sxs-lookup"><span data-stu-id="0c498-228">The on-premises vCenter server should be running version 5.5, 6.0, or 6.5</span></span><br/><br/> <span data-ttu-id="0c498-229">An ESXi host running version 5.5, 6.0 or 6.5</span><span class="sxs-lookup"><span data-stu-id="0c498-229">An ESXi host running version 5.5, 6.0 or 6.5</span></span><br/><br/> <span data-ttu-id="0c498-230">One or more VMware VMs running on the ESXi host.</span><span class="sxs-lookup"><span data-stu-id="0c498-230">One or more VMware VMs running on the ESXi host.</span></span>
<span data-ttu-id="0c498-231">**On-premises VMs**</span><span class="sxs-lookup"><span data-stu-id="0c498-231">**On-premises VMs**</span></span> | <span data-ttu-id="0c498-232">[Review Linux VM requirements](https://docs.microsoft.com//azure/site-recovery/vmware-physical-azure-support-matrix#replicated-machines) that are supported for migration with Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="0c498-232">[Review Linux VM requirements](https://docs.microsoft.com//azure/site-recovery/vmware-physical-azure-support-matrix#replicated-machines) that are supported for migration with Site Recovery.</span></span><br/><br/> <span data-ttu-id="0c498-233">Verify supported [Linux file and storage systems](https://docs.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix#linux-file-systemsguest-storage).</span><span class="sxs-lookup"><span data-stu-id="0c498-233">Verify supported [Linux file and storage systems](https://docs.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix#linux-file-systemsguest-storage).</span></span><br/><br/> <span data-ttu-id="0c498-234">VMs must meet [Azure requirements](https://docs.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix#azure-vm-requirements).</span><span class="sxs-lookup"><span data-stu-id="0c498-234">VMs must meet [Azure requirements](https://docs.microsoft.com/azure/site-recovery/vmware-physical-azure-support-matrix#azure-vm-requirements).</span></span>


## <a name="scenario-steps"></a><span data-ttu-id="0c498-235">Scenario steps</span><span class="sxs-lookup"><span data-stu-id="0c498-235">Scenario steps</span></span>

<span data-ttu-id="0c498-236">Here's how Contoso admins will complete the migration:</span><span class="sxs-lookup"><span data-stu-id="0c498-236">Here's how Contoso admins will complete the migration:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="0c498-237">**Step 1: Prepare Azure for Site Recovery**: They create an Azure storage account to hold replicated data, and create a Recovery Services vault.</span><span class="sxs-lookup"><span data-stu-id="0c498-237">**Step 1: Prepare Azure for Site Recovery**: They create an Azure storage account to hold replicated data, and create a Recovery Services vault.</span></span>
> * <span data-ttu-id="0c498-238">**Step 2: Prepare on-premises VMware for Site Recovery**: They prepare accounts for VM discovery and agent installation, and prepare to connect to Azure VMs after failover.</span><span class="sxs-lookup"><span data-stu-id="0c498-238">**Step 2: Prepare on-premises VMware for Site Recovery**: They prepare accounts for VM discovery and agent installation, and prepare to connect to Azure VMs after failover.</span></span>
 * <span data-ttu-id="0c498-239">**Step 3: Provision the database]**: In Azure, they provision an instance of Azure MySQL database.</span><span class="sxs-lookup"><span data-stu-id="0c498-239">**Step 3: Provision the database]**: In Azure, they provision an instance of Azure MySQL database.</span></span>
> * <span data-ttu-id="0c498-240">**Step 4: Replicate VMs**: They configure the Site Recovery source and target environment, set up a replication policy, and start replicating VMs to Azure storage.</span><span class="sxs-lookup"><span data-stu-id="0c498-240">**Step 4: Replicate VMs**: They configure the Site Recovery source and target environment, set up a replication policy, and start replicating VMs to Azure storage.</span></span>
> * <span data-ttu-id="0c498-241">**Step 5: Migrate the database**: They set up migration with MySQL tools.</span><span class="sxs-lookup"><span data-stu-id="0c498-241">**Step 5: Migrate the database**: They set up migration with MySQL tools.</span></span>
> * <span data-ttu-id="0c498-242">**Step 6: Migrate the VMs with Site Recovery**: Lastly, they run a test failover to make sure everything's working, and then run a full failover to migrate the VMs to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-242">**Step 6: Migrate the VMs with Site Recovery**: Lastly, they run a test failover to make sure everything's working, and then run a full failover to migrate the VMs to Azure.</span></span>




## <a name="step-1-prepare-azure-for-the-site-recovery-service"></a><span data-ttu-id="0c498-243">Step 1: Prepare Azure for the Site Recovery service</span><span class="sxs-lookup"><span data-stu-id="0c498-243">Step 1: Prepare Azure for the Site Recovery service</span></span>

<span data-ttu-id="0c498-244">Contoso needs a couple of Azure components for Site Recovery:</span><span class="sxs-lookup"><span data-stu-id="0c498-244">Contoso needs a couple of Azure components for Site Recovery:</span></span>

- <span data-ttu-id="0c498-245">A VNet in which failed over resources are located.</span><span class="sxs-lookup"><span data-stu-id="0c498-245">A VNet in which failed over resources are located.</span></span> <span data-ttu-id="0c498-246">Contoso already created the VNet during [Azure infrastructure deployment](contoso-migration-infrastructure.md)</span><span class="sxs-lookup"><span data-stu-id="0c498-246">Contoso already created the VNet during [Azure infrastructure deployment](contoso-migration-infrastructure.md)</span></span>
- <span data-ttu-id="0c498-247">A new Azure storage account to hold replicated data.</span><span class="sxs-lookup"><span data-stu-id="0c498-247">A new Azure storage account to hold replicated data.</span></span> 
- <span data-ttu-id="0c498-248">A Recovery Services vault in Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-248">A Recovery Services vault in Azure.</span></span>

<span data-ttu-id="0c498-249">The Contoso admins create a storage account and vault as follows:</span><span class="sxs-lookup"><span data-stu-id="0c498-249">The Contoso admins create a storage account and vault as follows:</span></span>

1. <span data-ttu-id="0c498-250">They create a storage account (**contosovmsacc20180528**) in the East US 2 region.</span><span class="sxs-lookup"><span data-stu-id="0c498-250">They create a storage account (**contosovmsacc20180528**) in the East US 2 region.</span></span>

    - <span data-ttu-id="0c498-251">The storage account must be in the same region as the Recovery Services vault.</span><span class="sxs-lookup"><span data-stu-id="0c498-251">The storage account must be in the same region as the Recovery Services vault.</span></span>
    - <span data-ttu-id="0c498-252">They use a general purpose account, with standard storage, and LRS replication.</span><span class="sxs-lookup"><span data-stu-id="0c498-252">They use a general purpose account, with standard storage, and LRS replication.</span></span>

    ![Site Recovery storage](./media/contoso-migration-rehost-linux-vm-mysql/asr-storage.png)

3. <span data-ttu-id="0c498-254">With the network and storage account in place, they create a vault (ContosoMigrationVault), and place it in the **ContosoFailoverRG** resource group, in the primary East US 2 region.</span><span class="sxs-lookup"><span data-stu-id="0c498-254">With the network and storage account in place, they create a vault (ContosoMigrationVault), and place it in the **ContosoFailoverRG** resource group, in the primary East US 2 region.</span></span>

    ![Recovery Services vault](./media/contoso-migration-rehost-linux-vm-mysql/asr-vault.png)

<span data-ttu-id="0c498-256">**Need more help?**</span><span class="sxs-lookup"><span data-stu-id="0c498-256">**Need more help?**</span></span>

<span data-ttu-id="0c498-257">[Learn about](https://docs.microsoft.com/azure/site-recovery/tutorial-prepare-azure) setting up Azure for Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="0c498-257">[Learn about](https://docs.microsoft.com/azure/site-recovery/tutorial-prepare-azure) setting up Azure for Site Recovery.</span></span>


## <a name="step-2-prepare-on-premises-vmware-for-site-recovery"></a><span data-ttu-id="0c498-258">Step 2: Prepare on-premises VMware for Site Recovery</span><span class="sxs-lookup"><span data-stu-id="0c498-258">Step 2: Prepare on-premises VMware for Site Recovery</span></span>

<span data-ttu-id="0c498-259">Contoso admins prepare the on-premises VMware infrastructure as follows:</span><span class="sxs-lookup"><span data-stu-id="0c498-259">Contoso admins prepare the on-premises VMware infrastructure as follows:</span></span>

- <span data-ttu-id="0c498-260">They create an account on the vCenter server, to automate VM discovery.</span><span class="sxs-lookup"><span data-stu-id="0c498-260">They create an account on the vCenter server, to automate VM discovery.</span></span>
- <span data-ttu-id="0c498-261">They create an account that allows automatic installation of the Mobility service on VMware VMs that will be replicated.</span><span class="sxs-lookup"><span data-stu-id="0c498-261">They create an account that allows automatic installation of the Mobility service on VMware VMs that will be replicated.</span></span>
- <span data-ttu-id="0c498-262">They prepare on-premises VMs, so that they can connect to Azure VMs when they're created after the migration.</span><span class="sxs-lookup"><span data-stu-id="0c498-262">They prepare on-premises VMs, so that they can connect to Azure VMs when they're created after the migration.</span></span>


### <a name="prepare-an-account-for-automatic-discovery"></a><span data-ttu-id="0c498-263">Prepare an account for automatic discovery</span><span class="sxs-lookup"><span data-stu-id="0c498-263">Prepare an account for automatic discovery</span></span>

<span data-ttu-id="0c498-264">Site Recovery needs access to VMware servers to:</span><span class="sxs-lookup"><span data-stu-id="0c498-264">Site Recovery needs access to VMware servers to:</span></span>

- <span data-ttu-id="0c498-265">Automatically discover VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-265">Automatically discover VMs.</span></span> <span data-ttu-id="0c498-266">At least a read-only account is required.</span><span class="sxs-lookup"><span data-stu-id="0c498-266">At least a read-only account is required.</span></span>
- <span data-ttu-id="0c498-267">Orchestrate replication, failover, and failback.</span><span class="sxs-lookup"><span data-stu-id="0c498-267">Orchestrate replication, failover, and failback.</span></span> <span data-ttu-id="0c498-268">You need an account that can run operations such as creating and removing disks, and turning on VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-268">You need an account that can run operations such as creating and removing disks, and turning on VMs.</span></span>

<span data-ttu-id="0c498-269">Contoso admins set up the account as follows:</span><span class="sxs-lookup"><span data-stu-id="0c498-269">Contoso admins set up the account as follows:</span></span>

1. <span data-ttu-id="0c498-270">They create a role at the vCenter level.</span><span class="sxs-lookup"><span data-stu-id="0c498-270">They create a role at the vCenter level.</span></span>
2. <span data-ttu-id="0c498-271">They then assign that role the required permissions.</span><span class="sxs-lookup"><span data-stu-id="0c498-271">They then assign that role the required permissions.</span></span>


### <a name="prepare-an-account-for-mobility-service-installation"></a><span data-ttu-id="0c498-272">Prepare an account for Mobility service installation</span><span class="sxs-lookup"><span data-stu-id="0c498-272">Prepare an account for Mobility service installation</span></span>

<span data-ttu-id="0c498-273">The Mobility service must be installed on each VM that Contoso wants to migrate.</span><span class="sxs-lookup"><span data-stu-id="0c498-273">The Mobility service must be installed on each VM that Contoso wants to migrate.</span></span>

- <span data-ttu-id="0c498-274">Site Recovery can do an automatic push installation of this component when you enable replication for the VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-274">Site Recovery can do an automatic push installation of this component when you enable replication for the VMs.</span></span>
- <span data-ttu-id="0c498-275">For automatic installation.</span><span class="sxs-lookup"><span data-stu-id="0c498-275">For automatic installation.</span></span> <span data-ttu-id="0c498-276">Site Recovery needs an account with permissions to access the VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-276">Site Recovery needs an account with permissions to access the VM.</span></span> 
- <span data-ttu-id="0c498-277">Account details are input during replication setup.</span><span class="sxs-lookup"><span data-stu-id="0c498-277">Account details are input during replication setup.</span></span> 
- <span data-ttu-id="0c498-278">The account can be domain or local account, as long as it has installation permissions.</span><span class="sxs-lookup"><span data-stu-id="0c498-278">The account can be domain or local account, as long as it has installation permissions.</span></span>


### <a name="prepare-to-connect-to-azure-vms-after-failover"></a><span data-ttu-id="0c498-279">Prepare to connect to Azure VMs after failover</span><span class="sxs-lookup"><span data-stu-id="0c498-279">Prepare to connect to Azure VMs after failover</span></span>

<span data-ttu-id="0c498-280">After failover to Azure, Contoso wants to be able to connect to the Azure VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-280">After failover to Azure, Contoso wants to be able to connect to the Azure VMs.</span></span> <span data-ttu-id="0c498-281">To do this, Contoso admins need to do the following:</span><span class="sxs-lookup"><span data-stu-id="0c498-281">To do this, Contoso admins need to do the following:</span></span>

- <span data-ttu-id="0c498-282">To access over the internet, they enable SSH on the on-premises Linux VM before the migration.</span><span class="sxs-lookup"><span data-stu-id="0c498-282">To access over the internet, they enable SSH on the on-premises Linux VM before the migration.</span></span>  <span data-ttu-id="0c498-283">For Ubuntu this can be completed using the following command: **Sudo apt-get ssh install -y**.</span><span class="sxs-lookup"><span data-stu-id="0c498-283">For Ubuntu this can be completed using the following command: **Sudo apt-get ssh install -y**.</span></span>
- <span data-ttu-id="0c498-284">After the failover, they should check **Boot diagnostics** to view a screenshot of the VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-284">After the failover, they should check **Boot diagnostics** to view a screenshot of the VM.</span></span>
- <span data-ttu-id="0c498-285">If this doesn't work, they need to verify that the VM is running, and review these [troubleshooting tips](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span><span class="sxs-lookup"><span data-stu-id="0c498-285">If this doesn't work, they need to verify that the VM is running, and review these [troubleshooting tips](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span></span>

<span data-ttu-id="0c498-286">**Need more help?**</span><span class="sxs-lookup"><span data-stu-id="0c498-286">**Need more help?**</span></span>

- <span data-ttu-id="0c498-287">[Learn about](https://docs.microsoft.com/azure/site-recovery/vmware-azure-tutorial-prepare-on-premises#prepare-an-account-for-automatic-discovery) creating and assigning a role for automatic discovery.</span><span class="sxs-lookup"><span data-stu-id="0c498-287">[Learn about](https://docs.microsoft.com/azure/site-recovery/vmware-azure-tutorial-prepare-on-premises#prepare-an-account-for-automatic-discovery) creating and assigning a role for automatic discovery.</span></span>
- <span data-ttu-id="0c498-288">[Learn about](https://docs.microsoft.com/azure/site-recovery/vmware-azure-tutorial-prepare-on-premises#prepare-an-account-for-mobility-service-installation) creating an account for push installation of the Mobility service.</span><span class="sxs-lookup"><span data-stu-id="0c498-288">[Learn about](https://docs.microsoft.com/azure/site-recovery/vmware-azure-tutorial-prepare-on-premises#prepare-an-account-for-mobility-service-installation) creating an account for push installation of the Mobility service.</span></span>


## <a name="step-3-provision-azure-database-for-mysql"></a><span data-ttu-id="0c498-289">Step 3: Provision Azure Database for MySQL</span><span class="sxs-lookup"><span data-stu-id="0c498-289">Step 3: Provision Azure Database for MySQL</span></span>

<span data-ttu-id="0c498-290">Contoso admins provision a MySQL database instance in the primary East US 2 region.</span><span class="sxs-lookup"><span data-stu-id="0c498-290">Contoso admins provision a MySQL database instance in the primary East US 2 region.</span></span>

1. <span data-ttu-id="0c498-291">In the Azure portal, they create an Azure Database for MySQL resource.</span><span class="sxs-lookup"><span data-stu-id="0c498-291">In the Azure portal, they create an Azure Database for MySQL resource.</span></span> 

    ![MySQL](./media/contoso-migration-rehost-linux-vm-mysql/mysql-1.png)

2. <span data-ttu-id="0c498-293">They add the name **contosoosticket** for the Azure database.</span><span class="sxs-lookup"><span data-stu-id="0c498-293">They add the name **contosoosticket** for the Azure database.</span></span> <span data-ttu-id="0c498-294">They add the database to the production resource group **ContosoRG**, and specify credentials for it.</span><span class="sxs-lookup"><span data-stu-id="0c498-294">They add the database to the production resource group **ContosoRG**, and specify credentials for it.</span></span>
3. <span data-ttu-id="0c498-295">The on-premises MySQL database is version 5.7, so they select this version for compatibility.</span><span class="sxs-lookup"><span data-stu-id="0c498-295">The on-premises MySQL database is version 5.7, so they select this version for compatibility.</span></span> <span data-ttu-id="0c498-296">They use the default sizes, which match their database requirements.</span><span class="sxs-lookup"><span data-stu-id="0c498-296">They use the default sizes, which match their database requirements.</span></span>

     ![MySQL](./media/contoso-migration-rehost-linux-vm-mysql/mysql-2.png)

4. <span data-ttu-id="0c498-298">For **Backup Redundancy Options**, they select to use **Geo-Redundant**.</span><span class="sxs-lookup"><span data-stu-id="0c498-298">For **Backup Redundancy Options**, they select to use **Geo-Redundant**.</span></span> <span data-ttu-id="0c498-299">This option allows them to restore the database in their secondary Central US region if an outage occurs.</span><span class="sxs-lookup"><span data-stu-id="0c498-299">This option allows them to restore the database in their secondary Central US region if an outage occurs.</span></span> <span data-ttu-id="0c498-300">They can only configure this option when they provision the database.</span><span class="sxs-lookup"><span data-stu-id="0c498-300">They can only configure this option when they provision the database.</span></span>

     ![Redundancy](./media/contoso-migration-rehost-linux-vm-mysql/db-redundancy.png)

4. <span data-ttu-id="0c498-302">In the **VNET-PROD-EUS2** network > **Service endpoints**, they add a service endpoint (a database subnet) for the SQL service.</span><span class="sxs-lookup"><span data-stu-id="0c498-302">In the **VNET-PROD-EUS2** network > **Service endpoints**, they add a service endpoint (a database subnet) for the SQL service.</span></span>

    ![MySQL](./media/contoso-migration-rehost-linux-vm-mysql/mysql-3.png)

5. <span data-ttu-id="0c498-304">After adding the subnet, they create a virtual network rule that allows access from the database subnet in the production network.</span><span class="sxs-lookup"><span data-stu-id="0c498-304">After adding the subnet, they create a virtual network rule that allows access from the database subnet in the production network.</span></span>

    ![MySQL](./media/contoso-migration-rehost-linux-vm-mysql/mysql-4.png)


## <a name="step-4-replicate-the-on-premises-vms"></a><span data-ttu-id="0c498-306">Step 4: Replicate the on-premises VMs</span><span class="sxs-lookup"><span data-stu-id="0c498-306">Step 4: Replicate the on-premises VMs</span></span>

<span data-ttu-id="0c498-307">Before they can migrate the web VM to Azure, Contoso admins set up and enable replication.</span><span class="sxs-lookup"><span data-stu-id="0c498-307">Before they can migrate the web VM to Azure, Contoso admins set up and enable replication.</span></span>

### <a name="set-a-protection-goal"></a><span data-ttu-id="0c498-308">Set a protection goal</span><span class="sxs-lookup"><span data-stu-id="0c498-308">Set a protection goal</span></span>

1. <span data-ttu-id="0c498-309">In the vault, under the vault name (ContosoVMVault) they set a replication goal (**Getting Started** > **Site Recovery** > **Prepare infrastructure**.</span><span class="sxs-lookup"><span data-stu-id="0c498-309">In the vault, under the vault name (ContosoVMVault) they set a replication goal (**Getting Started** > **Site Recovery** > **Prepare infrastructure**.</span></span>
2. <span data-ttu-id="0c498-310">They specify that their machines are located on-premises, that they're VMware VMs, and that they want to replicate to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-310">They specify that their machines are located on-premises, that they're VMware VMs, and that they want to replicate to Azure.</span></span>

    ![Replication goal](./media/contoso-migration-rehost-linux-vm-mysql/replication-goal.png)

### <a name="confirm-deployment-planning"></a><span data-ttu-id="0c498-312">Confirm deployment planning</span><span class="sxs-lookup"><span data-stu-id="0c498-312">Confirm deployment planning</span></span>

<span data-ttu-id="0c498-313">To continue, they confirm that they've completed deployment planning, by selecting **Yes, I have done it**.</span><span class="sxs-lookup"><span data-stu-id="0c498-313">To continue, they confirm that they've completed deployment planning, by selecting **Yes, I have done it**.</span></span> <span data-ttu-id="0c498-314">Contoso are only migrating a single VM in this scenario, and don't need deployment planning.</span><span class="sxs-lookup"><span data-stu-id="0c498-314">Contoso are only migrating a single VM in this scenario, and don't need deployment planning.</span></span>

### <a name="set-up-the-source-environment"></a><span data-ttu-id="0c498-315">Set up the source environment</span><span class="sxs-lookup"><span data-stu-id="0c498-315">Set up the source environment</span></span>

<span data-ttu-id="0c498-316">Contoso admins now configure the source environment.</span><span class="sxs-lookup"><span data-stu-id="0c498-316">Contoso admins now configure the source environment.</span></span> <span data-ttu-id="0c498-317">To do this, using an OVF template they deploy a Site Recovery configuration server as a highly available, on-premises VMware VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-317">To do this, using an OVF template they deploy a Site Recovery configuration server as a highly available, on-premises VMware VM.</span></span> <span data-ttu-id="0c498-318">After the configuration server is up and running, they register it in the vault.</span><span class="sxs-lookup"><span data-stu-id="0c498-318">After the configuration server is up and running, they register it in the vault.</span></span>

<span data-ttu-id="0c498-319">The configuration server runs a number of components:</span><span class="sxs-lookup"><span data-stu-id="0c498-319">The configuration server runs a number of components:</span></span>

- <span data-ttu-id="0c498-320">The configuration server component that coordinates communications between on-premises and Azure and manages data replication.</span><span class="sxs-lookup"><span data-stu-id="0c498-320">The configuration server component that coordinates communications between on-premises and Azure and manages data replication.</span></span>
- <span data-ttu-id="0c498-321">The process server that acts as a replication gateway.</span><span class="sxs-lookup"><span data-stu-id="0c498-321">The process server that acts as a replication gateway.</span></span> <span data-ttu-id="0c498-322">It receives replication data; optimizes it with caching, compression, and encryption; and sends it to Azure storage.</span><span class="sxs-lookup"><span data-stu-id="0c498-322">It receives replication data; optimizes it with caching, compression, and encryption; and sends it to Azure storage.</span></span>
- <span data-ttu-id="0c498-323">The process server also installs Mobility Service on VMs you want to replicate and performs automatic discovery of on-premises VMware VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-323">The process server also installs Mobility Service on VMs you want to replicate and performs automatic discovery of on-premises VMware VMs.</span></span>

<span data-ttu-id="0c498-324">Contoso admins do this as follows:</span><span class="sxs-lookup"><span data-stu-id="0c498-324">Contoso admins do this as follows:</span></span>


1. <span data-ttu-id="0c498-325">They download the OVF template from **Prepare Infrastructure** > **Source** > **Configuration Server**.</span><span class="sxs-lookup"><span data-stu-id="0c498-325">They download the OVF template from **Prepare Infrastructure** > **Source** > **Configuration Server**.</span></span>
    
    ![Download OVF](./media/contoso-migration-rehost-linux-vm-mysql/add-cs.png)

2. <span data-ttu-id="0c498-327">They import the template into VMware to create the VM, and deploy the VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-327">They import the template into VMware to create the VM, and deploy the VM.</span></span>

    ![OVF template](./media/contoso-migration-rehost-linux-vm-mysql/vcenter-wizard.png)

3. <span data-ttu-id="0c498-329">When they turn on the VM for the first time, it boots up into a Windows Server 2016 installation experience.</span><span class="sxs-lookup"><span data-stu-id="0c498-329">When they turn on the VM for the first time, it boots up into a Windows Server 2016 installation experience.</span></span> <span data-ttu-id="0c498-330">They accept the license agreement, and enter an administrator password.</span><span class="sxs-lookup"><span data-stu-id="0c498-330">They accept the license agreement, and enter an administrator password.</span></span>
4. <span data-ttu-id="0c498-331">After the installation finishes, they sign in to the VM as the administrator.</span><span class="sxs-lookup"><span data-stu-id="0c498-331">After the installation finishes, they sign in to the VM as the administrator.</span></span> <span data-ttu-id="0c498-332">At first sign-in, the Azure Site Recovery Configuration Tool runs by default.</span><span class="sxs-lookup"><span data-stu-id="0c498-332">At first sign-in, the Azure Site Recovery Configuration Tool runs by default.</span></span>
5. <span data-ttu-id="0c498-333">In the tool, they specify a name to use for registering the configuration server in the vault.</span><span class="sxs-lookup"><span data-stu-id="0c498-333">In the tool, they specify a name to use for registering the configuration server in the vault.</span></span>
6. <span data-ttu-id="0c498-334">The tool checks that the VM can connect to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-334">The tool checks that the VM can connect to Azure.</span></span>
7. <span data-ttu-id="0c498-335">After the connection is established, they sign in to the Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="0c498-335">After the connection is established, they sign in to the Azure subscription.</span></span> <span data-ttu-id="0c498-336">The credentials must have access to the vault in which they'll register the configuration server.</span><span class="sxs-lookup"><span data-stu-id="0c498-336">The credentials must have access to the vault in which they'll register the configuration server.</span></span>

    ![Register configuration server](./media/contoso-migration-rehost-linux-vm-mysql/config-server-register2.png)

8. <span data-ttu-id="0c498-338">The tool performs some configuration tasks and then reboots.</span><span class="sxs-lookup"><span data-stu-id="0c498-338">The tool performs some configuration tasks and then reboots.</span></span>
9. <span data-ttu-id="0c498-339">They sign in to the machine again, and the Configuration Server Management Wizard starts automatically.</span><span class="sxs-lookup"><span data-stu-id="0c498-339">They sign in to the machine again, and the Configuration Server Management Wizard starts automatically.</span></span>
10. <span data-ttu-id="0c498-340">In the wizard, they select the NIC to receive replication traffic.</span><span class="sxs-lookup"><span data-stu-id="0c498-340">In the wizard, they select the NIC to receive replication traffic.</span></span> <span data-ttu-id="0c498-341">This setting can't be changed after it's configured.</span><span class="sxs-lookup"><span data-stu-id="0c498-341">This setting can't be changed after it's configured.</span></span>
11. <span data-ttu-id="0c498-342">They select the subscription, resource group, and vault in which to register the configuration server.</span><span class="sxs-lookup"><span data-stu-id="0c498-342">They select the subscription, resource group, and vault in which to register the configuration server.</span></span>

    ![vault](./media/contoso-migration-rehost-linux-vm-mysql/cswiz1.png) 

12. <span data-ttu-id="0c498-344">Now, they download and install MySQL Server, and VMWare PowerCLI.</span><span class="sxs-lookup"><span data-stu-id="0c498-344">Now, they download and install MySQL Server, and VMWare PowerCLI.</span></span> 
13. <span data-ttu-id="0c498-345">After validation, they specify the FQDN or IP address of the vCenter server or vSphere host.</span><span class="sxs-lookup"><span data-stu-id="0c498-345">After validation, they specify the FQDN or IP address of the vCenter server or vSphere host.</span></span> <span data-ttu-id="0c498-346">They leave the default port, and specify a friendly name for the vCenter server.</span><span class="sxs-lookup"><span data-stu-id="0c498-346">They leave the default port, and specify a friendly name for the vCenter server.</span></span>
14. <span data-ttu-id="0c498-347">They input the account that they created for automatic discovery, and the credentials that Site Recovery will use to automatically install the Mobility Service.</span><span class="sxs-lookup"><span data-stu-id="0c498-347">They input the account that they created for automatic discovery, and the credentials that Site Recovery will use to automatically install the Mobility Service.</span></span> 

    ![vCenter](./media/contoso-migration-rehost-linux-vm-mysql/cswiz2.png)

14. <span data-ttu-id="0c498-349">After registration finishes, in the Azure portal, they check that the configuration server and VMware server are listed on the **Source** page in the vault.</span><span class="sxs-lookup"><span data-stu-id="0c498-349">After registration finishes, in the Azure portal, they check that the configuration server and VMware server are listed on the **Source** page in the vault.</span></span> <span data-ttu-id="0c498-350">Discovery can take 15 minutes or more.</span><span class="sxs-lookup"><span data-stu-id="0c498-350">Discovery can take 15 minutes or more.</span></span> 
15. <span data-ttu-id="0c498-351">With everything in place, Site Recovery connects to VMware servers, and discovers VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-351">With everything in place, Site Recovery connects to VMware servers, and discovers VMs.</span></span>

### <a name="set-up-the-target"></a><span data-ttu-id="0c498-352">Set up the target</span><span class="sxs-lookup"><span data-stu-id="0c498-352">Set up the target</span></span>

<span data-ttu-id="0c498-353">Now Contoso admins input target replication settings.</span><span class="sxs-lookup"><span data-stu-id="0c498-353">Now Contoso admins input target replication settings.</span></span>

1. <span data-ttu-id="0c498-354">In **Prepare infrastructure** > **Target**, they select the target settings.</span><span class="sxs-lookup"><span data-stu-id="0c498-354">In **Prepare infrastructure** > **Target**, they select the target settings.</span></span>
2. <span data-ttu-id="0c498-355">Site Recovery checks that there's an Azure storage account and network in the specified target.</span><span class="sxs-lookup"><span data-stu-id="0c498-355">Site Recovery checks that there's an Azure storage account and network in the specified target.</span></span>


### <a name="create-a-replication-policy"></a><span data-ttu-id="0c498-356">Create a replication policy</span><span class="sxs-lookup"><span data-stu-id="0c498-356">Create a replication policy</span></span>

<span data-ttu-id="0c498-357">With the source and target set up, Contoso admins are ready to create a replication policy.</span><span class="sxs-lookup"><span data-stu-id="0c498-357">With the source and target set up, Contoso admins are ready to create a replication policy.</span></span>

1. <span data-ttu-id="0c498-358">In  **Prepare infrastructure** > **Replication Settings** > **Replication Policy** >  **Create and Associate**, they create a policy **ContosoMigrationPolicy**.</span><span class="sxs-lookup"><span data-stu-id="0c498-358">In  **Prepare infrastructure** > **Replication Settings** > **Replication Policy** >  **Create and Associate**, they create a policy **ContosoMigrationPolicy**.</span></span>
2. <span data-ttu-id="0c498-359">They use the default settings:</span><span class="sxs-lookup"><span data-stu-id="0c498-359">They use the default settings:</span></span>
    - <span data-ttu-id="0c498-360">**RPO threshold**: Default of 60 minutes.</span><span class="sxs-lookup"><span data-stu-id="0c498-360">**RPO threshold**: Default of 60 minutes.</span></span> <span data-ttu-id="0c498-361">This value defines how often recovery points are created.</span><span class="sxs-lookup"><span data-stu-id="0c498-361">This value defines how often recovery points are created.</span></span> <span data-ttu-id="0c498-362">An alert is generated if continuous replication exceeds this limit.</span><span class="sxs-lookup"><span data-stu-id="0c498-362">An alert is generated if continuous replication exceeds this limit.</span></span>
    - <span data-ttu-id="0c498-363">**Recovery point retention**.</span><span class="sxs-lookup"><span data-stu-id="0c498-363">**Recovery point retention**.</span></span> <span data-ttu-id="0c498-364">Default of 24 hours.</span><span class="sxs-lookup"><span data-stu-id="0c498-364">Default of 24 hours.</span></span> <span data-ttu-id="0c498-365">This value specifies how long the retention window is for each recovery point.</span><span class="sxs-lookup"><span data-stu-id="0c498-365">This value specifies how long the retention window is for each recovery point.</span></span> <span data-ttu-id="0c498-366">Replicated VMs can be recovered to any point in a window.</span><span class="sxs-lookup"><span data-stu-id="0c498-366">Replicated VMs can be recovered to any point in a window.</span></span>
    - <span data-ttu-id="0c498-367">**App-consistent snapshot frequency**.</span><span class="sxs-lookup"><span data-stu-id="0c498-367">**App-consistent snapshot frequency**.</span></span> <span data-ttu-id="0c498-368">Default of one hour.</span><span class="sxs-lookup"><span data-stu-id="0c498-368">Default of one hour.</span></span> <span data-ttu-id="0c498-369">This value specifies the frequency at which application-consistent snapshots are created.</span><span class="sxs-lookup"><span data-stu-id="0c498-369">This value specifies the frequency at which application-consistent snapshots are created.</span></span>
 
        ![Create replication policy](./media/contoso-migration-rehost-linux-vm-mysql/replication-policy.png)

5. <span data-ttu-id="0c498-371">The policy is automatically associated with the configuration server.</span><span class="sxs-lookup"><span data-stu-id="0c498-371">The policy is automatically associated with the configuration server.</span></span> 

    ![Associate replication policy](./media/contoso-migration-rehost-linux-vm-mysql/replication-policy2.png)


<span data-ttu-id="0c498-373">**Need more help?**</span><span class="sxs-lookup"><span data-stu-id="0c498-373">**Need more help?**</span></span>

- <span data-ttu-id="0c498-374">You can read a full walkthrough of all these steps in [Set up disaster recovery for on-premises VMware VMs](https://docs.microsoft.com/azure/site-recovery/vmware-azure-tutorial).</span><span class="sxs-lookup"><span data-stu-id="0c498-374">You can read a full walkthrough of all these steps in [Set up disaster recovery for on-premises VMware VMs](https://docs.microsoft.com/azure/site-recovery/vmware-azure-tutorial).</span></span>
- <span data-ttu-id="0c498-375">Detailed instructions are available to help you [set up the source environment](https://docs.microsoft.com/azure/site-recovery/vmware-azure-set-up-source), [deploy the configuration server](https://docs.microsoft.com/azure/site-recovery/vmware-azure-deploy-configuration-server), and [configure replication settings](https://docs.microsoft.com/azure/site-recovery/vmware-azure-set-up-replication).</span><span class="sxs-lookup"><span data-stu-id="0c498-375">Detailed instructions are available to help you [set up the source environment](https://docs.microsoft.com/azure/site-recovery/vmware-azure-set-up-source), [deploy the configuration server](https://docs.microsoft.com/azure/site-recovery/vmware-azure-deploy-configuration-server), and [configure replication settings](https://docs.microsoft.com/azure/site-recovery/vmware-azure-set-up-replication).</span></span>
- <span data-ttu-id="0c498-376">[Learn more](https://docs.microsoft.com/azure/virtual-machines/extensions/agent-linux) about the Azure Guest agent for Linux.</span><span class="sxs-lookup"><span data-stu-id="0c498-376">[Learn more](https://docs.microsoft.com/azure/virtual-machines/extensions/agent-linux) about the Azure Guest agent for Linux.</span></span>

### <a name="enable-replication-for-the-web-vm"></a><span data-ttu-id="0c498-377">Enable replication for the Web VM</span><span class="sxs-lookup"><span data-stu-id="0c498-377">Enable replication for the Web VM</span></span>

<span data-ttu-id="0c498-378">Now Contoso admins can start replicating the **OSTICKETWEB** VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-378">Now Contoso admins can start replicating the **OSTICKETWEB** VM.</span></span>

1. <span data-ttu-id="0c498-379">In **Replicate application** > **Source** > **+Replicate** they select the source settings.</span><span class="sxs-lookup"><span data-stu-id="0c498-379">In **Replicate application** > **Source** > **+Replicate** they select the source settings.</span></span>
2. <span data-ttu-id="0c498-380">They indicate that they want to enable virtual machines, and select the source settings, including the vCenter server, and the configuration server.</span><span class="sxs-lookup"><span data-stu-id="0c498-380">They indicate that they want to enable virtual machines, and select the source settings, including the vCenter server, and the configuration server.</span></span>

    ![Enable replication](./media/contoso-migration-rehost-linux-vm-mysql/enable-replication-source.png)

3. <span data-ttu-id="0c498-382">Now they specify the target settings.</span><span class="sxs-lookup"><span data-stu-id="0c498-382">Now they specify the target settings.</span></span> <span data-ttu-id="0c498-383">These include the resource group and network in which the Azure VM will be located after failover, and the storage account in which replicated data will be stored.</span><span class="sxs-lookup"><span data-stu-id="0c498-383">These include the resource group and network in which the Azure VM will be located after failover, and the storage account in which replicated data will be stored.</span></span> 

     ![Enable replication](./media/contoso-migration-rehost-linux-vm-mysql/enable-replication2.png)

3. <span data-ttu-id="0c498-385">They select **OSTICKETWEB** for replication.</span><span class="sxs-lookup"><span data-stu-id="0c498-385">They select **OSTICKETWEB** for replication.</span></span> 

    ![Enable replication](./media/contoso-migration-rehost-linux-vm-mysql/enable-replication3.png)

4. <span data-ttu-id="0c498-387">In the VM properties, they select the account that should be used to automatically install the Mobility Service on the VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-387">In the VM properties, they select the account that should be used to automatically install the Mobility Service on the VM.</span></span>

     ![Mobility service](./media/contoso-migration-rehost-linux-vm-mysql/linux-mobility.png)

5. <span data-ttu-id="0c498-389">in **Replication settings** > **Configure replication settings**, they check that the correct replication policy is applied, and select **Enable Replication**.</span><span class="sxs-lookup"><span data-stu-id="0c498-389">in **Replication settings** > **Configure replication settings**, they check that the correct replication policy is applied, and select **Enable Replication**.</span></span> <span data-ttu-id="0c498-390">The Mobility service will be automatically installed.</span><span class="sxs-lookup"><span data-stu-id="0c498-390">The Mobility service will be automatically installed.</span></span>
6.  <span data-ttu-id="0c498-391">They track replication progress in **Jobs**.</span><span class="sxs-lookup"><span data-stu-id="0c498-391">They track replication progress in **Jobs**.</span></span> <span data-ttu-id="0c498-392">After the **Finalize Protection** job runs, the machine is ready for failover.</span><span class="sxs-lookup"><span data-stu-id="0c498-392">After the **Finalize Protection** job runs, the machine is ready for failover.</span></span>


<span data-ttu-id="0c498-393">**Need more help?**</span><span class="sxs-lookup"><span data-stu-id="0c498-393">**Need more help?**</span></span>

<span data-ttu-id="0c498-394">You can read a full walkthrough of all these steps in [Enable replication](https://docs.microsoft.com/azure/site-recovery/vmware-azure-enable-replication).</span><span class="sxs-lookup"><span data-stu-id="0c498-394">You can read a full walkthrough of all these steps in [Enable replication](https://docs.microsoft.com/azure/site-recovery/vmware-azure-enable-replication).</span></span>


## <a name="step-5-migrate-the-database"></a><span data-ttu-id="0c498-395">Step 5: Migrate the database</span><span class="sxs-lookup"><span data-stu-id="0c498-395">Step 5: Migrate the database</span></span>

<span data-ttu-id="0c498-396">Contoso admins migrate the database using backup and restore, with MySQL tools.</span><span class="sxs-lookup"><span data-stu-id="0c498-396">Contoso admins migrate the database using backup and restore, with MySQL tools.</span></span> <span data-ttu-id="0c498-397">They install MySQL Workbench, back up the database from OSTICKETMYSQL, and then restore it to Azure Database for MySQL Server.</span><span class="sxs-lookup"><span data-stu-id="0c498-397">They install MySQL Workbench, back up the database from OSTICKETMYSQL, and then restore it to Azure Database for MySQL Server.</span></span>

### <a name="install-mysql-workbench"></a><span data-ttu-id="0c498-398">Install MySQL Workbench</span><span class="sxs-lookup"><span data-stu-id="0c498-398">Install MySQL Workbench</span></span>

1. <span data-ttu-id="0c498-399">They check the [prerequisites and downloads MySQL Workbench](https://dev.mysql.com/downloads/workbench/?utm_source=tuicool).</span><span class="sxs-lookup"><span data-stu-id="0c498-399">They check the [prerequisites and downloads MySQL Workbench](https://dev.mysql.com/downloads/workbench/?utm_source=tuicool).</span></span>
2. <span data-ttu-id="0c498-400">They install MySQL Workbench for Windows in accordance with the [installation instructions](https://dev.mysql.com/doc/workbench/en/wb-installing.html).</span><span class="sxs-lookup"><span data-stu-id="0c498-400">They install MySQL Workbench for Windows in accordance with the [installation instructions](https://dev.mysql.com/doc/workbench/en/wb-installing.html).</span></span>
3. <span data-ttu-id="0c498-401">In MySQL Workbench, they create a MySQL connection to OSTICKETMYSQL.</span><span class="sxs-lookup"><span data-stu-id="0c498-401">In MySQL Workbench, they create a MySQL connection to OSTICKETMYSQL.</span></span> 

    ![MySQL Workbench](./media/contoso-migration-rehost-linux-vm-mysql/workbench1.png)

4. <span data-ttu-id="0c498-403">They export the database as **osticket**, to a local self-contained file.</span><span class="sxs-lookup"><span data-stu-id="0c498-403">They export the database as **osticket**, to a local self-contained file.</span></span>

    ![MySQL Workbench](./media/contoso-migration-rehost-linux-vm-mysql/workbench2.png)

5. <span data-ttu-id="0c498-405">After the database has been backed up locally, they create a connection to the Azure Database for MySQL instance.</span><span class="sxs-lookup"><span data-stu-id="0c498-405">After the database has been backed up locally, they create a connection to the Azure Database for MySQL instance.</span></span>

    ![MySQL Workbench](./media/contoso-migration-rehost-linux-vm-mysql/workbench3.png)

6. <span data-ttu-id="0c498-407">Now, they can import (restore) the database in the Azure MySQL instance, from the self-contained file.</span><span class="sxs-lookup"><span data-stu-id="0c498-407">Now, they can import (restore) the database in the Azure MySQL instance, from the self-contained file.</span></span> <span data-ttu-id="0c498-408">A new schema (osticket) is created for the instance.</span><span class="sxs-lookup"><span data-stu-id="0c498-408">A new schema (osticket) is created for the instance.</span></span>

    ![MySQL Workbench](./media/contoso-migration-rehost-linux-vm-mysql/workbench4.png)

## <a name="step-6-migrate-the-vms-with-site-recovery"></a><span data-ttu-id="0c498-410">Step 6: Migrate the VMs with Site Recovery</span><span class="sxs-lookup"><span data-stu-id="0c498-410">Step 6: Migrate the VMs with Site Recovery</span></span>

<span data-ttu-id="0c498-411">Finally, Contoso admins run a quick test failover, and then migrate the VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-411">Finally, Contoso admins run a quick test failover, and then migrate the VM.</span></span>

### <a name="run-a-test-failover"></a><span data-ttu-id="0c498-412">Run a test failover</span><span class="sxs-lookup"><span data-stu-id="0c498-412">Run a test failover</span></span>

<span data-ttu-id="0c498-413">Running a test failover helps verify that everything's working as expected, before the migration.</span><span class="sxs-lookup"><span data-stu-id="0c498-413">Running a test failover helps verify that everything's working as expected, before the migration.</span></span> 

1. <span data-ttu-id="0c498-414">They run a test failover to the latest available point in time (**Latest processed**).</span><span class="sxs-lookup"><span data-stu-id="0c498-414">They run a test failover to the latest available point in time (**Latest processed**).</span></span>
2. <span data-ttu-id="0c498-415">They select **Shut down machine before beginning failover**, so that Site Recovery attempts to shut down the source VM before triggering the failover.</span><span class="sxs-lookup"><span data-stu-id="0c498-415">They select **Shut down machine before beginning failover**, so that Site Recovery attempts to shut down the source VM before triggering the failover.</span></span> <span data-ttu-id="0c498-416">Failover continues even if shutdown fails.</span><span class="sxs-lookup"><span data-stu-id="0c498-416">Failover continues even if shutdown fails.</span></span> 
3. <span data-ttu-id="0c498-417">Test failover runs:</span><span class="sxs-lookup"><span data-stu-id="0c498-417">Test failover runs:</span></span> 

    - <span data-ttu-id="0c498-418">A prerequisites check runs to make sure all of the conditions required for migration are in place.</span><span class="sxs-lookup"><span data-stu-id="0c498-418">A prerequisites check runs to make sure all of the conditions required for migration are in place.</span></span>
    - <span data-ttu-id="0c498-419">Failover processes the data, so that an Azure VM can be created.</span><span class="sxs-lookup"><span data-stu-id="0c498-419">Failover processes the data, so that an Azure VM can be created.</span></span> <span data-ttu-id="0c498-420">If select the latest recovery point, a recovery point is created from the data.</span><span class="sxs-lookup"><span data-stu-id="0c498-420">If select the latest recovery point, a recovery point is created from the data.</span></span>
    - <span data-ttu-id="0c498-421">An Azure VM is created using the data processed in the previous step.</span><span class="sxs-lookup"><span data-stu-id="0c498-421">An Azure VM is created using the data processed in the previous step.</span></span>

3. <span data-ttu-id="0c498-422">After the failover finishes, the replica Azure VM appears in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="0c498-422">After the failover finishes, the replica Azure VM appears in the Azure portal.</span></span> <span data-ttu-id="0c498-423">They check that the VM is the appropriate size, that it's connected to the right network, and that it's running.</span><span class="sxs-lookup"><span data-stu-id="0c498-423">They check that the VM is the appropriate size, that it's connected to the right network, and that it's running.</span></span> 
4. <span data-ttu-id="0c498-424">After verifying, they clean up the failover, and record and save any observations.</span><span class="sxs-lookup"><span data-stu-id="0c498-424">After verifying, they clean up the failover, and record and save any observations.</span></span>

### <a name="migrate-the-vm"></a><span data-ttu-id="0c498-425">Migrate the VM</span><span class="sxs-lookup"><span data-stu-id="0c498-425">Migrate the VM</span></span>

<span data-ttu-id="0c498-426">To migrate the VM, Contoso admins creats a recovery plan that includes the VM, and fail over the plan to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-426">To migrate the VM, Contoso admins creats a recovery plan that includes the VM, and fail over the plan to Azure.</span></span>

1. <span data-ttu-id="0c498-427">They create a plan, and add **OSTICKETWEB** to it.</span><span class="sxs-lookup"><span data-stu-id="0c498-427">They create a plan, and add **OSTICKETWEB** to it.</span></span>

    ![Recovery plan](./media/contoso-migration-rehost-linux-vm-mysql/recovery-plan.png)

2. <span data-ttu-id="0c498-429">They run a failover on the plan.</span><span class="sxs-lookup"><span data-stu-id="0c498-429">They run a failover on the plan.</span></span> <span data-ttu-id="0c498-430">They select the latest recovery point, and specify that Site Recovery should try to shut down the on-premises VM before triggering the failover.</span><span class="sxs-lookup"><span data-stu-id="0c498-430">They select the latest recovery point, and specify that Site Recovery should try to shut down the on-premises VM before triggering the failover.</span></span> <span data-ttu-id="0c498-431">They can follow the failover progress on the **Jobs** page.</span><span class="sxs-lookup"><span data-stu-id="0c498-431">They can follow the failover progress on the **Jobs** page.</span></span>

    ![Failover](./media/contoso-migration-rehost-linux-vm-mysql/failover1.png)

3. <span data-ttu-id="0c498-433">During the failover, vCenter Server issues commands to stop the two VMs running on the ESXi host.</span><span class="sxs-lookup"><span data-stu-id="0c498-433">During the failover, vCenter Server issues commands to stop the two VMs running on the ESXi host.</span></span>

    ![Failover](./media/contoso-migration-rehost-linux-vm-mysql/vcenter-failover.png)

4. <span data-ttu-id="0c498-435">After the failover, they verify that the Azure VM appears as expected in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="0c498-435">After the failover, they verify that the Azure VM appears as expected in the Azure portal.</span></span>

    ![Failover](./media/contoso-migration-rehost-linux-vm-mysql/failover2.png)  

5. <span data-ttu-id="0c498-437">After checking the VM, they complete the migration.</span><span class="sxs-lookup"><span data-stu-id="0c498-437">After checking the VM, they complete the migration.</span></span> <span data-ttu-id="0c498-438">This stops replication for the VM, and stops Site Recovery billing for the VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-438">This stops replication for the VM, and stops Site Recovery billing for the VM.</span></span>

    ![Failover](./media/contoso-migration-rehost-linux-vm-mysql/failover3.png)

<span data-ttu-id="0c498-440">**Need more help?**</span><span class="sxs-lookup"><span data-stu-id="0c498-440">**Need more help?**</span></span>

- <span data-ttu-id="0c498-441">[Learn about](https://docs.microsoft.com/azure/site-recovery/tutorial-dr-drill-azure) running a test failover.</span><span class="sxs-lookup"><span data-stu-id="0c498-441">[Learn about](https://docs.microsoft.com/azure/site-recovery/tutorial-dr-drill-azure) running a test failover.</span></span> 
- <span data-ttu-id="0c498-442">[Learn](https://docs.microsoft.com/azure/site-recovery/site-recovery-create-recovery-plans) how to create a recovery plan.</span><span class="sxs-lookup"><span data-stu-id="0c498-442">[Learn](https://docs.microsoft.com/azure/site-recovery/site-recovery-create-recovery-plans) how to create a recovery plan.</span></span>
- <span data-ttu-id="0c498-443">[Learn about](https://docs.microsoft.com/azure/site-recovery/site-recovery-failover) failing over to Azure.</span><span class="sxs-lookup"><span data-stu-id="0c498-443">[Learn about](https://docs.microsoft.com/azure/site-recovery/site-recovery-failover) failing over to Azure.</span></span>


### <a name="connect-the-vm-to-the-database"></a><span data-ttu-id="0c498-444">Connect the VM to the database</span><span class="sxs-lookup"><span data-stu-id="0c498-444">Connect the VM to the database</span></span>

<span data-ttu-id="0c498-445">As the final step in the migration process, Contoso admins update the connection string of the app to point to the Azure Database for MySQL.</span><span class="sxs-lookup"><span data-stu-id="0c498-445">As the final step in the migration process, Contoso admins update the connection string of the app to point to the Azure Database for MySQL.</span></span> 

1. <span data-ttu-id="0c498-446">They make an SSH connection to the OSTICKETWEB VM using Putty or another SSH client.</span><span class="sxs-lookup"><span data-stu-id="0c498-446">They make an SSH connection to the OSTICKETWEB VM using Putty or another SSH client.</span></span> <span data-ttu-id="0c498-447">The VM is private so they connect using the private IP address.</span><span class="sxs-lookup"><span data-stu-id="0c498-447">The VM is private so they connect using the private IP address.</span></span>

    ![Connect to database](./media/contoso-migration-rehost-linux-vm-mysql/db-connect.png)  

    ![Connect to database](./media/contoso-migration-rehost-linux-vm-mysql/db-connect2.png)  

2. <span data-ttu-id="0c498-450">They update settings so that the **OSTICKETWEB** VM can communicate with the **OSTICKETMYSQL** database.</span><span class="sxs-lookup"><span data-stu-id="0c498-450">They update settings so that the **OSTICKETWEB** VM can communicate with the **OSTICKETMYSQL** database.</span></span> <span data-ttu-id="0c498-451">Currently the configuration is hardcoded with the on-premises IP address 172.16.0.43.</span><span class="sxs-lookup"><span data-stu-id="0c498-451">Currently the configuration is hardcoded with the on-premises IP address 172.16.0.43.</span></span>

    <span data-ttu-id="0c498-452">**Before the update**</span><span class="sxs-lookup"><span data-stu-id="0c498-452">**Before the update**</span></span>
    
    ![Update IP](./media/contoso-migration-rehost-linux-vm-mysql/update-ip1.png)  

    <span data-ttu-id="0c498-454">**After the update**</span><span class="sxs-lookup"><span data-stu-id="0c498-454">**After the update**</span></span>
    
    ![Update IP](./media/contoso-migration-rehost-linux-vm-mysql/update-ip2.png) 
    
    ![Update IP](./media/contoso-migration-rehost-linux-vm-mysql/update-ip3.png) 

3. <span data-ttu-id="0c498-457">They restart the service with **systemctl restart apache2**.</span><span class="sxs-lookup"><span data-stu-id="0c498-457">They restart the service with **systemctl restart apache2**.</span></span>

    ![Restart](./media/contoso-migration-rehost-linux-vm-mysql/restart.png) 

4. <span data-ttu-id="0c498-459">Finally, they update the DNS records for **OSTICKETWEB**, on one of the Contoso domain controllers.</span><span class="sxs-lookup"><span data-stu-id="0c498-459">Finally, they update the DNS records for **OSTICKETWEB**, on one of the Contoso domain controllers.</span></span>

    ![Update DNS](./media/contoso-migration-rehost-linux-vm-mysql/update-dns.png) 


##  <a name="clean-up-after-migration"></a><span data-ttu-id="0c498-461">Clean up after migration</span><span class="sxs-lookup"><span data-stu-id="0c498-461">Clean up after migration</span></span>

<span data-ttu-id="0c498-462">With migration complete, the osTicket app tiers are running on Azure VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-462">With migration complete, the osTicket app tiers are running on Azure VMs.</span></span>

<span data-ttu-id="0c498-463">Now, Contoso needs to do the following:</span><span class="sxs-lookup"><span data-stu-id="0c498-463">Now, Contoso needs to do the following:</span></span> 
- <span data-ttu-id="0c498-464">Remove the VMware VMs from the vCenter inventory</span><span class="sxs-lookup"><span data-stu-id="0c498-464">Remove the VMware VMs from the vCenter inventory</span></span>
- <span data-ttu-id="0c498-465">Remove the on-premises VMs from local backup jobs.</span><span class="sxs-lookup"><span data-stu-id="0c498-465">Remove the on-premises VMs from local backup jobs.</span></span>
- <span data-ttu-id="0c498-466">Update internal documentation show new locations and IP addresses.</span><span class="sxs-lookup"><span data-stu-id="0c498-466">Update internal documentation show new locations and IP addresses.</span></span> 
- <span data-ttu-id="0c498-467">Review any resources that interact with the on-premises VMs, and update any relevant settings or documentation to reflect the new configuration.</span><span class="sxs-lookup"><span data-stu-id="0c498-467">Review any resources that interact with the on-premises VMs, and update any relevant settings or documentation to reflect the new configuration.</span></span>
- <span data-ttu-id="0c498-468">Contoso used the Azure Migrate service with dependency mapping to assess the **OSTICKETWEB** VM for migration.</span><span class="sxs-lookup"><span data-stu-id="0c498-468">Contoso used the Azure Migrate service with dependency mapping to assess the **OSTICKETWEB** VM for migration.</span></span> <span data-ttu-id="0c498-469">They should now remove the agents (Microsoft Monitoring Agent/Dependency Agent) they installed for this purpose, from the VM.</span><span class="sxs-lookup"><span data-stu-id="0c498-469">They should now remove the agents (Microsoft Monitoring Agent/Dependency Agent) they installed for this purpose, from the VM.</span></span>

## <a name="review-the-deployment"></a><span data-ttu-id="0c498-470">Review the deployment</span><span class="sxs-lookup"><span data-stu-id="0c498-470">Review the deployment</span></span>

<span data-ttu-id="0c498-471">With the app now running, Contoso need to fully operationalize and secure their new infrastructure.</span><span class="sxs-lookup"><span data-stu-id="0c498-471">With the app now running, Contoso need to fully operationalize and secure their new infrastructure.</span></span>

### <a name="security"></a><span data-ttu-id="0c498-472">Security</span><span class="sxs-lookup"><span data-stu-id="0c498-472">Security</span></span>

<span data-ttu-id="0c498-473">The Contoso security team review the VM and database to determine any security issues.</span><span class="sxs-lookup"><span data-stu-id="0c498-473">The Contoso security team review the VM and database to determine any security issues.</span></span>

- <span data-ttu-id="0c498-474">They review the Network Security Groups (NSGs) for the VM, to control access.</span><span class="sxs-lookup"><span data-stu-id="0c498-474">They review the Network Security Groups (NSGs) for the VM, to control access.</span></span> <span data-ttu-id="0c498-475">NSGs are used to ensure that only traffic allowed to the application can pass.</span><span class="sxs-lookup"><span data-stu-id="0c498-475">NSGs are used to ensure that only traffic allowed to the application can pass.</span></span>
- <span data-ttu-id="0c498-476">They consider securing the data on the VM disks using Disk encryption and Azure KeyVault.</span><span class="sxs-lookup"><span data-stu-id="0c498-476">They consider securing the data on the VM disks using Disk encryption and Azure KeyVault.</span></span>
- <span data-ttu-id="0c498-477">Communication between the VM and database instance isn't configured for SSL.</span><span class="sxs-lookup"><span data-stu-id="0c498-477">Communication between the VM and database instance isn't configured for SSL.</span></span> <span data-ttu-id="0c498-478">They will need to do this to ensure that database traffic can't be hacked.</span><span class="sxs-lookup"><span data-stu-id="0c498-478">They will need to do this to ensure that database traffic can't be hacked.</span></span>

<span data-ttu-id="0c498-479">[Read more](https://docs.microsoft.com/azure/security/azure-security-best-practices-vms#vm-authentication-and-access-control) about security practices for VMs.</span><span class="sxs-lookup"><span data-stu-id="0c498-479">[Read more](https://docs.microsoft.com/azure/security/azure-security-best-practices-vms#vm-authentication-and-access-control) about security practices for VMs.</span></span>

### <a name="bcdr"></a><span data-ttu-id="0c498-480">BCDR</span><span class="sxs-lookup"><span data-stu-id="0c498-480">BCDR</span></span>

<span data-ttu-id="0c498-481">For business continuity and disaster recovery, Contoso takes the following actions:</span><span class="sxs-lookup"><span data-stu-id="0c498-481">For business continuity and disaster recovery, Contoso takes the following actions:</span></span>

- <span data-ttu-id="0c498-482">**Keep data safe**: Contoso backs up the data on the app VM using the Azure Backup service.</span><span class="sxs-lookup"><span data-stu-id="0c498-482">**Keep data safe**: Contoso backs up the data on the app VM using the Azure Backup service.</span></span> <span data-ttu-id="0c498-483">[Learn more](https://docs.microsoft.com/azure/backup/backup-introduction-to-azure-backup?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="0c498-483">[Learn more](https://docs.microsoft.com/azure/backup/backup-introduction-to-azure-backup?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span> <span data-ttu-id="0c498-484">They don't need to configure backup for the database.</span><span class="sxs-lookup"><span data-stu-id="0c498-484">They don't need to configure backup for the database.</span></span> <span data-ttu-id="0c498-485">Azure Database for MySQL automatically creates and stores server backups.</span><span class="sxs-lookup"><span data-stu-id="0c498-485">Azure Database for MySQL automatically creates and stores server backups.</span></span> <span data-ttu-id="0c498-486">They selected to use geo-redundancy for the database, so it's resilient and production-ready.</span><span class="sxs-lookup"><span data-stu-id="0c498-486">They selected to use geo-redundancy for the database, so it's resilient and production-ready.</span></span>
- <span data-ttu-id="0c498-487">**Keep apps up and running**: Contoso replicates the app VMs in Azure to a secondary region using Site Recovery.</span><span class="sxs-lookup"><span data-stu-id="0c498-487">**Keep apps up and running**: Contoso replicates the app VMs in Azure to a secondary region using Site Recovery.</span></span> <span data-ttu-id="0c498-488">[Learn more](https://docs.microsoft.com/azure/site-recovery/azure-to-azure-quickstart).</span><span class="sxs-lookup"><span data-stu-id="0c498-488">[Learn more](https://docs.microsoft.com/azure/site-recovery/azure-to-azure-quickstart).</span></span>


### <a name="licensing-and-cost-optimization"></a><span data-ttu-id="0c498-489">Licensing and cost optimization</span><span class="sxs-lookup"><span data-stu-id="0c498-489">Licensing and cost optimization</span></span>

- <span data-ttu-id="0c498-490">After deploying resources, Contoso assigns Azure tags, in accordance with decisions they made during the [Azure infrastructure](contoso-migration-infrastructure.md#set-up-tagging) deployment.</span><span class="sxs-lookup"><span data-stu-id="0c498-490">After deploying resources, Contoso assigns Azure tags, in accordance with decisions they made during the [Azure infrastructure](contoso-migration-infrastructure.md#set-up-tagging) deployment.</span></span>
- <span data-ttu-id="0c498-491">There are no licensing issues for the Contoso Ubuntu servers.</span><span class="sxs-lookup"><span data-stu-id="0c498-491">There are no licensing issues for the Contoso Ubuntu servers.</span></span>
- <span data-ttu-id="0c498-492">Contoso will enable Azure Cost Management licensed by Cloudyn, a Microsoft subsidiary.</span><span class="sxs-lookup"><span data-stu-id="0c498-492">Contoso will enable Azure Cost Management licensed by Cloudyn, a Microsoft subsidiary.</span></span> <span data-ttu-id="0c498-493">It's a multi-cloud cost management solution that helps you to utilize and manage Azure and other cloud resources.</span><span class="sxs-lookup"><span data-stu-id="0c498-493">It's a multi-cloud cost management solution that helps you to utilize and manage Azure and other cloud resources.</span></span>  <span data-ttu-id="0c498-494">[Learn more](https://docs.microsoft.com/azure/cost-management/overview) about Azure Cost Management.</span><span class="sxs-lookup"><span data-stu-id="0c498-494">[Learn more](https://docs.microsoft.com/azure/cost-management/overview) about Azure Cost Management.</span></span>


## <a name="next-steps"></a><span data-ttu-id="0c498-495">Next steps</span><span class="sxs-lookup"><span data-stu-id="0c498-495">Next steps</span></span>

<span data-ttu-id="0c498-496">In this scenario we showed the final rehost scenario.</span><span class="sxs-lookup"><span data-stu-id="0c498-496">In this scenario we showed the final rehost scenario.</span></span> <span data-ttu-id="0c498-497">Contoso migrated the frontend VM of the on-premises Linux osTicket app to an Azure VM, and migrated the app database to an Azure MySQL instance.</span><span class="sxs-lookup"><span data-stu-id="0c498-497">Contoso migrated the frontend VM of the on-premises Linux osTicket app to an Azure VM, and migrated the app database to an Azure MySQL instance.</span></span>

<span data-ttu-id="0c498-498">In the next set of tutorials in the migration series, we're going to show you how Contoso performed a more complex set of migrations, involving app refactoring, rather than simple lift-and-shift migrations.</span><span class="sxs-lookup"><span data-stu-id="0c498-498">In the next set of tutorials in the migration series, we're going to show you how Contoso performed a more complex set of migrations, involving app refactoring, rather than simple lift-and-shift migrations.</span></span>
