---
title: Diagnose performance issues using Azure Application Insights | Microsoft Docs
description: Tutorial to find and diagnose performance issues in your application using Azure Application Insights.
services: application-insights
keywords: ''
author: mrbullwinkle
ms.author: mbullwin
ms.date: 09/18/2017
ms.service: application-insights
ms.custom: mvc
ms.topic: tutorial
manager: carmonm
ms.openlocfilehash: 4ce4c9e2479c8d570766169ce5094dcc2b4bc511
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44865468"
---
# <a name="find-and-diagnose-performance-issues-with-azure-application-insights"></a><span data-ttu-id="91be3-103">Find and diagnose performance issues with Azure Application Insights</span><span class="sxs-lookup"><span data-stu-id="91be3-103">Find and diagnose performance issues with Azure Application Insights</span></span>

<span data-ttu-id="91be3-104">Azure Application Insights collects telemetry from your application to help analyze its operation and performance.</span><span class="sxs-lookup"><span data-stu-id="91be3-104">Azure Application Insights collects telemetry from your application to help analyze its operation and performance.</span></span>  <span data-ttu-id="91be3-105">You can use this information to identify problems that may be occurring or to identify improvements to the application that would most impact users.</span><span class="sxs-lookup"><span data-stu-id="91be3-105">You can use this information to identify problems that may be occurring or to identify improvements to the application that would most impact users.</span></span>  <span data-ttu-id="91be3-106">This tutorial takes you through the process of analyzing the performance of both the server components of your application and the perspective of the client.</span><span class="sxs-lookup"><span data-stu-id="91be3-106">This tutorial takes you through the process of analyzing the performance of both the server components of your application and the perspective of the client.</span></span>  <span data-ttu-id="91be3-107">You learn how to:</span><span class="sxs-lookup"><span data-stu-id="91be3-107">You learn how to:</span></span>

> [!div class="checklist"]
> * <span data-ttu-id="91be3-108">Identify the performance of server-side operations</span><span class="sxs-lookup"><span data-stu-id="91be3-108">Identify the performance of server-side operations</span></span>
> * <span data-ttu-id="91be3-109">Analyze server operations to determine the root cause of slow performance</span><span class="sxs-lookup"><span data-stu-id="91be3-109">Analyze server operations to determine the root cause of slow performance</span></span>
> * <span data-ttu-id="91be3-110">Identify slowest client-side operations</span><span class="sxs-lookup"><span data-stu-id="91be3-110">Identify slowest client-side operations</span></span>
> * <span data-ttu-id="91be3-111">Analyze details of page views using query language</span><span class="sxs-lookup"><span data-stu-id="91be3-111">Analyze details of page views using query language</span></span>


## <a name="prerequisites"></a><span data-ttu-id="91be3-112">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="91be3-112">Prerequisites</span></span>

<span data-ttu-id="91be3-113">To complete this tutorial:</span><span class="sxs-lookup"><span data-stu-id="91be3-113">To complete this tutorial:</span></span>

- <span data-ttu-id="91be3-114">Install [Visual Studio 2017](https://www.visualstudio.com/downloads/) with the following workloads:</span><span class="sxs-lookup"><span data-stu-id="91be3-114">Install [Visual Studio 2017](https://www.visualstudio.com/downloads/) with the following workloads:</span></span>
    - <span data-ttu-id="91be3-115">ASP.NET and web development</span><span class="sxs-lookup"><span data-stu-id="91be3-115">ASP.NET and web development</span></span>
    - <span data-ttu-id="91be3-116">Azure development</span><span class="sxs-lookup"><span data-stu-id="91be3-116">Azure development</span></span>
- <span data-ttu-id="91be3-117">Deploy a .NET application to Azure and [enable the Application Insights SDK](app-insights-asp-net.md).</span><span class="sxs-lookup"><span data-stu-id="91be3-117">Deploy a .NET application to Azure and [enable the Application Insights SDK](app-insights-asp-net.md).</span></span>
- <span data-ttu-id="91be3-118">[Enable the Application Insights profiler](app-insights-profiler.md#installation) for your application.</span><span class="sxs-lookup"><span data-stu-id="91be3-118">[Enable the Application Insights profiler](app-insights-profiler.md#installation) for your application.</span></span>

## <a name="log-in-to-azure"></a><span data-ttu-id="91be3-119">Log in to Azure</span><span class="sxs-lookup"><span data-stu-id="91be3-119">Log in to Azure</span></span>
<span data-ttu-id="91be3-120">Log in to the Azure portal at [https://portal.azure.com](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="91be3-120">Log in to the Azure portal at [https://portal.azure.com](https://portal.azure.com).</span></span>

## <a name="identify-slow-server-operations"></a><span data-ttu-id="91be3-121">Identify slow server operations</span><span class="sxs-lookup"><span data-stu-id="91be3-121">Identify slow server operations</span></span>
<span data-ttu-id="91be3-122">Application Insights collects performance details for the different operations in your application.</span><span class="sxs-lookup"><span data-stu-id="91be3-122">Application Insights collects performance details for the different operations in your application.</span></span> <span data-ttu-id="91be3-123">By identifying those operations with the longest duration, you can diagnose potential problems or best target your ongoing development to improve the overall performance of the application.</span><span class="sxs-lookup"><span data-stu-id="91be3-123">By identifying those operations with the longest duration, you can diagnose potential problems or best target your ongoing development to improve the overall performance of the application.</span></span>

1. <span data-ttu-id="91be3-124">Select **Application Insights** and then select your subscription.</span><span class="sxs-lookup"><span data-stu-id="91be3-124">Select **Application Insights** and then select your subscription.</span></span>  
1. <span data-ttu-id="91be3-125">To open the **Performance** panel either select **Performance** under the **Investigate** menu or click the **Server Response Time** graph.</span><span class="sxs-lookup"><span data-stu-id="91be3-125">To open the **Performance** panel either select **Performance** under the **Investigate** menu or click the **Server Response Time** graph.</span></span>

    ![Performance](media/app-insights-tutorial-performance/performance.png)

2. <span data-ttu-id="91be3-127">The **Performance** panel shows the count and average duration of each operation for the application.</span><span class="sxs-lookup"><span data-stu-id="91be3-127">The **Performance** panel shows the count and average duration of each operation for the application.</span></span>  <span data-ttu-id="91be3-128">You can use this information to identify those operations that most impact users.</span><span class="sxs-lookup"><span data-stu-id="91be3-128">You can use this information to identify those operations that most impact users.</span></span> <span data-ttu-id="91be3-129">In this example, the **GET Customers/Details** and **GET Home/Index** are likely candidates to investigate because of their relatively high duration and number of calls.</span><span class="sxs-lookup"><span data-stu-id="91be3-129">In this example, the **GET Customers/Details** and **GET Home/Index** are likely candidates to investigate because of their relatively high duration and number of calls.</span></span>  <span data-ttu-id="91be3-130">Other operations may have a higher duration but were rarely called, so the effect of their improvement would be minimal.</span><span class="sxs-lookup"><span data-stu-id="91be3-130">Other operations may have a higher duration but were rarely called, so the effect of their improvement would be minimal.</span></span>  

    ![Performance panel](media/app-insights-tutorial-performance/performance-blade.png)

3. <span data-ttu-id="91be3-132">The graph currently shows the average duration of the selected operations over time.</span><span class="sxs-lookup"><span data-stu-id="91be3-132">The graph currently shows the average duration of the selected operations over time.</span></span> <span data-ttu-id="91be3-133">You can switch to the 95th percentile to find the performance issues.</span><span class="sxs-lookup"><span data-stu-id="91be3-133">You can switch to the 95th percentile to find the performance issues.</span></span> <span data-ttu-id="91be3-134">Add the operations that you're interested in by pinning them to the graph.</span><span class="sxs-lookup"><span data-stu-id="91be3-134">Add the operations that you're interested in by pinning them to the graph.</span></span>  <span data-ttu-id="91be3-135">This shows that there are some peaks worth investigating.</span><span class="sxs-lookup"><span data-stu-id="91be3-135">This shows that there are some peaks worth investigating.</span></span>  <span data-ttu-id="91be3-136">Isolate this further by reducing the time window of the graph.</span><span class="sxs-lookup"><span data-stu-id="91be3-136">Isolate this further by reducing the time window of the graph.</span></span>

    ![Pin operations](media/app-insights-tutorial-performance/pin-operations.png)

4.  <span data-ttu-id="91be3-138">The performance panel on the right shows distribution of durations for different requests for the selected operation.</span><span class="sxs-lookup"><span data-stu-id="91be3-138">The performance panel on the right shows distribution of durations for different requests for the selected operation.</span></span>  <span data-ttu-id="91be3-139">Reduce the window to start around the 95th percentile.</span><span class="sxs-lookup"><span data-stu-id="91be3-139">Reduce the window to start around the 95th percentile.</span></span> <span data-ttu-id="91be3-140">The "Top 3 dependencies" insights card, can tell you at a glance that the external dependencies are likely contributing to the slow transactions.</span><span class="sxs-lookup"><span data-stu-id="91be3-140">The "Top 3 dependencies" insights card, can tell you at a glance that the external dependencies are likely contributing to the slow transactions.</span></span>  <span data-ttu-id="91be3-141">Click on the button with number of samples to see a list of the samples.</span><span class="sxs-lookup"><span data-stu-id="91be3-141">Click on the button with number of samples to see a list of the samples.</span></span> <span data-ttu-id="91be3-142">You can then select any sample to see transaction details.</span><span class="sxs-lookup"><span data-stu-id="91be3-142">You can then select any sample to see transaction details.</span></span>

    ![Duration distribution](media/app-insights-tutorial-performance/duration-distribution.png)

5.  <span data-ttu-id="91be3-144">You can see at a glance that the call to Fabrikamaccount Azure Table is contributing most to the total duration of the transaction.</span><span class="sxs-lookup"><span data-stu-id="91be3-144">You can see at a glance that the call to Fabrikamaccount Azure Table is contributing most to the total duration of the transaction.</span></span> <span data-ttu-id="91be3-145">You can also see that an exception caused it to fail.</span><span class="sxs-lookup"><span data-stu-id="91be3-145">You can also see that an exception caused it to fail.</span></span> <span data-ttu-id="91be3-146">You can click on any item in the list to see its details on the right side.</span><span class="sxs-lookup"><span data-stu-id="91be3-146">You can click on any item in the list to see its details on the right side.</span></span> [<span data-ttu-id="91be3-147">Learn more about the transaction diagnostics experience</span><span class="sxs-lookup"><span data-stu-id="91be3-147">Learn more about the transaction diagnostics experience</span></span>](app-insights-transaction-diagnostics.md)

    ![Operation details](media/app-insights-tutorial-performance/operation-details.png)
    

6.  <span data-ttu-id="91be3-149">The **Profiler** helps get further with code level diagnostics by showing the actual code that ran for the operation and the time required for each step.</span><span class="sxs-lookup"><span data-stu-id="91be3-149">The **Profiler** helps get further with code level diagnostics by showing the actual code that ran for the operation and the time required for each step.</span></span> <span data-ttu-id="91be3-150">Some operations may not have a trace since the profiler runs periodically.</span><span class="sxs-lookup"><span data-stu-id="91be3-150">Some operations may not have a trace since the profiler runs periodically.</span></span>  <span data-ttu-id="91be3-151">Over time, more operations should have traces.</span><span class="sxs-lookup"><span data-stu-id="91be3-151">Over time, more operations should have traces.</span></span>  <span data-ttu-id="91be3-152">To start the profiler for the operation, click **Profiler traces**.</span><span class="sxs-lookup"><span data-stu-id="91be3-152">To start the profiler for the operation, click **Profiler traces**.</span></span>
5.  <span data-ttu-id="91be3-153">The trace shows the individual events for each operation so you can diagnose the root cause for the duration of the overall operation.</span><span class="sxs-lookup"><span data-stu-id="91be3-153">The trace shows the individual events for each operation so you can diagnose the root cause for the duration of the overall operation.</span></span>  <span data-ttu-id="91be3-154">Click one of the top examples, which have the longest duration.</span><span class="sxs-lookup"><span data-stu-id="91be3-154">Click one of the top examples, which have the longest duration.</span></span>
6.  <span data-ttu-id="91be3-155">Click **Show Hot Path** to highlight the specific path of events that most contribute to the total duration of the operation.</span><span class="sxs-lookup"><span data-stu-id="91be3-155">Click **Show Hot Path** to highlight the specific path of events that most contribute to the total duration of the operation.</span></span>  <span data-ttu-id="91be3-156">In this example, you can see that the slowest call is from *FabrikamFiberAzureStorage.GetStorageTableData* method.</span><span class="sxs-lookup"><span data-stu-id="91be3-156">In this example, you can see that the slowest call is from *FabrikamFiberAzureStorage.GetStorageTableData* method.</span></span> <span data-ttu-id="91be3-157">The part that takes most time is the *CloudTable.CreateIfNotExist* method.</span><span class="sxs-lookup"><span data-stu-id="91be3-157">The part that takes most time is the *CloudTable.CreateIfNotExist* method.</span></span> <span data-ttu-id="91be3-158">If this line of code is executed every time the function gets called, unnecessary network call and CPU resource will be consumed.</span><span class="sxs-lookup"><span data-stu-id="91be3-158">If this line of code is executed every time the function gets called, unnecessary network call and CPU resource will be consumed.</span></span> <span data-ttu-id="91be3-159">The best way to fix your code is to put this line in some startup method that only executes once.</span><span class="sxs-lookup"><span data-stu-id="91be3-159">The best way to fix your code is to put this line in some startup method that only executes once.</span></span> 

    ![Profiler details](media/app-insights-tutorial-performance/profiler-details.png)

7.  <span data-ttu-id="91be3-161">The **Performance Tip** at the top of the screen supports the assessment that the excessive duration is due to waiting.</span><span class="sxs-lookup"><span data-stu-id="91be3-161">The **Performance Tip** at the top of the screen supports the assessment that the excessive duration is due to waiting.</span></span>  <span data-ttu-id="91be3-162">Click the **waiting** link for documentation on interpreting the different types of events.</span><span class="sxs-lookup"><span data-stu-id="91be3-162">Click the **waiting** link for documentation on interpreting the different types of events.</span></span>

    ![Performance tip](media/app-insights-tutorial-performance/performance-tip.png)

8.  <span data-ttu-id="91be3-164">For further analysis, you can click **Download .etl trace** to download the trace in to Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="91be3-164">For further analysis, you can click **Download .etl trace** to download the trace in to Visual Studio.</span></span>

## <a name="use-analytics-data-for-server"></a><span data-ttu-id="91be3-165">Use analytics data for server</span><span class="sxs-lookup"><span data-stu-id="91be3-165">Use analytics data for server</span></span>
<span data-ttu-id="91be3-166">Application Insights Analytics provides a rich query language that allows you to analyze all data collected by Application Insights.</span><span class="sxs-lookup"><span data-stu-id="91be3-166">Application Insights Analytics provides a rich query language that allows you to analyze all data collected by Application Insights.</span></span>  <span data-ttu-id="91be3-167">You can use this to perform deep analysis on request and performance data.</span><span class="sxs-lookup"><span data-stu-id="91be3-167">You can use this to perform deep analysis on request and performance data.</span></span>

1. <span data-ttu-id="91be3-168">Return to the operation detail panel and click the Analytics button.</span><span class="sxs-lookup"><span data-stu-id="91be3-168">Return to the operation detail panel and click the Analytics button.</span></span>

    ![Analytics button](media/app-insights-tutorial-performance/server-analytics-button.png)

2. <span data-ttu-id="91be3-170">Application Insights Analytics opens with a query for each of the views in the panel.</span><span class="sxs-lookup"><span data-stu-id="91be3-170">Application Insights Analytics opens with a query for each of the views in the panel.</span></span>  <span data-ttu-id="91be3-171">You can run these queries as they are or modify them for your requirements.</span><span class="sxs-lookup"><span data-stu-id="91be3-171">You can run these queries as they are or modify them for your requirements.</span></span>  <span data-ttu-id="91be3-172">The first query shows the duration for this operation over time.</span><span class="sxs-lookup"><span data-stu-id="91be3-172">The first query shows the duration for this operation over time.</span></span>

    ![Analytics](media/app-insights-tutorial-performance/server-analytics.png)


## <a name="identify-slow-client-operations"></a><span data-ttu-id="91be3-174">Identify slow client operations</span><span class="sxs-lookup"><span data-stu-id="91be3-174">Identify slow client operations</span></span>
<span data-ttu-id="91be3-175">In addition to identifying server processes to optimize, Application Insights can analyze the perspective of client browsers.</span><span class="sxs-lookup"><span data-stu-id="91be3-175">In addition to identifying server processes to optimize, Application Insights can analyze the perspective of client browsers.</span></span>  <span data-ttu-id="91be3-176">This can help you identify potential improvements to client components and even identify issues with different browsers or different locations.</span><span class="sxs-lookup"><span data-stu-id="91be3-176">This can help you identify potential improvements to client components and even identify issues with different browsers or different locations.</span></span>

1. <span data-ttu-id="91be3-177">Select **Browser** under **Investigate** to open the browser summary.</span><span class="sxs-lookup"><span data-stu-id="91be3-177">Select **Browser** under **Investigate** to open the browser summary.</span></span>  <span data-ttu-id="91be3-178">This provides a visual summary of various telemetries of your application from the perspective of the browser.</span><span class="sxs-lookup"><span data-stu-id="91be3-178">This provides a visual summary of various telemetries of your application from the perspective of the browser.</span></span>

    ![Browser summary](media/app-insights-tutorial-performance/browser-summary.png)

2.  <span data-ttu-id="91be3-180">Scroll down to **What are my slowest pages?**.</span><span class="sxs-lookup"><span data-stu-id="91be3-180">Scroll down to **What are my slowest pages?**.</span></span>  <span data-ttu-id="91be3-181">This shows a list of the pages in your application that have taken the longest time for clients to load.</span><span class="sxs-lookup"><span data-stu-id="91be3-181">This shows a list of the pages in your application that have taken the longest time for clients to load.</span></span>  <span data-ttu-id="91be3-182">You can use this information to prioritize those pages that have the most significant impact on the user.</span><span class="sxs-lookup"><span data-stu-id="91be3-182">You can use this information to prioritize those pages that have the most significant impact on the user.</span></span>
3.  <span data-ttu-id="91be3-183">Click one of the pages to open the **Page view** panel.</span><span class="sxs-lookup"><span data-stu-id="91be3-183">Click one of the pages to open the **Page view** panel.</span></span>  <span data-ttu-id="91be3-184">In the example, the **/FabrikamProd** page is showing an excessive average duration.</span><span class="sxs-lookup"><span data-stu-id="91be3-184">In the example, the **/FabrikamProd** page is showing an excessive average duration.</span></span>  <span data-ttu-id="91be3-185">The **Page view** panel provides details about this page including a breakdown of different duration ranges.</span><span class="sxs-lookup"><span data-stu-id="91be3-185">The **Page view** panel provides details about this page including a breakdown of different duration ranges.</span></span>

    ![Page view](media/app-insights-tutorial-performance/page-view.png)

4.  <span data-ttu-id="91be3-187">Click the highest duration to inspect details of these requests.</span><span class="sxs-lookup"><span data-stu-id="91be3-187">Click the highest duration to inspect details of these requests.</span></span>  <span data-ttu-id="91be3-188">Then click the individual request to view details of the client requesting the page including the type of browser and its location.</span><span class="sxs-lookup"><span data-stu-id="91be3-188">Then click the individual request to view details of the client requesting the page including the type of browser and its location.</span></span>  <span data-ttu-id="91be3-189">This information can assist you in determining whether there are performance issues related to particular types of clients.</span><span class="sxs-lookup"><span data-stu-id="91be3-189">This information can assist you in determining whether there are performance issues related to particular types of clients.</span></span>

    ![Request details](media/app-insights-tutorial-performance/request-details.png)

## <a name="use-analytics-data-for-client"></a><span data-ttu-id="91be3-191">Use analytics data for client</span><span class="sxs-lookup"><span data-stu-id="91be3-191">Use analytics data for client</span></span>
<span data-ttu-id="91be3-192">Like the data collected for server performance, Application Insights makes all client data available for deep analysis using Analytics.</span><span class="sxs-lookup"><span data-stu-id="91be3-192">Like the data collected for server performance, Application Insights makes all client data available for deep analysis using Analytics.</span></span>

1. <span data-ttu-id="91be3-193">Return to the browser summary and click the Analytics icon.</span><span class="sxs-lookup"><span data-stu-id="91be3-193">Return to the browser summary and click the Analytics icon.</span></span>

    ![Analytics icon](media/app-insights-tutorial-performance/client-analytics-icon.png)

2. <span data-ttu-id="91be3-195">Application Insights Analytics opens with a query for each of the views in the panel.</span><span class="sxs-lookup"><span data-stu-id="91be3-195">Application Insights Analytics opens with a query for each of the views in the panel.</span></span> <span data-ttu-id="91be3-196">The first query shows the duration for different page views over time.</span><span class="sxs-lookup"><span data-stu-id="91be3-196">The first query shows the duration for different page views over time.</span></span>

    ![Analytics](media/app-insights-tutorial-performance/client-analytics.png)

3.  <span data-ttu-id="91be3-198">Smart Diagnostics is a feature of Application Insights Analytics that identifies unique patterns in the data.</span><span class="sxs-lookup"><span data-stu-id="91be3-198">Smart Diagnostics is a feature of Application Insights Analytics that identifies unique patterns in the data.</span></span>  <span data-ttu-id="91be3-199">When you click the Smart Diagnostics dot in the line chart, the same query is run without the records that caused the anomaly.</span><span class="sxs-lookup"><span data-stu-id="91be3-199">When you click the Smart Diagnostics dot in the line chart, the same query is run without the records that caused the anomaly.</span></span>  <span data-ttu-id="91be3-200">Details of those records are shown in the comment section of the query so you can identify the properties of those page views that are causing the excessive duration.</span><span class="sxs-lookup"><span data-stu-id="91be3-200">Details of those records are shown in the comment section of the query so you can identify the properties of those page views that are causing the excessive duration.</span></span>

    ![Smart Diagnostics](media/app-insights-tutorial-performance/client-smart-diagnostics.png)


## <a name="next-steps"></a><span data-ttu-id="91be3-202">Next steps</span><span class="sxs-lookup"><span data-stu-id="91be3-202">Next steps</span></span>
<span data-ttu-id="91be3-203">Now that you've learned how to identify run-time exceptions, advance to the next tutorial to learn how to create alerts in response to failures.</span><span class="sxs-lookup"><span data-stu-id="91be3-203">Now that you've learned how to identify run-time exceptions, advance to the next tutorial to learn how to create alerts in response to failures.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="91be3-204">Alert on application health</span><span class="sxs-lookup"><span data-stu-id="91be3-204">Alert on application health</span></span>](app-insights-tutorial-alert.md)
