---
title: Impactful maintenance for Windows VMs in Azure | Microsoft Docs
description: Impactful maintenance for Windows virtual machines.
services: virtual-machines-windows
documentationcenter: ''
author: ''
manager: timlt
editor: ''
tags: azure-service-management,azure-resource-manager
ms.assetid: ''
ms.service: virtual-machines-windows
ms.workload: infrastructure-services
ms.tgt_pltfrm: vm-windows
ms.devlang: na
ms.topic: article
ms.date: 03/27/2017
ms.author: ''
ms.openlocfilehash: b95a5bd216a6d9cdd6ae6ba8e849d0bf4be71fe5
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44564345"
---
# <a name="impactful-maintenance-for-virtual-machines"></a><span data-ttu-id="88070-103">Impactful maintenance for virtual machines</span><span class="sxs-lookup"><span data-stu-id="88070-103">Impactful maintenance for virtual machines</span></span>

<span data-ttu-id="88070-104">There are few cases where your VMs are rebooted due to planned maintenance to the underlying infrastructure.</span><span class="sxs-lookup"><span data-stu-id="88070-104">There are few cases where your VMs are rebooted due to planned maintenance to the underlying infrastructure.</span></span> <span data-ttu-id="88070-105">Being impactful to the availability of your VMs hosted in Azure, the following are now available for you to use:</span><span class="sxs-lookup"><span data-stu-id="88070-105">Being impactful to the availability of your VMs hosted in Azure, the following are now available for you to use:</span></span>

-   <span data-ttu-id="88070-106">Notification sent at least 30 days before the impact.</span><span class="sxs-lookup"><span data-stu-id="88070-106">Notification sent at least 30 days before the impact.</span></span>

-   <span data-ttu-id="88070-107">Visibility to the maintenance windows per each VM.</span><span class="sxs-lookup"><span data-stu-id="88070-107">Visibility to the maintenance windows per each VM.</span></span>

-   <span data-ttu-id="88070-108">Flexibility and control in setting the exact time for maintenance to impact your VMs.</span><span class="sxs-lookup"><span data-stu-id="88070-108">Flexibility and control in setting the exact time for maintenance to impact your VMs.</span></span>

<span data-ttu-id="88070-109">Maintenance in Microsoft Azure is scheduled in iterations.</span><span class="sxs-lookup"><span data-stu-id="88070-109">Maintenance in Microsoft Azure is scheduled in iterations.</span></span> <span data-ttu-id="88070-110">Initial iterations have smaller scope in order to reduce the risk involved in rolling out new fixes and capabilities.</span><span class="sxs-lookup"><span data-stu-id="88070-110">Initial iterations have smaller scope in order to reduce the risk involved in rolling out new fixes and capabilities.</span></span> <span data-ttu-id="88070-111">Later iterations may span multiple regions (never from the same region pair).</span><span class="sxs-lookup"><span data-stu-id="88070-111">Later iterations may span multiple regions (never from the same region pair).</span></span> <span data-ttu-id="88070-112">A VM is included in a single maintenance iteration.</span><span class="sxs-lookup"><span data-stu-id="88070-112">A VM is included in a single maintenance iteration.</span></span> <span data-ttu-id="88070-113">If an iteration is aborted, remaining VMs are included in another, future, iteration.</span><span class="sxs-lookup"><span data-stu-id="88070-113">If an iteration is aborted, remaining VMs are included in another, future, iteration.</span></span>

<span data-ttu-id="88070-114">The planned maintenance iteration has two phases: Pre-emptive Maintenance Window and a Scheduled-Maintenance Window.</span><span class="sxs-lookup"><span data-stu-id="88070-114">The planned maintenance iteration has two phases: Pre-emptive Maintenance Window and a Scheduled-Maintenance Window.</span></span>

<span data-ttu-id="88070-115">The **Pre-emptive Maintenance Window** provides you with the flexibility to initiate the maintenance on your VMs.</span><span class="sxs-lookup"><span data-stu-id="88070-115">The **Pre-emptive Maintenance Window** provides you with the flexibility to initiate the maintenance on your VMs.</span></span> <span data-ttu-id="88070-116">By doing so, you can determine when your VMs are impacted, the sequence of the update, and the time between each VM being maintained.</span><span class="sxs-lookup"><span data-stu-id="88070-116">By doing so, you can determine when your VMs are impacted, the sequence of the update, and the time between each VM being maintained.</span></span> <span data-ttu-id="88070-117">You can query each VM to see whether it is planned for maintenance and check the result of your last initiated maintenance request.</span><span class="sxs-lookup"><span data-stu-id="88070-117">You can query each VM to see whether it is planned for maintenance and check the result of your last initiated maintenance request.</span></span>

<span data-ttu-id="88070-118">The **Scheduled Maintenance Window** is when Azure has scheduled your VMs for the maintenance.</span><span class="sxs-lookup"><span data-stu-id="88070-118">The **Scheduled Maintenance Window** is when Azure has scheduled your VMs for the maintenance.</span></span> <span data-ttu-id="88070-119">During this time window, which follows the pre-emptive maintenance window, you can still query for the maintenance window, but no longer be able to orchestrate the maintenance.</span><span class="sxs-lookup"><span data-stu-id="88070-119">During this time window, which follows the pre-emptive maintenance window, you can still query for the maintenance window, but no longer be able to orchestrate the maintenance.</span></span>

## <a name="availability-considerations-during-planned-maintenance"></a><span data-ttu-id="88070-120">Availability Considerations during Planned Maintenance</span><span class="sxs-lookup"><span data-stu-id="88070-120">Availability Considerations during Planned Maintenance</span></span> 

### <a name="paired-regions"></a><span data-ttu-id="88070-121">Paired Regions</span><span class="sxs-lookup"><span data-stu-id="88070-121">Paired Regions</span></span>

<span data-ttu-id="88070-122">Each Azure region is paired with another region within the same geography, together making a regional pair.</span><span class="sxs-lookup"><span data-stu-id="88070-122">Each Azure region is paired with another region within the same geography, together making a regional pair.</span></span> <span data-ttu-id="88070-123">When executing maintenance, Azure will only update the Virtual Machine instances in a single region of its pair.</span><span class="sxs-lookup"><span data-stu-id="88070-123">When executing maintenance, Azure will only update the Virtual Machine instances in a single region of its pair.</span></span> <span data-ttu-id="88070-124">For example, when updating the Virtual Machines in North Central US, Azure will not update any Virtual Machines in South Central US at the same time.</span><span class="sxs-lookup"><span data-stu-id="88070-124">For example, when updating the Virtual Machines in North Central US, Azure will not update any Virtual Machines in South Central US at the same time.</span></span> <span data-ttu-id="88070-125">This will be scheduled at a separate time, enabling failover or load balancing between regions.</span><span class="sxs-lookup"><span data-stu-id="88070-125">This will be scheduled at a separate time, enabling failover or load balancing between regions.</span></span> <span data-ttu-id="88070-126">However, other regions such as North Europe can be under maintenance at the same time as East US.</span><span class="sxs-lookup"><span data-stu-id="88070-126">However, other regions such as North Europe can be under maintenance at the same time as East US.</span></span>
<span data-ttu-id="88070-127">Read more about [Azure region pairs](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).</span><span class="sxs-lookup"><span data-stu-id="88070-127">Read more about [Azure region pairs](https://docs.microsoft.com/azure/best-practices-availability-paired-regions).</span></span>

### <a name="single-instance-vms-vs-availability-set-or-vm-scale-set"></a><span data-ttu-id="88070-128">Single Instance VMs vs. Availability Set or VM scale set</span><span class="sxs-lookup"><span data-stu-id="88070-128">Single Instance VMs vs. Availability Set or VM scale set</span></span>

<span data-ttu-id="88070-129">When deploying a workload using virtual machines in Azure, you can create the VMs within an availability set in order to provide high availability to your application.</span><span class="sxs-lookup"><span data-stu-id="88070-129">When deploying a workload using virtual machines in Azure, you can create the VMs within an availability set in order to provide high availability to your application.</span></span> <span data-ttu-id="88070-130">This configuration ensures that during either an outage or maintenance events, at least one virtual machine is available.</span><span class="sxs-lookup"><span data-stu-id="88070-130">This configuration ensures that during either an outage or maintenance events, at least one virtual machine is available.</span></span>

<span data-ttu-id="88070-131">Within an availability set, individual VMs are spread across up to 20 update domains.</span><span class="sxs-lookup"><span data-stu-id="88070-131">Within an availability set, individual VMs are spread across up to 20 update domains.</span></span> <span data-ttu-id="88070-132">During planned maintenance, only a single update domain is impacted at any given time.</span><span class="sxs-lookup"><span data-stu-id="88070-132">During planned maintenance, only a single update domain is impacted at any given time.</span></span> <span data-ttu-id="88070-133">The order of update domains being impacted may not proceed sequentially during planned maintenance.</span><span class="sxs-lookup"><span data-stu-id="88070-133">The order of update domains being impacted may not proceed sequentially during planned maintenance.</span></span> <span data-ttu-id="88070-134">For single instance VMs (not part of availability set), there is no way to predict or determine which and how many VMs are impacted together.</span><span class="sxs-lookup"><span data-stu-id="88070-134">For single instance VMs (not part of availability set), there is no way to predict or determine which and how many VMs are impacted together.</span></span>

<span data-ttu-id="88070-135">Virtual machine scale sets are an Azure compute resource that enables you to deploy and manage a set of identical VMs as a single resource.</span><span class="sxs-lookup"><span data-stu-id="88070-135">Virtual machine scale sets are an Azure compute resource that enables you to deploy and manage a set of identical VMs as a single resource.</span></span>
<span data-ttu-id="88070-136">The scale set provides similar guarantees to an availability set in the form of update domains.</span><span class="sxs-lookup"><span data-stu-id="88070-136">The scale set provides similar guarantees to an availability set in the form of update domains.</span></span> 

<span data-ttu-id="88070-137">For more information about configuring your virtual machines for high availability, see [*Manage the availability of your Windows virtual machines*](../linux/manage-availability.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span><span class="sxs-lookup"><span data-stu-id="88070-137">For more information about configuring your virtual machines for high availability, see [*Manage the availability of your Windows virtual machines*](../linux/manage-availability.md?toc=%2fazure%2fvirtual-machines%2flinux%2ftoc.json).</span></span>

### <a name="scheduled-events"></a><span data-ttu-id="88070-138">Scheduled Events</span><span class="sxs-lookup"><span data-stu-id="88070-138">Scheduled Events</span></span>

<span data-ttu-id="88070-139">Azure Metadata Service enables you to discover information about your Virtual Machine hosted in Azure.</span><span class="sxs-lookup"><span data-stu-id="88070-139">Azure Metadata Service enables you to discover information about your Virtual Machine hosted in Azure.</span></span> <span data-ttu-id="88070-140">Scheduled Events, one of the exposed categories, surfaces information regarding upcoming events (for example, reboot) so your application can prepare for them and limit disruption.</span><span class="sxs-lookup"><span data-stu-id="88070-140">Scheduled Events, one of the exposed categories, surfaces information regarding upcoming events (for example, reboot) so your application can prepare for them and limit disruption.</span></span>

<span data-ttu-id="88070-141">For more information about scheduled events, refer to [Azure Metadata Service - Scheduled Events](../virtual-machines-scheduled-events.md).</span><span class="sxs-lookup"><span data-stu-id="88070-141">For more information about scheduled events, refer to [Azure Metadata Service - Scheduled Events](../virtual-machines-scheduled-events.md).</span></span>

## <a name="maintenance-discovery-and-notifications"></a><span data-ttu-id="88070-142">Maintenance Discovery and Notifications</span><span class="sxs-lookup"><span data-stu-id="88070-142">Maintenance Discovery and Notifications</span></span>

<span data-ttu-id="88070-143">Maintenance schedule is visible to customers at the level of individual VMs.</span><span class="sxs-lookup"><span data-stu-id="88070-143">Maintenance schedule is visible to customers at the level of individual VMs.</span></span> <span data-ttu-id="88070-144">You can use Azure portal, API, PowerShell, or CLI to query for the pre-emptive and scheduled maintenance windows.</span><span class="sxs-lookup"><span data-stu-id="88070-144">You can use Azure portal, API, PowerShell, or CLI to query for the pre-emptive and scheduled maintenance windows.</span></span> <span data-ttu-id="88070-145">In addition, expect to receive a notification (email) in the case where one (or more) of your VMs are impacted during the process.</span><span class="sxs-lookup"><span data-stu-id="88070-145">In addition, expect to receive a notification (email) in the case where one (or more) of your VMs are impacted during the process.</span></span>

<span data-ttu-id="88070-146">Both pre-emptive maintenance and scheduled maintenance phases begin with a notification.</span><span class="sxs-lookup"><span data-stu-id="88070-146">Both pre-emptive maintenance and scheduled maintenance phases begin with a notification.</span></span> <span data-ttu-id="88070-147">Expect to receive a single notification per Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="88070-147">Expect to receive a single notification per Azure subscription.</span></span> <span data-ttu-id="88070-148">The notification is sent to the subscription’s admin and co-admin by default.</span><span class="sxs-lookup"><span data-stu-id="88070-148">The notification is sent to the subscription’s admin and co-admin by default.</span></span> <span data-ttu-id="88070-149">You can also configure the audience for the maintenance notification.</span><span class="sxs-lookup"><span data-stu-id="88070-149">You can also configure the audience for the maintenance notification.</span></span>

### <a name="view-the-maintenance-window-in-the-portal"></a><span data-ttu-id="88070-150">View the Maintenance Window in the portal</span><span class="sxs-lookup"><span data-stu-id="88070-150">View the Maintenance Window in the portal</span></span> 

<span data-ttu-id="88070-151">You can use the Azure portal and look for VMs scheduled for maintenance.</span><span class="sxs-lookup"><span data-stu-id="88070-151">You can use the Azure portal and look for VMs scheduled for maintenance.</span></span>

1.  <span data-ttu-id="88070-152">Sign in to the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="88070-152">Sign in to the Azure portal.</span></span>

2.  <span data-ttu-id="88070-153">Click and open the **Virtual Machines** blade.</span><span class="sxs-lookup"><span data-stu-id="88070-153">Click and open the **Virtual Machines** blade.</span></span>

3.  <span data-ttu-id="88070-154">Click the **Columns** button to open the list of available columns to choose from</span><span class="sxs-lookup"><span data-stu-id="88070-154">Click the **Columns** button to open the list of available columns to choose from</span></span>

4.  <span data-ttu-id="88070-155">Select and add the **Maintenance Window** columns.</span><span class="sxs-lookup"><span data-stu-id="88070-155">Select and add the **Maintenance Window** columns.</span></span> <span data-ttu-id="88070-156">VMs that are scheduled for maintenance have the maintenance windows surfaced.</span><span class="sxs-lookup"><span data-stu-id="88070-156">VMs that are scheduled for maintenance have the maintenance windows surfaced.</span></span> <span data-ttu-id="88070-157">Once maintenance is completed or aborted for a, the maintenance window is no longer be presented.</span><span class="sxs-lookup"><span data-stu-id="88070-157">Once maintenance is completed or aborted for a, the maintenance window is no longer be presented.</span></span>

### <a name="query-maintenance-details-using-the-azure-api"></a><span data-ttu-id="88070-158">Query maintenance details using the Azure API</span><span class="sxs-lookup"><span data-stu-id="88070-158">Query maintenance details using the Azure API</span></span>

<span data-ttu-id="88070-159">Use the [get VM information API](https://docs.microsoft.com/rest/api/compute/virtualmachines/virtualmachines-get) and look for the instance view to discover the maintenance details on an individual VM.</span><span class="sxs-lookup"><span data-stu-id="88070-159">Use the [get VM information API](https://docs.microsoft.com/rest/api/compute/virtualmachines/virtualmachines-get) and look for the instance view to discover the maintenance details on an individual VM.</span></span> <span data-ttu-id="88070-160">The response includes the following elements:</span><span class="sxs-lookup"><span data-stu-id="88070-160">The response includes the following elements:</span></span>

  - <span data-ttu-id="88070-161">isCustomerInitiatedMaintenanceAllowed: Indicates whether you can now initiate pre-emptive redeploy on the VM.</span><span class="sxs-lookup"><span data-stu-id="88070-161">isCustomerInitiatedMaintenanceAllowed: Indicates whether you can now initiate pre-emptive redeploy on the VM.</span></span>

  - <span data-ttu-id="88070-162">preMaintenanceWindowStartTime: The start time of the pre-emptive maintenance window.</span><span class="sxs-lookup"><span data-stu-id="88070-162">preMaintenanceWindowStartTime: The start time of the pre-emptive maintenance window.</span></span>

  - <span data-ttu-id="88070-163">preMaintenanceWindowEndTime: The end time of the pre-emptive maintenance window.</span><span class="sxs-lookup"><span data-stu-id="88070-163">preMaintenanceWindowEndTime: The end time of the pre-emptive maintenance window.</span></span> <span data-ttu-id="88070-164">After this time, you will no longer be able to initiate maintenance on this VM.</span><span class="sxs-lookup"><span data-stu-id="88070-164">After this time, you will no longer be able to initiate maintenance on this VM.</span></span>
    
  - <span data-ttu-id="88070-165">maintenanceWindowStartTime: The start time of the scheduled maintenance window when your VM are impacted.</span><span class="sxs-lookup"><span data-stu-id="88070-165">maintenanceWindowStartTime: The start time of the scheduled maintenance window when your VM are impacted.</span></span>

  - <span data-ttu-id="88070-166">maintenanceWindowEndTime: The end time of the scheduled maintenance window.</span><span class="sxs-lookup"><span data-stu-id="88070-166">maintenanceWindowEndTime: The end time of the scheduled maintenance window.</span></span>
  
  - <span data-ttu-id="88070-167">lastOperationResultCode: The result of your last Maintenance-Redeploy operation.</span><span class="sxs-lookup"><span data-stu-id="88070-167">lastOperationResultCode: The result of your last Maintenance-Redeploy operation.</span></span>
 
  - <span data-ttu-id="88070-168">lastOperationMessage:  Message describing the result of your last Maintenance-Redeploy operation.</span><span class="sxs-lookup"><span data-stu-id="88070-168">lastOperationMessage:  Message describing the result of your last Maintenance-Redeploy operation.</span></span>

## <a name="pre-emptive-redeploy"></a><span data-ttu-id="88070-169">Pre-emptive Redeploy</span><span class="sxs-lookup"><span data-stu-id="88070-169">Pre-emptive Redeploy</span></span>

<span data-ttu-id="88070-170">Pre-emptive redeploy action provides the flexibility to control the time when maintenance is applied to your VMs in Azure.</span><span class="sxs-lookup"><span data-stu-id="88070-170">Pre-emptive redeploy action provides the flexibility to control the time when maintenance is applied to your VMs in Azure.</span></span> <span data-ttu-id="88070-171">Planned maintenance begins with a pre-emptive maintenance window where you can decide on the exact time for each of your VMs to be rebooted.</span><span class="sxs-lookup"><span data-stu-id="88070-171">Planned maintenance begins with a pre-emptive maintenance window where you can decide on the exact time for each of your VMs to be rebooted.</span></span> <span data-ttu-id="88070-172">The following are use cases where such a functionality is useful:</span><span class="sxs-lookup"><span data-stu-id="88070-172">The following are use cases where such a functionality is useful:</span></span>

-   <span data-ttu-id="88070-173">Maintenance need to be coordinated with the end customer.</span><span class="sxs-lookup"><span data-stu-id="88070-173">Maintenance need to be coordinated with the end customer.</span></span>

-   <span data-ttu-id="88070-174">The scheduled maintenance window offered by Azure is not sufficient.</span><span class="sxs-lookup"><span data-stu-id="88070-174">The scheduled maintenance window offered by Azure is not sufficient.</span></span>
    <span data-ttu-id="88070-175">It could be that the window happens to be on the busiest time of the week or it is too long.</span><span class="sxs-lookup"><span data-stu-id="88070-175">It could be that the window happens to be on the busiest time of the week or it is too long.</span></span>

-   <span data-ttu-id="88070-176">For multi-instance or multi-tier applications, you need sufficient time between two VMs or a certain sequence to follow.</span><span class="sxs-lookup"><span data-stu-id="88070-176">For multi-instance or multi-tier applications, you need sufficient time between two VMs or a certain sequence to follow.</span></span>

<span data-ttu-id="88070-177">When you call for pre-emptive redeploy on a VM, it moves the VM to an already updated node and then powers it back on, retaining all your configuration options and associated resources.</span><span class="sxs-lookup"><span data-stu-id="88070-177">When you call for pre-emptive redeploy on a VM, it moves the VM to an already updated node and then powers it back on, retaining all your configuration options and associated resources.</span></span> <span data-ttu-id="88070-178">While doing so, the temporary disk is lost and dynamic IP addresses associated with virtual network interface are updated.</span><span class="sxs-lookup"><span data-stu-id="88070-178">While doing so, the temporary disk is lost and dynamic IP addresses associated with virtual network interface are updated.</span></span>

<span data-ttu-id="88070-179">Pre-emptive redeploy is enabled once per VM.</span><span class="sxs-lookup"><span data-stu-id="88070-179">Pre-emptive redeploy is enabled once per VM.</span></span> <span data-ttu-id="88070-180">If there is an error during the process, the operation is aborted, the VM is not impacted and it is excluded from the planned maintenance iteration.</span><span class="sxs-lookup"><span data-stu-id="88070-180">If there is an error during the process, the operation is aborted, the VM is not impacted and it is excluded from the planned maintenance iteration.</span></span> <span data-ttu-id="88070-181">You will be contacted in a later time with a new schedule and offered a new opportunity to schedule and sequence the impact on your VMs.</span><span class="sxs-lookup"><span data-stu-id="88070-181">You will be contacted in a later time with a new schedule and offered a new opportunity to schedule and sequence the impact on your VMs.</span></span>