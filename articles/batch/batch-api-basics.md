---
title: Overview of Azure Batch for developers | Microsoft Docs
description: Learn the features of the Batch service and its APIs from a development standpoint.
services: batch
documentationcenter: .net
author: tamram
manager: timlt
editor: ''
ms.assetid: 416b95f8-2d7b-4111-8012-679b0f60d204
ms.service: batch
ms.devlang: multiple
ms.topic: get-started-article
ms.tgt_pltfrm: na
ms.workload: big-compute
ms.date: 03/27/2017
ms.author: tamram
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: 69b16f4846c1717ce6e53ac2ad419a640214825f
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44554217"
---
# <a name="develop-large-scale-parallel-compute-solutions-with-batch"></a><span data-ttu-id="49f00-103">Develop large-scale parallel compute solutions with Batch</span><span class="sxs-lookup"><span data-stu-id="49f00-103">Develop large-scale parallel compute solutions with Batch</span></span>

<span data-ttu-id="49f00-104">In this overview of the core components of the Azure Batch service, we discuss the primary service features and resources that Batch developers can use to build large-scale parallel compute solutions.</span><span class="sxs-lookup"><span data-stu-id="49f00-104">In this overview of the core components of the Azure Batch service, we discuss the primary service features and resources that Batch developers can use to build large-scale parallel compute solutions.</span></span>

<span data-ttu-id="49f00-105">Whether you're developing a distributed computational application or service that issues direct [REST API][batch_rest_api] calls or you're using one of the [Batch SDKs](batch-apis-tools.md#batch-development-apis), you'll use many of the resources and features discussed in this article.</span><span class="sxs-lookup"><span data-stu-id="49f00-105">Whether you're developing a distributed computational application or service that issues direct [REST API][batch_rest_api] calls or you're using one of the [Batch SDKs](batch-apis-tools.md#batch-development-apis), you'll use many of the resources and features discussed in this article.</span></span>

> [!TIP]
> <span data-ttu-id="49f00-106">For a higher-level introduction to the Batch service, see [Basics of Azure Batch](batch-technical-overview.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-106">For a higher-level introduction to the Batch service, see [Basics of Azure Batch](batch-technical-overview.md).</span></span>
>
>

## <a name="batch-service-workflow"></a><span data-ttu-id="49f00-107">Batch service workflow</span><span class="sxs-lookup"><span data-stu-id="49f00-107">Batch service workflow</span></span>
<span data-ttu-id="49f00-108">The following high-level workflow is typical of nearly all applications and services that use the Batch service for processing parallel workloads:</span><span class="sxs-lookup"><span data-stu-id="49f00-108">The following high-level workflow is typical of nearly all applications and services that use the Batch service for processing parallel workloads:</span></span>

1. <span data-ttu-id="49f00-109">Upload the **data files** that you want to process to an [Azure Storage][azure_storage] account.</span><span class="sxs-lookup"><span data-stu-id="49f00-109">Upload the **data files** that you want to process to an [Azure Storage][azure_storage] account.</span></span> <span data-ttu-id="49f00-110">Batch includes built-in support for accessing Azure Blob storage, and your tasks can download these files to [compute nodes](#compute-node) when the tasks are run.</span><span class="sxs-lookup"><span data-stu-id="49f00-110">Batch includes built-in support for accessing Azure Blob storage, and your tasks can download these files to [compute nodes](#compute-node) when the tasks are run.</span></span>
2. <span data-ttu-id="49f00-111">Upload the **application files** that your tasks will run.</span><span class="sxs-lookup"><span data-stu-id="49f00-111">Upload the **application files** that your tasks will run.</span></span> <span data-ttu-id="49f00-112">These files can be binaries or scripts and their dependencies, and are executed by the tasks in your jobs.</span><span class="sxs-lookup"><span data-stu-id="49f00-112">These files can be binaries or scripts and their dependencies, and are executed by the tasks in your jobs.</span></span> <span data-ttu-id="49f00-113">Your tasks can download these files from your Storage account, or you can use the [application packages](#application-packages) feature of Batch for application management and deployment.</span><span class="sxs-lookup"><span data-stu-id="49f00-113">Your tasks can download these files from your Storage account, or you can use the [application packages](#application-packages) feature of Batch for application management and deployment.</span></span>
3. <span data-ttu-id="49f00-114">Create a [pool](#pool) of compute nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-114">Create a [pool](#pool) of compute nodes.</span></span> <span data-ttu-id="49f00-115">When you create a pool, you specify the number of compute nodes for the pool, their size, and the operating system.</span><span class="sxs-lookup"><span data-stu-id="49f00-115">When you create a pool, you specify the number of compute nodes for the pool, their size, and the operating system.</span></span> <span data-ttu-id="49f00-116">When each task in your job runs, it's assigned to execute on one of the nodes in your pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-116">When each task in your job runs, it's assigned to execute on one of the nodes in your pool.</span></span>
4. <span data-ttu-id="49f00-117">Create a [job](#job).</span><span class="sxs-lookup"><span data-stu-id="49f00-117">Create a [job](#job).</span></span> <span data-ttu-id="49f00-118">A job manages a collection of tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-118">A job manages a collection of tasks.</span></span> <span data-ttu-id="49f00-119">You associate each job to a specific pool where that job's tasks will run.</span><span class="sxs-lookup"><span data-stu-id="49f00-119">You associate each job to a specific pool where that job's tasks will run.</span></span>
5. <span data-ttu-id="49f00-120">Add [tasks](#task) to the job.</span><span class="sxs-lookup"><span data-stu-id="49f00-120">Add [tasks](#task) to the job.</span></span> <span data-ttu-id="49f00-121">Each task runs the application or script that you uploaded to process the data files it downloads from your Storage account.</span><span class="sxs-lookup"><span data-stu-id="49f00-121">Each task runs the application or script that you uploaded to process the data files it downloads from your Storage account.</span></span> <span data-ttu-id="49f00-122">As each task completes, it can upload its output to Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="49f00-122">As each task completes, it can upload its output to Azure Storage.</span></span>
6. <span data-ttu-id="49f00-123">Monitor job progress and retrieve the task output from Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="49f00-123">Monitor job progress and retrieve the task output from Azure Storage.</span></span>

<span data-ttu-id="49f00-124">The following sections discuss these and the other resources of Batch that enable your distributed computational scenario.</span><span class="sxs-lookup"><span data-stu-id="49f00-124">The following sections discuss these and the other resources of Batch that enable your distributed computational scenario.</span></span>

> [!NOTE]
> <span data-ttu-id="49f00-125">You need a [Batch account](#account) to use the Batch service.</span><span class="sxs-lookup"><span data-stu-id="49f00-125">You need a [Batch account](#account) to use the Batch service.</span></span> <span data-ttu-id="49f00-126">Also, nearly all solutions use an [Azure Storage][azure_storage] account for file storage and retrieval.</span><span class="sxs-lookup"><span data-stu-id="49f00-126">Also, nearly all solutions use an [Azure Storage][azure_storage] account for file storage and retrieval.</span></span> <span data-ttu-id="49f00-127">Batch currently supports only the **General purpose** storage account type, as described in step 5 of [Create a storage account](../storage/storage-create-storage-account.md#create-a-storage-account) in [About Azure storage accounts](../storage/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-127">Batch currently supports only the **General purpose** storage account type, as described in step 5 of [Create a storage account](../storage/storage-create-storage-account.md#create-a-storage-account) in [About Azure storage accounts](../storage/storage-create-storage-account.md).</span></span>
>
>

## <a name="batch-service-resources"></a><span data-ttu-id="49f00-128">Batch service resources</span><span class="sxs-lookup"><span data-stu-id="49f00-128">Batch service resources</span></span>
<span data-ttu-id="49f00-129">Some of the following resources--accounts, compute nodes, pools, jobs, and tasks--are required by all solutions that use the Batch service.</span><span class="sxs-lookup"><span data-stu-id="49f00-129">Some of the following resources--accounts, compute nodes, pools, jobs, and tasks--are required by all solutions that use the Batch service.</span></span> <span data-ttu-id="49f00-130">Others, like job schedules and application packages, are helpful, but optional, features.</span><span class="sxs-lookup"><span data-stu-id="49f00-130">Others, like job schedules and application packages, are helpful, but optional, features.</span></span>

* [<span data-ttu-id="49f00-131">Account</span><span class="sxs-lookup"><span data-stu-id="49f00-131">Account</span></span>](#account)
* [<span data-ttu-id="49f00-132">Compute node</span><span class="sxs-lookup"><span data-stu-id="49f00-132">Compute node</span></span>](#compute-node)
* [<span data-ttu-id="49f00-133">Pool</span><span class="sxs-lookup"><span data-stu-id="49f00-133">Pool</span></span>](#pool)
* [<span data-ttu-id="49f00-134">Job</span><span class="sxs-lookup"><span data-stu-id="49f00-134">Job</span></span>](#job)

  * [<span data-ttu-id="49f00-135">Job schedules</span><span class="sxs-lookup"><span data-stu-id="49f00-135">Job schedules</span></span>](#scheduled-jobs)
* [<span data-ttu-id="49f00-136">Task</span><span class="sxs-lookup"><span data-stu-id="49f00-136">Task</span></span>](#task)

  * [<span data-ttu-id="49f00-137">Start task</span><span class="sxs-lookup"><span data-stu-id="49f00-137">Start task</span></span>](#start-task)
  * [<span data-ttu-id="49f00-138">Job manager task</span><span class="sxs-lookup"><span data-stu-id="49f00-138">Job manager task</span></span>](#job-manager-task)
  * [<span data-ttu-id="49f00-139">Job preparation and release tasks</span><span class="sxs-lookup"><span data-stu-id="49f00-139">Job preparation and release tasks</span></span>](#job-preparation-and-release-tasks)
  * [<span data-ttu-id="49f00-140">Multi-instance task (MPI)</span><span class="sxs-lookup"><span data-stu-id="49f00-140">Multi-instance task (MPI)</span></span>](#multi-instance-tasks)
  * [<span data-ttu-id="49f00-141">Task dependencies</span><span class="sxs-lookup"><span data-stu-id="49f00-141">Task dependencies</span></span>](#task-dependencies)
* [<span data-ttu-id="49f00-142">Application packages</span><span class="sxs-lookup"><span data-stu-id="49f00-142">Application packages</span></span>](#application-packages)

## <a name="account"></a><span data-ttu-id="49f00-143">Account</span><span class="sxs-lookup"><span data-stu-id="49f00-143">Account</span></span>
<span data-ttu-id="49f00-144">A Batch account is a uniquely identified entity within the Batch service.</span><span class="sxs-lookup"><span data-stu-id="49f00-144">A Batch account is a uniquely identified entity within the Batch service.</span></span> <span data-ttu-id="49f00-145">All processing is associated with a Batch account.</span><span class="sxs-lookup"><span data-stu-id="49f00-145">All processing is associated with a Batch account.</span></span>

<span data-ttu-id="49f00-146">You can create an Azure Batch account using the [Azure portal](batch-account-create-portal.md) or programmatically, such as with the [Batch Management .NET library](batch-management-dotnet.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-146">You can create an Azure Batch account using the [Azure portal](batch-account-create-portal.md) or programmatically, such as with the [Batch Management .NET library](batch-management-dotnet.md).</span></span> <span data-ttu-id="49f00-147">When creating the account, you can associate an Azure storage account.</span><span class="sxs-lookup"><span data-stu-id="49f00-147">When creating the account, you can associate an Azure storage account.</span></span>

<span data-ttu-id="49f00-148">Batch supports two account configurations, based on the *pool allocation mode* property.</span><span class="sxs-lookup"><span data-stu-id="49f00-148">Batch supports two account configurations, based on the *pool allocation mode* property.</span></span> <span data-ttu-id="49f00-149">The two configurations give you different options for authenticating with the Batch service and for provisioning and managing Batch [pools](#pool) (see later in this article).</span><span class="sxs-lookup"><span data-stu-id="49f00-149">The two configurations give you different options for authenticating with the Batch service and for provisioning and managing Batch [pools](#pool) (see later in this article).</span></span> 


* <span data-ttu-id="49f00-150">**Batch service** (default): You can access the Batch APIs using either shared key authentication or [Azure Active Directory authentication](batch-aad-auth.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-150">**Batch service** (default): You can access the Batch APIs using either shared key authentication or [Azure Active Directory authentication](batch-aad-auth.md).</span></span> <span data-ttu-id="49f00-151">Batch compute resources are allocated behind the scenes in an Azure-managed account.</span><span class="sxs-lookup"><span data-stu-id="49f00-151">Batch compute resources are allocated behind the scenes in an Azure-managed account.</span></span>   
* <span data-ttu-id="49f00-152">**User subscription**: You can only access the Batch APIs using [Azure Active Directory authentication](batch-aad-auth.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-152">**User subscription**: You can only access the Batch APIs using [Azure Active Directory authentication](batch-aad-auth.md).</span></span> <span data-ttu-id="49f00-153">Batch compute resources are allocated directly in your Azure subscription.</span><span class="sxs-lookup"><span data-stu-id="49f00-153">Batch compute resources are allocated directly in your Azure subscription.</span></span> <span data-ttu-id="49f00-154">This mode gives you more flexibility to configure the compute nodes and integrate with other services.</span><span class="sxs-lookup"><span data-stu-id="49f00-154">This mode gives you more flexibility to configure the compute nodes and integrate with other services.</span></span> <span data-ttu-id="49f00-155">This mode requires you to set up an additional Azure key vault for your Batch account.</span><span class="sxs-lookup"><span data-stu-id="49f00-155">This mode requires you to set up an additional Azure key vault for your Batch account.</span></span>
 

## <a name="compute-node"></a><span data-ttu-id="49f00-156">Compute node</span><span class="sxs-lookup"><span data-stu-id="49f00-156">Compute node</span></span>
<span data-ttu-id="49f00-157">A compute node is an Azure virtual machine (VM) that is dedicated to processing a portion of your application's workload.</span><span class="sxs-lookup"><span data-stu-id="49f00-157">A compute node is an Azure virtual machine (VM) that is dedicated to processing a portion of your application's workload.</span></span> <span data-ttu-id="49f00-158">The size of a node determines the number of CPU cores, memory capacity, and local file system size that is allocated to the node.</span><span class="sxs-lookup"><span data-stu-id="49f00-158">The size of a node determines the number of CPU cores, memory capacity, and local file system size that is allocated to the node.</span></span> <span data-ttu-id="49f00-159">You can create pools of Windows or Linux nodes by using either Azure Cloud Services or Virtual Machines Marketplace images.</span><span class="sxs-lookup"><span data-stu-id="49f00-159">You can create pools of Windows or Linux nodes by using either Azure Cloud Services or Virtual Machines Marketplace images.</span></span> <span data-ttu-id="49f00-160">See the following [Pool](#pool) section for more information on these options.</span><span class="sxs-lookup"><span data-stu-id="49f00-160">See the following [Pool](#pool) section for more information on these options.</span></span>

<span data-ttu-id="49f00-161">Nodes can run any executable or script that is supported by the operating system environment of the node.</span><span class="sxs-lookup"><span data-stu-id="49f00-161">Nodes can run any executable or script that is supported by the operating system environment of the node.</span></span> <span data-ttu-id="49f00-162">This includes \*.exe, \*.cmd, \*.bat and PowerShell scripts for Windows--and binaries, shell, and Python scripts for Linux.</span><span class="sxs-lookup"><span data-stu-id="49f00-162">This includes \*.exe, \*.cmd, \*.bat and PowerShell scripts for Windows--and binaries, shell, and Python scripts for Linux.</span></span>

<span data-ttu-id="49f00-163">All compute nodes in Batch also include:</span><span class="sxs-lookup"><span data-stu-id="49f00-163">All compute nodes in Batch also include:</span></span>

* <span data-ttu-id="49f00-164">A standard [folder structure](#files-and-directories) and associated [environment variables](#environment-settings-for-tasks) that are available for reference by tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-164">A standard [folder structure](#files-and-directories) and associated [environment variables](#environment-settings-for-tasks) that are available for reference by tasks.</span></span>
* <span data-ttu-id="49f00-165">**Firewall** settings that are configured to control access.</span><span class="sxs-lookup"><span data-stu-id="49f00-165">**Firewall** settings that are configured to control access.</span></span>
* <span data-ttu-id="49f00-166">[Remote access](#connecting-to-compute-nodes) to both Windows (Remote Desktop Protocol (RDP)) and Linux (Secure Shell (SSH)) nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-166">[Remote access](#connecting-to-compute-nodes) to both Windows (Remote Desktop Protocol (RDP)) and Linux (Secure Shell (SSH)) nodes.</span></span>

## <a name="pool"></a><span data-ttu-id="49f00-167">Pool</span><span class="sxs-lookup"><span data-stu-id="49f00-167">Pool</span></span>
<span data-ttu-id="49f00-168">A pool is a collection of nodes that your application runs on.</span><span class="sxs-lookup"><span data-stu-id="49f00-168">A pool is a collection of nodes that your application runs on.</span></span> <span data-ttu-id="49f00-169">The pool can be created manually by you, or automatically by the Batch service when you specify the work to be done.</span><span class="sxs-lookup"><span data-stu-id="49f00-169">The pool can be created manually by you, or automatically by the Batch service when you specify the work to be done.</span></span> <span data-ttu-id="49f00-170">You can create and manage a pool that meets the resource requirements of your application.</span><span class="sxs-lookup"><span data-stu-id="49f00-170">You can create and manage a pool that meets the resource requirements of your application.</span></span> <span data-ttu-id="49f00-171">A pool can be used only by the Batch account in which it was created.</span><span class="sxs-lookup"><span data-stu-id="49f00-171">A pool can be used only by the Batch account in which it was created.</span></span> <span data-ttu-id="49f00-172">A Batch account can have more than one pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-172">A Batch account can have more than one pool.</span></span>

<span data-ttu-id="49f00-173">Azure Batch pools build on top of the core Azure compute platform.</span><span class="sxs-lookup"><span data-stu-id="49f00-173">Azure Batch pools build on top of the core Azure compute platform.</span></span> <span data-ttu-id="49f00-174">They provide large-scale allocation, application installation, data distribution, health monitoring, and flexible adjustment of the number of compute nodes within a pool ([scaling](#scaling-compute-resources)).</span><span class="sxs-lookup"><span data-stu-id="49f00-174">They provide large-scale allocation, application installation, data distribution, health monitoring, and flexible adjustment of the number of compute nodes within a pool ([scaling](#scaling-compute-resources)).</span></span>

<span data-ttu-id="49f00-175">Every node that is added to a pool is assigned a unique name and IP address.</span><span class="sxs-lookup"><span data-stu-id="49f00-175">Every node that is added to a pool is assigned a unique name and IP address.</span></span> <span data-ttu-id="49f00-176">When a node is removed from a pool, any changes that are made to the operating system or files are lost, and its name and IP address are released for future use.</span><span class="sxs-lookup"><span data-stu-id="49f00-176">When a node is removed from a pool, any changes that are made to the operating system or files are lost, and its name and IP address are released for future use.</span></span> <span data-ttu-id="49f00-177">When a node leaves a pool, its lifetime is over.</span><span class="sxs-lookup"><span data-stu-id="49f00-177">When a node leaves a pool, its lifetime is over.</span></span>

<span data-ttu-id="49f00-178">When you create a pool, you can specify the following attributes.</span><span class="sxs-lookup"><span data-stu-id="49f00-178">When you create a pool, you can specify the following attributes.</span></span> <span data-ttu-id="49f00-179">Some settings differ, depending on the pool allocation mode of the Batch [account](#account).</span><span class="sxs-lookup"><span data-stu-id="49f00-179">Some settings differ, depending on the pool allocation mode of the Batch [account](#account).</span></span>

* <span data-ttu-id="49f00-180">Compute node **operating system** and **version**</span><span class="sxs-lookup"><span data-stu-id="49f00-180">Compute node **operating system** and **version**</span></span>

    > [!NOTE]
    > <span data-ttu-id="49f00-181">In the Batch service pool allocation mode, you have two options when you select an operating system for the nodes in your pool: **Virtual Machine Configuration** and **Cloud Services Configuration**.</span><span class="sxs-lookup"><span data-stu-id="49f00-181">In the Batch service pool allocation mode, you have two options when you select an operating system for the nodes in your pool: **Virtual Machine Configuration** and **Cloud Services Configuration**.</span></span> <span data-ttu-id="49f00-182">In the user subscription mode, you can only use the Virtual Machine Configuration.</span><span class="sxs-lookup"><span data-stu-id="49f00-182">In the user subscription mode, you can only use the Virtual Machine Configuration.</span></span>
    >

    <span data-ttu-id="49f00-183">**Virtual Machine Configuration** provides both Linux and Windows images for compute nodes from the [Azure Virtual Machines Marketplace][vm_marketplace] and, in the user subscription allocation mode, the option to use custom VM images.</span><span class="sxs-lookup"><span data-stu-id="49f00-183">**Virtual Machine Configuration** provides both Linux and Windows images for compute nodes from the [Azure Virtual Machines Marketplace][vm_marketplace] and, in the user subscription allocation mode, the option to use custom VM images.</span></span>

    <span data-ttu-id="49f00-184">When you create a pool that contains Virtual Machine Configuration nodes, you must specify not only the size of the nodes, but also the **virtual machine image reference** and the Batch **node agent SKU** to be installed on the nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-184">When you create a pool that contains Virtual Machine Configuration nodes, you must specify not only the size of the nodes, but also the **virtual machine image reference** and the Batch **node agent SKU** to be installed on the nodes.</span></span> <span data-ttu-id="49f00-185">For more information about specifying these pool properties, see [Provision Linux compute nodes in Azure Batch pools](batch-linux-nodes.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-185">For more information about specifying these pool properties, see [Provision Linux compute nodes in Azure Batch pools](batch-linux-nodes.md).</span></span>

    <span data-ttu-id="49f00-186">**Cloud Services Configuration** provides Windows compute nodes *only*.</span><span class="sxs-lookup"><span data-stu-id="49f00-186">**Cloud Services Configuration** provides Windows compute nodes *only*.</span></span> <span data-ttu-id="49f00-187">Available operating systems for Cloud Services Configuration pools are listed in the [Azure Guest OS releases and SDK compatibility matrix](../cloud-services/cloud-services-guestos-update-matrix.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-187">Available operating systems for Cloud Services Configuration pools are listed in the [Azure Guest OS releases and SDK compatibility matrix](../cloud-services/cloud-services-guestos-update-matrix.md).</span></span> <span data-ttu-id="49f00-188">When you create a pool that contains Cloud Services nodes, you need to specify only the node size and its *OS Family*.</span><span class="sxs-lookup"><span data-stu-id="49f00-188">When you create a pool that contains Cloud Services nodes, you need to specify only the node size and its *OS Family*.</span></span> <span data-ttu-id="49f00-189">When you create pools of Windows compute nodes, you most commonly use Cloud Services.</span><span class="sxs-lookup"><span data-stu-id="49f00-189">When you create pools of Windows compute nodes, you most commonly use Cloud Services.</span></span>

  * <span data-ttu-id="49f00-190">The *OS Family* also determines which versions of .NET are installed with the OS.</span><span class="sxs-lookup"><span data-stu-id="49f00-190">The *OS Family* also determines which versions of .NET are installed with the OS.</span></span>
  * <span data-ttu-id="49f00-191">As with worker roles within Cloud Services, you can specify an *OS Version* (for more information on worker roles, see the [Tell me about cloud services](../cloud-services/cloud-services-choose-me.md#tell-me-about-cloud-services) section in the [Cloud Services overview](../cloud-services/cloud-services-choose-me.md)).</span><span class="sxs-lookup"><span data-stu-id="49f00-191">As with worker roles within Cloud Services, you can specify an *OS Version* (for more information on worker roles, see the [Tell me about cloud services](../cloud-services/cloud-services-choose-me.md#tell-me-about-cloud-services) section in the [Cloud Services overview](../cloud-services/cloud-services-choose-me.md)).</span></span>
  * <span data-ttu-id="49f00-192">As with worker roles, we recommend that you specify `*` for the *OS Version* so that the nodes are automatically upgraded, and there is no work required to cater to newly released versions.</span><span class="sxs-lookup"><span data-stu-id="49f00-192">As with worker roles, we recommend that you specify `*` for the *OS Version* so that the nodes are automatically upgraded, and there is no work required to cater to newly released versions.</span></span> <span data-ttu-id="49f00-193">The primary use case for selecting a specific OS version is to ensure application compatibility, which allows backward compatibility testing to be performed before allowing the version to be updated.</span><span class="sxs-lookup"><span data-stu-id="49f00-193">The primary use case for selecting a specific OS version is to ensure application compatibility, which allows backward compatibility testing to be performed before allowing the version to be updated.</span></span> <span data-ttu-id="49f00-194">After validation, the *OS Version* for the pool can be updated and the new OS image can be installed--any running tasks are interrupted and requeued.</span><span class="sxs-lookup"><span data-stu-id="49f00-194">After validation, the *OS Version* for the pool can be updated and the new OS image can be installed--any running tasks are interrupted and requeued.</span></span>
* <span data-ttu-id="49f00-195">**Size of the nodes**</span><span class="sxs-lookup"><span data-stu-id="49f00-195">**Size of the nodes**</span></span>

    <span data-ttu-id="49f00-196">**Cloud Services Configuration** compute node sizes are listed in [Sizes for Cloud Services](../cloud-services/cloud-services-sizes-specs.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-196">**Cloud Services Configuration** compute node sizes are listed in [Sizes for Cloud Services](../cloud-services/cloud-services-sizes-specs.md).</span></span> <span data-ttu-id="49f00-197">Batch supports all Cloud Services sizes except `ExtraSmall`, `STANDARD_A1_V2`, and `STANDARD_A2_V2`.</span><span class="sxs-lookup"><span data-stu-id="49f00-197">Batch supports all Cloud Services sizes except `ExtraSmall`, `STANDARD_A1_V2`, and `STANDARD_A2_V2`.</span></span>

    <span data-ttu-id="49f00-198">**Virtual Machine Configuration** compute node sizes are listed in [Sizes for virtual machines in Azure](../virtual-machines/linux/sizes.md) (Linux) and [Sizes for virtual machines in Azure](../virtual-machines/windows/sizes.md) (Windows).</span><span class="sxs-lookup"><span data-stu-id="49f00-198">**Virtual Machine Configuration** compute node sizes are listed in [Sizes for virtual machines in Azure](../virtual-machines/linux/sizes.md) (Linux) and [Sizes for virtual machines in Azure](../virtual-machines/windows/sizes.md) (Windows).</span></span> <span data-ttu-id="49f00-199">Batch supports all Azure VM sizes except `STANDARD_A0` and those with premium storage (`STANDARD_GS`, `STANDARD_DS`, and `STANDARD_DSV2` series).</span><span class="sxs-lookup"><span data-stu-id="49f00-199">Batch supports all Azure VM sizes except `STANDARD_A0` and those with premium storage (`STANDARD_GS`, `STANDARD_DS`, and `STANDARD_DSV2` series).</span></span>

    <span data-ttu-id="49f00-200">When selecting a compute node size, consider the characteristics and requirements of the applications you'll run on the nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-200">When selecting a compute node size, consider the characteristics and requirements of the applications you'll run on the nodes.</span></span> <span data-ttu-id="49f00-201">Aspects like whether the application is multithreaded and how much memory it consumes can help determine the most suitable and cost-effective node size.</span><span class="sxs-lookup"><span data-stu-id="49f00-201">Aspects like whether the application is multithreaded and how much memory it consumes can help determine the most suitable and cost-effective node size.</span></span> <span data-ttu-id="49f00-202">It's typical to select a node size assuming one task will run on a node at a time.</span><span class="sxs-lookup"><span data-stu-id="49f00-202">It's typical to select a node size assuming one task will run on a node at a time.</span></span> <span data-ttu-id="49f00-203">However, it is possible to have multiple tasks (and therefore multiple application instances) [run in parallel](batch-parallel-node-tasks.md) on compute nodes during job execution.</span><span class="sxs-lookup"><span data-stu-id="49f00-203">However, it is possible to have multiple tasks (and therefore multiple application instances) [run in parallel](batch-parallel-node-tasks.md) on compute nodes during job execution.</span></span> <span data-ttu-id="49f00-204">In this case, it is common to choose a larger node size to accommodate the increased demand of parallel task execution.</span><span class="sxs-lookup"><span data-stu-id="49f00-204">In this case, it is common to choose a larger node size to accommodate the increased demand of parallel task execution.</span></span> <span data-ttu-id="49f00-205">See [Task scheduling policy](#task-scheduling-policy) for more information.</span><span class="sxs-lookup"><span data-stu-id="49f00-205">See [Task scheduling policy](#task-scheduling-policy) for more information.</span></span>

    <span data-ttu-id="49f00-206">All of the nodes in a pool are the same size.</span><span class="sxs-lookup"><span data-stu-id="49f00-206">All of the nodes in a pool are the same size.</span></span> <span data-ttu-id="49f00-207">If you intend to run applications with differing system requirements and/or load levels, we recommend that you use separate pools.</span><span class="sxs-lookup"><span data-stu-id="49f00-207">If you intend to run applications with differing system requirements and/or load levels, we recommend that you use separate pools.</span></span>
* <span data-ttu-id="49f00-208">**Target number of nodes**</span><span class="sxs-lookup"><span data-stu-id="49f00-208">**Target number of nodes**</span></span>

    <span data-ttu-id="49f00-209">This is the number of compute nodes that you want to deploy in the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-209">This is the number of compute nodes that you want to deploy in the pool.</span></span> <span data-ttu-id="49f00-210">This is referred to as a *target* because, in some situations, your pool might not reach the desired number of nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-210">This is referred to as a *target* because, in some situations, your pool might not reach the desired number of nodes.</span></span> <span data-ttu-id="49f00-211">A pool might not reach the desired number of nodes if it reaches the [core quota](batch-quota-limit.md) for your Batch account--or if there is an auto-scaling formula that you have applied to the pool that limits the maximum number of nodes (see the following "Scaling policy" section).</span><span class="sxs-lookup"><span data-stu-id="49f00-211">A pool might not reach the desired number of nodes if it reaches the [core quota](batch-quota-limit.md) for your Batch account--or if there is an auto-scaling formula that you have applied to the pool that limits the maximum number of nodes (see the following "Scaling policy" section).</span></span>
* <span data-ttu-id="49f00-212">**Scaling policy**</span><span class="sxs-lookup"><span data-stu-id="49f00-212">**Scaling policy**</span></span>

    <span data-ttu-id="49f00-213">For dynamic workloads, you can write and apply an [auto-scaling formula](#scaling-compute-resources) to a pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-213">For dynamic workloads, you can write and apply an [auto-scaling formula](#scaling-compute-resources) to a pool.</span></span> <span data-ttu-id="49f00-214">The Batch service periodically evaluates your formula and adjusts the number of nodes within the pool based on various pool, job, and task parameters that you can specify.</span><span class="sxs-lookup"><span data-stu-id="49f00-214">The Batch service periodically evaluates your formula and adjusts the number of nodes within the pool based on various pool, job, and task parameters that you can specify.</span></span>
* <span data-ttu-id="49f00-215">**Task scheduling policy**</span><span class="sxs-lookup"><span data-stu-id="49f00-215">**Task scheduling policy**</span></span>

    <span data-ttu-id="49f00-216">The [max tasks per node](batch-parallel-node-tasks.md) configuration option determines the maximum number of tasks that can be run in parallel on each compute node within the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-216">The [max tasks per node](batch-parallel-node-tasks.md) configuration option determines the maximum number of tasks that can be run in parallel on each compute node within the pool.</span></span>

    <span data-ttu-id="49f00-217">The default configuration specifies that one task at a time runs on a node, but there are scenarios where it is beneficial to have two or more tasks executed on a node simultaneously.</span><span class="sxs-lookup"><span data-stu-id="49f00-217">The default configuration specifies that one task at a time runs on a node, but there are scenarios where it is beneficial to have two or more tasks executed on a node simultaneously.</span></span> <span data-ttu-id="49f00-218">See the [example scenario](batch-parallel-node-tasks.md#example-scenario) in the [concurrent node tasks](batch-parallel-node-tasks.md) article to see how you can benefit from multiple tasks per node.</span><span class="sxs-lookup"><span data-stu-id="49f00-218">See the [example scenario](batch-parallel-node-tasks.md#example-scenario) in the [concurrent node tasks](batch-parallel-node-tasks.md) article to see how you can benefit from multiple tasks per node.</span></span>

    <span data-ttu-id="49f00-219">You can also specify a *fill type* which determines whether Batch spreads the tasks evenly across all nodes in a pool, or packs each node with the maximum number of tasks before assigning tasks to another node.</span><span class="sxs-lookup"><span data-stu-id="49f00-219">You can also specify a *fill type* which determines whether Batch spreads the tasks evenly across all nodes in a pool, or packs each node with the maximum number of tasks before assigning tasks to another node.</span></span>
* <span data-ttu-id="49f00-220">**Communication status** of compute nodes</span><span class="sxs-lookup"><span data-stu-id="49f00-220">**Communication status** of compute nodes</span></span>

    <span data-ttu-id="49f00-221">In most scenarios, tasks operate independently and do not need to communicate with one another.</span><span class="sxs-lookup"><span data-stu-id="49f00-221">In most scenarios, tasks operate independently and do not need to communicate with one another.</span></span> <span data-ttu-id="49f00-222">However, there are some applications in which tasks must communicate, like [MPI scenarios](batch-mpi.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-222">However, there are some applications in which tasks must communicate, like [MPI scenarios](batch-mpi.md).</span></span>

    <span data-ttu-id="49f00-223">You can configure a pool to allow **internode communication**, so that nodes within a pool can communicate at runtime.</span><span class="sxs-lookup"><span data-stu-id="49f00-223">You can configure a pool to allow **internode communication**, so that nodes within a pool can communicate at runtime.</span></span> <span data-ttu-id="49f00-224">When internode communication is enabled, nodes in Cloud Services Configuration pools can communicate with each other on ports greater than 1100, and Virtual Machine Configuration pools do not restrict traffic on any port.</span><span class="sxs-lookup"><span data-stu-id="49f00-224">When internode communication is enabled, nodes in Cloud Services Configuration pools can communicate with each other on ports greater than 1100, and Virtual Machine Configuration pools do not restrict traffic on any port.</span></span>

    <span data-ttu-id="49f00-225">Note that enabling internode communication also impacts the placement of the nodes within clusters and might limit the maximum number of nodes in a pool because of deployment restrictions.</span><span class="sxs-lookup"><span data-stu-id="49f00-225">Note that enabling internode communication also impacts the placement of the nodes within clusters and might limit the maximum number of nodes in a pool because of deployment restrictions.</span></span> <span data-ttu-id="49f00-226">If your application does not require communication between nodes, the Batch service can allocate a potentially large number of nodes to the pool from many different clusters and datacenters to enable increased parallel processing power.</span><span class="sxs-lookup"><span data-stu-id="49f00-226">If your application does not require communication between nodes, the Batch service can allocate a potentially large number of nodes to the pool from many different clusters and datacenters to enable increased parallel processing power.</span></span>
* <span data-ttu-id="49f00-227">**Start task** for compute nodes</span><span class="sxs-lookup"><span data-stu-id="49f00-227">**Start task** for compute nodes</span></span>

    <span data-ttu-id="49f00-228">The optional *start task* executes on each node as that node joins the pool, and each time a node is restarted or reimaged.</span><span class="sxs-lookup"><span data-stu-id="49f00-228">The optional *start task* executes on each node as that node joins the pool, and each time a node is restarted or reimaged.</span></span> <span data-ttu-id="49f00-229">The start task is especially useful for preparing compute nodes for the execution of tasks, like installing the applications that your tasks run on the compute nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-229">The start task is especially useful for preparing compute nodes for the execution of tasks, like installing the applications that your tasks run on the compute nodes.</span></span>
* <span data-ttu-id="49f00-230">**Application packages**</span><span class="sxs-lookup"><span data-stu-id="49f00-230">**Application packages**</span></span>

    <span data-ttu-id="49f00-231">You can specify [application packages](#application-packages) to deploy to the compute nodes in the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-231">You can specify [application packages](#application-packages) to deploy to the compute nodes in the pool.</span></span> <span data-ttu-id="49f00-232">Application packages provide simplified deployment and versioning of the applications that your tasks run.</span><span class="sxs-lookup"><span data-stu-id="49f00-232">Application packages provide simplified deployment and versioning of the applications that your tasks run.</span></span> <span data-ttu-id="49f00-233">Application packages that you specify for a pool are installed on every node that joins that pool, and every time a node is rebooted or reimaged.</span><span class="sxs-lookup"><span data-stu-id="49f00-233">Application packages that you specify for a pool are installed on every node that joins that pool, and every time a node is rebooted or reimaged.</span></span> <span data-ttu-id="49f00-234">Application packages are currently unsupported on Linux compute nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-234">Application packages are currently unsupported on Linux compute nodes.</span></span>
* <span data-ttu-id="49f00-235">**Network configuration**</span><span class="sxs-lookup"><span data-stu-id="49f00-235">**Network configuration**</span></span>

    <span data-ttu-id="49f00-236">You can specify the ID of an Azure [virtual network (VNet)](../virtual-network/virtual-networks-overview.md) in which the pool's compute nodes should be created.</span><span class="sxs-lookup"><span data-stu-id="49f00-236">You can specify the ID of an Azure [virtual network (VNet)](../virtual-network/virtual-networks-overview.md) in which the pool's compute nodes should be created.</span></span> <span data-ttu-id="49f00-237">See the [Pool network configuration](#pool-network-configuration) section for more information.</span><span class="sxs-lookup"><span data-stu-id="49f00-237">See the [Pool network configuration](#pool-network-configuration) section for more information.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="49f00-238">All Batch accounts have a default **quota** that limits the number of **cores** (and thus, compute nodes) in a Batch account.</span><span class="sxs-lookup"><span data-stu-id="49f00-238">All Batch accounts have a default **quota** that limits the number of **cores** (and thus, compute nodes) in a Batch account.</span></span> <span data-ttu-id="49f00-239">You can find the default quotas and instructions on how to [increase a quota](batch-quota-limit.md#increase-a-quota) (such as the maximum number of cores in your Batch account) in [Quotas and limits for the Azure Batch service](batch-quota-limit.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-239">You can find the default quotas and instructions on how to [increase a quota](batch-quota-limit.md#increase-a-quota) (such as the maximum number of cores in your Batch account) in [Quotas and limits for the Azure Batch service](batch-quota-limit.md).</span></span> <span data-ttu-id="49f00-240">If you find yourself asking "Why won't my pool reach more than X nodes?"</span><span class="sxs-lookup"><span data-stu-id="49f00-240">If you find yourself asking "Why won't my pool reach more than X nodes?"</span></span> <span data-ttu-id="49f00-241">this core quota might be the cause.</span><span class="sxs-lookup"><span data-stu-id="49f00-241">this core quota might be the cause.</span></span>
>
>

## <a name="job"></a><span data-ttu-id="49f00-242">Job</span><span class="sxs-lookup"><span data-stu-id="49f00-242">Job</span></span>
<span data-ttu-id="49f00-243">A job is a collection of tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-243">A job is a collection of tasks.</span></span> <span data-ttu-id="49f00-244">It manages how computation is performed by its tasks on the compute nodes in a pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-244">It manages how computation is performed by its tasks on the compute nodes in a pool.</span></span>

* <span data-ttu-id="49f00-245">The job specifies the **pool** in which the work is to be run.</span><span class="sxs-lookup"><span data-stu-id="49f00-245">The job specifies the **pool** in which the work is to be run.</span></span> <span data-ttu-id="49f00-246">You can create a new pool for each job, or use one pool for many jobs.</span><span class="sxs-lookup"><span data-stu-id="49f00-246">You can create a new pool for each job, or use one pool for many jobs.</span></span> <span data-ttu-id="49f00-247">You can create a pool for each job that is associated with a job schedule, or for all jobs that are associated with a job schedule.</span><span class="sxs-lookup"><span data-stu-id="49f00-247">You can create a pool for each job that is associated with a job schedule, or for all jobs that are associated with a job schedule.</span></span>
* <span data-ttu-id="49f00-248">You can specify an optional **job priority**.</span><span class="sxs-lookup"><span data-stu-id="49f00-248">You can specify an optional **job priority**.</span></span> <span data-ttu-id="49f00-249">When a job is submitted with a higher priority than jobs that are currently in progress, the tasks for the higher-priority job are inserted into the queue ahead of tasks for the lower-priority jobs.</span><span class="sxs-lookup"><span data-stu-id="49f00-249">When a job is submitted with a higher priority than jobs that are currently in progress, the tasks for the higher-priority job are inserted into the queue ahead of tasks for the lower-priority jobs.</span></span> <span data-ttu-id="49f00-250">Tasks in lower-priority jobs that are already running are not preempted.</span><span class="sxs-lookup"><span data-stu-id="49f00-250">Tasks in lower-priority jobs that are already running are not preempted.</span></span>
* <span data-ttu-id="49f00-251">You can use job **constraints** to specify certain limits for your jobs:</span><span class="sxs-lookup"><span data-stu-id="49f00-251">You can use job **constraints** to specify certain limits for your jobs:</span></span>

    <span data-ttu-id="49f00-252">You can set a **maximum wallclock time**, so that if a job runs for longer than the maximum wallclock time that is specified, the job and all of its tasks are terminated.</span><span class="sxs-lookup"><span data-stu-id="49f00-252">You can set a **maximum wallclock time**, so that if a job runs for longer than the maximum wallclock time that is specified, the job and all of its tasks are terminated.</span></span>

    <span data-ttu-id="49f00-253">Batch can detect and then retry failed tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-253">Batch can detect and then retry failed tasks.</span></span> <span data-ttu-id="49f00-254">You can specify the **maximum number of task retries** as a constraint, including whether a task is *always* or *never* retried.</span><span class="sxs-lookup"><span data-stu-id="49f00-254">You can specify the **maximum number of task retries** as a constraint, including whether a task is *always* or *never* retried.</span></span> <span data-ttu-id="49f00-255">Retrying a task means that the task is requeued to be run again.</span><span class="sxs-lookup"><span data-stu-id="49f00-255">Retrying a task means that the task is requeued to be run again.</span></span>
* <span data-ttu-id="49f00-256">Your client application can add tasks to a job, or you can specify a [job manager task](#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="49f00-256">Your client application can add tasks to a job, or you can specify a [job manager task](#job-manager-task).</span></span> <span data-ttu-id="49f00-257">A job manager task contains the information that is necessary to create the required tasks for a job, with the job manager task being run on one of the compute nodes in the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-257">A job manager task contains the information that is necessary to create the required tasks for a job, with the job manager task being run on one of the compute nodes in the pool.</span></span> <span data-ttu-id="49f00-258">The job manager task is handled specifically by Batch--it is queued as soon as the job is created, and is restarted if it fails.</span><span class="sxs-lookup"><span data-stu-id="49f00-258">The job manager task is handled specifically by Batch--it is queued as soon as the job is created, and is restarted if it fails.</span></span> <span data-ttu-id="49f00-259">A job manager task is *required* for jobs that are created by a [job schedule](#scheduled-jobs) because it is the only way to define the tasks before the job is instantiated.</span><span class="sxs-lookup"><span data-stu-id="49f00-259">A job manager task is *required* for jobs that are created by a [job schedule](#scheduled-jobs) because it is the only way to define the tasks before the job is instantiated.</span></span>
* <span data-ttu-id="49f00-260">By default, jobs remain in the active state when all tasks within the job are complete.</span><span class="sxs-lookup"><span data-stu-id="49f00-260">By default, jobs remain in the active state when all tasks within the job are complete.</span></span> <span data-ttu-id="49f00-261">You can change this behavior so that the job is automatically terminated when all tasks in the job are complete.</span><span class="sxs-lookup"><span data-stu-id="49f00-261">You can change this behavior so that the job is automatically terminated when all tasks in the job are complete.</span></span> <span data-ttu-id="49f00-262">Set the job's **onAllTasksComplete** property ([OnAllTasksComplete][net_onalltaskscomplete] in Batch .NET) to *terminatejob* to automatically terminate the job when all of its tasks are in the completed state.</span><span class="sxs-lookup"><span data-stu-id="49f00-262">Set the job's **onAllTasksComplete** property ([OnAllTasksComplete][net_onalltaskscomplete] in Batch .NET) to *terminatejob* to automatically terminate the job when all of its tasks are in the completed state.</span></span>

    <span data-ttu-id="49f00-263">Note that the Batch service considers a job with *no* tasks to have all of its tasks completed.</span><span class="sxs-lookup"><span data-stu-id="49f00-263">Note that the Batch service considers a job with *no* tasks to have all of its tasks completed.</span></span> <span data-ttu-id="49f00-264">Therefore, this option is most commonly used with a [job manager task](#job-manager-task).</span><span class="sxs-lookup"><span data-stu-id="49f00-264">Therefore, this option is most commonly used with a [job manager task](#job-manager-task).</span></span> <span data-ttu-id="49f00-265">If you want to use automatic job termination without a job manager, you should initially set a new job's **onAllTasksComplete** property to *noaction*, then set it to *terminatejob* only after you've finished adding tasks to the job.</span><span class="sxs-lookup"><span data-stu-id="49f00-265">If you want to use automatic job termination without a job manager, you should initially set a new job's **onAllTasksComplete** property to *noaction*, then set it to *terminatejob* only after you've finished adding tasks to the job.</span></span>

### <a name="job-priority"></a><span data-ttu-id="49f00-266">Job priority</span><span class="sxs-lookup"><span data-stu-id="49f00-266">Job priority</span></span>
<span data-ttu-id="49f00-267">You can assign a priority to jobs that you create in Batch.</span><span class="sxs-lookup"><span data-stu-id="49f00-267">You can assign a priority to jobs that you create in Batch.</span></span> <span data-ttu-id="49f00-268">The Batch service uses the priority value of the job to determine the order of job scheduling within an account (this is not to be confused with a [scheduled job](#scheduled-jobs)).</span><span class="sxs-lookup"><span data-stu-id="49f00-268">The Batch service uses the priority value of the job to determine the order of job scheduling within an account (this is not to be confused with a [scheduled job](#scheduled-jobs)).</span></span> <span data-ttu-id="49f00-269">The priority values range from -1000 to 1000, with -1000 being the lowest priority and 1000 being the highest.</span><span class="sxs-lookup"><span data-stu-id="49f00-269">The priority values range from -1000 to 1000, with -1000 being the lowest priority and 1000 being the highest.</span></span> <span data-ttu-id="49f00-270">To update the priority of a job, call the [Update the properties of a job][rest_update_job] operation (Batch REST), or modify the [CloudJob.Priority][net_cloudjob_priority] property (Batch .NET).</span><span class="sxs-lookup"><span data-stu-id="49f00-270">To update the priority of a job, call the [Update the properties of a job][rest_update_job] operation (Batch REST), or modify the [CloudJob.Priority][net_cloudjob_priority] property (Batch .NET).</span></span>

<span data-ttu-id="49f00-271">Within the same account, higher-priority jobs have scheduling precedence over lower-priority jobs.</span><span class="sxs-lookup"><span data-stu-id="49f00-271">Within the same account, higher-priority jobs have scheduling precedence over lower-priority jobs.</span></span> <span data-ttu-id="49f00-272">A job with a higher-priority value in one account does not have scheduling precedence over another job with a lower-priority value in a different account.</span><span class="sxs-lookup"><span data-stu-id="49f00-272">A job with a higher-priority value in one account does not have scheduling precedence over another job with a lower-priority value in a different account.</span></span>

<span data-ttu-id="49f00-273">Job scheduling across pools is independent.</span><span class="sxs-lookup"><span data-stu-id="49f00-273">Job scheduling across pools is independent.</span></span> <span data-ttu-id="49f00-274">Between different pools, it is not guaranteed that a higher-priority job is scheduled first if its associated pool is short of idle nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-274">Between different pools, it is not guaranteed that a higher-priority job is scheduled first if its associated pool is short of idle nodes.</span></span> <span data-ttu-id="49f00-275">In the same pool, jobs with the same priority level have an equal chance of being scheduled.</span><span class="sxs-lookup"><span data-stu-id="49f00-275">In the same pool, jobs with the same priority level have an equal chance of being scheduled.</span></span>

### <a name="scheduled-jobs"></a><span data-ttu-id="49f00-276">Scheduled jobs</span><span class="sxs-lookup"><span data-stu-id="49f00-276">Scheduled jobs</span></span>
<span data-ttu-id="49f00-277">[Job schedules][rest_job_schedules] enable you to create recurring jobs within the Batch service.</span><span class="sxs-lookup"><span data-stu-id="49f00-277">[Job schedules][rest_job_schedules] enable you to create recurring jobs within the Batch service.</span></span> <span data-ttu-id="49f00-278">A job schedule specifies when to run jobs and includes the specifications for the jobs to be run.</span><span class="sxs-lookup"><span data-stu-id="49f00-278">A job schedule specifies when to run jobs and includes the specifications for the jobs to be run.</span></span> <span data-ttu-id="49f00-279">You can specify the duration of the schedule--how long and when the schedule is in effect--and how frequently jobs are created during the scheduled period.</span><span class="sxs-lookup"><span data-stu-id="49f00-279">You can specify the duration of the schedule--how long and when the schedule is in effect--and how frequently jobs are created during the scheduled period.</span></span>

## <a name="task"></a><span data-ttu-id="49f00-280">Task</span><span class="sxs-lookup"><span data-stu-id="49f00-280">Task</span></span>
<span data-ttu-id="49f00-281">A task is a unit of computation that is associated with a job.</span><span class="sxs-lookup"><span data-stu-id="49f00-281">A task is a unit of computation that is associated with a job.</span></span> <span data-ttu-id="49f00-282">It runs on a node.</span><span class="sxs-lookup"><span data-stu-id="49f00-282">It runs on a node.</span></span> <span data-ttu-id="49f00-283">Tasks are assigned to a node for execution, or are queued until a node becomes free.</span><span class="sxs-lookup"><span data-stu-id="49f00-283">Tasks are assigned to a node for execution, or are queued until a node becomes free.</span></span> <span data-ttu-id="49f00-284">Put simply, a task runs one or more programs or scripts on a compute node to perform the work you need done.</span><span class="sxs-lookup"><span data-stu-id="49f00-284">Put simply, a task runs one or more programs or scripts on a compute node to perform the work you need done.</span></span>

<span data-ttu-id="49f00-285">When you create a task, you can specify:</span><span class="sxs-lookup"><span data-stu-id="49f00-285">When you create a task, you can specify:</span></span>

* <span data-ttu-id="49f00-286">The **command line** for the task.</span><span class="sxs-lookup"><span data-stu-id="49f00-286">The **command line** for the task.</span></span> <span data-ttu-id="49f00-287">This is the command line that runs your application or script on the compute node.</span><span class="sxs-lookup"><span data-stu-id="49f00-287">This is the command line that runs your application or script on the compute node.</span></span>

    <span data-ttu-id="49f00-288">It is important to note that the command line does not actually run under a shell.</span><span class="sxs-lookup"><span data-stu-id="49f00-288">It is important to note that the command line does not actually run under a shell.</span></span> <span data-ttu-id="49f00-289">Therefore, it cannot natively take advantage of shell features like [environment variable](#environment-settings-for-tasks) expansion (this includes the `PATH`).</span><span class="sxs-lookup"><span data-stu-id="49f00-289">Therefore, it cannot natively take advantage of shell features like [environment variable](#environment-settings-for-tasks) expansion (this includes the `PATH`).</span></span> <span data-ttu-id="49f00-290">To take advantage of such features, you must invoke the shell in the command line--for example, by launching `cmd.exe` on Windows nodes or `/bin/sh` on Linux:</span><span class="sxs-lookup"><span data-stu-id="49f00-290">To take advantage of such features, you must invoke the shell in the command line--for example, by launching `cmd.exe` on Windows nodes or `/bin/sh` on Linux:</span></span>

    `cmd /c MyTaskApplication.exe %MY_ENV_VAR%`

    `/bin/sh -c MyTaskApplication $MY_ENV_VAR`

    <span data-ttu-id="49f00-291">If your tasks need to run an application or script that is not in the node's `PATH` or reference environment variables, invoke the shell explicitly in the task command line.</span><span class="sxs-lookup"><span data-stu-id="49f00-291">If your tasks need to run an application or script that is not in the node's `PATH` or reference environment variables, invoke the shell explicitly in the task command line.</span></span>
* <span data-ttu-id="49f00-292">**Resource files** that contain the data to be processed.</span><span class="sxs-lookup"><span data-stu-id="49f00-292">**Resource files** that contain the data to be processed.</span></span> <span data-ttu-id="49f00-293">These files are automatically copied to the node from Blob storage in a general-purpose Azure Storage account before the task's command line is executed.</span><span class="sxs-lookup"><span data-stu-id="49f00-293">These files are automatically copied to the node from Blob storage in a general-purpose Azure Storage account before the task's command line is executed.</span></span> <span data-ttu-id="49f00-294">For more information, see the sections [Start task](#start-task) and [Files and directories](#files-and-directories).</span><span class="sxs-lookup"><span data-stu-id="49f00-294">For more information, see the sections [Start task](#start-task) and [Files and directories](#files-and-directories).</span></span>
* <span data-ttu-id="49f00-295">The **environment variables** that are required by your application.</span><span class="sxs-lookup"><span data-stu-id="49f00-295">The **environment variables** that are required by your application.</span></span> <span data-ttu-id="49f00-296">For more information, see the [Environment settings for tasks](#environment-settings-for-tasks) section.</span><span class="sxs-lookup"><span data-stu-id="49f00-296">For more information, see the [Environment settings for tasks](#environment-settings-for-tasks) section.</span></span>
* <span data-ttu-id="49f00-297">The **constraints** under which the task should execute.</span><span class="sxs-lookup"><span data-stu-id="49f00-297">The **constraints** under which the task should execute.</span></span> <span data-ttu-id="49f00-298">For example, constraints include the maximum time that the task is allowed to run, the maximum number of times a failed task should be retried, and the maximum time that files in the task's working directory are retained.</span><span class="sxs-lookup"><span data-stu-id="49f00-298">For example, constraints include the maximum time that the task is allowed to run, the maximum number of times a failed task should be retried, and the maximum time that files in the task's working directory are retained.</span></span>
* <span data-ttu-id="49f00-299">**Application packages** to deploy to the compute node on which the task is scheduled to run.</span><span class="sxs-lookup"><span data-stu-id="49f00-299">**Application packages** to deploy to the compute node on which the task is scheduled to run.</span></span> <span data-ttu-id="49f00-300">[Application packages](#application-packages) provide simplified deployment and versioning of the applications that your tasks run.</span><span class="sxs-lookup"><span data-stu-id="49f00-300">[Application packages](#application-packages) provide simplified deployment and versioning of the applications that your tasks run.</span></span> <span data-ttu-id="49f00-301">Task-level application packages are especially useful in shared-pool environments, where different jobs are run on one pool, and the pool is not deleted when a job is completed.</span><span class="sxs-lookup"><span data-stu-id="49f00-301">Task-level application packages are especially useful in shared-pool environments, where different jobs are run on one pool, and the pool is not deleted when a job is completed.</span></span> <span data-ttu-id="49f00-302">If your job has fewer tasks than nodes in the pool, task application packages can minimize data transfer since your application is deployed only to the nodes that run tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-302">If your job has fewer tasks than nodes in the pool, task application packages can minimize data transfer since your application is deployed only to the nodes that run tasks.</span></span>

<span data-ttu-id="49f00-303">In addition to tasks you define to perform computation on a node, the following special tasks are also provided by the Batch service:</span><span class="sxs-lookup"><span data-stu-id="49f00-303">In addition to tasks you define to perform computation on a node, the following special tasks are also provided by the Batch service:</span></span>

* [<span data-ttu-id="49f00-304">Start task</span><span class="sxs-lookup"><span data-stu-id="49f00-304">Start task</span></span>](#start-task)
* [<span data-ttu-id="49f00-305">Job manager task</span><span class="sxs-lookup"><span data-stu-id="49f00-305">Job manager task</span></span>](#job-manager-task)
* [<span data-ttu-id="49f00-306">Job preparation and release tasks</span><span class="sxs-lookup"><span data-stu-id="49f00-306">Job preparation and release tasks</span></span>](#job-preparation-and-release-tasks)
* [<span data-ttu-id="49f00-307">Multi-instance tasks (MPI)</span><span class="sxs-lookup"><span data-stu-id="49f00-307">Multi-instance tasks (MPI)</span></span>](#multi-instance-tasks)
* [<span data-ttu-id="49f00-308">Task dependencies</span><span class="sxs-lookup"><span data-stu-id="49f00-308">Task dependencies</span></span>](#task-dependencies)

### <a name="start-task"></a><span data-ttu-id="49f00-309">Start task</span><span class="sxs-lookup"><span data-stu-id="49f00-309">Start task</span></span>
<span data-ttu-id="49f00-310">By associating a **start task** with a pool, you can prepare the operating environment of its nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-310">By associating a **start task** with a pool, you can prepare the operating environment of its nodes.</span></span> <span data-ttu-id="49f00-311">For example, you can perform actions like installing the applications that your tasks run or starting background processes.</span><span class="sxs-lookup"><span data-stu-id="49f00-311">For example, you can perform actions like installing the applications that your tasks run or starting background processes.</span></span> <span data-ttu-id="49f00-312">The start task runs every time a node starts, for as long as it remains in the pool--including when the node is first added to the pool and when it is restarted or reimaged.</span><span class="sxs-lookup"><span data-stu-id="49f00-312">The start task runs every time a node starts, for as long as it remains in the pool--including when the node is first added to the pool and when it is restarted or reimaged.</span></span>

<span data-ttu-id="49f00-313">A primary benefit of the start task is that it can contain all of the information that is necessary to configure a compute node and install the applications that are required for task execution.</span><span class="sxs-lookup"><span data-stu-id="49f00-313">A primary benefit of the start task is that it can contain all of the information that is necessary to configure a compute node and install the applications that are required for task execution.</span></span> <span data-ttu-id="49f00-314">Therefore, increasing the number of nodes in a pool is as simple as specifying the new target node count.</span><span class="sxs-lookup"><span data-stu-id="49f00-314">Therefore, increasing the number of nodes in a pool is as simple as specifying the new target node count.</span></span> <span data-ttu-id="49f00-315">The start task provides the Batch service the information that is needed to configure the new nodes and get them ready for accepting tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-315">The start task provides the Batch service the information that is needed to configure the new nodes and get them ready for accepting tasks.</span></span>

<span data-ttu-id="49f00-316">As with any Azure Batch task, you can specify a list of **resource files** in [Azure Storage][azure_storage], in addition to a **command line** to be executed.</span><span class="sxs-lookup"><span data-stu-id="49f00-316">As with any Azure Batch task, you can specify a list of **resource files** in [Azure Storage][azure_storage], in addition to a **command line** to be executed.</span></span> <span data-ttu-id="49f00-317">The Batch service first copies the resource files to the node from Azure Storage, and then runs the command line.</span><span class="sxs-lookup"><span data-stu-id="49f00-317">The Batch service first copies the resource files to the node from Azure Storage, and then runs the command line.</span></span> <span data-ttu-id="49f00-318">For a pool start task, the file list typically contains the task application and its dependencies.</span><span class="sxs-lookup"><span data-stu-id="49f00-318">For a pool start task, the file list typically contains the task application and its dependencies.</span></span>

<span data-ttu-id="49f00-319">However, the start task could also include reference data to be used by all tasks that are running on the compute node.</span><span class="sxs-lookup"><span data-stu-id="49f00-319">However, the start task could also include reference data to be used by all tasks that are running on the compute node.</span></span> <span data-ttu-id="49f00-320">For example, a start task's command line could perform a `robocopy` operation to copy application files (which were specified as resource files and downloaded to the node) from the start task's [working directory](#files-and-directories) to the [shared folder](#files-and-directories), and then run an MSI or `setup.exe`.</span><span class="sxs-lookup"><span data-stu-id="49f00-320">For example, a start task's command line could perform a `robocopy` operation to copy application files (which were specified as resource files and downloaded to the node) from the start task's [working directory](#files-and-directories) to the [shared folder](#files-and-directories), and then run an MSI or `setup.exe`.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="49f00-321">Batch currently supports *only* the **General purpose** storage account type, as described in step 5 of [Create a storage account](../storage/storage-create-storage-account.md#create-a-storage-account) in [About Azure storage accounts](../storage/storage-create-storage-account.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-321">Batch currently supports *only* the **General purpose** storage account type, as described in step 5 of [Create a storage account](../storage/storage-create-storage-account.md#create-a-storage-account) in [About Azure storage accounts](../storage/storage-create-storage-account.md).</span></span> <span data-ttu-id="49f00-322">Your Batch tasks (including standard tasks, start tasks, job preparation tasks, and job release tasks) must specify resource files that reside *only* in **General purpose** storage accounts.</span><span class="sxs-lookup"><span data-stu-id="49f00-322">Your Batch tasks (including standard tasks, start tasks, job preparation tasks, and job release tasks) must specify resource files that reside *only* in **General purpose** storage accounts.</span></span>
>
>

<span data-ttu-id="49f00-323">It is typically desirable for the Batch service to wait for the start task to complete before considering the node ready to be assigned tasks, but you can configure this.</span><span class="sxs-lookup"><span data-stu-id="49f00-323">It is typically desirable for the Batch service to wait for the start task to complete before considering the node ready to be assigned tasks, but you can configure this.</span></span>

<span data-ttu-id="49f00-324">If a start task fails on a compute node, then the state of the node is updated to reflect the failure, and the node is not assigned any tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-324">If a start task fails on a compute node, then the state of the node is updated to reflect the failure, and the node is not assigned any tasks.</span></span> <span data-ttu-id="49f00-325">A start task can fail if there is an issue copying its resource files from storage, or if the process executed by its command line returns a nonzero exit code.</span><span class="sxs-lookup"><span data-stu-id="49f00-325">A start task can fail if there is an issue copying its resource files from storage, or if the process executed by its command line returns a nonzero exit code.</span></span>

<span data-ttu-id="49f00-326">If you add or update the start task for an *existing* pool, you must reboot its compute nodes for the start task to be applied to the nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-326">If you add or update the start task for an *existing* pool, you must reboot its compute nodes for the start task to be applied to the nodes.</span></span>

### <a name="job-manager-task"></a><span data-ttu-id="49f00-327">Job manager task</span><span class="sxs-lookup"><span data-stu-id="49f00-327">Job manager task</span></span>
<span data-ttu-id="49f00-328">You typically use a **job manager task** to control and/or monitor job execution--for example, to create and submit the tasks for a job, determine additional tasks to run, and determine when work is complete.</span><span class="sxs-lookup"><span data-stu-id="49f00-328">You typically use a **job manager task** to control and/or monitor job execution--for example, to create and submit the tasks for a job, determine additional tasks to run, and determine when work is complete.</span></span> <span data-ttu-id="49f00-329">However, a job manager task is not restricted to these activities.</span><span class="sxs-lookup"><span data-stu-id="49f00-329">However, a job manager task is not restricted to these activities.</span></span> <span data-ttu-id="49f00-330">It is a fully fledged task that can perform any actions that are required for the job.</span><span class="sxs-lookup"><span data-stu-id="49f00-330">It is a fully fledged task that can perform any actions that are required for the job.</span></span> <span data-ttu-id="49f00-331">For example, a job manager task might download a file that is specified as a parameter, analyze the contents of that file, and submit additional tasks based on those contents.</span><span class="sxs-lookup"><span data-stu-id="49f00-331">For example, a job manager task might download a file that is specified as a parameter, analyze the contents of that file, and submit additional tasks based on those contents.</span></span>

<span data-ttu-id="49f00-332">A job manager task is started before all other tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-332">A job manager task is started before all other tasks.</span></span> <span data-ttu-id="49f00-333">It provides the following features:</span><span class="sxs-lookup"><span data-stu-id="49f00-333">It provides the following features:</span></span>

* <span data-ttu-id="49f00-334">It is automatically submitted as a task by the Batch service when the job is created.</span><span class="sxs-lookup"><span data-stu-id="49f00-334">It is automatically submitted as a task by the Batch service when the job is created.</span></span>
* <span data-ttu-id="49f00-335">It is scheduled to execute before the other tasks in a job.</span><span class="sxs-lookup"><span data-stu-id="49f00-335">It is scheduled to execute before the other tasks in a job.</span></span>
* <span data-ttu-id="49f00-336">Its associated node is the last to be removed from a pool when the pool is being downsized.</span><span class="sxs-lookup"><span data-stu-id="49f00-336">Its associated node is the last to be removed from a pool when the pool is being downsized.</span></span>
* <span data-ttu-id="49f00-337">Its termination can be tied to the termination of all tasks in the job.</span><span class="sxs-lookup"><span data-stu-id="49f00-337">Its termination can be tied to the termination of all tasks in the job.</span></span>
* <span data-ttu-id="49f00-338">A job manager task is given the highest priority when it needs to be restarted.</span><span class="sxs-lookup"><span data-stu-id="49f00-338">A job manager task is given the highest priority when it needs to be restarted.</span></span> <span data-ttu-id="49f00-339">If an idle node is not available, the Batch service might terminate one of the other running tasks in the pool to make room for the job manager task to run.</span><span class="sxs-lookup"><span data-stu-id="49f00-339">If an idle node is not available, the Batch service might terminate one of the other running tasks in the pool to make room for the job manager task to run.</span></span>
* <span data-ttu-id="49f00-340">A job manager task in one job does not have priority over the tasks of other jobs.</span><span class="sxs-lookup"><span data-stu-id="49f00-340">A job manager task in one job does not have priority over the tasks of other jobs.</span></span> <span data-ttu-id="49f00-341">Across jobs, only job-level priorities are observed.</span><span class="sxs-lookup"><span data-stu-id="49f00-341">Across jobs, only job-level priorities are observed.</span></span>

### <a name="job-preparation-and-release-tasks"></a><span data-ttu-id="49f00-342">Job preparation and release tasks</span><span class="sxs-lookup"><span data-stu-id="49f00-342">Job preparation and release tasks</span></span>
<span data-ttu-id="49f00-343">Batch provides job preparation tasks for pre-job execution setup.</span><span class="sxs-lookup"><span data-stu-id="49f00-343">Batch provides job preparation tasks for pre-job execution setup.</span></span> <span data-ttu-id="49f00-344">Job release tasks are for post-job maintenance or cleanup.</span><span class="sxs-lookup"><span data-stu-id="49f00-344">Job release tasks are for post-job maintenance or cleanup.</span></span>

* <span data-ttu-id="49f00-345">**Job preparation task**: A job preparation task runs on all compute nodes that are scheduled to run tasks, before any of the other job tasks are executed.</span><span class="sxs-lookup"><span data-stu-id="49f00-345">**Job preparation task**: A job preparation task runs on all compute nodes that are scheduled to run tasks, before any of the other job tasks are executed.</span></span> <span data-ttu-id="49f00-346">You can use a job preparation task to copy data that is shared by all tasks, but is unique to the job, for example.</span><span class="sxs-lookup"><span data-stu-id="49f00-346">You can use a job preparation task to copy data that is shared by all tasks, but is unique to the job, for example.</span></span>
* <span data-ttu-id="49f00-347">**Job release task**: When a job has completed, a job release task runs on each node in the pool that executed at least one task.</span><span class="sxs-lookup"><span data-stu-id="49f00-347">**Job release task**: When a job has completed, a job release task runs on each node in the pool that executed at least one task.</span></span> <span data-ttu-id="49f00-348">You can use a job release task to delete data that is copied by the job preparation task, or to compress and upload diagnostic log data, for example.</span><span class="sxs-lookup"><span data-stu-id="49f00-348">You can use a job release task to delete data that is copied by the job preparation task, or to compress and upload diagnostic log data, for example.</span></span>

<span data-ttu-id="49f00-349">Both job preparation and release tasks allow you to specify a command line to run when the task is invoked.</span><span class="sxs-lookup"><span data-stu-id="49f00-349">Both job preparation and release tasks allow you to specify a command line to run when the task is invoked.</span></span> <span data-ttu-id="49f00-350">They offer features like file download, elevated execution, custom environment variables, maximum execution duration, retry count, and file retention time.</span><span class="sxs-lookup"><span data-stu-id="49f00-350">They offer features like file download, elevated execution, custom environment variables, maximum execution duration, retry count, and file retention time.</span></span>

<span data-ttu-id="49f00-351">For more information on job preparation and release tasks, see [Run job preparation and completion tasks on Azure Batch compute nodes](batch-job-prep-release.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-351">For more information on job preparation and release tasks, see [Run job preparation and completion tasks on Azure Batch compute nodes](batch-job-prep-release.md).</span></span>

### <a name="multi-instance-task"></a><span data-ttu-id="49f00-352">Multi-instance task</span><span class="sxs-lookup"><span data-stu-id="49f00-352">Multi-instance task</span></span>
<span data-ttu-id="49f00-353">A [multi-instance task](batch-mpi.md) is a task that is configured to run on more than one compute node simultaneously.</span><span class="sxs-lookup"><span data-stu-id="49f00-353">A [multi-instance task](batch-mpi.md) is a task that is configured to run on more than one compute node simultaneously.</span></span> <span data-ttu-id="49f00-354">With multi-instance tasks, you can enable high-performance computing scenarios that require a group of compute nodes that are allocated together to process a single workload (like Message Passing Interface (MPI)).</span><span class="sxs-lookup"><span data-stu-id="49f00-354">With multi-instance tasks, you can enable high-performance computing scenarios that require a group of compute nodes that are allocated together to process a single workload (like Message Passing Interface (MPI)).</span></span>

<span data-ttu-id="49f00-355">For a detailed discussion on running MPI jobs in Batch by using the Batch .NET library, check out [Use multi-instance tasks to run Message Passing Interface (MPI) applications in Azure Batch](batch-mpi.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-355">For a detailed discussion on running MPI jobs in Batch by using the Batch .NET library, check out [Use multi-instance tasks to run Message Passing Interface (MPI) applications in Azure Batch](batch-mpi.md).</span></span>

### <a name="task-dependencies"></a><span data-ttu-id="49f00-356">Task dependencies</span><span class="sxs-lookup"><span data-stu-id="49f00-356">Task dependencies</span></span>
<span data-ttu-id="49f00-357">[Task dependencies](batch-task-dependencies.md), as the name implies, allow you to specify that a task depends on the completion of other tasks before its execution.</span><span class="sxs-lookup"><span data-stu-id="49f00-357">[Task dependencies](batch-task-dependencies.md), as the name implies, allow you to specify that a task depends on the completion of other tasks before its execution.</span></span> <span data-ttu-id="49f00-358">This feature provides support for situations in which a "downstream" task consumes the output of an "upstream" task--or when an upstream task performs some initialization that is required by a downstream task.</span><span class="sxs-lookup"><span data-stu-id="49f00-358">This feature provides support for situations in which a "downstream" task consumes the output of an "upstream" task--or when an upstream task performs some initialization that is required by a downstream task.</span></span> <span data-ttu-id="49f00-359">To use this feature, you must first enable task dependencies on your Batch job.</span><span class="sxs-lookup"><span data-stu-id="49f00-359">To use this feature, you must first enable task dependencies on your Batch job.</span></span> <span data-ttu-id="49f00-360">Then, for each task that depends on another (or many others), you specify the tasks which that task depends on.</span><span class="sxs-lookup"><span data-stu-id="49f00-360">Then, for each task that depends on another (or many others), you specify the tasks which that task depends on.</span></span>

<span data-ttu-id="49f00-361">With task dependencies, you can configure scenarios like the following:</span><span class="sxs-lookup"><span data-stu-id="49f00-361">With task dependencies, you can configure scenarios like the following:</span></span>

* <span data-ttu-id="49f00-362">*taskB* depends on *taskA* (*taskB* will not begin execution until *taskA* has completed).</span><span class="sxs-lookup"><span data-stu-id="49f00-362">*taskB* depends on *taskA* (*taskB* will not begin execution until *taskA* has completed).</span></span>
* <span data-ttu-id="49f00-363">*taskC* depends on both *taskA* and *taskB*.</span><span class="sxs-lookup"><span data-stu-id="49f00-363">*taskC* depends on both *taskA* and *taskB*.</span></span>
* <span data-ttu-id="49f00-364">*taskD* depends on a range of tasks, such as tasks *1* through *10*, before it executes.</span><span class="sxs-lookup"><span data-stu-id="49f00-364">*taskD* depends on a range of tasks, such as tasks *1* through *10*, before it executes.</span></span>

<span data-ttu-id="49f00-365">Check out [Task dependencies in Azure Batch](batch-task-dependencies.md) and the [TaskDependencies][github_sample_taskdeps] code sample in the [azure-batch-samples][github_samples] GitHub repository for more in-depth details on this feature.</span><span class="sxs-lookup"><span data-stu-id="49f00-365">Check out [Task dependencies in Azure Batch](batch-task-dependencies.md) and the [TaskDependencies][github_sample_taskdeps] code sample in the [azure-batch-samples][github_samples] GitHub repository for more in-depth details on this feature.</span></span>

## <a name="environment-settings-for-tasks"></a><span data-ttu-id="49f00-366">Environment settings for tasks</span><span class="sxs-lookup"><span data-stu-id="49f00-366">Environment settings for tasks</span></span>
<span data-ttu-id="49f00-367">Each task executed by the Batch service has access to environment variables that it sets on compute nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-367">Each task executed by the Batch service has access to environment variables that it sets on compute nodes.</span></span> <span data-ttu-id="49f00-368">This includes environment variables defined by the Batch service ([service-defined][msdn_env_vars]) and custom environment variables that you can define for your tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-368">This includes environment variables defined by the Batch service ([service-defined][msdn_env_vars]) and custom environment variables that you can define for your tasks.</span></span> <span data-ttu-id="49f00-369">The applications and scripts your tasks execute have access to these environment variables during execution.</span><span class="sxs-lookup"><span data-stu-id="49f00-369">The applications and scripts your tasks execute have access to these environment variables during execution.</span></span>

<span data-ttu-id="49f00-370">You can set custom environment variables at the task or job level by populating the *environment settings* property for these entities.</span><span class="sxs-lookup"><span data-stu-id="49f00-370">You can set custom environment variables at the task or job level by populating the *environment settings* property for these entities.</span></span> <span data-ttu-id="49f00-371">For example, see the [Add a task to a job][rest_add_task] operation (Batch REST API), or the [CloudTask.EnvironmentSettings][net_cloudtask_env] and [CloudJob.CommonEnvironmentSettings][net_job_env] properties in Batch .NET.</span><span class="sxs-lookup"><span data-stu-id="49f00-371">For example, see the [Add a task to a job][rest_add_task] operation (Batch REST API), or the [CloudTask.EnvironmentSettings][net_cloudtask_env] and [CloudJob.CommonEnvironmentSettings][net_job_env] properties in Batch .NET.</span></span>

<span data-ttu-id="49f00-372">Your client application or service can obtain a task's environment variables, both service-defined and custom, by using the [Get information about a task][rest_get_task_info] operation (Batch REST) or by accessing the [CloudTask.EnvironmentSettings][net_cloudtask_env] property (Batch .NET).</span><span class="sxs-lookup"><span data-stu-id="49f00-372">Your client application or service can obtain a task's environment variables, both service-defined and custom, by using the [Get information about a task][rest_get_task_info] operation (Batch REST) or by accessing the [CloudTask.EnvironmentSettings][net_cloudtask_env] property (Batch .NET).</span></span> <span data-ttu-id="49f00-373">Processes executing on a compute node can access these and other environment variables on the node, for example, by using the familiar `%VARIABLE_NAME%` (Windows) or `$VARIABLE_NAME` (Linux) syntax.</span><span class="sxs-lookup"><span data-stu-id="49f00-373">Processes executing on a compute node can access these and other environment variables on the node, for example, by using the familiar `%VARIABLE_NAME%` (Windows) or `$VARIABLE_NAME` (Linux) syntax.</span></span>

<span data-ttu-id="49f00-374">You can find a full list of all service-defined environment variables in [Compute node environment variables][msdn_env_vars].</span><span class="sxs-lookup"><span data-stu-id="49f00-374">You can find a full list of all service-defined environment variables in [Compute node environment variables][msdn_env_vars].</span></span>

## <a name="files-and-directories"></a><span data-ttu-id="49f00-375">Files and directories</span><span class="sxs-lookup"><span data-stu-id="49f00-375">Files and directories</span></span>
<span data-ttu-id="49f00-376">Each task has a *working directory* under which it creates zero or more files and directories.</span><span class="sxs-lookup"><span data-stu-id="49f00-376">Each task has a *working directory* under which it creates zero or more files and directories.</span></span> <span data-ttu-id="49f00-377">This working directory can be used for storing the program that is run by the task, the data that it processes, and the output of the processing it performs.</span><span class="sxs-lookup"><span data-stu-id="49f00-377">This working directory can be used for storing the program that is run by the task, the data that it processes, and the output of the processing it performs.</span></span> <span data-ttu-id="49f00-378">All files and directories of a task are owned by the task user.</span><span class="sxs-lookup"><span data-stu-id="49f00-378">All files and directories of a task are owned by the task user.</span></span>

<span data-ttu-id="49f00-379">The Batch service exposes a portion of the file system on a node as the *root directory*.</span><span class="sxs-lookup"><span data-stu-id="49f00-379">The Batch service exposes a portion of the file system on a node as the *root directory*.</span></span> <span data-ttu-id="49f00-380">Tasks can access the root directory by referencing the `AZ_BATCH_NODE_ROOT_DIR` environment variable.</span><span class="sxs-lookup"><span data-stu-id="49f00-380">Tasks can access the root directory by referencing the `AZ_BATCH_NODE_ROOT_DIR` environment variable.</span></span> <span data-ttu-id="49f00-381">For more information about using environment variables, see [Environment settings for tasks](#environment-settings-for-tasks).</span><span class="sxs-lookup"><span data-stu-id="49f00-381">For more information about using environment variables, see [Environment settings for tasks](#environment-settings-for-tasks).</span></span>

<span data-ttu-id="49f00-382">The root directory contains the following directory structure:</span><span class="sxs-lookup"><span data-stu-id="49f00-382">The root directory contains the following directory structure:</span></span>

![Compute node directory structure][1]

* <span data-ttu-id="49f00-384">**shared**: This directory provides read/write access to *all* tasks that run on a node.</span><span class="sxs-lookup"><span data-stu-id="49f00-384">**shared**: This directory provides read/write access to *all* tasks that run on a node.</span></span> <span data-ttu-id="49f00-385">Any task that runs on the node can create, read, update, and delete files in this directory.</span><span class="sxs-lookup"><span data-stu-id="49f00-385">Any task that runs on the node can create, read, update, and delete files in this directory.</span></span> <span data-ttu-id="49f00-386">Tasks can access this directory by referencing the `AZ_BATCH_NODE_SHARED_DIR` environment variable.</span><span class="sxs-lookup"><span data-stu-id="49f00-386">Tasks can access this directory by referencing the `AZ_BATCH_NODE_SHARED_DIR` environment variable.</span></span>
* <span data-ttu-id="49f00-387">**startup**: This directory is used by a start task as its working directory.</span><span class="sxs-lookup"><span data-stu-id="49f00-387">**startup**: This directory is used by a start task as its working directory.</span></span> <span data-ttu-id="49f00-388">All of the files that are downloaded to the node by the start task are stored here.</span><span class="sxs-lookup"><span data-stu-id="49f00-388">All of the files that are downloaded to the node by the start task are stored here.</span></span> <span data-ttu-id="49f00-389">The start task can create, read, update, and delete files under this directory.</span><span class="sxs-lookup"><span data-stu-id="49f00-389">The start task can create, read, update, and delete files under this directory.</span></span> <span data-ttu-id="49f00-390">Tasks can access this directory by referencing the `AZ_BATCH_NODE_STARTUP_DIR` environment variable.</span><span class="sxs-lookup"><span data-stu-id="49f00-390">Tasks can access this directory by referencing the `AZ_BATCH_NODE_STARTUP_DIR` environment variable.</span></span>
* <span data-ttu-id="49f00-391">**Tasks**: A directory is created for each task that runs on the node.</span><span class="sxs-lookup"><span data-stu-id="49f00-391">**Tasks**: A directory is created for each task that runs on the node.</span></span> <span data-ttu-id="49f00-392">It is accessed by referencing the `AZ_BATCH_TASK_DIR` environment variable.</span><span class="sxs-lookup"><span data-stu-id="49f00-392">It is accessed by referencing the `AZ_BATCH_TASK_DIR` environment variable.</span></span>

    <span data-ttu-id="49f00-393">Within each task directory, the Batch service creates a working directory (`wd`) whose unique path is specified by the `AZ_BATCH_TASK_WORKING_DIR` environment variable.</span><span class="sxs-lookup"><span data-stu-id="49f00-393">Within each task directory, the Batch service creates a working directory (`wd`) whose unique path is specified by the `AZ_BATCH_TASK_WORKING_DIR` environment variable.</span></span> <span data-ttu-id="49f00-394">This directory provides read/write access to the task.</span><span class="sxs-lookup"><span data-stu-id="49f00-394">This directory provides read/write access to the task.</span></span> <span data-ttu-id="49f00-395">The task can create, read, update, and delete files under this directory.</span><span class="sxs-lookup"><span data-stu-id="49f00-395">The task can create, read, update, and delete files under this directory.</span></span> <span data-ttu-id="49f00-396">This directory is retained based on the *RetentionTime* constraint that is specified for the task.</span><span class="sxs-lookup"><span data-stu-id="49f00-396">This directory is retained based on the *RetentionTime* constraint that is specified for the task.</span></span>

    <span data-ttu-id="49f00-397">`stdout.txt` and `stderr.txt`: These files are written to the task folder during the execution of the task.</span><span class="sxs-lookup"><span data-stu-id="49f00-397">`stdout.txt` and `stderr.txt`: These files are written to the task folder during the execution of the task.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="49f00-398">When a node is removed from the pool, *all* of the files that are stored on the node are removed.</span><span class="sxs-lookup"><span data-stu-id="49f00-398">When a node is removed from the pool, *all* of the files that are stored on the node are removed.</span></span>
>
>

## <a name="application-packages"></a><span data-ttu-id="49f00-399">Application packages</span><span class="sxs-lookup"><span data-stu-id="49f00-399">Application packages</span></span>
<span data-ttu-id="49f00-400">The [application packages](batch-application-packages.md) feature provides easy management and deployment of applications to the compute nodes in your pools.</span><span class="sxs-lookup"><span data-stu-id="49f00-400">The [application packages](batch-application-packages.md) feature provides easy management and deployment of applications to the compute nodes in your pools.</span></span> <span data-ttu-id="49f00-401">You can upload and manage multiple versions of the applications run by your tasks, including their binaries and support files.</span><span class="sxs-lookup"><span data-stu-id="49f00-401">You can upload and manage multiple versions of the applications run by your tasks, including their binaries and support files.</span></span> <span data-ttu-id="49f00-402">Then you can automatically deploy one or more of these applications to the compute nodes in your pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-402">Then you can automatically deploy one or more of these applications to the compute nodes in your pool.</span></span>

<span data-ttu-id="49f00-403">You can specify application packages at the pool and task level.</span><span class="sxs-lookup"><span data-stu-id="49f00-403">You can specify application packages at the pool and task level.</span></span> <span data-ttu-id="49f00-404">When you specify pool application packages, the application is deployed to every node in the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-404">When you specify pool application packages, the application is deployed to every node in the pool.</span></span> <span data-ttu-id="49f00-405">When you specify task application packages, the application is deployed only to nodes that are scheduled to run at least one of the job's tasks, just before the task's command line is run.</span><span class="sxs-lookup"><span data-stu-id="49f00-405">When you specify task application packages, the application is deployed only to nodes that are scheduled to run at least one of the job's tasks, just before the task's command line is run.</span></span>

<span data-ttu-id="49f00-406">Batch handles the details of working with Azure Storage to store your application packages and deploy them to compute nodes, so both your code and management overhead can be simplified.</span><span class="sxs-lookup"><span data-stu-id="49f00-406">Batch handles the details of working with Azure Storage to store your application packages and deploy them to compute nodes, so both your code and management overhead can be simplified.</span></span>

<span data-ttu-id="49f00-407">To find out more about the application package feature, check out [Application deployment with Azure Batch application packages](batch-application-packages.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-407">To find out more about the application package feature, check out [Application deployment with Azure Batch application packages](batch-application-packages.md).</span></span>

> [!NOTE]
> <span data-ttu-id="49f00-408">If you add pool application packages to an *existing* pool, you must reboot its compute nodes for the application packages to be deployed to the nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-408">If you add pool application packages to an *existing* pool, you must reboot its compute nodes for the application packages to be deployed to the nodes.</span></span>
>
>

## <a name="pool-and-compute-node-lifetime"></a><span data-ttu-id="49f00-409">Pool and compute node lifetime</span><span class="sxs-lookup"><span data-stu-id="49f00-409">Pool and compute node lifetime</span></span>
<span data-ttu-id="49f00-410">When you design your Azure Batch solution, you have to make a design decision about how and when pools are created, and how long compute nodes within those pools are kept available.</span><span class="sxs-lookup"><span data-stu-id="49f00-410">When you design your Azure Batch solution, you have to make a design decision about how and when pools are created, and how long compute nodes within those pools are kept available.</span></span>

<span data-ttu-id="49f00-411">On one end of the spectrum, you can create a pool for each job that you submit, and delete the pool as soon as its tasks finish execution.</span><span class="sxs-lookup"><span data-stu-id="49f00-411">On one end of the spectrum, you can create a pool for each job that you submit, and delete the pool as soon as its tasks finish execution.</span></span> <span data-ttu-id="49f00-412">This maximizes utilization because the nodes are only allocated when needed, and shut down as soon as they're idle.</span><span class="sxs-lookup"><span data-stu-id="49f00-412">This maximizes utilization because the nodes are only allocated when needed, and shut down as soon as they're idle.</span></span> <span data-ttu-id="49f00-413">While this means that the job must wait for the nodes to be allocated, it's important to note that tasks are scheduled for execution as soon as nodes are individually available, allocated, and the start task has completed.</span><span class="sxs-lookup"><span data-stu-id="49f00-413">While this means that the job must wait for the nodes to be allocated, it's important to note that tasks are scheduled for execution as soon as nodes are individually available, allocated, and the start task has completed.</span></span> <span data-ttu-id="49f00-414">Batch does *not* wait until all nodes within a pool are available before assigning tasks to the nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-414">Batch does *not* wait until all nodes within a pool are available before assigning tasks to the nodes.</span></span> <span data-ttu-id="49f00-415">This ensures maximum utilization of all available nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-415">This ensures maximum utilization of all available nodes.</span></span>

<span data-ttu-id="49f00-416">At the other end of the spectrum, if having jobs start immediately is the highest priority, you can create a pool ahead of time and make its nodes available before jobs are submitted.</span><span class="sxs-lookup"><span data-stu-id="49f00-416">At the other end of the spectrum, if having jobs start immediately is the highest priority, you can create a pool ahead of time and make its nodes available before jobs are submitted.</span></span> <span data-ttu-id="49f00-417">In this scenario, tasks can start immediately, but nodes might sit idle while waiting for them to be assigned.</span><span class="sxs-lookup"><span data-stu-id="49f00-417">In this scenario, tasks can start immediately, but nodes might sit idle while waiting for them to be assigned.</span></span>

<span data-ttu-id="49f00-418">A combined approach is typically used for handling a variable, but ongoing, load.</span><span class="sxs-lookup"><span data-stu-id="49f00-418">A combined approach is typically used for handling a variable, but ongoing, load.</span></span> <span data-ttu-id="49f00-419">You can have a pool that multiple jobs are submitted to, but can scale the number of nodes up or down according to the job load (see [Scaling compute resources](#scaling-compute-resources) in the following section).</span><span class="sxs-lookup"><span data-stu-id="49f00-419">You can have a pool that multiple jobs are submitted to, but can scale the number of nodes up or down according to the job load (see [Scaling compute resources](#scaling-compute-resources) in the following section).</span></span> <span data-ttu-id="49f00-420">You can do this reactively, based on current load, or proactively, if load can be predicted.</span><span class="sxs-lookup"><span data-stu-id="49f00-420">You can do this reactively, based on current load, or proactively, if load can be predicted.</span></span>

## <a name="pool-network-configuration"></a><span data-ttu-id="49f00-421">Pool network configuration</span><span class="sxs-lookup"><span data-stu-id="49f00-421">Pool network configuration</span></span>

<span data-ttu-id="49f00-422">When you create a pool of compute nodes in Azure Batch, you can use the APIs to specify the ID of an Azure [virtual network (VNet)](../virtual-network/virtual-networks-overview.md) in which the pool's compute nodes should be created.</span><span class="sxs-lookup"><span data-stu-id="49f00-422">When you create a pool of compute nodes in Azure Batch, you can use the APIs to specify the ID of an Azure [virtual network (VNet)](../virtual-network/virtual-networks-overview.md) in which the pool's compute nodes should be created.</span></span>

* <span data-ttu-id="49f00-423">The VNet must be:</span><span class="sxs-lookup"><span data-stu-id="49f00-423">The VNet must be:</span></span>

   * <span data-ttu-id="49f00-424">In the same Azure **region** as the Azure Batch account.</span><span class="sxs-lookup"><span data-stu-id="49f00-424">In the same Azure **region** as the Azure Batch account.</span></span>
   * <span data-ttu-id="49f00-425">In the same **subscription** as the Azure Batch account.</span><span class="sxs-lookup"><span data-stu-id="49f00-425">In the same **subscription** as the Azure Batch account.</span></span>

* <span data-ttu-id="49f00-426">The VNet should have enough free **IP addresses** to accommodate the `targetDedicated` property of the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-426">The VNet should have enough free **IP addresses** to accommodate the `targetDedicated` property of the pool.</span></span> <span data-ttu-id="49f00-427">If the subnet doesn't have enough free IP addresses, the Batch service partially allocates the compute nodes in the pool and returns a resize error.</span><span class="sxs-lookup"><span data-stu-id="49f00-427">If the subnet doesn't have enough free IP addresses, the Batch service partially allocates the compute nodes in the pool and returns a resize error.</span></span>

* <span data-ttu-id="49f00-428">The specified subnet must allow communication from the Batch service to be able to schedule tasks on the compute nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-428">The specified subnet must allow communication from the Batch service to be able to schedule tasks on the compute nodes.</span></span> <span data-ttu-id="49f00-429">If communication to the compute nodes is denied by a **Network Security Group (NSG)** associated with the VNet, then the Batch service sets the state of the compute nodes to **unusable**.</span><span class="sxs-lookup"><span data-stu-id="49f00-429">If communication to the compute nodes is denied by a **Network Security Group (NSG)** associated with the VNet, then the Batch service sets the state of the compute nodes to **unusable**.</span></span> 

* <span data-ttu-id="49f00-430">If the specified VNet has any associated NSGs, then inbound communication must be enabled.</span><span class="sxs-lookup"><span data-stu-id="49f00-430">If the specified VNet has any associated NSGs, then inbound communication must be enabled.</span></span> <span data-ttu-id="49f00-431">For a Linux pool, ports 29876, 29877, and 22 must be enabled.</span><span class="sxs-lookup"><span data-stu-id="49f00-431">For a Linux pool, ports 29876, 29877, and 22 must be enabled.</span></span> <span data-ttu-id="49f00-432">For a Windows pool, port 3389 must be enabled.</span><span class="sxs-lookup"><span data-stu-id="49f00-432">For a Windows pool, port 3389 must be enabled.</span></span>

<span data-ttu-id="49f00-433">Additional settings for the VNet depend on the pool allocation mode of the Batch account.</span><span class="sxs-lookup"><span data-stu-id="49f00-433">Additional settings for the VNet depend on the pool allocation mode of the Batch account.</span></span>

### <a name="vnets-for-pools-provisioned-in-the-batch-service"></a><span data-ttu-id="49f00-434">VNets for pools provisioned in the Batch service</span><span class="sxs-lookup"><span data-stu-id="49f00-434">VNets for pools provisioned in the Batch service</span></span>

<span data-ttu-id="49f00-435">In Batch service allocation mode, only **Cloud Services Configuration** pools can be assigned a VNet.</span><span class="sxs-lookup"><span data-stu-id="49f00-435">In Batch service allocation mode, only **Cloud Services Configuration** pools can be assigned a VNet.</span></span> <span data-ttu-id="49f00-436">Additionally, the specified VNet must be a  **classic** VNet.</span><span class="sxs-lookup"><span data-stu-id="49f00-436">Additionally, the specified VNet must be a  **classic** VNet.</span></span> <span data-ttu-id="49f00-437">VNets created with the Azure Resource Manager deployment model are not supported.</span><span class="sxs-lookup"><span data-stu-id="49f00-437">VNets created with the Azure Resource Manager deployment model are not supported.</span></span>
   


* <span data-ttu-id="49f00-438">The *MicrosoftAzureBatch* service principal must have the [Classic Virtual Machine Contributor](../active-directory/role-based-access-built-in-roles.md#classic-virtual-machine-contributor) Role-Based Access Control (RBAC) role for the specified VNet.</span><span class="sxs-lookup"><span data-stu-id="49f00-438">The *MicrosoftAzureBatch* service principal must have the [Classic Virtual Machine Contributor](../active-directory/role-based-access-built-in-roles.md#classic-virtual-machine-contributor) Role-Based Access Control (RBAC) role for the specified VNet.</span></span> <span data-ttu-id="49f00-439">In the Azure portal:</span><span class="sxs-lookup"><span data-stu-id="49f00-439">In the Azure portal:</span></span>

  * <span data-ttu-id="49f00-440">Select the **VNet**, then **Access control (IAM)** > **Roles** > **Classic Virtual Machine Contributor** > **Add**</span><span class="sxs-lookup"><span data-stu-id="49f00-440">Select the **VNet**, then **Access control (IAM)** > **Roles** > **Classic Virtual Machine Contributor** > **Add**</span></span>
  * <span data-ttu-id="49f00-441">Enter "MicrosoftAzureBatch" in the **Search** box</span><span class="sxs-lookup"><span data-stu-id="49f00-441">Enter "MicrosoftAzureBatch" in the **Search** box</span></span>
  * <span data-ttu-id="49f00-442">Check the **MicrosoftAzureBatch** check box</span><span class="sxs-lookup"><span data-stu-id="49f00-442">Check the **MicrosoftAzureBatch** check box</span></span>
  * <span data-ttu-id="49f00-443">Select the **Select** button</span><span class="sxs-lookup"><span data-stu-id="49f00-443">Select the **Select** button</span></span>



### <a name="vnets-for-pools-provisioned-in-a-user-subscription"></a><span data-ttu-id="49f00-444">VNets for pools provisioned in a user subscription</span><span class="sxs-lookup"><span data-stu-id="49f00-444">VNets for pools provisioned in a user subscription</span></span>

<span data-ttu-id="49f00-445">In user subscription allocation mode, only **Virtual Machine Configuration** pools are supported and can be assigned a VNet.</span><span class="sxs-lookup"><span data-stu-id="49f00-445">In user subscription allocation mode, only **Virtual Machine Configuration** pools are supported and can be assigned a VNet.</span></span> <span data-ttu-id="49f00-446">Additionally, the specified VNet must be a **Resource Manager** based VNet.</span><span class="sxs-lookup"><span data-stu-id="49f00-446">Additionally, the specified VNet must be a **Resource Manager** based VNet.</span></span> <span data-ttu-id="49f00-447">VNets created with the classic deployment model are not supported.</span><span class="sxs-lookup"><span data-stu-id="49f00-447">VNets created with the classic deployment model are not supported.</span></span>



## <a name="scaling-compute-resources"></a><span data-ttu-id="49f00-448">Scaling compute resources</span><span class="sxs-lookup"><span data-stu-id="49f00-448">Scaling compute resources</span></span>
<span data-ttu-id="49f00-449">With [automatic scaling](batch-automatic-scaling.md), you can have the Batch service dynamically adjust the number of compute nodes in a pool according to the current workload and resource usage of your compute scenario.</span><span class="sxs-lookup"><span data-stu-id="49f00-449">With [automatic scaling](batch-automatic-scaling.md), you can have the Batch service dynamically adjust the number of compute nodes in a pool according to the current workload and resource usage of your compute scenario.</span></span> <span data-ttu-id="49f00-450">This allows you to lower the overall cost of running your application by using only the resources you need, and releasing those you don't need.</span><span class="sxs-lookup"><span data-stu-id="49f00-450">This allows you to lower the overall cost of running your application by using only the resources you need, and releasing those you don't need.</span></span>

<span data-ttu-id="49f00-451">You enable automatic scaling by writing an [automatic scaling formula](batch-automatic-scaling.md#automatic-scaling-formulas) and associating that formula with a pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-451">You enable automatic scaling by writing an [automatic scaling formula](batch-automatic-scaling.md#automatic-scaling-formulas) and associating that formula with a pool.</span></span> <span data-ttu-id="49f00-452">The Batch service uses the formula to determine the target number of nodes in the pool for the next scaling interval (an interval that you can configure).</span><span class="sxs-lookup"><span data-stu-id="49f00-452">The Batch service uses the formula to determine the target number of nodes in the pool for the next scaling interval (an interval that you can configure).</span></span> <span data-ttu-id="49f00-453">You can specify the automatic scaling settings for a pool when you create it, or enable scaling on a pool later.</span><span class="sxs-lookup"><span data-stu-id="49f00-453">You can specify the automatic scaling settings for a pool when you create it, or enable scaling on a pool later.</span></span> <span data-ttu-id="49f00-454">You can also update the scaling settings on a scaling-enabled pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-454">You can also update the scaling settings on a scaling-enabled pool.</span></span>

<span data-ttu-id="49f00-455">As an example, perhaps a job requires that you submit a very large number of tasks to be executed.</span><span class="sxs-lookup"><span data-stu-id="49f00-455">As an example, perhaps a job requires that you submit a very large number of tasks to be executed.</span></span> <span data-ttu-id="49f00-456">You can assign a scaling formula to the pool that adjusts the number of nodes in the pool based on the current number of queued tasks and the completion rate of the tasks in the job.</span><span class="sxs-lookup"><span data-stu-id="49f00-456">You can assign a scaling formula to the pool that adjusts the number of nodes in the pool based on the current number of queued tasks and the completion rate of the tasks in the job.</span></span> <span data-ttu-id="49f00-457">The Batch service periodically evaluates the formula and resizes the pool, based on workload and your other formula settings.</span><span class="sxs-lookup"><span data-stu-id="49f00-457">The Batch service periodically evaluates the formula and resizes the pool, based on workload and your other formula settings.</span></span> <span data-ttu-id="49f00-458">The service adds nodes as needed when there are a large number of queued tasks, and removes nodes when there are no queued or running tasks.</span><span class="sxs-lookup"><span data-stu-id="49f00-458">The service adds nodes as needed when there are a large number of queued tasks, and removes nodes when there are no queued or running tasks.</span></span> 

<span data-ttu-id="49f00-459">A scaling formula can be based on the following metrics:</span><span class="sxs-lookup"><span data-stu-id="49f00-459">A scaling formula can be based on the following metrics:</span></span>

* <span data-ttu-id="49f00-460">**Time metrics** are based on statistics collected every five minutes in the specified number of hours.</span><span class="sxs-lookup"><span data-stu-id="49f00-460">**Time metrics** are based on statistics collected every five minutes in the specified number of hours.</span></span>
* <span data-ttu-id="49f00-461">**Resource metrics** are based on CPU usage, bandwidth usage, memory usage, and number of nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-461">**Resource metrics** are based on CPU usage, bandwidth usage, memory usage, and number of nodes.</span></span>
* <span data-ttu-id="49f00-462">**Task metrics** are based on task state, such as *Active* (queued), *Running*, or *Completed*.</span><span class="sxs-lookup"><span data-stu-id="49f00-462">**Task metrics** are based on task state, such as *Active* (queued), *Running*, or *Completed*.</span></span>

<span data-ttu-id="49f00-463">When automatic scaling decreases the number of compute nodes in a pool, you must consider how to handle tasks that are running at the time of the decrease operation.</span><span class="sxs-lookup"><span data-stu-id="49f00-463">When automatic scaling decreases the number of compute nodes in a pool, you must consider how to handle tasks that are running at the time of the decrease operation.</span></span> <span data-ttu-id="49f00-464">To accommodate this, Batch provides a *node deallocation option* that you can include in your formulas.</span><span class="sxs-lookup"><span data-stu-id="49f00-464">To accommodate this, Batch provides a *node deallocation option* that you can include in your formulas.</span></span> <span data-ttu-id="49f00-465">For example, you can specify that running tasks are stopped immediately, stopped immediately and then requeued for execution on another node, or allowed to finish before the node is removed from the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-465">For example, you can specify that running tasks are stopped immediately, stopped immediately and then requeued for execution on another node, or allowed to finish before the node is removed from the pool.</span></span>

<span data-ttu-id="49f00-466">For more information about automatically scaling an application, see [Automatically scale compute nodes in an Azure Batch pool](batch-automatic-scaling.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-466">For more information about automatically scaling an application, see [Automatically scale compute nodes in an Azure Batch pool](batch-automatic-scaling.md).</span></span>

> [!TIP]
> <span data-ttu-id="49f00-467">To maximize compute resource utilization, set the target number of nodes to zero at the end of a job, but allow running tasks to finish.</span><span class="sxs-lookup"><span data-stu-id="49f00-467">To maximize compute resource utilization, set the target number of nodes to zero at the end of a job, but allow running tasks to finish.</span></span>
>
>

## <a name="security-with-certificates"></a><span data-ttu-id="49f00-468">Security with certificates</span><span class="sxs-lookup"><span data-stu-id="49f00-468">Security with certificates</span></span>
<span data-ttu-id="49f00-469">You typically need to use certificates when you encrypt or decrypt sensitive information for tasks, like the key for an [Azure Storage account][azure_storage].</span><span class="sxs-lookup"><span data-stu-id="49f00-469">You typically need to use certificates when you encrypt or decrypt sensitive information for tasks, like the key for an [Azure Storage account][azure_storage].</span></span> <span data-ttu-id="49f00-470">To support this, you can install certificates on nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-470">To support this, you can install certificates on nodes.</span></span> <span data-ttu-id="49f00-471">Encrypted secrets are passed to tasks via command-line parameters or embedded in one of the task resources, and the installed certificates can be used to decrypt them.</span><span class="sxs-lookup"><span data-stu-id="49f00-471">Encrypted secrets are passed to tasks via command-line parameters or embedded in one of the task resources, and the installed certificates can be used to decrypt them.</span></span>

<span data-ttu-id="49f00-472">You use the [Add certificate][rest_add_cert] operation (Batch REST) or [CertificateOperations.CreateCertificate][net_create_cert] method (Batch .NET) to add a certificate to a Batch account.</span><span class="sxs-lookup"><span data-stu-id="49f00-472">You use the [Add certificate][rest_add_cert] operation (Batch REST) or [CertificateOperations.CreateCertificate][net_create_cert] method (Batch .NET) to add a certificate to a Batch account.</span></span> <span data-ttu-id="49f00-473">You can then associate the certificate with a new or existing pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-473">You can then associate the certificate with a new or existing pool.</span></span> <span data-ttu-id="49f00-474">When a certificate is associated with a pool, the Batch service installs the certificate on each node in the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-474">When a certificate is associated with a pool, the Batch service installs the certificate on each node in the pool.</span></span> <span data-ttu-id="49f00-475">The Batch service installs the appropriate certificates when the node starts up, before launching any tasks (including the start task and job manager task).</span><span class="sxs-lookup"><span data-stu-id="49f00-475">The Batch service installs the appropriate certificates when the node starts up, before launching any tasks (including the start task and job manager task).</span></span>

<span data-ttu-id="49f00-476">If you add certificates to an *existing* pool, you must reboot its compute nodes for the certificates to be applied to the nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-476">If you add certificates to an *existing* pool, you must reboot its compute nodes for the certificates to be applied to the nodes.</span></span>

## <a name="error-handling"></a><span data-ttu-id="49f00-477">Error handling</span><span class="sxs-lookup"><span data-stu-id="49f00-477">Error handling</span></span>
<span data-ttu-id="49f00-478">You might find it necessary to handle both task and application failures within your Batch solution.</span><span class="sxs-lookup"><span data-stu-id="49f00-478">You might find it necessary to handle both task and application failures within your Batch solution.</span></span>

### <a name="task-failure-handling"></a><span data-ttu-id="49f00-479">Task failure handling</span><span class="sxs-lookup"><span data-stu-id="49f00-479">Task failure handling</span></span>
<span data-ttu-id="49f00-480">Task failures fall into these categories:</span><span class="sxs-lookup"><span data-stu-id="49f00-480">Task failures fall into these categories:</span></span>

* <span data-ttu-id="49f00-481">**Scheduling failures**</span><span class="sxs-lookup"><span data-stu-id="49f00-481">**Scheduling failures**</span></span>

    <span data-ttu-id="49f00-482">If the transfer of files that are specified for a task fails for any reason, a *scheduling error* is set for the task.</span><span class="sxs-lookup"><span data-stu-id="49f00-482">If the transfer of files that are specified for a task fails for any reason, a *scheduling error* is set for the task.</span></span>

    <span data-ttu-id="49f00-483">Scheduling errors can occur if the task's resource files have moved, the Storage account is no longer available, or another issue was encountered that prevented the successful copying of files to the node.</span><span class="sxs-lookup"><span data-stu-id="49f00-483">Scheduling errors can occur if the task's resource files have moved, the Storage account is no longer available, or another issue was encountered that prevented the successful copying of files to the node.</span></span>
* <span data-ttu-id="49f00-484">**Application failures**</span><span class="sxs-lookup"><span data-stu-id="49f00-484">**Application failures**</span></span>

    <span data-ttu-id="49f00-485">The process that is specified by the task's command line can also fail.</span><span class="sxs-lookup"><span data-stu-id="49f00-485">The process that is specified by the task's command line can also fail.</span></span> <span data-ttu-id="49f00-486">The process is deemed to have failed when a nonzero exit code is returned by the process that is executed by the task (see *Task exit codes* in the next section).</span><span class="sxs-lookup"><span data-stu-id="49f00-486">The process is deemed to have failed when a nonzero exit code is returned by the process that is executed by the task (see *Task exit codes* in the next section).</span></span>

    <span data-ttu-id="49f00-487">For application failures, you can configure Batch to automatically retry the task up to a specified number of times.</span><span class="sxs-lookup"><span data-stu-id="49f00-487">For application failures, you can configure Batch to automatically retry the task up to a specified number of times.</span></span>
* <span data-ttu-id="49f00-488">**Constraint failures**</span><span class="sxs-lookup"><span data-stu-id="49f00-488">**Constraint failures**</span></span>

    <span data-ttu-id="49f00-489">You can set a constraint that specifies the maximum execution duration for a job or task, the *maxWallClockTime*.</span><span class="sxs-lookup"><span data-stu-id="49f00-489">You can set a constraint that specifies the maximum execution duration for a job or task, the *maxWallClockTime*.</span></span> <span data-ttu-id="49f00-490">This can be useful for terminating tasks that fail to progress.</span><span class="sxs-lookup"><span data-stu-id="49f00-490">This can be useful for terminating tasks that fail to progress.</span></span>

    <span data-ttu-id="49f00-491">When the maximum amount of time has been exceeded, the task is marked as *completed*, but the exit code is set to `0xC000013A` and the *schedulingError* field is marked as `{ category:"ServerError", code="TaskEnded"}`.</span><span class="sxs-lookup"><span data-stu-id="49f00-491">When the maximum amount of time has been exceeded, the task is marked as *completed*, but the exit code is set to `0xC000013A` and the *schedulingError* field is marked as `{ category:"ServerError", code="TaskEnded"}`.</span></span>

### <a name="debugging-application-failures"></a><span data-ttu-id="49f00-492">Debugging application failures</span><span class="sxs-lookup"><span data-stu-id="49f00-492">Debugging application failures</span></span>
* <span data-ttu-id="49f00-493">`stderr` and `stdout`</span><span class="sxs-lookup"><span data-stu-id="49f00-493">`stderr` and `stdout`</span></span>

    <span data-ttu-id="49f00-494">During execution, an application might produce diagnostic output that you can use to troubleshoot issues.</span><span class="sxs-lookup"><span data-stu-id="49f00-494">During execution, an application might produce diagnostic output that you can use to troubleshoot issues.</span></span> <span data-ttu-id="49f00-495">As mentioned in the earlier section [Files and directories](#files-and-directories), the Batch service writes standard output and standard error output to `stdout.txt` and `stderr.txt` files in the task directory on the compute node.</span><span class="sxs-lookup"><span data-stu-id="49f00-495">As mentioned in the earlier section [Files and directories](#files-and-directories), the Batch service writes standard output and standard error output to `stdout.txt` and `stderr.txt` files in the task directory on the compute node.</span></span> <span data-ttu-id="49f00-496">You can use the Azure portal or one of the Batch SDKs to download these files.</span><span class="sxs-lookup"><span data-stu-id="49f00-496">You can use the Azure portal or one of the Batch SDKs to download these files.</span></span> <span data-ttu-id="49f00-497">For example, you can retrieve these and other files for troubleshooting purposes by using [ComputeNode.GetNodeFile][net_getfile_node] and [CloudTask.GetNodeFile][net_getfile_task] in the Batch .NET library.</span><span class="sxs-lookup"><span data-stu-id="49f00-497">For example, you can retrieve these and other files for troubleshooting purposes by using [ComputeNode.GetNodeFile][net_getfile_node] and [CloudTask.GetNodeFile][net_getfile_task] in the Batch .NET library.</span></span>
* <span data-ttu-id="49f00-498">**Task exit codes**</span><span class="sxs-lookup"><span data-stu-id="49f00-498">**Task exit codes**</span></span>

    <span data-ttu-id="49f00-499">As mentioned earlier, a task is marked as failed by the Batch service if the process that is executed by the task returns a nonzero exit code.</span><span class="sxs-lookup"><span data-stu-id="49f00-499">As mentioned earlier, a task is marked as failed by the Batch service if the process that is executed by the task returns a nonzero exit code.</span></span> <span data-ttu-id="49f00-500">When a task executes a process, Batch populates the task's exit code property with the *return code of the process*.</span><span class="sxs-lookup"><span data-stu-id="49f00-500">When a task executes a process, Batch populates the task's exit code property with the *return code of the process*.</span></span> <span data-ttu-id="49f00-501">It is important to note that a task's exit code is **not** determined by the Batch service.</span><span class="sxs-lookup"><span data-stu-id="49f00-501">It is important to note that a task's exit code is **not** determined by the Batch service.</span></span> <span data-ttu-id="49f00-502">A task's exit code is determined by the process itself or the operating system on which the process executed.</span><span class="sxs-lookup"><span data-stu-id="49f00-502">A task's exit code is determined by the process itself or the operating system on which the process executed.</span></span>

### <a name="accounting-for-task-failures-or-interruptions"></a><span data-ttu-id="49f00-503">Accounting for task failures or interruptions</span><span class="sxs-lookup"><span data-stu-id="49f00-503">Accounting for task failures or interruptions</span></span>
<span data-ttu-id="49f00-504">Tasks might occasionally fail or be interrupted.</span><span class="sxs-lookup"><span data-stu-id="49f00-504">Tasks might occasionally fail or be interrupted.</span></span> <span data-ttu-id="49f00-505">The task application itself might fail, the node on which the task is running might be rebooted, or the node might be removed from the pool during a resize operation if the pool's deallocation policy is set to remove nodes immediately without waiting for tasks to finish.</span><span class="sxs-lookup"><span data-stu-id="49f00-505">The task application itself might fail, the node on which the task is running might be rebooted, or the node might be removed from the pool during a resize operation if the pool's deallocation policy is set to remove nodes immediately without waiting for tasks to finish.</span></span> <span data-ttu-id="49f00-506">In all cases, the task can be automatically requeued by Batch for execution on another node.</span><span class="sxs-lookup"><span data-stu-id="49f00-506">In all cases, the task can be automatically requeued by Batch for execution on another node.</span></span>

<span data-ttu-id="49f00-507">It is also possible for an intermittent issue to cause a task to hang or take too long to execute.</span><span class="sxs-lookup"><span data-stu-id="49f00-507">It is also possible for an intermittent issue to cause a task to hang or take too long to execute.</span></span> <span data-ttu-id="49f00-508">You can set the maximum execution interval for a task.</span><span class="sxs-lookup"><span data-stu-id="49f00-508">You can set the maximum execution interval for a task.</span></span> <span data-ttu-id="49f00-509">If the maximum execution interval is exceeded, the Batch service interrupts the task application.</span><span class="sxs-lookup"><span data-stu-id="49f00-509">If the maximum execution interval is exceeded, the Batch service interrupts the task application.</span></span>

### <a name="connecting-to-compute-nodes"></a><span data-ttu-id="49f00-510">Connecting to compute nodes</span><span class="sxs-lookup"><span data-stu-id="49f00-510">Connecting to compute nodes</span></span>
<span data-ttu-id="49f00-511">You can perform additional debugging and troubleshooting by signing in to a compute node remotely.</span><span class="sxs-lookup"><span data-stu-id="49f00-511">You can perform additional debugging and troubleshooting by signing in to a compute node remotely.</span></span> <span data-ttu-id="49f00-512">You can use the Azure portal to download a Remote Desktop Protocol (RDP) file for Windows nodes and obtain Secure Shell (SSH) connection information for Linux nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-512">You can use the Azure portal to download a Remote Desktop Protocol (RDP) file for Windows nodes and obtain Secure Shell (SSH) connection information for Linux nodes.</span></span> <span data-ttu-id="49f00-513">You can also do this by using the Batch APIs--for example, with [Batch .NET][net_rdpfile] or [Batch Python](batch-linux-nodes.md#connect-to-linux-nodes).</span><span class="sxs-lookup"><span data-stu-id="49f00-513">You can also do this by using the Batch APIs--for example, with [Batch .NET][net_rdpfile] or [Batch Python](batch-linux-nodes.md#connect-to-linux-nodes).</span></span>

> [!IMPORTANT]
> <span data-ttu-id="49f00-514">To connect to a node via RDP or SSH, you must first create a user on the node.</span><span class="sxs-lookup"><span data-stu-id="49f00-514">To connect to a node via RDP or SSH, you must first create a user on the node.</span></span> <span data-ttu-id="49f00-515">To do this, you can use the Azure portal, [add a user account to a node][rest_create_user] by using the Batch REST API, call the [ComputeNode.CreateComputeNodeUser][net_create_user] method in Batch .NET, or call the [add_user][py_add_user] method in the Batch Python module.</span><span class="sxs-lookup"><span data-stu-id="49f00-515">To do this, you can use the Azure portal, [add a user account to a node][rest_create_user] by using the Batch REST API, call the [ComputeNode.CreateComputeNodeUser][net_create_user] method in Batch .NET, or call the [add_user][py_add_user] method in the Batch Python module.</span></span>
>
>

### <a name="troubleshooting-problematic-compute-nodes"></a><span data-ttu-id="49f00-516">Troubleshooting problematic compute nodes</span><span class="sxs-lookup"><span data-stu-id="49f00-516">Troubleshooting problematic compute nodes</span></span>
<span data-ttu-id="49f00-517">In situations where some of your tasks are failing, your Batch client application or service can examine the metadata of the failed tasks to identify a misbehaving node.</span><span class="sxs-lookup"><span data-stu-id="49f00-517">In situations where some of your tasks are failing, your Batch client application or service can examine the metadata of the failed tasks to identify a misbehaving node.</span></span> <span data-ttu-id="49f00-518">Each node in a pool is given a unique ID, and the node on which a task runs is included in the task metadata.</span><span class="sxs-lookup"><span data-stu-id="49f00-518">Each node in a pool is given a unique ID, and the node on which a task runs is included in the task metadata.</span></span> <span data-ttu-id="49f00-519">After you've identified a problem node, you can take several actions with it:</span><span class="sxs-lookup"><span data-stu-id="49f00-519">After you've identified a problem node, you can take several actions with it:</span></span>

* <span data-ttu-id="49f00-520">**Reboot the node** ([REST][rest_reboot] | [.NET][net_reboot])</span><span class="sxs-lookup"><span data-stu-id="49f00-520">**Reboot the node** ([REST][rest_reboot] | [.NET][net_reboot])</span></span>

    <span data-ttu-id="49f00-521">Restarting the node can sometimes clear up latent issues like stuck or crashed processes.</span><span class="sxs-lookup"><span data-stu-id="49f00-521">Restarting the node can sometimes clear up latent issues like stuck or crashed processes.</span></span> <span data-ttu-id="49f00-522">Note that if your pool uses a start task or your job uses a job preparation task, they are executed when the node restarts.</span><span class="sxs-lookup"><span data-stu-id="49f00-522">Note that if your pool uses a start task or your job uses a job preparation task, they are executed when the node restarts.</span></span>
* <span data-ttu-id="49f00-523">**Reimage the node** ([REST][rest_reimage] | [.NET][net_reimage])</span><span class="sxs-lookup"><span data-stu-id="49f00-523">**Reimage the node** ([REST][rest_reimage] | [.NET][net_reimage])</span></span>

    <span data-ttu-id="49f00-524">This reinstalls the operating system on the node.</span><span class="sxs-lookup"><span data-stu-id="49f00-524">This reinstalls the operating system on the node.</span></span> <span data-ttu-id="49f00-525">As with rebooting a node, start tasks and job preparation tasks are rerun after the node has been reimaged.</span><span class="sxs-lookup"><span data-stu-id="49f00-525">As with rebooting a node, start tasks and job preparation tasks are rerun after the node has been reimaged.</span></span>
* <span data-ttu-id="49f00-526">**Remove the node from the pool** ([REST][rest_remove] | [.NET][net_remove])</span><span class="sxs-lookup"><span data-stu-id="49f00-526">**Remove the node from the pool** ([REST][rest_remove] | [.NET][net_remove])</span></span>

    <span data-ttu-id="49f00-527">Sometimes it is necessary to completely remove the node from the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-527">Sometimes it is necessary to completely remove the node from the pool.</span></span>
* <span data-ttu-id="49f00-528">**Disable task scheduling on the node** ([REST][rest_offline] | [.NET][net_offline])</span><span class="sxs-lookup"><span data-stu-id="49f00-528">**Disable task scheduling on the node** ([REST][rest_offline] | [.NET][net_offline])</span></span>

    <span data-ttu-id="49f00-529">This effectively takes the node offline so that no further tasks are assigned to it, but allows the node to remain running and in the pool.</span><span class="sxs-lookup"><span data-stu-id="49f00-529">This effectively takes the node offline so that no further tasks are assigned to it, but allows the node to remain running and in the pool.</span></span> <span data-ttu-id="49f00-530">This enables you to perform further investigation into the cause of the failures without losing the failed task's data, and without the node causing additional task failures.</span><span class="sxs-lookup"><span data-stu-id="49f00-530">This enables you to perform further investigation into the cause of the failures without losing the failed task's data, and without the node causing additional task failures.</span></span> <span data-ttu-id="49f00-531">For example, you can disable task scheduling on the node, then [sign in remotely](#connecting-to-compute-nodes) to examine the node's event logs or perform other troubleshooting.</span><span class="sxs-lookup"><span data-stu-id="49f00-531">For example, you can disable task scheduling on the node, then [sign in remotely](#connecting-to-compute-nodes) to examine the node's event logs or perform other troubleshooting.</span></span> <span data-ttu-id="49f00-532">After you've finished your investigation, you can then bring the node back online by enabling task scheduling ([REST][rest_online] | [.NET][net_online]), or perform one of the other actions discussed earlier.</span><span class="sxs-lookup"><span data-stu-id="49f00-532">After you've finished your investigation, you can then bring the node back online by enabling task scheduling ([REST][rest_online] | [.NET][net_online]), or perform one of the other actions discussed earlier.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="49f00-533">With each action that is described in this section--reboot, reimage, remove, and disable task scheduling--you are able to specify how tasks currently running on the node are handled when you perform the action.</span><span class="sxs-lookup"><span data-stu-id="49f00-533">With each action that is described in this section--reboot, reimage, remove, and disable task scheduling--you are able to specify how tasks currently running on the node are handled when you perform the action.</span></span> <span data-ttu-id="49f00-534">For example, when you disable task scheduling on a node by using the Batch .NET client library, you can specify a [DisableComputeNodeSchedulingOption][net_offline_option] enum value to specify whether to **Terminate** running tasks, **Requeue** them for scheduling on other nodes, or allow running tasks to complete before performing the action (**TaskCompletion**).</span><span class="sxs-lookup"><span data-stu-id="49f00-534">For example, when you disable task scheduling on a node by using the Batch .NET client library, you can specify a [DisableComputeNodeSchedulingOption][net_offline_option] enum value to specify whether to **Terminate** running tasks, **Requeue** them for scheduling on other nodes, or allow running tasks to complete before performing the action (**TaskCompletion**).</span></span>
>
>

## <a name="next-steps"></a><span data-ttu-id="49f00-535">Next steps</span><span class="sxs-lookup"><span data-stu-id="49f00-535">Next steps</span></span>
* <span data-ttu-id="49f00-536">Learn about the [Batch APIs and tools](batch-apis-tools.md) available for building Batch solutions.</span><span class="sxs-lookup"><span data-stu-id="49f00-536">Learn about the [Batch APIs and tools](batch-apis-tools.md) available for building Batch solutions.</span></span>
* <span data-ttu-id="49f00-537">Walk through a sample Batch application step-by-step in [Get started with the Azure Batch Library for .NET](batch-dotnet-get-started.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-537">Walk through a sample Batch application step-by-step in [Get started with the Azure Batch Library for .NET](batch-dotnet-get-started.md).</span></span> <span data-ttu-id="49f00-538">There is also a [Python version](batch-python-tutorial.md) of the tutorial that runs a workload on Linux compute nodes.</span><span class="sxs-lookup"><span data-stu-id="49f00-538">There is also a [Python version](batch-python-tutorial.md) of the tutorial that runs a workload on Linux compute nodes.</span></span>
* <span data-ttu-id="49f00-539">Download and build the [Batch Explorer][github_batchexplorer] sample project for use while you develop your Batch solutions.</span><span class="sxs-lookup"><span data-stu-id="49f00-539">Download and build the [Batch Explorer][github_batchexplorer] sample project for use while you develop your Batch solutions.</span></span> <span data-ttu-id="49f00-540">Using the Batch Explorer, you can perform the following and more:</span><span class="sxs-lookup"><span data-stu-id="49f00-540">Using the Batch Explorer, you can perform the following and more:</span></span>

  * <span data-ttu-id="49f00-541">Monitor and manipulate pools, jobs, and tasks within your Batch account</span><span class="sxs-lookup"><span data-stu-id="49f00-541">Monitor and manipulate pools, jobs, and tasks within your Batch account</span></span>
  * <span data-ttu-id="49f00-542">Download `stdout.txt`, `stderr.txt`, and other files from nodes</span><span class="sxs-lookup"><span data-stu-id="49f00-542">Download `stdout.txt`, `stderr.txt`, and other files from nodes</span></span>
  * <span data-ttu-id="49f00-543">Create users on nodes and download RDP files for remote login</span><span class="sxs-lookup"><span data-stu-id="49f00-543">Create users on nodes and download RDP files for remote login</span></span>
* <span data-ttu-id="49f00-544">Learn how to [create pools of Linux compute nodes](batch-linux-nodes.md).</span><span class="sxs-lookup"><span data-stu-id="49f00-544">Learn how to [create pools of Linux compute nodes](batch-linux-nodes.md).</span></span>
* <span data-ttu-id="49f00-545">Visit the [Azure Batch forum][batch_forum] on MSDN.</span><span class="sxs-lookup"><span data-stu-id="49f00-545">Visit the [Azure Batch forum][batch_forum] on MSDN.</span></span> <span data-ttu-id="49f00-546">The forum is a good place to ask questions, whether you are just learning or are an expert in using Batch.</span><span class="sxs-lookup"><span data-stu-id="49f00-546">The forum is a good place to ask questions, whether you are just learning or are an expert in using Batch.</span></span>

[1]: https://docstestmedia1.blob.core.windows.net/azure-media/articles/batch/media/batch-api-basics/node-folder-structure.png

[azure_storage]: https://azure.microsoft.com/services/storage/
[batch_forum]: https://social.msdn.microsoft.com/Forums/en-US/home?forum=azurebatch
[cloud_service_sizes]: ../cloud-services/cloud-services-sizes-specs.md
[msmpi]: https://msdn.microsoft.com/library/bb524831.aspx
[github_samples]: https://github.com/Azure/azure-batch-samples
[github_sample_taskdeps]:  https://github.com/Azure/azure-batch-samples/tree/master/CSharp/ArticleProjects/TaskDependencies
[github_batchexplorer]: https://github.com/Azure/azure-batch-samples/tree/master/CSharp/BatchExplorer
[batch_net_api]: https://msdn.microsoft.com/library/azure/mt348682.aspx
[msdn_env_vars]: https://msdn.microsoft.com/library/azure/mt743623.aspx
[net_cloudjob_jobmanagertask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.jobmanagertask.aspx
[net_cloudjob_priority]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.priority.aspx
[net_cloudpool_starttask]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudpool.starttask.aspx
[net_cloudtask_env]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudtask.environmentsettings.aspx
[net_create_cert]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.certificateoperations.createcertificate.aspx
[net_create_user]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.createcomputenodeuser.aspx
[net_getfile_node]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.getnodefile.aspx
[net_getfile_task]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudtask.getnodefile.aspx
[net_job_env]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.commonenvironmentsettings.aspx
[net_multiinstancesettings]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.multiinstancesettings.aspx
[net_onalltaskscomplete]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.cloudjob.onalltaskscomplete.aspx
[net_rdp]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.getrdpfile.aspx
[net_reboot]: https://msdn.microsoft.com/library/azure/mt631495.aspx
[net_reimage]: https://msdn.microsoft.com/library/azure/mt631496.aspx
[net_remove]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.pooloperations.removefrompoolasync.aspx
[net_offline]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.disableschedulingasync.aspx
[net_online]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.computenode.enableschedulingasync.aspx
[net_offline_option]: https://msdn.microsoft.com/library/azure/microsoft.azure.batch.common.disablecomputenodeschedulingoption.aspx
[net_rdpfile]: https://msdn.microsoft.com/library/azure/Mt272127.aspx
[vnet]: https://msdn.microsoft.com/library/azure/dn820174.aspx#bk_netconf

[py_add_user]: http://azure-sdk-for-python.readthedocs.io/en/latest/ref/azure.batch.operations.html#azure.batch.operations.ComputeNodeOperations.add_user

[batch_rest_api]: https://msdn.microsoft.com/library/azure/Dn820158.aspx
[rest_add_job]: https://msdn.microsoft.com/library/azure/mt282178.aspx
[rest_add_pool]: https://msdn.microsoft.com/library/azure/dn820174.aspx
[rest_add_cert]: https://msdn.microsoft.com/library/azure/dn820169.aspx
[rest_add_task]: https://msdn.microsoft.com/library/azure/dn820105.aspx
[rest_create_user]: https://msdn.microsoft.com/library/azure/dn820137.aspx
[rest_get_task_info]: https://msdn.microsoft.com/library/azure/dn820133.aspx
[rest_job_schedules]: https://msdn.microsoft.com/library/azure/mt282179.aspx
[rest_multiinstance]: https://msdn.microsoft.com/library/azure/mt637905.aspx
[rest_multiinstancesettings]: https://msdn.microsoft.com/library/azure/dn820105.aspx#multiInstanceSettings
[rest_update_job]: https://msdn.microsoft.com/library/azure/dn820162.aspx
[rest_rdp]: https://msdn.microsoft.com/library/azure/dn820120.aspx
[rest_reboot]: https://msdn.microsoft.com/library/azure/dn820171.aspx
[rest_reimage]: https://msdn.microsoft.com/library/azure/dn820157.aspx
[rest_remove]: https://msdn.microsoft.com/library/azure/dn820194.aspx
[rest_offline]: https://msdn.microsoft.com/library/azure/mt637904.aspx
[rest_online]: https://msdn.microsoft.com/library/azure/mt637907.aspx

[vm_marketplace]: https://azure.microsoft.com/marketplace/virtual-machines/

