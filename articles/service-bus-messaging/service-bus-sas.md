---
title: Azure Service Bus access control with Shared Access Signatures | Microsoft Docs
description: Overview of Service Bus access control using Shared Access Signatures overview, details about SAS authorization with Azure Service Bus.
services: service-bus-messaging
documentationcenter: na
author: spelluru
manager: timlt
editor: ''
ms.assetid: ''
ms.service: service-bus-messaging
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 02/14/2018
ms.author: spelluru
ms.openlocfilehash: 2905bff56c5ab49c91f85e0816b84018b27bbb57
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44804991"
---
# <a name="service-bus-access-control-with-shared-access-signatures"></a><span data-ttu-id="8fea5-103">Service Bus access control with Shared Access Signatures</span><span class="sxs-lookup"><span data-stu-id="8fea5-103">Service Bus access control with Shared Access Signatures</span></span>

<span data-ttu-id="8fea5-104">*Shared Access Signatures* (SAS) are the primary security mechanism for Service Bus messaging.</span><span class="sxs-lookup"><span data-stu-id="8fea5-104">*Shared Access Signatures* (SAS) are the primary security mechanism for Service Bus messaging.</span></span> <span data-ttu-id="8fea5-105">This article discusses SAS, how they work, and how to use them in a platform-agnostic way.</span><span class="sxs-lookup"><span data-stu-id="8fea5-105">This article discusses SAS, how they work, and how to use them in a platform-agnostic way.</span></span>

<span data-ttu-id="8fea5-106">SAS guards access to Service Bus based on authorization rules.</span><span class="sxs-lookup"><span data-stu-id="8fea5-106">SAS guards access to Service Bus based on authorization rules.</span></span> <span data-ttu-id="8fea5-107">Those are configured either on a namespace, or a messaging entity (relay, queue, or topic).</span><span class="sxs-lookup"><span data-stu-id="8fea5-107">Those are configured either on a namespace, or a messaging entity (relay, queue, or topic).</span></span> <span data-ttu-id="8fea5-108">An authorization rule has a name, is associated with specific rights, and carries a pair of cryptographic keys.</span><span class="sxs-lookup"><span data-stu-id="8fea5-108">An authorization rule has a name, is associated with specific rights, and carries a pair of cryptographic keys.</span></span> <span data-ttu-id="8fea5-109">You use the rule's name and key via the Service Bus SDK or in your own code to generate a SAS token.</span><span class="sxs-lookup"><span data-stu-id="8fea5-109">You use the rule's name and key via the Service Bus SDK or in your own code to generate a SAS token.</span></span> <span data-ttu-id="8fea5-110">A client can then pass the token to Service Bus to prove authorization for the requested operation.</span><span class="sxs-lookup"><span data-stu-id="8fea5-110">A client can then pass the token to Service Bus to prove authorization for the requested operation.</span></span>

## <a name="overview-of-sas"></a><span data-ttu-id="8fea5-111">Overview of SAS</span><span class="sxs-lookup"><span data-stu-id="8fea5-111">Overview of SAS</span></span>

<span data-ttu-id="8fea5-112">Shared Access Signatures are a claims-based authorization mechanism using simple tokens.</span><span class="sxs-lookup"><span data-stu-id="8fea5-112">Shared Access Signatures are a claims-based authorization mechanism using simple tokens.</span></span> <span data-ttu-id="8fea5-113">Using SAS, keys are never passed on the wire.</span><span class="sxs-lookup"><span data-stu-id="8fea5-113">Using SAS, keys are never passed on the wire.</span></span> <span data-ttu-id="8fea5-114">Keys are used to cryptographically sign information that can later be verified by the service.</span><span class="sxs-lookup"><span data-stu-id="8fea5-114">Keys are used to cryptographically sign information that can later be verified by the service.</span></span> <span data-ttu-id="8fea5-115">SAS can be used similar to a username and password scheme where the client is in immediate possession of an authorization rule name and a matching key.</span><span class="sxs-lookup"><span data-stu-id="8fea5-115">SAS can be used similar to a username and password scheme where the client is in immediate possession of an authorization rule name and a matching key.</span></span> <span data-ttu-id="8fea5-116">SAS can also be used similar to a federated security model, where the client receives a time-limited and signed access token from a security token service without ever coming into possession of the signing key.</span><span class="sxs-lookup"><span data-stu-id="8fea5-116">SAS can also be used similar to a federated security model, where the client receives a time-limited and signed access token from a security token service without ever coming into possession of the signing key.</span></span>

<span data-ttu-id="8fea5-117">SAS authentication in Service Bus is configured with named [Shared Access Authorization Rules](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) having associated access rights, and a pair of primary and secondary cryptographic keys.</span><span class="sxs-lookup"><span data-stu-id="8fea5-117">SAS authentication in Service Bus is configured with named [Shared Access Authorization Rules](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) having associated access rights, and a pair of primary and secondary cryptographic keys.</span></span> <span data-ttu-id="8fea5-118">The keys are 256-bit values in Base64 representation.</span><span class="sxs-lookup"><span data-stu-id="8fea5-118">The keys are 256-bit values in Base64 representation.</span></span> <span data-ttu-id="8fea5-119">You can configure rules at the namespace level, on Service Bus [relays](service-bus-fundamentals-hybrid-solutions.md#relays), [queues](service-bus-fundamentals-hybrid-solutions.md#queues), and [topics](service-bus-fundamentals-hybrid-solutions.md#topics).</span><span class="sxs-lookup"><span data-stu-id="8fea5-119">You can configure rules at the namespace level, on Service Bus [relays](service-bus-fundamentals-hybrid-solutions.md#relays), [queues](service-bus-fundamentals-hybrid-solutions.md#queues), and [topics](service-bus-fundamentals-hybrid-solutions.md#topics).</span></span>

<span data-ttu-id="8fea5-120">The [Shared Access Signature](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) token contains the name of the chosen authorization rule, the URI of the resource that shall be accessed, an expiry instant, and an HMAC-SHA256 cryptographic signature computed over these fields using either the primary or the secondary cryptographic key of the chosen authorization rule.</span><span class="sxs-lookup"><span data-stu-id="8fea5-120">The [Shared Access Signature](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) token contains the name of the chosen authorization rule, the URI of the resource that shall be accessed, an expiry instant, and an HMAC-SHA256 cryptographic signature computed over these fields using either the primary or the secondary cryptographic key of the chosen authorization rule.</span></span>

## <a name="shared-access-authorization-policies"></a><span data-ttu-id="8fea5-121">Shared Access Authorization Policies</span><span class="sxs-lookup"><span data-stu-id="8fea5-121">Shared Access Authorization Policies</span></span>

<span data-ttu-id="8fea5-122">Each Service Bus namespace and each Service Bus entity has a Shared Access Authorization policy made up of rules.</span><span class="sxs-lookup"><span data-stu-id="8fea5-122">Each Service Bus namespace and each Service Bus entity has a Shared Access Authorization policy made up of rules.</span></span> <span data-ttu-id="8fea5-123">The policy at the namespace level applies to all entities inside the namespace, irrespective of their individual policy configuration.</span><span class="sxs-lookup"><span data-stu-id="8fea5-123">The policy at the namespace level applies to all entities inside the namespace, irrespective of their individual policy configuration.</span></span>

<span data-ttu-id="8fea5-124">For each authorization policy rule, you decide on three pieces of information: **name**, **scope**, and **rights**.</span><span class="sxs-lookup"><span data-stu-id="8fea5-124">For each authorization policy rule, you decide on three pieces of information: **name**, **scope**, and **rights**.</span></span> <span data-ttu-id="8fea5-125">The **name** is just that; a unique name within that scope.</span><span class="sxs-lookup"><span data-stu-id="8fea5-125">The **name** is just that; a unique name within that scope.</span></span> <span data-ttu-id="8fea5-126">The scope is easy enough: it's the URI of the resource in question.</span><span class="sxs-lookup"><span data-stu-id="8fea5-126">The scope is easy enough: it's the URI of the resource in question.</span></span> <span data-ttu-id="8fea5-127">For a Service Bus namespace, the scope is the fully qualified domain name (FQDN), such as `https://<yournamespace>.servicebus.windows.net/`.</span><span class="sxs-lookup"><span data-stu-id="8fea5-127">For a Service Bus namespace, the scope is the fully qualified domain name (FQDN), such as `https://<yournamespace>.servicebus.windows.net/`.</span></span>

<span data-ttu-id="8fea5-128">The rights conferred by the policy rule can be a combination of:</span><span class="sxs-lookup"><span data-stu-id="8fea5-128">The rights conferred by the policy rule can be a combination of:</span></span>

* <span data-ttu-id="8fea5-129">'Send' - Confers the right to send messages to the entity</span><span class="sxs-lookup"><span data-stu-id="8fea5-129">'Send' - Confers the right to send messages to the entity</span></span>
* <span data-ttu-id="8fea5-130">'Listen' - Confers the right to listen (relay) or receive (queue, subscriptions) and all related message handling</span><span class="sxs-lookup"><span data-stu-id="8fea5-130">'Listen' - Confers the right to listen (relay) or receive (queue, subscriptions) and all related message handling</span></span>
* <span data-ttu-id="8fea5-131">'Manage' - Confers the right to manage the topology of the namespace, including creating and deleting entities</span><span class="sxs-lookup"><span data-stu-id="8fea5-131">'Manage' - Confers the right to manage the topology of the namespace, including creating and deleting entities</span></span>

<span data-ttu-id="8fea5-132">The 'Manage' right includes the 'Send' and 'Receive' rights.</span><span class="sxs-lookup"><span data-stu-id="8fea5-132">The 'Manage' right includes the 'Send' and 'Receive' rights.</span></span>

<span data-ttu-id="8fea5-133">A namespace or entity policy can hold up to 12 Shared Access Authorization rules, providing room for three sets of rules, each covering the basic rights and the combination of Send and Listen.</span><span class="sxs-lookup"><span data-stu-id="8fea5-133">A namespace or entity policy can hold up to 12 Shared Access Authorization rules, providing room for three sets of rules, each covering the basic rights and the combination of Send and Listen.</span></span> <span data-ttu-id="8fea5-134">This limit underlines that the SAS policy store is not intended to be a user or service account store.</span><span class="sxs-lookup"><span data-stu-id="8fea5-134">This limit underlines that the SAS policy store is not intended to be a user or service account store.</span></span> <span data-ttu-id="8fea5-135">If your application needs to grant access to Service Bus based on user or service identities, it should implement a security token service that issues SAS tokens after an authentication and access check.</span><span class="sxs-lookup"><span data-stu-id="8fea5-135">If your application needs to grant access to Service Bus based on user or service identities, it should implement a security token service that issues SAS tokens after an authentication and access check.</span></span>

<span data-ttu-id="8fea5-136">An authorization rule is assigned a *Primary Key* and a *Secondary Key*.</span><span class="sxs-lookup"><span data-stu-id="8fea5-136">An authorization rule is assigned a *Primary Key* and a *Secondary Key*.</span></span> <span data-ttu-id="8fea5-137">These are cryptographically strong keys.</span><span class="sxs-lookup"><span data-stu-id="8fea5-137">These are cryptographically strong keys.</span></span> <span data-ttu-id="8fea5-138">Don't lose them or leak them - they'll always be available in the [Azure portal][Azure portal].</span><span class="sxs-lookup"><span data-stu-id="8fea5-138">Don't lose them or leak them - they'll always be available in the [Azure portal][Azure portal].</span></span> <span data-ttu-id="8fea5-139">You can use either of the generated keys, and you can regenerate them at any time.</span><span class="sxs-lookup"><span data-stu-id="8fea5-139">You can use either of the generated keys, and you can regenerate them at any time.</span></span> <span data-ttu-id="8fea5-140">If you regenerate or change a key in the policy, all previously issued tokens based on that key become instantly invalid.</span><span class="sxs-lookup"><span data-stu-id="8fea5-140">If you regenerate or change a key in the policy, all previously issued tokens based on that key become instantly invalid.</span></span> <span data-ttu-id="8fea5-141">However, ongoing connections created based on such tokens will continue to work until the token expires.</span><span class="sxs-lookup"><span data-stu-id="8fea5-141">However, ongoing connections created based on such tokens will continue to work until the token expires.</span></span>

<span data-ttu-id="8fea5-142">When you create a Service Bus namespace, a policy rule named **RootManageSharedAccessKey** is automatically created for the namespace.</span><span class="sxs-lookup"><span data-stu-id="8fea5-142">When you create a Service Bus namespace, a policy rule named **RootManageSharedAccessKey** is automatically created for the namespace.</span></span> <span data-ttu-id="8fea5-143">This policy has Manage permissions for the entire namespace.</span><span class="sxs-lookup"><span data-stu-id="8fea5-143">This policy has Manage permissions for the entire namespace.</span></span> <span data-ttu-id="8fea5-144">It's recommended that you treat this rule like an administrative **root** account and don't use it in your application.</span><span class="sxs-lookup"><span data-stu-id="8fea5-144">It's recommended that you treat this rule like an administrative **root** account and don't use it in your application.</span></span> <span data-ttu-id="8fea5-145">You can create additional policy rules in the **Configure** tab for the namespace in the portal, via Powershell or Azure CLI.</span><span class="sxs-lookup"><span data-stu-id="8fea5-145">You can create additional policy rules in the **Configure** tab for the namespace in the portal, via Powershell or Azure CLI.</span></span>

## <a name="configuration-for-shared-access-signature-authentication"></a><span data-ttu-id="8fea5-146">Configuration for Shared Access Signature authentication</span><span class="sxs-lookup"><span data-stu-id="8fea5-146">Configuration for Shared Access Signature authentication</span></span>

<span data-ttu-id="8fea5-147">You can configure the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) rule on Service Bus namespaces, queues, or topics.</span><span class="sxs-lookup"><span data-stu-id="8fea5-147">You can configure the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) rule on Service Bus namespaces, queues, or topics.</span></span> <span data-ttu-id="8fea5-148">Configuring a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) on a Service Bus subscription is currently not supported, but you can use rules configured on a namespace or topic to secure access to subscriptions.</span><span class="sxs-lookup"><span data-stu-id="8fea5-148">Configuring a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) on a Service Bus subscription is currently not supported, but you can use rules configured on a namespace or topic to secure access to subscriptions.</span></span> <span data-ttu-id="8fea5-149">For a working sample that illustrates this procedure, see the [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) sample.</span><span class="sxs-lookup"><span data-stu-id="8fea5-149">For a working sample that illustrates this procedure, see the [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c) sample.</span></span>

![SAS](./media/service-bus-sas/service-bus-namespace.png)

<span data-ttu-id="8fea5-151">In this figure, the *manageRuleNS*, *sendRuleNS*, and *listenRuleNS* authorization rules apply to both queue Q1 and topic T1, while *listenRuleQ* and *sendRuleQ* apply only to queue Q1 and *sendRuleT* applies only to topic T1.</span><span class="sxs-lookup"><span data-stu-id="8fea5-151">In this figure, the *manageRuleNS*, *sendRuleNS*, and *listenRuleNS* authorization rules apply to both queue Q1 and topic T1, while *listenRuleQ* and *sendRuleQ* apply only to queue Q1 and *sendRuleT* applies only to topic T1.</span></span>

## <a name="generate-a-shared-access-signature-token"></a><span data-ttu-id="8fea5-152">Generate a Shared Access Signature token</span><span class="sxs-lookup"><span data-stu-id="8fea5-152">Generate a Shared Access Signature token</span></span>

<span data-ttu-id="8fea5-153">Any client that has access to name of an authorization rule name and one of its signing keys can generate a SAS token.</span><span class="sxs-lookup"><span data-stu-id="8fea5-153">Any client that has access to name of an authorization rule name and one of its signing keys can generate a SAS token.</span></span> <span data-ttu-id="8fea5-154">The token is generated by crafting a string in the following format:</span><span class="sxs-lookup"><span data-stu-id="8fea5-154">The token is generated by crafting a string in the following format:</span></span>

```
SharedAccessSignature sig=<signature-string>&se=<expiry>&skn=<keyName>&sr=<URL-encoded-resourceURI>
```

* <span data-ttu-id="8fea5-155">**`se`** - Token expiry instant.</span><span class="sxs-lookup"><span data-stu-id="8fea5-155">**`se`** - Token expiry instant.</span></span> <span data-ttu-id="8fea5-156">Integer reflecting seconds since the epoch `00:00:00 UTC` on 1 January 1970 (UNIX epoch) when the token expires.</span><span class="sxs-lookup"><span data-stu-id="8fea5-156">Integer reflecting seconds since the epoch `00:00:00 UTC` on 1 January 1970 (UNIX epoch) when the token expires.</span></span>
* <span data-ttu-id="8fea5-157">**`skn`** - Name of the authorization rule.</span><span class="sxs-lookup"><span data-stu-id="8fea5-157">**`skn`** - Name of the authorization rule.</span></span>
* <span data-ttu-id="8fea5-158">**`sr`** - URI of the resource being accessed.</span><span class="sxs-lookup"><span data-stu-id="8fea5-158">**`sr`** - URI of the resource being accessed.</span></span>
* <span data-ttu-id="8fea5-159">**`sig`** - Signature.</span><span class="sxs-lookup"><span data-stu-id="8fea5-159">**`sig`** - Signature.</span></span>

<span data-ttu-id="8fea5-160">The `signature-string` is the SHA-256 hash computed over the resource URI (**scope** as described in the previous section) and the string representation of the token expiry instant, separated by CRLF.</span><span class="sxs-lookup"><span data-stu-id="8fea5-160">The `signature-string` is the SHA-256 hash computed over the resource URI (**scope** as described in the previous section) and the string representation of the token expiry instant, separated by CRLF.</span></span>

<span data-ttu-id="8fea5-161">The hash computation looks similar to the following pseudo code and returns a 256-bit/32-byte hash value.</span><span class="sxs-lookup"><span data-stu-id="8fea5-161">The hash computation looks similar to the following pseudo code and returns a 256-bit/32-byte hash value.</span></span>

```
SHA-256('https://<yournamespace>.servicebus.windows.net/'+'\n'+ 1438205742)
```

<span data-ttu-id="8fea5-162">The token contains the non-hashed values so that the recipient can recompute the hash with the same parameters, verifying that the issuer is in possession of a valid signing key.</span><span class="sxs-lookup"><span data-stu-id="8fea5-162">The token contains the non-hashed values so that the recipient can recompute the hash with the same parameters, verifying that the issuer is in possession of a valid signing key.</span></span> 

<span data-ttu-id="8fea5-163">The resource URI is the full URI of the Service Bus resource to which access is claimed.</span><span class="sxs-lookup"><span data-stu-id="8fea5-163">The resource URI is the full URI of the Service Bus resource to which access is claimed.</span></span> <span data-ttu-id="8fea5-164">For example, `http://<namespace>.servicebus.windows.net/<entityPath>` or `sb://<namespace>.servicebus.windows.net/<entityPath>`; that is, `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span><span class="sxs-lookup"><span data-stu-id="8fea5-164">For example, `http://<namespace>.servicebus.windows.net/<entityPath>` or `sb://<namespace>.servicebus.windows.net/<entityPath>`; that is, `http://contoso.servicebus.windows.net/contosoTopics/T1/Subscriptions/S3`.</span></span> <span data-ttu-id="8fea5-165">The URI must be [percent-encoded](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span><span class="sxs-lookup"><span data-stu-id="8fea5-165">The URI must be [percent-encoded](https://msdn.microsoft.com/library/4fkewx0t.aspx).</span></span>

<span data-ttu-id="8fea5-166">The shared access authorization rule used for signing must be configured on the entity specified by this URI, or by one of its hierarchical parents.</span><span class="sxs-lookup"><span data-stu-id="8fea5-166">The shared access authorization rule used for signing must be configured on the entity specified by this URI, or by one of its hierarchical parents.</span></span> <span data-ttu-id="8fea5-167">For example, `http://contoso.servicebus.windows.net/contosoTopics/T1` or `http://contoso.servicebus.windows.net` in the previous example.</span><span class="sxs-lookup"><span data-stu-id="8fea5-167">For example, `http://contoso.servicebus.windows.net/contosoTopics/T1` or `http://contoso.servicebus.windows.net` in the previous example.</span></span>

<span data-ttu-id="8fea5-168">A SAS token is valid for all resources prefixed with the `<resourceURI>` used in the `signature-string`.</span><span class="sxs-lookup"><span data-stu-id="8fea5-168">A SAS token is valid for all resources prefixed with the `<resourceURI>` used in the `signature-string`.</span></span>

## <a name="regenerating-keys"></a><span data-ttu-id="8fea5-169">Regenerating keys</span><span class="sxs-lookup"><span data-stu-id="8fea5-169">Regenerating keys</span></span>

<span data-ttu-id="8fea5-170">It is recommended that you periodically regenerate the keys used in the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object.</span><span class="sxs-lookup"><span data-stu-id="8fea5-170">It is recommended that you periodically regenerate the keys used in the [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object.</span></span> <span data-ttu-id="8fea5-171">The primary and secondary key slots exist so that you can rotate keys gradually.</span><span class="sxs-lookup"><span data-stu-id="8fea5-171">The primary and secondary key slots exist so that you can rotate keys gradually.</span></span> <span data-ttu-id="8fea5-172">If your application generally uses the primary key, you can copy the primary key into the secondary key slot, and only then regenerate the primary key.</span><span class="sxs-lookup"><span data-stu-id="8fea5-172">If your application generally uses the primary key, you can copy the primary key into the secondary key slot, and only then regenerate the primary key.</span></span> <span data-ttu-id="8fea5-173">The new primary key value can then be configured into the client applications, which have continued access using the old primary key in the secondary slot.</span><span class="sxs-lookup"><span data-stu-id="8fea5-173">The new primary key value can then be configured into the client applications, which have continued access using the old primary key in the secondary slot.</span></span> <span data-ttu-id="8fea5-174">Once all clients are updated, you can regenerate the secondary key to finally retire the old primary key.</span><span class="sxs-lookup"><span data-stu-id="8fea5-174">Once all clients are updated, you can regenerate the secondary key to finally retire the old primary key.</span></span>

<span data-ttu-id="8fea5-175">If you know or suspect that a key is compromised and you have to revoke the keys, you can regenerate both the [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) and the [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), replacing them with new keys.</span><span class="sxs-lookup"><span data-stu-id="8fea5-175">If you know or suspect that a key is compromised and you have to revoke the keys, you can regenerate both the [PrimaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_PrimaryKey) and the [SecondaryKey](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule#Microsoft_ServiceBus_Messaging_SharedAccessAuthorizationRule_SecondaryKey) of a [SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule), replacing them with new keys.</span></span> <span data-ttu-id="8fea5-176">This procedure invalidates all tokens signed with the old keys.</span><span class="sxs-lookup"><span data-stu-id="8fea5-176">This procedure invalidates all tokens signed with the old keys.</span></span>

## <a name="shared-access-signature-authentication-with-service-bus"></a><span data-ttu-id="8fea5-177">Shared Access Signature authentication with Service Bus</span><span class="sxs-lookup"><span data-stu-id="8fea5-177">Shared Access Signature authentication with Service Bus</span></span>

<span data-ttu-id="8fea5-178">The scenarios described as follows include configuration of authorization rules, generation of SAS tokens, and client authorization.</span><span class="sxs-lookup"><span data-stu-id="8fea5-178">The scenarios described as follows include configuration of authorization rules, generation of SAS tokens, and client authorization.</span></span>

<span data-ttu-id="8fea5-179">For a full working sample of a Service Bus application that illustrates the configuration and uses SAS authorization, see [Shared Access Signature authentication with Service Bus](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span><span class="sxs-lookup"><span data-stu-id="8fea5-179">For a full working sample of a Service Bus application that illustrates the configuration and uses SAS authorization, see [Shared Access Signature authentication with Service Bus](http://code.msdn.microsoft.com/Shared-Access-Signature-0a88adf8).</span></span> <span data-ttu-id="8fea5-180">A related sample that illustrates the use of SAS authorization rules configured on namespaces or topics to secure Service Bus subscriptions is available here: [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span><span class="sxs-lookup"><span data-stu-id="8fea5-180">A related sample that illustrates the use of SAS authorization rules configured on namespaces or topics to secure Service Bus subscriptions is available here: [Using Shared Access Signature (SAS) authentication with Service Bus Subscriptions](http://code.msdn.microsoft.com/Using-Shared-Access-e605b37c).</span></span>

## <a name="access-shared-access-authorization-rules-on-an-entity"></a><span data-ttu-id="8fea5-181">Access Shared Access Authorization rules on an entity</span><span class="sxs-lookup"><span data-stu-id="8fea5-181">Access Shared Access Authorization rules on an entity</span></span>

<span data-ttu-id="8fea5-182">With Service Bus .NET Framework libraries, you can access a [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object configured on a Service Bus queue or topic through the [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) collection in the corresponding [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) or [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span><span class="sxs-lookup"><span data-stu-id="8fea5-182">With Service Bus .NET Framework libraries, you can access a [Microsoft.ServiceBus.Messaging.SharedAccessAuthorizationRule](/dotnet/api/microsoft.servicebus.messaging.sharedaccessauthorizationrule) object configured on a Service Bus queue or topic through the [AuthorizationRules](/dotnet/api/microsoft.servicebus.messaging.authorizationrules) collection in the corresponding [QueueDescription](/dotnet/api/microsoft.servicebus.messaging.queuedescription) or [TopicDescription](/dotnet/api/microsoft.servicebus.messaging.topicdescription).</span></span>

<span data-ttu-id="8fea5-183">The following code shows how to add authorization rules for a queue.</span><span class="sxs-lookup"><span data-stu-id="8fea5-183">The following code shows how to add authorization rules for a queue.</span></span>

```csharp
// Create an instance of NamespaceManager for the operation
NamespaceManager nsm = NamespaceManager.CreateFromConnectionString(
    <connectionString> );
QueueDescription qd = new QueueDescription( <qPath> );

// Create a rule with send rights with keyName as "contosoQSendKey"
// and add it to the queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoSendKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Send }));

// Create a rule with listen rights with keyName as "contosoQListenKey"
// and add it to the queue description.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQListenKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] { AccessRights.Listen }));

// Create a rule with manage rights with keyName as "contosoQManageKey"
// and add it to the queue description.
// A rule with manage rights must also have send and receive rights.
qd.Authorization.Add(new SharedAccessAuthorizationRule("contosoQManageKey",
    SharedAccessAuthorizationRule.GenerateRandomKey(),
    new[] {AccessRights.Manage, AccessRights.Listen, AccessRights.Send }));

// Create the queue.
nsm.CreateQueue(qd);
```

## <a name="use-shared-access-signature-authorization"></a><span data-ttu-id="8fea5-184">Use Shared Access Signature authorization</span><span class="sxs-lookup"><span data-stu-id="8fea5-184">Use Shared Access Signature authorization</span></span>

<span data-ttu-id="8fea5-185">Applications using the Azure .NET SDK with the Service Bus .NET libraries can use SAS authorization through the [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) class.</span><span class="sxs-lookup"><span data-stu-id="8fea5-185">Applications using the Azure .NET SDK with the Service Bus .NET libraries can use SAS authorization through the [SharedAccessSignatureTokenProvider](/dotnet/api/microsoft.servicebus.sharedaccesssignaturetokenprovider) class.</span></span> <span data-ttu-id="8fea5-186">The following code illustrates the use of the token provider to send messages to a Service Bus queue.</span><span class="sxs-lookup"><span data-stu-id="8fea5-186">The following code illustrates the use of the token provider to send messages to a Service Bus queue.</span></span> <span data-ttu-id="8fea5-187">Alternative to the usage shown here, you can also pass a previously issued token to the token provider factory method.</span><span class="sxs-lookup"><span data-stu-id="8fea5-187">Alternative to the usage shown here, you can also pass a previously issued token to the token provider factory method.</span></span>

```csharp
Uri runtimeUri = ServiceBusEnvironment.CreateServiceUri("sb",
    <yourServiceNamespace>, string.Empty);
MessagingFactory mf = MessagingFactory.Create(runtimeUri,
    TokenProvider.CreateSharedAccessSignatureTokenProvider(keyName, key));
QueueClient sendClient = mf.CreateQueueClient(qPath);

//Sending hello message to queue.
BrokeredMessage helloMessage = new BrokeredMessage("Hello, Service Bus!");
helloMessage.MessageId = "SAS-Sample-Message";
sendClient.Send(helloMessage);
```

<span data-ttu-id="8fea5-188">You can also use the token provider directly for issuing tokens to pass to other clients.</span><span class="sxs-lookup"><span data-stu-id="8fea5-188">You can also use the token provider directly for issuing tokens to pass to other clients.</span></span> 

<span data-ttu-id="8fea5-189">Connection strings can include a rule name (*SharedAccessKeyName*) and rule key (*SharedAccessKey*) or a previously issued token (*SharedAccessSignature*).</span><span class="sxs-lookup"><span data-stu-id="8fea5-189">Connection strings can include a rule name (*SharedAccessKeyName*) and rule key (*SharedAccessKey*) or a previously issued token (*SharedAccessSignature*).</span></span> <span data-ttu-id="8fea5-190">When those are present in the connection string passed to any constructor or factory method accepting a connection string, the SAS token provider is automatically created and populated.</span><span class="sxs-lookup"><span data-stu-id="8fea5-190">When those are present in the connection string passed to any constructor or factory method accepting a connection string, the SAS token provider is automatically created and populated.</span></span>

<span data-ttu-id="8fea5-191">Note that to use SAS authorization with Service Bus relays, you can use SAS keys configured on the Service Bus namespace.</span><span class="sxs-lookup"><span data-stu-id="8fea5-191">Note that to use SAS authorization with Service Bus relays, you can use SAS keys configured on the Service Bus namespace.</span></span> <span data-ttu-id="8fea5-192">If you explicitly create a relay on the namespace ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) with a [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)) object, you can set the SAS rules just for that relay.</span><span class="sxs-lookup"><span data-stu-id="8fea5-192">If you explicitly create a relay on the namespace ([NamespaceManager](/dotnet/api/microsoft.servicebus.namespacemanager) with a [RelayDescription](/dotnet/api/microsoft.servicebus.messaging.relaydescription)) object, you can set the SAS rules just for that relay.</span></span> <span data-ttu-id="8fea5-193">To use SAS authorization with Service Bus subscriptions, you can use SAS keys configured on a Service Bus namespace or on a topic.</span><span class="sxs-lookup"><span data-stu-id="8fea5-193">To use SAS authorization with Service Bus subscriptions, you can use SAS keys configured on a Service Bus namespace or on a topic.</span></span>

## <a name="use-the-shared-access-signature-at-http-level"></a><span data-ttu-id="8fea5-194">Use the Shared Access Signature (at HTTP level)</span><span class="sxs-lookup"><span data-stu-id="8fea5-194">Use the Shared Access Signature (at HTTP level)</span></span>

<span data-ttu-id="8fea5-195">Now that you know how to create Shared Access Signatures for any entities in Service Bus, you are ready to perform an HTTP POST:</span><span class="sxs-lookup"><span data-stu-id="8fea5-195">Now that you know how to create Shared Access Signatures for any entities in Service Bus, you are ready to perform an HTTP POST:</span></span>

```http
POST https://<yournamespace>.servicebus.windows.net/<yourentity>/messages
Content-Type: application/json
Authorization: SharedAccessSignature sr=https%3A%2F%2F<yournamespace>.servicebus.windows.net%2F<yourentity>&sig=<yoursignature from code above>&se=1438205742&skn=KeyName
ContentType: application/atom+xml;type=entry;charset=utf-8
``` 

<span data-ttu-id="8fea5-196">Remember, this works for everything.</span><span class="sxs-lookup"><span data-stu-id="8fea5-196">Remember, this works for everything.</span></span> <span data-ttu-id="8fea5-197">You can create SAS for a queue, topic, or subscription.</span><span class="sxs-lookup"><span data-stu-id="8fea5-197">You can create SAS for a queue, topic, or subscription.</span></span>

<span data-ttu-id="8fea5-198">If you give a sender or client a SAS token, they don't have the key directly, and they cannot reverse the hash to obtain it.</span><span class="sxs-lookup"><span data-stu-id="8fea5-198">If you give a sender or client a SAS token, they don't have the key directly, and they cannot reverse the hash to obtain it.</span></span> <span data-ttu-id="8fea5-199">As such, you have control over what they can access, and for how long.</span><span class="sxs-lookup"><span data-stu-id="8fea5-199">As such, you have control over what they can access, and for how long.</span></span> <span data-ttu-id="8fea5-200">An important thing to remember is that if you change the primary key in the policy, any Shared Access Signatures created from it are invalidated.</span><span class="sxs-lookup"><span data-stu-id="8fea5-200">An important thing to remember is that if you change the primary key in the policy, any Shared Access Signatures created from it are invalidated.</span></span>

## <a name="use-the-shared-access-signature-at-amqp-level"></a><span data-ttu-id="8fea5-201">Use the Shared Access Signature (at AMQP level)</span><span class="sxs-lookup"><span data-stu-id="8fea5-201">Use the Shared Access Signature (at AMQP level)</span></span>

<span data-ttu-id="8fea5-202">In the previous section, you saw how to use the SAS token with an HTTP POST request for sending data to the Service Bus.</span><span class="sxs-lookup"><span data-stu-id="8fea5-202">In the previous section, you saw how to use the SAS token with an HTTP POST request for sending data to the Service Bus.</span></span> <span data-ttu-id="8fea5-203">As you know, you can access Service Bus using the Advanced Message Queuing Protocol (AMQP) that is the preferred protocol to use for performance reasons, in many scenarios.</span><span class="sxs-lookup"><span data-stu-id="8fea5-203">As you know, you can access Service Bus using the Advanced Message Queuing Protocol (AMQP) that is the preferred protocol to use for performance reasons, in many scenarios.</span></span> <span data-ttu-id="8fea5-204">The SAS token usage with AMQP is described in the document [AMQP Claim-Based Security Version 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) that is in working draft since 2013 but well-supported by Azure today.</span><span class="sxs-lookup"><span data-stu-id="8fea5-204">The SAS token usage with AMQP is described in the document [AMQP Claim-Based Security Version 1.0](https://www.oasis-open.org/committees/download.php/50506/amqp-cbs-v1%200-wd02%202013-08-12.doc) that is in working draft since 2013 but well-supported by Azure today.</span></span>

<span data-ttu-id="8fea5-205">Before starting to send data to Service Bus, the publisher must send the SAS token inside an AMQP message to a well-defined AMQP node named **$cbs** (you can see it as a "special" queue used by the service to acquire and validate all the SAS tokens).</span><span class="sxs-lookup"><span data-stu-id="8fea5-205">Before starting to send data to Service Bus, the publisher must send the SAS token inside an AMQP message to a well-defined AMQP node named **$cbs** (you can see it as a "special" queue used by the service to acquire and validate all the SAS tokens).</span></span> <span data-ttu-id="8fea5-206">The publisher must specify the **ReplyTo** field inside the AMQP message; this is the node in which the service replies to the publisher with the result of the token validation (a simple request/reply pattern between publisher and service).</span><span class="sxs-lookup"><span data-stu-id="8fea5-206">The publisher must specify the **ReplyTo** field inside the AMQP message; this is the node in which the service replies to the publisher with the result of the token validation (a simple request/reply pattern between publisher and service).</span></span> <span data-ttu-id="8fea5-207">This reply node is created "on the fly," speaking about "dynamic creation of remote node" as described by the AMQP 1.0 specification.</span><span class="sxs-lookup"><span data-stu-id="8fea5-207">This reply node is created "on the fly," speaking about "dynamic creation of remote node" as described by the AMQP 1.0 specification.</span></span> <span data-ttu-id="8fea5-208">After checking that the SAS token is valid, the publisher can go forward and start to send data to the service.</span><span class="sxs-lookup"><span data-stu-id="8fea5-208">After checking that the SAS token is valid, the publisher can go forward and start to send data to the service.</span></span>

<span data-ttu-id="8fea5-209">The following steps show how to send the SAS token with AMQP protocol using the [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) library.</span><span class="sxs-lookup"><span data-stu-id="8fea5-209">The following steps show how to send the SAS token with AMQP protocol using the [AMQP.Net Lite](https://github.com/Azure/amqpnetlite) library.</span></span> <span data-ttu-id="8fea5-210">This is useful if you can't use the official Service Bus SDK (for example on WinRT, .Net Compact Framework, .Net Micro Framework and Mono) developing in C\#.</span><span class="sxs-lookup"><span data-stu-id="8fea5-210">This is useful if you can't use the official Service Bus SDK (for example on WinRT, .Net Compact Framework, .Net Micro Framework and Mono) developing in C\#.</span></span> <span data-ttu-id="8fea5-211">Of course, this library is useful to help understand how claims-based security works at the AMQP level, as you saw how it works at the HTTP level (with an HTTP POST request and the SAS token sent inside the "Authorization" header).</span><span class="sxs-lookup"><span data-stu-id="8fea5-211">Of course, this library is useful to help understand how claims-based security works at the AMQP level, as you saw how it works at the HTTP level (with an HTTP POST request and the SAS token sent inside the "Authorization" header).</span></span> <span data-ttu-id="8fea5-212">If you don't need such deep knowledge about AMQP, you can use the official Service Bus SDK with .Net Framework applications, which will do it for you.</span><span class="sxs-lookup"><span data-stu-id="8fea5-212">If you don't need such deep knowledge about AMQP, you can use the official Service Bus SDK with .Net Framework applications, which will do it for you.</span></span>

### <a name="c35"></a><span data-ttu-id="8fea5-213">C&#35;</span><span class="sxs-lookup"><span data-stu-id="8fea5-213">C&#35;</span></span>

```csharp
/// <summary>
/// Send claim-based security (CBS) token
/// </summary>
/// <param name="shareAccessSignature">Shared access signature (token) to send</param>
private bool PutCbsToken(Connection connection, string sasToken)
{
    bool result = true;
    Session session = new Session(connection);

    string cbsClientAddress = "cbs-client-reply-to";
    var cbsSender = new SenderLink(session, "cbs-sender", "$cbs");
    var cbsReceiver = new ReceiverLink(session, cbsClientAddress, "$cbs");

    // construct the put-token message
    var request = new Message(sasToken);
    request.Properties = new Properties();
    request.Properties.MessageId = Guid.NewGuid().ToString();
    request.Properties.ReplyTo = cbsClientAddress;
    request.ApplicationProperties = new ApplicationProperties();
    request.ApplicationProperties["operation"] = "put-token";
    request.ApplicationProperties["type"] = "servicebus.windows.net:sastoken";
    request.ApplicationProperties["name"] = Fx.Format("amqp://{0}/{1}", sbNamespace, entity);
    cbsSender.Send(request);

    // receive the response
    var response = cbsReceiver.Receive();
    if (response == null || response.Properties == null || response.ApplicationProperties == null)
    {
        result = false;
    }
    else
    {
        int statusCode = (int)response.ApplicationProperties["status-code"];
        if (statusCode != (int)HttpStatusCode.Accepted && statusCode != (int)HttpStatusCode.OK)
        {
            result = false;
        }
    }

    // the sender/receiver may be kept open for refreshing tokens
    cbsSender.Close();
    cbsReceiver.Close();
    session.Close();

    return result;
}
```

<span data-ttu-id="8fea5-214">The `PutCbsToken()` method receives the *connection* (AMQP connection class instance as provided by the [AMQP .NET Lite library](https://github.com/Azure/amqpnetlite)) that represents the TCP connection to the service and the *sasToken* parameter that is the SAS token to send.</span><span class="sxs-lookup"><span data-stu-id="8fea5-214">The `PutCbsToken()` method receives the *connection* (AMQP connection class instance as provided by the [AMQP .NET Lite library](https://github.com/Azure/amqpnetlite)) that represents the TCP connection to the service and the *sasToken* parameter that is the SAS token to send.</span></span> 

> [!NOTE]
> <span data-ttu-id="8fea5-215">It's important that the connection is created with **SASL authentication mechanism set to ANONYMOUS** (and not the default PLAIN with username and password used when you don't need to send the SAS token).</span><span class="sxs-lookup"><span data-stu-id="8fea5-215">It's important that the connection is created with **SASL authentication mechanism set to ANONYMOUS** (and not the default PLAIN with username and password used when you don't need to send the SAS token).</span></span>
> 
> 

<span data-ttu-id="8fea5-216">Next, the publisher creates two AMQP links for sending the SAS token and receiving the reply (the token validation result) from the service.</span><span class="sxs-lookup"><span data-stu-id="8fea5-216">Next, the publisher creates two AMQP links for sending the SAS token and receiving the reply (the token validation result) from the service.</span></span>

<span data-ttu-id="8fea5-217">The AMQP message contains a set of properties, and more information than a simple message.</span><span class="sxs-lookup"><span data-stu-id="8fea5-217">The AMQP message contains a set of properties, and more information than a simple message.</span></span> <span data-ttu-id="8fea5-218">The SAS token is the body of the message (using its constructor).</span><span class="sxs-lookup"><span data-stu-id="8fea5-218">The SAS token is the body of the message (using its constructor).</span></span> <span data-ttu-id="8fea5-219">The **"ReplyTo"** property is set to the node name for receiving the validation result on the receiver link (you can change its name if you want, and it will be created dynamically by the service).</span><span class="sxs-lookup"><span data-stu-id="8fea5-219">The **"ReplyTo"** property is set to the node name for receiving the validation result on the receiver link (you can change its name if you want, and it will be created dynamically by the service).</span></span> <span data-ttu-id="8fea5-220">The last three application/custom properties are used by the service to indicate what kind of operation it has to execute.</span><span class="sxs-lookup"><span data-stu-id="8fea5-220">The last three application/custom properties are used by the service to indicate what kind of operation it has to execute.</span></span> <span data-ttu-id="8fea5-221">As described by the CBS draft specification, they must be the **operation name** ("put-token"), the **type of token** (in this case, a `servicebus.windows.net:sastoken`), and the **"name" of the audience** to which the token applies (the entire entity).</span><span class="sxs-lookup"><span data-stu-id="8fea5-221">As described by the CBS draft specification, they must be the **operation name** ("put-token"), the **type of token** (in this case, a `servicebus.windows.net:sastoken`), and the **"name" of the audience** to which the token applies (the entire entity).</span></span>

<span data-ttu-id="8fea5-222">After sending the SAS token on the sender link, the publisher must read the reply on the receiver link.</span><span class="sxs-lookup"><span data-stu-id="8fea5-222">After sending the SAS token on the sender link, the publisher must read the reply on the receiver link.</span></span> <span data-ttu-id="8fea5-223">The reply is a simple AMQP message with an application property named **"status-code"** that can contain the same values as an HTTP status code.</span><span class="sxs-lookup"><span data-stu-id="8fea5-223">The reply is a simple AMQP message with an application property named **"status-code"** that can contain the same values as an HTTP status code.</span></span>

## <a name="rights-required-for-service-bus-operations"></a><span data-ttu-id="8fea5-224">Rights required for Service Bus operations</span><span class="sxs-lookup"><span data-stu-id="8fea5-224">Rights required for Service Bus operations</span></span>

<span data-ttu-id="8fea5-225">The following table shows the access rights required for various operations on Service Bus resources.</span><span class="sxs-lookup"><span data-stu-id="8fea5-225">The following table shows the access rights required for various operations on Service Bus resources.</span></span>

| <span data-ttu-id="8fea5-226">Operation</span><span class="sxs-lookup"><span data-stu-id="8fea5-226">Operation</span></span> | <span data-ttu-id="8fea5-227">Claim Required</span><span class="sxs-lookup"><span data-stu-id="8fea5-227">Claim Required</span></span> | <span data-ttu-id="8fea5-228">Claim Scope</span><span class="sxs-lookup"><span data-stu-id="8fea5-228">Claim Scope</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8fea5-229">**Namespace**</span><span class="sxs-lookup"><span data-stu-id="8fea5-229">**Namespace**</span></span> | | |
| <span data-ttu-id="8fea5-230">Configure authorization rule on a namespace</span><span class="sxs-lookup"><span data-stu-id="8fea5-230">Configure authorization rule on a namespace</span></span> |<span data-ttu-id="8fea5-231">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-231">Manage</span></span> |<span data-ttu-id="8fea5-232">Any namespace address</span><span class="sxs-lookup"><span data-stu-id="8fea5-232">Any namespace address</span></span> |
| <span data-ttu-id="8fea5-233">**Service Registry**</span><span class="sxs-lookup"><span data-stu-id="8fea5-233">**Service Registry**</span></span> | | |
| <span data-ttu-id="8fea5-234">Enumerate Private Policies</span><span class="sxs-lookup"><span data-stu-id="8fea5-234">Enumerate Private Policies</span></span> |<span data-ttu-id="8fea5-235">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-235">Manage</span></span> |<span data-ttu-id="8fea5-236">Any namespace address</span><span class="sxs-lookup"><span data-stu-id="8fea5-236">Any namespace address</span></span> |
| <span data-ttu-id="8fea5-237">Begin listening on a namespace</span><span class="sxs-lookup"><span data-stu-id="8fea5-237">Begin listening on a namespace</span></span> |<span data-ttu-id="8fea5-238">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-238">Listen</span></span> |<span data-ttu-id="8fea5-239">Any namespace address</span><span class="sxs-lookup"><span data-stu-id="8fea5-239">Any namespace address</span></span> |
| <span data-ttu-id="8fea5-240">Send messages to a listener at a namespace</span><span class="sxs-lookup"><span data-stu-id="8fea5-240">Send messages to a listener at a namespace</span></span> |<span data-ttu-id="8fea5-241">Send</span><span class="sxs-lookup"><span data-stu-id="8fea5-241">Send</span></span> |<span data-ttu-id="8fea5-242">Any namespace address</span><span class="sxs-lookup"><span data-stu-id="8fea5-242">Any namespace address</span></span> |
| <span data-ttu-id="8fea5-243">**Queue**</span><span class="sxs-lookup"><span data-stu-id="8fea5-243">**Queue**</span></span> | | |
| <span data-ttu-id="8fea5-244">Create a queue</span><span class="sxs-lookup"><span data-stu-id="8fea5-244">Create a queue</span></span> |<span data-ttu-id="8fea5-245">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-245">Manage</span></span> |<span data-ttu-id="8fea5-246">Any namespace address</span><span class="sxs-lookup"><span data-stu-id="8fea5-246">Any namespace address</span></span> |
| <span data-ttu-id="8fea5-247">Delete a queue</span><span class="sxs-lookup"><span data-stu-id="8fea5-247">Delete a queue</span></span> |<span data-ttu-id="8fea5-248">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-248">Manage</span></span> |<span data-ttu-id="8fea5-249">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-249">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-250">Enumerate queues</span><span class="sxs-lookup"><span data-stu-id="8fea5-250">Enumerate queues</span></span> |<span data-ttu-id="8fea5-251">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-251">Manage</span></span> |<span data-ttu-id="8fea5-252">/$Resources/Queues</span><span class="sxs-lookup"><span data-stu-id="8fea5-252">/$Resources/Queues</span></span> |
| <span data-ttu-id="8fea5-253">Get the queue description</span><span class="sxs-lookup"><span data-stu-id="8fea5-253">Get the queue description</span></span> |<span data-ttu-id="8fea5-254">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-254">Manage</span></span> |<span data-ttu-id="8fea5-255">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-255">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-256">Configure authorization rule for a queue</span><span class="sxs-lookup"><span data-stu-id="8fea5-256">Configure authorization rule for a queue</span></span> |<span data-ttu-id="8fea5-257">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-257">Manage</span></span> |<span data-ttu-id="8fea5-258">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-258">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-259">Send into to the queue</span><span class="sxs-lookup"><span data-stu-id="8fea5-259">Send into to the queue</span></span> |<span data-ttu-id="8fea5-260">Send</span><span class="sxs-lookup"><span data-stu-id="8fea5-260">Send</span></span> |<span data-ttu-id="8fea5-261">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-261">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-262">Receive messages from a queue</span><span class="sxs-lookup"><span data-stu-id="8fea5-262">Receive messages from a queue</span></span> |<span data-ttu-id="8fea5-263">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-263">Listen</span></span> |<span data-ttu-id="8fea5-264">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-264">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-265">Abandon or complete messages after receiving the message in peek-lock mode</span><span class="sxs-lookup"><span data-stu-id="8fea5-265">Abandon or complete messages after receiving the message in peek-lock mode</span></span> |<span data-ttu-id="8fea5-266">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-266">Listen</span></span> |<span data-ttu-id="8fea5-267">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-267">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-268">Defer a message for later retrieval</span><span class="sxs-lookup"><span data-stu-id="8fea5-268">Defer a message for later retrieval</span></span> |<span data-ttu-id="8fea5-269">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-269">Listen</span></span> |<span data-ttu-id="8fea5-270">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-270">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-271">Deadletter a message</span><span class="sxs-lookup"><span data-stu-id="8fea5-271">Deadletter a message</span></span> |<span data-ttu-id="8fea5-272">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-272">Listen</span></span> |<span data-ttu-id="8fea5-273">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-273">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-274">Get the state associated with a message queue session</span><span class="sxs-lookup"><span data-stu-id="8fea5-274">Get the state associated with a message queue session</span></span> |<span data-ttu-id="8fea5-275">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-275">Listen</span></span> |<span data-ttu-id="8fea5-276">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-276">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-277">Set the state associated with a message queue session</span><span class="sxs-lookup"><span data-stu-id="8fea5-277">Set the state associated with a message queue session</span></span> |<span data-ttu-id="8fea5-278">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-278">Listen</span></span> |<span data-ttu-id="8fea5-279">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-279">Any valid queue address</span></span> |
| <span data-ttu-id="8fea5-280">Schedule a message for later delivery; for example, [ScheduleMessageAsync()](/dotnet/api/microsoft.azure.servicebus.queueclient.schedulemessageasync#Microsoft_Azure_ServiceBus_QueueClient_ScheduleMessageAsync_Microsoft_Azure_ServiceBus_Message_System_DateTimeOffset_)</span><span class="sxs-lookup"><span data-stu-id="8fea5-280">Schedule a message for later delivery; for example, [ScheduleMessageAsync()](/dotnet/api/microsoft.azure.servicebus.queueclient.schedulemessageasync#Microsoft_Azure_ServiceBus_QueueClient_ScheduleMessageAsync_Microsoft_Azure_ServiceBus_Message_System_DateTimeOffset_)</span></span> |<span data-ttu-id="8fea5-281">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-281">Listen</span></span> | <span data-ttu-id="8fea5-282">Any valid queue address</span><span class="sxs-lookup"><span data-stu-id="8fea5-282">Any valid queue address</span></span>
| <span data-ttu-id="8fea5-283">**Topic**</span><span class="sxs-lookup"><span data-stu-id="8fea5-283">**Topic**</span></span> | | |
| <span data-ttu-id="8fea5-284">Create a topic</span><span class="sxs-lookup"><span data-stu-id="8fea5-284">Create a topic</span></span> |<span data-ttu-id="8fea5-285">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-285">Manage</span></span> |<span data-ttu-id="8fea5-286">Any namespace address</span><span class="sxs-lookup"><span data-stu-id="8fea5-286">Any namespace address</span></span> |
| <span data-ttu-id="8fea5-287">Delete a topic</span><span class="sxs-lookup"><span data-stu-id="8fea5-287">Delete a topic</span></span> |<span data-ttu-id="8fea5-288">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-288">Manage</span></span> |<span data-ttu-id="8fea5-289">Any valid topic address</span><span class="sxs-lookup"><span data-stu-id="8fea5-289">Any valid topic address</span></span> |
| <span data-ttu-id="8fea5-290">Enumerate topics</span><span class="sxs-lookup"><span data-stu-id="8fea5-290">Enumerate topics</span></span> |<span data-ttu-id="8fea5-291">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-291">Manage</span></span> |<span data-ttu-id="8fea5-292">/$Resources/Topics</span><span class="sxs-lookup"><span data-stu-id="8fea5-292">/$Resources/Topics</span></span> |
| <span data-ttu-id="8fea5-293">Get the topic description</span><span class="sxs-lookup"><span data-stu-id="8fea5-293">Get the topic description</span></span> |<span data-ttu-id="8fea5-294">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-294">Manage</span></span> |<span data-ttu-id="8fea5-295">Any valid topic address</span><span class="sxs-lookup"><span data-stu-id="8fea5-295">Any valid topic address</span></span> |
| <span data-ttu-id="8fea5-296">Configure authorization rule for a topic</span><span class="sxs-lookup"><span data-stu-id="8fea5-296">Configure authorization rule for a topic</span></span> |<span data-ttu-id="8fea5-297">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-297">Manage</span></span> |<span data-ttu-id="8fea5-298">Any valid topic address</span><span class="sxs-lookup"><span data-stu-id="8fea5-298">Any valid topic address</span></span> |
| <span data-ttu-id="8fea5-299">Send to the topic</span><span class="sxs-lookup"><span data-stu-id="8fea5-299">Send to the topic</span></span> |<span data-ttu-id="8fea5-300">Send</span><span class="sxs-lookup"><span data-stu-id="8fea5-300">Send</span></span> |<span data-ttu-id="8fea5-301">Any valid topic address</span><span class="sxs-lookup"><span data-stu-id="8fea5-301">Any valid topic address</span></span> |
| <span data-ttu-id="8fea5-302">**Subscription**</span><span class="sxs-lookup"><span data-stu-id="8fea5-302">**Subscription**</span></span> | | |
| <span data-ttu-id="8fea5-303">Create a subscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-303">Create a subscription</span></span> |<span data-ttu-id="8fea5-304">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-304">Manage</span></span> |<span data-ttu-id="8fea5-305">Any namespace address</span><span class="sxs-lookup"><span data-stu-id="8fea5-305">Any namespace address</span></span> |
| <span data-ttu-id="8fea5-306">Delete subscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-306">Delete subscription</span></span> |<span data-ttu-id="8fea5-307">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-307">Manage</span></span> |<span data-ttu-id="8fea5-308">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-308">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-309">Enumerate subscriptions</span><span class="sxs-lookup"><span data-stu-id="8fea5-309">Enumerate subscriptions</span></span> |<span data-ttu-id="8fea5-310">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-310">Manage</span></span> |<span data-ttu-id="8fea5-311">../myTopic/Subscriptions</span><span class="sxs-lookup"><span data-stu-id="8fea5-311">../myTopic/Subscriptions</span></span> |
| <span data-ttu-id="8fea5-312">Get subscription description</span><span class="sxs-lookup"><span data-stu-id="8fea5-312">Get subscription description</span></span> |<span data-ttu-id="8fea5-313">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-313">Manage</span></span> |<span data-ttu-id="8fea5-314">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-314">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-315">Abandon or complete messages after receiving the message in peek-lock mode</span><span class="sxs-lookup"><span data-stu-id="8fea5-315">Abandon or complete messages after receiving the message in peek-lock mode</span></span> |<span data-ttu-id="8fea5-316">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-316">Listen</span></span> |<span data-ttu-id="8fea5-317">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-317">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-318">Defer a message for later retrieval</span><span class="sxs-lookup"><span data-stu-id="8fea5-318">Defer a message for later retrieval</span></span> |<span data-ttu-id="8fea5-319">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-319">Listen</span></span> |<span data-ttu-id="8fea5-320">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-320">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-321">Deadletter a message</span><span class="sxs-lookup"><span data-stu-id="8fea5-321">Deadletter a message</span></span> |<span data-ttu-id="8fea5-322">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-322">Listen</span></span> |<span data-ttu-id="8fea5-323">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-323">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-324">Get the state associated with a topic session</span><span class="sxs-lookup"><span data-stu-id="8fea5-324">Get the state associated with a topic session</span></span> |<span data-ttu-id="8fea5-325">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-325">Listen</span></span> |<span data-ttu-id="8fea5-326">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-326">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-327">Set the state associated with a topic session</span><span class="sxs-lookup"><span data-stu-id="8fea5-327">Set the state associated with a topic session</span></span> |<span data-ttu-id="8fea5-328">Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-328">Listen</span></span> |<span data-ttu-id="8fea5-329">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-329">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-330">**Rules**</span><span class="sxs-lookup"><span data-stu-id="8fea5-330">**Rules**</span></span> | | |
| <span data-ttu-id="8fea5-331">Create a rule</span><span class="sxs-lookup"><span data-stu-id="8fea5-331">Create a rule</span></span> |<span data-ttu-id="8fea5-332">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-332">Manage</span></span> |<span data-ttu-id="8fea5-333">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-333">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-334">Delete a rule</span><span class="sxs-lookup"><span data-stu-id="8fea5-334">Delete a rule</span></span> |<span data-ttu-id="8fea5-335">Manage</span><span class="sxs-lookup"><span data-stu-id="8fea5-335">Manage</span></span> |<span data-ttu-id="8fea5-336">../myTopic/Subscriptions/mySubscription</span><span class="sxs-lookup"><span data-stu-id="8fea5-336">../myTopic/Subscriptions/mySubscription</span></span> |
| <span data-ttu-id="8fea5-337">Enumerate rules</span><span class="sxs-lookup"><span data-stu-id="8fea5-337">Enumerate rules</span></span> |<span data-ttu-id="8fea5-338">Manage or Listen</span><span class="sxs-lookup"><span data-stu-id="8fea5-338">Manage or Listen</span></span> |<span data-ttu-id="8fea5-339">../myTopic/Subscriptions/mySubscription/Rules</span><span class="sxs-lookup"><span data-stu-id="8fea5-339">../myTopic/Subscriptions/mySubscription/Rules</span></span> 

## <a name="next-steps"></a><span data-ttu-id="8fea5-340">Next steps</span><span class="sxs-lookup"><span data-stu-id="8fea5-340">Next steps</span></span>

<span data-ttu-id="8fea5-341">To learn more about Service Bus messaging, see the following topics.</span><span class="sxs-lookup"><span data-stu-id="8fea5-341">To learn more about Service Bus messaging, see the following topics.</span></span>

* [<span data-ttu-id="8fea5-342">Service Bus fundamentals</span><span class="sxs-lookup"><span data-stu-id="8fea5-342">Service Bus fundamentals</span></span>](service-bus-fundamentals-hybrid-solutions.md)
* [<span data-ttu-id="8fea5-343">Service Bus queues, topics, and subscriptions</span><span class="sxs-lookup"><span data-stu-id="8fea5-343">Service Bus queues, topics, and subscriptions</span></span>](service-bus-queues-topics-subscriptions.md)
* [<span data-ttu-id="8fea5-344">How to use Service Bus queues</span><span class="sxs-lookup"><span data-stu-id="8fea5-344">How to use Service Bus queues</span></span>](service-bus-dotnet-get-started-with-queues.md)
* [<span data-ttu-id="8fea5-345">How to use Service Bus topics and subscriptions</span><span class="sxs-lookup"><span data-stu-id="8fea5-345">How to use Service Bus topics and subscriptions</span></span>](service-bus-dotnet-how-to-use-topics-subscriptions.md)

[Azure portal]: https://portal.azure.com