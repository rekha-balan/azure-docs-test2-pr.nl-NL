---
title: Debug C# modules for Azure IoT Edge | Microsoft Docs
description: Use Visual Studio Code to develop, build, and debug a C# module for Azure IoT Edge
services: iot-edge
keywords: ''
author: shizn
manager: timlt
ms.author: xshi
ms.date: 09/04/2018
ms.topic: article
ms.service: iot-edge
ms.openlocfilehash: 7fec050f43ed6facef548ea19d1d67030458fbb1
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44865354"
---
# <a name="use-visual-studio-code-to-develop-and-debug-c-modules-for-azure-iot-edge"></a><span data-ttu-id="f2ef1-103">Use Visual Studio Code to develop and debug C# modules for Azure IoT Edge</span><span class="sxs-lookup"><span data-stu-id="f2ef1-103">Use Visual Studio Code to develop and debug C# modules for Azure IoT Edge</span></span>

<span data-ttu-id="f2ef1-104">You can turn your business logic into modules for Azure IoT Edge.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-104">You can turn your business logic into modules for Azure IoT Edge.</span></span> <span data-ttu-id="f2ef1-105">This article shows you how to use Visual Studio Code (VS Code) as the main tool to develop and debug C# modules.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-105">This article shows you how to use Visual Studio Code (VS Code) as the main tool to develop and debug C# modules.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="f2ef1-106">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="f2ef1-106">Prerequisites</span></span>
<span data-ttu-id="f2ef1-107">This article assumes that you use a computer or virtual machine running Windows, macOS or Linux as your development machine.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-107">This article assumes that you use a computer or virtual machine running Windows, macOS or Linux as your development machine.</span></span> <span data-ttu-id="f2ef1-108">Your IoT Edge device can be another physical device.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-108">Your IoT Edge device can be another physical device.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ef1-109">This debugging article demonstrates two typical ways to debug your C# module in VS Code.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-109">This debugging article demonstrates two typical ways to debug your C# module in VS Code.</span></span> <span data-ttu-id="f2ef1-110">One way is to attach a process in a module container, while the other is to lanuch the module code in debug mode.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-110">One way is to attach a process in a module container, while the other is to lanuch the module code in debug mode.</span></span> <span data-ttu-id="f2ef1-111">If you aren't familiar with the debugging capabilities of Visual Studio Code, read about [Debugging](https://code.visualstudio.com/Docs/editor/debugging).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-111">If you aren't familiar with the debugging capabilities of Visual Studio Code, read about [Debugging](https://code.visualstudio.com/Docs/editor/debugging).</span></span>

<span data-ttu-id="f2ef1-112">Because this article uses Visual Studio Code as the main development tool, install VS Code.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-112">Because this article uses Visual Studio Code as the main development tool, install VS Code.</span></span> <span data-ttu-id="f2ef1-113">Then add the necessary extensions:</span><span class="sxs-lookup"><span data-stu-id="f2ef1-113">Then add the necessary extensions:</span></span>
* [<span data-ttu-id="f2ef1-114">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="f2ef1-114">Visual Studio Code</span></span>](https://code.visualstudio.com/) 
* [<span data-ttu-id="f2ef1-115">Azure IoT Edge extension</span><span class="sxs-lookup"><span data-stu-id="f2ef1-115">Azure IoT Edge extension</span></span>](https://marketplace.visualstudio.com/items?itemName=vsciot-vscode.azure-iot-edge) 
* [<span data-ttu-id="f2ef1-116">C# extension</span><span class="sxs-lookup"><span data-stu-id="f2ef1-116">C# extension</span></span>](https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp) 
* [<span data-ttu-id="f2ef1-117">Docker extension</span><span class="sxs-lookup"><span data-stu-id="f2ef1-117">Docker extension</span></span>](https://marketplace.visualstudio.com/items?itemName=PeterJausovec.vscode-docker)

<span data-ttu-id="f2ef1-118">To create a module, you need .NET to build the project folder, Docker to build the module image, and a container registry to hold the module image:</span><span class="sxs-lookup"><span data-stu-id="f2ef1-118">To create a module, you need .NET to build the project folder, Docker to build the module image, and a container registry to hold the module image:</span></span>
* <span data-ttu-id="f2ef1-119">[.NET Core 2.1 SDK](https://www.microsoft.com/net/download).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-119">[.NET Core 2.1 SDK](https://www.microsoft.com/net/download).</span></span>
* <span data-ttu-id="f2ef1-120">[Docker Community Edition](https://docs.docker.com/install/) on your development machine.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-120">[Docker Community Edition](https://docs.docker.com/install/) on your development machine.</span></span> 
* <span data-ttu-id="f2ef1-121">[Azure Container Registry](https://docs.microsoft.com/azure/container-registry/) or [Docker Hub](https://docs.docker.com/docker-hub/repos/#viewing-repository-tags)</span><span class="sxs-lookup"><span data-stu-id="f2ef1-121">[Azure Container Registry](https://docs.microsoft.com/azure/container-registry/) or [Docker Hub](https://docs.docker.com/docker-hub/repos/#viewing-repository-tags)</span></span>
   * <span data-ttu-id="f2ef1-122">You can use a local Docker registry for prototype and testing purposes instead of a cloud registry.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-122">You can use a local Docker registry for prototype and testing purposes instead of a cloud registry.</span></span> 

<span data-ttu-id="f2ef1-123">To setup local development environment to debug, run and test your IoT Edge solution, you need [Azure IoT EdgeHub Dev Tool](https://pypi.org/project/iotedgehubdev/).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-123">To setup local development environment to debug, run and test your IoT Edge solution, you need [Azure IoT EdgeHub Dev Tool](https://pypi.org/project/iotedgehubdev/).</span></span> <span data-ttu-id="f2ef1-124">Install [Python (2.7/3.6) and Pip](https://www.python.org/).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-124">Install [Python (2.7/3.6) and Pip](https://www.python.org/).</span></span> <span data-ttu-id="f2ef1-125">Then install **iotedgehubdev** by running below command in your terminal.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-125">Then install **iotedgehubdev** by running below command in your terminal.</span></span>

   ```cmd
   pip install --upgrade iotedgehubdev
   ```

<span data-ttu-id="f2ef1-126">To test your module on a device, you need an active IoT hub with at least one IoT Edge device ID created.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-126">To test your module on a device, you need an active IoT hub with at least one IoT Edge device ID created.</span></span> <span data-ttu-id="f2ef1-127">If you are running IoT Edge daemon on development machine, you might need to stop EdgeHub and EdgeAgent before you move to next step.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-127">If you are running IoT Edge daemon on development machine, you might need to stop EdgeHub and EdgeAgent before you move to next step.</span></span> 

## <a name="create-a-new-solution-with-c-module"></a><span data-ttu-id="f2ef1-128">Create a new solution with C# module</span><span class="sxs-lookup"><span data-stu-id="f2ef1-128">Create a new solution with C# module</span></span>

<span data-ttu-id="f2ef1-129">Take these steps to create an IoT Edge module based on .NET Core 2.0 using Visual Studio Code and the Azure IoT Edge extension.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-129">Take these steps to create an IoT Edge module based on .NET Core 2.0 using Visual Studio Code and the Azure IoT Edge extension.</span></span> <span data-ttu-id="f2ef1-130">First you create a solution, and then you generate the first module in that solution.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-130">First you create a solution, and then you generate the first module in that solution.</span></span> <span data-ttu-id="f2ef1-131">Each solution can contain more than one module.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-131">Each solution can contain more than one module.</span></span> 

1. <span data-ttu-id="f2ef1-132">In Visual Studio Code, select **View** > **Integrated Terminal**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-132">In Visual Studio Code, select **View** > **Integrated Terminal**.</span></span>
3. <span data-ttu-id="f2ef1-133">Select **View** > **Command Palette**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-133">Select **View** > **Command Palette**.</span></span> 
4. <span data-ttu-id="f2ef1-134">In the command palette, enter and run the command **Azure IoT Edge: New IoT Edge Solution**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-134">In the command palette, enter and run the command **Azure IoT Edge: New IoT Edge Solution**.</span></span>

   ![Run New IoT Edge Solution](./media/how-to-develop-csharp-module/new-solution.png)

5. <span data-ttu-id="f2ef1-136">Browse to the folder where you want to create the new solution.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-136">Browse to the folder where you want to create the new solution.</span></span> <span data-ttu-id="f2ef1-137">Choose **Select folder**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-137">Choose **Select folder**.</span></span> 
6. <span data-ttu-id="f2ef1-138">Enter a name for your solution.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-138">Enter a name for your solution.</span></span> 
7. <span data-ttu-id="f2ef1-139">Select **C# Module** as the template for the first module in the solution.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-139">Select **C# Module** as the template for the first module in the solution.</span></span>
8. <span data-ttu-id="f2ef1-140">Enter a name for your module.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-140">Enter a name for your module.</span></span> <span data-ttu-id="f2ef1-141">Choose a name that's unique within your container registry.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-141">Choose a name that's unique within your container registry.</span></span> 
9. <span data-ttu-id="f2ef1-142">Provide the name of the module's image repository.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-142">Provide the name of the module's image repository.</span></span> <span data-ttu-id="f2ef1-143">VS Code autopopulates the module name with **localhost:5000**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-143">VS Code autopopulates the module name with **localhost:5000**.</span></span> <span data-ttu-id="f2ef1-144">Replace it with your own registry information.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-144">Replace it with your own registry information.</span></span> <span data-ttu-id="f2ef1-145">If you use a local Docker registry for testing, then **localhost** is fine.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-145">If you use a local Docker registry for testing, then **localhost** is fine.</span></span> <span data-ttu-id="f2ef1-146">If you use Azure Container Registry, then use the login server from your registry's settings.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-146">If you use Azure Container Registry, then use the login server from your registry's settings.</span></span> <span data-ttu-id="f2ef1-147">The login server looks like **\<registry name\>.azurecr.io**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-147">The login server looks like **\<registry name\>.azurecr.io**.</span></span> <span data-ttu-id="f2ef1-148">Only replace the localhost part of the string, don't delete your module name.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-148">Only replace the localhost part of the string, don't delete your module name.</span></span>

   ![Provide Docker image repository](./media/how-to-develop-csharp-module/repository.png)

<span data-ttu-id="f2ef1-150">VS Code takes the information you provided, creates an IoT Edge solution, and then loads it in a new window.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-150">VS Code takes the information you provided, creates an IoT Edge solution, and then loads it in a new window.</span></span>

   ![View IoT Edge solution](./media/how-to-develop-csharp-module/view-solution.png)

<span data-ttu-id="f2ef1-152">There are four items within the solution:</span><span class="sxs-lookup"><span data-stu-id="f2ef1-152">There are four items within the solution:</span></span> 
* <span data-ttu-id="f2ef1-153">A **.vscode** folder contains debug configurations.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-153">A **.vscode** folder contains debug configurations.</span></span>
* <span data-ttu-id="f2ef1-154">A **modules** folder has subfolders for each module.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-154">A **modules** folder has subfolders for each module.</span></span> <span data-ttu-id="f2ef1-155">At this point, you only have one.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-155">At this point, you only have one.</span></span> <span data-ttu-id="f2ef1-156">But you can add more in the command palette with the command **Azure IoT Edge: Add IoT Edge Module**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-156">But you can add more in the command palette with the command **Azure IoT Edge: Add IoT Edge Module**.</span></span> 
* <span data-ttu-id="f2ef1-157">An **.env** file lists your environment variables.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-157">An **.env** file lists your environment variables.</span></span> <span data-ttu-id="f2ef1-158">If Azure Container Registry is your registry, you'll have an Azure Container Registry username and password in it.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-158">If Azure Container Registry is your registry, you'll have an Azure Container Registry username and password in it.</span></span> 

   >[!NOTE]
   ><span data-ttu-id="f2ef1-159">The environment file is only created if you provide an image repository for the module.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-159">The environment file is only created if you provide an image repository for the module.</span></span> <span data-ttu-id="f2ef1-160">If you accepted the localhost defaults to test and debug locally, then you don't need to declare environment variables.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-160">If you accepted the localhost defaults to test and debug locally, then you don't need to declare environment variables.</span></span> 

* <span data-ttu-id="f2ef1-161">A **deployment.template.json** file lists your new module along with a sample **tempSensor** module that simulates data you can use for testing.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-161">A **deployment.template.json** file lists your new module along with a sample **tempSensor** module that simulates data you can use for testing.</span></span> <span data-ttu-id="f2ef1-162">For more information about how deployment manifests work, see [Learn how to use deployment manifests to deploy modules and establish routes](module-composition.md).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-162">For more information about how deployment manifests work, see [Learn how to use deployment manifests to deploy modules and establish routes](module-composition.md).</span></span> 

## <a name="develop-your-module"></a><span data-ttu-id="f2ef1-163">Develop your module</span><span class="sxs-lookup"><span data-stu-id="f2ef1-163">Develop your module</span></span>

<span data-ttu-id="f2ef1-164">The default C# module code that comes with the solution is located at **modules** > \*\* [your module name] \*\* > **Program.cs**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-164">The default C# module code that comes with the solution is located at **modules** > \*\* [your module name] \*\* > **Program.cs**.</span></span> <span data-ttu-id="f2ef1-165">The module and the deployment.template.json file are set up so that you can build the solution, push it to your container registry, and deploy it to a device to start testing without touching any code.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-165">The module and the deployment.template.json file are set up so that you can build the solution, push it to your container registry, and deploy it to a device to start testing without touching any code.</span></span> <span data-ttu-id="f2ef1-166">The module is built to simply take input from a source (in this case, the tempSensor module that simulates data) and pipe it to IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-166">The module is built to simply take input from a source (in this case, the tempSensor module that simulates data) and pipe it to IoT Hub.</span></span> 

<span data-ttu-id="f2ef1-167">When you're ready to customize the C# template with your own code, use the [Azure IoT Hub SDKs](../iot-hub/iot-hub-devguide-sdks.md) to build modules that address the key needs for IoT solutions such as security, device management, and reliability.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-167">When you're ready to customize the C# template with your own code, use the [Azure IoT Hub SDKs](../iot-hub/iot-hub-devguide-sdks.md) to build modules that address the key needs for IoT solutions such as security, device management, and reliability.</span></span> 

<span data-ttu-id="f2ef1-168">The C# support in VS Code is optimized for cross-platform .NET Core development.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-168">The C# support in VS Code is optimized for cross-platform .NET Core development.</span></span> <span data-ttu-id="f2ef1-169">Learn more about [how to work with C# in VS Code](https://code.visualstudio.com/docs/languages/csharp).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-169">Learn more about [how to work with C# in VS Code](https://code.visualstudio.com/docs/languages/csharp).</span></span>

## <a name="launch-and-debug-module-code-without-container"></a><span data-ttu-id="f2ef1-170">Launch and debug module code without container</span><span class="sxs-lookup"><span data-stu-id="f2ef1-170">Launch and debug module code without container</span></span>
<span data-ttu-id="f2ef1-171">The IoT Edge C# module is a .Net Core application.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-171">The IoT Edge C# module is a .Net Core application.</span></span> <span data-ttu-id="f2ef1-172">And it depends on Azure IoT C# Device SDK.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-172">And it depends on Azure IoT C# Device SDK.</span></span> <span data-ttu-id="f2ef1-173">In the default module code, you initialize a **ModuleClient** with environment settings and input name, which means the IoT Edge C# module requires the environment settings to start and run, and you also need to send or route messages to the input channels.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-173">In the default module code, you initialize a **ModuleClient** with environment settings and input name, which means the IoT Edge C# module requires the environment settings to start and run, and you also need to send or route messages to the input channels.</span></span> <span data-ttu-id="f2ef1-174">Your default C# module only contains one input channel and the name is **input1**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-174">Your default C# module only contains one input channel and the name is **input1**.</span></span>

### <a name="setup-iot-edge-simulator-for-single-module-app"></a><span data-ttu-id="f2ef1-175">Setup IoT Edge simulator for single module app</span><span class="sxs-lookup"><span data-stu-id="f2ef1-175">Setup IoT Edge simulator for single module app</span></span>

1. <span data-ttu-id="f2ef1-176">To setup and start the simulator, in VS Code command palette, type and select **Azure IoT Edge: Start IoT Edge Hub Simulator for Single Module**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-176">To setup and start the simulator, in VS Code command palette, type and select **Azure IoT Edge: Start IoT Edge Hub Simulator for Single Module**.</span></span> <span data-ttu-id="f2ef1-177">You also need to specify the input names for your single module application, type **input1** and press Enter.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-177">You also need to specify the input names for your single module application, type **input1** and press Enter.</span></span> <span data-ttu-id="f2ef1-178">The command will trigger **iotedgehubdev** CLI and start IoT Edge simulator and a testing utility module container.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-178">The command will trigger **iotedgehubdev** CLI and start IoT Edge simulator and a testing utility module container.</span></span> <span data-ttu-id="f2ef1-179">You can see the outputs below in the integrated terminal if the simulator has been started in single module mode successfully.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-179">You can see the outputs below in the integrated terminal if the simulator has been started in single module mode successfully.</span></span> <span data-ttu-id="f2ef1-180">You can also see a `curl` command to help send message through.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-180">You can also see a `curl` command to help send message through.</span></span> <span data-ttu-id="f2ef1-181">You will use it later.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-181">You will use it later.</span></span>

   ![Setup IoT Edge simulator for single module app](media/how-to-develop-csharp-module/start-simulator-for-single-module.png)

   <span data-ttu-id="f2ef1-183">You can move to Docker Explorer and see the module running status.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-183">You can move to Docker Explorer and see the module running status.</span></span>

   ![Simulator module status](media/how-to-develop-csharp-module/simulator-status.png)

   <span data-ttu-id="f2ef1-185">The **edgeHubDev** container is the core of the local IoT Edge simulator.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-185">The **edgeHubDev** container is the core of the local IoT Edge simulator.</span></span> <span data-ttu-id="f2ef1-186">It can run on your development machine without IoT Edge security daemon and provide environment settings for your native module app or module containers.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-186">It can run on your development machine without IoT Edge security daemon and provide environment settings for your native module app or module containers.</span></span> <span data-ttu-id="f2ef1-187">The **input** container exposed restAPIs to help bridge messages to target input channel on your module.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-187">The **input** container exposed restAPIs to help bridge messages to target input channel on your module.</span></span>

2. <span data-ttu-id="f2ef1-188">In VS Code command palette, type and select **Azure IoT Edge: Set Module Credentials to User Settings** to set the module environment settings into `azure-iot-edge.EdgeHubConnectionString` and `azure-iot-edge.EdgeModuleCACertificateFile` in user settings.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-188">In VS Code command palette, type and select **Azure IoT Edge: Set Module Credentials to User Settings** to set the module environment settings into `azure-iot-edge.EdgeHubConnectionString` and `azure-iot-edge.EdgeModuleCACertificateFile` in user settings.</span></span> <span data-ttu-id="f2ef1-189">You can find these environment settings are referenced in **.vscode** > **launch.json** and [VS Code user settings](https://code.visualstudio.com/docs/getstarted/settings).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-189">You can find these environment settings are referenced in **.vscode** > **launch.json** and [VS Code user settings](https://code.visualstudio.com/docs/getstarted/settings).</span></span>

### <a name="build-module-app-and-debug-in-launch-mode"></a><span data-ttu-id="f2ef1-190">Build module app and debug in launch mode</span><span class="sxs-lookup"><span data-stu-id="f2ef1-190">Build module app and debug in launch mode</span></span>

1. <span data-ttu-id="f2ef1-191">In integrated terminal, change directory to **CSharpModule** folder, run the following command to build .Net Core application.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-191">In integrated terminal, change directory to **CSharpModule** folder, run the following command to build .Net Core application.</span></span>

    ```cmd
    dotnet build
    ```

2. <span data-ttu-id="f2ef1-192">Navigate to `program.cs`.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-192">Navigate to `program.cs`.</span></span> <span data-ttu-id="f2ef1-193">Add a breakpoint in this file.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-193">Add a breakpoint in this file.</span></span>

3. <span data-ttu-id="f2ef1-194">Navigate to VS Code debug view.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-194">Navigate to VS Code debug view.</span></span> <span data-ttu-id="f2ef1-195">Select the debug configuration **ModuleName Local Debug (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-195">Select the debug configuration **ModuleName Local Debug (.NET Core)**.</span></span> 

4. <span data-ttu-id="f2ef1-196">Click **Start Debugging** or press **F5**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-196">Click **Start Debugging** or press **F5**.</span></span> <span data-ttu-id="f2ef1-197">You will start the debug session.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-197">You will start the debug session.</span></span>

   > [!NOTE]
   > <span data-ttu-id="f2ef1-198">If your .Net Core `TargetFramework` is not consistent with your program path in `launch.json`.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-198">If your .Net Core `TargetFramework` is not consistent with your program path in `launch.json`.</span></span> <span data-ttu-id="f2ef1-199">You need to manually update the program path in `launch.json` to respect the `TargetFramework` in your .csproj file.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-199">You need to manually update the program path in `launch.json` to respect the `TargetFramework` in your .csproj file.</span></span> <span data-ttu-id="f2ef1-200">So that VS Code can successfully launch this program.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-200">So that VS Code can successfully launch this program.</span></span>

5. <span data-ttu-id="f2ef1-201">In VS Code integrated terminal, run the following command to send a **Hello World** message to your module.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-201">In VS Code integrated terminal, run the following command to send a **Hello World** message to your module.</span></span> <span data-ttu-id="f2ef1-202">This is the command showed in previous steps when setup IoT Edge simulator successfully.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-202">This is the command showed in previous steps when setup IoT Edge simulator successfully.</span></span>

    ```cmd
    curl --header "Content-Type: application/json" --request POST --data '{"inputName": "input1","data":"hello world"}' http://localhost:53000/api/v1/messages
    ```

   > [!NOTE]
   > <span data-ttu-id="f2ef1-203">If you are using Windows, making sure the shell of your VS Code integrated terminal is **Git Bash** or **WSL Bash**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-203">If you are using Windows, making sure the shell of your VS Code integrated terminal is **Git Bash** or **WSL Bash**.</span></span> <span data-ttu-id="f2ef1-204">You cannot run `curl` command in PowerShell or Command Prompt.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-204">You cannot run `curl` command in PowerShell or Command Prompt.</span></span> 
   
   > [!TIP]
   > <span data-ttu-id="f2ef1-205">You can also use [PostMan](https://www.getpostman.com/) or other API tools to send messages through instead of `curl`.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-205">You can also use [PostMan](https://www.getpostman.com/) or other API tools to send messages through instead of `curl`.</span></span>

6. <span data-ttu-id="f2ef1-206">In VS Code Debug view, you'll see the variables in the left panel.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-206">In VS Code Debug view, you'll see the variables in the left panel.</span></span> 

    ![Watch Variables](media/how-to-develop-csharp-module/single-module-variables.png)

7. <span data-ttu-id="f2ef1-208">To stop debugging session, click the Stop button or press **Shift + F5**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-208">To stop debugging session, click the Stop button or press **Shift + F5**.</span></span> <span data-ttu-id="f2ef1-209">And in VS Code command palette, type and select **Azure IoT Edge: Stop IoT Edge Simulator** stop and clean the simulator.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-209">And in VS Code command palette, type and select **Azure IoT Edge: Stop IoT Edge Simulator** stop and clean the simulator.</span></span>

## <a name="build-module-container-for-debugging-and-debug-in-attach-mode"></a><span data-ttu-id="f2ef1-210">Build module container for debugging and debug in attach mode</span><span class="sxs-lookup"><span data-stu-id="f2ef1-210">Build module container for debugging and debug in attach mode</span></span>

<span data-ttu-id="f2ef1-211">Your default solution contains two modules, one is a simulated temperature sensor module and the other is the C# pipe module.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-211">Your default solution contains two modules, one is a simulated temperature sensor module and the other is the C# pipe module.</span></span> <span data-ttu-id="f2ef1-212">The simulated temperature sensor keeps sending messages to C# pipe module, and then the messages are piped to IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-212">The simulated temperature sensor keeps sending messages to C# pipe module, and then the messages are piped to IoT Hub.</span></span> <span data-ttu-id="f2ef1-213">In the module folder you created, there are several Docker files for different container types.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-213">In the module folder you created, there are several Docker files for different container types.</span></span> <span data-ttu-id="f2ef1-214">Use any of these files that end with the extension **.debug** to build your module for testing.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-214">Use any of these files that end with the extension **.debug** to build your module for testing.</span></span> <span data-ttu-id="f2ef1-215">Currently, C# modules support debugging only in Linux amd64 containers in attach mode.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-215">Currently, C# modules support debugging only in Linux amd64 containers in attach mode.</span></span> 

### <a name="setup-iot-edge-simulator-for-iot-edge-solution"></a><span data-ttu-id="f2ef1-216">Setup IoT Edge simulator for IoT Edge solution</span><span class="sxs-lookup"><span data-stu-id="f2ef1-216">Setup IoT Edge simulator for IoT Edge solution</span></span>

<span data-ttu-id="f2ef1-217">In your development machine, you can start IoT Edge simulator instead of installing the IoT Edge security daemon to run your IoT Edge solution.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-217">In your development machine, you can start IoT Edge simulator instead of installing the IoT Edge security daemon to run your IoT Edge solution.</span></span> 

1. <span data-ttu-id="f2ef1-218">In device explorer on the left side, right-click on your IoT Edge device ID, select **Setup IoT Edge Simulator** to start the simulator with the device connection string.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-218">In device explorer on the left side, right-click on your IoT Edge device ID, select **Setup IoT Edge Simulator** to start the simulator with the device connection string.</span></span>

2. <span data-ttu-id="f2ef1-219">You can see the IoT Edge Simulator has been successfully setup in integrated terminal.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-219">You can see the IoT Edge Simulator has been successfully setup in integrated terminal.</span></span>

### <a name="build-and-run-container-for-debugging-and-debug-in-attach-mode"></a><span data-ttu-id="f2ef1-220">Build and run container for debugging and debug in attach mode</span><span class="sxs-lookup"><span data-stu-id="f2ef1-220">Build and run container for debugging and debug in attach mode</span></span>

1. <span data-ttu-id="f2ef1-221">In VS Code, navigate to the `deployment.template.json` file.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-221">In VS Code, navigate to the `deployment.template.json` file.</span></span> <span data-ttu-id="f2ef1-222">Update your C# module image URL by adding **.debug** to the end.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-222">Update your C# module image URL by adding **.debug** to the end.</span></span>

   ![Add **.debug** to your image name](./media/how-to-develop-csharp-module/image-debug.png)

2. <span data-ttu-id="f2ef1-224">Navigate to `program.cs`.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-224">Navigate to `program.cs`.</span></span> <span data-ttu-id="f2ef1-225">Add a breakpoint in this file.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-225">Add a breakpoint in this file.</span></span>
3. <span data-ttu-id="f2ef1-226">In the VS Code file explorer, select the `deployment.template.json` file for your solution, in the context-menu, click **Build and Run IoT Edge solution in Simulator**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-226">In the VS Code file explorer, select the `deployment.template.json` file for your solution, in the context-menu, click **Build and Run IoT Edge solution in Simulator**.</span></span> <span data-ttu-id="f2ef1-227">You can watch all the module container logs in the same window.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-227">You can watch all the module container logs in the same window.</span></span> <span data-ttu-id="f2ef1-228">You can also navigate to Docker Explorer to watch container status.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-228">You can also navigate to Docker Explorer to watch container status.</span></span>

   ![Watch Variables](media/how-to-develop-csharp-module/view-log.png)

5. <span data-ttu-id="f2ef1-230">Navigate to the VS Code debug view.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-230">Navigate to the VS Code debug view.</span></span> <span data-ttu-id="f2ef1-231">Select the debug configuration file for your module.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-231">Select the debug configuration file for your module.</span></span> <span data-ttu-id="f2ef1-232">The debug option name should be similar to **ModuleName Remote Debug (.NET Core)**</span><span class="sxs-lookup"><span data-stu-id="f2ef1-232">The debug option name should be similar to **ModuleName Remote Debug (.NET Core)**</span></span>

   ![Select Configuration](media/how-to-develop-csharp-module/debug-config.png)

6. <span data-ttu-id="f2ef1-234">Select **Start Debugging** or select **F5**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-234">Select **Start Debugging** or select **F5**.</span></span> <span data-ttu-id="f2ef1-235">Select the process to attach to.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-235">Select the process to attach to.</span></span>

7. <span data-ttu-id="f2ef1-236">In VS Code Debug view, you'll see the variables in the left panel.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-236">In VS Code Debug view, you'll see the variables in the left panel.</span></span>

8. <span data-ttu-id="f2ef1-237">To stop debugging session, click the Stop button or press **Shift + F5**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-237">To stop debugging session, click the Stop button or press **Shift + F5**.</span></span> <span data-ttu-id="f2ef1-238">And in VS Code command palette, type and select **Azure IoT Edge: Stop IoT Edge Simulator**.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-238">And in VS Code command palette, type and select **Azure IoT Edge: Stop IoT Edge Simulator**.</span></span>

> [!NOTE]
> <span data-ttu-id="f2ef1-239">This example shows how to debug .NET Core IoT Edge modules on containers.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-239">This example shows how to debug .NET Core IoT Edge modules on containers.</span></span> <span data-ttu-id="f2ef1-240">It's based on the debug version of `Dockerfile.debug`, which includes the .NET Core command-line debugger VSDBG in your container image while building it.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-240">It's based on the debug version of `Dockerfile.debug`, which includes the .NET Core command-line debugger VSDBG in your container image while building it.</span></span> <span data-ttu-id="f2ef1-241">After you debug your C# modules, we recommend that you directly use or customize `Dockerfile` without VSDBG for production-ready IoT Edge modules.</span><span class="sxs-lookup"><span data-stu-id="f2ef1-241">After you debug your C# modules, we recommend that you directly use or customize `Dockerfile` without VSDBG for production-ready IoT Edge modules.</span></span>

## <a name="next-steps"></a><span data-ttu-id="f2ef1-242">Next steps</span><span class="sxs-lookup"><span data-stu-id="f2ef1-242">Next steps</span></span>

<span data-ttu-id="f2ef1-243">After you've built your module, learn how to [deploy Azure IoT Edge modules from Visual Studio Code](how-to-deploy-modules-vscode.md).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-243">After you've built your module, learn how to [deploy Azure IoT Edge modules from Visual Studio Code](how-to-deploy-modules-vscode.md).</span></span>

<span data-ttu-id="f2ef1-244">To develop modules for your IoT Edge devices, [Understand and use Azure IoT Hub SDKs](../iot-hub/iot-hub-devguide-sdks.md).</span><span class="sxs-lookup"><span data-stu-id="f2ef1-244">To develop modules for your IoT Edge devices, [Understand and use Azure IoT Hub SDKs](../iot-hub/iot-hub-devguide-sdks.md).</span></span>
