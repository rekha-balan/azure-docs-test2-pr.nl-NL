---
title: Deploy modules for Azure IoT Edge | Microsoft Docs
description: Learn about how modules get deployed to edge devices
author: kgremban
manager: timlt
ms.author: kgremban
ms.date: 06/06/2018
ms.topic: conceptual
ms.service: iot-edge
services: iot-edge
ms.openlocfilehash: f64e6db576b7b1605cc070948a021184fc6ee8ad
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44870439"
---
# <a name="understand-iot-edge-deployments-for-single-devices-or-at-scale"></a><span data-ttu-id="14ed0-103">Understand IoT Edge deployments for single devices or at scale</span><span class="sxs-lookup"><span data-stu-id="14ed0-103">Understand IoT Edge deployments for single devices or at scale</span></span>

<span data-ttu-id="14ed0-104">Azure IoT Edge devices follow a [device lifecycle][lnk-lifecycle] that is similar to other types of IoT devices:</span><span class="sxs-lookup"><span data-stu-id="14ed0-104">Azure IoT Edge devices follow a [device lifecycle][lnk-lifecycle] that is similar to other types of IoT devices:</span></span>

1. <span data-ttu-id="14ed0-105">IoT Edge devices are provisioned, which involves imaging a device with an OS and installing the [IoT Edge runtime][lnk-runtime].</span><span class="sxs-lookup"><span data-stu-id="14ed0-105">IoT Edge devices are provisioned, which involves imaging a device with an OS and installing the [IoT Edge runtime][lnk-runtime].</span></span>
1. <span data-ttu-id="14ed0-106">The devices are configured to run [IoT Edge modules][lnk-modules], and then monitored for health.</span><span class="sxs-lookup"><span data-stu-id="14ed0-106">The devices are configured to run [IoT Edge modules][lnk-modules], and then monitored for health.</span></span> 
1. <span data-ttu-id="14ed0-107">Finally, devices may be retired when they are replaced or become obsolete.</span><span class="sxs-lookup"><span data-stu-id="14ed0-107">Finally, devices may be retired when they are replaced or become obsolete.</span></span>  

<span data-ttu-id="14ed0-108">Azure IoT Edge provides two ways to configure the modules to run on IoT Edge devices: one for development and fast iterations on a single device (you used this method in the Azure IoT Edge tutorials), and one for managing large fleets of IoT Edge devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-108">Azure IoT Edge provides two ways to configure the modules to run on IoT Edge devices: one for development and fast iterations on a single device (you used this method in the Azure IoT Edge tutorials), and one for managing large fleets of IoT Edge devices.</span></span> <span data-ttu-id="14ed0-109">Both of these approaches are available in the Azure portal and programmatically.</span><span class="sxs-lookup"><span data-stu-id="14ed0-109">Both of these approaches are available in the Azure portal and programmatically.</span></span>

<span data-ttu-id="14ed0-110">This article focuses on the configuration and monitoring stages for fleets of devices, collectively referred to as IoT Edge automatic deployments.</span><span class="sxs-lookup"><span data-stu-id="14ed0-110">This article focuses on the configuration and monitoring stages for fleets of devices, collectively referred to as IoT Edge automatic deployments.</span></span> <span data-ttu-id="14ed0-111">The overall deployment steps are as follows:</span><span class="sxs-lookup"><span data-stu-id="14ed0-111">The overall deployment steps are as follows:</span></span>   

1. <span data-ttu-id="14ed0-112">An operator defines a deployment that describes a set of modules as well as the target devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-112">An operator defines a deployment that describes a set of modules as well as the target devices.</span></span> <span data-ttu-id="14ed0-113">Each deployment has a deployment manifest that reflects this information.</span><span class="sxs-lookup"><span data-stu-id="14ed0-113">Each deployment has a deployment manifest that reflects this information.</span></span> 
1. <span data-ttu-id="14ed0-114">The IoT Hub service communicates with all targeted devices to configure them with the desired modules.</span><span class="sxs-lookup"><span data-stu-id="14ed0-114">The IoT Hub service communicates with all targeted devices to configure them with the desired modules.</span></span> 
1. <span data-ttu-id="14ed0-115">The IoT Hub service retrieves status from the IoT Edge devices and surfaces those for the operator to monitor.</span><span class="sxs-lookup"><span data-stu-id="14ed0-115">The IoT Hub service retrieves status from the IoT Edge devices and surfaces those for the operator to monitor.</span></span>  <span data-ttu-id="14ed0-116">For example, an operator can see when an Edge device is not configured successfully or if a module fails during runtime.</span><span class="sxs-lookup"><span data-stu-id="14ed0-116">For example, an operator can see when an Edge device is not configured successfully or if a module fails during runtime.</span></span> 
1. <span data-ttu-id="14ed0-117">At any time, new IoT Edge devices that meet the targeting conditions are configured for the deployment.</span><span class="sxs-lookup"><span data-stu-id="14ed0-117">At any time, new IoT Edge devices that meet the targeting conditions are configured for the deployment.</span></span> <span data-ttu-id="14ed0-118">For example, a deployment that targets all IoT Edge devices in Washington State automatically configures a new IoT Edge device once it is provisioned and added to the Washington State device group.</span><span class="sxs-lookup"><span data-stu-id="14ed0-118">For example, a deployment that targets all IoT Edge devices in Washington State automatically configures a new IoT Edge device once it is provisioned and added to the Washington State device group.</span></span> 
 
<span data-ttu-id="14ed0-119">This article describes each component involved in configuring and monitoring a deployment.</span><span class="sxs-lookup"><span data-stu-id="14ed0-119">This article describes each component involved in configuring and monitoring a deployment.</span></span> <span data-ttu-id="14ed0-120">For a walkthrough of creating and updating a deployment, see [Deploy and monitor IoT Edge modules at scale][lnk-howto].</span><span class="sxs-lookup"><span data-stu-id="14ed0-120">For a walkthrough of creating and updating a deployment, see [Deploy and monitor IoT Edge modules at scale][lnk-howto].</span></span>

## <a name="deployment"></a><span data-ttu-id="14ed0-121">Deployment</span><span class="sxs-lookup"><span data-stu-id="14ed0-121">Deployment</span></span>

<span data-ttu-id="14ed0-122">An IoT Edge automatic deployment assigns IoT Edge module images to run as instances on a targeted set of IoT Edge devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-122">An IoT Edge automatic deployment assigns IoT Edge module images to run as instances on a targeted set of IoT Edge devices.</span></span> <span data-ttu-id="14ed0-123">It works by configuring an IoT Edge deployment manifest to include a list of modules with the corresponding initialization parameters.</span><span class="sxs-lookup"><span data-stu-id="14ed0-123">It works by configuring an IoT Edge deployment manifest to include a list of modules with the corresponding initialization parameters.</span></span> <span data-ttu-id="14ed0-124">A deployment can be assigned to a single device (based on Device ID) or to a group of devices (based on tags).</span><span class="sxs-lookup"><span data-stu-id="14ed0-124">A deployment can be assigned to a single device (based on Device ID) or to a group of devices (based on tags).</span></span> <span data-ttu-id="14ed0-125">Once an IoT Edge device receives a deployment manifest, it downloads and installs the module container images from the respective container repositories, and configures them accordingly.</span><span class="sxs-lookup"><span data-stu-id="14ed0-125">Once an IoT Edge device receives a deployment manifest, it downloads and installs the module container images from the respective container repositories, and configures them accordingly.</span></span> <span data-ttu-id="14ed0-126">Once a deployment is created, an operator can monitor the deployment status to see whether targeted devices are correctly configured.</span><span class="sxs-lookup"><span data-stu-id="14ed0-126">Once a deployment is created, an operator can monitor the deployment status to see whether targeted devices are correctly configured.</span></span>   

<span data-ttu-id="14ed0-127">Devices need to be provisioned as IoT Edge devices to be configured with a deployment.</span><span class="sxs-lookup"><span data-stu-id="14ed0-127">Devices need to be provisioned as IoT Edge devices to be configured with a deployment.</span></span> <span data-ttu-id="14ed0-128">The following prerequisites must be on the device before it can receive the deployment:</span><span class="sxs-lookup"><span data-stu-id="14ed0-128">The following prerequisites must be on the device before it can receive the deployment:</span></span>
* <span data-ttu-id="14ed0-129">The base operating system</span><span class="sxs-lookup"><span data-stu-id="14ed0-129">The base operating system</span></span>
* <span data-ttu-id="14ed0-130">A container management system, like Moby or Docker</span><span class="sxs-lookup"><span data-stu-id="14ed0-130">A container management system, like Moby or Docker</span></span>
* <span data-ttu-id="14ed0-131">Provisioning of the IoT Edge runtime</span><span class="sxs-lookup"><span data-stu-id="14ed0-131">Provisioning of the IoT Edge runtime</span></span> 

### <a name="deployment-manifest"></a><span data-ttu-id="14ed0-132">Deployment manifest</span><span class="sxs-lookup"><span data-stu-id="14ed0-132">Deployment manifest</span></span>

<span data-ttu-id="14ed0-133">A deployment manifest is a JSON document that describes the modules to be configured on the targeted IoT Edge devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-133">A deployment manifest is a JSON document that describes the modules to be configured on the targeted IoT Edge devices.</span></span> <span data-ttu-id="14ed0-134">It contains the configuration metadata for all the modules, including the required system modules (specifically the IoT Edge agent and IoT Edge hub).</span><span class="sxs-lookup"><span data-stu-id="14ed0-134">It contains the configuration metadata for all the modules, including the required system modules (specifically the IoT Edge agent and IoT Edge hub).</span></span>  

<span data-ttu-id="14ed0-135">The configuration metadata for each module includes:</span><span class="sxs-lookup"><span data-stu-id="14ed0-135">The configuration metadata for each module includes:</span></span> 
* <span data-ttu-id="14ed0-136">Version</span><span class="sxs-lookup"><span data-stu-id="14ed0-136">Version</span></span> 
* <span data-ttu-id="14ed0-137">Type</span><span class="sxs-lookup"><span data-stu-id="14ed0-137">Type</span></span> 
* <span data-ttu-id="14ed0-138">Status (e.g. Running or Stopped)</span><span class="sxs-lookup"><span data-stu-id="14ed0-138">Status (e.g. Running or Stopped)</span></span> 
* <span data-ttu-id="14ed0-139">Re-start policy</span><span class="sxs-lookup"><span data-stu-id="14ed0-139">Re-start policy</span></span> 
* <span data-ttu-id="14ed0-140">Image and container registry</span><span class="sxs-lookup"><span data-stu-id="14ed0-140">Image and container registry</span></span>
* <span data-ttu-id="14ed0-141">Routes for data input and output</span><span class="sxs-lookup"><span data-stu-id="14ed0-141">Routes for data input and output</span></span> 

<span data-ttu-id="14ed0-142">If the module image is stored in a private container registry, the IoT Edge agent holds the registry credentials.</span><span class="sxs-lookup"><span data-stu-id="14ed0-142">If the module image is stored in a private container registry, the IoT Edge agent holds the registry credentials.</span></span> 

### <a name="target-condition"></a><span data-ttu-id="14ed0-143">Target condition</span><span class="sxs-lookup"><span data-stu-id="14ed0-143">Target condition</span></span>

<span data-ttu-id="14ed0-144">The target condition is continuously evaluated to include any new devices that meet the requirements or remove devices that no longer do through the life time of the deployment.</span><span class="sxs-lookup"><span data-stu-id="14ed0-144">The target condition is continuously evaluated to include any new devices that meet the requirements or remove devices that no longer do through the life time of the deployment.</span></span> <span data-ttu-id="14ed0-145">The deployment will be reactivated if the service detects any target condition change.</span><span class="sxs-lookup"><span data-stu-id="14ed0-145">The deployment will be reactivated if the service detects any target condition change.</span></span> 

<span data-ttu-id="14ed0-146">For instance, you have a deployment A with a target condition tags.environment = 'prod'.</span><span class="sxs-lookup"><span data-stu-id="14ed0-146">For instance, you have a deployment A with a target condition tags.environment = 'prod'.</span></span> <span data-ttu-id="14ed0-147">When you kick off the deployment, there are ten production devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-147">When you kick off the deployment, there are ten production devices.</span></span> <span data-ttu-id="14ed0-148">The modules are successfully installed in these ten devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-148">The modules are successfully installed in these ten devices.</span></span> <span data-ttu-id="14ed0-149">The IoT Edge Agent Status is shown as 10 total devices, 10 successful responses, 0 failure responses, and 0 pending responses.</span><span class="sxs-lookup"><span data-stu-id="14ed0-149">The IoT Edge Agent Status is shown as 10 total devices, 10 successful responses, 0 failure responses, and 0 pending responses.</span></span> <span data-ttu-id="14ed0-150">Now you add five more devices with tags.environment = 'prod'.</span><span class="sxs-lookup"><span data-stu-id="14ed0-150">Now you add five more devices with tags.environment = 'prod'.</span></span> <span data-ttu-id="14ed0-151">The service detects the change and the IoT Edge Agent Status becomes 15 total devices, 10 successful responses, 0 failure responses, and 5 pending responses when it tries to deploy to the five new devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-151">The service detects the change and the IoT Edge Agent Status becomes 15 total devices, 10 successful responses, 0 failure responses, and 5 pending responses when it tries to deploy to the five new devices.</span></span>

<span data-ttu-id="14ed0-152">Use any Boolean condition on device twins tags or deviceId to select the target devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-152">Use any Boolean condition on device twins tags or deviceId to select the target devices.</span></span> <span data-ttu-id="14ed0-153">If you want to use condition with tags, you need to add "tags":{} section in the device twin under the same level as properties.</span><span class="sxs-lookup"><span data-stu-id="14ed0-153">If you want to use condition with tags, you need to add "tags":{} section in the device twin under the same level as properties.</span></span> [<span data-ttu-id="14ed0-154">Learn more about tags in device twin</span><span class="sxs-lookup"><span data-stu-id="14ed0-154">Learn more about tags in device twin</span></span>](../iot-hub/iot-hub-devguide-device-twins.md)

<span data-ttu-id="14ed0-155">Target condition examples:</span><span class="sxs-lookup"><span data-stu-id="14ed0-155">Target condition examples:</span></span>
* <span data-ttu-id="14ed0-156">deviceId ='linuxprod1'</span><span class="sxs-lookup"><span data-stu-id="14ed0-156">deviceId ='linuxprod1'</span></span>
* <span data-ttu-id="14ed0-157">tags.environment ='prod'</span><span class="sxs-lookup"><span data-stu-id="14ed0-157">tags.environment ='prod'</span></span>
* <span data-ttu-id="14ed0-158">tags.environment = 'prod' AND tags.location = 'westus'</span><span class="sxs-lookup"><span data-stu-id="14ed0-158">tags.environment = 'prod' AND tags.location = 'westus'</span></span>
* <span data-ttu-id="14ed0-159">tags.environment = 'prod' OR tags.location = 'westus'</span><span class="sxs-lookup"><span data-stu-id="14ed0-159">tags.environment = 'prod' OR tags.location = 'westus'</span></span>
* <span data-ttu-id="14ed0-160">tags.operator = 'John' AND tags.environment = 'prod' NOT deviceId = 'linuxprod1'</span><span class="sxs-lookup"><span data-stu-id="14ed0-160">tags.operator = 'John' AND tags.environment = 'prod' NOT deviceId = 'linuxprod1'</span></span>

<span data-ttu-id="14ed0-161">Here are some constrains when you construct a target condition:</span><span class="sxs-lookup"><span data-stu-id="14ed0-161">Here are some constrains when you construct a target condition:</span></span>

* <span data-ttu-id="14ed0-162">In device twin, you can only build a target condition using tags or deviceId.</span><span class="sxs-lookup"><span data-stu-id="14ed0-162">In device twin, you can only build a target condition using tags or deviceId.</span></span>
* <span data-ttu-id="14ed0-163">Double quotes aren't allowed in any portion of the target condition.</span><span class="sxs-lookup"><span data-stu-id="14ed0-163">Double quotes aren't allowed in any portion of the target condition.</span></span> <span data-ttu-id="14ed0-164">Please use single quotes.</span><span class="sxs-lookup"><span data-stu-id="14ed0-164">Please use single quotes.</span></span>
* <span data-ttu-id="14ed0-165">Single quotes represent the values of the target condition.</span><span class="sxs-lookup"><span data-stu-id="14ed0-165">Single quotes represent the values of the target condition.</span></span> <span data-ttu-id="14ed0-166">Therefore, you must escape the single quote with another single quote if it's part of the device name.</span><span class="sxs-lookup"><span data-stu-id="14ed0-166">Therefore, you must escape the single quote with another single quote if it's part of the device name.</span></span> <span data-ttu-id="14ed0-167">For example, the target condition for: operator'sDevice would need to be written as deviceId='operator''sDevice'.</span><span class="sxs-lookup"><span data-stu-id="14ed0-167">For example, the target condition for: operator'sDevice would need to be written as deviceId='operator''sDevice'.</span></span>
* <span data-ttu-id="14ed0-168">Numbers, letters, and the following characters are allowed in target condition values: `-:.+%_#*?!(),=@;$`.</span><span class="sxs-lookup"><span data-stu-id="14ed0-168">Numbers, letters, and the following characters are allowed in target condition values: `-:.+%_#*?!(),=@;$`.</span></span>

### <a name="priority"></a><span data-ttu-id="14ed0-169">Priority</span><span class="sxs-lookup"><span data-stu-id="14ed0-169">Priority</span></span>

<span data-ttu-id="14ed0-170">A priority defines whether a deployment should be applied to a targeted device relative to other deployments.</span><span class="sxs-lookup"><span data-stu-id="14ed0-170">A priority defines whether a deployment should be applied to a targeted device relative to other deployments.</span></span> <span data-ttu-id="14ed0-171">A deployment priority is a positive integer, with larger numbers denoting higher priority.</span><span class="sxs-lookup"><span data-stu-id="14ed0-171">A deployment priority is a positive integer, with larger numbers denoting higher priority.</span></span> <span data-ttu-id="14ed0-172">If an IoT Edge device is targeted by more than one deployment, the deployment with the highest priority applies.</span><span class="sxs-lookup"><span data-stu-id="14ed0-172">If an IoT Edge device is targeted by more than one deployment, the deployment with the highest priority applies.</span></span>  <span data-ttu-id="14ed0-173">Deployments with lower priorities are not applied, nor are they merged.</span><span class="sxs-lookup"><span data-stu-id="14ed0-173">Deployments with lower priorities are not applied, nor are they merged.</span></span>  <span data-ttu-id="14ed0-174">If a device is targeted with two or more deployments with equal priority, the most recently created deployment (determined by the creation timestamp) applies.</span><span class="sxs-lookup"><span data-stu-id="14ed0-174">If a device is targeted with two or more deployments with equal priority, the most recently created deployment (determined by the creation timestamp) applies.</span></span>

### <a name="labels"></a><span data-ttu-id="14ed0-175">Labels</span><span class="sxs-lookup"><span data-stu-id="14ed0-175">Labels</span></span> 

<span data-ttu-id="14ed0-176">Labels are string key/value pairs that you can use to filter and group of deployments.</span><span class="sxs-lookup"><span data-stu-id="14ed0-176">Labels are string key/value pairs that you can use to filter and group of deployments.</span></span> <span data-ttu-id="14ed0-177">A deployment may have multiple labels.</span><span class="sxs-lookup"><span data-stu-id="14ed0-177">A deployment may have multiple labels.</span></span> <span data-ttu-id="14ed0-178">Labels are optional and do no impact the actual configuration of IoT Edge devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-178">Labels are optional and do no impact the actual configuration of IoT Edge devices.</span></span> 

### <a name="deployment-status"></a><span data-ttu-id="14ed0-179">Deployment status</span><span class="sxs-lookup"><span data-stu-id="14ed0-179">Deployment status</span></span>

<span data-ttu-id="14ed0-180">A deployment can be monitored to determine whether it applied successfully for any targeted IoT Edge device.</span><span class="sxs-lookup"><span data-stu-id="14ed0-180">A deployment can be monitored to determine whether it applied successfully for any targeted IoT Edge device.</span></span>  <span data-ttu-id="14ed0-181">A targeted Edge device will appear in one or more of the following status categories:</span><span class="sxs-lookup"><span data-stu-id="14ed0-181">A targeted Edge device will appear in one or more of the following status categories:</span></span> 
* <span data-ttu-id="14ed0-182">**Target** shows the IoT Edge devices that match the Deployment targeting condition.</span><span class="sxs-lookup"><span data-stu-id="14ed0-182">**Target** shows the IoT Edge devices that match the Deployment targeting condition.</span></span>
* <span data-ttu-id="14ed0-183">**Actual** shows the targeted IoT Edge devices that are not targeted by another deployment of higher priority.</span><span class="sxs-lookup"><span data-stu-id="14ed0-183">**Actual** shows the targeted IoT Edge devices that are not targeted by another deployment of higher priority.</span></span>
* <span data-ttu-id="14ed0-184">**Healthy** shows the IoT Edge devices that have reported back to the service that the modules have been deployed successfully.</span><span class="sxs-lookup"><span data-stu-id="14ed0-184">**Healthy** shows the IoT Edge devices that have reported back to the service that the modules have been deployed successfully.</span></span> 
* <span data-ttu-id="14ed0-185">**Unhealthy** shows the IoT Edge devices have reported back to the service that one or modules have not been deployed successfully.</span><span class="sxs-lookup"><span data-stu-id="14ed0-185">**Unhealthy** shows the IoT Edge devices have reported back to the service that one or modules have not been deployed successfully.</span></span> <span data-ttu-id="14ed0-186">To further investigate the error, connect remotely to that devices and view the log files.</span><span class="sxs-lookup"><span data-stu-id="14ed0-186">To further investigate the error, connect remotely to that devices and view the log files.</span></span>
* <span data-ttu-id="14ed0-187">**Unknown** shows the IoT Edge devices that did not report any status pertaining this deployment.</span><span class="sxs-lookup"><span data-stu-id="14ed0-187">**Unknown** shows the IoT Edge devices that did not report any status pertaining this deployment.</span></span> <span data-ttu-id="14ed0-188">To further investigate, view service info and log files.</span><span class="sxs-lookup"><span data-stu-id="14ed0-188">To further investigate, view service info and log files.</span></span>

## <a name="phased-rollout"></a><span data-ttu-id="14ed0-189">Phased rollout</span><span class="sxs-lookup"><span data-stu-id="14ed0-189">Phased rollout</span></span> 

<span data-ttu-id="14ed0-190">A phased rollout is an overall process whereby an operator deploys changes to a broadening set of IoT Edge devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-190">A phased rollout is an overall process whereby an operator deploys changes to a broadening set of IoT Edge devices.</span></span> <span data-ttu-id="14ed0-191">The goal is to make changes gradually to reduce the risk of making wide scale breaking changes.</span><span class="sxs-lookup"><span data-stu-id="14ed0-191">The goal is to make changes gradually to reduce the risk of making wide scale breaking changes.</span></span>  

<span data-ttu-id="14ed0-192">A phased rollout is executed in the following phases and steps:</span><span class="sxs-lookup"><span data-stu-id="14ed0-192">A phased rollout is executed in the following phases and steps:</span></span> 
1. <span data-ttu-id="14ed0-193">Establish a test environment of IoT Edge devices by provisioning them and setting a device twin tag like `tag.environment='test'`.</span><span class="sxs-lookup"><span data-stu-id="14ed0-193">Establish a test environment of IoT Edge devices by provisioning them and setting a device twin tag like `tag.environment='test'`.</span></span> <span data-ttu-id="14ed0-194">The test environment should mirror the production environment that the deployment will eventually target.</span><span class="sxs-lookup"><span data-stu-id="14ed0-194">The test environment should mirror the production environment that the deployment will eventually target.</span></span> 
1. <span data-ttu-id="14ed0-195">Create a deployment including the desired modules and configurations.</span><span class="sxs-lookup"><span data-stu-id="14ed0-195">Create a deployment including the desired modules and configurations.</span></span> <span data-ttu-id="14ed0-196">The targeting condition should target the test IoT Edge device environment.</span><span class="sxs-lookup"><span data-stu-id="14ed0-196">The targeting condition should target the test IoT Edge device environment.</span></span>   
1. <span data-ttu-id="14ed0-197">Validate the new module configuration in the test environment.</span><span class="sxs-lookup"><span data-stu-id="14ed0-197">Validate the new module configuration in the test environment.</span></span>
1. <span data-ttu-id="14ed0-198">Update the deployment to include a subset of production IoT Edge devices by adding a new tag to the targeting condition.</span><span class="sxs-lookup"><span data-stu-id="14ed0-198">Update the deployment to include a subset of production IoT Edge devices by adding a new tag to the targeting condition.</span></span> <span data-ttu-id="14ed0-199">Also, ensure that the priority for the deployment is higher than other deployments currently targeted to those devices</span><span class="sxs-lookup"><span data-stu-id="14ed0-199">Also, ensure that the priority for the deployment is higher than other deployments currently targeted to those devices</span></span> 
1. <span data-ttu-id="14ed0-200">Verify that the deployment succeeded on the targeted IoT Devices by viewing the deployment status.</span><span class="sxs-lookup"><span data-stu-id="14ed0-200">Verify that the deployment succeeded on the targeted IoT Devices by viewing the deployment status.</span></span>
1. <span data-ttu-id="14ed0-201">Update the deployment to target all remaining production IoT Edge devices.</span><span class="sxs-lookup"><span data-stu-id="14ed0-201">Update the deployment to target all remaining production IoT Edge devices.</span></span>

## <a name="rollback"></a><span data-ttu-id="14ed0-202">Rollback</span><span class="sxs-lookup"><span data-stu-id="14ed0-202">Rollback</span></span>

<span data-ttu-id="14ed0-203">Deployments can be rolled back in case of errors or misconfigurations.</span><span class="sxs-lookup"><span data-stu-id="14ed0-203">Deployments can be rolled back in case of errors or misconfigurations.</span></span>  <span data-ttu-id="14ed0-204">Because a deployment defines the absolute module configuration for an IoT Edge device, an additional deployment must also be targeted to the same device at a lower priority even if the goal is to remove all modules.</span><span class="sxs-lookup"><span data-stu-id="14ed0-204">Because a deployment defines the absolute module configuration for an IoT Edge device, an additional deployment must also be targeted to the same device at a lower priority even if the goal is to remove all modules.</span></span>  

<span data-ttu-id="14ed0-205">Perform rollbacks in the following sequence:</span><span class="sxs-lookup"><span data-stu-id="14ed0-205">Perform rollbacks in the following sequence:</span></span> 
1. <span data-ttu-id="14ed0-206">Confirm that a second deployment is also targeted at the same device set.</span><span class="sxs-lookup"><span data-stu-id="14ed0-206">Confirm that a second deployment is also targeted at the same device set.</span></span> <span data-ttu-id="14ed0-207">If the goal of the rollback is to remove all modules, the second deployment should not include any modules.</span><span class="sxs-lookup"><span data-stu-id="14ed0-207">If the goal of the rollback is to remove all modules, the second deployment should not include any modules.</span></span> 
1. <span data-ttu-id="14ed0-208">Modify or remove the target condition expression of the deployment you wish to roll back so that the devices no longer meet the targeting condition.</span><span class="sxs-lookup"><span data-stu-id="14ed0-208">Modify or remove the target condition expression of the deployment you wish to roll back so that the devices no longer meet the targeting condition.</span></span>
1. <span data-ttu-id="14ed0-209">Verify that the rollback succeeded by viewing the deployment status.</span><span class="sxs-lookup"><span data-stu-id="14ed0-209">Verify that the rollback succeeded by viewing the deployment status.</span></span>
   * <span data-ttu-id="14ed0-210">The rolled-back deployment should no longer show status for the devices that were rolled back.</span><span class="sxs-lookup"><span data-stu-id="14ed0-210">The rolled-back deployment should no longer show status for the devices that were rolled back.</span></span>
   * <span data-ttu-id="14ed0-211">The second deployment should now include deployment status for the devices that were rolled back.</span><span class="sxs-lookup"><span data-stu-id="14ed0-211">The second deployment should now include deployment status for the devices that were rolled back.</span></span>


## <a name="next-steps"></a><span data-ttu-id="14ed0-212">Next steps</span><span class="sxs-lookup"><span data-stu-id="14ed0-212">Next steps</span></span>

* <span data-ttu-id="14ed0-213">Walk through the steps to create, update, or delete a deployment in [Deploy and monitor IoT Edge modules at scale][lnk-howto].</span><span class="sxs-lookup"><span data-stu-id="14ed0-213">Walk through the steps to create, update, or delete a deployment in [Deploy and monitor IoT Edge modules at scale][lnk-howto].</span></span>
* <span data-ttu-id="14ed0-214">Learn more about other IoT Edge concepts like the [IoT Edge runtime][lnk-runtime] and [IoT Edge modules][lnk-modules].</span><span class="sxs-lookup"><span data-stu-id="14ed0-214">Learn more about other IoT Edge concepts like the [IoT Edge runtime][lnk-runtime] and [IoT Edge modules][lnk-modules].</span></span>

<!-- Links -->
[lnk-lifecycle]: ../iot-hub/iot-hub-device-management-overview.md
[lnk-runtime]: iot-edge-runtime.md
[lnk-modules]: iot-edge-modules.md
[lnk-howto]: how-to-deploy-monitor.md
