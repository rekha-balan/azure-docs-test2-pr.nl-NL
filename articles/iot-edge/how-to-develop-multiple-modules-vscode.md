---
title: Work with multiple Azure IoT Edge modules in VS Code | Microsoft Docs
description: Use the IoT extension for Visual Studio Code to develop multiple modules at once for Azure IoT Edge
services: iot-edge
keywords: ''
author: shizn
manager: timlt
ms.author: xshi
ms.date: 06/27/2018
ms.topic: conceptual
ms.service: iot-edge
ms.openlocfilehash: 31fe210b87a052438956d813db0d104e0f2cdb6e
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44855831"
---
# <a name="develop-an-iot-edge-solution-with-multiple-modules-in-visual-studio-code"></a><span data-ttu-id="a227a-103">Develop an IoT Edge solution with multiple modules in Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="a227a-103">Develop an IoT Edge solution with multiple modules in Visual Studio Code</span></span>

<span data-ttu-id="a227a-104">You can use Visual Studio Code to develop your Azure IoT Edge solution with multiple modules.</span><span class="sxs-lookup"><span data-stu-id="a227a-104">You can use Visual Studio Code to develop your Azure IoT Edge solution with multiple modules.</span></span> <span data-ttu-id="a227a-105">This article shows you how to create, update, and deploy an IoT Edge solution that pipes sensor data on a simulated IoT Edge device in VS Code.</span><span class="sxs-lookup"><span data-stu-id="a227a-105">This article shows you how to create, update, and deploy an IoT Edge solution that pipes sensor data on a simulated IoT Edge device in VS Code.</span></span> 

## <a name="prerequisites"></a><span data-ttu-id="a227a-106">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="a227a-106">Prerequisites</span></span>

<span data-ttu-id="a227a-107">To complete the steps in this article, have the following prerequisites in place:</span><span class="sxs-lookup"><span data-stu-id="a227a-107">To complete the steps in this article, have the following prerequisites in place:</span></span>

- [<span data-ttu-id="a227a-108">Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="a227a-108">Visual Studio Code</span></span>](https://code.visualstudio.com/)
- <span data-ttu-id="a227a-109">The [Azure IoT Edge extension for Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=vsciot-vscode.azure-iot-edge)</span><span class="sxs-lookup"><span data-stu-id="a227a-109">The [Azure IoT Edge extension for Visual Studio Code](https://marketplace.visualstudio.com/items?itemName=vsciot-vscode.azure-iot-edge)</span></span>
- <span data-ttu-id="a227a-110">The [C# for Visual Studio Code (powered by OmniSharp) extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp)</span><span class="sxs-lookup"><span data-stu-id="a227a-110">The [C# for Visual Studio Code (powered by OmniSharp) extension](https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp)</span></span>
- [<span data-ttu-id="a227a-111">Docker</span><span class="sxs-lookup"><span data-stu-id="a227a-111">Docker</span></span>](https://docs.docker.com/engine/installation/)
- <span data-ttu-id="a227a-112">The [.NET Core 2.1 SDK](https://www.microsoft.com/net/download)</span><span class="sxs-lookup"><span data-stu-id="a227a-112">The [.NET Core 2.1 SDK](https://www.microsoft.com/net/download)</span></span>
- <span data-ttu-id="a227a-113">An active IoT hub with at least one IoT Edge device</span><span class="sxs-lookup"><span data-stu-id="a227a-113">An active IoT hub with at least one IoT Edge device</span></span>

<span data-ttu-id="a227a-114">You also need [Docker for VS Code](https://marketplace.visualstudio.com/items?itemName=PeterJausovec.vscode-docker) with Azure IoT Hub Device Explorer integration to manage images and containers.</span><span class="sxs-lookup"><span data-stu-id="a227a-114">You also need [Docker for VS Code](https://marketplace.visualstudio.com/items?itemName=PeterJausovec.vscode-docker) with Azure IoT Hub Device Explorer integration to manage images and containers.</span></span>

## <a name="create-your-iot-edge-solution"></a><span data-ttu-id="a227a-115">Create your IoT Edge solution</span><span class="sxs-lookup"><span data-stu-id="a227a-115">Create your IoT Edge solution</span></span>

1. <span data-ttu-id="a227a-116">In Visual Studio code, open the integrated terminal by selecting **View** > **Integrated terminal**.</span><span class="sxs-lookup"><span data-stu-id="a227a-116">In Visual Studio code, open the integrated terminal by selecting **View** > **Integrated terminal**.</span></span> 

1. <span data-ttu-id="a227a-117">In the VS Code **Command Palette**, enter and run the command **Azure IoT Edge: New IoT Edge solution**.</span><span class="sxs-lookup"><span data-stu-id="a227a-117">In the VS Code **Command Palette**, enter and run the command **Azure IoT Edge: New IoT Edge solution**.</span></span> <span data-ttu-id="a227a-118">Select your workspace folder and provide the solution name (default is EdgeSolution).</span><span class="sxs-lookup"><span data-stu-id="a227a-118">Select your workspace folder and provide the solution name (default is EdgeSolution).</span></span> <span data-ttu-id="a227a-119">Create a C# module (with the name **PipeModule**) as the first user module in this solution.</span><span class="sxs-lookup"><span data-stu-id="a227a-119">Create a C# module (with the name **PipeModule**) as the first user module in this solution.</span></span> <span data-ttu-id="a227a-120">The default template of C# module is a pipe module, which directly pipes messages from upstream to downstream.</span><span class="sxs-lookup"><span data-stu-id="a227a-120">The default template of C# module is a pipe module, which directly pipes messages from upstream to downstream.</span></span> <span data-ttu-id="a227a-121">You also need to specify the Docker image repository for your first module.</span><span class="sxs-lookup"><span data-stu-id="a227a-121">You also need to specify the Docker image repository for your first module.</span></span> <span data-ttu-id="a227a-122">The default image repository is based on a local Docker registry (**localhost:5000/<first module name>**).</span><span class="sxs-lookup"><span data-stu-id="a227a-122">The default image repository is based on a local Docker registry (**localhost:5000/<first module name>**).</span></span> <span data-ttu-id="a227a-123">You can change it to Azure Container Registry or Docker Hub.</span><span class="sxs-lookup"><span data-stu-id="a227a-123">You can change it to Azure Container Registry or Docker Hub.</span></span> 

2. <span data-ttu-id="a227a-124">The VS Code window loads your IoT Edge solution workspace.</span><span class="sxs-lookup"><span data-stu-id="a227a-124">The VS Code window loads your IoT Edge solution workspace.</span></span> <span data-ttu-id="a227a-125">The root folder contains a **modules** folder, a **.vscode** folder, and a deployment manifest template file.</span><span class="sxs-lookup"><span data-stu-id="a227a-125">The root folder contains a **modules** folder, a **.vscode** folder, and a deployment manifest template file.</span></span> <span data-ttu-id="a227a-126">Debug configurations are located in the .vscode folder.</span><span class="sxs-lookup"><span data-stu-id="a227a-126">Debug configurations are located in the .vscode folder.</span></span> <span data-ttu-id="a227a-127">All of the user module codes are subfolders of the modules folder.</span><span class="sxs-lookup"><span data-stu-id="a227a-127">All of the user module codes are subfolders of the modules folder.</span></span> <span data-ttu-id="a227a-128">The deployment.template.json file is the deployment manifest template.</span><span class="sxs-lookup"><span data-stu-id="a227a-128">The deployment.template.json file is the deployment manifest template.</span></span> <span data-ttu-id="a227a-129">Some of the parameters in this file are parsed from the module.json file, which exists in every module folder.</span><span class="sxs-lookup"><span data-stu-id="a227a-129">Some of the parameters in this file are parsed from the module.json file, which exists in every module folder.</span></span>

3. <span data-ttu-id="a227a-130">Add your second module to this solution project.</span><span class="sxs-lookup"><span data-stu-id="a227a-130">Add your second module to this solution project.</span></span> <span data-ttu-id="a227a-131">There are several ways to add a new module to current solution.</span><span class="sxs-lookup"><span data-stu-id="a227a-131">There are several ways to add a new module to current solution.</span></span> <span data-ttu-id="a227a-132">Enter and run the command **Azure IoT Edge: Add IoT Edge module**.</span><span class="sxs-lookup"><span data-stu-id="a227a-132">Enter and run the command **Azure IoT Edge: Add IoT Edge module**.</span></span> <span data-ttu-id="a227a-133">Select the deployment template file to update.</span><span class="sxs-lookup"><span data-stu-id="a227a-133">Select the deployment template file to update.</span></span> <span data-ttu-id="a227a-134">Or right-click the modules folder or right-click the deployment.template.json file and select **Add IoT Edge Module**.</span><span class="sxs-lookup"><span data-stu-id="a227a-134">Or right-click the modules folder or right-click the deployment.template.json file and select **Add IoT Edge Module**.</span></span> <span data-ttu-id="a227a-135">Then there will be a dropdown list to select module type.</span><span class="sxs-lookup"><span data-stu-id="a227a-135">Then there will be a dropdown list to select module type.</span></span> <span data-ttu-id="a227a-136">Select an **Azure Functions - C#** module with the name **PipeFunction** and its Docker image repository.</span><span class="sxs-lookup"><span data-stu-id="a227a-136">Select an **Azure Functions - C#** module with the name **PipeFunction** and its Docker image repository.</span></span> <span data-ttu-id="a227a-137">The default template of C# functions module is a pipe module, which directly pipes messages from upstream to downstream.</span><span class="sxs-lookup"><span data-stu-id="a227a-137">The default template of C# functions module is a pipe module, which directly pipes messages from upstream to downstream.</span></span>

4. <span data-ttu-id="a227a-138">Open the deployment.template.json file.</span><span class="sxs-lookup"><span data-stu-id="a227a-138">Open the deployment.template.json file.</span></span> <span data-ttu-id="a227a-139">Verify that the file declares three modules and the runtime.</span><span class="sxs-lookup"><span data-stu-id="a227a-139">Verify that the file declares three modules and the runtime.</span></span> <span data-ttu-id="a227a-140">The message is generated from the tempSensor module.</span><span class="sxs-lookup"><span data-stu-id="a227a-140">The message is generated from the tempSensor module.</span></span> <span data-ttu-id="a227a-141">The message is directly piped via the SampleModule and SampleFunction modules and then sent to your IoT hub.</span><span class="sxs-lookup"><span data-stu-id="a227a-141">The message is directly piped via the SampleModule and SampleFunction modules and then sent to your IoT hub.</span></span> 

5. <span data-ttu-id="a227a-142">Update the routes for these modules with the following content:</span><span class="sxs-lookup"><span data-stu-id="a227a-142">Update the routes for these modules with the following content:</span></span>

   ```json
        "routes": {
          "SensorToPipeModule": "FROM /messages/modules/tempSensor/outputs/temperatureOutput INTO BrokeredEndpoint(\"/modules/PipeModule/inputs/input1\")",
          "PipeModuleToPipeFunction": "FROM /messages/modules/PipeModule/outputs/output1 INTO BrokeredEndpoint(\"/modules/PipeFunction/inputs/input1\")",
          "PipeFunctionToIoTHub": "FROM /messages/modules/PipeFunction/outputs/output1 INTO $upstream"
        },
   ```

5. <span data-ttu-id="a227a-143">Save this file.</span><span class="sxs-lookup"><span data-stu-id="a227a-143">Save this file.</span></span>

## <a name="build-and-deploy-your-iot-edge-solution"></a><span data-ttu-id="a227a-144">Build and deploy your IoT Edge solution</span><span class="sxs-lookup"><span data-stu-id="a227a-144">Build and deploy your IoT Edge solution</span></span>

1. <span data-ttu-id="a227a-145">In the VS Code **Command Palette**, enter and run the command **Azure IoT Edge: Build IoT Edge solution**.</span><span class="sxs-lookup"><span data-stu-id="a227a-145">In the VS Code **Command Palette**, enter and run the command **Azure IoT Edge: Build IoT Edge solution**.</span></span> <span data-ttu-id="a227a-146">Based on the module.json file in each module folder, the command starts to build, containerize, and push each module Docker image.</span><span class="sxs-lookup"><span data-stu-id="a227a-146">Based on the module.json file in each module folder, the command starts to build, containerize, and push each module Docker image.</span></span> <span data-ttu-id="a227a-147">The command then passes the required value to the deployment.template.json file and generates the deployment.json file with information from the config folder.</span><span class="sxs-lookup"><span data-stu-id="a227a-147">The command then passes the required value to the deployment.template.json file and generates the deployment.json file with information from the config folder.</span></span> <span data-ttu-id="a227a-148">The integrated terminal in VS Code shows the build progress.</span><span class="sxs-lookup"><span data-stu-id="a227a-148">The integrated terminal in VS Code shows the build progress.</span></span> 

2. <span data-ttu-id="a227a-149">In the Azure IoT Hub **Device Explorer**, right-click an IoT Edge device ID and then select the **Create deployment for Edge device** command.</span><span class="sxs-lookup"><span data-stu-id="a227a-149">In the Azure IoT Hub **Device Explorer**, right-click an IoT Edge device ID and then select the **Create deployment for Edge device** command.</span></span> <span data-ttu-id="a227a-150">Select the deployment.json file in the config folder.</span><span class="sxs-lookup"><span data-stu-id="a227a-150">Select the deployment.json file in the config folder.</span></span> <span data-ttu-id="a227a-151">The integrated terminal in VS Code shows the deployment successfully created with a deployment ID.</span><span class="sxs-lookup"><span data-stu-id="a227a-151">The integrated terminal in VS Code shows the deployment successfully created with a deployment ID.</span></span>

3. <span data-ttu-id="a227a-152">If you're simulating an IoT Edge device on your development machine, you can watch to see that all of the module image containers start within a few minutes.</span><span class="sxs-lookup"><span data-stu-id="a227a-152">If you're simulating an IoT Edge device on your development machine, you can watch to see that all of the module image containers start within a few minutes.</span></span>

## <a name="view-the-generated-data"></a><span data-ttu-id="a227a-153">View the generated data</span><span class="sxs-lookup"><span data-stu-id="a227a-153">View the generated data</span></span>

1. <span data-ttu-id="a227a-154">To monitor the data that arrives at the IoT hub, select **View** > **Command Palette**.</span><span class="sxs-lookup"><span data-stu-id="a227a-154">To monitor the data that arrives at the IoT hub, select **View** > **Command Palette**.</span></span> <span data-ttu-id="a227a-155">Then select the **IoT: Start monitoring D2C message** command.</span><span class="sxs-lookup"><span data-stu-id="a227a-155">Then select the **IoT: Start monitoring D2C message** command.</span></span> 
2. <span data-ttu-id="a227a-156">To stop monitoring the data, use the **IoT: Stop monitoring D2C message** command in the **Command Palette**.</span><span class="sxs-lookup"><span data-stu-id="a227a-156">To stop monitoring the data, use the **IoT: Stop monitoring D2C message** command in the **Command Palette**.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="a227a-157">Next steps</span><span class="sxs-lookup"><span data-stu-id="a227a-157">Next steps</span></span>

<span data-ttu-id="a227a-158">Learn about other scenarios for developing with Azure IoT Edge in Visual Studio Code:</span><span class="sxs-lookup"><span data-stu-id="a227a-158">Learn about other scenarios for developing with Azure IoT Edge in Visual Studio Code:</span></span>

* <span data-ttu-id="a227a-159">Develop modules in VS Code with [C#](how-to-develop-csharp-module.md) or [Node.js](how-to-develop-node-module.md).</span><span class="sxs-lookup"><span data-stu-id="a227a-159">Develop modules in VS Code with [C#](how-to-develop-csharp-module.md) or [Node.js](how-to-develop-node-module.md).</span></span>
* <span data-ttu-id="a227a-160">Develop Azure Functions in VS Code with [C#](how-to-develop-csharp-function.md).</span><span class="sxs-lookup"><span data-stu-id="a227a-160">Develop Azure Functions in VS Code with [C#](how-to-develop-csharp-function.md).</span></span>

<span data-ttu-id="a227a-161">To develop modules for your IoT Edge devices, [Understand and use Azure IoT Hub SDKs](../iot-hub/iot-hub-devguide-sdks.md).</span><span class="sxs-lookup"><span data-stu-id="a227a-161">To develop modules for your IoT Edge devices, [Understand and use Azure IoT Hub SDKs](../iot-hub/iot-hub-devguide-sdks.md).</span></span>