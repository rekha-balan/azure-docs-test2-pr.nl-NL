---
title: Define a SAML technical profile in a custom policy in Azure Active Directory B2C | Microsoft Docs
description: Define a SAML technical profile in a custom policy in Azure Active Directory B2C.
services: active-directory-b2c
author: davidmu1
manager: mtillman
ms.service: active-directory
ms.workload: identity
ms.topic: reference
ms.date: 09/10/2018
ms.author: davidmu
ms.component: B2C
ms.openlocfilehash: 6dcc1abdf06df2de951bb851c8b1abe93b71a69e
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44866839"
---
# <a name="define-a-saml-technical-profile-in-an-azure-active-directory-b2c-custom-policy"></a><span data-ttu-id="80540-103">Define a SAML technical profile in an Azure Active Directory B2C custom policy</span><span class="sxs-lookup"><span data-stu-id="80540-103">Define a SAML technical profile in an Azure Active Directory B2C custom policy</span></span>

[!INCLUDE [active-directory-b2c-advanced-audience-warning](../../includes/active-directory-b2c-advanced-audience-warning.md)]

<span data-ttu-id="80540-104">Azure Active Directory (Azure AD) B2C provides support for the SAML 2.0 identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-104">Azure Active Directory (Azure AD) B2C provides support for the SAML 2.0 identity provider.</span></span> <span data-ttu-id="80540-105">This article describes the specifics of a technical profile for interacting with a claims provider that supports this standardized protocol.</span><span class="sxs-lookup"><span data-stu-id="80540-105">This article describes the specifics of a technical profile for interacting with a claims provider that supports this standardized protocol.</span></span> <span data-ttu-id="80540-106">With SAML technical profile you can federate with a SAML based identity provider, such as AD-FS and Salesforce, allowing you users to sign-in with their existing social or enterprise identities.</span><span class="sxs-lookup"><span data-stu-id="80540-106">With SAML technical profile you can federate with a SAML based identity provider, such as AD-FS and Salesforce, allowing you users to sign-in with their existing social or enterprise identities.</span></span>

## <a name="metadata-exchange"></a><span data-ttu-id="80540-107">Metadata exchange</span><span class="sxs-lookup"><span data-stu-id="80540-107">Metadata exchange</span></span>

<span data-ttu-id="80540-108">Metadata is information used in the SAML protocol to expose the configuration of a SAML party, such as a service provider or identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-108">Metadata is information used in the SAML protocol to expose the configuration of a SAML party, such as a service provider or identity provider.</span></span> <span data-ttu-id="80540-109">Metadata defines the location of the services, such as sign-in and sign-out, certificates, sign-in method, and more.</span><span class="sxs-lookup"><span data-stu-id="80540-109">Metadata defines the location of the services, such as sign-in and sign-out, certificates, sign-in method, and more.</span></span> <span data-ttu-id="80540-110">The identity provider uses the metadata to know how to communicate with Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="80540-110">The identity provider uses the metadata to know how to communicate with Azure AD B2C.</span></span> <span data-ttu-id="80540-111">The metadata is configured in XML format and may be signed with a digital signature so that the other party can validate the integrity of the metadata.</span><span class="sxs-lookup"><span data-stu-id="80540-111">The metadata is configured in XML format and may be signed with a digital signature so that the other party can validate the integrity of the metadata.</span></span> <span data-ttu-id="80540-112">When Azure AD B2C federates with a SAML identity provider, it acts as a service provider initiating a SAML request and waiting for a SAML response.</span><span class="sxs-lookup"><span data-stu-id="80540-112">When Azure AD B2C federates with a SAML identity provider, it acts as a service provider initiating a SAML request and waiting for a SAML response.</span></span> <span data-ttu-id="80540-113">And, in some cases, excepts unsolicited SAML authentication, which is also known as identity provider initiated.</span><span class="sxs-lookup"><span data-stu-id="80540-113">And, in some cases, excepts unsolicited SAML authentication, which is also known as identity provider initiated.</span></span> 

<span data-ttu-id="80540-114">The metadata can be configured in both parties as "Static Metadata" or "Dynamic Metadata".</span><span class="sxs-lookup"><span data-stu-id="80540-114">The metadata can be configured in both parties as "Static Metadata" or "Dynamic Metadata".</span></span> <span data-ttu-id="80540-115">In static mode, you copy the entire metadata from one party and set it in the other party.</span><span class="sxs-lookup"><span data-stu-id="80540-115">In static mode, you copy the entire metadata from one party and set it in the other party.</span></span> <span data-ttu-id="80540-116">In dynamic mode, you set the URL to the metadata while the other party reads the configuration dynamically.</span><span class="sxs-lookup"><span data-stu-id="80540-116">In dynamic mode, you set the URL to the metadata while the other party reads the configuration dynamically.</span></span> <span data-ttu-id="80540-117">The principles are the same, you set the metadata of the Azure AD B2C technical profile in your identity provider and set the metadata of the identity provider in Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="80540-117">The principles are the same, you set the metadata of the Azure AD B2C technical profile in your identity provider and set the metadata of the identity provider in Azure AD B2C.</span></span>

<span data-ttu-id="80540-118">Each SAML identity provider has different steps to expose and set the service provider, in this case Azure AD B2C, and set the Azure AD B2C metadata in the identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-118">Each SAML identity provider has different steps to expose and set the service provider, in this case Azure AD B2C, and set the Azure AD B2C metadata in the identity provider.</span></span> <span data-ttu-id="80540-119">Look at your identity provider’s documentation for guidance on how to do so.</span><span class="sxs-lookup"><span data-stu-id="80540-119">Look at your identity provider’s documentation for guidance on how to do so.</span></span>

<span data-ttu-id="80540-120">The following example shows a URL address to the SAML metadata of an Azure AD B2C technical profile:</span><span class="sxs-lookup"><span data-stu-id="80540-120">The following example shows a URL address to the SAML metadata of an Azure AD B2C technical profile:</span></span>

```
https://login.microsoftonline.com/te/your-tenant/your-policy/samlp/metadata?idptp=your-technical-profile
```

<span data-ttu-id="80540-121">Replace the following values:</span><span class="sxs-lookup"><span data-stu-id="80540-121">Replace the following values:</span></span>

- <span data-ttu-id="80540-122">**your-tenant** with your tenant name, such as your-tenant.onmicrosoft.com</span><span class="sxs-lookup"><span data-stu-id="80540-122">**your-tenant** with your tenant name, such as your-tenant.onmicrosoft.com</span></span>
- <span data-ttu-id="80540-123">**your-policy** with your policy name.</span><span class="sxs-lookup"><span data-stu-id="80540-123">**your-policy** with your policy name.</span></span> <span data-ttu-id="80540-124">Use the policy where you configure the SAML provider technical profile, or a policy that inherits from that policy.</span><span class="sxs-lookup"><span data-stu-id="80540-124">Use the policy where you configure the SAML provider technical profile, or a policy that inherits from that policy.</span></span>
- <span data-ttu-id="80540-125">**your-technical-profile** with your SAML identity provider technical profile name</span><span class="sxs-lookup"><span data-stu-id="80540-125">**your-technical-profile** with your SAML identity provider technical profile name</span></span>

## <a name="digital-signing-certificates-exchange"></a><span data-ttu-id="80540-126">Digital signing certificates exchange</span><span class="sxs-lookup"><span data-stu-id="80540-126">Digital signing certificates exchange</span></span>

<span data-ttu-id="80540-127">To build a trust between Azure AD B2C and your SAML identity provider, you need to provide a valid X509 certificate with the private key.</span><span class="sxs-lookup"><span data-stu-id="80540-127">To build a trust between Azure AD B2C and your SAML identity provider, you need to provide a valid X509 certificate with the private key.</span></span> <span data-ttu-id="80540-128">You upload the certificate with the private key (.pfx file) to the Azure AD B2C policy key store.</span><span class="sxs-lookup"><span data-stu-id="80540-128">You upload the certificate with the private key (.pfx file) to the Azure AD B2C policy key store.</span></span> <span data-ttu-id="80540-129">Azure AD B2C digitally signs the SAML sign-in request using the certificate that you provide.</span><span class="sxs-lookup"><span data-stu-id="80540-129">Azure AD B2C digitally signs the SAML sign-in request using the certificate that you provide.</span></span> 

<span data-ttu-id="80540-130">The certificate is used in the following ways:</span><span class="sxs-lookup"><span data-stu-id="80540-130">The certificate is used in the following ways:</span></span>

- <span data-ttu-id="80540-131">Azure AD B2C generates and signs a SAML request, using the Azure AD B2C private key of the certificate.</span><span class="sxs-lookup"><span data-stu-id="80540-131">Azure AD B2C generates and signs a SAML request, using the Azure AD B2C private key of the certificate.</span></span> <span data-ttu-id="80540-132">The SAML request is sent to the identity provider, which validates the request using Azure AD B2C public key of the certificate.</span><span class="sxs-lookup"><span data-stu-id="80540-132">The SAML request is sent to the identity provider, which validates the request using Azure AD B2C public key of the certificate.</span></span> <span data-ttu-id="80540-133">The Azure AD B2C public certificate is accessible through technical profile metadata.</span><span class="sxs-lookup"><span data-stu-id="80540-133">The Azure AD B2C public certificate is accessible through technical profile metadata.</span></span> <span data-ttu-id="80540-134">Alternatively, you can manually upload the .cer file to your SAML identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-134">Alternatively, you can manually upload the .cer file to your SAML identity provider.</span></span>
- <span data-ttu-id="80540-135">The identity provider signs the data sent to Azure AD B2C using the identity provider's private key of the certificate.</span><span class="sxs-lookup"><span data-stu-id="80540-135">The identity provider signs the data sent to Azure AD B2C using the identity provider's private key of the certificate.</span></span> <span data-ttu-id="80540-136">Azure AD B2C validates the data using the identity provider's public certificate.</span><span class="sxs-lookup"><span data-stu-id="80540-136">Azure AD B2C validates the data using the identity provider's public certificate.</span></span> <span data-ttu-id="80540-137">Each identity provider has different steps for setup, look at your identity providers’s documentation for guidance on how to do so.</span><span class="sxs-lookup"><span data-stu-id="80540-137">Each identity provider has different steps for setup, look at your identity providers’s documentation for guidance on how to do so.</span></span> <span data-ttu-id="80540-138">In Azure AD B2C, your policy needs access to the certificate public key using the identity provider's metadata.</span><span class="sxs-lookup"><span data-stu-id="80540-138">In Azure AD B2C, your policy needs access to the certificate public key using the identity provider's metadata.</span></span>

<span data-ttu-id="80540-139">A self-signed certificate is acceptable for most scenarios.</span><span class="sxs-lookup"><span data-stu-id="80540-139">A self-signed certificate is acceptable for most scenarios.</span></span> <span data-ttu-id="80540-140">For production environments, it is recommended to use an X509 certificate that is issued by a certificate authority.</span><span class="sxs-lookup"><span data-stu-id="80540-140">For production environments, it is recommended to use an X509 certificate that is issued by a certificate authority.</span></span> <span data-ttu-id="80540-141">Also, as described later in this document, for a non-production environment you can disable the SAML signing on both sides.</span><span class="sxs-lookup"><span data-stu-id="80540-141">Also, as described later in this document, for a non-production environment you can disable the SAML signing on both sides.</span></span>

<span data-ttu-id="80540-142">The following diagram shows the metadata and certificate exchange:</span><span class="sxs-lookup"><span data-stu-id="80540-142">The following diagram shows the metadata and certificate exchange:</span></span>

![metadata and certificate exchange](media/saml-technical-profile/technical-profile-idp-saml-metadata.png)


## <a name="digital-encryption"></a><span data-ttu-id="80540-144">Digital encryption</span><span class="sxs-lookup"><span data-stu-id="80540-144">Digital encryption</span></span>

<span data-ttu-id="80540-145">To encrypt the SAML response assertion, the identity provider always uses a public key of an encryption certificate in an Azure AD B2C technical profile.</span><span class="sxs-lookup"><span data-stu-id="80540-145">To encrypt the SAML response assertion, the identity provider always uses a public key of an encryption certificate in an Azure AD B2C technical profile.</span></span> <span data-ttu-id="80540-146">When Azure AD B2C needs to decrypt the data, it uses the private portion of the encryption certificate.</span><span class="sxs-lookup"><span data-stu-id="80540-146">When Azure AD B2C needs to decrypt the data, it uses the private portion of the encryption certificate.</span></span>

<span data-ttu-id="80540-147">To encrypt the SAML response assertion:</span><span class="sxs-lookup"><span data-stu-id="80540-147">To encrypt the SAML response assertion:</span></span>

1. <span data-ttu-id="80540-148">Upload a valid X509 certificate with the private key (.pfx file) to the Azure AD B2C policy key store.</span><span class="sxs-lookup"><span data-stu-id="80540-148">Upload a valid X509 certificate with the private key (.pfx file) to the Azure AD B2C policy key store.</span></span>
2. <span data-ttu-id="80540-149">Add a **CryptographicKey** element with an identifier of `SamlAssertionDecryption` to the technical profile **CryptographicKeys** collection.</span><span class="sxs-lookup"><span data-stu-id="80540-149">Add a **CryptographicKey** element with an identifier of `SamlAssertionDecryption` to the technical profile **CryptographicKeys** collection.</span></span> <span data-ttu-id="80540-150">Set the **StorageReferenceId** to the name of the policy key you created in step 1.</span><span class="sxs-lookup"><span data-stu-id="80540-150">Set the **StorageReferenceId** to the name of the policy key you created in step 1.</span></span>
3. <span data-ttu-id="80540-151">Set the technical profile metadata **WantsEncryptedAssertions** to `true`.</span><span class="sxs-lookup"><span data-stu-id="80540-151">Set the technical profile metadata **WantsEncryptedAssertions** to `true`.</span></span>
4. <span data-ttu-id="80540-152">Update the identity provider with the new Azure AD B2C technical profile metadata.</span><span class="sxs-lookup"><span data-stu-id="80540-152">Update the identity provider with the new Azure AD B2C technical profile metadata.</span></span> <span data-ttu-id="80540-153">You should see the **KeyDescriptor** with the **use** property set to `encryption` containing the public key of your certificate.</span><span class="sxs-lookup"><span data-stu-id="80540-153">You should see the **KeyDescriptor** with the **use** property set to `encryption` containing the public key of your certificate.</span></span>

<span data-ttu-id="80540-154">The following example shows the Azure AD B2C technical profile encryption section of the metadata:</span><span class="sxs-lookup"><span data-stu-id="80540-154">The following example shows the Azure AD B2C technical profile encryption section of the metadata:</span></span>

```XML
<KeyDescriptor use="encryption">
  <KeyInfo xmlns="http://www.w3.org/2000/09/xmldsig#">
    <X509Data>
      <X509Certificate>valid certificate</X509Certificate>
    </X509Data>
  </KeyInfo>
</KeyDescriptor>
```

## <a name="identity-provider-initiated-flow"></a><span data-ttu-id="80540-155">Identity provider initiated flow</span><span class="sxs-lookup"><span data-stu-id="80540-155">Identity provider initiated flow</span></span>

<span data-ttu-id="80540-156">In a single sign-on session (unsolicited request) initiated by the IDP, an unsolicited SAML response is sent to the service provider, in this case, an Azure AD B2C technical profile.</span><span class="sxs-lookup"><span data-stu-id="80540-156">In a single sign-on session (unsolicited request) initiated by the IDP, an unsolicited SAML response is sent to the service provider, in this case, an Azure AD B2C technical profile.</span></span> <span data-ttu-id="80540-157">In this flow, the user does not go through the web application first, but is directed to the identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-157">In this flow, the user does not go through the web application first, but is directed to the identity provider.</span></span> <span data-ttu-id="80540-158">When the request is sent, an authentication page is provided to the user by the identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-158">When the request is sent, an authentication page is provided to the user by the identity provider.</span></span> <span data-ttu-id="80540-159">The user completes the sign-in and then the request is redirected to Azure AD B2C with a SAML response that contains the assertions.</span><span class="sxs-lookup"><span data-stu-id="80540-159">The user completes the sign-in and then the request is redirected to Azure AD B2C with a SAML response that contains the assertions.</span></span> <span data-ttu-id="80540-160">Azure AD B2C reads the assertions and issues a new SAML token and then redirects the user back to the relying party application.</span><span class="sxs-lookup"><span data-stu-id="80540-160">Azure AD B2C reads the assertions and issues a new SAML token and then redirects the user back to the relying party application.</span></span> <span data-ttu-id="80540-161">The redirections are done by the **AssertionConsumerService** element's **Location** property.</span><span class="sxs-lookup"><span data-stu-id="80540-161">The redirections are done by the **AssertionConsumerService** element's **Location** property.</span></span>


![SAML IDP initiated](media/saml-technical-profile/technical-profile-idp-saml-idp-initiated.png) 

<span data-ttu-id="80540-163">Consider the following policy requirements when creating an identity provider initiated flow:</span><span class="sxs-lookup"><span data-stu-id="80540-163">Consider the following policy requirements when creating an identity provider initiated flow:</span></span>

- <span data-ttu-id="80540-164">The first orchestration step needs to be a single claims exchange that points to a SAML technical profile.</span><span class="sxs-lookup"><span data-stu-id="80540-164">The first orchestration step needs to be a single claims exchange that points to a SAML technical profile.</span></span>
- <span data-ttu-id="80540-165">The technical profile needs to have a metadata item named **IdpInitiatedProfileEnabled** set to `true`.</span><span class="sxs-lookup"><span data-stu-id="80540-165">The technical profile needs to have a metadata item named **IdpInitiatedProfileEnabled** set to `true`.</span></span>
- <span data-ttu-id="80540-166">The relying party policy needs to be a SAML relying party.</span><span class="sxs-lookup"><span data-stu-id="80540-166">The relying party policy needs to be a SAML relying party.</span></span>
- <span data-ttu-id="80540-167">The relying party policy needs to have a metadata item named **IdpInitiatedProfileEnabled** set to `true`.</span><span class="sxs-lookup"><span data-stu-id="80540-167">The relying party policy needs to have a metadata item named **IdpInitiatedProfileEnabled** set to `true`.</span></span>
- <span data-ttu-id="80540-168">The unsolicited response needs to be sent to the `/your-tenant/your-policy/samlp/sso/assertionconsumer` endpoint.</span><span class="sxs-lookup"><span data-stu-id="80540-168">The unsolicited response needs to be sent to the `/your-tenant/your-policy/samlp/sso/assertionconsumer` endpoint.</span></span> <span data-ttu-id="80540-169">Any relay state included with the response is forwarded onto the relying party.</span><span class="sxs-lookup"><span data-stu-id="80540-169">Any relay state included with the response is forwarded onto the relying party.</span></span> <span data-ttu-id="80540-170">Replace the following values: **your-tenant** with your tenant name.</span><span class="sxs-lookup"><span data-stu-id="80540-170">Replace the following values: **your-tenant** with your tenant name.</span></span> <span data-ttu-id="80540-171">**your-policy** with your relying party policy name.</span><span class="sxs-lookup"><span data-stu-id="80540-171">**your-policy** with your relying party policy name.</span></span>
    
## <a name="protocol"></a><span data-ttu-id="80540-172">Protocol</span><span class="sxs-lookup"><span data-stu-id="80540-172">Protocol</span></span>

<span data-ttu-id="80540-173">The **Name** attribute of the Protocol element needs to be set to `SAML2`.</span><span class="sxs-lookup"><span data-stu-id="80540-173">The **Name** attribute of the Protocol element needs to be set to `SAML2`.</span></span> 

## <a name="metadata"></a><span data-ttu-id="80540-174">Metadata</span><span class="sxs-lookup"><span data-stu-id="80540-174">Metadata</span></span>

| <span data-ttu-id="80540-175">Attribute</span><span class="sxs-lookup"><span data-stu-id="80540-175">Attribute</span></span> | <span data-ttu-id="80540-176">Required</span><span class="sxs-lookup"><span data-stu-id="80540-176">Required</span></span> | <span data-ttu-id="80540-177">Description</span><span class="sxs-lookup"><span data-stu-id="80540-177">Description</span></span> |
| --------- | -------- | ----------- |
| <span data-ttu-id="80540-178">PartnerEntity</span><span class="sxs-lookup"><span data-stu-id="80540-178">PartnerEntity</span></span> | <span data-ttu-id="80540-179">Yes</span><span class="sxs-lookup"><span data-stu-id="80540-179">Yes</span></span> | <span data-ttu-id="80540-180">URL of the metadata of the SAML identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-180">URL of the metadata of the SAML identity provider.</span></span> <span data-ttu-id="80540-181">Copy the identity provider metadata and add it inside the CDATA element `<![CDATA[Your IDP metadata]]>`</span><span class="sxs-lookup"><span data-stu-id="80540-181">Copy the identity provider metadata and add it inside the CDATA element `<![CDATA[Your IDP metadata]]>`</span></span> |
| <span data-ttu-id="80540-182">IssuerUri</span><span class="sxs-lookup"><span data-stu-id="80540-182">IssuerUri</span></span> | <span data-ttu-id="80540-183">No</span><span class="sxs-lookup"><span data-stu-id="80540-183">No</span></span> | <span data-ttu-id="80540-184">Controls the value of **entityID** of the **EntityDescriptor** element in the metadata of the Azure AD B2C technical profile.</span><span class="sxs-lookup"><span data-stu-id="80540-184">Controls the value of **entityID** of the **EntityDescriptor** element in the metadata of the Azure AD B2C technical profile.</span></span> <span data-ttu-id="80540-185">The **entityID** attribute is the unique identifier of the service provider, in this case, the Azure AD B2C technical profile.</span><span class="sxs-lookup"><span data-stu-id="80540-185">The **entityID** attribute is the unique identifier of the service provider, in this case, the Azure AD B2C technical profile.</span></span> <span data-ttu-id="80540-186">The default value of the **entityID** is `https://login.microsoftonline.com/te/your-tenant.onmicrosoft.com/your-base-policy-name`</span><span class="sxs-lookup"><span data-stu-id="80540-186">The default value of the **entityID** is `https://login.microsoftonline.com/te/your-tenant.onmicrosoft.com/your-base-policy-name`</span></span> |
| <span data-ttu-id="80540-187">WantsSignedRequests</span><span class="sxs-lookup"><span data-stu-id="80540-187">WantsSignedRequests</span></span> | <span data-ttu-id="80540-188">No</span><span class="sxs-lookup"><span data-stu-id="80540-188">No</span></span> | <span data-ttu-id="80540-189">Indicates whether the technical profile requires all of the outgoing authentication requests to be signed.</span><span class="sxs-lookup"><span data-stu-id="80540-189">Indicates whether the technical profile requires all of the outgoing authentication requests to be signed.</span></span> <span data-ttu-id="80540-190">Possible values: `true` or `false`.</span><span class="sxs-lookup"><span data-stu-id="80540-190">Possible values: `true` or `false`.</span></span> <span data-ttu-id="80540-191">The default value is `true`.</span><span class="sxs-lookup"><span data-stu-id="80540-191">The default value is `true`.</span></span> <span data-ttu-id="80540-192">When the value is set to `true`, the **SamlMessageSigning** cryptographic key needs to be specified and all of the outgoing authentication requests are signed.</span><span class="sxs-lookup"><span data-stu-id="80540-192">When the value is set to `true`, the **SamlMessageSigning** cryptographic key needs to be specified and all of the outgoing authentication requests are signed.</span></span> <span data-ttu-id="80540-193">If the value is set to `false`, the **SigAlg** and **Signature** parameters (query string or post parameter) are omitted from the request.</span><span class="sxs-lookup"><span data-stu-id="80540-193">If the value is set to `false`, the **SigAlg** and **Signature** parameters (query string or post parameter) are omitted from the request.</span></span> <span data-ttu-id="80540-194">This metadata also controls the metadata **AuthnRequestsSigned** attribute, which is output in the metadata of the Azure AD B2C technical profile that is shared with the identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-194">This metadata also controls the metadata **AuthnRequestsSigned** attribute, which is output in the metadata of the Azure AD B2C technical profile that is shared with the identity provider.</span></span> |
| <span data-ttu-id="80540-195">XmlSignatureAlgorithm</span><span class="sxs-lookup"><span data-stu-id="80540-195">XmlSignatureAlgorithm</span></span> | <span data-ttu-id="80540-196">No</span><span class="sxs-lookup"><span data-stu-id="80540-196">No</span></span> | <span data-ttu-id="80540-197">The method that Azure AD B2C uses to sign the SAML request.</span><span class="sxs-lookup"><span data-stu-id="80540-197">The method that Azure AD B2C uses to sign the SAML request.</span></span> <span data-ttu-id="80540-198">This metadata controls the value of the  **SigAlg** parameter (query string or post parameter) in the SAML request.</span><span class="sxs-lookup"><span data-stu-id="80540-198">This metadata controls the value of the  **SigAlg** parameter (query string or post parameter) in the SAML request.</span></span> <span data-ttu-id="80540-199">Possible values: `Sha256`, `Sha384`, `Sha512`, or `Sha1`.</span><span class="sxs-lookup"><span data-stu-id="80540-199">Possible values: `Sha256`, `Sha384`, `Sha512`, or `Sha1`.</span></span> <span data-ttu-id="80540-200">Make sure you configure the signature algorithm on both sides with same value.</span><span class="sxs-lookup"><span data-stu-id="80540-200">Make sure you configure the signature algorithm on both sides with same value.</span></span> <span data-ttu-id="80540-201">Use only the algorithm that your certificate supports.</span><span class="sxs-lookup"><span data-stu-id="80540-201">Use only the algorithm that your certificate supports.</span></span> | 
| <span data-ttu-id="80540-202">WantsSignedAssertions</span><span class="sxs-lookup"><span data-stu-id="80540-202">WantsSignedAssertions</span></span> | <span data-ttu-id="80540-203">No</span><span class="sxs-lookup"><span data-stu-id="80540-203">No</span></span> | <span data-ttu-id="80540-204">Indicates whether the technical profile requires all incoming assertions to be signed.</span><span class="sxs-lookup"><span data-stu-id="80540-204">Indicates whether the technical profile requires all incoming assertions to be signed.</span></span> <span data-ttu-id="80540-205">Possible values: `true` or `false`.</span><span class="sxs-lookup"><span data-stu-id="80540-205">Possible values: `true` or `false`.</span></span> <span data-ttu-id="80540-206">The default value is `true`.</span><span class="sxs-lookup"><span data-stu-id="80540-206">The default value is `true`.</span></span> <span data-ttu-id="80540-207">If the value is set to `true`, all assertions section `saml:Assertion` sent by the identity provider to Azure AD B2C must be signed.</span><span class="sxs-lookup"><span data-stu-id="80540-207">If the value is set to `true`, all assertions section `saml:Assertion` sent by the identity provider to Azure AD B2C must be signed.</span></span> <span data-ttu-id="80540-208">If the value is set to `false`,  the identity provider shouldn’t sign the assertions, but even if it does, Azure AD B2C won’t validate the signature.</span><span class="sxs-lookup"><span data-stu-id="80540-208">If the value is set to `false`,  the identity provider shouldn’t sign the assertions, but even if it does, Azure AD B2C won’t validate the signature.</span></span> <span data-ttu-id="80540-209">This metadata also controls the metadata flag **WantsAssertionsSigned**, which is output in the metadata of the Azure AD B2C technical profile that is shared with the identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-209">This metadata also controls the metadata flag **WantsAssertionsSigned**, which is output in the metadata of the Azure AD B2C technical profile that is shared with the identity provider.</span></span> <span data-ttu-id="80540-210">If you disable the assertions validation, you also may want to disable the response signature validation (for more information, see **ResponsesSigned**).</span><span class="sxs-lookup"><span data-stu-id="80540-210">If you disable the assertions validation, you also may want to disable the response signature validation (for more information, see **ResponsesSigned**).</span></span> |
| <span data-ttu-id="80540-211">ResponsesSigned</span><span class="sxs-lookup"><span data-stu-id="80540-211">ResponsesSigned</span></span> | <span data-ttu-id="80540-212">No</span><span class="sxs-lookup"><span data-stu-id="80540-212">No</span></span> | <span data-ttu-id="80540-213">Possible values: `true` or `false`.</span><span class="sxs-lookup"><span data-stu-id="80540-213">Possible values: `true` or `false`.</span></span> <span data-ttu-id="80540-214">The default value is `true`.</span><span class="sxs-lookup"><span data-stu-id="80540-214">The default value is `true`.</span></span> <span data-ttu-id="80540-215">If the value is set to `false`, the identity provider shouldn’t sign the SAML response, but even if it does, Azure AD B2C won’t validate the signature.</span><span class="sxs-lookup"><span data-stu-id="80540-215">If the value is set to `false`, the identity provider shouldn’t sign the SAML response, but even if it does, Azure AD B2C won’t validate the signature.</span></span> <span data-ttu-id="80540-216">If the value is set to `true`, the SAML response sent by the identity provider to Azure AD B2C is signed and must be validated.</span><span class="sxs-lookup"><span data-stu-id="80540-216">If the value is set to `true`, the SAML response sent by the identity provider to Azure AD B2C is signed and must be validated.</span></span> <span data-ttu-id="80540-217">If you disable the SAML response validation, you also may want to disable the assertion signature validation (for more information, see **WantsSignedAssertions**).</span><span class="sxs-lookup"><span data-stu-id="80540-217">If you disable the SAML response validation, you also may want to disable the assertion signature validation (for more information, see **WantsSignedAssertions**).</span></span> |
| <span data-ttu-id="80540-218">WantsEncryptedAssertions</span><span class="sxs-lookup"><span data-stu-id="80540-218">WantsEncryptedAssertions</span></span> | <span data-ttu-id="80540-219">No</span><span class="sxs-lookup"><span data-stu-id="80540-219">No</span></span> | <span data-ttu-id="80540-220">Indicates whether the technical profile requires all incoming assertions to be encrypted.</span><span class="sxs-lookup"><span data-stu-id="80540-220">Indicates whether the technical profile requires all incoming assertions to be encrypted.</span></span> <span data-ttu-id="80540-221">Possible values: `true` or `false`.</span><span class="sxs-lookup"><span data-stu-id="80540-221">Possible values: `true` or `false`.</span></span> <span data-ttu-id="80540-222">The default value is `false`.</span><span class="sxs-lookup"><span data-stu-id="80540-222">The default value is `false`.</span></span> <span data-ttu-id="80540-223">If the value is set to `true`, assertions sent by the identity provider to Azure AD B2C must be signed and the **SamlAssertionDecryption** cryptographic key needs to be specified.</span><span class="sxs-lookup"><span data-stu-id="80540-223">If the value is set to `true`, assertions sent by the identity provider to Azure AD B2C must be signed and the **SamlAssertionDecryption** cryptographic key needs to be specified.</span></span> <span data-ttu-id="80540-224">If the value is set to `true`, the metadata of the Azure AD B2C technical profile includes the **encryption** section.</span><span class="sxs-lookup"><span data-stu-id="80540-224">If the value is set to `true`, the metadata of the Azure AD B2C technical profile includes the **encryption** section.</span></span> <span data-ttu-id="80540-225">The identity provider reads the metadata and encrypts the SAML response assertion with the public key that is provided in the metadata of the Azure AD B2C technical profile.</span><span class="sxs-lookup"><span data-stu-id="80540-225">The identity provider reads the metadata and encrypts the SAML response assertion with the public key that is provided in the metadata of the Azure AD B2C technical profile.</span></span> <span data-ttu-id="80540-226">If you enable the assertions encryption, you also may need to disable the response signature validation (for more information, see **ResponsesSigned**).</span><span class="sxs-lookup"><span data-stu-id="80540-226">If you enable the assertions encryption, you also may need to disable the response signature validation (for more information, see **ResponsesSigned**).</span></span> | 
| <span data-ttu-id="80540-227">IdpInitiatedProfileEnabled</span><span class="sxs-lookup"><span data-stu-id="80540-227">IdpInitiatedProfileEnabled</span></span> | <span data-ttu-id="80540-228">No</span><span class="sxs-lookup"><span data-stu-id="80540-228">No</span></span> |<span data-ttu-id="80540-229">Indicates whether a single sign-on session profile is enabled that was initiated by a SAML identity provider profile.</span><span class="sxs-lookup"><span data-stu-id="80540-229">Indicates whether a single sign-on session profile is enabled that was initiated by a SAML identity provider profile.</span></span> <span data-ttu-id="80540-230">Possible values: `true` or `false`.</span><span class="sxs-lookup"><span data-stu-id="80540-230">Possible values: `true` or `false`.</span></span> <span data-ttu-id="80540-231">The default is `false`.</span><span class="sxs-lookup"><span data-stu-id="80540-231">The default is `false`.</span></span> <span data-ttu-id="80540-232">In the flow initiated by the identity provider, the user is authenticated externally and an unsolicited response is sent to Azure AD B2C, which then consumes the token, executes orchestration steps, and then sends a response to the relying party application.</span><span class="sxs-lookup"><span data-stu-id="80540-232">In the flow initiated by the identity provider, the user is authenticated externally and an unsolicited response is sent to Azure AD B2C, which then consumes the token, executes orchestration steps, and then sends a response to the relying party application.</span></span> |

## <a name="cryptographic-keys"></a><span data-ttu-id="80540-233">Cryptographic keys</span><span class="sxs-lookup"><span data-stu-id="80540-233">Cryptographic keys</span></span>

<span data-ttu-id="80540-234">The **CryptographicKeys** element contains the following attributes:</span><span class="sxs-lookup"><span data-stu-id="80540-234">The **CryptographicKeys** element contains the following attributes:</span></span>

| <span data-ttu-id="80540-235">Attribute</span><span class="sxs-lookup"><span data-stu-id="80540-235">Attribute</span></span> |<span data-ttu-id="80540-236">Required</span><span class="sxs-lookup"><span data-stu-id="80540-236">Required</span></span> | <span data-ttu-id="80540-237">Description</span><span class="sxs-lookup"><span data-stu-id="80540-237">Description</span></span> |
| --------- | ----------- | ----------- |
| <span data-ttu-id="80540-238">SamlMessageSigning</span><span class="sxs-lookup"><span data-stu-id="80540-238">SamlMessageSigning</span></span> |<span data-ttu-id="80540-239">Yes</span><span class="sxs-lookup"><span data-stu-id="80540-239">Yes</span></span> | <span data-ttu-id="80540-240">The X509 certificate (RSA key set) to use to sign SAML messages.</span><span class="sxs-lookup"><span data-stu-id="80540-240">The X509 certificate (RSA key set) to use to sign SAML messages.</span></span> <span data-ttu-id="80540-241">Azure AD B2C uses this key to sign the requests and send them to the identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-241">Azure AD B2C uses this key to sign the requests and send them to the identity provider.</span></span> |
| <span data-ttu-id="80540-242">SamlAssertionDecryption</span><span class="sxs-lookup"><span data-stu-id="80540-242">SamlAssertionDecryption</span></span> |<span data-ttu-id="80540-243">Yes</span><span class="sxs-lookup"><span data-stu-id="80540-243">Yes</span></span> | <span data-ttu-id="80540-244">The X509 certificate (RSA key set) to use to decrypt SAML messages.</span><span class="sxs-lookup"><span data-stu-id="80540-244">The X509 certificate (RSA key set) to use to decrypt SAML messages.</span></span> <span data-ttu-id="80540-245">This certificate should be provided by the identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-245">This certificate should be provided by the identity provider.</span></span> <span data-ttu-id="80540-246">Azure AD B2C uses this certificate to decrypt the data sent by the identity provider.</span><span class="sxs-lookup"><span data-stu-id="80540-246">Azure AD B2C uses this certificate to decrypt the data sent by the identity provider.</span></span> |
| <span data-ttu-id="80540-247">MetadataSigning</span><span class="sxs-lookup"><span data-stu-id="80540-247">MetadataSigning</span></span> |<span data-ttu-id="80540-248">No</span><span class="sxs-lookup"><span data-stu-id="80540-248">No</span></span> | <span data-ttu-id="80540-249">The X509 certificate (RSA key set) to use to sign SAML metadata.</span><span class="sxs-lookup"><span data-stu-id="80540-249">The X509 certificate (RSA key set) to use to sign SAML metadata.</span></span> <span data-ttu-id="80540-250">Azure AD B2C uses this key to sign the metadata.</span><span class="sxs-lookup"><span data-stu-id="80540-250">Azure AD B2C uses this key to sign the metadata.</span></span>  |

## <a name="examples"></a><span data-ttu-id="80540-251">Examples</span><span class="sxs-lookup"><span data-stu-id="80540-251">Examples</span></span>

- [<span data-ttu-id="80540-252">Add ADFS as a SAML identity provider using custom policies</span><span class="sxs-lookup"><span data-stu-id="80540-252">Add ADFS as a SAML identity provider using custom policies</span></span>](active-directory-b2c-custom-setup-adfs2016-idp.md)
- [<span data-ttu-id="80540-253">Sign in by using Salesforce accounts via SAML</span><span class="sxs-lookup"><span data-stu-id="80540-253">Sign in by using Salesforce accounts via SAML</span></span>](active-directory-b2c-setup-sf-app-custom.md)













