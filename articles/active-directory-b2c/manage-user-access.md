---
title: Manage user access in Azure Active Directory B2C | Microsoft Docs
description: Learn how to identify minors, collect date of birth and country data, and get acceptance of terms of use in your application by using Azure AD B2C.
services: active-directory-b2c
author: davidmu1
manager: mtillman
ms.service: active-directory
ms.workload: identity
ms.topic: conceptual
ms.date: 07/24/2018
ms.author: davidmu
ms.component: B2C
ms.openlocfilehash: 6709fb8ae328f749b367c58f95b8a9ef8da9bc65
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44857834"
---
# <a name="manage-user-access-in-azure-active-directory-b2c"></a><span data-ttu-id="ca734-103">Manage user access in Azure Active Directory B2C</span><span class="sxs-lookup"><span data-stu-id="ca734-103">Manage user access in Azure Active Directory B2C</span></span>

<span data-ttu-id="ca734-104">This article discusses how to manage user access to your applications by using Azure Active Directory (Azure AD) B2C.</span><span class="sxs-lookup"><span data-stu-id="ca734-104">This article discusses how to manage user access to your applications by using Azure Active Directory (Azure AD) B2C.</span></span> <span data-ttu-id="ca734-105">Access management in your application includes:</span><span class="sxs-lookup"><span data-stu-id="ca734-105">Access management in your application includes:</span></span>

- <span data-ttu-id="ca734-106">Identifying minors and controlling user access to your application.</span><span class="sxs-lookup"><span data-stu-id="ca734-106">Identifying minors and controlling user access to your application.</span></span>
- <span data-ttu-id="ca734-107">Requiring parental consent for minors to use your applications.</span><span class="sxs-lookup"><span data-stu-id="ca734-107">Requiring parental consent for minors to use your applications.</span></span>
- <span data-ttu-id="ca734-108">Gathering birth and country data from users.</span><span class="sxs-lookup"><span data-stu-id="ca734-108">Gathering birth and country data from users.</span></span>
- <span data-ttu-id="ca734-109">Capturing a terms-of-use agreement and gating access.</span><span class="sxs-lookup"><span data-stu-id="ca734-109">Capturing a terms-of-use agreement and gating access.</span></span>

[!INCLUDE [active-directory-b2c-advanced-audience-warning](../../includes/active-directory-b2c-advanced-audience-warning.md)]

## <a name="control-minor-access"></a><span data-ttu-id="ca734-110">Control minor access</span><span class="sxs-lookup"><span data-stu-id="ca734-110">Control minor access</span></span>

<span data-ttu-id="ca734-111">Applications and organizations may decide to block minors from using applications and services that are not targeted to this audience.</span><span class="sxs-lookup"><span data-stu-id="ca734-111">Applications and organizations may decide to block minors from using applications and services that are not targeted to this audience.</span></span> <span data-ttu-id="ca734-112">Alternatively, applications and organizations may decide to accept minors and subsequently manage the parental consent, and deliver permissible experiences for minors as dictated by business rules and allowed by regulation.</span><span class="sxs-lookup"><span data-stu-id="ca734-112">Alternatively, applications and organizations may decide to accept minors and subsequently manage the parental consent, and deliver permissible experiences for minors as dictated by business rules and allowed by regulation.</span></span> 

<span data-ttu-id="ca734-113">If a user is identified as a minor, you can set the user flow in Azure AD B2C to one of three options:</span><span class="sxs-lookup"><span data-stu-id="ca734-113">If a user is identified as a minor, you can set the user flow in Azure AD B2C to one of three options:</span></span>

- <span data-ttu-id="ca734-114">**Send a signed JWT id_token back to the application**: The user is registered in the directory, and a token is returned to the application.</span><span class="sxs-lookup"><span data-stu-id="ca734-114">**Send a signed JWT id_token back to the application**: The user is registered in the directory, and a token is returned to the application.</span></span> <span data-ttu-id="ca734-115">The application then proceeds by applying business rules.</span><span class="sxs-lookup"><span data-stu-id="ca734-115">The application then proceeds by applying business rules.</span></span> <span data-ttu-id="ca734-116">For example, the application may proceed with a parental consent process.</span><span class="sxs-lookup"><span data-stu-id="ca734-116">For example, the application may proceed with a parental consent process.</span></span> <span data-ttu-id="ca734-117">To use this method, choose to receive the **ageGroup** and **consentProvidedForMinor** claims from the application.</span><span class="sxs-lookup"><span data-stu-id="ca734-117">To use this method, choose to receive the **ageGroup** and **consentProvidedForMinor** claims from the application.</span></span>

- <span data-ttu-id="ca734-118">**Send an unsigned JSON token to the application**: Azure AD B2C notifies the application that the user is a minor and provides the status of the user’s parental consent.</span><span class="sxs-lookup"><span data-stu-id="ca734-118">**Send an unsigned JSON token to the application**: Azure AD B2C notifies the application that the user is a minor and provides the status of the user’s parental consent.</span></span> <span data-ttu-id="ca734-119">The application then proceeds by applying business rules.</span><span class="sxs-lookup"><span data-stu-id="ca734-119">The application then proceeds by applying business rules.</span></span> <span data-ttu-id="ca734-120">A JSON token does not complete a successful authentication with the application.</span><span class="sxs-lookup"><span data-stu-id="ca734-120">A JSON token does not complete a successful authentication with the application.</span></span> <span data-ttu-id="ca734-121">The application must process the unauthenticated user according to the claims included in the JSON token, which may include **name**, **email**, **ageGroup**, and **consentProvidedForMinor**.</span><span class="sxs-lookup"><span data-stu-id="ca734-121">The application must process the unauthenticated user according to the claims included in the JSON token, which may include **name**, **email**, **ageGroup**, and **consentProvidedForMinor**.</span></span>

- <span data-ttu-id="ca734-122">**Block the user**: If a user is a minor, and parental consent has not been provided, Azure AD B2C can notify the user that he or she is blocked.</span><span class="sxs-lookup"><span data-stu-id="ca734-122">**Block the user**: If a user is a minor, and parental consent has not been provided, Azure AD B2C can notify the user that he or she is blocked.</span></span> <span data-ttu-id="ca734-123">No token is issued, access is blocked, and the user account is not created during a registration journey.</span><span class="sxs-lookup"><span data-stu-id="ca734-123">No token is issued, access is blocked, and the user account is not created during a registration journey.</span></span> <span data-ttu-id="ca734-124">To implement this notification, you provide a suitable HTML/CSS content page to inform the user and present appropriate options.</span><span class="sxs-lookup"><span data-stu-id="ca734-124">To implement this notification, you provide a suitable HTML/CSS content page to inform the user and present appropriate options.</span></span> <span data-ttu-id="ca734-125">No further action is needed by the application for new registrations.</span><span class="sxs-lookup"><span data-stu-id="ca734-125">No further action is needed by the application for new registrations.</span></span>

## <a name="get-parental-consent"></a><span data-ttu-id="ca734-126">Get parental consent</span><span class="sxs-lookup"><span data-stu-id="ca734-126">Get parental consent</span></span>

<span data-ttu-id="ca734-127">Depending on application regulation, parental consent might need to be granted by a user who is verified as an adult.</span><span class="sxs-lookup"><span data-stu-id="ca734-127">Depending on application regulation, parental consent might need to be granted by a user who is verified as an adult.</span></span> <span data-ttu-id="ca734-128">Azure AD B2C does not provide an experience to verify an individual’s age and then allow a verified adult to grant parental consent to a minor.</span><span class="sxs-lookup"><span data-stu-id="ca734-128">Azure AD B2C does not provide an experience to verify an individual’s age and then allow a verified adult to grant parental consent to a minor.</span></span> <span data-ttu-id="ca734-129">This experience must be provided by the application or another service provider.</span><span class="sxs-lookup"><span data-stu-id="ca734-129">This experience must be provided by the application or another service provider.</span></span>

<span data-ttu-id="ca734-130">The following is an example of a user flow for gathering parental consent:</span><span class="sxs-lookup"><span data-stu-id="ca734-130">The following is an example of a user flow for gathering parental consent:</span></span>

1. <span data-ttu-id="ca734-131">An [Azure Active Directory Graph API](https://msdn.microsoft.com/library/azure/ad/graph/api/api-catalog) operation identifies the user as a minor and returns the user data to the application in the form of an unsigned JSON token.</span><span class="sxs-lookup"><span data-stu-id="ca734-131">An [Azure Active Directory Graph API](https://msdn.microsoft.com/library/azure/ad/graph/api/api-catalog) operation identifies the user as a minor and returns the user data to the application in the form of an unsigned JSON token.</span></span>

2. <span data-ttu-id="ca734-132">The application processes the JSON token and shows a screen to the minor, notifying him or her that parental consent is required and requesting the consent of a parent online.</span><span class="sxs-lookup"><span data-stu-id="ca734-132">The application processes the JSON token and shows a screen to the minor, notifying him or her that parental consent is required and requesting the consent of a parent online.</span></span> 

3. <span data-ttu-id="ca734-133">Azure AD B2C shows a sign-in journey that the user can sign in to normally and issues a token to the application that is set to include **legalAgeGroupClassification = “minorWithParentalConsent”**.</span><span class="sxs-lookup"><span data-stu-id="ca734-133">Azure AD B2C shows a sign-in journey that the user can sign in to normally and issues a token to the application that is set to include **legalAgeGroupClassification = “minorWithParentalConsent”**.</span></span> <span data-ttu-id="ca734-134">The application collects the email address of the parent and verifies that the parent is an adult.</span><span class="sxs-lookup"><span data-stu-id="ca734-134">The application collects the email address of the parent and verifies that the parent is an adult.</span></span> <span data-ttu-id="ca734-135">To do so, it uses a trusted source, such as a national ID office, license verification, or credit card proof.</span><span class="sxs-lookup"><span data-stu-id="ca734-135">To do so, it uses a trusted source, such as a national ID office, license verification, or credit card proof.</span></span> <span data-ttu-id="ca734-136">If verification is successful, the application prompts the minor to sign in by using the Azure AD B2C user flow.</span><span class="sxs-lookup"><span data-stu-id="ca734-136">If verification is successful, the application prompts the minor to sign in by using the Azure AD B2C user flow.</span></span> <span data-ttu-id="ca734-137">If consent is denied (for example, if **legalAgeGroupClassification = “minorWithoutParentalConsent”**), Azure AD B2C returns a JSON token (not a login) to the application to restart the consent process.</span><span class="sxs-lookup"><span data-stu-id="ca734-137">If consent is denied (for example, if **legalAgeGroupClassification = “minorWithoutParentalConsent”**), Azure AD B2C returns a JSON token (not a login) to the application to restart the consent process.</span></span> <span data-ttu-id="ca734-138">It is optionally possible to customize the user flow so that a minor or an adult can regain access to a minor’s account by sending a registration code to the minor’s email address or the adult’s email address on record.</span><span class="sxs-lookup"><span data-stu-id="ca734-138">It is optionally possible to customize the user flow so that a minor or an adult can regain access to a minor’s account by sending a registration code to the minor’s email address or the adult’s email address on record.</span></span>

4. <span data-ttu-id="ca734-139">The application offers an option to the minor to revoke consent.</span><span class="sxs-lookup"><span data-stu-id="ca734-139">The application offers an option to the minor to revoke consent.</span></span>

5. <span data-ttu-id="ca734-140">When either the minor or the adult revokes consent, the Azure AD Graph API can be used to change **consentProvidedForMinor** to **denied**.</span><span class="sxs-lookup"><span data-stu-id="ca734-140">When either the minor or the adult revokes consent, the Azure AD Graph API can be used to change **consentProvidedForMinor** to **denied**.</span></span> <span data-ttu-id="ca734-141">Alternatively, the application may choose to delete a minor whose consent has been revoked.</span><span class="sxs-lookup"><span data-stu-id="ca734-141">Alternatively, the application may choose to delete a minor whose consent has been revoked.</span></span> <span data-ttu-id="ca734-142">It is optionally possible to customize the user flow so that the authenticated minor (or parent that is using the minor’s account) can revoke consent.</span><span class="sxs-lookup"><span data-stu-id="ca734-142">It is optionally possible to customize the user flow so that the authenticated minor (or parent that is using the minor’s account) can revoke consent.</span></span> <span data-ttu-id="ca734-143">Azure AD B2C records **consentProvidedForMinor** as **denied**.</span><span class="sxs-lookup"><span data-stu-id="ca734-143">Azure AD B2C records **consentProvidedForMinor** as **denied**.</span></span>

<span data-ttu-id="ca734-144">For more information about **legalAgeGroupClassification**, **consentProvidedForMinor**, and **ageGroup**, see [User resource type](https://developer.microsoft.com/graph/docs/api-reference/beta/resources/user).</span><span class="sxs-lookup"><span data-stu-id="ca734-144">For more information about **legalAgeGroupClassification**, **consentProvidedForMinor**, and **ageGroup**, see [User resource type](https://developer.microsoft.com/graph/docs/api-reference/beta/resources/user).</span></span> <span data-ttu-id="ca734-145">For more information about custom attributes, see [Use custom attributes to collect information about your consumers](active-directory-b2c-reference-custom-attr.md).</span><span class="sxs-lookup"><span data-stu-id="ca734-145">For more information about custom attributes, see [Use custom attributes to collect information about your consumers](active-directory-b2c-reference-custom-attr.md).</span></span> <span data-ttu-id="ca734-146">When you address extended attributes by using the Azure AD Graph API, you must use the long version of the attribute, such as *extension_18b70cf9bb834edd8f38521c2583cd86_dateOfBirth*: *2011-01-01T00:00:00Z*.</span><span class="sxs-lookup"><span data-stu-id="ca734-146">When you address extended attributes by using the Azure AD Graph API, you must use the long version of the attribute, such as *extension_18b70cf9bb834edd8f38521c2583cd86_dateOfBirth*: *2011-01-01T00:00:00Z*.</span></span>

## <a name="gather-date-of-birth-and-country-data"></a><span data-ttu-id="ca734-147">Gather date of birth and country data</span><span class="sxs-lookup"><span data-stu-id="ca734-147">Gather date of birth and country data</span></span>

<span data-ttu-id="ca734-148">Applications may rely on Azure AD B2C to gather the date of birth (DOB) and country information from all users during registration.</span><span class="sxs-lookup"><span data-stu-id="ca734-148">Applications may rely on Azure AD B2C to gather the date of birth (DOB) and country information from all users during registration.</span></span> <span data-ttu-id="ca734-149">If this information does not already exist, the application can request it from the user during the next authentication (sign-in) journey.</span><span class="sxs-lookup"><span data-stu-id="ca734-149">If this information does not already exist, the application can request it from the user during the next authentication (sign-in) journey.</span></span> <span data-ttu-id="ca734-150">Users cannot proceed without providing their DOB and country information.</span><span class="sxs-lookup"><span data-stu-id="ca734-150">Users cannot proceed without providing their DOB and country information.</span></span> <span data-ttu-id="ca734-151">Azure AD B2C uses the information to determine whether the individual is considered a minor according to the regulatory standards of that country.</span><span class="sxs-lookup"><span data-stu-id="ca734-151">Azure AD B2C uses the information to determine whether the individual is considered a minor according to the regulatory standards of that country.</span></span> 

<span data-ttu-id="ca734-152">A customized user flow can gather DOB and country information and use Azure AD B2C claims transformation to determine the **ageGroup** and persist the result (or persist the DOB and country information directly) in the directory.</span><span class="sxs-lookup"><span data-stu-id="ca734-152">A customized user flow can gather DOB and country information and use Azure AD B2C claims transformation to determine the **ageGroup** and persist the result (or persist the DOB and country information directly) in the directory.</span></span>

<span data-ttu-id="ca734-153">The following steps show the logic that is used to calculate **ageGroup** from the user's date of birth:</span><span class="sxs-lookup"><span data-stu-id="ca734-153">The following steps show the logic that is used to calculate **ageGroup** from the user's date of birth:</span></span>

1. <span data-ttu-id="ca734-154">Try to find the country by the country code in the list.</span><span class="sxs-lookup"><span data-stu-id="ca734-154">Try to find the country by the country code in the list.</span></span> <span data-ttu-id="ca734-155">If the country is not found, fall back to **Default**.</span><span class="sxs-lookup"><span data-stu-id="ca734-155">If the country is not found, fall back to **Default**.</span></span>

2. <span data-ttu-id="ca734-156">If the **MinorConsent** node is present in the country element:</span><span class="sxs-lookup"><span data-stu-id="ca734-156">If the **MinorConsent** node is present in the country element:</span></span>

    <span data-ttu-id="ca734-157">a.</span><span class="sxs-lookup"><span data-stu-id="ca734-157">a.</span></span> <span data-ttu-id="ca734-158">Calculate the date that the user must have been born on to be considered an adult.</span><span class="sxs-lookup"><span data-stu-id="ca734-158">Calculate the date that the user must have been born on to be considered an adult.</span></span> <span data-ttu-id="ca734-159">For example, if the current date is March 14, 2015, and **MinorConsent** is 18, the birth date must be no later than March 14, 2000.</span><span class="sxs-lookup"><span data-stu-id="ca734-159">For example, if the current date is March 14, 2015, and **MinorConsent** is 18, the birth date must be no later than March 14, 2000.</span></span>

    <span data-ttu-id="ca734-160">b.</span><span class="sxs-lookup"><span data-stu-id="ca734-160">b.</span></span> <span data-ttu-id="ca734-161">Compare the minimum birth date with the actual birth date.</span><span class="sxs-lookup"><span data-stu-id="ca734-161">Compare the minimum birth date with the actual birth date.</span></span> <span data-ttu-id="ca734-162">If the minimum birth date is before the user’s birth date, the calculation returns **Minor** as the age group calculation.</span><span class="sxs-lookup"><span data-stu-id="ca734-162">If the minimum birth date is before the user’s birth date, the calculation returns **Minor** as the age group calculation.</span></span>

3. <span data-ttu-id="ca734-163">If the **MinorNoConsentRequired** node is present in the country element, repeat steps 2a and 2b using the value from **MinorNoConsentRequired**.</span><span class="sxs-lookup"><span data-stu-id="ca734-163">If the **MinorNoConsentRequired** node is present in the country element, repeat steps 2a and 2b using the value from **MinorNoConsentRequired**.</span></span> <span data-ttu-id="ca734-164">The output of 2b returns **MinorNoConsentRequired** if the minimum birth date is before the user’s birth date.</span><span class="sxs-lookup"><span data-stu-id="ca734-164">The output of 2b returns **MinorNoConsentRequired** if the minimum birth date is before the user’s birth date.</span></span> 

4. <span data-ttu-id="ca734-165">If neither calculation returns true, the calculation returns **Adult**.</span><span class="sxs-lookup"><span data-stu-id="ca734-165">If neither calculation returns true, the calculation returns **Adult**.</span></span>

<span data-ttu-id="ca734-166">If an application has reliably gathered DOB or country data by other methods, the application may use the Graph API to update the user record with this information.</span><span class="sxs-lookup"><span data-stu-id="ca734-166">If an application has reliably gathered DOB or country data by other methods, the application may use the Graph API to update the user record with this information.</span></span> <span data-ttu-id="ca734-167">For example:</span><span class="sxs-lookup"><span data-stu-id="ca734-167">For example:</span></span>

- <span data-ttu-id="ca734-168">If a user is known to be an adult, update the directory attribute **ageGroup** with a value of **Adult**.</span><span class="sxs-lookup"><span data-stu-id="ca734-168">If a user is known to be an adult, update the directory attribute **ageGroup** with a value of **Adult**.</span></span>
- <span data-ttu-id="ca734-169">If a user is known to be a minor, update the directory attribute **ageGroup** with a  value of **Minor** and set **consentProvidedForMinor**, as appropriate.</span><span class="sxs-lookup"><span data-stu-id="ca734-169">If a user is known to be a minor, update the directory attribute **ageGroup** with a  value of **Minor** and set **consentProvidedForMinor**, as appropriate.</span></span>

<span data-ttu-id="ca734-170">For more information about gathering DOB data, see [Use age gating in Azure AD B2C](basic-age-gating.md).</span><span class="sxs-lookup"><span data-stu-id="ca734-170">For more information about gathering DOB data, see [Use age gating in Azure AD B2C](basic-age-gating.md).</span></span>

## <a name="capture-terms-of-use-agreement"></a><span data-ttu-id="ca734-171">Capture terms of use agreement</span><span class="sxs-lookup"><span data-stu-id="ca734-171">Capture terms of use agreement</span></span>

<span data-ttu-id="ca734-172">When you develop your application, you ordinarily capture users' acceptance of terms of use within their applications with no, or only minor, participation from the user directory.</span><span class="sxs-lookup"><span data-stu-id="ca734-172">When you develop your application, you ordinarily capture users' acceptance of terms of use within their applications with no, or only minor, participation from the user directory.</span></span> <span data-ttu-id="ca734-173">It is possible, however, to use an Azure AD B2C user flow to gather a user's acceptance of terms of use, restrict access if acceptance is not granted, and enforce acceptance of future changes to the terms of use, based on the date of the latest acceptance and the date of the latest version of the terms of use.</span><span class="sxs-lookup"><span data-stu-id="ca734-173">It is possible, however, to use an Azure AD B2C user flow to gather a user's acceptance of terms of use, restrict access if acceptance is not granted, and enforce acceptance of future changes to the terms of use, based on the date of the latest acceptance and the date of the latest version of the terms of use.</span></span>

<span data-ttu-id="ca734-174">**Terms of Use** may also include “Consent to share data with third parties.”</span><span class="sxs-lookup"><span data-stu-id="ca734-174">**Terms of Use** may also include “Consent to share data with third parties.”</span></span> <span data-ttu-id="ca734-175">Depending on local regulations and business rules, you can gather a user's acceptance of both conditions combined, or you can allow the user to accept one condition and not the other.</span><span class="sxs-lookup"><span data-stu-id="ca734-175">Depending on local regulations and business rules, you can gather a user's acceptance of both conditions combined, or you can allow the user to accept one condition and not the other.</span></span>

<span data-ttu-id="ca734-176">The following steps describe how you can manage terms of use:</span><span class="sxs-lookup"><span data-stu-id="ca734-176">The following steps describe how you can manage terms of use:</span></span>

1. <span data-ttu-id="ca734-177">Record the acceptance of the terms of use and the date of acceptance by using the Graph API and extended attributes.</span><span class="sxs-lookup"><span data-stu-id="ca734-177">Record the acceptance of the terms of use and the date of acceptance by using the Graph API and extended attributes.</span></span> <span data-ttu-id="ca734-178">You can do so by using both built-in and custom user flows.</span><span class="sxs-lookup"><span data-stu-id="ca734-178">You can do so by using both built-in and custom user flows.</span></span> <span data-ttu-id="ca734-179">We recommend that you create and use the **extension_termsOfUseConsentDateTime** and **extension_termsOfUseConsentVersion** attributes.</span><span class="sxs-lookup"><span data-stu-id="ca734-179">We recommend that you create and use the **extension_termsOfUseConsentDateTime** and **extension_termsOfUseConsentVersion** attributes.</span></span>

2. <span data-ttu-id="ca734-180">Create a required check box labeled “Accept Terms of Use,” and record the result during signup.</span><span class="sxs-lookup"><span data-stu-id="ca734-180">Create a required check box labeled “Accept Terms of Use,” and record the result during signup.</span></span> <span data-ttu-id="ca734-181">You can do so by using both built-in and custom user flows.</span><span class="sxs-lookup"><span data-stu-id="ca734-181">You can do so by using both built-in and custom user flows.</span></span>

3. <span data-ttu-id="ca734-182">Azure AD B2C stores the terms of use agreement and the user's acceptance.</span><span class="sxs-lookup"><span data-stu-id="ca734-182">Azure AD B2C stores the terms of use agreement and the user's acceptance.</span></span> <span data-ttu-id="ca734-183">You can use the Graph API to query for the status of any user by reading the extension attribute that's used to record the response (for example, read **termsOfUseTestUpdateDateTime**).</span><span class="sxs-lookup"><span data-stu-id="ca734-183">You can use the Graph API to query for the status of any user by reading the extension attribute that's used to record the response (for example, read **termsOfUseTestUpdateDateTime**).</span></span> <span data-ttu-id="ca734-184">You can do so by using both built-in and custom user flows.</span><span class="sxs-lookup"><span data-stu-id="ca734-184">You can do so by using both built-in and custom user flows.</span></span>

4. <span data-ttu-id="ca734-185">Require acceptance of updated terms of use by comparing the date of acceptance to the date of the latest version of the terms of use.</span><span class="sxs-lookup"><span data-stu-id="ca734-185">Require acceptance of updated terms of use by comparing the date of acceptance to the date of the latest version of the terms of use.</span></span> <span data-ttu-id="ca734-186">You can compare the dates only by using a custom user flow.</span><span class="sxs-lookup"><span data-stu-id="ca734-186">You can compare the dates only by using a custom user flow.</span></span> <span data-ttu-id="ca734-187">Use the extended attribute **extension_termsOfUseConsentDateTime**, and compare the value to the claim of **termsOfUseTextUpdateDateTime**.</span><span class="sxs-lookup"><span data-stu-id="ca734-187">Use the extended attribute **extension_termsOfUseConsentDateTime**, and compare the value to the claim of **termsOfUseTextUpdateDateTime**.</span></span> <span data-ttu-id="ca734-188">If the acceptance is old, force a new acceptance by displaying a self-asserted screen.</span><span class="sxs-lookup"><span data-stu-id="ca734-188">If the acceptance is old, force a new acceptance by displaying a self-asserted screen.</span></span> <span data-ttu-id="ca734-189">Otherwise, block access by using policy logic.</span><span class="sxs-lookup"><span data-stu-id="ca734-189">Otherwise, block access by using policy logic.</span></span>

5. <span data-ttu-id="ca734-190">Require acceptance of updated terms of use by comparing the version number of the acceptance to the most recent accepted version number.</span><span class="sxs-lookup"><span data-stu-id="ca734-190">Require acceptance of updated terms of use by comparing the version number of the acceptance to the most recent accepted version number.</span></span> <span data-ttu-id="ca734-191">You can compare version numbers only by using a custom user flow.</span><span class="sxs-lookup"><span data-stu-id="ca734-191">You can compare version numbers only by using a custom user flow.</span></span> <span data-ttu-id="ca734-192">Use the extended attribute **extension_termsOfUseConsentDateTime**, and compare the value to the claim of **extension_termsOfUseConsentVersion**.</span><span class="sxs-lookup"><span data-stu-id="ca734-192">Use the extended attribute **extension_termsOfUseConsentDateTime**, and compare the value to the claim of **extension_termsOfUseConsentVersion**.</span></span> <span data-ttu-id="ca734-193">If the acceptance is old, force a new acceptance by displaying a self-asserted screen.</span><span class="sxs-lookup"><span data-stu-id="ca734-193">If the acceptance is old, force a new acceptance by displaying a self-asserted screen.</span></span> <span data-ttu-id="ca734-194">Otherwise, block access by using policy logic.</span><span class="sxs-lookup"><span data-stu-id="ca734-194">Otherwise, block access by using policy logic.</span></span>

<span data-ttu-id="ca734-195">You can capture terms of use acceptance under the following scenarios:</span><span class="sxs-lookup"><span data-stu-id="ca734-195">You can capture terms of use acceptance under the following scenarios:</span></span>

- <span data-ttu-id="ca734-196">A new user is signing up.</span><span class="sxs-lookup"><span data-stu-id="ca734-196">A new user is signing up.</span></span> <span data-ttu-id="ca734-197">The terms of use are displayed, and the acceptance result is stored.</span><span class="sxs-lookup"><span data-stu-id="ca734-197">The terms of use are displayed, and the acceptance result is stored.</span></span>
- <span data-ttu-id="ca734-198">A user is signing in who has previously accepted the latest or active terms of use.</span><span class="sxs-lookup"><span data-stu-id="ca734-198">A user is signing in who has previously accepted the latest or active terms of use.</span></span> <span data-ttu-id="ca734-199">The terms of use are not displayed.</span><span class="sxs-lookup"><span data-stu-id="ca734-199">The terms of use are not displayed.</span></span>
- <span data-ttu-id="ca734-200">A user is signing in who has not already accepted the latest or active terms of use.</span><span class="sxs-lookup"><span data-stu-id="ca734-200">A user is signing in who has not already accepted the latest or active terms of use.</span></span> <span data-ttu-id="ca734-201">The terms of use are displayed, and the acceptance result is stored.</span><span class="sxs-lookup"><span data-stu-id="ca734-201">The terms of use are displayed, and the acceptance result is stored.</span></span>
- <span data-ttu-id="ca734-202">A user is signing in who has already accepted an older version of the terms of use, which are now updated to the latest version.</span><span class="sxs-lookup"><span data-stu-id="ca734-202">A user is signing in who has already accepted an older version of the terms of use, which are now updated to the latest version.</span></span> <span data-ttu-id="ca734-203">The terms of use are displayed, and the acceptance result is stored.</span><span class="sxs-lookup"><span data-stu-id="ca734-203">The terms of use are displayed, and the acceptance result is stored.</span></span>

<span data-ttu-id="ca734-204">The following image shows the recommended user flow:</span><span class="sxs-lookup"><span data-stu-id="ca734-204">The following image shows the recommended user flow:</span></span>

![Acceptance user flow](./media/manage-user-access/user-flow.png) 

<span data-ttu-id="ca734-206">The following is an example of a DateTime based terms of use consent in a claim:</span><span class="sxs-lookup"><span data-stu-id="ca734-206">The following is an example of a DateTime based terms of use consent in a claim:</span></span>

```
<ClaimsTransformations>
  <ClaimsTransformation Id="GetNewUserAgreeToTermsOfUseConsentDateTime" TransformationMethod="GetCurrentDateTime">
    <OutputClaims>
      <OutputClaim ClaimTypeReferenceId="extension_termsOfUseConsentDateTime" TransformationClaimType="currentDateTime" />
    </OutputClaims>
  </ClaimsTransformation>
  <ClaimsTransformation Id="IsTermsOfUseConsentRequired" TransformationMethod="IsTermsOfUseConsentRequired">
    <InputClaims>
      <InputClaim ClaimTypeReferenceId="extension_termsOfUseConsentDateTime" TransformationClaimType="termsOfUseConsentDateTime" />
    </InputClaims>
    <InputParameters>
      <InputParameter Id="termsOfUseTextUpdateDateTime" DataType="dateTime" Value="2098-01-30T23:03:45" />
    </InputParameters>
    <OutputClaims>
      <OutputClaim ClaimTypeReferenceId="termsOfUseConsentRequired" TransformationClaimType="result" />
    </OutputClaims>
  </ClaimsTransformation>
</ClaimsTransformations>
```

<span data-ttu-id="ca734-207">The following is an example of a Version based terms of use consent in a claim:</span><span class="sxs-lookup"><span data-stu-id="ca734-207">The following is an example of a Version based terms of use consent in a claim:</span></span>

```
<ClaimsTransformations>
  <ClaimsTransformation Id="GetEmptyTermsOfUseConsentVersionForNewUser" TransformationMethod="CreateStringClaim">
    <InputParameters>
      <InputParameter Id="value" DataType="string" Value=""/>
    </InputParameters>
    <OutputClaims>
      <OutputClaim ClaimTypeReferenceId="extension_termsOfUseConsentVersion" TransformationClaimType="createdClaim" />
    </OutputClaims>
  </ClaimsTransformation>
  <ClaimsTransformation Id="GetNewUserAgreeToTermsOfUseConsentVersion" TransformationMethod="CreateStringClaim">
    <InputParameters>
      <InputParameter Id="value" DataType="string" Value="V1"/>
    </InputParameters>
    <OutputClaims>
      <OutputClaim ClaimTypeReferenceId="extension_termsOfUseConsentVersion" TransformationClaimType="createdClaim" />
    </OutputClaims>
  </ClaimsTransformation>
  <ClaimsTransformation Id="IsTermsOfUseConsentRequiredForVersion" TransformationMethod="CompareClaimToValue">
    <InputClaims>
      <InputClaim ClaimTypeReferenceId="extension_termsOfUseConsentVersion" TransformationClaimType="inputClaim1" />
    </InputClaims>
    <InputParameters>
      <InputParameter Id="compareTo" DataType="string" Value="V1" />
      <InputParameter Id="operator" DataType="string" Value="not equal" />
      <InputParameter Id="ignoreCase" DataType="string" Value="true" />
    </InputParameters>
    <OutputClaims>
      <OutputClaim ClaimTypeReferenceId="termsOfUseConsentRequired" TransformationClaimType="outputClaim" />
    </OutputClaims>
  </ClaimsTransformation>
</ClaimsTransformations> 
```

## <a name="next-steps"></a><span data-ttu-id="ca734-208">Next steps</span><span class="sxs-lookup"><span data-stu-id="ca734-208">Next steps</span></span>

- <span data-ttu-id="ca734-209">To learn how to delete and export user data, see [Manage user data](manage-user-data.md).</span><span class="sxs-lookup"><span data-stu-id="ca734-209">To learn how to delete and export user data, see [Manage user data](manage-user-data.md).</span></span>
