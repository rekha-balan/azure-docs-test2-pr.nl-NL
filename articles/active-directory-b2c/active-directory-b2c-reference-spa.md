---
title: Azure Active Directory B2C | Microsoft Docs
description: How to build single-page apps directly by using implicit flow.
services: active-directory-b2c
documentationcenter: ''
author: parakhj
manager: krassk
editor: parakhj
ms.assetid: a45cc74c-a37e-453f-b08b-af75855e0792
ms.service: active-directory-b2c
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 02/06/2017
ms.author: parakhj
ms.openlocfilehash: 1ae531bb90c3f6a30f8c970903bde6731d6eaaa8
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44564748"
---
# <a name="azure-active-directory-b2c-sign-in-for-single-page-apps-using-oauth-20-implicit-flow"></a><span data-ttu-id="81d65-103">Azure Active Directory B2C: Sign-in for Single-Page Apps using OAuth 2.0 Implicit Flow</span><span class="sxs-lookup"><span data-stu-id="81d65-103">Azure Active Directory B2C: Sign-in for Single-Page Apps using OAuth 2.0 Implicit Flow</span></span>

> [!NOTE]
> <span data-ttu-id="81d65-104">This feature is still in preview.</span><span class="sxs-lookup"><span data-stu-id="81d65-104">This feature is still in preview.</span></span>
> 

<span data-ttu-id="81d65-105">Many modern apps have a single-page app front end that primarily is written in JavaScript.</span><span class="sxs-lookup"><span data-stu-id="81d65-105">Many modern apps have a single-page app front end that primarily is written in JavaScript.</span></span> <span data-ttu-id="81d65-106">Often, it's written by using a framework like AngularJS, Ember.js, or Durandal.js.</span><span class="sxs-lookup"><span data-stu-id="81d65-106">Often, it's written by using a framework like AngularJS, Ember.js, or Durandal.js.</span></span> <span data-ttu-id="81d65-107">Single page and other JavaScript apps that run primarily in a browser face a few interesting challenges when it comes to authentication:</span><span class="sxs-lookup"><span data-stu-id="81d65-107">Single page and other JavaScript apps that run primarily in a browser face a few interesting challenges when it comes to authentication:</span></span>

* <span data-ttu-id="81d65-108">The security characteristics of these apps are significantly different from traditional server-based web applications.</span><span class="sxs-lookup"><span data-stu-id="81d65-108">The security characteristics of these apps are significantly different from traditional server-based web applications.</span></span>
* <span data-ttu-id="81d65-109">Many authorization servers & identity providers do not support CORS requests.</span><span class="sxs-lookup"><span data-stu-id="81d65-109">Many authorization servers & identity providers do not support CORS requests.</span></span>
* <span data-ttu-id="81d65-110">Full page browser redirects away from the app become particularly invasive to the user experience.</span><span class="sxs-lookup"><span data-stu-id="81d65-110">Full page browser redirects away from the app become particularly invasive to the user experience.</span></span>

<span data-ttu-id="81d65-111">To support these applications, Azure AD B2C uses the OAuth 2.0 implicit flow.</span><span class="sxs-lookup"><span data-stu-id="81d65-111">To support these applications, Azure AD B2C uses the OAuth 2.0 implicit flow.</span></span>  <span data-ttu-id="81d65-112">The OAuth 2.0 authorization implicit grant flow is described in [section 4.2 of the OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span><span class="sxs-lookup"><span data-stu-id="81d65-112">The OAuth 2.0 authorization implicit grant flow is described in [section 4.2 of the OAuth 2.0 specification](http://tools.ietf.org/html/rfc6749).</span></span>  <span data-ttu-id="81d65-113">In this flow, the app receives tokens directly from the Azure AD authorize endpoint, without any server-to-server exchanges.</span><span class="sxs-lookup"><span data-stu-id="81d65-113">In this flow, the app receives tokens directly from the Azure AD authorize endpoint, without any server-to-server exchanges.</span></span> <span data-ttu-id="81d65-114">All authentication logic and session handling takes place entirely in the JavaScript client, without extra page redirects.</span><span class="sxs-lookup"><span data-stu-id="81d65-114">All authentication logic and session handling takes place entirely in the JavaScript client, without extra page redirects.</span></span>

<span data-ttu-id="81d65-115">Azure AD B2C extends the standard OAuth 2.0 implicit flows to do more than simple authentication and authorization.</span><span class="sxs-lookup"><span data-stu-id="81d65-115">Azure AD B2C extends the standard OAuth 2.0 implicit flows to do more than simple authentication and authorization.</span></span> <span data-ttu-id="81d65-116">It introduces the [**policy parameter**](active-directory-b2c-reference-policies.md), which enables you to use OAuth 2.0 to add user experiences to your app, such as sign-up, sign-in, and profile management.</span><span class="sxs-lookup"><span data-stu-id="81d65-116">It introduces the [**policy parameter**](active-directory-b2c-reference-policies.md), which enables you to use OAuth 2.0 to add user experiences to your app, such as sign-up, sign-in, and profile management.</span></span> <span data-ttu-id="81d65-117">Here we show how to use the implicit flow and Azure AD to implement each of these experiences in your single-page applications.</span><span class="sxs-lookup"><span data-stu-id="81d65-117">Here we show how to use the implicit flow and Azure AD to implement each of these experiences in your single-page applications.</span></span>  <span data-ttu-id="81d65-118">You can also look at our [Node.JS](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-nodejs-webapi) or [.NET](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-dotnet-webapi) samples to help you get started.</span><span class="sxs-lookup"><span data-stu-id="81d65-118">You can also look at our [Node.JS](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-nodejs-webapi) or [.NET](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-dotnet-webapi) samples to help you get started.</span></span>

<span data-ttu-id="81d65-119">The example HTTP requests below use our sample B2C directory, **fabrikamb2c.onmicrosoft.com**, and our sample application and policies.</span><span class="sxs-lookup"><span data-stu-id="81d65-119">The example HTTP requests below use our sample B2C directory, **fabrikamb2c.onmicrosoft.com**, and our sample application and policies.</span></span> <span data-ttu-id="81d65-120">You're free to try out the requests yourself by using these values, or you can replace them with your own.</span><span class="sxs-lookup"><span data-stu-id="81d65-120">You're free to try out the requests yourself by using these values, or you can replace them with your own.</span></span>
<span data-ttu-id="81d65-121">Learn how to [get your own B2C directory, application, and policies](#use-your-own-b2c-tenant).</span><span class="sxs-lookup"><span data-stu-id="81d65-121">Learn how to [get your own B2C directory, application, and policies](#use-your-own-b2c-tenant).</span></span>

## <a name="protocol-diagram"></a><span data-ttu-id="81d65-122">Protocol diagram</span><span class="sxs-lookup"><span data-stu-id="81d65-122">Protocol diagram</span></span>
<span data-ttu-id="81d65-123">The entire implicit sign-in flow looks something like this - each of the steps are described in detail below.</span><span class="sxs-lookup"><span data-stu-id="81d65-123">The entire implicit sign-in flow looks something like this - each of the steps are described in detail below.</span></span>

![OpenId Connect Swimlanes](https://docstestmedia1.blob.core.windows.net/azure-media/articles/media/active-directory-v2-flows/convergence_scenarios_implicit.png)

## <a name="send-authentication-requests"></a><span data-ttu-id="81d65-125">Send authentication requests</span><span class="sxs-lookup"><span data-stu-id="81d65-125">Send authentication requests</span></span>
<span data-ttu-id="81d65-126">When your web app needs to authenticate the user and execute a policy, it directs the user to the `/authorize` endpoint.</span><span class="sxs-lookup"><span data-stu-id="81d65-126">When your web app needs to authenticate the user and execute a policy, it directs the user to the `/authorize` endpoint.</span></span> <span data-ttu-id="81d65-127">This is the interactive portion of the flow, where the user actually takes action, depending on the policy, and gets an `id_token` from the Azure AD endpoint.</span><span class="sxs-lookup"><span data-stu-id="81d65-127">This is the interactive portion of the flow, where the user actually takes action, depending on the policy, and gets an `id_token` from the Azure AD endpoint.</span></span>

<span data-ttu-id="81d65-128">In this request, the client indicates the permissions that it needs to acquire from the user in the `scope` parameter and the policy to execute in the `p` parameter.</span><span class="sxs-lookup"><span data-stu-id="81d65-128">In this request, the client indicates the permissions that it needs to acquire from the user in the `scope` parameter and the policy to execute in the `p` parameter.</span></span> <span data-ttu-id="81d65-129">Three examples are provided below (with line breaks for readability), each using a different policy.</span><span class="sxs-lookup"><span data-stu-id="81d65-129">Three examples are provided below (with line breaks for readability), each using a different policy.</span></span> <span data-ttu-id="81d65-130">To get a feel for how each request works, try pasting the request into a browser and running it.</span><span class="sxs-lookup"><span data-stu-id="81d65-130">To get a feel for how each request works, try pasting the request into a browser and running it.</span></span>

#### <a name="use-a-sign-in-policy"></a><span data-ttu-id="81d65-131">Use a sign-in policy</span><span class="sxs-lookup"><span data-stu-id="81d65-131">Use a sign-in policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=id_token+token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=fragment
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_in
```

#### <a name="use-a-sign-up-policy"></a><span data-ttu-id="81d65-132">Use a sign-up policy</span><span class="sxs-lookup"><span data-stu-id="81d65-132">Use a sign-up policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=id_token+token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=fragment
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_sign_up
```

#### <a name="use-an-edit-profile-policy"></a><span data-ttu-id="81d65-133">Use an edit-profile policy</span><span class="sxs-lookup"><span data-stu-id="81d65-133">Use an edit-profile policy</span></span>
```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=id_token+token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&response_mode=fragment
&scope=openid%20offline_access
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&p=b2c_1_edit_profile
```

| <span data-ttu-id="81d65-134">Parameter</span><span class="sxs-lookup"><span data-stu-id="81d65-134">Parameter</span></span> |  | <span data-ttu-id="81d65-135">Description</span><span class="sxs-lookup"><span data-stu-id="81d65-135">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="81d65-136">client_id</span><span class="sxs-lookup"><span data-stu-id="81d65-136">client_id</span></span> |<span data-ttu-id="81d65-137">Required</span><span class="sxs-lookup"><span data-stu-id="81d65-137">Required</span></span> |<span data-ttu-id="81d65-138">The application ID that the [Azure portal](https://portal.azure.com/) assigned to your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-138">The application ID that the [Azure portal](https://portal.azure.com/) assigned to your app.</span></span> |
| <span data-ttu-id="81d65-139">response_type</span><span class="sxs-lookup"><span data-stu-id="81d65-139">response_type</span></span> |<span data-ttu-id="81d65-140">required</span><span class="sxs-lookup"><span data-stu-id="81d65-140">required</span></span> |<span data-ttu-id="81d65-141">Must include `id_token` for OpenID Connect sign-in.</span><span class="sxs-lookup"><span data-stu-id="81d65-141">Must include `id_token` for OpenID Connect sign-in.</span></span>  <span data-ttu-id="81d65-142">It may also include the response_type `token`.</span><span class="sxs-lookup"><span data-stu-id="81d65-142">It may also include the response_type `token`.</span></span> <span data-ttu-id="81d65-143">Using `token` here allows your app to receive an access token immediately from the authorize endpoint without having to make a second request to the authorize endpoint.</span><span class="sxs-lookup"><span data-stu-id="81d65-143">Using `token` here allows your app to receive an access token immediately from the authorize endpoint without having to make a second request to the authorize endpoint.</span></span>  <span data-ttu-id="81d65-144">If you use the `token` response_type, the `scope` parameter must contain a scope indicating which resource to issue the token for.</span><span class="sxs-lookup"><span data-stu-id="81d65-144">If you use the `token` response_type, the `scope` parameter must contain a scope indicating which resource to issue the token for.</span></span> |
| <span data-ttu-id="81d65-145">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="81d65-145">redirect_uri</span></span> |<span data-ttu-id="81d65-146">Recommended</span><span class="sxs-lookup"><span data-stu-id="81d65-146">Recommended</span></span> |<span data-ttu-id="81d65-147">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-147">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span></span> <span data-ttu-id="81d65-148">It must exactly match one of the redirect_uris that you registered in the portal, except that it must be URL encoded.</span><span class="sxs-lookup"><span data-stu-id="81d65-148">It must exactly match one of the redirect_uris that you registered in the portal, except that it must be URL encoded.</span></span> |
| <span data-ttu-id="81d65-149">response_mode</span><span class="sxs-lookup"><span data-stu-id="81d65-149">response_mode</span></span> |<span data-ttu-id="81d65-150">recommended</span><span class="sxs-lookup"><span data-stu-id="81d65-150">recommended</span></span> |<span data-ttu-id="81d65-151">Specifies the method that should be used to send the resulting token back to your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-151">Specifies the method that should be used to send the resulting token back to your app.</span></span>  <span data-ttu-id="81d65-152">Should be `fragment` for the implicit flow.</span><span class="sxs-lookup"><span data-stu-id="81d65-152">Should be `fragment` for the implicit flow.</span></span> |
| <span data-ttu-id="81d65-153">scope</span><span class="sxs-lookup"><span data-stu-id="81d65-153">scope</span></span> |<span data-ttu-id="81d65-154">Required</span><span class="sxs-lookup"><span data-stu-id="81d65-154">Required</span></span> |<span data-ttu-id="81d65-155">A space-separated list of scopes.</span><span class="sxs-lookup"><span data-stu-id="81d65-155">A space-separated list of scopes.</span></span> <span data-ttu-id="81d65-156">A single scope value indicates to Azure AD both of the permissions that are being requested.</span><span class="sxs-lookup"><span data-stu-id="81d65-156">A single scope value indicates to Azure AD both of the permissions that are being requested.</span></span> <span data-ttu-id="81d65-157">The `openid` scope indicates a permission to sign in the user and get data about the user in the form of **id_tokens** (more to come on this later in the article).</span><span class="sxs-lookup"><span data-stu-id="81d65-157">The `openid` scope indicates a permission to sign in the user and get data about the user in the form of **id_tokens** (more to come on this later in the article).</span></span> <span data-ttu-id="81d65-158">The `offline_access` scope is optional for web apps.</span><span class="sxs-lookup"><span data-stu-id="81d65-158">The `offline_access` scope is optional for web apps.</span></span> <span data-ttu-id="81d65-159">It indicates that your app will need a **refresh_token** for long-lived access to resources.</span><span class="sxs-lookup"><span data-stu-id="81d65-159">It indicates that your app will need a **refresh_token** for long-lived access to resources.</span></span> |
| <span data-ttu-id="81d65-160">state</span><span class="sxs-lookup"><span data-stu-id="81d65-160">state</span></span> |<span data-ttu-id="81d65-161">Recommended</span><span class="sxs-lookup"><span data-stu-id="81d65-161">Recommended</span></span> |<span data-ttu-id="81d65-162">A value included in the request that will also be returned in the token response.</span><span class="sxs-lookup"><span data-stu-id="81d65-162">A value included in the request that will also be returned in the token response.</span></span> <span data-ttu-id="81d65-163">It can be a string of any content that you want.</span><span class="sxs-lookup"><span data-stu-id="81d65-163">It can be a string of any content that you want.</span></span> <span data-ttu-id="81d65-164">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span><span class="sxs-lookup"><span data-stu-id="81d65-164">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span></span> <span data-ttu-id="81d65-165">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page they were on.</span><span class="sxs-lookup"><span data-stu-id="81d65-165">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page they were on.</span></span> |
| <span data-ttu-id="81d65-166">nonce</span><span class="sxs-lookup"><span data-stu-id="81d65-166">nonce</span></span> |<span data-ttu-id="81d65-167">Required</span><span class="sxs-lookup"><span data-stu-id="81d65-167">Required</span></span> |<span data-ttu-id="81d65-168">A value included in the request (generated by the app) that will be included in the resulting id_token as a claim.</span><span class="sxs-lookup"><span data-stu-id="81d65-168">A value included in the request (generated by the app) that will be included in the resulting id_token as a claim.</span></span> <span data-ttu-id="81d65-169">The app can then verify this value to mitigate token replay attacks.</span><span class="sxs-lookup"><span data-stu-id="81d65-169">The app can then verify this value to mitigate token replay attacks.</span></span> <span data-ttu-id="81d65-170">The value is typically a randomized, unique string that can be used to identify the origin of the request.</span><span class="sxs-lookup"><span data-stu-id="81d65-170">The value is typically a randomized, unique string that can be used to identify the origin of the request.</span></span> |
| <span data-ttu-id="81d65-171">p</span><span class="sxs-lookup"><span data-stu-id="81d65-171">p</span></span> |<span data-ttu-id="81d65-172">Required</span><span class="sxs-lookup"><span data-stu-id="81d65-172">Required</span></span> |<span data-ttu-id="81d65-173">The policy that will be executed.</span><span class="sxs-lookup"><span data-stu-id="81d65-173">The policy that will be executed.</span></span> <span data-ttu-id="81d65-174">It is the name of a policy that is created in your B2C tenant.</span><span class="sxs-lookup"><span data-stu-id="81d65-174">It is the name of a policy that is created in your B2C tenant.</span></span> <span data-ttu-id="81d65-175">The policy name value should begin with "b2c\_1\_".</span><span class="sxs-lookup"><span data-stu-id="81d65-175">The policy name value should begin with "b2c\_1\_".</span></span> <span data-ttu-id="81d65-176">Learn more about policies in [Extensible policy framework](active-directory-b2c-reference-policies.md).</span><span class="sxs-lookup"><span data-stu-id="81d65-176">Learn more about policies in [Extensible policy framework](active-directory-b2c-reference-policies.md).</span></span> |
| <span data-ttu-id="81d65-177">prompt</span><span class="sxs-lookup"><span data-stu-id="81d65-177">prompt</span></span> |<span data-ttu-id="81d65-178">Optional</span><span class="sxs-lookup"><span data-stu-id="81d65-178">Optional</span></span> |<span data-ttu-id="81d65-179">The type of user interaction that is required.</span><span class="sxs-lookup"><span data-stu-id="81d65-179">The type of user interaction that is required.</span></span> <span data-ttu-id="81d65-180">The only valid value at this time is 'login', which forces the user to enter their credentials on that request.</span><span class="sxs-lookup"><span data-stu-id="81d65-180">The only valid value at this time is 'login', which forces the user to enter their credentials on that request.</span></span> <span data-ttu-id="81d65-181">Single sign-on will not take effect.</span><span class="sxs-lookup"><span data-stu-id="81d65-181">Single sign-on will not take effect.</span></span> |

<span data-ttu-id="81d65-182">At this point, the user will be asked to complete the policy's workflow.</span><span class="sxs-lookup"><span data-stu-id="81d65-182">At this point, the user will be asked to complete the policy's workflow.</span></span> <span data-ttu-id="81d65-183">This may involve the user entering their user name and password, signing in with a social identity, signing up for the directory, or any other number of steps, depending on how the policy is defined.</span><span class="sxs-lookup"><span data-stu-id="81d65-183">This may involve the user entering their user name and password, signing in with a social identity, signing up for the directory, or any other number of steps, depending on how the policy is defined.</span></span>

<span data-ttu-id="81d65-184">After the user completes the policy, Azure AD will return a response to your app at the indicated `redirect_uri`, by using the method that is specified in the `response_mode` parameter.</span><span class="sxs-lookup"><span data-stu-id="81d65-184">After the user completes the policy, Azure AD will return a response to your app at the indicated `redirect_uri`, by using the method that is specified in the `response_mode` parameter.</span></span> <span data-ttu-id="81d65-185">The response will be exactly the same for each of the above cases, independent of the policy that was executed.</span><span class="sxs-lookup"><span data-stu-id="81d65-185">The response will be exactly the same for each of the above cases, independent of the policy that was executed.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="81d65-186">Successful response</span><span class="sxs-lookup"><span data-stu-id="81d65-186">Successful response</span></span>
<span data-ttu-id="81d65-187">A successful response using `response_mode=fragment` and `response_type=id_token+token` looks like the following, with line breaks for legibility:</span><span class="sxs-lookup"><span data-stu-id="81d65-187">A successful response using `response_mode=fragment` and `response_type=id_token+token` looks like the following, with line breaks for legibility:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&token_type=Bearer
&expires_in=3599
&scope="90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6 offline_access",
&id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&state=arbitrary_data_you_sent_earlier
```

| <span data-ttu-id="81d65-188">Parameter</span><span class="sxs-lookup"><span data-stu-id="81d65-188">Parameter</span></span> | <span data-ttu-id="81d65-189">Description</span><span class="sxs-lookup"><span data-stu-id="81d65-189">Description</span></span> |
| --- | --- |
| <span data-ttu-id="81d65-190">access_token</span><span class="sxs-lookup"><span data-stu-id="81d65-190">access_token</span></span> |<span data-ttu-id="81d65-191">The access token that the app requested.</span><span class="sxs-lookup"><span data-stu-id="81d65-191">The access token that the app requested.</span></span>  <span data-ttu-id="81d65-192">The access token should not be decoded or otherwise inspected, it can be treated as an opaque string.</span><span class="sxs-lookup"><span data-stu-id="81d65-192">The access token should not be decoded or otherwise inspected, it can be treated as an opaque string.</span></span> |
| <span data-ttu-id="81d65-193">token_type</span><span class="sxs-lookup"><span data-stu-id="81d65-193">token_type</span></span> |<span data-ttu-id="81d65-194">The token type value.</span><span class="sxs-lookup"><span data-stu-id="81d65-194">The token type value.</span></span> <span data-ttu-id="81d65-195">The only type that Azure AD supports is Bearer.</span><span class="sxs-lookup"><span data-stu-id="81d65-195">The only type that Azure AD supports is Bearer.</span></span> |
| <span data-ttu-id="81d65-196">expires_in</span><span class="sxs-lookup"><span data-stu-id="81d65-196">expires_in</span></span> |<span data-ttu-id="81d65-197">The length of time that the access_token is valid (in seconds).</span><span class="sxs-lookup"><span data-stu-id="81d65-197">The length of time that the access_token is valid (in seconds).</span></span> |
| <span data-ttu-id="81d65-198">scope</span><span class="sxs-lookup"><span data-stu-id="81d65-198">scope</span></span> |<span data-ttu-id="81d65-199">Scopes for which the token is valid, which can be used for caching tokens for later use.</span><span class="sxs-lookup"><span data-stu-id="81d65-199">Scopes for which the token is valid, which can be used for caching tokens for later use.</span></span> |
| <span data-ttu-id="81d65-200">id_token</span><span class="sxs-lookup"><span data-stu-id="81d65-200">id_token</span></span> |<span data-ttu-id="81d65-201">The id_token that the app requested.</span><span class="sxs-lookup"><span data-stu-id="81d65-201">The id_token that the app requested.</span></span> <span data-ttu-id="81d65-202">You can use the id_token to verify the user's identity and begin a session with the user.</span><span class="sxs-lookup"><span data-stu-id="81d65-202">You can use the id_token to verify the user's identity and begin a session with the user.</span></span> <span data-ttu-id="81d65-203">More details on id_tokens and their contents are included in the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="81d65-203">More details on id_tokens and their contents are included in the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> |
| <span data-ttu-id="81d65-204">state</span><span class="sxs-lookup"><span data-stu-id="81d65-204">state</span></span> |<span data-ttu-id="81d65-205">If a state parameter is included in the request, the same value should appear in the response.</span><span class="sxs-lookup"><span data-stu-id="81d65-205">If a state parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="81d65-206">The app should verify that the state values in the request and response are identical.</span><span class="sxs-lookup"><span data-stu-id="81d65-206">The app should verify that the state values in the request and response are identical.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="81d65-207">Error response</span><span class="sxs-lookup"><span data-stu-id="81d65-207">Error response</span></span>
<span data-ttu-id="81d65-208">Error responses may also be sent to the `redirect_uri` so the app can handle them appropriately:</span><span class="sxs-lookup"><span data-stu-id="81d65-208">Error responses may also be sent to the `redirect_uri` so the app can handle them appropriately:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
error=access_denied
&error_description=the+user+canceled+the+authentication
&state=arbitrary_data_you_can_receive_in_the_response
```

| <span data-ttu-id="81d65-209">Parameter</span><span class="sxs-lookup"><span data-stu-id="81d65-209">Parameter</span></span> | <span data-ttu-id="81d65-210">Description</span><span class="sxs-lookup"><span data-stu-id="81d65-210">Description</span></span> |
| --- | --- |
| <span data-ttu-id="81d65-211">error</span><span class="sxs-lookup"><span data-stu-id="81d65-211">error</span></span> |<span data-ttu-id="81d65-212">An error code string used to classify types of errors that occur.</span><span class="sxs-lookup"><span data-stu-id="81d65-212">An error code string used to classify types of errors that occur.</span></span> <span data-ttu-id="81d65-213">The error code can be used for error handling.</span><span class="sxs-lookup"><span data-stu-id="81d65-213">The error code can be used for error handling.</span></span> |
| <span data-ttu-id="81d65-214">error_description</span><span class="sxs-lookup"><span data-stu-id="81d65-214">error_description</span></span> |<span data-ttu-id="81d65-215">A specific error message that can help a developer identify the root cause of an authentication error.</span><span class="sxs-lookup"><span data-stu-id="81d65-215">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |
| <span data-ttu-id="81d65-216">state</span><span class="sxs-lookup"><span data-stu-id="81d65-216">state</span></span> |<span data-ttu-id="81d65-217">See the full description in the previous table.</span><span class="sxs-lookup"><span data-stu-id="81d65-217">See the full description in the previous table.</span></span> <span data-ttu-id="81d65-218">If a state parameter is included in the request, the same value should appear in the response.</span><span class="sxs-lookup"><span data-stu-id="81d65-218">If a state parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="81d65-219">The app should verify that the state values in the request and response are identical.</span><span class="sxs-lookup"><span data-stu-id="81d65-219">The app should verify that the state values in the request and response are identical.</span></span>|

## <a name="validate-the-idtoken"></a><span data-ttu-id="81d65-220">Validate the id_token</span><span class="sxs-lookup"><span data-stu-id="81d65-220">Validate the id_token</span></span>
<span data-ttu-id="81d65-221">Just receiving an id_token is not enough to authenticate the user--you must validate the id_token's signature and verify the claims in the token as per your app's requirements.</span><span class="sxs-lookup"><span data-stu-id="81d65-221">Just receiving an id_token is not enough to authenticate the user--you must validate the id_token's signature and verify the claims in the token as per your app's requirements.</span></span> <span data-ttu-id="81d65-222">Azure AD B2C uses [JSON Web Tokens (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) and public key cryptography to sign tokens and verify that they are valid.</span><span class="sxs-lookup"><span data-stu-id="81d65-222">Azure AD B2C uses [JSON Web Tokens (JWTs)](http://self-issued.info/docs/draft-ietf-oauth-json-web-token.html) and public key cryptography to sign tokens and verify that they are valid.</span></span>

<span data-ttu-id="81d65-223">There are many open-source libraries that are available for validating JWTs, depending on your language of preference.</span><span class="sxs-lookup"><span data-stu-id="81d65-223">There are many open-source libraries that are available for validating JWTs, depending on your language of preference.</span></span> <span data-ttu-id="81d65-224">Consider exploring those options rather than implementing your own validation logic.</span><span class="sxs-lookup"><span data-stu-id="81d65-224">Consider exploring those options rather than implementing your own validation logic.</span></span> <span data-ttu-id="81d65-225">The information here will be useful in figuring out how to properly use those libraries.</span><span class="sxs-lookup"><span data-stu-id="81d65-225">The information here will be useful in figuring out how to properly use those libraries.</span></span>

<span data-ttu-id="81d65-226">Azure AD B2C has an OpenID Connect metadata endpoint, which allows an app to fetch information about Azure AD B2C at runtime.</span><span class="sxs-lookup"><span data-stu-id="81d65-226">Azure AD B2C has an OpenID Connect metadata endpoint, which allows an app to fetch information about Azure AD B2C at runtime.</span></span> <span data-ttu-id="81d65-227">This information includes endpoints, token contents, and token signing keys.</span><span class="sxs-lookup"><span data-stu-id="81d65-227">This information includes endpoints, token contents, and token signing keys.</span></span> <span data-ttu-id="81d65-228">There is a JSON metadata document for each policy in your B2C tenant.</span><span class="sxs-lookup"><span data-stu-id="81d65-228">There is a JSON metadata document for each policy in your B2C tenant.</span></span> <span data-ttu-id="81d65-229">For example the metadata document for the `b2c_1_sign_in` policy in the `fabrikamb2c.onmicrosoft.com` is located at:</span><span class="sxs-lookup"><span data-stu-id="81d65-229">For example the metadata document for the `b2c_1_sign_in` policy in the `fabrikamb2c.onmicrosoft.com` is located at:</span></span>

`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/v2.0/.well-known/openid-configuration?p=b2c_1_sign_in`

<span data-ttu-id="81d65-230">One of the properties of this configuration document is the `jwks_uri`, whose value for the same policy would be:</span><span class="sxs-lookup"><span data-stu-id="81d65-230">One of the properties of this configuration document is the `jwks_uri`, whose value for the same policy would be:</span></span>

<span data-ttu-id="81d65-231">`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`.</span><span class="sxs-lookup"><span data-stu-id="81d65-231">`https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/discovery/v2.0/keys?p=b2c_1_sign_in`.</span></span>

<span data-ttu-id="81d65-232">In order to determine which policy was used in signing an id_token (and where to fetch the metadata from), you have two options.</span><span class="sxs-lookup"><span data-stu-id="81d65-232">In order to determine which policy was used in signing an id_token (and where to fetch the metadata from), you have two options.</span></span> <span data-ttu-id="81d65-233">First, the policy name is included in the `acr` claim in the id_token.</span><span class="sxs-lookup"><span data-stu-id="81d65-233">First, the policy name is included in the `acr` claim in the id_token.</span></span> <span data-ttu-id="81d65-234">For information on how to parse the claims from an id_token, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="81d65-234">For information on how to parse the claims from an id_token, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span> <span data-ttu-id="81d65-235">Your other option is to encode the policy in the value of the `state` parameter when you issue the request, and then decode it to determine which policy was used.</span><span class="sxs-lookup"><span data-stu-id="81d65-235">Your other option is to encode the policy in the value of the `state` parameter when you issue the request, and then decode it to determine which policy was used.</span></span> <span data-ttu-id="81d65-236">Either method is perfectly valid.</span><span class="sxs-lookup"><span data-stu-id="81d65-236">Either method is perfectly valid.</span></span>

<span data-ttu-id="81d65-237">After you've acquired the metadata document from the OpenID Connect metadata endpoint, you can use the RSA 256 public keys (which are located at this endpoint) to validate the signature of the id_token.</span><span class="sxs-lookup"><span data-stu-id="81d65-237">After you've acquired the metadata document from the OpenID Connect metadata endpoint, you can use the RSA 256 public keys (which are located at this endpoint) to validate the signature of the id_token.</span></span> <span data-ttu-id="81d65-238">There may be multiple keys listed at this endpoint at any given point in time, each identified by a `kid`.</span><span class="sxs-lookup"><span data-stu-id="81d65-238">There may be multiple keys listed at this endpoint at any given point in time, each identified by a `kid`.</span></span> <span data-ttu-id="81d65-239">The header of the id_token also contains a `kid` claim, which indicates which of these keys was used to sign the id_token.</span><span class="sxs-lookup"><span data-stu-id="81d65-239">The header of the id_token also contains a `kid` claim, which indicates which of these keys was used to sign the id_token.</span></span> <span data-ttu-id="81d65-240">See the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md) for more information, including [validating tokens](active-directory-b2c-reference-tokens.md#token-validation).</span><span class="sxs-lookup"><span data-stu-id="81d65-240">See the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md) for more information, including [validating tokens](active-directory-b2c-reference-tokens.md#token-validation).</span></span>
<!--TODO: Improve the information on this-->

<span data-ttu-id="81d65-241">After validating the signature of the id_token, several claims also require verification, for instance:</span><span class="sxs-lookup"><span data-stu-id="81d65-241">After validating the signature of the id_token, several claims also require verification, for instance:</span></span>

* <span data-ttu-id="81d65-242">Validate the `nonce` claim to prevent token replay attacks.</span><span class="sxs-lookup"><span data-stu-id="81d65-242">Validate the `nonce` claim to prevent token replay attacks.</span></span> <span data-ttu-id="81d65-243">Its value should be what you specified in the sign-in request.</span><span class="sxs-lookup"><span data-stu-id="81d65-243">Its value should be what you specified in the sign-in request.</span></span>
* <span data-ttu-id="81d65-244">Validate the `aud` claim to ensure that the id_token was issued for your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-244">Validate the `aud` claim to ensure that the id_token was issued for your app.</span></span> <span data-ttu-id="81d65-245">Its value should be the application ID of your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-245">Its value should be the application ID of your app.</span></span>
* <span data-ttu-id="81d65-246">Validate the `iat` and `exp` claims to ensure that the id_token has not expired.</span><span class="sxs-lookup"><span data-stu-id="81d65-246">Validate the `iat` and `exp` claims to ensure that the id_token has not expired.</span></span>

<span data-ttu-id="81d65-247">There are also several more validations that you should perform, described in detail in the [OpenID Connect Core Spec](http://openid.net/specs/openid-connect-core-1_0.html).  You might also want to validate additional claims, depending on your scenario.</span><span class="sxs-lookup"><span data-stu-id="81d65-247">There are also several more validations that you should perform, described in detail in the [OpenID Connect Core Spec](http://openid.net/specs/openid-connect-core-1_0.html).  You might also want to validate additional claims, depending on your scenario.</span></span> <span data-ttu-id="81d65-248">Some common validations include:</span><span class="sxs-lookup"><span data-stu-id="81d65-248">Some common validations include:</span></span>

* <span data-ttu-id="81d65-249">Ensuring that the user/organization has signed up for the app.</span><span class="sxs-lookup"><span data-stu-id="81d65-249">Ensuring that the user/organization has signed up for the app.</span></span>
* <span data-ttu-id="81d65-250">Ensuring that the user has proper authorization/privileges.</span><span class="sxs-lookup"><span data-stu-id="81d65-250">Ensuring that the user has proper authorization/privileges.</span></span>
* <span data-ttu-id="81d65-251">Ensuring that a certain strength of authentication has occurred, such as Azure Multi-Factor Authentication.</span><span class="sxs-lookup"><span data-stu-id="81d65-251">Ensuring that a certain strength of authentication has occurred, such as Azure Multi-Factor Authentication.</span></span>

<span data-ttu-id="81d65-252">For more information on the claims in an id_token, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span><span class="sxs-lookup"><span data-stu-id="81d65-252">For more information on the claims in an id_token, see the [Azure AD B2C token reference](active-directory-b2c-reference-tokens.md).</span></span>

<span data-ttu-id="81d65-253">After you have completely validated the id_token, you can begin a session with the user and use the claims in the id_token to obtain information about the user in your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-253">After you have completely validated the id_token, you can begin a session with the user and use the claims in the id_token to obtain information about the user in your app.</span></span> <span data-ttu-id="81d65-254">This information can be used for display, records, authorization, and so on.</span><span class="sxs-lookup"><span data-stu-id="81d65-254">This information can be used for display, records, authorization, and so on.</span></span>

## <a name="get-access-tokens"></a><span data-ttu-id="81d65-255">Get access tokens</span><span class="sxs-lookup"><span data-stu-id="81d65-255">Get access tokens</span></span>
<span data-ttu-id="81d65-256">If all that your web app needs to do is to execute policies, you can skip the next few sections.</span><span class="sxs-lookup"><span data-stu-id="81d65-256">If all that your web app needs to do is to execute policies, you can skip the next few sections.</span></span> <span data-ttu-id="81d65-257">These sections are only applicable to web apps that need to make authenticated calls to a web API and are also protected by Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="81d65-257">These sections are only applicable to web apps that need to make authenticated calls to a web API and are also protected by Azure AD B2C.</span></span>

<span data-ttu-id="81d65-258">Now that you've signed the user into your single page app, you can get access tokens for calling web APIs secured by Azure AD.</span><span class="sxs-lookup"><span data-stu-id="81d65-258">Now that you've signed the user into your single page app, you can get access tokens for calling web APIs secured by Azure AD.</span></span>  <span data-ttu-id="81d65-259">Even if you already received a token using the `token` response_type, you can use this method to acquire tokens to additional resources without having to redirect the user to sign in again.</span><span class="sxs-lookup"><span data-stu-id="81d65-259">Even if you already received a token using the `token` response_type, you can use this method to acquire tokens to additional resources without having to redirect the user to sign in again.</span></span>

<span data-ttu-id="81d65-260">In the normal web app flow, you would do this by making a request to the `/token` endpoint.</span><span class="sxs-lookup"><span data-stu-id="81d65-260">In the normal web app flow, you would do this by making a request to the `/token` endpoint.</span></span>  <span data-ttu-id="81d65-261">However, the endpoint does not support CORS requests, so making AJAX calls to get and refresh tokens is out of the question.</span><span class="sxs-lookup"><span data-stu-id="81d65-261">However, the endpoint does not support CORS requests, so making AJAX calls to get and refresh tokens is out of the question.</span></span>  <span data-ttu-id="81d65-262">Instead, you can use the implicit flow in a hidden iframe to get new tokens for other web APIs:</span><span class="sxs-lookup"><span data-stu-id="81d65-262">Instead, you can use the implicit flow in a hidden iframe to get new tokens for other web APIs:</span></span>

```
// Line breaks for legibility only

https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/authorize?
client_id=90c0fe63-bcf2-44d5-8fb7-b8bbc0b29dc6
&response_type=token
&redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
&scope=https%3A%2F%2Fapi.contoso.com%2Ftasks.read
&response_mode=fragment
&state=arbitrary_data_you_can_receive_in_the_response
&nonce=12345
&prompt=none
&domain_hint=organizations
&login_hint=myuser@mycompany.com
&p=b2c_1_sign_in
```

| <span data-ttu-id="81d65-263">Parameter</span><span class="sxs-lookup"><span data-stu-id="81d65-263">Parameter</span></span> |  | <span data-ttu-id="81d65-264">Description</span><span class="sxs-lookup"><span data-stu-id="81d65-264">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="81d65-265">client_id</span><span class="sxs-lookup"><span data-stu-id="81d65-265">client_id</span></span> |<span data-ttu-id="81d65-266">Required</span><span class="sxs-lookup"><span data-stu-id="81d65-266">Required</span></span> |<span data-ttu-id="81d65-267">The application ID that the [Azure portal](https://portal.azure.com/) assigned to your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-267">The application ID that the [Azure portal](https://portal.azure.com/) assigned to your app.</span></span> |
| <span data-ttu-id="81d65-268">response_type</span><span class="sxs-lookup"><span data-stu-id="81d65-268">response_type</span></span> |<span data-ttu-id="81d65-269">required</span><span class="sxs-lookup"><span data-stu-id="81d65-269">required</span></span> |<span data-ttu-id="81d65-270">Must include `id_token` for OpenID Connect sign-in.</span><span class="sxs-lookup"><span data-stu-id="81d65-270">Must include `id_token` for OpenID Connect sign-in.</span></span>  <span data-ttu-id="81d65-271">It may also include the response_type `token`.</span><span class="sxs-lookup"><span data-stu-id="81d65-271">It may also include the response_type `token`.</span></span> <span data-ttu-id="81d65-272">Using `token` here will allow your app to receive an access token immediately from the authorize endpoint without having to make a second request to the authorize endpoint.</span><span class="sxs-lookup"><span data-stu-id="81d65-272">Using `token` here will allow your app to receive an access token immediately from the authorize endpoint without having to make a second request to the authorize endpoint.</span></span>  <span data-ttu-id="81d65-273">If you use the `token` response_type, the `scope` parameter must contain a scope indicating which resource to issue the token for.</span><span class="sxs-lookup"><span data-stu-id="81d65-273">If you use the `token` response_type, the `scope` parameter must contain a scope indicating which resource to issue the token for.</span></span> |
| <span data-ttu-id="81d65-274">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="81d65-274">redirect_uri</span></span> |<span data-ttu-id="81d65-275">recommended</span><span class="sxs-lookup"><span data-stu-id="81d65-275">recommended</span></span> |<span data-ttu-id="81d65-276">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-276">The redirect_uri of your app, where authentication responses can be sent and received by your app.</span></span>  <span data-ttu-id="81d65-277">It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded.</span><span class="sxs-lookup"><span data-stu-id="81d65-277">It must exactly match one of the redirect_uris you registered in the portal, except it must be url encoded.</span></span> |
| <span data-ttu-id="81d65-278">scope</span><span class="sxs-lookup"><span data-stu-id="81d65-278">scope</span></span> |<span data-ttu-id="81d65-279">required</span><span class="sxs-lookup"><span data-stu-id="81d65-279">required</span></span> |<span data-ttu-id="81d65-280">A space-separated list of scopes.</span><span class="sxs-lookup"><span data-stu-id="81d65-280">A space-separated list of scopes.</span></span>  <span data-ttu-id="81d65-281">For getting tokens, include all scopes you require for the resource of interest.</span><span class="sxs-lookup"><span data-stu-id="81d65-281">For getting tokens, include all scopes you require for the resource of interest.</span></span> |
| <span data-ttu-id="81d65-282">response_mode</span><span class="sxs-lookup"><span data-stu-id="81d65-282">response_mode</span></span> |<span data-ttu-id="81d65-283">recommended</span><span class="sxs-lookup"><span data-stu-id="81d65-283">recommended</span></span> |<span data-ttu-id="81d65-284">Specifies the method that is used to send the resulting token back to your app.</span><span class="sxs-lookup"><span data-stu-id="81d65-284">Specifies the method that is used to send the resulting token back to your app.</span></span>  <span data-ttu-id="81d65-285">Can be one of `query`, `form_post`, or `fragment`.</span><span class="sxs-lookup"><span data-stu-id="81d65-285">Can be one of `query`, `form_post`, or `fragment`.</span></span> |
| <span data-ttu-id="81d65-286">state</span><span class="sxs-lookup"><span data-stu-id="81d65-286">state</span></span> |<span data-ttu-id="81d65-287">recommended</span><span class="sxs-lookup"><span data-stu-id="81d65-287">recommended</span></span> |<span data-ttu-id="81d65-288">A value included in the request that is returned in the token response.</span><span class="sxs-lookup"><span data-stu-id="81d65-288">A value included in the request that is returned in the token response.</span></span>  <span data-ttu-id="81d65-289">It can be a string of any content that you wish.</span><span class="sxs-lookup"><span data-stu-id="81d65-289">It can be a string of any content that you wish.</span></span>  <span data-ttu-id="81d65-290">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span><span class="sxs-lookup"><span data-stu-id="81d65-290">A randomly generated unique value is typically used for preventing cross-site request forgery attacks.</span></span>  <span data-ttu-id="81d65-291">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span><span class="sxs-lookup"><span data-stu-id="81d65-291">The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |
| <span data-ttu-id="81d65-292">nonce</span><span class="sxs-lookup"><span data-stu-id="81d65-292">nonce</span></span> |<span data-ttu-id="81d65-293">required</span><span class="sxs-lookup"><span data-stu-id="81d65-293">required</span></span> |<span data-ttu-id="81d65-294">A value included in the request, generated by the app, that is included in the resulting id_token as a claim.</span><span class="sxs-lookup"><span data-stu-id="81d65-294">A value included in the request, generated by the app, that is included in the resulting id_token as a claim.</span></span>  <span data-ttu-id="81d65-295">The app can then verify this value to mitigate token replay attacks.</span><span class="sxs-lookup"><span data-stu-id="81d65-295">The app can then verify this value to mitigate token replay attacks.</span></span>  <span data-ttu-id="81d65-296">The value is typically a randomized, unique string that identifies the origin of the request.</span><span class="sxs-lookup"><span data-stu-id="81d65-296">The value is typically a randomized, unique string that identifies the origin of the request.</span></span> |
| <span data-ttu-id="81d65-297">prompt</span><span class="sxs-lookup"><span data-stu-id="81d65-297">prompt</span></span> |<span data-ttu-id="81d65-298">required</span><span class="sxs-lookup"><span data-stu-id="81d65-298">required</span></span> |<span data-ttu-id="81d65-299">For refreshing & getting tokens in a hidden iframe, use `prompt=none` to ensure that the iframe does not hang on the sign-in page, and returns immediately.</span><span class="sxs-lookup"><span data-stu-id="81d65-299">For refreshing & getting tokens in a hidden iframe, use `prompt=none` to ensure that the iframe does not hang on the sign-in page, and returns immediately.</span></span> |
| <span data-ttu-id="81d65-300">login_hint</span><span class="sxs-lookup"><span data-stu-id="81d65-300">login_hint</span></span> |<span data-ttu-id="81d65-301">required</span><span class="sxs-lookup"><span data-stu-id="81d65-301">required</span></span> |<span data-ttu-id="81d65-302">For refreshing & getting tokens in a hidden iframe, you must include the username of the user in this hint in order to distinguish between multiple sessions the user may have at a given point in time.</span><span class="sxs-lookup"><span data-stu-id="81d65-302">For refreshing & getting tokens in a hidden iframe, you must include the username of the user in this hint in order to distinguish between multiple sessions the user may have at a given point in time.</span></span> <span data-ttu-id="81d65-303">You can extract the username from a previous sign-in using the `preferred_username` claim.</span><span class="sxs-lookup"><span data-stu-id="81d65-303">You can extract the username from a previous sign-in using the `preferred_username` claim.</span></span> |
| <span data-ttu-id="81d65-304">domain_hint</span><span class="sxs-lookup"><span data-stu-id="81d65-304">domain_hint</span></span> |<span data-ttu-id="81d65-305">required</span><span class="sxs-lookup"><span data-stu-id="81d65-305">required</span></span> |<span data-ttu-id="81d65-306">Can be one of `consumers` or `organizations`.</span><span class="sxs-lookup"><span data-stu-id="81d65-306">Can be one of `consumers` or `organizations`.</span></span>  <span data-ttu-id="81d65-307">For refreshing & getting tokens in a hidden iframe, you must include the domain_hint in the request.</span><span class="sxs-lookup"><span data-stu-id="81d65-307">For refreshing & getting tokens in a hidden iframe, you must include the domain_hint in the request.</span></span>  <span data-ttu-id="81d65-308">Extract the `tid` claim from the id_token of a previous sign-in to determine which value to use.</span><span class="sxs-lookup"><span data-stu-id="81d65-308">Extract the `tid` claim from the id_token of a previous sign-in to determine which value to use.</span></span>  <span data-ttu-id="81d65-309">If the `tid` claim value is `9188040d-6c67-4c5b-b112-36a304b66dad`, you should use `domain_hint=consumers`.</span><span class="sxs-lookup"><span data-stu-id="81d65-309">If the `tid` claim value is `9188040d-6c67-4c5b-b112-36a304b66dad`, you should use `domain_hint=consumers`.</span></span>  <span data-ttu-id="81d65-310">Otherwise, use `domain_hint=organizations`.</span><span class="sxs-lookup"><span data-stu-id="81d65-310">Otherwise, use `domain_hint=organizations`.</span></span> |

<span data-ttu-id="81d65-311">By setting the `prompt=none` parameter, this request will either succeed or fail immediately and return to your application.</span><span class="sxs-lookup"><span data-stu-id="81d65-311">By setting the `prompt=none` parameter, this request will either succeed or fail immediately and return to your application.</span></span>  <span data-ttu-id="81d65-312">A successful response will be sent to your app at the indicated `redirect_uri`, using the method specified in the `response_mode` parameter.</span><span class="sxs-lookup"><span data-stu-id="81d65-312">A successful response will be sent to your app at the indicated `redirect_uri`, using the method specified in the `response_mode` parameter.</span></span>

#### <a name="successful-response"></a><span data-ttu-id="81d65-313">Successful response</span><span class="sxs-lookup"><span data-stu-id="81d65-313">Successful response</span></span>
<span data-ttu-id="81d65-314">A successful response using `response_mode=fragment` looks like:</span><span class="sxs-lookup"><span data-stu-id="81d65-314">A successful response using `response_mode=fragment` looks like:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
access_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...
&state=arbitrary_data_you_sent_earlier
&token_type=Bearer
&expires_in=3599
&scope=https%3A%2F%2Fapi.contoso.com%2Ftasks.read
```

| <span data-ttu-id="81d65-315">Parameter</span><span class="sxs-lookup"><span data-stu-id="81d65-315">Parameter</span></span> | <span data-ttu-id="81d65-316">Description</span><span class="sxs-lookup"><span data-stu-id="81d65-316">Description</span></span> |
| --- | --- |
| <span data-ttu-id="81d65-317">access_token</span><span class="sxs-lookup"><span data-stu-id="81d65-317">access_token</span></span> |<span data-ttu-id="81d65-318">The token that the app requested.</span><span class="sxs-lookup"><span data-stu-id="81d65-318">The token that the app requested.</span></span> |
| <span data-ttu-id="81d65-319">token_type</span><span class="sxs-lookup"><span data-stu-id="81d65-319">token_type</span></span> |<span data-ttu-id="81d65-320">Will always be `Bearer`.</span><span class="sxs-lookup"><span data-stu-id="81d65-320">Will always be `Bearer`.</span></span> |
| <span data-ttu-id="81d65-321">state</span><span class="sxs-lookup"><span data-stu-id="81d65-321">state</span></span> |<span data-ttu-id="81d65-322">If a state parameter is included in the request, the same value should appear in the response.</span><span class="sxs-lookup"><span data-stu-id="81d65-322">If a state parameter is included in the request, the same value should appear in the response.</span></span> <span data-ttu-id="81d65-323">The app should verify that the state values in the request and response are identical.</span><span class="sxs-lookup"><span data-stu-id="81d65-323">The app should verify that the state values in the request and response are identical.</span></span> |
| <span data-ttu-id="81d65-324">expires_in</span><span class="sxs-lookup"><span data-stu-id="81d65-324">expires_in</span></span> |<span data-ttu-id="81d65-325">How long the access token is valid (in seconds).</span><span class="sxs-lookup"><span data-stu-id="81d65-325">How long the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="81d65-326">scope</span><span class="sxs-lookup"><span data-stu-id="81d65-326">scope</span></span> |<span data-ttu-id="81d65-327">The scopes that the access token is valid for.</span><span class="sxs-lookup"><span data-stu-id="81d65-327">The scopes that the access token is valid for.</span></span> |

#### <a name="error-response"></a><span data-ttu-id="81d65-328">Error response</span><span class="sxs-lookup"><span data-stu-id="81d65-328">Error response</span></span>
<span data-ttu-id="81d65-329">Error responses may also be sent to the `redirect_uri` so the app can handle them appropriately.</span><span class="sxs-lookup"><span data-stu-id="81d65-329">Error responses may also be sent to the `redirect_uri` so the app can handle them appropriately.</span></span>  <span data-ttu-id="81d65-330">In the case of `prompt=none`, an expected error will be:</span><span class="sxs-lookup"><span data-stu-id="81d65-330">In the case of `prompt=none`, an expected error will be:</span></span>

```
GET https://aadb2cplayground.azurewebsites.net/#
error=user_authentication_required
&error_description=the+request+could+not+be+completed+silently
```

| <span data-ttu-id="81d65-331">Parameter</span><span class="sxs-lookup"><span data-stu-id="81d65-331">Parameter</span></span> | <span data-ttu-id="81d65-332">Description</span><span class="sxs-lookup"><span data-stu-id="81d65-332">Description</span></span> |
| --- | --- |
| <span data-ttu-id="81d65-333">error</span><span class="sxs-lookup"><span data-stu-id="81d65-333">error</span></span> |<span data-ttu-id="81d65-334">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span><span class="sxs-lookup"><span data-stu-id="81d65-334">An error code string that can be used to classify types of errors that occur, and can be used to react to errors.</span></span> |
| <span data-ttu-id="81d65-335">error_description</span><span class="sxs-lookup"><span data-stu-id="81d65-335">error_description</span></span> |<span data-ttu-id="81d65-336">A specific error message that can help a developer identify the root cause of an authentication error.</span><span class="sxs-lookup"><span data-stu-id="81d65-336">A specific error message that can help a developer identify the root cause of an authentication error.</span></span> |

<span data-ttu-id="81d65-337">If you receive this error in the iframe request, the user must interactively sign in again to retrieve a new token.</span><span class="sxs-lookup"><span data-stu-id="81d65-337">If you receive this error in the iframe request, the user must interactively sign in again to retrieve a new token.</span></span>  <span data-ttu-id="81d65-338">You can choose to handle this case in whatever way makes sense for your application.</span><span class="sxs-lookup"><span data-stu-id="81d65-338">You can choose to handle this case in whatever way makes sense for your application.</span></span>

## <a name="refreshing-tokens"></a><span data-ttu-id="81d65-339">Refreshing tokens</span><span class="sxs-lookup"><span data-stu-id="81d65-339">Refreshing tokens</span></span>
<span data-ttu-id="81d65-340">Both `id_token`s and `access_token`s expires after a short period of time, so your app must be prepared to refresh these tokens periodically.</span><span class="sxs-lookup"><span data-stu-id="81d65-340">Both `id_token`s and `access_token`s expires after a short period of time, so your app must be prepared to refresh these tokens periodically.</span></span>  <span data-ttu-id="81d65-341">To refresh either type of token, perform the same hidden iframe request from above using the `prompt=none` parameter to control Azure AD's behavior.</span><span class="sxs-lookup"><span data-stu-id="81d65-341">To refresh either type of token, perform the same hidden iframe request from above using the `prompt=none` parameter to control Azure AD's behavior.</span></span>  <span data-ttu-id="81d65-342">To receive a new `id_token`, be sure to use `response_type=id_token` and `scope=openid`, as well as a `nonce` parameter.</span><span class="sxs-lookup"><span data-stu-id="81d65-342">To receive a new `id_token`, be sure to use `response_type=id_token` and `scope=openid`, as well as a `nonce` parameter.</span></span>

## <a name="send-a-sign-out-request"></a><span data-ttu-id="81d65-343">Send a sign-out request</span><span class="sxs-lookup"><span data-stu-id="81d65-343">Send a sign-out request</span></span>
<span data-ttu-id="81d65-344">When you want to sign the user out of the app, redirect the user to Azure AD to sign out. If you fail to do so, the user might be able to reauthenticate to your app without entering their credentials again.</span><span class="sxs-lookup"><span data-stu-id="81d65-344">When you want to sign the user out of the app, redirect the user to Azure AD to sign out. If you fail to do so, the user might be able to reauthenticate to your app without entering their credentials again.</span></span> <span data-ttu-id="81d65-345">This is because they will have a valid single sign-on session with Azure AD.</span><span class="sxs-lookup"><span data-stu-id="81d65-345">This is because they will have a valid single sign-on session with Azure AD.</span></span>

<span data-ttu-id="81d65-346">You can simply redirect the user to the `end_session_endpoint` that is listed in the same OpenID Connect metadata document described in the earlier section "Validate the id_token":</span><span class="sxs-lookup"><span data-stu-id="81d65-346">You can simply redirect the user to the `end_session_endpoint` that is listed in the same OpenID Connect metadata document described in the earlier section "Validate the id_token":</span></span>

```
GET https://login.microsoftonline.com/fabrikamb2c.onmicrosoft.com/oauth2/v2.0/logout?
p=b2c_1_sign_in
&post_logout_redirect_uri=https%3A%2F%2Faadb2cplayground.azurewebsites.net%2F
```

| <span data-ttu-id="81d65-347">Parameter</span><span class="sxs-lookup"><span data-stu-id="81d65-347">Parameter</span></span> | <span data-ttu-id="81d65-348">Required?</span><span class="sxs-lookup"><span data-stu-id="81d65-348">Required?</span></span> | <span data-ttu-id="81d65-349">Description</span><span class="sxs-lookup"><span data-stu-id="81d65-349">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="81d65-350">p</span><span class="sxs-lookup"><span data-stu-id="81d65-350">p</span></span> |<span data-ttu-id="81d65-351">Required</span><span class="sxs-lookup"><span data-stu-id="81d65-351">Required</span></span> |<span data-ttu-id="81d65-352">The policy to use to sign the user out of your application.</span><span class="sxs-lookup"><span data-stu-id="81d65-352">The policy to use to sign the user out of your application.</span></span> |
| <span data-ttu-id="81d65-353">post_logout_redirect_uri</span><span class="sxs-lookup"><span data-stu-id="81d65-353">post_logout_redirect_uri</span></span> |<span data-ttu-id="81d65-354">Recommended</span><span class="sxs-lookup"><span data-stu-id="81d65-354">Recommended</span></span> |<span data-ttu-id="81d65-355">The URL that the user should be redirected to after successful sign-out. If it is not included, the user will be shown a generic message by Azure AD B2C.</span><span class="sxs-lookup"><span data-stu-id="81d65-355">The URL that the user should be redirected to after successful sign-out. If it is not included, the user will be shown a generic message by Azure AD B2C.</span></span> |

> [!NOTE]
> <span data-ttu-id="81d65-356">While directing the user to the `end_session_endpoint` clears some of the user's single sign-on state with Azure AD B2C, it does not sign the user out of the user's social identity provider (IDP) session.</span><span class="sxs-lookup"><span data-stu-id="81d65-356">While directing the user to the `end_session_endpoint` clears some of the user's single sign-on state with Azure AD B2C, it does not sign the user out of the user's social identity provider (IDP) session.</span></span> <span data-ttu-id="81d65-357">If the user selects the same IDP during a subsequent sign-in, they will be reauthenticated, without entering their credentials.</span><span class="sxs-lookup"><span data-stu-id="81d65-357">If the user selects the same IDP during a subsequent sign-in, they will be reauthenticated, without entering their credentials.</span></span> <span data-ttu-id="81d65-358">If a user wants to sign out of your B2C application, it does not necessarily mean they want to sign out of their Facebook account entirely.</span><span class="sxs-lookup"><span data-stu-id="81d65-358">If a user wants to sign out of your B2C application, it does not necessarily mean they want to sign out of their Facebook account entirely.</span></span> <span data-ttu-id="81d65-359">However, in the case of local accounts, the user's session will be ended properly.</span><span class="sxs-lookup"><span data-stu-id="81d65-359">However, in the case of local accounts, the user's session will be ended properly.</span></span>
> 
> 

## <a name="use-your-own-b2c-tenant"></a><span data-ttu-id="81d65-360">Use your own B2C tenant</span><span class="sxs-lookup"><span data-stu-id="81d65-360">Use your own B2C tenant</span></span>
<span data-ttu-id="81d65-361">If you want to try these requests for yourself, you must first perform these three steps, and then replace the example values above with your own:</span><span class="sxs-lookup"><span data-stu-id="81d65-361">If you want to try these requests for yourself, you must first perform these three steps, and then replace the example values above with your own:</span></span>

* <span data-ttu-id="81d65-362">[Create a B2C tenant](active-directory-b2c-get-started.md), and use the name of your tenant in the requests.</span><span class="sxs-lookup"><span data-stu-id="81d65-362">[Create a B2C tenant](active-directory-b2c-get-started.md), and use the name of your tenant in the requests.</span></span>
* <span data-ttu-id="81d65-363">[Create an application](active-directory-b2c-app-registration.md) to obtain an application ID and a redirect_uri.</span><span class="sxs-lookup"><span data-stu-id="81d65-363">[Create an application](active-directory-b2c-app-registration.md) to obtain an application ID and a redirect_uri.</span></span> <span data-ttu-id="81d65-364">You will want to include a **web app/web api** in your app, and optionally create an **application secret**.</span><span class="sxs-lookup"><span data-stu-id="81d65-364">You will want to include a **web app/web api** in your app, and optionally create an **application secret**.</span></span>
* <span data-ttu-id="81d65-365">[Create your policies](active-directory-b2c-reference-policies.md) to obtain your policy names.</span><span class="sxs-lookup"><span data-stu-id="81d65-365">[Create your policies](active-directory-b2c-reference-policies.md) to obtain your policy names.</span></span>

## <a name="samples"></a><span data-ttu-id="81d65-366">Samples</span><span class="sxs-lookup"><span data-stu-id="81d65-366">Samples</span></span>

* [<span data-ttu-id="81d65-367">Create a single-page app using Node.JS</span><span class="sxs-lookup"><span data-stu-id="81d65-367">Create a single-page app using Node.JS</span></span>](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-nodejs-webapi)
* [<span data-ttu-id="81d65-368">Create a single-page app using .NET</span><span class="sxs-lookup"><span data-stu-id="81d65-368">Create a single-page app using .NET</span></span>](https://github.com/Azure-Samples/active-directory-b2c-javascript-singlepageapp-dotnet-webapi)


