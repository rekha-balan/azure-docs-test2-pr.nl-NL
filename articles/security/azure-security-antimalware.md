---
title: Microsoft Antimalware for Azure | Microsoft Docs
description: This article provides an architectural overview of Microsoft Antimalware for Azure, including supported scenarios and configurations for enabling, configuring, and deploying protection for Azure Cloud Services and Virtual Machines. We will cover basic configuration, management, and monitoring functionality accessible through Microsoft Azure service management API’s, PowerShell scripts, the Azure portal and Visual Studio.
services: security
documentationcenter: na
author: YuriDio
manager: swadhwa
editor: ''
ms.assetid: 265683c8-30d7-4f2b-b66c-5082a18f7a8b
ms.service: security
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: na
ms.date: 03/15/2017
ms.author: yurid
ms.openlocfilehash: 70607f66d9dfb8ea88c2a9f95c545e8cd7827ceb
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44556738"
---
# <a name="microsoft-antimalware-for-azure-cloud-services-and-virtual-machines"></a><span data-ttu-id="6b235-104">Microsoft Antimalware for Azure Cloud Services and Virtual Machines</span><span class="sxs-lookup"><span data-stu-id="6b235-104">Microsoft Antimalware for Azure Cloud Services and Virtual Machines</span></span>
<span data-ttu-id="6b235-105">The modern threat landscape for cloud environments is extremely dynamic, increasing the pressure on business IT cloud subscribers to maintain effective protection in order to meet compliance and security requirements.</span><span class="sxs-lookup"><span data-stu-id="6b235-105">The modern threat landscape for cloud environments is extremely dynamic, increasing the pressure on business IT cloud subscribers to maintain effective protection in order to meet compliance and security requirements.</span></span> <span data-ttu-id="6b235-106">Microsoft Antimalware for Azure is free real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on your Azure systems.</span><span class="sxs-lookup"><span data-stu-id="6b235-106">Microsoft Antimalware for Azure is free real-time protection capability that helps identify and remove viruses, spyware, and other malicious software, with configurable alerts when known malicious or unwanted software attempts to install itself or run on your Azure systems.</span></span>

<span data-ttu-id="6b235-107">The solution is built on the same antimalware platform as Microsoft Security Essentials \[MSE\], Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune, and Windows Defender for Windows 8.0 and higher.</span><span class="sxs-lookup"><span data-stu-id="6b235-107">The solution is built on the same antimalware platform as Microsoft Security Essentials \[MSE\], Microsoft Forefront Endpoint Protection, Microsoft System Center Endpoint Protection, Windows Intune, and Windows Defender for Windows 8.0 and higher.</span></span> <span data-ttu-id="6b235-108">Microsoft Antimalware for Azure is a single-agent solution for applications and tenant environments, designed to run in the background without human intervention.</span><span class="sxs-lookup"><span data-stu-id="6b235-108">Microsoft Antimalware for Azure is a single-agent solution for applications and tenant environments, designed to run in the background without human intervention.</span></span> <span data-ttu-id="6b235-109">You can deploy protection based on the needs of your application workloads, with either basic secure-by-default or advanced custom configuration, including antimalware monitoring.</span><span class="sxs-lookup"><span data-stu-id="6b235-109">You can deploy protection based on the needs of your application workloads, with either basic secure-by-default or advanced custom configuration, including antimalware monitoring.</span></span>

<span data-ttu-id="6b235-110">When you deploy and enable Microsoft Antimalware for Azure for your applications, the following core features are available:</span><span class="sxs-lookup"><span data-stu-id="6b235-110">When you deploy and enable Microsoft Antimalware for Azure for your applications, the following core features are available:</span></span>

* <span data-ttu-id="6b235-111">**Real-time protection** - monitors activity in Cloud Services and on Virtual Machines to detect and block malware execution.</span><span class="sxs-lookup"><span data-stu-id="6b235-111">**Real-time protection** - monitors activity in Cloud Services and on Virtual Machines to detect and block malware execution.</span></span>
* <span data-ttu-id="6b235-112">**Scheduled scanning** - periodically performs targeted scanning to detect malware, including actively running programs.</span><span class="sxs-lookup"><span data-stu-id="6b235-112">**Scheduled scanning** - periodically performs targeted scanning to detect malware, including actively running programs.</span></span>
* <span data-ttu-id="6b235-113">**Malware remediation** - automatically takes action on detected malware, such as deleting or quarantining malicious files and cleaning up malicious registry entries.</span><span class="sxs-lookup"><span data-stu-id="6b235-113">**Malware remediation** - automatically takes action on detected malware, such as deleting or quarantining malicious files and cleaning up malicious registry entries.</span></span>
* <span data-ttu-id="6b235-114">**Signature updates** - automatically installs the latest protection signatures (virus definitions) to ensure protection is up-to-date on a pre-determined frequency.</span><span class="sxs-lookup"><span data-stu-id="6b235-114">**Signature updates** - automatically installs the latest protection signatures (virus definitions) to ensure protection is up-to-date on a pre-determined frequency.</span></span>
* <span data-ttu-id="6b235-115">**Antimalware Engine updates** – automatically updates the Microsoft Antimalware engine.</span><span class="sxs-lookup"><span data-stu-id="6b235-115">**Antimalware Engine updates** – automatically updates the Microsoft Antimalware engine.</span></span>
* <span data-ttu-id="6b235-116">**Antimalware Platform updates** – automatically updates the Microsoft Antimalware platform.</span><span class="sxs-lookup"><span data-stu-id="6b235-116">**Antimalware Platform updates** – automatically updates the Microsoft Antimalware platform.</span></span>
* <span data-ttu-id="6b235-117">**Active protection** - reports telemetry metadata about detected threats and suspicious resources to Microsoft Azure to ensure rapid response to the evolving threat landscape, as well as enabling real-time synchronous signature delivery through the Microsoft Active Protection System (MAPS).</span><span class="sxs-lookup"><span data-stu-id="6b235-117">**Active protection** - reports telemetry metadata about detected threats and suspicious resources to Microsoft Azure to ensure rapid response to the evolving threat landscape, as well as enabling real-time synchronous signature delivery through the Microsoft Active Protection System (MAPS).</span></span>
* <span data-ttu-id="6b235-118">**Samples reporting** - provides and reports samples to the Microsoft Antimalware service to help refine the service and enable troubleshooting.</span><span class="sxs-lookup"><span data-stu-id="6b235-118">**Samples reporting** - provides and reports samples to the Microsoft Antimalware service to help refine the service and enable troubleshooting.</span></span>
* <span data-ttu-id="6b235-119">**Exclusions** – allows application and service administrators to configure certain files, processes, and drives to exclude them from protection and scanning for performance and/or other reasons.</span><span class="sxs-lookup"><span data-stu-id="6b235-119">**Exclusions** – allows application and service administrators to configure certain files, processes, and drives to exclude them from protection and scanning for performance and/or other reasons.</span></span>
* <span data-ttu-id="6b235-120">**Antimalware event collection** - records the antimalware service health, suspicious activities, and remediation actions taken in the operating system event log and collects them into the customer’s Azure Storage account.</span><span class="sxs-lookup"><span data-stu-id="6b235-120">**Antimalware event collection** - records the antimalware service health, suspicious activities, and remediation actions taken in the operating system event log and collects them into the customer’s Azure Storage account.</span></span>

> [!NOTE]
> <span data-ttu-id="6b235-121">Microsoft Antimalware can also be deployed using Azure Security Center.</span><span class="sxs-lookup"><span data-stu-id="6b235-121">Microsoft Antimalware can also be deployed using Azure Security Center.</span></span> <span data-ttu-id="6b235-122">Read [Install Endpoint Protection in Azure Security Center](../security-center/security-center-install-endpoint-protection.md) for more information.</span><span class="sxs-lookup"><span data-stu-id="6b235-122">Read [Install Endpoint Protection in Azure Security Center](../security-center/security-center-install-endpoint-protection.md) for more information.</span></span>
>
>

## <a name="architecture"></a><span data-ttu-id="6b235-123">Architecture</span><span class="sxs-lookup"><span data-stu-id="6b235-123">Architecture</span></span>
<span data-ttu-id="6b235-124">The Microsoft Antimalware for Azure solution includes the Microsoft Antimalware Client and Service, Antimalware classic deployment model, Antimalware PowerShell cmdlets and Azure Diagnostics Extension.</span><span class="sxs-lookup"><span data-stu-id="6b235-124">The Microsoft Antimalware for Azure solution includes the Microsoft Antimalware Client and Service, Antimalware classic deployment model, Antimalware PowerShell cmdlets and Azure Diagnostics Extension.</span></span> <span data-ttu-id="6b235-125">The Microsoft Antimalware solution is supported on Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2 operating system families.</span><span class="sxs-lookup"><span data-stu-id="6b235-125">The Microsoft Antimalware solution is supported on Windows Server 2008 R2, Windows Server 2012, and Windows Server 2012 R2 operating system families.</span></span> <span data-ttu-id="6b235-126">It is not supported on the Windows Server 2008 operating system.</span><span class="sxs-lookup"><span data-stu-id="6b235-126">It is not supported on the Windows Server 2008 operating system.</span></span> <span data-ttu-id="6b235-127">Support for Windows Server 2016 with Defender has been released, you can read more about this update [here](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).</span><span class="sxs-lookup"><span data-stu-id="6b235-127">Support for Windows Server 2016 with Defender has been released, you can read more about this update [here](https://blogs.msdn.microsoft.com/azuresecurity/2017/03/07/update-to-azure-antimalware-extension-for-cloud-services/).</span></span>

<span data-ttu-id="6b235-128">The Microsoft Antimalware Client and Service is installed by default in a disabled state in all supported Azure guest operating system families in the Cloud Services platform.</span><span class="sxs-lookup"><span data-stu-id="6b235-128">The Microsoft Antimalware Client and Service is installed by default in a disabled state in all supported Azure guest operating system families in the Cloud Services platform.</span></span> <span data-ttu-id="6b235-129">The Microsoft Antimalware Client and Service is not installed by default in the Virtual Machines platform and is available as an optional feature through the Azure portal and Visual Studio Virtual Machine configuration under Security Extensions.</span><span class="sxs-lookup"><span data-stu-id="6b235-129">The Microsoft Antimalware Client and Service is not installed by default in the Virtual Machines platform and is available as an optional feature through the Azure portal and Visual Studio Virtual Machine configuration under Security Extensions.</span></span>

<span data-ttu-id="6b235-130">When using Azure Websites, the underlying service that hosts the web app has Microsoft Antimalware enabled on it.</span><span class="sxs-lookup"><span data-stu-id="6b235-130">When using Azure Websites, the underlying service that hosts the web app has Microsoft Antimalware enabled on it.</span></span> <span data-ttu-id="6b235-131">This is used to protect Azure Websites infrastructure and does not run on customer content.</span><span class="sxs-lookup"><span data-stu-id="6b235-131">This is used to protect Azure Websites infrastructure and does not run on customer content.</span></span>

### <a name="microsoft-antimalware-workflow"></a><span data-ttu-id="6b235-132">Microsoft antimalware workflow</span><span class="sxs-lookup"><span data-stu-id="6b235-132">Microsoft antimalware workflow</span></span>
<span data-ttu-id="6b235-133">The Azure service administrator can enable Antimalware for Azure with a default or custom configuration for your Virtual Machines and Cloud Services using the following options:</span><span class="sxs-lookup"><span data-stu-id="6b235-133">The Azure service administrator can enable Antimalware for Azure with a default or custom configuration for your Virtual Machines and Cloud Services using the following options:</span></span>

* <span data-ttu-id="6b235-134">Virtual Machines – In the Azure portal, under **Security Extensions**</span><span class="sxs-lookup"><span data-stu-id="6b235-134">Virtual Machines – In the Azure portal, under **Security Extensions**</span></span>
* <span data-ttu-id="6b235-135">Virtual Machines – Using the Visual Studio virtual machines configuration in Server Explorer</span><span class="sxs-lookup"><span data-stu-id="6b235-135">Virtual Machines – Using the Visual Studio virtual machines configuration in Server Explorer</span></span>
* <span data-ttu-id="6b235-136">Virtual Machines and Cloud Services – Using the Antimalware [classic deployment model](https://msdn.microsoft.com/library/azure/ee460799.aspx)</span><span class="sxs-lookup"><span data-stu-id="6b235-136">Virtual Machines and Cloud Services – Using the Antimalware [classic deployment model](https://msdn.microsoft.com/library/azure/ee460799.aspx)</span></span>
* <span data-ttu-id="6b235-137">Virtual Machines and Cloud Services – Using Antimalware PowerShell cmdlets</span><span class="sxs-lookup"><span data-stu-id="6b235-137">Virtual Machines and Cloud Services – Using Antimalware PowerShell cmdlets</span></span>

<span data-ttu-id="6b235-138">The Azure portal or PowerShell cmdlets push the Antimalware extension package file to the Azure system at a pre-determined fixed location.</span><span class="sxs-lookup"><span data-stu-id="6b235-138">The Azure portal or PowerShell cmdlets push the Antimalware extension package file to the Azure system at a pre-determined fixed location.</span></span> <span data-ttu-id="6b235-139">The Azure Guest Agent (or the Fabric Agent) launches the Antimalware Extension, applying the Antimalware configuration settings supplied as input.</span><span class="sxs-lookup"><span data-stu-id="6b235-139">The Azure Guest Agent (or the Fabric Agent) launches the Antimalware Extension, applying the Antimalware configuration settings supplied as input.</span></span> <span data-ttu-id="6b235-140">This step enables the Antimalware service with either default or custom configuration settings.</span><span class="sxs-lookup"><span data-stu-id="6b235-140">This step enables the Antimalware service with either default or custom configuration settings.</span></span> <span data-ttu-id="6b235-141">If no custom configuration is provided, then the antimalware service is enabled with the default configuration settings.</span><span class="sxs-lookup"><span data-stu-id="6b235-141">If no custom configuration is provided, then the antimalware service is enabled with the default configuration settings.</span></span> <span data-ttu-id="6b235-142">Refer to the *Antimalware configuration* section in the [Microsoft Antimalware for Azure – Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure Cloud Services and VMs Code Samples") for more details.</span><span class="sxs-lookup"><span data-stu-id="6b235-142">Refer to the *Antimalware configuration* section in the [Microsoft Antimalware for Azure – Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure Cloud Services and VMs Code Samples") for more details.</span></span>

<span data-ttu-id="6b235-143">Once running, the Microsoft Antimalware client downloads the latest protection engine and signature definitions from the Internet and loads them on the Azure system.</span><span class="sxs-lookup"><span data-stu-id="6b235-143">Once running, the Microsoft Antimalware client downloads the latest protection engine and signature definitions from the Internet and loads them on the Azure system.</span></span> <span data-ttu-id="6b235-144">The Microsoft Antimalware service writes service-related events to the system OS events log under the “Microsoft Antimalware” event source.</span><span class="sxs-lookup"><span data-stu-id="6b235-144">The Microsoft Antimalware service writes service-related events to the system OS events log under the “Microsoft Antimalware” event source.</span></span> <span data-ttu-id="6b235-145">Events include the Antimalware client health state, protection and remediation status, new and old configuration settings, engine updates and signature definitions, and others.</span><span class="sxs-lookup"><span data-stu-id="6b235-145">Events include the Antimalware client health state, protection and remediation status, new and old configuration settings, engine updates and signature definitions, and others.</span></span>

<span data-ttu-id="6b235-146">You can enable Antimalware monitoring for your Cloud Service or Virtual Machine to have the Antimalware event log events written as they are produced to your Azure storage account.</span><span class="sxs-lookup"><span data-stu-id="6b235-146">You can enable Antimalware monitoring for your Cloud Service or Virtual Machine to have the Antimalware event log events written as they are produced to your Azure storage account.</span></span> <span data-ttu-id="6b235-147">The Antimalware Service uses the Azure Diagnostics extension to collect Antimalware events from the Azure system into tables in the customer’s Azure Storage account.</span><span class="sxs-lookup"><span data-stu-id="6b235-147">The Antimalware Service uses the Azure Diagnostics extension to collect Antimalware events from the Azure system into tables in the customer’s Azure Storage account.</span></span>

<span data-ttu-id="6b235-148">The deployment workflow including configuration steps and options supported for the above scenarios are documented in [Antimalware deployment scenarios](#_Antimalware_Deployment_Scenarios) section of this document.</span><span class="sxs-lookup"><span data-stu-id="6b235-148">The deployment workflow including configuration steps and options supported for the above scenarios are documented in [Antimalware deployment scenarios](#_Antimalware_Deployment_Scenarios) section of this document.</span></span>

![Microsoft Antimalware in Azure](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-fig1.PNG)

> [!NOTE]
> <span data-ttu-id="6b235-150">You can however use Powershell/APIs and Azure Resource Manager templates to deploy Virtual Machine Scale Sets with the Microsoft Anti-Malware extension.</span><span class="sxs-lookup"><span data-stu-id="6b235-150">You can however use Powershell/APIs and Azure Resource Manager templates to deploy Virtual Machine Scale Sets with the Microsoft Anti-Malware extension.</span></span>  <span data-ttu-id="6b235-151">For installing an extension on an already running Virtual Machine, you can use the sample python script *vmssextn.py* located [here](https://github.com/gbowerman/vmsstools).</span><span class="sxs-lookup"><span data-stu-id="6b235-151">For installing an extension on an already running Virtual Machine, you can use the sample python script *vmssextn.py* located [here](https://github.com/gbowerman/vmsstools).</span></span> <span data-ttu-id="6b235-152">This script gets the existing extension config on the Scale Set and adds an extension to the list of existing extensions on the VM Scale Sets.</span><span class="sxs-lookup"><span data-stu-id="6b235-152">This script gets the existing extension config on the Scale Set and adds an extension to the list of existing extensions on the VM Scale Sets.</span></span>
>
>

### <a name="default-and-custom-antimalware-configuration"></a><span data-ttu-id="6b235-153">Default and Custom Antimalware Configuration</span><span class="sxs-lookup"><span data-stu-id="6b235-153">Default and Custom Antimalware Configuration</span></span>
<span data-ttu-id="6b235-154">The default configuration settings are applied to enable Antimalware for Azure Cloud Services or Virtual Machines when you do not provide custom configuration settings.</span><span class="sxs-lookup"><span data-stu-id="6b235-154">The default configuration settings are applied to enable Antimalware for Azure Cloud Services or Virtual Machines when you do not provide custom configuration settings.</span></span> <span data-ttu-id="6b235-155">The default configuration settings have been pre-optimized for running in the Azure environment.</span><span class="sxs-lookup"><span data-stu-id="6b235-155">The default configuration settings have been pre-optimized for running in the Azure environment.</span></span> <span data-ttu-id="6b235-156">Optionally, you can customize these default configuration settings as required for your Azure application or service deployment and apply them for other deployment scenarios.</span><span class="sxs-lookup"><span data-stu-id="6b235-156">Optionally, you can customize these default configuration settings as required for your Azure application or service deployment and apply them for other deployment scenarios.</span></span>

> [!NOTE]
> <span data-ttu-id="6b235-157">By default the Microsoft Antimalware User Interface on Azure Resource Manager is disabled, [cleanuppolicy.xml](https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/) file to bypass this error message is not supported.</span><span class="sxs-lookup"><span data-stu-id="6b235-157">By default the Microsoft Antimalware User Interface on Azure Resource Manager is disabled, [cleanuppolicy.xml](https://blogs.msdn.microsoft.com/azuresecurity/2016/02/24/update-on-microsoft-antimalware-and-azure-resource-manager-arm-vms/) file to bypass this error message is not supported.</span></span> <span data-ttu-id="6b235-158">For information on how to create a custom policy, read [Enabling Microsoft Antimalware User Interface on Azure Resource Manager VMs Post Deployment](https://blogs.msdn.microsoft.com/azuresecurity/2016/03/09/enabling-microsoft-antimalware-user-interface-post-deployment/).</span><span class="sxs-lookup"><span data-stu-id="6b235-158">For information on how to create a custom policy, read [Enabling Microsoft Antimalware User Interface on Azure Resource Manager VMs Post Deployment](https://blogs.msdn.microsoft.com/azuresecurity/2016/03/09/enabling-microsoft-antimalware-user-interface-post-deployment/).</span></span>
>
>

<span data-ttu-id="6b235-159">The following table summarizes the configuration settings available for the Antimalware service.</span><span class="sxs-lookup"><span data-stu-id="6b235-159">The following table summarizes the configuration settings available for the Antimalware service.</span></span> <span data-ttu-id="6b235-160">The default configuration settings are marked under the column labeled “Default” below.</span><span class="sxs-lookup"><span data-stu-id="6b235-160">The default configuration settings are marked under the column labeled “Default” below.</span></span>

![Table 1](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-tb18.PNG)

## <a name="antimalware-deployment-scenarios"></a><span data-ttu-id="6b235-162">Antimalware Deployment Scenarios</span><span class="sxs-lookup"><span data-stu-id="6b235-162">Antimalware Deployment Scenarios</span></span>
<span data-ttu-id="6b235-163">The scenarios to enable and configure antimalware, including monitoring for Azure Cloud Services and Virtual Machines, are discussed in this section.</span><span class="sxs-lookup"><span data-stu-id="6b235-163">The scenarios to enable and configure antimalware, including monitoring for Azure Cloud Services and Virtual Machines, are discussed in this section.</span></span>

### <a name="virtual-machines---enable-and-configure-antimalware"></a><span data-ttu-id="6b235-164">Virtual machines - enable and configure antimalware</span><span class="sxs-lookup"><span data-stu-id="6b235-164">Virtual machines - enable and configure antimalware</span></span>
<span data-ttu-id="6b235-165">**Deployment using Azure Portal**</span><span class="sxs-lookup"><span data-stu-id="6b235-165">**Deployment using Azure Portal**</span></span>

<span data-ttu-id="6b235-166">To enable the Antimalware service, click **Add** on the Extensions blade, select **Microsoft Antimalware** on the New resource blade, click **Create** on the Microsoft Antimalware blade.</span><span class="sxs-lookup"><span data-stu-id="6b235-166">To enable the Antimalware service, click **Add** on the Extensions blade, select **Microsoft Antimalware** on the New resource blade, click **Create** on the Microsoft Antimalware blade.</span></span> <span data-ttu-id="6b235-167">Click **Create** without inputting any configuration values to enable Antimalware with the default settings, or enter the Antimalware configuration settings for the Virtual Machine configured as shown in Figure 2 below.</span><span class="sxs-lookup"><span data-stu-id="6b235-167">Click **Create** without inputting any configuration values to enable Antimalware with the default settings, or enter the Antimalware configuration settings for the Virtual Machine configured as shown in Figure 2 below.</span></span> <span data-ttu-id="6b235-168">Please refer to the **tooltips** provided with each configuration setting on the Add Extension blade to see the supported configuration values.</span><span class="sxs-lookup"><span data-stu-id="6b235-168">Please refer to the **tooltips** provided with each configuration setting on the Add Extension blade to see the supported configuration values.</span></span>

![Virtual Machine configuration settings for Microsoft Antimalware](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-fig2.PNG)

<span data-ttu-id="6b235-170">**Deployment using the Azure classic portal**</span><span class="sxs-lookup"><span data-stu-id="6b235-170">**Deployment using the Azure classic portal**</span></span>

<span data-ttu-id="6b235-171">To enable and configure Microsoft Antimalware for Azure Virtual Machines using the Azure portal while provisioning a Virtual Machine, follow the steps below:</span><span class="sxs-lookup"><span data-stu-id="6b235-171">To enable and configure Microsoft Antimalware for Azure Virtual Machines using the Azure portal while provisioning a Virtual Machine, follow the steps below:</span></span>

<span data-ttu-id="6b235-172">1.Log onto the Azure portal at <https://portal.azure.com></span><span class="sxs-lookup"><span data-stu-id="6b235-172">1.Log onto the Azure portal at <https://portal.azure.com></span></span>

<span data-ttu-id="6b235-173">2.To create a new virtual machine, click **New**, **Compute**, **Virtual** **Machine**, **From Gallery** (do not use Quick Create) as shown below:</span><span class="sxs-lookup"><span data-stu-id="6b235-173">2.To create a new virtual machine, click **New**, **Compute**, **Virtual** **Machine**, **From Gallery** (do not use Quick Create) as shown below:</span></span>

![New Virtual Machine](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-fig3.PNG)

<span data-ttu-id="6b235-175">3.Select the **Microsoft Windows Server** image on the **Choose an Image** page.</span><span class="sxs-lookup"><span data-stu-id="6b235-175">3.Select the **Microsoft Windows Server** image on the **Choose an Image** page.</span></span>

<span data-ttu-id="6b235-176">4.Click the right arrow and input the Virtual Machine configuration.</span><span class="sxs-lookup"><span data-stu-id="6b235-176">4.Click the right arrow and input the Virtual Machine configuration.</span></span>

<span data-ttu-id="6b235-177">5.Check the **Microsoft Antimalware** checkbox under **Security Extensions** on the Virtual Machine configuration page.</span><span class="sxs-lookup"><span data-stu-id="6b235-177">5.Check the **Microsoft Antimalware** checkbox under **Security Extensions** on the Virtual Machine configuration page.</span></span>

<span data-ttu-id="6b235-178">6.Click the Submit button to enable and configure Microsoft Antimalware for Azure Virtual Machines with the default configuration settings.</span><span class="sxs-lookup"><span data-stu-id="6b235-178">6.Click the Submit button to enable and configure Microsoft Antimalware for Azure Virtual Machines with the default configuration settings.</span></span>

![Virtual Machine configuration](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-fig4.PNG)

<span data-ttu-id="6b235-180">**Deployment Using the Visual Studio virtual machine configuration**</span><span class="sxs-lookup"><span data-stu-id="6b235-180">**Deployment Using the Visual Studio virtual machine configuration**</span></span>

<span data-ttu-id="6b235-181">To enable and configure the Microsoft Antimalware service using Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="6b235-181">To enable and configure the Microsoft Antimalware service using Visual Studio:</span></span>

<span data-ttu-id="6b235-182">1.Connect to Microsoft Azure in Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="6b235-182">1.Connect to Microsoft Azure in Visual Studio.</span></span>

<span data-ttu-id="6b235-183">2.Choose your Virtual Machine in the **Virtual Machines** node in **Server Explorer**</span><span class="sxs-lookup"><span data-stu-id="6b235-183">2.Choose your Virtual Machine in the **Virtual Machines** node in **Server Explorer**</span></span>

![Virtual Machine configuration in Visual Studio](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-fig5.PNG)

<span data-ttu-id="6b235-185">3.Right click **configure** to view the Virtual Machine configuration page</span><span class="sxs-lookup"><span data-stu-id="6b235-185">3.Right click **configure** to view the Virtual Machine configuration page</span></span>

<span data-ttu-id="6b235-186">4.Select **Microsoft Antimalware** extension from the dropdown list under **Installed Extensions** and click **Add** to configure with default antimalware configuration.</span><span class="sxs-lookup"><span data-stu-id="6b235-186">4.Select **Microsoft Antimalware** extension from the dropdown list under **Installed Extensions** and click **Add** to configure with default antimalware configuration.</span></span>

![Installed extensions](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-fig6.PNG)

<span data-ttu-id="6b235-188">5.To customize the default Antimalware configuration, select (highlight) the Antimalware extension in the installed extensions list and click **Configure**.</span><span class="sxs-lookup"><span data-stu-id="6b235-188">5.To customize the default Antimalware configuration, select (highlight) the Antimalware extension in the installed extensions list and click **Configure**.</span></span>

<span data-ttu-id="6b235-189">6.Replace the default Antimalware configuration with your custom configuration in supported JSON format in the **public configuration** textbox and click OK.</span><span class="sxs-lookup"><span data-stu-id="6b235-189">6.Replace the default Antimalware configuration with your custom configuration in supported JSON format in the **public configuration** textbox and click OK.</span></span>

<span data-ttu-id="6b235-190">7.Click the **Update** button to push the configuration updates to your Virtual Machine.</span><span class="sxs-lookup"><span data-stu-id="6b235-190">7.Click the **Update** button to push the configuration updates to your Virtual Machine.</span></span>

![Virtual Machine configuration extension](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-fig7.PNG)

<span data-ttu-id="6b235-192">**Note:** The Visual Studio Virtual Machines configuration for Antimalware supports only JSON format configuration.</span><span class="sxs-lookup"><span data-stu-id="6b235-192">**Note:** The Visual Studio Virtual Machines configuration for Antimalware supports only JSON format configuration.</span></span> <span data-ttu-id="6b235-193">The Antimalware JSON configuration settings template is included in the [Microsoft Antimalware For Azure - Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples"), showing the supported Antimalware configuration settings.</span><span class="sxs-lookup"><span data-stu-id="6b235-193">The Antimalware JSON configuration settings template is included in the [Microsoft Antimalware For Azure - Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples"), showing the supported Antimalware configuration settings.</span></span>

<span data-ttu-id="6b235-194">**Deployment Using PowerShell cmdlets**</span><span class="sxs-lookup"><span data-stu-id="6b235-194">**Deployment Using PowerShell cmdlets**</span></span>

<span data-ttu-id="6b235-195">An Azure application or service can enable and configure Microsoft Antimalware for Azure Virtual Machines using PowerShell cmdlets.</span><span class="sxs-lookup"><span data-stu-id="6b235-195">An Azure application or service can enable and configure Microsoft Antimalware for Azure Virtual Machines using PowerShell cmdlets.</span></span>

<span data-ttu-id="6b235-196">To enable and configure Microsoft antimalware using antimalware PowerShell cmdlets:</span><span class="sxs-lookup"><span data-stu-id="6b235-196">To enable and configure Microsoft antimalware using antimalware PowerShell cmdlets:</span></span>

1. <span data-ttu-id="6b235-197">Set up your PowerShell environment - Refer to the documentation at <https://github.com/Azure/azure-powershell></span><span class="sxs-lookup"><span data-stu-id="6b235-197">Set up your PowerShell environment - Refer to the documentation at <https://github.com/Azure/azure-powershell></span></span>
2. <span data-ttu-id="6b235-198">Use the Set-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet to enable and configure Microsoft Antimalware for your Virtual Machine as documented at <http://msdn.microsoft.com/library/azure/dn771718.aspx></span><span class="sxs-lookup"><span data-stu-id="6b235-198">Use the Set-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet to enable and configure Microsoft Antimalware for your Virtual Machine as documented at <http://msdn.microsoft.com/library/azure/dn771718.aspx></span></span>

<span data-ttu-id="6b235-199">**Note:** The Azure Virtual Machines configuration for Antimalware supports only JSON format configuration.</span><span class="sxs-lookup"><span data-stu-id="6b235-199">**Note:** The Azure Virtual Machines configuration for Antimalware supports only JSON format configuration.</span></span> <span data-ttu-id="6b235-200">The Antimalware JSON configuration settings template is included in the [Microsoft Antimalware For Azure - Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples"), showing the supported Antimalware configuration settings.</span><span class="sxs-lookup"><span data-stu-id="6b235-200">The Antimalware JSON configuration settings template is included in the [Microsoft Antimalware For Azure - Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples"), showing the supported Antimalware configuration settings.</span></span>

### <a name="enable-and-configure-antimalware-using-powershell-cmdlets"></a><span data-ttu-id="6b235-201">Enable and Configure Antimalware Using PowerShell cmdlets</span><span class="sxs-lookup"><span data-stu-id="6b235-201">Enable and Configure Antimalware Using PowerShell cmdlets</span></span>
<span data-ttu-id="6b235-202">An Azure application or service can enable and configure Microsoft Antimalware for Azure Cloud Services using PowerShell cmdlets.</span><span class="sxs-lookup"><span data-stu-id="6b235-202">An Azure application or service can enable and configure Microsoft Antimalware for Azure Cloud Services using PowerShell cmdlets.</span></span> <span data-ttu-id="6b235-203">Note that Microsoft Antimalware is installed in a disabled state in the Cloud Services platform and requires an action by an Azure application to enable it.</span><span class="sxs-lookup"><span data-stu-id="6b235-203">Note that Microsoft Antimalware is installed in a disabled state in the Cloud Services platform and requires an action by an Azure application to enable it.</span></span>

<span data-ttu-id="6b235-204">To enable and configure Microsoft Antimalware using PowerShell cmdlets:</span><span class="sxs-lookup"><span data-stu-id="6b235-204">To enable and configure Microsoft Antimalware using PowerShell cmdlets:</span></span>

1. <span data-ttu-id="6b235-205">Set up your PowerShell environment - Refer to the documentation at <https://github.com/Azure/azure-sdk-tools#get-started></span><span class="sxs-lookup"><span data-stu-id="6b235-205">Set up your PowerShell environment - Refer to the documentation at <https://github.com/Azure/azure-sdk-tools#get-started></span></span>
2. <span data-ttu-id="6b235-206">Use the Set-AzureServiceAntimalwareExtension Antimalware cmdlet to enable and configure Microsoft Antimalware for your Cloud Service as documented at <http://msdn.microsoft.com/library/azure/dn771718.aspx></span><span class="sxs-lookup"><span data-stu-id="6b235-206">Use the Set-AzureServiceAntimalwareExtension Antimalware cmdlet to enable and configure Microsoft Antimalware for your Cloud Service as documented at <http://msdn.microsoft.com/library/azure/dn771718.aspx></span></span>

<span data-ttu-id="6b235-207">The Antimalware XML configuration settings template is included in the [Microsoft Antimalware For Azure - Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples"), showing the supported Antimalware configuration settings.</span><span class="sxs-lookup"><span data-stu-id="6b235-207">The Antimalware XML configuration settings template is included in the [Microsoft Antimalware For Azure - Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples"), showing the supported Antimalware configuration settings.</span></span>

### <a name="cloud-services-and-virtual-machines---configuration-using-powershell-cmdlets"></a><span data-ttu-id="6b235-208">Cloud Services and Virtual Machines - Configuration Using PowerShell cmdlets</span><span class="sxs-lookup"><span data-stu-id="6b235-208">Cloud Services and Virtual Machines - Configuration Using PowerShell cmdlets</span></span>
<span data-ttu-id="6b235-209">An Azure application or service can retrieve the Microsoft Antimalware configuration for Cloud Services and Virtual Machines using PowerShell cmdlets.</span><span class="sxs-lookup"><span data-stu-id="6b235-209">An Azure application or service can retrieve the Microsoft Antimalware configuration for Cloud Services and Virtual Machines using PowerShell cmdlets.</span></span>

<span data-ttu-id="6b235-210">To retrieve the Microsoft Antimalware configuration using PowerShell cmdlets:</span><span class="sxs-lookup"><span data-stu-id="6b235-210">To retrieve the Microsoft Antimalware configuration using PowerShell cmdlets:</span></span>

1. <span data-ttu-id="6b235-211">Set up your PowerShell environment - Refer to the documentation at <https://github.com/Azure/azure-sdk-tools#get-started></span><span class="sxs-lookup"><span data-stu-id="6b235-211">Set up your PowerShell environment - Refer to the documentation at <https://github.com/Azure/azure-sdk-tools#get-started></span></span>
2. <span data-ttu-id="6b235-212">**For Virtual Machines**: Use the Get-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet to get the antimalware configuration as documented at <http://msdn.microsoft.com/library/azure/dn771719.aspx></span><span class="sxs-lookup"><span data-stu-id="6b235-212">**For Virtual Machines**: Use the Get-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet to get the antimalware configuration as documented at <http://msdn.microsoft.com/library/azure/dn771719.aspx></span></span>
3. <span data-ttu-id="6b235-213">**For Cloud Services**: Use the Get-AzureServiceAntimalwareConfig Antimalware cmdlet to get the Antimalware configuration as documented at <http://msdn.microsoft.com/library/azure/dn771722.aspx></span><span class="sxs-lookup"><span data-stu-id="6b235-213">**For Cloud Services**: Use the Get-AzureServiceAntimalwareConfig Antimalware cmdlet to get the Antimalware configuration as documented at <http://msdn.microsoft.com/library/azure/dn771722.aspx></span></span>

### <a name="remove-antimalware-configuration-using-powershell-cmdlets"></a><span data-ttu-id="6b235-214">Remove Antimalware Configuration Using PowerShell cmdlets</span><span class="sxs-lookup"><span data-stu-id="6b235-214">Remove Antimalware Configuration Using PowerShell cmdlets</span></span>
<span data-ttu-id="6b235-215">An Azure application or service can remove the Antimalware configuration and any associated Antimalware monitoring configuration from the relevant Azure Antimalware and diagnostics service extensions associated with the Cloud Service or Virtual Machine.</span><span class="sxs-lookup"><span data-stu-id="6b235-215">An Azure application or service can remove the Antimalware configuration and any associated Antimalware monitoring configuration from the relevant Azure Antimalware and diagnostics service extensions associated with the Cloud Service or Virtual Machine.</span></span>

<span data-ttu-id="6b235-216">To remove Microsoft Antimalware using PowerShell cmdlets:</span><span class="sxs-lookup"><span data-stu-id="6b235-216">To remove Microsoft Antimalware using PowerShell cmdlets:</span></span>

1. <span data-ttu-id="6b235-217">Set up your PowerShell environment - Refer to the documentation at <https://github.com/Azure/azure-sdk-tools#get-started></span><span class="sxs-lookup"><span data-stu-id="6b235-217">Set up your PowerShell environment - Refer to the documentation at <https://github.com/Azure/azure-sdk-tools#get-started></span></span>
2. <span data-ttu-id="6b235-218">**For Virtual Machines**: Use the Remove-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet as documented at <http://msdn.microsoft.com/library/azure/dn771720.aspx></span><span class="sxs-lookup"><span data-stu-id="6b235-218">**For Virtual Machines**: Use the Remove-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet as documented at <http://msdn.microsoft.com/library/azure/dn771720.aspx></span></span>
3. <span data-ttu-id="6b235-219">**For Cloud Services:** Use the Remove-AzureServiceAntimalwareExtension Antimalware cmdlet as documented at <http://msdn.microsoft.com/library/azure/dn771717.aspx></span><span class="sxs-lookup"><span data-stu-id="6b235-219">**For Cloud Services:** Use the Remove-AzureServiceAntimalwareExtension Antimalware cmdlet as documented at <http://msdn.microsoft.com/library/azure/dn771717.aspx></span></span>

<span data-ttu-id="6b235-220">To **enable** antimalware event collection for a virtual machine using the Azure Preview Portal:</span><span class="sxs-lookup"><span data-stu-id="6b235-220">To **enable** antimalware event collection for a virtual machine using the Azure Preview Portal:</span></span>

1. <span data-ttu-id="6b235-221">Click any part of the Monitoring lens in the Virtual Machine blade</span><span class="sxs-lookup"><span data-stu-id="6b235-221">Click any part of the Monitoring lens in the Virtual Machine blade</span></span>
2. <span data-ttu-id="6b235-222">Click the Diagnostics command on Metric blade</span><span class="sxs-lookup"><span data-stu-id="6b235-222">Click the Diagnostics command on Metric blade</span></span>
3. <span data-ttu-id="6b235-223">Select **Status** ON and check the option for Windows event system</span><span class="sxs-lookup"><span data-stu-id="6b235-223">Select **Status** ON and check the option for Windows event system</span></span>
4. <span data-ttu-id="6b235-224">.</span><span class="sxs-lookup"><span data-stu-id="6b235-224">.</span></span> <span data-ttu-id="6b235-225">You can choose to uncheck all other options in the list, or leave them enabled per your application service needs.</span><span class="sxs-lookup"><span data-stu-id="6b235-225">You can choose to uncheck all other options in the list, or leave them enabled per your application service needs.</span></span>
5. <span data-ttu-id="6b235-226">The Antimalware event categories “Error”, “Warning”, “Informational”, etc., are captured in your Azure Storage account.</span><span class="sxs-lookup"><span data-stu-id="6b235-226">The Antimalware event categories “Error”, “Warning”, “Informational”, etc., are captured in your Azure Storage account.</span></span>

<span data-ttu-id="6b235-227">Antimalware events are collected from the Windows event system logs to your Azure Storage account.</span><span class="sxs-lookup"><span data-stu-id="6b235-227">Antimalware events are collected from the Windows event system logs to your Azure Storage account.</span></span> <span data-ttu-id="6b235-228">You can configure the Storage Account for your Virtual Machine to collect Antimalware events by selecting the appropriate storage account.</span><span class="sxs-lookup"><span data-stu-id="6b235-228">You can configure the Storage Account for your Virtual Machine to collect Antimalware events by selecting the appropriate storage account.</span></span>

![Metrics and diagnostics](https://docstestmedia1.blob.core.windows.net/azure-media/articles/security/media/azure-security-antimalware/sec-azantimal-fig8.PNG)

> [!NOTE]
> <span data-ttu-id="6b235-230">For more information on how to Diagnostics Logging for Azure Antimalware, read [Enabling Diagnostics Logging for Azure Antimalware](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).</span><span class="sxs-lookup"><span data-stu-id="6b235-230">For more information on how to Diagnostics Logging for Azure Antimalware, read [Enabling Diagnostics Logging for Azure Antimalware](https://blogs.msdn.microsoft.com/azuresecurity/2016/04/19/enabling-diagnostics-logging-for-azure-antimalware/).</span></span>
>
>

### <a name="enable-and-configure-antimalware-monitoring-using-powershell-cmdlets"></a><span data-ttu-id="6b235-231">Enable and configure antimalware monitoring using powerShell cmdlets</span><span class="sxs-lookup"><span data-stu-id="6b235-231">Enable and configure antimalware monitoring using powerShell cmdlets</span></span>
<span data-ttu-id="6b235-232">You can enable collection of Microsoft Antimalware events for your Cloud Service or Virtual Machine using Azure Diagnostics through Antimalware PowerShell cmdlets.</span><span class="sxs-lookup"><span data-stu-id="6b235-232">You can enable collection of Microsoft Antimalware events for your Cloud Service or Virtual Machine using Azure Diagnostics through Antimalware PowerShell cmdlets.</span></span> <span data-ttu-id="6b235-233">The Azure Diagnostics extension can be configured to capture events from the System event log source “Microsoft Antimalware” to your Azure Storage account.</span><span class="sxs-lookup"><span data-stu-id="6b235-233">The Azure Diagnostics extension can be configured to capture events from the System event log source “Microsoft Antimalware” to your Azure Storage account.</span></span> <span data-ttu-id="6b235-234">The Antimalware event categories “Error”, “Warning”, “Informational”, etc., are captured in your Azure Storage account.</span><span class="sxs-lookup"><span data-stu-id="6b235-234">The Antimalware event categories “Error”, “Warning”, “Informational”, etc., are captured in your Azure Storage account.</span></span>

<span data-ttu-id="6b235-235">To enable Antimalware event collection to your Azure Storage account using PowerShell cmdlets:</span><span class="sxs-lookup"><span data-stu-id="6b235-235">To enable Antimalware event collection to your Azure Storage account using PowerShell cmdlets:</span></span>

1. <span data-ttu-id="6b235-236">Set up your PowerShell environment - Refer to <https://github.com/Azure/azure-sdk-tools#get-started></span><span class="sxs-lookup"><span data-stu-id="6b235-236">Set up your PowerShell environment - Refer to <https://github.com/Azure/azure-sdk-tools#get-started></span></span>
2. <span data-ttu-id="6b235-237">**For Virtual Machines** - Use the Set-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet with Monitoring ON option as documented at <http://msdn.microsoft.com/library/azure/dn771716.aspx></span><span class="sxs-lookup"><span data-stu-id="6b235-237">**For Virtual Machines** - Use the Set-AzureVMMicrosoftAntimalwareExtension Antimalware cmdlet with Monitoring ON option as documented at <http://msdn.microsoft.com/library/azure/dn771716.aspx></span></span>
3. <span data-ttu-id="6b235-238">**For Cloud Services** - Use the Set-AzureServiceAntimalwareExtension Antimalware cmdlet with Monitoring ON option as documented at <http://msdn.microsoft.com/library/azure/dn771718.aspx></span><span class="sxs-lookup"><span data-stu-id="6b235-238">**For Cloud Services** - Use the Set-AzureServiceAntimalwareExtension Antimalware cmdlet with Monitoring ON option as documented at <http://msdn.microsoft.com/library/azure/dn771718.aspx></span></span>

<span data-ttu-id="6b235-239">You can view the Antimalware raw events by looking at the WADWindowsEventLogsTable table in your Azure Storage account that you configured to enable Antimalware monitoring.</span><span class="sxs-lookup"><span data-stu-id="6b235-239">You can view the Antimalware raw events by looking at the WADWindowsEventLogsTable table in your Azure Storage account that you configured to enable Antimalware monitoring.</span></span> <span data-ttu-id="6b235-240">This can be useful to validate that Antimalware event collection is working, including getting insight into the Antimalware service’s health.</span><span class="sxs-lookup"><span data-stu-id="6b235-240">This can be useful to validate that Antimalware event collection is working, including getting insight into the Antimalware service’s health.</span></span> <span data-ttu-id="6b235-241">For more details, including sample code on how to extract Antimalware events from your storage account, refer to [Microsoft Antimalware For Azure - Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples").</span><span class="sxs-lookup"><span data-stu-id="6b235-241">For more details, including sample code on how to extract Antimalware events from your storage account, refer to [Microsoft Antimalware For Azure - Code Samples](http://aka.ms/amazsamples "Microsoft Antimalware For Azure - Code Samples").</span></span>









