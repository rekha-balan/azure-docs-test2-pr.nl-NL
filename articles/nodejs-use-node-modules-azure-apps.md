---
title: Working with Node.js Modules
description: Learn how to work with Node.js modules when using Azure App Service or Cloud Services.
services: ''
documentationcenter: nodejs
author: rmcmurray
manager: erikre
editor: ''
ms.assetid: c0e6cd3d-932d-433e-b72d-e513e23b4eb6
ms.service: multiple
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 12/22/2016
ms.author: robmcm
ms.openlocfilehash: 4ef028e7dbacc126a94b383d0fb13e255bcedcaf
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44563711"
---
# <a name="using-nodejs-modules-with-azure-applications"></a><span data-ttu-id="a83fd-103">Using Node.js Modules with Azure applications</span><span class="sxs-lookup"><span data-stu-id="a83fd-103">Using Node.js Modules with Azure applications</span></span>
<span data-ttu-id="a83fd-104">This document provides guidance on using Node.js modules with applications hosted on Azure.</span><span class="sxs-lookup"><span data-stu-id="a83fd-104">This document provides guidance on using Node.js modules with applications hosted on Azure.</span></span> <span data-ttu-id="a83fd-105">It provides guidance on ensuring that your application uses a specific version of module as well as using native modules with Azure.</span><span class="sxs-lookup"><span data-stu-id="a83fd-105">It provides guidance on ensuring that your application uses a specific version of module as well as using native modules with Azure.</span></span>

<span data-ttu-id="a83fd-106">If you are already familiar with using Node.js modules, **package.json** and **npm-shrinkwrap.json** files, the following is a quick summary of what is discussed in this article:</span><span class="sxs-lookup"><span data-stu-id="a83fd-106">If you are already familiar with using Node.js modules, **package.json** and **npm-shrinkwrap.json** files, the following is a quick summary of what is discussed in this article:</span></span>

* <span data-ttu-id="a83fd-107">Azure App Service understands **package.json** and **npm-shrinkwrap.json** files and can install modules based on entries in these files.</span><span class="sxs-lookup"><span data-stu-id="a83fd-107">Azure App Service understands **package.json** and **npm-shrinkwrap.json** files and can install modules based on entries in these files.</span></span>
* <span data-ttu-id="a83fd-108">Azure Cloud Services expect all modules to be installed on the development environment, and the **node\_modules** directory to be included as part of the deployment package.</span><span class="sxs-lookup"><span data-stu-id="a83fd-108">Azure Cloud Services expect all modules to be installed on the development environment, and the **node\_modules** directory to be included as part of the deployment package.</span></span> <span data-ttu-id="a83fd-109">It is possible to enable support for installing modules using **package.json** or **npm-shrinkwrap.json** files on Cloud Services, however this requires customization of the default scripts used by Cloud Service projects.</span><span class="sxs-lookup"><span data-stu-id="a83fd-109">It is possible to enable support for installing modules using **package.json** or **npm-shrinkwrap.json** files on Cloud Services, however this requires customization of the default scripts used by Cloud Service projects.</span></span> <span data-ttu-id="a83fd-110">For an example of how to accomplish this, see [Azure Startup task to run npm install to avoid deploying node modules](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span><span class="sxs-lookup"><span data-stu-id="a83fd-110">For an example of how to accomplish this, see [Azure Startup task to run npm install to avoid deploying node modules](https://github.com/woloski/nodeonazure-blog/blob/master/articles/startup-task-to-run-npm-in-azure.markdown)</span></span>

> [!NOTE]
> <span data-ttu-id="a83fd-111">Azure Virtual Machines are not discussed in this article, as the deployment experience in a VM will be dependent on the operating system hosted by the Virtual Machine.</span><span class="sxs-lookup"><span data-stu-id="a83fd-111">Azure Virtual Machines are not discussed in this article, as the deployment experience in a VM will be dependent on the operating system hosted by the Virtual Machine.</span></span>
> 
> 

## <a name="nodejs-modules"></a><span data-ttu-id="a83fd-112">Node.js Modules</span><span class="sxs-lookup"><span data-stu-id="a83fd-112">Node.js Modules</span></span>
<span data-ttu-id="a83fd-113">Modules are loadable JavaScript packages that provide specific functionality for your application.</span><span class="sxs-lookup"><span data-stu-id="a83fd-113">Modules are loadable JavaScript packages that provide specific functionality for your application.</span></span> <span data-ttu-id="a83fd-114">A module is usually installed using the **npm** command-line tool, however some (such as the http module) are provided as part of the core Node.js package.</span><span class="sxs-lookup"><span data-stu-id="a83fd-114">A module is usually installed using the **npm** command-line tool, however some (such as the http module) are provided as part of the core Node.js package.</span></span>

<span data-ttu-id="a83fd-115">When modules are installed, they are stored in the **node\_modules** directory at the root of your application directory structure.</span><span class="sxs-lookup"><span data-stu-id="a83fd-115">When modules are installed, they are stored in the **node\_modules** directory at the root of your application directory structure.</span></span> <span data-ttu-id="a83fd-116">Each module within the **node\_modules** directory maintains its own **node\_modules** directory that contains any modules that it depends on, and this repeats again for every module all the way down the dependency chain.</span><span class="sxs-lookup"><span data-stu-id="a83fd-116">Each module within the **node\_modules** directory maintains its own **node\_modules** directory that contains any modules that it depends on, and this repeats again for every module all the way down the dependency chain.</span></span> <span data-ttu-id="a83fd-117">This allows each module installed to have its own version requirements for the modules it depends on, however it can result in quite a large directory structure.</span><span class="sxs-lookup"><span data-stu-id="a83fd-117">This allows each module installed to have its own version requirements for the modules it depends on, however it can result in quite a large directory structure.</span></span>

<span data-ttu-id="a83fd-118">When deploying the **node\_modules** directory as part of your application, it will increase the size of the deployment compared to using a **package.json** or **npm-shrinkwrap.json** file; however, it does guarantee that the version of the modules used in production are the same as those used in development.</span><span class="sxs-lookup"><span data-stu-id="a83fd-118">When deploying the **node\_modules** directory as part of your application, it will increase the size of the deployment compared to using a **package.json** or **npm-shrinkwrap.json** file; however, it does guarantee that the version of the modules used in production are the same as those used in development.</span></span>

### <a name="native-modules"></a><span data-ttu-id="a83fd-119">Native Modules</span><span class="sxs-lookup"><span data-stu-id="a83fd-119">Native Modules</span></span>
<span data-ttu-id="a83fd-120">While most modules are simply plain-text JavaScript files, some modules are platform-specific binary images.</span><span class="sxs-lookup"><span data-stu-id="a83fd-120">While most modules are simply plain-text JavaScript files, some modules are platform-specific binary images.</span></span> <span data-ttu-id="a83fd-121">These modules are compiled at install time, usually by using Python and node-gyp.</span><span class="sxs-lookup"><span data-stu-id="a83fd-121">These modules are compiled at install time, usually by using Python and node-gyp.</span></span> <span data-ttu-id="a83fd-122">Since Azure Cloud Services rely on the **node\_modules** folder being deployed as part of the application, any native module included as part of the installed modules should work in a cloud service as long as it was installed and compiled on a Windows development system.</span><span class="sxs-lookup"><span data-stu-id="a83fd-122">Since Azure Cloud Services rely on the **node\_modules** folder being deployed as part of the application, any native module included as part of the installed modules should work in a cloud service as long as it was installed and compiled on a Windows development system.</span></span>

<span data-ttu-id="a83fd-123">Azure App Service does not support all native modules and might fail at compiling those with very specific prerequisites.</span><span class="sxs-lookup"><span data-stu-id="a83fd-123">Azure App Service does not support all native modules and might fail at compiling those with very specific prerequisites.</span></span> <span data-ttu-id="a83fd-124">While some popular modules like MongoDB have optional native dependencies and work just fine without them, two workarounds proved successful with almost all native modules available today:</span><span class="sxs-lookup"><span data-stu-id="a83fd-124">While some popular modules like MongoDB have optional native dependencies and work just fine without them, two workarounds proved successful with almost all native modules available today:</span></span>

* <span data-ttu-id="a83fd-125">Run **npm install** on a Windows machine that has all the native module's prerequisites installed.</span><span class="sxs-lookup"><span data-stu-id="a83fd-125">Run **npm install** on a Windows machine that has all the native module's prerequisites installed.</span></span> <span data-ttu-id="a83fd-126">Then, deploy the created **node\_modules** folder as part of the application to Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="a83fd-126">Then, deploy the created **node\_modules** folder as part of the application to Azure App Service.</span></span>
  * <span data-ttu-id="a83fd-127">Before compiling, check that your local Node.js installation has matching architecture and the version is as close as possible to the one used in Azure (the current values can be checked on runtime from properties **process.arch** and **process.version**).</span><span class="sxs-lookup"><span data-stu-id="a83fd-127">Before compiling, check that your local Node.js installation has matching architecture and the version is as close as possible to the one used in Azure (the current values can be checked on runtime from properties **process.arch** and **process.version**).</span></span>
* <span data-ttu-id="a83fd-128">Azure App Service can be configured to execute custom bash or shell scripts during deployment, giving you the opportunity to execute custom commands and precisely configure the way **npm install** is being run.</span><span class="sxs-lookup"><span data-stu-id="a83fd-128">Azure App Service can be configured to execute custom bash or shell scripts during deployment, giving you the opportunity to execute custom commands and precisely configure the way **npm install** is being run.</span></span> <span data-ttu-id="a83fd-129">For a video showing how to do this, see [Custom Website Deployment Scripts with Kudu].</span><span class="sxs-lookup"><span data-stu-id="a83fd-129">For a video showing how to do this, see [Custom Website Deployment Scripts with Kudu].</span></span>

### <a name="using-a-packagejson-file"></a><span data-ttu-id="a83fd-130">Using a package.json file</span><span class="sxs-lookup"><span data-stu-id="a83fd-130">Using a package.json file</span></span>
<span data-ttu-id="a83fd-131">The **package.json** file is a way to specify the top level dependencies your application requires so that the hosting platform can install the dependencies, rather than requiring you to include the **node\_packages** folder as part of the deployment.</span><span class="sxs-lookup"><span data-stu-id="a83fd-131">The **package.json** file is a way to specify the top level dependencies your application requires so that the hosting platform can install the dependencies, rather than requiring you to include the **node\_packages** folder as part of the deployment.</span></span> <span data-ttu-id="a83fd-132">After the application has been deployed, the **npm install** command is used to parse the **package.json** file and install all the dependencies listed.</span><span class="sxs-lookup"><span data-stu-id="a83fd-132">After the application has been deployed, the **npm install** command is used to parse the **package.json** file and install all the dependencies listed.</span></span>

<span data-ttu-id="a83fd-133">During development, you can use the **--save**, **--save-dev**, or **--save-optional** parameters when installing modules to add an entry for the module to your **package.json** file automatically.</span><span class="sxs-lookup"><span data-stu-id="a83fd-133">During development, you can use the **--save**, **--save-dev**, or **--save-optional** parameters when installing modules to add an entry for the module to your **package.json** file automatically.</span></span> <span data-ttu-id="a83fd-134">For more information, see [npm-install](https://docs.npmjs.com/cli/install).</span><span class="sxs-lookup"><span data-stu-id="a83fd-134">For more information, see [npm-install](https://docs.npmjs.com/cli/install).</span></span>

<span data-ttu-id="a83fd-135">One potential problem with the **package.json** file is that it only specifies the version for top level dependencies.</span><span class="sxs-lookup"><span data-stu-id="a83fd-135">One potential problem with the **package.json** file is that it only specifies the version for top level dependencies.</span></span> <span data-ttu-id="a83fd-136">Each module installed may or may not specify the version of the modules it depends on, and so it is possible that you may end up with a different dependency chain than the one used in development.</span><span class="sxs-lookup"><span data-stu-id="a83fd-136">Each module installed may or may not specify the version of the modules it depends on, and so it is possible that you may end up with a different dependency chain than the one used in development.</span></span>

> [!NOTE]
> <span data-ttu-id="a83fd-137">When deploying to Azure App Service, if your <b>package.json</b> file references a native module you will see an error similar to the following when publishing the application using Git:</span><span class="sxs-lookup"><span data-stu-id="a83fd-137">When deploying to Azure App Service, if your <b>package.json</b> file references a native module you will see an error similar to the following when publishing the application using Git:</span></span>
> 
> <span data-ttu-id="a83fd-138">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="a83fd-138">npm ERR!</span></span> <span data-ttu-id="a83fd-139">module-name@0.6.0 install: 'node-gyp configure build'</span><span class="sxs-lookup"><span data-stu-id="a83fd-139">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="a83fd-140">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="a83fd-140">npm ERR!</span></span> <span data-ttu-id="a83fd-141">'cmd "/c" "node-gyp configure build"' failed with 1</span><span class="sxs-lookup"><span data-stu-id="a83fd-141">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

### <a name="using-a-npm-shrinkwrapjson-file"></a><span data-ttu-id="a83fd-142">Using a npm-shrinkwrap.json file</span><span class="sxs-lookup"><span data-stu-id="a83fd-142">Using a npm-shrinkwrap.json file</span></span>
<span data-ttu-id="a83fd-143">The **npm-shrinkwrap.json** file is an attempt to address the module versioning limitations of the **package.json** file.</span><span class="sxs-lookup"><span data-stu-id="a83fd-143">The **npm-shrinkwrap.json** file is an attempt to address the module versioning limitations of the **package.json** file.</span></span> <span data-ttu-id="a83fd-144">While the **package.json** file only includes versions for the top level modules, the **npm-shrinkwrap.json** file contains the version requirements for the full module dependency chain.</span><span class="sxs-lookup"><span data-stu-id="a83fd-144">While the **package.json** file only includes versions for the top level modules, the **npm-shrinkwrap.json** file contains the version requirements for the full module dependency chain.</span></span>

<span data-ttu-id="a83fd-145">When your application is ready for production, you can lock-down version requirements and create an **npm-shrinkwrap.json** file by using the **npm shrinkwrap** command.</span><span class="sxs-lookup"><span data-stu-id="a83fd-145">When your application is ready for production, you can lock-down version requirements and create an **npm-shrinkwrap.json** file by using the **npm shrinkwrap** command.</span></span> <span data-ttu-id="a83fd-146">This will use the versions currently installed in the **node\_modules** folder, and record these to the **npm-shrinkwrap.json** file.</span><span class="sxs-lookup"><span data-stu-id="a83fd-146">This will use the versions currently installed in the **node\_modules** folder, and record these to the **npm-shrinkwrap.json** file.</span></span> <span data-ttu-id="a83fd-147">After the application has been deployed to the hosting environment, the **npm install** command is used to parse the **npm-shrinkwrap.json** file and install all the dependencies listed.</span><span class="sxs-lookup"><span data-stu-id="a83fd-147">After the application has been deployed to the hosting environment, the **npm install** command is used to parse the **npm-shrinkwrap.json** file and install all the dependencies listed.</span></span> <span data-ttu-id="a83fd-148">For more information, see [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span><span class="sxs-lookup"><span data-stu-id="a83fd-148">For more information, see [npm-shrinkwrap](https://docs.npmjs.com/cli/shrinkwrap).</span></span>

> [!NOTE]
> <span data-ttu-id="a83fd-149">When deploying to Azure App Service, if your <b>npm-shrinkwrap.json</b> file references a native module you will see an error similar to the following when publishing the application using Git:</span><span class="sxs-lookup"><span data-stu-id="a83fd-149">When deploying to Azure App Service, if your <b>npm-shrinkwrap.json</b> file references a native module you will see an error similar to the following when publishing the application using Git:</span></span>
> 
> <span data-ttu-id="a83fd-150">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="a83fd-150">npm ERR!</span></span> <span data-ttu-id="a83fd-151">module-name@0.6.0 install: 'node-gyp configure build'</span><span class="sxs-lookup"><span data-stu-id="a83fd-151">module-name@0.6.0 install: 'node-gyp configure build'</span></span>
> 
> <span data-ttu-id="a83fd-152">npm ERR!</span><span class="sxs-lookup"><span data-stu-id="a83fd-152">npm ERR!</span></span> <span data-ttu-id="a83fd-153">'cmd "/c" "node-gyp configure build"' failed with 1</span><span class="sxs-lookup"><span data-stu-id="a83fd-153">'cmd "/c" "node-gyp configure build"' failed with 1</span></span>
> 
> 

## <a name="next-steps"></a><span data-ttu-id="a83fd-154">Next Steps</span><span class="sxs-lookup"><span data-stu-id="a83fd-154">Next Steps</span></span>
<span data-ttu-id="a83fd-155">Now that you understand how to use Node.js modules with Azure, learn how to [specify the Node.js version], [build and deploy a Node.js web app](app-service-web/app-service-web-get-started-nodejs.md), and [How to use the Azure Command-Line Interface for Mac and Linux].</span><span class="sxs-lookup"><span data-stu-id="a83fd-155">Now that you understand how to use Node.js modules with Azure, learn how to [specify the Node.js version], [build and deploy a Node.js web app](app-service-web/app-service-web-get-started-nodejs.md), and [How to use the Azure Command-Line Interface for Mac and Linux].</span></span>

<span data-ttu-id="a83fd-156">For more information, see the [Node.js Developer Center](/develop/nodejs/).</span><span class="sxs-lookup"><span data-stu-id="a83fd-156">For more information, see the [Node.js Developer Center](/develop/nodejs/).</span></span>

[specify the Node.js version]: nodejs-specify-node-version-azure-apps.md
[How to use the Azure Command-Line Interface for Mac and Linux]:cli-install-nodejs.md
[Custom Website Deployment Scripts with Kudu]: /documentation/videos/custom-web-site-deployment-scripts-with-kudu/
