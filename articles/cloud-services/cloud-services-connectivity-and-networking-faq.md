---
title: Connectivity and networking issues for Microsoft Azure Cloud Services FAQ| Microsoft Docs
description: This article lists the frequently asked questions about connectivity and networking for Microsoft Azure Cloud Services.
services: cloud-services
documentationcenter: ''
author: genlin
manager: cshepard
editor: ''
tags: top-support-issue
ms.assetid: 84985660-2cfd-483a-8378-50eef6a0151d
ms.service: cloud-services
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 05/11/2018
ms.author: genli
ms.openlocfilehash: 7b04efb419831508946c37416172587cefa2d275
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44871728"
---
# <a name="connectivity-and-networking-issues-for-azure-cloud-services-frequently-asked-questions-faqs"></a><span data-ttu-id="81c09-103">Connectivity and networking issues for Azure Cloud Services: Frequently asked questions (FAQs)</span><span class="sxs-lookup"><span data-stu-id="81c09-103">Connectivity and networking issues for Azure Cloud Services: Frequently asked questions (FAQs)</span></span>

<span data-ttu-id="81c09-104">This article includes frequently asked questions about connectivity and networking issues for [Azure Cloud Services](https://azure.microsoft.com/services/cloud-services).</span><span class="sxs-lookup"><span data-stu-id="81c09-104">This article includes frequently asked questions about connectivity and networking issues for [Azure Cloud Services](https://azure.microsoft.com/services/cloud-services).</span></span> <span data-ttu-id="81c09-105">For size information, see the [Cloud Services VM size page](cloud-services-sizes-specs.md).</span><span class="sxs-lookup"><span data-stu-id="81c09-105">For size information, see the [Cloud Services VM size page](cloud-services-sizes-specs.md).</span></span>

[!INCLUDE [support-disclaimer](../../includes/support-disclaimer.md)]

## <a name="i-cant-reserve-an-ip-in-a-multi-vip-cloud-service"></a><span data-ttu-id="81c09-106">I can't reserve an IP in a multi-VIP cloud service.</span><span class="sxs-lookup"><span data-stu-id="81c09-106">I can't reserve an IP in a multi-VIP cloud service.</span></span>
<span data-ttu-id="81c09-107">First, make sure that the virtual machine instance that you try to reserve the IP for is turned on.</span><span class="sxs-lookup"><span data-stu-id="81c09-107">First, make sure that the virtual machine instance that you try to reserve the IP for is turned on.</span></span> <span data-ttu-id="81c09-108">Second, make sure that you use reserved IPs for both the staging and production deployments.</span><span class="sxs-lookup"><span data-stu-id="81c09-108">Second, make sure that you use reserved IPs for both the staging and production deployments.</span></span> <span data-ttu-id="81c09-109">*Do not* change the settings while the deployment is upgrading.</span><span class="sxs-lookup"><span data-stu-id="81c09-109">*Do not* change the settings while the deployment is upgrading.</span></span>

## <a name="how-do-i-use-remote-desktop-when-i-have-an-nsg"></a><span data-ttu-id="81c09-110">How do I use Remote Desktop when I have an NSG?</span><span class="sxs-lookup"><span data-stu-id="81c09-110">How do I use Remote Desktop when I have an NSG?</span></span>
<span data-ttu-id="81c09-111">Add rules to the NSG that allow traffic on ports **3389** and **20000**.</span><span class="sxs-lookup"><span data-stu-id="81c09-111">Add rules to the NSG that allow traffic on ports **3389** and **20000**.</span></span> <span data-ttu-id="81c09-112">Remote Desktop uses port **3389**.</span><span class="sxs-lookup"><span data-stu-id="81c09-112">Remote Desktop uses port **3389**.</span></span> <span data-ttu-id="81c09-113">Cloud service instances are load balanced, so you can't directly control which instance to connect to.</span><span class="sxs-lookup"><span data-stu-id="81c09-113">Cloud service instances are load balanced, so you can't directly control which instance to connect to.</span></span> <span data-ttu-id="81c09-114">The *RemoteForwarder* and *RemoteAccess* agents manage Remote Desktop Protocol (RDP) traffic and allow the client to send an RDP cookie and specify an individual instance to connect to.</span><span class="sxs-lookup"><span data-stu-id="81c09-114">The *RemoteForwarder* and *RemoteAccess* agents manage Remote Desktop Protocol (RDP) traffic and allow the client to send an RDP cookie and specify an individual instance to connect to.</span></span> <span data-ttu-id="81c09-115">The *RemoteForwarder* and *RemoteAccess* agents require port **20000** to be open, which might be blocked if you have an NSG.</span><span class="sxs-lookup"><span data-stu-id="81c09-115">The *RemoteForwarder* and *RemoteAccess* agents require port **20000** to be open, which might be blocked if you have an NSG.</span></span>

## <a name="can-i-ping-a-cloud-service"></a><span data-ttu-id="81c09-116">Can I ping a cloud service?</span><span class="sxs-lookup"><span data-stu-id="81c09-116">Can I ping a cloud service?</span></span>

<span data-ttu-id="81c09-117">No, not by using the normal "ping"/ICMP protocol.</span><span class="sxs-lookup"><span data-stu-id="81c09-117">No, not by using the normal "ping"/ICMP protocol.</span></span> <span data-ttu-id="81c09-118">The ICMP protocol is not permitted through the Azure load balancer.</span><span class="sxs-lookup"><span data-stu-id="81c09-118">The ICMP protocol is not permitted through the Azure load balancer.</span></span>

<span data-ttu-id="81c09-119">To test connectivity, we recommend that you do a port ping.</span><span class="sxs-lookup"><span data-stu-id="81c09-119">To test connectivity, we recommend that you do a port ping.</span></span> <span data-ttu-id="81c09-120">While Ping.exe uses ICMP, you can use other tools, such as PSPing, Nmap, and telnet, to test connectivity to a specific TCP port.</span><span class="sxs-lookup"><span data-stu-id="81c09-120">While Ping.exe uses ICMP, you can use other tools, such as PSPing, Nmap, and telnet, to test connectivity to a specific TCP port.</span></span>

<span data-ttu-id="81c09-121">For more information, see [Use port pings instead of ICMP to test Azure VM connectivity](https://blogs.msdn.microsoft.com/mast/2014/06/22/use-port-pings-instead-of-icmp-to-test-azure-vm-connectivity/).</span><span class="sxs-lookup"><span data-stu-id="81c09-121">For more information, see [Use port pings instead of ICMP to test Azure VM connectivity](https://blogs.msdn.microsoft.com/mast/2014/06/22/use-port-pings-instead-of-icmp-to-test-azure-vm-connectivity/).</span></span>

## <a name="how-do-i-prevent-receiving-thousands-of-hits-from-unknown-ip-addresses-that-might-indicate-a-malicious-attack-to-the-cloud-service"></a><span data-ttu-id="81c09-122">How do I prevent receiving thousands of hits from unknown IP addresses that might indicate a malicious attack to the cloud service?</span><span class="sxs-lookup"><span data-stu-id="81c09-122">How do I prevent receiving thousands of hits from unknown IP addresses that might indicate a malicious attack to the cloud service?</span></span>
<span data-ttu-id="81c09-123">Azure implements a multilayer network security to protect its platform services against distributed denial-of-service (DDoS) attacks.</span><span class="sxs-lookup"><span data-stu-id="81c09-123">Azure implements a multilayer network security to protect its platform services against distributed denial-of-service (DDoS) attacks.</span></span> <span data-ttu-id="81c09-124">The Azure DDoS defense system is part of Azure's continuous monitoring process, which is continually improved through penetration testing.</span><span class="sxs-lookup"><span data-stu-id="81c09-124">The Azure DDoS defense system is part of Azure's continuous monitoring process, which is continually improved through penetration testing.</span></span> <span data-ttu-id="81c09-125">This DDoS defense system is designed to withstand not only attacks from the outside but also from other Azure tenants.</span><span class="sxs-lookup"><span data-stu-id="81c09-125">This DDoS defense system is designed to withstand not only attacks from the outside but also from other Azure tenants.</span></span> <span data-ttu-id="81c09-126">For more information, see [Azure network security](http://download.microsoft.com/download/C/A/3/CA3FC5C0-ECE0-4F87-BF4B-D74064A00846/AzureNetworkSecurity_v3_Feb2015.pdf).</span><span class="sxs-lookup"><span data-stu-id="81c09-126">For more information, see [Azure network security](http://download.microsoft.com/download/C/A/3/CA3FC5C0-ECE0-4F87-BF4B-D74064A00846/AzureNetworkSecurity_v3_Feb2015.pdf).</span></span>

<span data-ttu-id="81c09-127">You also can create a startup task to selectively block some specific IP addresses.</span><span class="sxs-lookup"><span data-stu-id="81c09-127">You also can create a startup task to selectively block some specific IP addresses.</span></span> <span data-ttu-id="81c09-128">For more information, see [Block a specific IP address](cloud-services-startup-tasks-common.md#block-a-specific-ip-address).</span><span class="sxs-lookup"><span data-stu-id="81c09-128">For more information, see [Block a specific IP address](cloud-services-startup-tasks-common.md#block-a-specific-ip-address).</span></span>

## <a name="when-i-try-to-rdp-to-my-cloud-service-instance-i-get-the-message-the-user-account-has-expired"></a><span data-ttu-id="81c09-129">When I try to RDP to my cloud service instance, I get the message "The user account has expired."</span><span class="sxs-lookup"><span data-stu-id="81c09-129">When I try to RDP to my cloud service instance, I get the message "The user account has expired."</span></span>
<span data-ttu-id="81c09-130">You might get the error message "This user account has expired" when you bypass the expiration date that is configured in your RDP settings.</span><span class="sxs-lookup"><span data-stu-id="81c09-130">You might get the error message "This user account has expired" when you bypass the expiration date that is configured in your RDP settings.</span></span> <span data-ttu-id="81c09-131">You can change the expiration date from the portal by following these steps:</span><span class="sxs-lookup"><span data-stu-id="81c09-131">You can change the expiration date from the portal by following these steps:</span></span>

1. <span data-ttu-id="81c09-132">Sign in to the [Azure portal](https://portal.azure.com), go to your cloud service, and select the **Remote Desktop** tab.</span><span class="sxs-lookup"><span data-stu-id="81c09-132">Sign in to the [Azure portal](https://portal.azure.com), go to your cloud service, and select the **Remote Desktop** tab.</span></span>

2. <span data-ttu-id="81c09-133">Select the **Production** or **Staging** deployment slot.</span><span class="sxs-lookup"><span data-stu-id="81c09-133">Select the **Production** or **Staging** deployment slot.</span></span>

3. <span data-ttu-id="81c09-134">Change the **Expires On** date, and then save the configuration.</span><span class="sxs-lookup"><span data-stu-id="81c09-134">Change the **Expires On** date, and then save the configuration.</span></span>

<span data-ttu-id="81c09-135">You now should be able to RDP to your machine.</span><span class="sxs-lookup"><span data-stu-id="81c09-135">You now should be able to RDP to your machine.</span></span>

## <a name="why-is-azure-load-balancer-not-balancing-traffic-equally"></a><span data-ttu-id="81c09-136">Why is Azure Load Balancer not balancing traffic equally?</span><span class="sxs-lookup"><span data-stu-id="81c09-136">Why is Azure Load Balancer not balancing traffic equally?</span></span>
<span data-ttu-id="81c09-137">For information about how an internal load balancer works, see [Azure Load Balancer new distribution mode](https://azure.microsoft.com/blog/azure-load-balancer-new-distribution-mode/).</span><span class="sxs-lookup"><span data-stu-id="81c09-137">For information about how an internal load balancer works, see [Azure Load Balancer new distribution mode](https://azure.microsoft.com/blog/azure-load-balancer-new-distribution-mode/).</span></span>

<span data-ttu-id="81c09-138">The distribution algorithm used is a 5-tuple (source IP, source port, destination IP, destination port, and protocol type) hash to map traffic to available servers.</span><span class="sxs-lookup"><span data-stu-id="81c09-138">The distribution algorithm used is a 5-tuple (source IP, source port, destination IP, destination port, and protocol type) hash to map traffic to available servers.</span></span> <span data-ttu-id="81c09-139">It provides stickiness only within a transport session.</span><span class="sxs-lookup"><span data-stu-id="81c09-139">It provides stickiness only within a transport session.</span></span> <span data-ttu-id="81c09-140">Packets in the same TCP or UDP session are directed to the same datacenter IP (DIP) instance behind the load-balanced endpoint.</span><span class="sxs-lookup"><span data-stu-id="81c09-140">Packets in the same TCP or UDP session are directed to the same datacenter IP (DIP) instance behind the load-balanced endpoint.</span></span> <span data-ttu-id="81c09-141">When the client closes and reopens the connection or starts a new session from the same source IP, the source port changes and causes the traffic to go to a different DIP endpoint.</span><span class="sxs-lookup"><span data-stu-id="81c09-141">When the client closes and reopens the connection or starts a new session from the same source IP, the source port changes and causes the traffic to go to a different DIP endpoint.</span></span>

## <a name="how-can-i-redirect-incoming-traffic-to-the-default-url-of-my-cloud-service-to-a-custom-url"></a><span data-ttu-id="81c09-142">How can I redirect incoming traffic to the default URL of my cloud service to a custom URL?</span><span class="sxs-lookup"><span data-stu-id="81c09-142">How can I redirect incoming traffic to the default URL of my cloud service to a custom URL?</span></span> 

<span data-ttu-id="81c09-143">The URL Rewrite module of IIS can be used to redirect traffic that comes to the default URL for the cloud service (for example, \*.cloudapp.net) to some custom name/URL.</span><span class="sxs-lookup"><span data-stu-id="81c09-143">The URL Rewrite module of IIS can be used to redirect traffic that comes to the default URL for the cloud service (for example, \*.cloudapp.net) to some custom name/URL.</span></span> <span data-ttu-id="81c09-144">Because the URL Rewrite module is enabled on web roles by default and its rules are configured in the application's web.config, it's always available on the VM regardless of reboots/reimages.</span><span class="sxs-lookup"><span data-stu-id="81c09-144">Because the URL Rewrite module is enabled on web roles by default and its rules are configured in the application's web.config, it's always available on the VM regardless of reboots/reimages.</span></span> <span data-ttu-id="81c09-145">For more information, see:</span><span class="sxs-lookup"><span data-stu-id="81c09-145">For more information, see:</span></span>

- [<span data-ttu-id="81c09-146">Create rewrite rules for the URL Rewrite module</span><span class="sxs-lookup"><span data-stu-id="81c09-146">Create rewrite rules for the URL Rewrite module</span></span>](https://docs.microsoft.com/iis/extensions/url-rewrite-module/creating-rewrite-rules-for-the-url-rewrite-module)
- [<span data-ttu-id="81c09-147">Remove a default link</span><span class="sxs-lookup"><span data-stu-id="81c09-147">Remove a default link</span></span>](https://stackoverflow.com/questions/32286487/azure-website-how-to-remove-default-link?answertab=votes#tab-top)

## <a name="how-can-i-blockdisable-incoming-traffic-to-the-default-url-of-my-cloud-service"></a><span data-ttu-id="81c09-148">How can I block/disable incoming traffic to the default URL of my cloud service?</span><span class="sxs-lookup"><span data-stu-id="81c09-148">How can I block/disable incoming traffic to the default URL of my cloud service?</span></span> 

<span data-ttu-id="81c09-149">You can prevent incoming traffic to the default URL/name of your cloud service (for example, \*.cloudapp.net).</span><span class="sxs-lookup"><span data-stu-id="81c09-149">You can prevent incoming traffic to the default URL/name of your cloud service (for example, \*.cloudapp.net).</span></span> <span data-ttu-id="81c09-150">Set the host header to a custom DNS name (for example, www.MyCloudService.com) under site binding configuration in the cloud service definition (\*.csdef) file, as indicated:</span><span class="sxs-lookup"><span data-stu-id="81c09-150">Set the host header to a custom DNS name (for example, www.MyCloudService.com) under site binding configuration in the cloud service definition (\*.csdef) file, as indicated:</span></span> 
 

    <?xml version="1.0" encoding="utf-8"?> 
    <ServiceDefinition name="AzureCloudServicesDemo" xmlns="http://schemas.microsoft.com/ServiceHosting/2008/10/ServiceDefinition" schemaVersion="2015-04.2.6"> 
      <WebRole name="MyWebRole" vmsize="Small"> 
        <Sites> 
          <Site name="Web"> 
            <Bindings> 
              <Binding name="Endpoint1" endpointName="Endpoint1" hostHeader="www.MyCloudService.com" /> 
            </Bindings> 
          </Site> 
        </Sites> 
        <Endpoints> 
          <InputEndpoint name="Endpoint1" protocol="http" port="80" /> 
        </Endpoints> 
        <ConfigurationSettings> 
          <Setting name="Microsoft.WindowsAzure.Plugins.Diagnostics.ConnectionString" /> 
        </ConfigurationSettings> 
      </WebRole> 
    </ServiceDefinition> 
 
<span data-ttu-id="81c09-151">Because this host header binding is enforced through the csdef file, the service is accessible only via the custom name "www.MyCloudService.com."</span><span class="sxs-lookup"><span data-stu-id="81c09-151">Because this host header binding is enforced through the csdef file, the service is accessible only via the custom name "www.MyCloudService.com."</span></span> <span data-ttu-id="81c09-152">All incoming requests to the "\*.cloudapp.net" domain always fail.</span><span class="sxs-lookup"><span data-stu-id="81c09-152">All incoming requests to the "\*.cloudapp.net" domain always fail.</span></span> <span data-ttu-id="81c09-153">If you use a custom SLB probe or an internal load balancer in the service, blocking the default URL/name of the service might interfere with the probing behavior.</span><span class="sxs-lookup"><span data-stu-id="81c09-153">If you use a custom SLB probe or an internal load balancer in the service, blocking the default URL/name of the service might interfere with the probing behavior.</span></span> 

## <a name="how-can-i-make-sure-the-public-facing-ip-address-of-a-cloud-service-never-changes"></a><span data-ttu-id="81c09-154">How can I make sure the public-facing IP address of a cloud service never changes?</span><span class="sxs-lookup"><span data-stu-id="81c09-154">How can I make sure the public-facing IP address of a cloud service never changes?</span></span>

<span data-ttu-id="81c09-155">To make sure the public-facing IP address of your cloud service (also known as a VIP) never changes so that it can be customarily whitelisted by a few specific clients, we recommend that you have a reserved IP associated with it.</span><span class="sxs-lookup"><span data-stu-id="81c09-155">To make sure the public-facing IP address of your cloud service (also known as a VIP) never changes so that it can be customarily whitelisted by a few specific clients, we recommend that you have a reserved IP associated with it.</span></span> <span data-ttu-id="81c09-156">Otherwise, the virtual IP provided by Azure is deallocated from your subscription if you delete the deployment.</span><span class="sxs-lookup"><span data-stu-id="81c09-156">Otherwise, the virtual IP provided by Azure is deallocated from your subscription if you delete the deployment.</span></span> <span data-ttu-id="81c09-157">For successful VIP swap operation, you need individual reserved IPs for both production and staging slots.</span><span class="sxs-lookup"><span data-stu-id="81c09-157">For successful VIP swap operation, you need individual reserved IPs for both production and staging slots.</span></span> <span data-ttu-id="81c09-158">Without them, the swap operation fails.</span><span class="sxs-lookup"><span data-stu-id="81c09-158">Without them, the swap operation fails.</span></span> <span data-ttu-id="81c09-159">To reserve an IP address and associate it with your cloud service, see these articles:</span><span class="sxs-lookup"><span data-stu-id="81c09-159">To reserve an IP address and associate it with your cloud service, see these articles:</span></span>
 
- [<span data-ttu-id="81c09-160">Reserve the IP address of an existing cloud service</span><span class="sxs-lookup"><span data-stu-id="81c09-160">Reserve the IP address of an existing cloud service</span></span>](../virtual-network/virtual-networks-reserved-public-ip.md#reserve-the-ip-address-of-an-existing-cloud-service)
- [<span data-ttu-id="81c09-161">Associate a reserved IP to a cloud service by using a service configuration file</span><span class="sxs-lookup"><span data-stu-id="81c09-161">Associate a reserved IP to a cloud service by using a service configuration file</span></span>](../virtual-network/virtual-networks-reserved-public-ip.md#associate-a-reserved-ip-to-a-cloud-service-by-using-a-service-configuration-file) 

<span data-ttu-id="81c09-162">If you have more than one instance for your roles, associating RIP with your cloud service shouldn't cause any downtime.</span><span class="sxs-lookup"><span data-stu-id="81c09-162">If you have more than one instance for your roles, associating RIP with your cloud service shouldn't cause any downtime.</span></span> <span data-ttu-id="81c09-163">Alternatively, you can whitelist the IP range of your Azure datacenter.</span><span class="sxs-lookup"><span data-stu-id="81c09-163">Alternatively, you can whitelist the IP range of your Azure datacenter.</span></span> <span data-ttu-id="81c09-164">You can find all Azure IP ranges at the [Microsoft Download Center](https://www.microsoft.com/en-us/download/details.aspx?id=41653).</span><span class="sxs-lookup"><span data-stu-id="81c09-164">You can find all Azure IP ranges at the [Microsoft Download Center](https://www.microsoft.com/en-us/download/details.aspx?id=41653).</span></span> 

<span data-ttu-id="81c09-165">This file contains the IP address ranges (including compute, SQL, and storage ranges) used in Azure datacenters.</span><span class="sxs-lookup"><span data-stu-id="81c09-165">This file contains the IP address ranges (including compute, SQL, and storage ranges) used in Azure datacenters.</span></span> <span data-ttu-id="81c09-166">An updated file is posted weekly that reflects the currently deployed ranges and any upcoming changes to the IP ranges.</span><span class="sxs-lookup"><span data-stu-id="81c09-166">An updated file is posted weekly that reflects the currently deployed ranges and any upcoming changes to the IP ranges.</span></span> <span data-ttu-id="81c09-167">New ranges that appear in the file aren't used in the datacenters for at least one week.</span><span class="sxs-lookup"><span data-stu-id="81c09-167">New ranges that appear in the file aren't used in the datacenters for at least one week.</span></span> <span data-ttu-id="81c09-168">Download the new .xml file every week, and perform the necessary changes on your site to correctly identify services running in Azure.</span><span class="sxs-lookup"><span data-stu-id="81c09-168">Download the new .xml file every week, and perform the necessary changes on your site to correctly identify services running in Azure.</span></span> <span data-ttu-id="81c09-169">Azure ExpressRoute users might note that this file used to update the BGP advertisement of Azure space in the first week of each month.</span><span class="sxs-lookup"><span data-stu-id="81c09-169">Azure ExpressRoute users might note that this file used to update the BGP advertisement of Azure space in the first week of each month.</span></span> 

## <a name="how-can-i-use-azure-resource-manager-virtual-networks-with-cloud-services"></a><span data-ttu-id="81c09-170">How can I use Azure Resource Manager virtual networks with cloud services?</span><span class="sxs-lookup"><span data-stu-id="81c09-170">How can I use Azure Resource Manager virtual networks with cloud services?</span></span> 

<span data-ttu-id="81c09-171">Cloud services can't be placed in Azure Resource Manager virtual networks.</span><span class="sxs-lookup"><span data-stu-id="81c09-171">Cloud services can't be placed in Azure Resource Manager virtual networks.</span></span> <span data-ttu-id="81c09-172">Resource Manager virtual networks and classic deployment virtual networks can be connected through peering.</span><span class="sxs-lookup"><span data-stu-id="81c09-172">Resource Manager virtual networks and classic deployment virtual networks can be connected through peering.</span></span> <span data-ttu-id="81c09-173">For more information, see [Virtual network peering](../virtual-network/virtual-network-peering-overview.md).</span><span class="sxs-lookup"><span data-stu-id="81c09-173">For more information, see [Virtual network peering](../virtual-network/virtual-network-peering-overview.md).</span></span>
