---
title: Using Azure CDN with SAS | Microsoft Docs
description: Azure CDN supports the use of Shared Access Signature (SAS) to grant limited access to private storage containers.
services: cdn
documentationcenter: ''
author: dksimpson
manager: cfowler
editor: ''
ms.assetid: ''
ms.service: cdn
ms.workload: tbd
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 06/21/2018
ms.author: v-deasim
ms.openlocfilehash: 15a4e0a8d62b38fa7aa542d95e53d29621965666
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44857314"
---
# <a name="using-azure-cdn-with-sas"></a><span data-ttu-id="53ad8-103">Using Azure CDN with SAS</span><span class="sxs-lookup"><span data-stu-id="53ad8-103">Using Azure CDN with SAS</span></span>

<span data-ttu-id="53ad8-104">When you set up a storage account for Azure Content Delivery Network (CDN) to use to cache content, by default anyone who knows the URLs for your storage containers can access the files that you've uploaded.</span><span class="sxs-lookup"><span data-stu-id="53ad8-104">When you set up a storage account for Azure Content Delivery Network (CDN) to use to cache content, by default anyone who knows the URLs for your storage containers can access the files that you've uploaded.</span></span> <span data-ttu-id="53ad8-105">To protect the files in your storage account, you can set the access of your storage containers from public to private.</span><span class="sxs-lookup"><span data-stu-id="53ad8-105">To protect the files in your storage account, you can set the access of your storage containers from public to private.</span></span> <span data-ttu-id="53ad8-106">However, if you do so, no one will be able to access your files.</span><span class="sxs-lookup"><span data-stu-id="53ad8-106">However, if you do so, no one will be able to access your files.</span></span> 

<span data-ttu-id="53ad8-107">If you want to grant limited access to private storage containers, you can use the Shared Access Signature (SAS) feature of your Azure storage account.</span><span class="sxs-lookup"><span data-stu-id="53ad8-107">If you want to grant limited access to private storage containers, you can use the Shared Access Signature (SAS) feature of your Azure storage account.</span></span> <span data-ttu-id="53ad8-108">A SAS is a URI that grants restricted access rights to your Azure Storage resources without exposing your account key.</span><span class="sxs-lookup"><span data-stu-id="53ad8-108">A SAS is a URI that grants restricted access rights to your Azure Storage resources without exposing your account key.</span></span> <span data-ttu-id="53ad8-109">You can provide a SAS to clients that you do not trust with your storage account key but to whom you want to delegate access to certain storage account resources.</span><span class="sxs-lookup"><span data-stu-id="53ad8-109">You can provide a SAS to clients that you do not trust with your storage account key but to whom you want to delegate access to certain storage account resources.</span></span> <span data-ttu-id="53ad8-110">By distributing a shared access signature URI to these clients, you grant them access to a resource for a specified period of time.</span><span class="sxs-lookup"><span data-stu-id="53ad8-110">By distributing a shared access signature URI to these clients, you grant them access to a resource for a specified period of time.</span></span>
 
<span data-ttu-id="53ad8-111">With a SAS, you can define various parameters of access to a blob, such as start and expiry times, permissions (read/write), and IP ranges.</span><span class="sxs-lookup"><span data-stu-id="53ad8-111">With a SAS, you can define various parameters of access to a blob, such as start and expiry times, permissions (read/write), and IP ranges.</span></span> <span data-ttu-id="53ad8-112">This article describes how to use SAS in conjunction with Azure CDN.</span><span class="sxs-lookup"><span data-stu-id="53ad8-112">This article describes how to use SAS in conjunction with Azure CDN.</span></span> <span data-ttu-id="53ad8-113">For more information about SAS, including how to create it and its parameter options, see [Using shared access signatures (SAS)](https://docs.microsoft.com/azure/storage/common/storage-dotnet-shared-access-signature-part-1).</span><span class="sxs-lookup"><span data-stu-id="53ad8-113">For more information about SAS, including how to create it and its parameter options, see [Using shared access signatures (SAS)](https://docs.microsoft.com/azure/storage/common/storage-dotnet-shared-access-signature-part-1).</span></span>

## <a name="setting-up-azure-cdn-to-work-with-storage-sas"></a><span data-ttu-id="53ad8-114">Setting up Azure CDN to work with storage SAS</span><span class="sxs-lookup"><span data-stu-id="53ad8-114">Setting up Azure CDN to work with storage SAS</span></span>
<span data-ttu-id="53ad8-115">The following three options are recommended for using SAS with Azure CDN.</span><span class="sxs-lookup"><span data-stu-id="53ad8-115">The following three options are recommended for using SAS with Azure CDN.</span></span> <span data-ttu-id="53ad8-116">All options assume that you have already created a working SAS (see prerequisites).</span><span class="sxs-lookup"><span data-stu-id="53ad8-116">All options assume that you have already created a working SAS (see prerequisites).</span></span> 
 
### <a name="prerequisites"></a><span data-ttu-id="53ad8-117">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="53ad8-117">Prerequisites</span></span>
<span data-ttu-id="53ad8-118">To start, create a storage account and then generate a SAS for your asset.</span><span class="sxs-lookup"><span data-stu-id="53ad8-118">To start, create a storage account and then generate a SAS for your asset.</span></span> <span data-ttu-id="53ad8-119">You can generate two types of stored access signatures: a service SAS or an account SAS.</span><span class="sxs-lookup"><span data-stu-id="53ad8-119">You can generate two types of stored access signatures: a service SAS or an account SAS.</span></span> <span data-ttu-id="53ad8-120">For more information, see [Types of shared access signatures](https://docs.microsoft.com/azure/storage/common/storage-dotnet-shared-access-signature-part-1#types-of-shared-access-signatures).</span><span class="sxs-lookup"><span data-stu-id="53ad8-120">For more information, see [Types of shared access signatures](https://docs.microsoft.com/azure/storage/common/storage-dotnet-shared-access-signature-part-1#types-of-shared-access-signatures).</span></span>

<span data-ttu-id="53ad8-121">After you've generated a SAS token, you can access your blob storage file by appending `?sv=<SAS token>` to your URL.</span><span class="sxs-lookup"><span data-stu-id="53ad8-121">After you've generated a SAS token, you can access your blob storage file by appending `?sv=<SAS token>` to your URL.</span></span> <span data-ttu-id="53ad8-122">This URL has the following format:</span><span class="sxs-lookup"><span data-stu-id="53ad8-122">This URL has the following format:</span></span> 

`https://<account name>.blob.core.windows.net/<container>/<file>?sv=<SAS token>`
 
<span data-ttu-id="53ad8-123">For example:</span><span class="sxs-lookup"><span data-stu-id="53ad8-123">For example:</span></span>
 ```
https://democdnstorage1.blob.core.windows.net/container1/demo.jpg?sv=2017-07-29&ss=b&srt=co&sp=r&se=2038-01-02T21:30:49Z&st=2018-01-02T13:30:49Z&spr=https&sig=QehoetQFWUEd1lhU5iOMGrHBmE727xYAbKJl5ohSiWI%3D
```

<span data-ttu-id="53ad8-124">For more information about setting parameters, see [SAS parameter considerations](#sas-parameter-considerations) and [Shared access signature parameters](https://docs.microsoft.com/azure/storage/common/storage-dotnet-shared-access-signature-part-1#shared-access-signature-parameters).</span><span class="sxs-lookup"><span data-stu-id="53ad8-124">For more information about setting parameters, see [SAS parameter considerations](#sas-parameter-considerations) and [Shared access signature parameters](https://docs.microsoft.com/azure/storage/common/storage-dotnet-shared-access-signature-part-1#shared-access-signature-parameters).</span></span>

![CDN SAS settings](./media/cdn-sas-storage-support/cdn-sas-settings.png)

### <a name="option-1-using-sas-with-pass-through-to-blob-storage-from-azure-cdn"></a><span data-ttu-id="53ad8-126">Option 1: Using SAS with pass-through to blob storage from Azure CDN</span><span class="sxs-lookup"><span data-stu-id="53ad8-126">Option 1: Using SAS with pass-through to blob storage from Azure CDN</span></span>

<span data-ttu-id="53ad8-127">This option is the simplest and uses a single SAS token, which is passed from Azure CDN to the origin server.</span><span class="sxs-lookup"><span data-stu-id="53ad8-127">This option is the simplest and uses a single SAS token, which is passed from Azure CDN to the origin server.</span></span> <span data-ttu-id="53ad8-128">It's supported by **Azure CDN Standard from Verizon** and **Azure CDN Standard from Akamai** profiles.</span><span class="sxs-lookup"><span data-stu-id="53ad8-128">It's supported by **Azure CDN Standard from Verizon** and **Azure CDN Standard from Akamai** profiles.</span></span> 
 
1. <span data-ttu-id="53ad8-129">Select an endpoint, select **Caching rules**, then select **Cache every unique URL** from the **Query string caching** list.</span><span class="sxs-lookup"><span data-stu-id="53ad8-129">Select an endpoint, select **Caching rules**, then select **Cache every unique URL** from the **Query string caching** list.</span></span>

    ![CDN caching rules](./media/cdn-sas-storage-support/cdn-caching-rules.png)

2. <span data-ttu-id="53ad8-131">After you set up SAS on your storage account, you must use the SAS token with the CDN endpoint and origin server URLs to access the file.</span><span class="sxs-lookup"><span data-stu-id="53ad8-131">After you set up SAS on your storage account, you must use the SAS token with the CDN endpoint and origin server URLs to access the file.</span></span> 
   
   <span data-ttu-id="53ad8-132">The resulting CDN endpoint URL has the following format: `https://<endpoint hostname>.azureedge.net/<container>/<file>?sv=<SAS token>`</span><span class="sxs-lookup"><span data-stu-id="53ad8-132">The resulting CDN endpoint URL has the following format: `https://<endpoint hostname>.azureedge.net/<container>/<file>?sv=<SAS token>`</span></span>

   <span data-ttu-id="53ad8-133">For example:</span><span class="sxs-lookup"><span data-stu-id="53ad8-133">For example:</span></span>   
   ```
   https://demoendpoint.azureedge.net/container1/demo.jpg/?sv=2017-07-29&ss=b&srt=c&sp=r&se=2027-12-19T17:35:58Z&st=2017-12-19T09:35:58Z&spr=https&sig=kquaXsAuCLXomN7R00b8CYM13UpDbAHcsRfGOW3Du1M%3D
   ```
   
3. <span data-ttu-id="53ad8-134">Fine-tune the cache duration either by using caching rules or by adding `Cache-Control` headers at the origin server.</span><span class="sxs-lookup"><span data-stu-id="53ad8-134">Fine-tune the cache duration either by using caching rules or by adding `Cache-Control` headers at the origin server.</span></span> <span data-ttu-id="53ad8-135">Because Azure CDN treats the SAS token as a plain query string, as a best practice you should set up a caching duration that expires at or before the SAS expiration time.</span><span class="sxs-lookup"><span data-stu-id="53ad8-135">Because Azure CDN treats the SAS token as a plain query string, as a best practice you should set up a caching duration that expires at or before the SAS expiration time.</span></span> <span data-ttu-id="53ad8-136">Otherwise, if a file is cached for a longer duration than the SAS is active, the file may be accessible from the Azure CDN origin server after the SAS expiration time has elapsed.</span><span class="sxs-lookup"><span data-stu-id="53ad8-136">Otherwise, if a file is cached for a longer duration than the SAS is active, the file may be accessible from the Azure CDN origin server after the SAS expiration time has elapsed.</span></span> <span data-ttu-id="53ad8-137">If this situation occurs, and you want to make your cached file inaccessible, you must perform a purge operation on the file to clear it from the cache.</span><span class="sxs-lookup"><span data-stu-id="53ad8-137">If this situation occurs, and you want to make your cached file inaccessible, you must perform a purge operation on the file to clear it from the cache.</span></span> <span data-ttu-id="53ad8-138">For information about setting the cache duration on Azure CDN, see [Control Azure CDN caching behavior with caching rules](cdn-caching-rules.md).</span><span class="sxs-lookup"><span data-stu-id="53ad8-138">For information about setting the cache duration on Azure CDN, see [Control Azure CDN caching behavior with caching rules](cdn-caching-rules.md).</span></span>

### <a name="option-2-hidden-cdn-sas-token-using-a-rewrite-rule"></a><span data-ttu-id="53ad8-139">Option 2: Hidden CDN SAS token using a rewrite rule</span><span class="sxs-lookup"><span data-stu-id="53ad8-139">Option 2: Hidden CDN SAS token using a rewrite rule</span></span>
 
<span data-ttu-id="53ad8-140">This option is available only for **Azure CDN Premium from Verizon** profiles.</span><span class="sxs-lookup"><span data-stu-id="53ad8-140">This option is available only for **Azure CDN Premium from Verizon** profiles.</span></span> <span data-ttu-id="53ad8-141">With this option, you can secure the blob storage at the origin server.</span><span class="sxs-lookup"><span data-stu-id="53ad8-141">With this option, you can secure the blob storage at the origin server.</span></span> <span data-ttu-id="53ad8-142">You may want to use this option if you don't need specific access restrictions for the file, but want to prevent users from accessing the storage origin directly to improve Azure CDN offload times.</span><span class="sxs-lookup"><span data-stu-id="53ad8-142">You may want to use this option if you don't need specific access restrictions for the file, but want to prevent users from accessing the storage origin directly to improve Azure CDN offload times.</span></span> <span data-ttu-id="53ad8-143">The SAS token, which is unknown to the user, is required for anyone accessing files in the specified container of the origin server.</span><span class="sxs-lookup"><span data-stu-id="53ad8-143">The SAS token, which is unknown to the user, is required for anyone accessing files in the specified container of the origin server.</span></span> <span data-ttu-id="53ad8-144">However, because of the URL Rewrite rule, the SAS token is not required on the CDN endpoint.</span><span class="sxs-lookup"><span data-stu-id="53ad8-144">However, because of the URL Rewrite rule, the SAS token is not required on the CDN endpoint.</span></span>
 
1. <span data-ttu-id="53ad8-145">Use the [rules engine](cdn-rules-engine.md) to create a URL Rewrite rule.</span><span class="sxs-lookup"><span data-stu-id="53ad8-145">Use the [rules engine](cdn-rules-engine.md) to create a URL Rewrite rule.</span></span> <span data-ttu-id="53ad8-146">New rules take about 10 minutes to propagate.</span><span class="sxs-lookup"><span data-stu-id="53ad8-146">New rules take about 10 minutes to propagate.</span></span>

   ![CDN Manage button](./media/cdn-sas-storage-support/cdn-manage-btn.png)

   ![CDN rules engine button](./media/cdn-sas-storage-support/cdn-rules-engine-btn.png)

   <span data-ttu-id="53ad8-149">The following sample URL Rewrite rule uses a regular expression pattern with a capturing group and an endpoint named *storagedemo*:</span><span class="sxs-lookup"><span data-stu-id="53ad8-149">The following sample URL Rewrite rule uses a regular expression pattern with a capturing group and an endpoint named *storagedemo*:</span></span>
   
   <span data-ttu-id="53ad8-150">Source:</span><span class="sxs-lookup"><span data-stu-id="53ad8-150">Source:</span></span>   
   `(\/container1\/.*)`
   
   <span data-ttu-id="53ad8-151">Destination:</span><span class="sxs-lookup"><span data-stu-id="53ad8-151">Destination:</span></span>   
   ```
   $1?sv=2017-07-29&ss=b&srt=c&sp=r&se=2027-12-19T17:35:58Z&st=2017-12-19T09:35:58Z&spr=https&sig=kquaXsAuCLXomN7R00b8CYM13UpDbAHcsRfGOW3Du1M%3D
   ```
   <span data-ttu-id="53ad8-152">![CDN URL Rewrite rule - left](./media/cdn-sas-storage-support/cdn-url-rewrite-rule.png)
   ![CDN URL Rewrite rule - right](./media/cdn-sas-storage-support/cdn-url-rewrite-rule-option-2.png)</span><span class="sxs-lookup"><span data-stu-id="53ad8-152">![CDN URL Rewrite rule - left](./media/cdn-sas-storage-support/cdn-url-rewrite-rule.png)
![CDN URL Rewrite rule - right](./media/cdn-sas-storage-support/cdn-url-rewrite-rule-option-2.png)</span></span>

2. <span data-ttu-id="53ad8-153">After the new rule becomes active, anyone can access files in the specified container on the CDN endpoint regardless of whether they're using a SAS token in the URL.</span><span class="sxs-lookup"><span data-stu-id="53ad8-153">After the new rule becomes active, anyone can access files in the specified container on the CDN endpoint regardless of whether they're using a SAS token in the URL.</span></span> <span data-ttu-id="53ad8-154">Here is the format: `https://<endpoint hostname>.azureedge.net/<container>/<file>`</span><span class="sxs-lookup"><span data-stu-id="53ad8-154">Here is the format: `https://<endpoint hostname>.azureedge.net/<container>/<file>`</span></span>
 
   <span data-ttu-id="53ad8-155">For example:</span><span class="sxs-lookup"><span data-stu-id="53ad8-155">For example:</span></span>   
   `https://demoendpoint.azureedge.net/container1/demo.jpg`
       

3. <span data-ttu-id="53ad8-156">Fine-tune the cache duration either by using caching rules or by adding `Cache-Control` headers at the origin server.</span><span class="sxs-lookup"><span data-stu-id="53ad8-156">Fine-tune the cache duration either by using caching rules or by adding `Cache-Control` headers at the origin server.</span></span> <span data-ttu-id="53ad8-157">Because Azure CDN treats the SAS token as a plain query string, as a best practice you should set up a caching duration that expires at or before the SAS expiration time.</span><span class="sxs-lookup"><span data-stu-id="53ad8-157">Because Azure CDN treats the SAS token as a plain query string, as a best practice you should set up a caching duration that expires at or before the SAS expiration time.</span></span> <span data-ttu-id="53ad8-158">Otherwise, if a file is cached for a longer duration than the SAS is active, the file may be accessible from the Azure CDN origin server after the SAS expiration time has elapsed.</span><span class="sxs-lookup"><span data-stu-id="53ad8-158">Otherwise, if a file is cached for a longer duration than the SAS is active, the file may be accessible from the Azure CDN origin server after the SAS expiration time has elapsed.</span></span> <span data-ttu-id="53ad8-159">If this situation occurs, and you want to make your cached file inaccessible, you must perform a purge operation on the file to clear it from the cache.</span><span class="sxs-lookup"><span data-stu-id="53ad8-159">If this situation occurs, and you want to make your cached file inaccessible, you must perform a purge operation on the file to clear it from the cache.</span></span> <span data-ttu-id="53ad8-160">For information about setting the cache duration on Azure CDN, see [Control Azure CDN caching behavior with caching rules](cdn-caching-rules.md).</span><span class="sxs-lookup"><span data-stu-id="53ad8-160">For information about setting the cache duration on Azure CDN, see [Control Azure CDN caching behavior with caching rules](cdn-caching-rules.md).</span></span>

### <a name="option-3-using-cdn-security-token-authentication-with-a-rewrite-rule"></a><span data-ttu-id="53ad8-161">Option 3: Using CDN security token authentication with a rewrite rule</span><span class="sxs-lookup"><span data-stu-id="53ad8-161">Option 3: Using CDN security token authentication with a rewrite rule</span></span>

<span data-ttu-id="53ad8-162">To use Azure CDN security token authentication, you must have an **Azure CDN Premium from Verizon** profile.</span><span class="sxs-lookup"><span data-stu-id="53ad8-162">To use Azure CDN security token authentication, you must have an **Azure CDN Premium from Verizon** profile.</span></span> <span data-ttu-id="53ad8-163">This option is the most secure and customizable.</span><span class="sxs-lookup"><span data-stu-id="53ad8-163">This option is the most secure and customizable.</span></span> <span data-ttu-id="53ad8-164">Client access is based on the security parameters that you set on the security token.</span><span class="sxs-lookup"><span data-stu-id="53ad8-164">Client access is based on the security parameters that you set on the security token.</span></span> <span data-ttu-id="53ad8-165">Once you've created and set up the security token, it will be required on all CDN endpoint URLs.</span><span class="sxs-lookup"><span data-stu-id="53ad8-165">Once you've created and set up the security token, it will be required on all CDN endpoint URLs.</span></span> <span data-ttu-id="53ad8-166">However, because of the URL Rewrite rule, the SAS token is not required on the CDN endpoint.</span><span class="sxs-lookup"><span data-stu-id="53ad8-166">However, because of the URL Rewrite rule, the SAS token is not required on the CDN endpoint.</span></span> <span data-ttu-id="53ad8-167">If the SAS token later becomes invalid, Azure CDN will no longer be able to revalidate the content from the origin server.</span><span class="sxs-lookup"><span data-stu-id="53ad8-167">If the SAS token later becomes invalid, Azure CDN will no longer be able to revalidate the content from the origin server.</span></span>

1. <span data-ttu-id="53ad8-168">[Create an Azure CDN security token](https://docs.microsoft.com/azure/cdn/cdn-token-auth#setting-up-token-authentication) and activate it by using the rules engine for the CDN endpoint and path where your users can access the file.</span><span class="sxs-lookup"><span data-stu-id="53ad8-168">[Create an Azure CDN security token](https://docs.microsoft.com/azure/cdn/cdn-token-auth#setting-up-token-authentication) and activate it by using the rules engine for the CDN endpoint and path where your users can access the file.</span></span>

   <span data-ttu-id="53ad8-169">A security token endpoint URL has the following format:</span><span class="sxs-lookup"><span data-stu-id="53ad8-169">A security token endpoint URL has the following format:</span></span>   
   `https://<endpoint hostname>.azureedge.net/<container>/<file>?<security_token>`
 
   <span data-ttu-id="53ad8-170">For example:</span><span class="sxs-lookup"><span data-stu-id="53ad8-170">For example:</span></span>   
   ```
   https://demoendpoint.azureedge.net/container1/demo.jpg?a4fbc3710fd3449a7c99986bkquaXsAuCLXomN7R00b8CYM13UpDbAHcsRfGOW3Du1M%3D
   ```
       
   <span data-ttu-id="53ad8-171">The parameter options for a security token authentication are different than the parameter options for a SAS token.</span><span class="sxs-lookup"><span data-stu-id="53ad8-171">The parameter options for a security token authentication are different than the parameter options for a SAS token.</span></span> <span data-ttu-id="53ad8-172">If you choose to use an expiration time when you create a security token, you should set it to the same value as the expiration time for the SAS token.</span><span class="sxs-lookup"><span data-stu-id="53ad8-172">If you choose to use an expiration time when you create a security token, you should set it to the same value as the expiration time for the SAS token.</span></span> <span data-ttu-id="53ad8-173">Doing so ensures that the expiration time is predictable.</span><span class="sxs-lookup"><span data-stu-id="53ad8-173">Doing so ensures that the expiration time is predictable.</span></span> 
 
2. <span data-ttu-id="53ad8-174">Use the [rules engine](cdn-rules-engine.md) to create a URL Rewrite rule to enable SAS token access to all blobs in the container.</span><span class="sxs-lookup"><span data-stu-id="53ad8-174">Use the [rules engine](cdn-rules-engine.md) to create a URL Rewrite rule to enable SAS token access to all blobs in the container.</span></span> <span data-ttu-id="53ad8-175">New rules take about 10 minutes to propagate.</span><span class="sxs-lookup"><span data-stu-id="53ad8-175">New rules take about 10 minutes to propagate.</span></span>

   <span data-ttu-id="53ad8-176">The following sample URL Rewrite rule uses a regular expression pattern with a capturing group and an endpoint named *storagedemo*:</span><span class="sxs-lookup"><span data-stu-id="53ad8-176">The following sample URL Rewrite rule uses a regular expression pattern with a capturing group and an endpoint named *storagedemo*:</span></span>
   
   <span data-ttu-id="53ad8-177">Source:</span><span class="sxs-lookup"><span data-stu-id="53ad8-177">Source:</span></span>   
   `(\/container1\/.*)`
   
   <span data-ttu-id="53ad8-178">Destination:</span><span class="sxs-lookup"><span data-stu-id="53ad8-178">Destination:</span></span>   
   ```
   $1&sv=2017-07-29&ss=b&srt=c&sp=r&se=2027-12-19T17:35:58Z&st=2017-12-19T09:35:58Z&spr=https&sig=kquaXsAuCLXomN7R00b8CYM13UpDbAHcsRfGOW3Du1M%3D
   ```
   <span data-ttu-id="53ad8-179">![CDN URL Rewrite rule - left](./media/cdn-sas-storage-support/cdn-url-rewrite-rule.png)
   ![CDN URL Rewrite rule - right](./media/cdn-sas-storage-support/cdn-url-rewrite-rule-option-3.png)</span><span class="sxs-lookup"><span data-stu-id="53ad8-179">![CDN URL Rewrite rule - left](./media/cdn-sas-storage-support/cdn-url-rewrite-rule.png)
![CDN URL Rewrite rule - right](./media/cdn-sas-storage-support/cdn-url-rewrite-rule-option-3.png)</span></span>

3. <span data-ttu-id="53ad8-180">If you renew the SAS, ensure that you update the Url Rewrite rule with the new SAS token.</span><span class="sxs-lookup"><span data-stu-id="53ad8-180">If you renew the SAS, ensure that you update the Url Rewrite rule with the new SAS token.</span></span> 

## <a name="sas-parameter-considerations"></a><span data-ttu-id="53ad8-181">SAS parameter considerations</span><span class="sxs-lookup"><span data-stu-id="53ad8-181">SAS parameter considerations</span></span>

<span data-ttu-id="53ad8-182">Because SAS parameters are not visible to Azure CDN, Azure CDN cannot change its delivery behavior based on them.</span><span class="sxs-lookup"><span data-stu-id="53ad8-182">Because SAS parameters are not visible to Azure CDN, Azure CDN cannot change its delivery behavior based on them.</span></span> <span data-ttu-id="53ad8-183">The defined parameter restrictions apply only on requests that Azure CDN makes to the origin server, not for requests from the client to Azure CDN.</span><span class="sxs-lookup"><span data-stu-id="53ad8-183">The defined parameter restrictions apply only on requests that Azure CDN makes to the origin server, not for requests from the client to Azure CDN.</span></span> <span data-ttu-id="53ad8-184">This distinction is important to consider when you set SAS parameters.</span><span class="sxs-lookup"><span data-stu-id="53ad8-184">This distinction is important to consider when you set SAS parameters.</span></span> <span data-ttu-id="53ad8-185">If these advanced capabilities are required and you are using [Option 3](#option-3-using-cdn-security-token-authentication-with-a-rewrite-rule), set the appropriate restrictions on the Azure CDN security token.</span><span class="sxs-lookup"><span data-stu-id="53ad8-185">If these advanced capabilities are required and you are using [Option 3](#option-3-using-cdn-security-token-authentication-with-a-rewrite-rule), set the appropriate restrictions on the Azure CDN security token.</span></span>

| <span data-ttu-id="53ad8-186">SAS parameter name</span><span class="sxs-lookup"><span data-stu-id="53ad8-186">SAS parameter name</span></span> | <span data-ttu-id="53ad8-187">Description</span><span class="sxs-lookup"><span data-stu-id="53ad8-187">Description</span></span> |
| --- | --- |
| <span data-ttu-id="53ad8-188">Start</span><span class="sxs-lookup"><span data-stu-id="53ad8-188">Start</span></span> | <span data-ttu-id="53ad8-189">The time that Azure CDN can begin to access the blob file.</span><span class="sxs-lookup"><span data-stu-id="53ad8-189">The time that Azure CDN can begin to access the blob file.</span></span> <span data-ttu-id="53ad8-190">Due to clock skew (when a clock signal arrives at different times for different components), choose a time 15 minutes earlier if you want the asset to be available immediately.</span><span class="sxs-lookup"><span data-stu-id="53ad8-190">Due to clock skew (when a clock signal arrives at different times for different components), choose a time 15 minutes earlier if you want the asset to be available immediately.</span></span> |
| <span data-ttu-id="53ad8-191">End</span><span class="sxs-lookup"><span data-stu-id="53ad8-191">End</span></span> | <span data-ttu-id="53ad8-192">The time after which Azure CDN can no longer access the blob file.</span><span class="sxs-lookup"><span data-stu-id="53ad8-192">The time after which Azure CDN can no longer access the blob file.</span></span> <span data-ttu-id="53ad8-193">Previously cached files on Azure CDN are still accessible.</span><span class="sxs-lookup"><span data-stu-id="53ad8-193">Previously cached files on Azure CDN are still accessible.</span></span> <span data-ttu-id="53ad8-194">To control the file expiry time, either set the appropriate expiry time on the Azure CDN security token or purge the asset.</span><span class="sxs-lookup"><span data-stu-id="53ad8-194">To control the file expiry time, either set the appropriate expiry time on the Azure CDN security token or purge the asset.</span></span> |
| <span data-ttu-id="53ad8-195">Allowed IP addresses</span><span class="sxs-lookup"><span data-stu-id="53ad8-195">Allowed IP addresses</span></span> | <span data-ttu-id="53ad8-196">Optional.</span><span class="sxs-lookup"><span data-stu-id="53ad8-196">Optional.</span></span> <span data-ttu-id="53ad8-197">If you are using **Azure CDN from Verizon**, you can set this parameter to the ranges defined in [Azure CDN from Verizon Edge Server IP Ranges](https://msdn.microsoft.com/library/mt757330.aspx).</span><span class="sxs-lookup"><span data-stu-id="53ad8-197">If you are using **Azure CDN from Verizon**, you can set this parameter to the ranges defined in [Azure CDN from Verizon Edge Server IP Ranges](https://msdn.microsoft.com/library/mt757330.aspx).</span></span> <span data-ttu-id="53ad8-198">If you are using **Azure CDN from Akamai**, you cannot set the IP ranges parameter because the IP addresses are not static.</span><span class="sxs-lookup"><span data-stu-id="53ad8-198">If you are using **Azure CDN from Akamai**, you cannot set the IP ranges parameter because the IP addresses are not static.</span></span>|
| <span data-ttu-id="53ad8-199">Allowed protocols</span><span class="sxs-lookup"><span data-stu-id="53ad8-199">Allowed protocols</span></span> | <span data-ttu-id="53ad8-200">The protocol(s) allowed for a request made with the account SAS.</span><span class="sxs-lookup"><span data-stu-id="53ad8-200">The protocol(s) allowed for a request made with the account SAS.</span></span> <span data-ttu-id="53ad8-201">The HTTPS setting is recommended.</span><span class="sxs-lookup"><span data-stu-id="53ad8-201">The HTTPS setting is recommended.</span></span>|

## <a name="next-steps"></a><span data-ttu-id="53ad8-202">Next steps</span><span class="sxs-lookup"><span data-stu-id="53ad8-202">Next steps</span></span>

<span data-ttu-id="53ad8-203">For more information about SAS, see the following articles:</span><span class="sxs-lookup"><span data-stu-id="53ad8-203">For more information about SAS, see the following articles:</span></span>
- [<span data-ttu-id="53ad8-204">Using shared access signatures (SAS)</span><span class="sxs-lookup"><span data-stu-id="53ad8-204">Using shared access signatures (SAS)</span></span>](https://docs.microsoft.com/azure/storage/common/storage-dotnet-shared-access-signature-part-1)
- [<span data-ttu-id="53ad8-205">Shared Access Signatures, Part 2: Create and use a SAS with Blob storage</span><span class="sxs-lookup"><span data-stu-id="53ad8-205">Shared Access Signatures, Part 2: Create and use a SAS with Blob storage</span></span>](https://docs.microsoft.com/azure/storage/blobs/storage-dotnet-shared-access-signature-part-2)

<span data-ttu-id="53ad8-206">For more information about setting up token authentication, see [Securing Azure Content Delivery Network assets with token authentication](https://docs.microsoft.com/azure/cdn/cdn-token-auth).</span><span class="sxs-lookup"><span data-stu-id="53ad8-206">For more information about setting up token authentication, see [Securing Azure Content Delivery Network assets with token authentication](https://docs.microsoft.com/azure/cdn/cdn-token-auth).</span></span>
