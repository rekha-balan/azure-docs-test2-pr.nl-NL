---
title: Upgrade PhoneFactor to Azure MFA Server | Microsoft Docs
description: Get started with Azure MFA Server when you upgrade from the older phonefactor agent.
services: multi-factor-authentication
documentationcenter: ''
author: kgremban
manager: femila
editor: yossib
ms.assetid: 42838ff7-bdf2-4d06-bacc-b3839a00cd76
ms.service: multi-factor-authentication
ms.workload: identity
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: get-started-article
ms.date: 02/06/2017
ms.author: kgremban
ms.openlocfilehash: 5bbd7088f5d4986a5b1c9f5695a5defb678307a9
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44661326"
---
# <a name="upgrade-the-phonefactor-agent-to-azure-multi-factor-authentication-server"></a><span data-ttu-id="72315-103">Upgrade the PhoneFactor Agent to Azure Multi-Factor Authentication Server</span><span class="sxs-lookup"><span data-stu-id="72315-103">Upgrade the PhoneFactor Agent to Azure Multi-Factor Authentication Server</span></span>
<span data-ttu-id="72315-104">To upgrading the PhoneFactor Agent v5.x or older to Azure Multi-Factor Authentication Server, uninstall the PhoneFactor Agent and affiliated components first.</span><span class="sxs-lookup"><span data-stu-id="72315-104">To upgrading the PhoneFactor Agent v5.x or older to Azure Multi-Factor Authentication Server, uninstall the PhoneFactor Agent and affiliated components first.</span></span> <span data-ttu-id="72315-105">Then the Multi-Factor Authentication Server and its affiliated components can be installed.</span><span class="sxs-lookup"><span data-stu-id="72315-105">Then the Multi-Factor Authentication Server and its affiliated components can be installed.</span></span>

## <a name="uninstall-the-phonefactor-agent"></a><span data-ttu-id="72315-106">Uninstall the PhoneFactor Agent</span><span class="sxs-lookup"><span data-stu-id="72315-106">Uninstall the PhoneFactor Agent</span></span>

1. <span data-ttu-id="72315-107">First, back up the PhoneFactor data file.</span><span class="sxs-lookup"><span data-stu-id="72315-107">First, back up the PhoneFactor data file.</span></span> <span data-ttu-id="72315-108">The default installation location is C:\Program Files\PhoneFactor\Data\Phonefactor.pfdata.</span><span class="sxs-lookup"><span data-stu-id="72315-108">The default installation location is C:\Program Files\PhoneFactor\Data\Phonefactor.pfdata.</span></span>

2. <span data-ttu-id="72315-109">If the User Portal is installed:</span><span class="sxs-lookup"><span data-stu-id="72315-109">If the User Portal is installed:</span></span>
  1. <span data-ttu-id="72315-110">Navigate to the install folder and back up the web.config file.</span><span class="sxs-lookup"><span data-stu-id="72315-110">Navigate to the install folder and back up the web.config file.</span></span> <span data-ttu-id="72315-111">The default installation location is C:\inetpub\wwwroot\PhoneFactor.</span><span class="sxs-lookup"><span data-stu-id="72315-111">The default installation location is C:\inetpub\wwwroot\PhoneFactor.</span></span>

  2. <span data-ttu-id="72315-112">If you have added custom themes to the portal, back up your custom folder below the C:\inetpub\wwwroot\PhoneFactor\App_Themes directory.</span><span class="sxs-lookup"><span data-stu-id="72315-112">If you have added custom themes to the portal, back up your custom folder below the C:\inetpub\wwwroot\PhoneFactor\App_Themes directory.</span></span>

  3. <span data-ttu-id="72315-113">Uninstall the User Portal either through the PhoneFactor Agent (only available if installed on the same server as the PhoneFactor Agent) or through Windows Programs and Features.</span><span class="sxs-lookup"><span data-stu-id="72315-113">Uninstall the User Portal either through the PhoneFactor Agent (only available if installed on the same server as the PhoneFactor Agent) or through Windows Programs and Features.</span></span>

3. <span data-ttu-id="72315-114">If the Mobile App Web Service is installed:</span><span class="sxs-lookup"><span data-stu-id="72315-114">If the Mobile App Web Service is installed:</span></span>

  1. <span data-ttu-id="72315-115">Go to the install folder and back up the web.config file.</span><span class="sxs-lookup"><span data-stu-id="72315-115">Go to the install folder and back up the web.config file.</span></span> <span data-ttu-id="72315-116">The default installation location is C:\inetpub\wwwroot\PhoneFactorPhoneAppWebService.</span><span class="sxs-lookup"><span data-stu-id="72315-116">The default installation location is C:\inetpub\wwwroot\PhoneFactorPhoneAppWebService.</span></span>

  2. <span data-ttu-id="72315-117">Uninstall the Mobile App Web Service through Windows Programs and Features.</span><span class="sxs-lookup"><span data-stu-id="72315-117">Uninstall the Mobile App Web Service through Windows Programs and Features.</span></span>

4. <span data-ttu-id="72315-118">If the Web Service SDK is installed, uninstall it either through the PhoneFactor Agent or through Windows Programs and Features.</span><span class="sxs-lookup"><span data-stu-id="72315-118">If the Web Service SDK is installed, uninstall it either through the PhoneFactor Agent or through Windows Programs and Features.</span></span>

5. <span data-ttu-id="72315-119">Uninstall the PhoneFactor Agent through Windows Programs and Features.</span><span class="sxs-lookup"><span data-stu-id="72315-119">Uninstall the PhoneFactor Agent through Windows Programs and Features.</span></span>

## <a name="install-the-multi-factor-authentication-server"></a><span data-ttu-id="72315-120">Install the Multi-Factor Authentication Server</span><span class="sxs-lookup"><span data-stu-id="72315-120">Install the Multi-Factor Authentication Server</span></span>

<span data-ttu-id="72315-121">The installation path is picked up from the registry from the previous PhoneFactor Agent installation, so it should install in the same location (e.g. C:\Program Files\PhoneFactor).</span><span class="sxs-lookup"><span data-stu-id="72315-121">The installation path is picked up from the registry from the previous PhoneFactor Agent installation, so it should install in the same location (e.g. C:\Program Files\PhoneFactor).</span></span> <span data-ttu-id="72315-122">New installations will have a different default install path (e.g. C:\Program Files\Multi-Factor Authentication Server).</span><span class="sxs-lookup"><span data-stu-id="72315-122">New installations will have a different default install path (e.g. C:\Program Files\Multi-Factor Authentication Server).</span></span> <span data-ttu-id="72315-123">The data file left by the previous PhoneFactor Agent should be upgraded during installation, so your users and settings should still be there after installing the new Multi-Factor Authentication Server.</span><span class="sxs-lookup"><span data-stu-id="72315-123">The data file left by the previous PhoneFactor Agent should be upgraded during installation, so your users and settings should still be there after installing the new Multi-Factor Authentication Server.</span></span>

1. <span data-ttu-id="72315-124">If prompted, activate the Multi-Factor Authentication Server and ensure it is assigned to the correct replication group.</span><span class="sxs-lookup"><span data-stu-id="72315-124">If prompted, activate the Multi-Factor Authentication Server and ensure it is assigned to the correct replication group.</span></span>

2. <span data-ttu-id="72315-125">If the Web Service SDK was previously installed, install the new Web Service SDK through the Multi-Factor Authentication Server User Interface.</span><span class="sxs-lookup"><span data-stu-id="72315-125">If the Web Service SDK was previously installed, install the new Web Service SDK through the Multi-Factor Authentication Server User Interface.</span></span>

  <span data-ttu-id="72315-126">The default virtual directory name is now “MultiFactorAuthWebServiceSdk” instead of “PhoneFactorWebServiceSdk”.</span><span class="sxs-lookup"><span data-stu-id="72315-126">The default virtual directory name is now “MultiFactorAuthWebServiceSdk” instead of “PhoneFactorWebServiceSdk”.</span></span> <span data-ttu-id="72315-127">If you want to use the previous name, you must change the name of the virtual directory during installation.</span><span class="sxs-lookup"><span data-stu-id="72315-127">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="72315-128">Otherwise, if you allow the install to use the new default name, you will have to change the URL in any applications that reference the Web Service SDK such as the User Portal and Mobile App Web Service to point at the correct location.</span><span class="sxs-lookup"><span data-stu-id="72315-128">Otherwise, if you allow the install to use the new default name, you will have to change the URL in any applications that reference the Web Service SDK such as the User Portal and Mobile App Web Service to point at the correct location.</span></span>

3. <span data-ttu-id="72315-129">If the User Portal was previously installed on the PhoneFactor Agent Server, install the new Multi-Factor Authentication User Portal through the Multi-Factor Authentication Server User Interface.</span><span class="sxs-lookup"><span data-stu-id="72315-129">If the User Portal was previously installed on the PhoneFactor Agent Server, install the new Multi-Factor Authentication User Portal through the Multi-Factor Authentication Server User Interface.</span></span>

  <span data-ttu-id="72315-130">The default virtual directory name is now “MultiFactorAuth” instead of “PhoneFactor”.</span><span class="sxs-lookup"><span data-stu-id="72315-130">The default virtual directory name is now “MultiFactorAuth” instead of “PhoneFactor”.</span></span> <span data-ttu-id="72315-131">If you want to use the previous name, you must change the name of the virtual directory during installation.</span><span class="sxs-lookup"><span data-stu-id="72315-131">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="72315-132">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab.</span><span class="sxs-lookup"><span data-stu-id="72315-132">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab.</span></span>

4. <span data-ttu-id="72315-133">If the User Portal and/or Mobile App Web Service was previously installed on a different server from the PhoneFactor Agent:</span><span class="sxs-lookup"><span data-stu-id="72315-133">If the User Portal and/or Mobile App Web Service was previously installed on a different server from the PhoneFactor Agent:</span></span>

  1. <span data-ttu-id="72315-134">Go to the install location (e.g. C:\Program Files\PhoneFactor) and copy the appropriate installer(s) to the other server.</span><span class="sxs-lookup"><span data-stu-id="72315-134">Go to the install location (e.g. C:\Program Files\PhoneFactor) and copy the appropriate installer(s) to the other server.</span></span> <span data-ttu-id="72315-135">There are 32-bit and 64-bit installers for both the User Portal and Mobile App Web Service.</span><span class="sxs-lookup"><span data-stu-id="72315-135">There are 32-bit and 64-bit installers for both the User Portal and Mobile App Web Service.</span></span> <span data-ttu-id="72315-136">They are called MultiFactorAuthenticationUserPortalSetupXX.msi and MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi respectively.</span><span class="sxs-lookup"><span data-stu-id="72315-136">They are called MultiFactorAuthenticationUserPortalSetupXX.msi and MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi respectively.</span></span>

  2. <span data-ttu-id="72315-137">To install the User Portal on the web server, open a command prompt as an administrator and run MultiFactorAuthenticationUserPortalSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="72315-137">To install the User Portal on the web server, open a command prompt as an administrator and run MultiFactorAuthenticationUserPortalSetupXX.msi.</span></span>

    <span data-ttu-id="72315-138">The default virtual directory name is now “MultiFactorAuth” instead of “PhoneFactor”.</span><span class="sxs-lookup"><span data-stu-id="72315-138">The default virtual directory name is now “MultiFactorAuth” instead of “PhoneFactor”.</span></span> <span data-ttu-id="72315-139">If you want to use the previous name, you must change the name of the virtual directory during installation.</span><span class="sxs-lookup"><span data-stu-id="72315-139">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="72315-140">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab. Existing users will need to be informed of the new URL.</span><span class="sxs-lookup"><span data-stu-id="72315-140">Otherwise, if you allow the install to use the new default name, you should click the User Portal icon in the Multi-Factor Authentication Server and update the User Portal URL on the Settings tab. Existing users will need to be informed of the new URL.</span></span>

  3. <span data-ttu-id="72315-141">Go to the User Portal install location (e.g. C:\inetpub\wwwroot\MultiFactorAuth) and edit the web.config file.</span><span class="sxs-lookup"><span data-stu-id="72315-141">Go to the User Portal install location (e.g. C:\inetpub\wwwroot\MultiFactorAuth) and edit the web.config file.</span></span> <span data-ttu-id="72315-142">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up prior to the upgrade into the new web.config file.</span><span class="sxs-lookup"><span data-stu-id="72315-142">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up prior to the upgrade into the new web.config file.</span></span> <span data-ttu-id="72315-143">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span><span class="sxs-lookup"><span data-stu-id="72315-143">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span></span> <span data-ttu-id="72315-144">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span><span class="sxs-lookup"><span data-stu-id="72315-144">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span></span>

  4. <span data-ttu-id="72315-145">To install the Mobile App Web Service on the web server, open a command prompt as an administrator and run the MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span><span class="sxs-lookup"><span data-stu-id="72315-145">To install the Mobile App Web Service on the web server, open a command prompt as an administrator and run the MultiFactorAuthenticationMobileAppWebServiceSetupXX.msi.</span></span>

    <span data-ttu-id="72315-146">The default virtual directory name is now “MultiFactorAuthMobileAppWebService” instead of “PhoneFactorPhoneAppWebService”.</span><span class="sxs-lookup"><span data-stu-id="72315-146">The default virtual directory name is now “MultiFactorAuthMobileAppWebService” instead of “PhoneFactorPhoneAppWebService”.</span></span> <span data-ttu-id="72315-147">If you want to use the previous name, you must change the name of the virtual directory during installation.</span><span class="sxs-lookup"><span data-stu-id="72315-147">If you want to use the previous name, you must change the name of the virtual directory during installation.</span></span> <span data-ttu-id="72315-148">You may want to choose a shorter name to make it easy for end users to type in on their mobile devices.</span><span class="sxs-lookup"><span data-stu-id="72315-148">You may want to choose a shorter name to make it easy for end users to type in on their mobile devices.</span></span> <span data-ttu-id="72315-149">Otherwise, if you allow the install to use the new default name, you should click the Mobile App icon in the Multi-Factor Authentication Server and update the Mobile App Web Service URL.</span><span class="sxs-lookup"><span data-stu-id="72315-149">Otherwise, if you allow the install to use the new default name, you should click the Mobile App icon in the Multi-Factor Authentication Server and update the Mobile App Web Service URL.</span></span>

  5. <span data-ttu-id="72315-150">Go to the Mobile App Web Service install location (e.g. C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService) and edit the web.config file.</span><span class="sxs-lookup"><span data-stu-id="72315-150">Go to the Mobile App Web Service install location (e.g. C:\inetpub\wwwroot\MultiFactorAuthMobileAppWebService) and edit the web.config file.</span></span> <span data-ttu-id="72315-151">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up prior to the upgrade into the new web.config file.</span><span class="sxs-lookup"><span data-stu-id="72315-151">Copy the values in the appSettings and applicationSettings sections from your original web.config file that was backed up prior to the upgrade into the new web.config file.</span></span> <span data-ttu-id="72315-152">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span><span class="sxs-lookup"><span data-stu-id="72315-152">If the new default virtual directory name was kept when installing the Web Service SDK, change the URL in the applicationSettings section to point to the correct location.</span></span> <span data-ttu-id="72315-153">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span><span class="sxs-lookup"><span data-stu-id="72315-153">If any other defaults were changed in the previous web.config file, apply those same changes to the new web.config file.</span></span>

## <a name="next-steps"></a><span data-ttu-id="72315-154">Next steps</span><span class="sxs-lookup"><span data-stu-id="72315-154">Next steps</span></span>

- <span data-ttu-id="72315-155">[Install the users portal](multi-factor-authentication-get-started-portal.md) for the Azure Multi-Factor Authentication Server.</span><span class="sxs-lookup"><span data-stu-id="72315-155">[Install the users portal](multi-factor-authentication-get-started-portal.md) for the Azure Multi-Factor Authentication Server.</span></span>

- <span data-ttu-id="72315-156">[Configure Windows Authentication](multi-factor-authentication-get-started-server-windows.md) for your applications.</span><span class="sxs-lookup"><span data-stu-id="72315-156">[Configure Windows Authentication](multi-factor-authentication-get-started-server-windows.md) for your applications.</span></span> 
