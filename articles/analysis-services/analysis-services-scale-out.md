---
title: Azure Analysis Services scale-out| Microsoft Docs
description: Replicate Azure Analysis Services servers with scale-out
author: minewiskan
manager: kfile
ms.service: azure-analysis-services
ms.topic: conceptual
ms.date: 09/06/2018
ms.author: owend
ms.reviewer: minewiskan
ms.openlocfilehash: ecf56f3172ebeab54757d7cbd164b92ca1470ce5
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44967140"
---
# <a name="azure-analysis-services-scale-out"></a><span data-ttu-id="7c258-103">Azure Analysis Services scale-out</span><span class="sxs-lookup"><span data-stu-id="7c258-103">Azure Analysis Services scale-out</span></span>

<span data-ttu-id="7c258-104">With scale-out, client queries can be distributed among multiple *query replicas* in a query pool, reducing response times during high query workloads.</span><span class="sxs-lookup"><span data-stu-id="7c258-104">With scale-out, client queries can be distributed among multiple *query replicas* in a query pool, reducing response times during high query workloads.</span></span> <span data-ttu-id="7c258-105">You can also separate processing from the query pool, ensuring client queries are not adversely affected by processing operations.</span><span class="sxs-lookup"><span data-stu-id="7c258-105">You can also separate processing from the query pool, ensuring client queries are not adversely affected by processing operations.</span></span> <span data-ttu-id="7c258-106">Scale-out can be configured in Azure portal or by using the Analysis Services REST API.</span><span class="sxs-lookup"><span data-stu-id="7c258-106">Scale-out can be configured in Azure portal or by using the Analysis Services REST API.</span></span>

## <a name="how-it-works"></a><span data-ttu-id="7c258-107">How it works</span><span class="sxs-lookup"><span data-stu-id="7c258-107">How it works</span></span>

<span data-ttu-id="7c258-108">In a typical server deployment, one server serves as both processing server and query server.</span><span class="sxs-lookup"><span data-stu-id="7c258-108">In a typical server deployment, one server serves as both processing server and query server.</span></span> <span data-ttu-id="7c258-109">If the number of client queries against models on your server exceeds the Query Processing Units (QPU) for your server's plan, or model processing occurs at the same time as high query workloads, performance can decrease.</span><span class="sxs-lookup"><span data-stu-id="7c258-109">If the number of client queries against models on your server exceeds the Query Processing Units (QPU) for your server's plan, or model processing occurs at the same time as high query workloads, performance can decrease.</span></span> 

<span data-ttu-id="7c258-110">With scale-out, you can create a query pool with up to seven additional query replica resources (eight total, including your server).</span><span class="sxs-lookup"><span data-stu-id="7c258-110">With scale-out, you can create a query pool with up to seven additional query replica resources (eight total, including your server).</span></span> <span data-ttu-id="7c258-111">You can scale the number of query replicas to meet QPU demands at critical times and you can separate a processing server from the query pool at any time.</span><span class="sxs-lookup"><span data-stu-id="7c258-111">You can scale the number of query replicas to meet QPU demands at critical times and you can separate a processing server from the query pool at any time.</span></span> <span data-ttu-id="7c258-112">All query replicas are created in the same region as your server.</span><span class="sxs-lookup"><span data-stu-id="7c258-112">All query replicas are created in the same region as your server.</span></span>

<span data-ttu-id="7c258-113">Regardless of the number of query replicas you have in a query pool, processing workloads are not distributed among query replicas.</span><span class="sxs-lookup"><span data-stu-id="7c258-113">Regardless of the number of query replicas you have in a query pool, processing workloads are not distributed among query replicas.</span></span> <span data-ttu-id="7c258-114">A single server serves as the processing server.</span><span class="sxs-lookup"><span data-stu-id="7c258-114">A single server serves as the processing server.</span></span> <span data-ttu-id="7c258-115">Query replicas serve only queries against the models synchronized between each query replica in the query pool.</span><span class="sxs-lookup"><span data-stu-id="7c258-115">Query replicas serve only queries against the models synchronized between each query replica in the query pool.</span></span> 

<span data-ttu-id="7c258-116">When scaling out, new query replicas are added to the query pool incrementally.</span><span class="sxs-lookup"><span data-stu-id="7c258-116">When scaling out, new query replicas are added to the query pool incrementally.</span></span> <span data-ttu-id="7c258-117">It can take up to five minutes for new query replica resources to be included in the query pool; ready to receive client connections and queries.</span><span class="sxs-lookup"><span data-stu-id="7c258-117">It can take up to five minutes for new query replica resources to be included in the query pool; ready to receive client connections and queries.</span></span> <span data-ttu-id="7c258-118">When all new query replicas are up and running, new client connections are load balanced across all query pool resources.</span><span class="sxs-lookup"><span data-stu-id="7c258-118">When all new query replicas are up and running, new client connections are load balanced across all query pool resources.</span></span> <span data-ttu-id="7c258-119">Existing client connections are not changed from the resource they are currently connected to.</span><span class="sxs-lookup"><span data-stu-id="7c258-119">Existing client connections are not changed from the resource they are currently connected to.</span></span>  <span data-ttu-id="7c258-120">When scaling in, any existing client connections to a query pool resource that is being removed from the query pool are terminated.</span><span class="sxs-lookup"><span data-stu-id="7c258-120">When scaling in, any existing client connections to a query pool resource that is being removed from the query pool are terminated.</span></span> <span data-ttu-id="7c258-121">They are reconnected to a remaining query pool resource when the scale in operation has completed, which can take up to five minutes.</span><span class="sxs-lookup"><span data-stu-id="7c258-121">They are reconnected to a remaining query pool resource when the scale in operation has completed, which can take up to five minutes.</span></span>

<span data-ttu-id="7c258-122">When processing models, after processing operations are completed, a synchronization must be performed between the processing server and the query replicas.</span><span class="sxs-lookup"><span data-stu-id="7c258-122">When processing models, after processing operations are completed, a synchronization must be performed between the processing server and the query replicas.</span></span> <span data-ttu-id="7c258-123">When automating processing operations, it's important to configure a synchronization operation upon successful completion of processing operations.</span><span class="sxs-lookup"><span data-stu-id="7c258-123">When automating processing operations, it's important to configure a synchronization operation upon successful completion of processing operations.</span></span> <span data-ttu-id="7c258-124">Synchronization can be performed manually in the portal, or by using PowerShell or REST API.</span><span class="sxs-lookup"><span data-stu-id="7c258-124">Synchronization can be performed manually in the portal, or by using PowerShell or REST API.</span></span> 

<span data-ttu-id="7c258-125">For maximum performance for both processing and query operations, you can choose to separate your processing server from the query pool.</span><span class="sxs-lookup"><span data-stu-id="7c258-125">For maximum performance for both processing and query operations, you can choose to separate your processing server from the query pool.</span></span> <span data-ttu-id="7c258-126">When separated, existing and new client connections are assigned to query replicas in the query pool only.</span><span class="sxs-lookup"><span data-stu-id="7c258-126">When separated, existing and new client connections are assigned to query replicas in the query pool only.</span></span> <span data-ttu-id="7c258-127">If processing operations only take up a short amount of time, you can choose to separate your processing server from the query pool only for the amount of time it takes to perform processing and synchronization operations, and then include it back into the query pool.</span><span class="sxs-lookup"><span data-stu-id="7c258-127">If processing operations only take up a short amount of time, you can choose to separate your processing server from the query pool only for the amount of time it takes to perform processing and synchronization operations, and then include it back into the query pool.</span></span> 

> [!NOTE]
> <span data-ttu-id="7c258-128">Scale-out is available for servers in the Standard pricing tier.</span><span class="sxs-lookup"><span data-stu-id="7c258-128">Scale-out is available for servers in the Standard pricing tier.</span></span> <span data-ttu-id="7c258-129">Each query replica is billed at the same rate as your server.</span><span class="sxs-lookup"><span data-stu-id="7c258-129">Each query replica is billed at the same rate as your server.</span></span>

> [!NOTE]
> <span data-ttu-id="7c258-130">Scale-out does not increase the amount of available memory for your server.</span><span class="sxs-lookup"><span data-stu-id="7c258-130">Scale-out does not increase the amount of available memory for your server.</span></span> <span data-ttu-id="7c258-131">To increase memory, you need to upgrade your plan.</span><span class="sxs-lookup"><span data-stu-id="7c258-131">To increase memory, you need to upgrade your plan.</span></span>

## <a name="region-limits"></a><span data-ttu-id="7c258-132">Region limits</span><span class="sxs-lookup"><span data-stu-id="7c258-132">Region limits</span></span>

<span data-ttu-id="7c258-133">The number of query replicas you can configure are limited by the region your server is in.</span><span class="sxs-lookup"><span data-stu-id="7c258-133">The number of query replicas you can configure are limited by the region your server is in.</span></span> <span data-ttu-id="7c258-134">To learn more, see [Availability by region](analysis-services-overview.md#availability-by-region).</span><span class="sxs-lookup"><span data-stu-id="7c258-134">To learn more, see [Availability by region](analysis-services-overview.md#availability-by-region).</span></span>

## <a name="monitor-qpu-usage"></a><span data-ttu-id="7c258-135">Monitor QPU usage</span><span class="sxs-lookup"><span data-stu-id="7c258-135">Monitor QPU usage</span></span>

 <span data-ttu-id="7c258-136">To determine if scale-out for your server is necessary, monitor your server in Azure portal by using Metrics.</span><span class="sxs-lookup"><span data-stu-id="7c258-136">To determine if scale-out for your server is necessary, monitor your server in Azure portal by using Metrics.</span></span> <span data-ttu-id="7c258-137">If your QPU regularly maxes out, it means the number of queries against your models is exceeding the QPU limit for your plan.</span><span class="sxs-lookup"><span data-stu-id="7c258-137">If your QPU regularly maxes out, it means the number of queries against your models is exceeding the QPU limit for your plan.</span></span> <span data-ttu-id="7c258-138">The Query pool job queue length metric also increases when the number of queries in the query thread pool queue exceeds available QPU.</span><span class="sxs-lookup"><span data-stu-id="7c258-138">The Query pool job queue length metric also increases when the number of queries in the query thread pool queue exceeds available QPU.</span></span> <span data-ttu-id="7c258-139">To learn more, see [Monitor server metrics](analysis-services-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="7c258-139">To learn more, see [Monitor server metrics](analysis-services-monitor.md).</span></span>

## <a name="configure-scale-out"></a><span data-ttu-id="7c258-140">Configure scale-out</span><span class="sxs-lookup"><span data-stu-id="7c258-140">Configure scale-out</span></span>

### <a name="in-azure-portal"></a><span data-ttu-id="7c258-141">In Azure portal</span><span class="sxs-lookup"><span data-stu-id="7c258-141">In Azure portal</span></span>

1. <span data-ttu-id="7c258-142">In the portal, click **Scale-out**. Use the slider to select the number of query replica servers.</span><span class="sxs-lookup"><span data-stu-id="7c258-142">In the portal, click **Scale-out**. Use the slider to select the number of query replica servers.</span></span> <span data-ttu-id="7c258-143">The number of replicas you choose is in addition to your existing server.</span><span class="sxs-lookup"><span data-stu-id="7c258-143">The number of replicas you choose is in addition to your existing server.</span></span>

2. <span data-ttu-id="7c258-144">In **Separate the processing server from the querying pool**, select yes to exclude your processing server from query servers.</span><span class="sxs-lookup"><span data-stu-id="7c258-144">In **Separate the processing server from the querying pool**, select yes to exclude your processing server from query servers.</span></span>

   ![Scale-out slider](media/analysis-services-scale-out/aas-scale-out-slider.png)

3. <span data-ttu-id="7c258-146">Click **Save** to provision your new query replica servers.</span><span class="sxs-lookup"><span data-stu-id="7c258-146">Click **Save** to provision your new query replica servers.</span></span> 

<span data-ttu-id="7c258-147">Tabular models on your primary server are synchronized with the replica servers.</span><span class="sxs-lookup"><span data-stu-id="7c258-147">Tabular models on your primary server are synchronized with the replica servers.</span></span> <span data-ttu-id="7c258-148">When synchronization is complete, the query pool begins distributing incoming queries among the replica servers.</span><span class="sxs-lookup"><span data-stu-id="7c258-148">When synchronization is complete, the query pool begins distributing incoming queries among the replica servers.</span></span> 


## <a name="synchronization"></a><span data-ttu-id="7c258-149">Synchronization</span><span class="sxs-lookup"><span data-stu-id="7c258-149">Synchronization</span></span> 

<span data-ttu-id="7c258-150">When you provision new query replicas, Azure Analysis Services automatically replicates your models across all replicas.</span><span class="sxs-lookup"><span data-stu-id="7c258-150">When you provision new query replicas, Azure Analysis Services automatically replicates your models across all replicas.</span></span> <span data-ttu-id="7c258-151">You can also perform a manual synchronization by using the portal or REST API.</span><span class="sxs-lookup"><span data-stu-id="7c258-151">You can also perform a manual synchronization by using the portal or REST API.</span></span> <span data-ttu-id="7c258-152">When you process your models, you should perform a synchronization so updates are synchronized among your query replicas.</span><span class="sxs-lookup"><span data-stu-id="7c258-152">When you process your models, you should perform a synchronization so updates are synchronized among your query replicas.</span></span>

### <a name="in-azure-portal"></a><span data-ttu-id="7c258-153">In Azure portal</span><span class="sxs-lookup"><span data-stu-id="7c258-153">In Azure portal</span></span>

<span data-ttu-id="7c258-154">In **Overview** > model > **Synchronize model**.</span><span class="sxs-lookup"><span data-stu-id="7c258-154">In **Overview** > model > **Synchronize model**.</span></span>

![Scale-out slider](media/analysis-services-scale-out/aas-scale-out-sync.png)

### <a name="rest-api"></a><span data-ttu-id="7c258-156">REST API</span><span class="sxs-lookup"><span data-stu-id="7c258-156">REST API</span></span>
<span data-ttu-id="7c258-157">Use the **sync** operation.</span><span class="sxs-lookup"><span data-stu-id="7c258-157">Use the **sync** operation.</span></span>

#### <a name="synchronize-a-model"></a><span data-ttu-id="7c258-158">Synchronize a model</span><span class="sxs-lookup"><span data-stu-id="7c258-158">Synchronize a model</span></span>   
`POST https://<region>.asazure.windows.net/servers/<servername>:rw/models/<modelname>/sync`

#### <a name="get-sync-status"></a><span data-ttu-id="7c258-159">Get sync status</span><span class="sxs-lookup"><span data-stu-id="7c258-159">Get sync status</span></span>  
`GET https://<region>.asazure.windows.net/servers/<servername>:rw/models/<modelname>/sync`

### <a name="powershell"></a><span data-ttu-id="7c258-160">PowerShell</span><span class="sxs-lookup"><span data-stu-id="7c258-160">PowerShell</span></span>
<span data-ttu-id="7c258-161">Before using PowerShell, [install or update the latest AzureRM module](https://github.com/Azure/azure-powershell/releases).</span><span class="sxs-lookup"><span data-stu-id="7c258-161">Before using PowerShell, [install or update the latest AzureRM module](https://github.com/Azure/azure-powershell/releases).</span></span> 

<span data-ttu-id="7c258-162">To set the number of query replicas, use [Set-AzureRmAnalysisServicesServer](https://docs.microsoft.com/powershell/module/azurerm.analysisservices/set-azurermanalysisservicesserver).</span><span class="sxs-lookup"><span data-stu-id="7c258-162">To set the number of query replicas, use [Set-AzureRmAnalysisServicesServer](https://docs.microsoft.com/powershell/module/azurerm.analysisservices/set-azurermanalysisservicesserver).</span></span> <span data-ttu-id="7c258-163">Specify the optional `-ReadonlyReplicaCount` parameter.</span><span class="sxs-lookup"><span data-stu-id="7c258-163">Specify the optional `-ReadonlyReplicaCount` parameter.</span></span>

<span data-ttu-id="7c258-164">To run sync, use [Sync-AzureAnalysisServicesInstance](https://docs.microsoft.com/powershell/module/azurerm.analysisservices/sync-azureanalysisservicesinstance).</span><span class="sxs-lookup"><span data-stu-id="7c258-164">To run sync, use [Sync-AzureAnalysisServicesInstance](https://docs.microsoft.com/powershell/module/azurerm.analysisservices/sync-azureanalysisservicesinstance).</span></span>



## <a name="connections"></a><span data-ttu-id="7c258-165">Connections</span><span class="sxs-lookup"><span data-stu-id="7c258-165">Connections</span></span>

<span data-ttu-id="7c258-166">On your server's Overview page, there are two server names.</span><span class="sxs-lookup"><span data-stu-id="7c258-166">On your server's Overview page, there are two server names.</span></span> <span data-ttu-id="7c258-167">If you haven't yet configured scale-out for a server, both server names work the same.</span><span class="sxs-lookup"><span data-stu-id="7c258-167">If you haven't yet configured scale-out for a server, both server names work the same.</span></span> <span data-ttu-id="7c258-168">Once you configure scale-out for a server, you need to specify the appropriate server name depending on the connection type.</span><span class="sxs-lookup"><span data-stu-id="7c258-168">Once you configure scale-out for a server, you need to specify the appropriate server name depending on the connection type.</span></span> 

<span data-ttu-id="7c258-169">For end-user client connections like Power BI Desktop, Excel, and custom apps, use **Server name**.</span><span class="sxs-lookup"><span data-stu-id="7c258-169">For end-user client connections like Power BI Desktop, Excel, and custom apps, use **Server name**.</span></span> 

<span data-ttu-id="7c258-170">For SSMS, SSDT, and connection strings in PowerShell, Azure Function apps, and AMO, use **Management server name**.</span><span class="sxs-lookup"><span data-stu-id="7c258-170">For SSMS, SSDT, and connection strings in PowerShell, Azure Function apps, and AMO, use **Management server name**.</span></span> <span data-ttu-id="7c258-171">The management server name includes a special `:rw` (read-write) qualifier.</span><span class="sxs-lookup"><span data-stu-id="7c258-171">The management server name includes a special `:rw` (read-write) qualifier.</span></span> <span data-ttu-id="7c258-172">All processing operations occur on the management server.</span><span class="sxs-lookup"><span data-stu-id="7c258-172">All processing operations occur on the management server.</span></span>

![Server names](media/analysis-services-scale-out/aas-scale-out-name.png)

## <a name="related-information"></a><span data-ttu-id="7c258-174">Related information</span><span class="sxs-lookup"><span data-stu-id="7c258-174">Related information</span></span>

<span data-ttu-id="7c258-175">[Monitor server metrics](analysis-services-monitor.md) </span><span class="sxs-lookup"><span data-stu-id="7c258-175">[Monitor server metrics](analysis-services-monitor.md) </span></span>  
[<span data-ttu-id="7c258-176">Manage Azure Analysis Services</span><span class="sxs-lookup"><span data-stu-id="7c258-176">Manage Azure Analysis Services</span></span>](analysis-services-manage.md) 

