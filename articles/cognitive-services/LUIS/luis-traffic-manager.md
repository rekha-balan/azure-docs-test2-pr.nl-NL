---
title: Use Microsoft Azure Traffic Manager to increase endpoint quota in Language Understanding (LUIS) - Azure | Microsoft Docs
description: Use Microsoft Azure Traffic Manager to spread endpoint quota across several subscriptions in Language Understanding (LUIS) to increase endpoint quota
author: diberry
manager: cjgronlund
services: cognitive-services
ms.service: cognitive-services
ms.component: language-understanding
ms.topic: article
ms.date: 06/07/2018
ms.author: diberry
ms.openlocfilehash: 909c32452db216f79633b94c31f39350b7a6ee20
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44864734"
---
# <a name="use-microsoft-azure-traffic-manager-to-manage-endpoint-quota-across-keys"></a><span data-ttu-id="12acd-103">Use Microsoft Azure Traffic Manager to manage endpoint quota across keys</span><span class="sxs-lookup"><span data-stu-id="12acd-103">Use Microsoft Azure Traffic Manager to manage endpoint quota across keys</span></span>
<span data-ttu-id="12acd-104">Language Understanding (LUIS) offers the ability to increase the endpoint request quota beyond a single key's quota.</span><span class="sxs-lookup"><span data-stu-id="12acd-104">Language Understanding (LUIS) offers the ability to increase the endpoint request quota beyond a single key's quota.</span></span> <span data-ttu-id="12acd-105">This is done by creating more keys for LUIS and adding them to the LUIS application on the **Publish** page in the **Resources and Keys** section.</span><span class="sxs-lookup"><span data-stu-id="12acd-105">This is done by creating more keys for LUIS and adding them to the LUIS application on the **Publish** page in the **Resources and Keys** section.</span></span> 

<span data-ttu-id="12acd-106">The client-application has to manage the traffic across the keys.</span><span class="sxs-lookup"><span data-stu-id="12acd-106">The client-application has to manage the traffic across the keys.</span></span> <span data-ttu-id="12acd-107">LUIS doesn't do that.</span><span class="sxs-lookup"><span data-stu-id="12acd-107">LUIS doesn't do that.</span></span> 

<span data-ttu-id="12acd-108">This article explains how to manage the traffic across keys with Azure [Traffic Manager][traffic-manager-marketing].</span><span class="sxs-lookup"><span data-stu-id="12acd-108">This article explains how to manage the traffic across keys with Azure [Traffic Manager][traffic-manager-marketing].</span></span> <span data-ttu-id="12acd-109">You must already have a trained and published LUIS app.</span><span class="sxs-lookup"><span data-stu-id="12acd-109">You must already have a trained and published LUIS app.</span></span> <span data-ttu-id="12acd-110">If you do not have one, follow the Prebuilt domain [quickstart](luis-get-started-create-app.md).</span><span class="sxs-lookup"><span data-stu-id="12acd-110">If you do not have one, follow the Prebuilt domain [quickstart](luis-get-started-create-app.md).</span></span> 

## <a name="connect-to-powershell-in-the-azure-portal"></a><span data-ttu-id="12acd-111">Connect to PowerShell in the Azure portal</span><span class="sxs-lookup"><span data-stu-id="12acd-111">Connect to PowerShell in the Azure portal</span></span>
<span data-ttu-id="12acd-112">In the [Azure][azure-portal] portal, open the PowerShell window.</span><span class="sxs-lookup"><span data-stu-id="12acd-112">In the [Azure][azure-portal] portal, open the PowerShell window.</span></span> <span data-ttu-id="12acd-113">The icon for the PowerShell window is the **>_** in the top navigation bar.</span><span class="sxs-lookup"><span data-stu-id="12acd-113">The icon for the PowerShell window is the **>_** in the top navigation bar.</span></span> <span data-ttu-id="12acd-114">By using PowerShell from the portal, you get the latest PowerShell version and you are authenticated.</span><span class="sxs-lookup"><span data-stu-id="12acd-114">By using PowerShell from the portal, you get the latest PowerShell version and you are authenticated.</span></span> <span data-ttu-id="12acd-115">PowerShell in the portal requires an [Azure Storage](https://azure.microsoft.com/services/storage/) account.</span><span class="sxs-lookup"><span data-stu-id="12acd-115">PowerShell in the portal requires an [Azure Storage](https://azure.microsoft.com/services/storage/) account.</span></span> 

![Screenshot of Azure portal with Powershell window open](./media/traffic-manager/azure-portal-powershell.png)

<span data-ttu-id="12acd-117">The following sections use [Traffic Manager PowerShell cmdlets](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/?view=azurermps-6.2.0#traffic_manager).</span><span class="sxs-lookup"><span data-stu-id="12acd-117">The following sections use [Traffic Manager PowerShell cmdlets](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/?view=azurermps-6.2.0#traffic_manager).</span></span>

## <a name="create-azure-resource-group-with-powershell"></a><span data-ttu-id="12acd-118">Create Azure resource group with PowerShell</span><span class="sxs-lookup"><span data-stu-id="12acd-118">Create Azure resource group with PowerShell</span></span>
<span data-ttu-id="12acd-119">Before creating the Azure resources, create a resource group to contain all the resources.</span><span class="sxs-lookup"><span data-stu-id="12acd-119">Before creating the Azure resources, create a resource group to contain all the resources.</span></span> <span data-ttu-id="12acd-120">Name the resource group `luis-traffic-manager` and use the region is `West US`.</span><span class="sxs-lookup"><span data-stu-id="12acd-120">Name the resource group `luis-traffic-manager` and use the region is `West US`.</span></span> <span data-ttu-id="12acd-121">The region of the resource group stores metadata about the group.</span><span class="sxs-lookup"><span data-stu-id="12acd-121">The region of the resource group stores metadata about the group.</span></span> <span data-ttu-id="12acd-122">It won't slow down your resources if they are in another region.</span><span class="sxs-lookup"><span data-stu-id="12acd-122">It won't slow down your resources if they are in another region.</span></span> 

<span data-ttu-id="12acd-123">Create resource group with **[New-AzureRmResourceGroup](https://docs.microsoft.com/powershell/module/azurerm.resources/new-azurermresourcegroup?view=azurermps-6.2.0)** cmdlet:</span><span class="sxs-lookup"><span data-stu-id="12acd-123">Create resource group with **[New-AzureRmResourceGroup](https://docs.microsoft.com/powershell/module/azurerm.resources/new-azurermresourcegroup?view=azurermps-6.2.0)** cmdlet:</span></span>

```PowerShell
New-AzureRmResourceGroup -Name luis-traffic-manager -Location "West US"
```

## <a name="create-luis-keys-to-increase-total-endpoint-quota"></a><span data-ttu-id="12acd-124">Create LUIS keys to increase total endpoint quota</span><span class="sxs-lookup"><span data-stu-id="12acd-124">Create LUIS keys to increase total endpoint quota</span></span>
1. <span data-ttu-id="12acd-125">In the Azure portal, create two **Language Understanding** keys, one in the `West US` and one in the `East US`.</span><span class="sxs-lookup"><span data-stu-id="12acd-125">In the Azure portal, create two **Language Understanding** keys, one in the `West US` and one in the `East US`.</span></span> <span data-ttu-id="12acd-126">Use the existing resource group, created in the previous section, named `luis-traffic-manager`.</span><span class="sxs-lookup"><span data-stu-id="12acd-126">Use the existing resource group, created in the previous section, named `luis-traffic-manager`.</span></span> 

    ![Screenshot of Azure portal with two LUIS keys in luis-traffic-manager resource group](./media/traffic-manager/luis-keys.png)

2. <span data-ttu-id="12acd-128">In the [LUIS][LUIS] website, on the **Publish** page, add keys to the app, and republish the app.</span><span class="sxs-lookup"><span data-stu-id="12acd-128">In the [LUIS][LUIS] website, on the **Publish** page, add keys to the app, and republish the app.</span></span> 

    ![Screenshot of LUIS portal with two LUIS keys on Publish page](./media/traffic-manager/luis-keys-in-luis.png)

    <span data-ttu-id="12acd-130">The example URL in the **endpoint** column uses a GET request with the endpoint key as a query parameter.</span><span class="sxs-lookup"><span data-stu-id="12acd-130">The example URL in the **endpoint** column uses a GET request with the endpoint key as a query parameter.</span></span> <span data-ttu-id="12acd-131">Copy the two new keys' endpoint URLs.</span><span class="sxs-lookup"><span data-stu-id="12acd-131">Copy the two new keys' endpoint URLs.</span></span> <span data-ttu-id="12acd-132">They are used as part of the Traffic Manager configuration later in this article.</span><span class="sxs-lookup"><span data-stu-id="12acd-132">They are used as part of the Traffic Manager configuration later in this article.</span></span>

## <a name="manage-luis-endpoint-requests-across-keys-with-traffic-manager"></a><span data-ttu-id="12acd-133">Manage LUIS endpoint requests across keys with Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="12acd-133">Manage LUIS endpoint requests across keys with Traffic Manager</span></span>
<span data-ttu-id="12acd-134">Traffic Manager creates a new DNS access point for your endpoints.</span><span class="sxs-lookup"><span data-stu-id="12acd-134">Traffic Manager creates a new DNS access point for your endpoints.</span></span> <span data-ttu-id="12acd-135">It does not act as a gateway or proxy but strictly at the DNS level.</span><span class="sxs-lookup"><span data-stu-id="12acd-135">It does not act as a gateway or proxy but strictly at the DNS level.</span></span> <span data-ttu-id="12acd-136">This example doesn't change any DNS records.</span><span class="sxs-lookup"><span data-stu-id="12acd-136">This example doesn't change any DNS records.</span></span> <span data-ttu-id="12acd-137">It uses a DNS library to communicate with Traffic Manager to get the correct endpoint for that specific request.</span><span class="sxs-lookup"><span data-stu-id="12acd-137">It uses a DNS library to communicate with Traffic Manager to get the correct endpoint for that specific request.</span></span> <span data-ttu-id="12acd-138">_Each_ request intended for LUIS first requires a Traffic Manager request to determine which LUIS endpoint to use.</span><span class="sxs-lookup"><span data-stu-id="12acd-138">_Each_ request intended for LUIS first requires a Traffic Manager request to determine which LUIS endpoint to use.</span></span> 

### <a name="polling-uses-luis-endpoint"></a><span data-ttu-id="12acd-139">Polling uses LUIS endpoint</span><span class="sxs-lookup"><span data-stu-id="12acd-139">Polling uses LUIS endpoint</span></span>
<span data-ttu-id="12acd-140">Traffic Manager polls the endpoints periodically to make sure the endpoint is still available.</span><span class="sxs-lookup"><span data-stu-id="12acd-140">Traffic Manager polls the endpoints periodically to make sure the endpoint is still available.</span></span> <span data-ttu-id="12acd-141">The Traffic Manager URL polled needs to be accessible with a GET request and return a 200.</span><span class="sxs-lookup"><span data-stu-id="12acd-141">The Traffic Manager URL polled needs to be accessible with a GET request and return a 200.</span></span> <span data-ttu-id="12acd-142">The endpoint URL on the **Publish** page does this.</span><span class="sxs-lookup"><span data-stu-id="12acd-142">The endpoint URL on the **Publish** page does this.</span></span> <span data-ttu-id="12acd-143">Since each endpoint key has a different route and query string parameters, each endpoint key needs a different polling path.</span><span class="sxs-lookup"><span data-stu-id="12acd-143">Since each endpoint key has a different route and query string parameters, each endpoint key needs a different polling path.</span></span> <span data-ttu-id="12acd-144">Each time Traffic Manager polls, it does cost a quota request.</span><span class="sxs-lookup"><span data-stu-id="12acd-144">Each time Traffic Manager polls, it does cost a quota request.</span></span> <span data-ttu-id="12acd-145">The query string parameter **q** of the LUIS endpoint is the utterance sent to LUIS.</span><span class="sxs-lookup"><span data-stu-id="12acd-145">The query string parameter **q** of the LUIS endpoint is the utterance sent to LUIS.</span></span> <span data-ttu-id="12acd-146">This parameter, instead of sending an utterance, is used to add Traffic Manager polling to the LUIS endpoint log as a debugging technique while getting Traffic Manager configured.</span><span class="sxs-lookup"><span data-stu-id="12acd-146">This parameter, instead of sending an utterance, is used to add Traffic Manager polling to the LUIS endpoint log as a debugging technique while getting Traffic Manager configured.</span></span>

<span data-ttu-id="12acd-147">Because each LUIS endpoint needs its own path, it needs its own Traffic Manager profile.</span><span class="sxs-lookup"><span data-stu-id="12acd-147">Because each LUIS endpoint needs its own path, it needs its own Traffic Manager profile.</span></span> <span data-ttu-id="12acd-148">In order to manage across profiles, create a [_nested_ Traffic Manager](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-nested-profiles) architecture.</span><span class="sxs-lookup"><span data-stu-id="12acd-148">In order to manage across profiles, create a [_nested_ Traffic Manager](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-nested-profiles) architecture.</span></span> <span data-ttu-id="12acd-149">One parent profile points to the children profiles and manage traffic across them.</span><span class="sxs-lookup"><span data-stu-id="12acd-149">One parent profile points to the children profiles and manage traffic across them.</span></span>

<span data-ttu-id="12acd-150">Once the Traffic Manager is configured, remember to change the path to use the logging=false query string parameter so your log is not filling up with polling.</span><span class="sxs-lookup"><span data-stu-id="12acd-150">Once the Traffic Manager is configured, remember to change the path to use the logging=false query string parameter so your log is not filling up with polling.</span></span>

## <a name="configure-traffic-manager-with-nested-profiles"></a><span data-ttu-id="12acd-151">Configure Traffic Manager with nested profiles</span><span class="sxs-lookup"><span data-stu-id="12acd-151">Configure Traffic Manager with nested profiles</span></span>
<span data-ttu-id="12acd-152">The following sections create two child profiles, one for the East LUIS key and one for the West LUIS key.</span><span class="sxs-lookup"><span data-stu-id="12acd-152">The following sections create two child profiles, one for the East LUIS key and one for the West LUIS key.</span></span> <span data-ttu-id="12acd-153">Then a parent profile is created and the two child profiles are added to the parent profile.</span><span class="sxs-lookup"><span data-stu-id="12acd-153">Then a parent profile is created and the two child profiles are added to the parent profile.</span></span> 

### <a name="create-the-east-us-traffic-manager-profile-with-powershell"></a><span data-ttu-id="12acd-154">Create the East US Traffic Manager profile with PowerShell</span><span class="sxs-lookup"><span data-stu-id="12acd-154">Create the East US Traffic Manager profile with PowerShell</span></span>
<span data-ttu-id="12acd-155">To create the East US Traffic Manager profile, there are several steps: create profile, add endpoint, and set endpoint.</span><span class="sxs-lookup"><span data-stu-id="12acd-155">To create the East US Traffic Manager profile, there are several steps: create profile, add endpoint, and set endpoint.</span></span> <span data-ttu-id="12acd-156">A Traffic Manager profile can have many endpoints but each endpoint has the same validation path.</span><span class="sxs-lookup"><span data-stu-id="12acd-156">A Traffic Manager profile can have many endpoints but each endpoint has the same validation path.</span></span> <span data-ttu-id="12acd-157">Because the LUIS endpoint URLs for the east and west subscriptions are different due to region and endpoint key, each LUIS endpoint has to be a single endpoint in the profile.</span><span class="sxs-lookup"><span data-stu-id="12acd-157">Because the LUIS endpoint URLs for the east and west subscriptions are different due to region and endpoint key, each LUIS endpoint has to be a single endpoint in the profile.</span></span> 

1. <span data-ttu-id="12acd-158">Create profile with **[New-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/new-azurermtrafficmanagerprofile?view=azurermps-6.2.0)** cmdlet</span><span class="sxs-lookup"><span data-stu-id="12acd-158">Create profile with **[New-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/new-azurermtrafficmanagerprofile?view=azurermps-6.2.0)** cmdlet</span></span>

    <span data-ttu-id="12acd-159">Use the following cmdlet to create the profile.</span><span class="sxs-lookup"><span data-stu-id="12acd-159">Use the following cmdlet to create the profile.</span></span> <span data-ttu-id="12acd-160">Make sure to change the `appIdLuis` and `subscriptionKeyLuis`.</span><span class="sxs-lookup"><span data-stu-id="12acd-160">Make sure to change the `appIdLuis` and `subscriptionKeyLuis`.</span></span> <span data-ttu-id="12acd-161">The subscriptionKey is for the East US LUIS key.</span><span class="sxs-lookup"><span data-stu-id="12acd-161">The subscriptionKey is for the East US LUIS key.</span></span> <span data-ttu-id="12acd-162">If the path is not correct, including the LUIS app ID and endpoint key, the Traffic Manager polling is a status of `degraded` because Traffic Manage can't successfully request the LUIS endpoint.</span><span class="sxs-lookup"><span data-stu-id="12acd-162">If the path is not correct, including the LUIS app ID and endpoint key, the Traffic Manager polling is a status of `degraded` because Traffic Manage can't successfully request the LUIS endpoint.</span></span> <span data-ttu-id="12acd-163">Make sure the value of `q` is `traffic-manager-east` so you can see this value in the LUIS endpoint logs.</span><span class="sxs-lookup"><span data-stu-id="12acd-163">Make sure the value of `q` is `traffic-manager-east` so you can see this value in the LUIS endpoint logs.</span></span>

    ```PowerShell
    $eastprofile = New-AzureRmTrafficManagerProfile -Name luis-profile-eastus -ResourceGroupName luis-traffic-manager -TrafficRoutingMethod Performance -RelativeDnsName luis-dns-eastus -Ttl 30 -MonitorProtocol HTTPS -MonitorPort 443 -MonitorPath "/luis/v2.0/apps/<appID>?subscription-key=<subscriptionKey>&q=traffic-manager-east"
    ```
    
    <span data-ttu-id="12acd-164">This table explains each variable in the cmdlet:</span><span class="sxs-lookup"><span data-stu-id="12acd-164">This table explains each variable in the cmdlet:</span></span>
    
    |<span data-ttu-id="12acd-165">Configuration parameter</span><span class="sxs-lookup"><span data-stu-id="12acd-165">Configuration parameter</span></span>|<span data-ttu-id="12acd-166">Variable name or Value</span><span class="sxs-lookup"><span data-stu-id="12acd-166">Variable name or Value</span></span>|<span data-ttu-id="12acd-167">Purpose</span><span class="sxs-lookup"><span data-stu-id="12acd-167">Purpose</span></span>|
    |--|--|--|
    |<span data-ttu-id="12acd-168">-Name</span><span class="sxs-lookup"><span data-stu-id="12acd-168">-Name</span></span>|<span data-ttu-id="12acd-169">luis-profile-eastus</span><span class="sxs-lookup"><span data-stu-id="12acd-169">luis-profile-eastus</span></span>|<span data-ttu-id="12acd-170">Traffic Manager name in Azure portal</span><span class="sxs-lookup"><span data-stu-id="12acd-170">Traffic Manager name in Azure portal</span></span>|
    |<span data-ttu-id="12acd-171">-ResourceGroupName</span><span class="sxs-lookup"><span data-stu-id="12acd-171">-ResourceGroupName</span></span>|<span data-ttu-id="12acd-172">luis-traffic-manager</span><span class="sxs-lookup"><span data-stu-id="12acd-172">luis-traffic-manager</span></span>|<span data-ttu-id="12acd-173">Created in previous section</span><span class="sxs-lookup"><span data-stu-id="12acd-173">Created in previous section</span></span>|
    |<span data-ttu-id="12acd-174">-TrafficRoutingMethod</span><span class="sxs-lookup"><span data-stu-id="12acd-174">-TrafficRoutingMethod</span></span>|<span data-ttu-id="12acd-175">Performance</span><span class="sxs-lookup"><span data-stu-id="12acd-175">Performance</span></span>|<span data-ttu-id="12acd-176">For more information, see [Traffic Manager routing methods][routing-methods].</span><span class="sxs-lookup"><span data-stu-id="12acd-176">For more information, see [Traffic Manager routing methods][routing-methods].</span></span> <span data-ttu-id="12acd-177">If using performance, the URL request to the Traffic Manager must come from the region of the user.</span><span class="sxs-lookup"><span data-stu-id="12acd-177">If using performance, the URL request to the Traffic Manager must come from the region of the user.</span></span> <span data-ttu-id="12acd-178">If going through a chatbot or other application, it is the chatbot's responsibility to mimic the region in the call to the Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="12acd-178">If going through a chatbot or other application, it is the chatbot's responsibility to mimic the region in the call to the Traffic Manager.</span></span> |
    |<span data-ttu-id="12acd-179">-RelativeDnsName</span><span class="sxs-lookup"><span data-stu-id="12acd-179">-RelativeDnsName</span></span>|<span data-ttu-id="12acd-180">luis-dns-eastus</span><span class="sxs-lookup"><span data-stu-id="12acd-180">luis-dns-eastus</span></span>|<span data-ttu-id="12acd-181">This is the subdomain for the service: luis-dns-eastus.trafficmanager.net</span><span class="sxs-lookup"><span data-stu-id="12acd-181">This is the subdomain for the service: luis-dns-eastus.trafficmanager.net</span></span>|
    |<span data-ttu-id="12acd-182">-Ttl</span><span class="sxs-lookup"><span data-stu-id="12acd-182">-Ttl</span></span>|<span data-ttu-id="12acd-183">30</span><span class="sxs-lookup"><span data-stu-id="12acd-183">30</span></span>|<span data-ttu-id="12acd-184">Polling interval, 30 seconds</span><span class="sxs-lookup"><span data-stu-id="12acd-184">Polling interval, 30 seconds</span></span>|
    |<span data-ttu-id="12acd-185">-MonitorProtocol</span><span class="sxs-lookup"><span data-stu-id="12acd-185">-MonitorProtocol</span></span><BR><span data-ttu-id="12acd-186">-MonitorPort</span><span class="sxs-lookup"><span data-stu-id="12acd-186">-MonitorPort</span></span>|<span data-ttu-id="12acd-187">HTTPS</span><span class="sxs-lookup"><span data-stu-id="12acd-187">HTTPS</span></span><br><span data-ttu-id="12acd-188">443</span><span class="sxs-lookup"><span data-stu-id="12acd-188">443</span></span>|<span data-ttu-id="12acd-189">Port and protocol for LUIS is HTTPS/443</span><span class="sxs-lookup"><span data-stu-id="12acd-189">Port and protocol for LUIS is HTTPS/443</span></span>|
    |<span data-ttu-id="12acd-190">-MonitorPath</span><span class="sxs-lookup"><span data-stu-id="12acd-190">-MonitorPath</span></span>|`/luis/v2.0/apps/<appIdLuis>?subscription-key=<subscriptionKeyLuis>&q=traffic-manager-east`|<span data-ttu-id="12acd-191">Replace <appIdLuis> and <subscriptionKeyLuis> with your own values.</span><span class="sxs-lookup"><span data-stu-id="12acd-191">Replace <appIdLuis> and <subscriptionKeyLuis> with your own values.</span></span>|
    
    <span data-ttu-id="12acd-192">A successful request has no response.</span><span class="sxs-lookup"><span data-stu-id="12acd-192">A successful request has no response.</span></span>

2. <span data-ttu-id="12acd-193">Add East US endpoint with **[Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/add-azurermtrafficmanagerendpointconfig?view=azurermps-6.2.0)** cmdlet</span><span class="sxs-lookup"><span data-stu-id="12acd-193">Add East US endpoint with **[Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/add-azurermtrafficmanagerendpointconfig?view=azurermps-6.2.0)** cmdlet</span></span>

    ```PowerShell
    Add-AzureRmTrafficManagerEndpointConfig -EndpointName luis-east-endpoint -TrafficManagerProfile $eastprofile -Type ExternalEndpoints -Target eastus.api.cognitive.microsoft.com -EndpointLocation "eastus" -EndpointStatus Enabled
    ```
    <span data-ttu-id="12acd-194">This table explains each variable in the cmdlet:</span><span class="sxs-lookup"><span data-stu-id="12acd-194">This table explains each variable in the cmdlet:</span></span>

    |<span data-ttu-id="12acd-195">Configuration parameter</span><span class="sxs-lookup"><span data-stu-id="12acd-195">Configuration parameter</span></span>|<span data-ttu-id="12acd-196">Variable name or Value</span><span class="sxs-lookup"><span data-stu-id="12acd-196">Variable name or Value</span></span>|<span data-ttu-id="12acd-197">Purpose</span><span class="sxs-lookup"><span data-stu-id="12acd-197">Purpose</span></span>|
    |--|--|--|
    |<span data-ttu-id="12acd-198">-EndpointName</span><span class="sxs-lookup"><span data-stu-id="12acd-198">-EndpointName</span></span>|<span data-ttu-id="12acd-199">luis-east-endpoint</span><span class="sxs-lookup"><span data-stu-id="12acd-199">luis-east-endpoint</span></span>|<span data-ttu-id="12acd-200">Endpoint name displayed under the profile</span><span class="sxs-lookup"><span data-stu-id="12acd-200">Endpoint name displayed under the profile</span></span>|
    |<span data-ttu-id="12acd-201">-TrafficManagerProfile</span><span class="sxs-lookup"><span data-stu-id="12acd-201">-TrafficManagerProfile</span></span>|<span data-ttu-id="12acd-202">$eastprofile</span><span class="sxs-lookup"><span data-stu-id="12acd-202">$eastprofile</span></span>|<span data-ttu-id="12acd-203">Use profile object created in Step 1</span><span class="sxs-lookup"><span data-stu-id="12acd-203">Use profile object created in Step 1</span></span>|
    |<span data-ttu-id="12acd-204">-Type</span><span class="sxs-lookup"><span data-stu-id="12acd-204">-Type</span></span>|<span data-ttu-id="12acd-205">ExternalEndpoints</span><span class="sxs-lookup"><span data-stu-id="12acd-205">ExternalEndpoints</span></span>|<span data-ttu-id="12acd-206">For more information, see [Traffic Manager endpoint][traffic-manager-endpoints]</span><span class="sxs-lookup"><span data-stu-id="12acd-206">For more information, see [Traffic Manager endpoint][traffic-manager-endpoints]</span></span> |
    |<span data-ttu-id="12acd-207">-Target</span><span class="sxs-lookup"><span data-stu-id="12acd-207">-Target</span></span>|<span data-ttu-id="12acd-208">eastus.api.cognitive.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="12acd-208">eastus.api.cognitive.microsoft.com</span></span>|<span data-ttu-id="12acd-209">This is the domain for the LUIS endpoint.</span><span class="sxs-lookup"><span data-stu-id="12acd-209">This is the domain for the LUIS endpoint.</span></span>|
    |<span data-ttu-id="12acd-210">-EndpointLocation</span><span class="sxs-lookup"><span data-stu-id="12acd-210">-EndpointLocation</span></span>|<span data-ttu-id="12acd-211">"eastus"</span><span class="sxs-lookup"><span data-stu-id="12acd-211">"eastus"</span></span>|<span data-ttu-id="12acd-212">Region of the endpoint</span><span class="sxs-lookup"><span data-stu-id="12acd-212">Region of the endpoint</span></span>|
    |<span data-ttu-id="12acd-213">-EndpointStatus</span><span class="sxs-lookup"><span data-stu-id="12acd-213">-EndpointStatus</span></span>|<span data-ttu-id="12acd-214">Enabled</span><span class="sxs-lookup"><span data-stu-id="12acd-214">Enabled</span></span>|<span data-ttu-id="12acd-215">Enable endpoint when it is created</span><span class="sxs-lookup"><span data-stu-id="12acd-215">Enable endpoint when it is created</span></span>|

    <span data-ttu-id="12acd-216">The successful response looks like:</span><span class="sxs-lookup"><span data-stu-id="12acd-216">The successful response looks like:</span></span>

    ```cmd
    Id                               : /subscriptions/<azure-subscription-id>/resourceGroups/luis-traffic-manager/providers/Microsoft.Network/trafficManagerProfiles/luis-profile-eastus
    Name                             : luis-profile-eastus
    ResourceGroupName                : luis-traffic-manager
    RelativeDnsName                  : luis-dns-eastus
    Ttl                              : 30
    ProfileStatus                    : Enabled
    TrafficRoutingMethod             : Performance
    MonitorProtocol                  : HTTPS
    MonitorPort                      : 443
    MonitorPath                      : /luis/v2.0/apps/<luis-app-id>?subscription-key=f0517d185bcf467cba5147d6260bb868&q=traffic-manager-east
    MonitorIntervalInSeconds         : 30
    MonitorTimeoutInSeconds          : 10
    MonitorToleratedNumberOfFailures : 3
    Endpoints                        : {luis-east-endpoint}
    ```

3. <span data-ttu-id="12acd-217">Set East US endpoint with **[Set-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/set-azurermtrafficmanagerprofile?view=azurermps-6.2.0)** cmdlet</span><span class="sxs-lookup"><span data-stu-id="12acd-217">Set East US endpoint with **[Set-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/set-azurermtrafficmanagerprofile?view=azurermps-6.2.0)** cmdlet</span></span>

    ```PowerShell
    Set-AzureRmTrafficManagerProfile -TrafficManagerProfile $eastprofile
    ```

    <span data-ttu-id="12acd-218">A successful response will be the same response as step 2.</span><span class="sxs-lookup"><span data-stu-id="12acd-218">A successful response will be the same response as step 2.</span></span>

### <a name="create-the-west-us-traffic-manager-profile-with-powershell"></a><span data-ttu-id="12acd-219">Create the West US Traffic Manager profile with PowerShell</span><span class="sxs-lookup"><span data-stu-id="12acd-219">Create the West US Traffic Manager profile with PowerShell</span></span>
<span data-ttu-id="12acd-220">To create the West US Traffic Manager profile, follow the same steps: create profile, add endpoint, and set endpoint.</span><span class="sxs-lookup"><span data-stu-id="12acd-220">To create the West US Traffic Manager profile, follow the same steps: create profile, add endpoint, and set endpoint.</span></span>

1. <span data-ttu-id="12acd-221">Create profile with **[New-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/New-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)** cmdlet</span><span class="sxs-lookup"><span data-stu-id="12acd-221">Create profile with **[New-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/New-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)** cmdlet</span></span>

    <span data-ttu-id="12acd-222">Use the following cmdlet to create the profile.</span><span class="sxs-lookup"><span data-stu-id="12acd-222">Use the following cmdlet to create the profile.</span></span> <span data-ttu-id="12acd-223">Make sure to change the `appIdLuis` and `subscriptionKeyLuis`.</span><span class="sxs-lookup"><span data-stu-id="12acd-223">Make sure to change the `appIdLuis` and `subscriptionKeyLuis`.</span></span> <span data-ttu-id="12acd-224">The subscriptionKey is for the East US LUIS key.</span><span class="sxs-lookup"><span data-stu-id="12acd-224">The subscriptionKey is for the East US LUIS key.</span></span> <span data-ttu-id="12acd-225">If the path is not correct including the LUIS app ID and endpoint key, the Traffic Manager polling is a status of `degraded` because Traffic Manage can't successfully request the LUIS endpoint.</span><span class="sxs-lookup"><span data-stu-id="12acd-225">If the path is not correct including the LUIS app ID and endpoint key, the Traffic Manager polling is a status of `degraded` because Traffic Manage can't successfully request the LUIS endpoint.</span></span> <span data-ttu-id="12acd-226">Make sure the value of `q` is `traffic-manager-west` so you can see this value in the LUIS endpoint logs.</span><span class="sxs-lookup"><span data-stu-id="12acd-226">Make sure the value of `q` is `traffic-manager-west` so you can see this value in the LUIS endpoint logs.</span></span>

    ```PowerShell
    $westprofile = New-AzureRmTrafficManagerProfile -Name luis-profile-westus -ResourceGroupName luis-traffic-manager -TrafficRoutingMethod Performance -RelativeDnsName luis-dns-westus -Ttl 30 -MonitorProtocol HTTPS -MonitorPort 443 -MonitorPath "/luis/v2.0/apps/<appIdLuis>?subscription-key=<subscriptionKeyLuis>&q=traffic-manager-west"
    ```
    
    <span data-ttu-id="12acd-227">This table explains each variable in the cmdlet:</span><span class="sxs-lookup"><span data-stu-id="12acd-227">This table explains each variable in the cmdlet:</span></span>
    
    |<span data-ttu-id="12acd-228">Configuration parameter</span><span class="sxs-lookup"><span data-stu-id="12acd-228">Configuration parameter</span></span>|<span data-ttu-id="12acd-229">Variable name or Value</span><span class="sxs-lookup"><span data-stu-id="12acd-229">Variable name or Value</span></span>|<span data-ttu-id="12acd-230">Purpose</span><span class="sxs-lookup"><span data-stu-id="12acd-230">Purpose</span></span>|
    |--|--|--|
    |<span data-ttu-id="12acd-231">-Name</span><span class="sxs-lookup"><span data-stu-id="12acd-231">-Name</span></span>|<span data-ttu-id="12acd-232">luis-profile-westus</span><span class="sxs-lookup"><span data-stu-id="12acd-232">luis-profile-westus</span></span>|<span data-ttu-id="12acd-233">Traffic Manager name in Azure portal</span><span class="sxs-lookup"><span data-stu-id="12acd-233">Traffic Manager name in Azure portal</span></span>|
    |<span data-ttu-id="12acd-234">-ResourceGroupName</span><span class="sxs-lookup"><span data-stu-id="12acd-234">-ResourceGroupName</span></span>|<span data-ttu-id="12acd-235">luis-traffic-manager</span><span class="sxs-lookup"><span data-stu-id="12acd-235">luis-traffic-manager</span></span>|<span data-ttu-id="12acd-236">Created in previous section</span><span class="sxs-lookup"><span data-stu-id="12acd-236">Created in previous section</span></span>|
    |<span data-ttu-id="12acd-237">-TrafficRoutingMethod</span><span class="sxs-lookup"><span data-stu-id="12acd-237">-TrafficRoutingMethod</span></span>|<span data-ttu-id="12acd-238">Performance</span><span class="sxs-lookup"><span data-stu-id="12acd-238">Performance</span></span>|<span data-ttu-id="12acd-239">For more information, see [Traffic Manager routing methods][routing-methods].</span><span class="sxs-lookup"><span data-stu-id="12acd-239">For more information, see [Traffic Manager routing methods][routing-methods].</span></span> <span data-ttu-id="12acd-240">If using performance, the URL request to the Traffic Manager must come from the region of the user.</span><span class="sxs-lookup"><span data-stu-id="12acd-240">If using performance, the URL request to the Traffic Manager must come from the region of the user.</span></span> <span data-ttu-id="12acd-241">If going through a chatbot or other application, it is the chatbot's responsibility to mimic the region in the call to the Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="12acd-241">If going through a chatbot or other application, it is the chatbot's responsibility to mimic the region in the call to the Traffic Manager.</span></span> |
    |<span data-ttu-id="12acd-242">-RelativeDnsName</span><span class="sxs-lookup"><span data-stu-id="12acd-242">-RelativeDnsName</span></span>|<span data-ttu-id="12acd-243">luis-dns-westus</span><span class="sxs-lookup"><span data-stu-id="12acd-243">luis-dns-westus</span></span>|<span data-ttu-id="12acd-244">This is the subdomain for the service: luis-dns-westus.trafficmanager.net</span><span class="sxs-lookup"><span data-stu-id="12acd-244">This is the subdomain for the service: luis-dns-westus.trafficmanager.net</span></span>|
    |<span data-ttu-id="12acd-245">-Ttl</span><span class="sxs-lookup"><span data-stu-id="12acd-245">-Ttl</span></span>|<span data-ttu-id="12acd-246">30</span><span class="sxs-lookup"><span data-stu-id="12acd-246">30</span></span>|<span data-ttu-id="12acd-247">Polling interval, 30 seconds</span><span class="sxs-lookup"><span data-stu-id="12acd-247">Polling interval, 30 seconds</span></span>|
    |<span data-ttu-id="12acd-248">-MonitorProtocol</span><span class="sxs-lookup"><span data-stu-id="12acd-248">-MonitorProtocol</span></span><BR><span data-ttu-id="12acd-249">-MonitorPort</span><span class="sxs-lookup"><span data-stu-id="12acd-249">-MonitorPort</span></span>|<span data-ttu-id="12acd-250">HTTPS</span><span class="sxs-lookup"><span data-stu-id="12acd-250">HTTPS</span></span><br><span data-ttu-id="12acd-251">443</span><span class="sxs-lookup"><span data-stu-id="12acd-251">443</span></span>|<span data-ttu-id="12acd-252">Port and protocol for LUIS is HTTPS/443</span><span class="sxs-lookup"><span data-stu-id="12acd-252">Port and protocol for LUIS is HTTPS/443</span></span>|
    |<span data-ttu-id="12acd-253">-MonitorPath</span><span class="sxs-lookup"><span data-stu-id="12acd-253">-MonitorPath</span></span>|`/luis/v2.0/apps/<appIdLuis>?subscription-key=<subscriptionKeyLuis>&q=traffic-manager-west`|<span data-ttu-id="12acd-254">Replace <appId> and <subscriptionKey> with your own values.</span><span class="sxs-lookup"><span data-stu-id="12acd-254">Replace <appId> and <subscriptionKey> with your own values.</span></span> <span data-ttu-id="12acd-255">Remember this endpoint key is different than the east endpoint key</span><span class="sxs-lookup"><span data-stu-id="12acd-255">Remember this endpoint key is different than the east endpoint key</span></span>|
    
    <span data-ttu-id="12acd-256">A successful request has no response.</span><span class="sxs-lookup"><span data-stu-id="12acd-256">A successful request has no response.</span></span>

2. <span data-ttu-id="12acd-257">Add West US endpoint with **[Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0)** cmdlet</span><span class="sxs-lookup"><span data-stu-id="12acd-257">Add West US endpoint with **[Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0)** cmdlet</span></span>

    ```PowerShell
    Add-AzureRmTrafficManagerEndpointConfig -EndpointName luis-west-endpoint -TrafficManagerProfile $westprofile -Type ExternalEndpoints -Target westus.api.cognitive.microsoft.com -EndpointLocation "westus" -EndpointStatus Enabled
    ```

    <span data-ttu-id="12acd-258">This table explains each variable in the cmdlet:</span><span class="sxs-lookup"><span data-stu-id="12acd-258">This table explains each variable in the cmdlet:</span></span>

    |<span data-ttu-id="12acd-259">Configuration parameter</span><span class="sxs-lookup"><span data-stu-id="12acd-259">Configuration parameter</span></span>|<span data-ttu-id="12acd-260">Variable name or Value</span><span class="sxs-lookup"><span data-stu-id="12acd-260">Variable name or Value</span></span>|<span data-ttu-id="12acd-261">Purpose</span><span class="sxs-lookup"><span data-stu-id="12acd-261">Purpose</span></span>|
    |--|--|--|
    |<span data-ttu-id="12acd-262">-EndpointName</span><span class="sxs-lookup"><span data-stu-id="12acd-262">-EndpointName</span></span>|<span data-ttu-id="12acd-263">luis-west-endpoint</span><span class="sxs-lookup"><span data-stu-id="12acd-263">luis-west-endpoint</span></span>|<span data-ttu-id="12acd-264">Endpoint name displayed under the profile</span><span class="sxs-lookup"><span data-stu-id="12acd-264">Endpoint name displayed under the profile</span></span>|
    |<span data-ttu-id="12acd-265">-TrafficManagerProfile</span><span class="sxs-lookup"><span data-stu-id="12acd-265">-TrafficManagerProfile</span></span>|<span data-ttu-id="12acd-266">$westprofile</span><span class="sxs-lookup"><span data-stu-id="12acd-266">$westprofile</span></span>|<span data-ttu-id="12acd-267">Use profile object created in Step 1</span><span class="sxs-lookup"><span data-stu-id="12acd-267">Use profile object created in Step 1</span></span>|
    |<span data-ttu-id="12acd-268">-Type</span><span class="sxs-lookup"><span data-stu-id="12acd-268">-Type</span></span>|<span data-ttu-id="12acd-269">ExternalEndpoints</span><span class="sxs-lookup"><span data-stu-id="12acd-269">ExternalEndpoints</span></span>|<span data-ttu-id="12acd-270">For more information, see [Traffic Manager endpoint][traffic-manager-endpoints]</span><span class="sxs-lookup"><span data-stu-id="12acd-270">For more information, see [Traffic Manager endpoint][traffic-manager-endpoints]</span></span> |
    |<span data-ttu-id="12acd-271">-Target</span><span class="sxs-lookup"><span data-stu-id="12acd-271">-Target</span></span>|<span data-ttu-id="12acd-272">westus.api.cognitive.microsoft.com</span><span class="sxs-lookup"><span data-stu-id="12acd-272">westus.api.cognitive.microsoft.com</span></span>|<span data-ttu-id="12acd-273">This is the domain for the LUIS endpoint.</span><span class="sxs-lookup"><span data-stu-id="12acd-273">This is the domain for the LUIS endpoint.</span></span>|
    |<span data-ttu-id="12acd-274">-EndpointLocation</span><span class="sxs-lookup"><span data-stu-id="12acd-274">-EndpointLocation</span></span>|<span data-ttu-id="12acd-275">"westus"</span><span class="sxs-lookup"><span data-stu-id="12acd-275">"westus"</span></span>|<span data-ttu-id="12acd-276">Region of the endpoint</span><span class="sxs-lookup"><span data-stu-id="12acd-276">Region of the endpoint</span></span>|
    |<span data-ttu-id="12acd-277">-EndpointStatus</span><span class="sxs-lookup"><span data-stu-id="12acd-277">-EndpointStatus</span></span>|<span data-ttu-id="12acd-278">Enabled</span><span class="sxs-lookup"><span data-stu-id="12acd-278">Enabled</span></span>|<span data-ttu-id="12acd-279">Enable endpoint when it is created</span><span class="sxs-lookup"><span data-stu-id="12acd-279">Enable endpoint when it is created</span></span>|

    <span data-ttu-id="12acd-280">The successful response looks like:</span><span class="sxs-lookup"><span data-stu-id="12acd-280">The successful response looks like:</span></span>

    ```cmd
    Id                               : /subscriptions/<azure-subscription-id>/resourceGroups/luis-traffic-manager/providers/Microsoft.Network/trafficManagerProfiles/luis-profile-westus
    Name                             : luis-profile-westus
    ResourceGroupName                : luis-traffic-manager
    RelativeDnsName                  : luis-dns-westus
    Ttl                              : 30
    ProfileStatus                    : Enabled
    TrafficRoutingMethod             : Performance
    MonitorProtocol                  : HTTPS
    MonitorPort                      : 443
    MonitorPath                      : /luis/v2.0/apps/c3fc5d1e-5187-40cc-af0f-fbde328aa16b?subscription-key=e3605f07e3cc4bedb7e02698a54c19cc&q=traffic-manager-west
    MonitorIntervalInSeconds         : 30
    MonitorTimeoutInSeconds          : 10
    MonitorToleratedNumberOfFailures : 3
    Endpoints                        : {luis-west-endpoint}
    ```

3. <span data-ttu-id="12acd-281">Set West US endpoint with **[Set-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Set-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)** cmdlet</span><span class="sxs-lookup"><span data-stu-id="12acd-281">Set West US endpoint with **[Set-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Set-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)** cmdlet</span></span>

    ```PowerShell
    Set-AzureRmTrafficManagerProfile -TrafficManagerProfile $westprofile
    ```

    <span data-ttu-id="12acd-282">A successful response is the same response as step 2.</span><span class="sxs-lookup"><span data-stu-id="12acd-282">A successful response is the same response as step 2.</span></span>

### <a name="create-parent-traffic-manager-profile"></a><span data-ttu-id="12acd-283">Create parent Traffic Manager profile</span><span class="sxs-lookup"><span data-stu-id="12acd-283">Create parent Traffic Manager profile</span></span>
<span data-ttu-id="12acd-284">Create the parent Traffic Manager profile and link two child Traffic Manager profiles to the parent.</span><span class="sxs-lookup"><span data-stu-id="12acd-284">Create the parent Traffic Manager profile and link two child Traffic Manager profiles to the parent.</span></span>

1. <span data-ttu-id="12acd-285">Create parent profile with **[New-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/New-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)** cmdlet</span><span class="sxs-lookup"><span data-stu-id="12acd-285">Create parent profile with **[New-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/New-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)** cmdlet</span></span>

    ```PowerShell
    $parentprofile = New-AzureRmTrafficManagerProfile -Name luis-profile-parent -ResourceGroupName luis-traffic-manager -TrafficRoutingMethod Performance -RelativeDnsName luis-dns-parent -Ttl 30 -MonitorProtocol HTTPS -MonitorPort 443 -MonitorPath "/"
    ```

    <span data-ttu-id="12acd-286">This table explains each variable in the cmdlet:</span><span class="sxs-lookup"><span data-stu-id="12acd-286">This table explains each variable in the cmdlet:</span></span>

    |<span data-ttu-id="12acd-287">Configuration parameter</span><span class="sxs-lookup"><span data-stu-id="12acd-287">Configuration parameter</span></span>|<span data-ttu-id="12acd-288">Variable name or Value</span><span class="sxs-lookup"><span data-stu-id="12acd-288">Variable name or Value</span></span>|<span data-ttu-id="12acd-289">Purpose</span><span class="sxs-lookup"><span data-stu-id="12acd-289">Purpose</span></span>|
    |--|--|--|
    |<span data-ttu-id="12acd-290">-Name</span><span class="sxs-lookup"><span data-stu-id="12acd-290">-Name</span></span>|<span data-ttu-id="12acd-291">luis-profile-parent</span><span class="sxs-lookup"><span data-stu-id="12acd-291">luis-profile-parent</span></span>|<span data-ttu-id="12acd-292">Traffic Manager name in Azure portal</span><span class="sxs-lookup"><span data-stu-id="12acd-292">Traffic Manager name in Azure portal</span></span>|
    |<span data-ttu-id="12acd-293">-ResourceGroupName</span><span class="sxs-lookup"><span data-stu-id="12acd-293">-ResourceGroupName</span></span>|<span data-ttu-id="12acd-294">luis-traffic-manager</span><span class="sxs-lookup"><span data-stu-id="12acd-294">luis-traffic-manager</span></span>|<span data-ttu-id="12acd-295">Created in previous section</span><span class="sxs-lookup"><span data-stu-id="12acd-295">Created in previous section</span></span>|
    |<span data-ttu-id="12acd-296">-TrafficRoutingMethod</span><span class="sxs-lookup"><span data-stu-id="12acd-296">-TrafficRoutingMethod</span></span>|<span data-ttu-id="12acd-297">Performance</span><span class="sxs-lookup"><span data-stu-id="12acd-297">Performance</span></span>|<span data-ttu-id="12acd-298">For more information, see [Traffic Manager routing methods][routing-methods].</span><span class="sxs-lookup"><span data-stu-id="12acd-298">For more information, see [Traffic Manager routing methods][routing-methods].</span></span> <span data-ttu-id="12acd-299">If using performance, the URL request to the Traffic Manager must come from the region of the user.</span><span class="sxs-lookup"><span data-stu-id="12acd-299">If using performance, the URL request to the Traffic Manager must come from the region of the user.</span></span> <span data-ttu-id="12acd-300">If going through a chatbot or other application, it is the chatbot's responsibility to mimic the region in the call to the Traffic Manager.</span><span class="sxs-lookup"><span data-stu-id="12acd-300">If going through a chatbot or other application, it is the chatbot's responsibility to mimic the region in the call to the Traffic Manager.</span></span> |
    |<span data-ttu-id="12acd-301">-RelativeDnsName</span><span class="sxs-lookup"><span data-stu-id="12acd-301">-RelativeDnsName</span></span>|<span data-ttu-id="12acd-302">luis-dns-parent</span><span class="sxs-lookup"><span data-stu-id="12acd-302">luis-dns-parent</span></span>|<span data-ttu-id="12acd-303">This is the subdomain for the service: luis-dns-parent.trafficmanager.net</span><span class="sxs-lookup"><span data-stu-id="12acd-303">This is the subdomain for the service: luis-dns-parent.trafficmanager.net</span></span>|
    |<span data-ttu-id="12acd-304">-Ttl</span><span class="sxs-lookup"><span data-stu-id="12acd-304">-Ttl</span></span>|<span data-ttu-id="12acd-305">30</span><span class="sxs-lookup"><span data-stu-id="12acd-305">30</span></span>|<span data-ttu-id="12acd-306">Polling interval, 30 seconds</span><span class="sxs-lookup"><span data-stu-id="12acd-306">Polling interval, 30 seconds</span></span>|
    |<span data-ttu-id="12acd-307">-MonitorProtocol</span><span class="sxs-lookup"><span data-stu-id="12acd-307">-MonitorProtocol</span></span><BR><span data-ttu-id="12acd-308">-MonitorPort</span><span class="sxs-lookup"><span data-stu-id="12acd-308">-MonitorPort</span></span>|<span data-ttu-id="12acd-309">HTTPS</span><span class="sxs-lookup"><span data-stu-id="12acd-309">HTTPS</span></span><br><span data-ttu-id="12acd-310">443</span><span class="sxs-lookup"><span data-stu-id="12acd-310">443</span></span>|<span data-ttu-id="12acd-311">Port and protocol for LUIS is HTTPS/443</span><span class="sxs-lookup"><span data-stu-id="12acd-311">Port and protocol for LUIS is HTTPS/443</span></span>|
    |<span data-ttu-id="12acd-312">-MonitorPath</span><span class="sxs-lookup"><span data-stu-id="12acd-312">-MonitorPath</span></span>|`/`|<span data-ttu-id="12acd-313">This path doesn't matter because the child endpoint paths are used instead.</span><span class="sxs-lookup"><span data-stu-id="12acd-313">This path doesn't matter because the child endpoint paths are used instead.</span></span>|

    <span data-ttu-id="12acd-314">A successful request has no response.</span><span class="sxs-lookup"><span data-stu-id="12acd-314">A successful request has no response.</span></span>

2. <span data-ttu-id="12acd-315">Add East US child profile to parent with **[Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0)** and **NestedEndpoints** type</span><span class="sxs-lookup"><span data-stu-id="12acd-315">Add East US child profile to parent with **[Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0)** and **NestedEndpoints** type</span></span>

    ```PowerShell
    Add-AzureRmTrafficManagerEndpointConfig -EndpointName child-endpoint-useast -TrafficManagerProfile $parentprofile -Type NestedEndpoints -TargetResourceId $eastprofile.Id -EndpointStatus Enabled -EndpointLocation "eastus" -MinChildEndpoints 1
    ```

    <span data-ttu-id="12acd-316">This table explains each variable in the cmdlet:</span><span class="sxs-lookup"><span data-stu-id="12acd-316">This table explains each variable in the cmdlet:</span></span>

    |<span data-ttu-id="12acd-317">Configuration parameter</span><span class="sxs-lookup"><span data-stu-id="12acd-317">Configuration parameter</span></span>|<span data-ttu-id="12acd-318">Variable name or Value</span><span class="sxs-lookup"><span data-stu-id="12acd-318">Variable name or Value</span></span>|<span data-ttu-id="12acd-319">Purpose</span><span class="sxs-lookup"><span data-stu-id="12acd-319">Purpose</span></span>|
    |--|--|--|
    |<span data-ttu-id="12acd-320">-EndpointName</span><span class="sxs-lookup"><span data-stu-id="12acd-320">-EndpointName</span></span>|<span data-ttu-id="12acd-321">child-endpoint-useast</span><span class="sxs-lookup"><span data-stu-id="12acd-321">child-endpoint-useast</span></span>|<span data-ttu-id="12acd-322">East profile</span><span class="sxs-lookup"><span data-stu-id="12acd-322">East profile</span></span>|
    |<span data-ttu-id="12acd-323">-TrafficManagerProfile</span><span class="sxs-lookup"><span data-stu-id="12acd-323">-TrafficManagerProfile</span></span>|<span data-ttu-id="12acd-324">$parentprofile</span><span class="sxs-lookup"><span data-stu-id="12acd-324">$parentprofile</span></span>|<span data-ttu-id="12acd-325">Profile to assign this endpoint to</span><span class="sxs-lookup"><span data-stu-id="12acd-325">Profile to assign this endpoint to</span></span>|
    |<span data-ttu-id="12acd-326">-Type</span><span class="sxs-lookup"><span data-stu-id="12acd-326">-Type</span></span>|<span data-ttu-id="12acd-327">NestedEndpoints</span><span class="sxs-lookup"><span data-stu-id="12acd-327">NestedEndpoints</span></span>|<span data-ttu-id="12acd-328">For more information, see [Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0).</span><span class="sxs-lookup"><span data-stu-id="12acd-328">For more information, see [Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0).</span></span> |
    |<span data-ttu-id="12acd-329">-TargetResourceId</span><span class="sxs-lookup"><span data-stu-id="12acd-329">-TargetResourceId</span></span>|<span data-ttu-id="12acd-330">$eastprofile.Id</span><span class="sxs-lookup"><span data-stu-id="12acd-330">$eastprofile.Id</span></span>|<span data-ttu-id="12acd-331">ID of the child profile</span><span class="sxs-lookup"><span data-stu-id="12acd-331">ID of the child profile</span></span>|
    |<span data-ttu-id="12acd-332">-EndpointStatus</span><span class="sxs-lookup"><span data-stu-id="12acd-332">-EndpointStatus</span></span>|<span data-ttu-id="12acd-333">Enabled</span><span class="sxs-lookup"><span data-stu-id="12acd-333">Enabled</span></span>|<span data-ttu-id="12acd-334">Endpoint status after adding to parent</span><span class="sxs-lookup"><span data-stu-id="12acd-334">Endpoint status after adding to parent</span></span>|
    |<span data-ttu-id="12acd-335">-EndpointLocation</span><span class="sxs-lookup"><span data-stu-id="12acd-335">-EndpointLocation</span></span>|<span data-ttu-id="12acd-336">"eastus"</span><span class="sxs-lookup"><span data-stu-id="12acd-336">"eastus"</span></span>|<span data-ttu-id="12acd-337">[Azure region name](https://azure.microsoft.com/global-infrastructure/regions/) of resource</span><span class="sxs-lookup"><span data-stu-id="12acd-337">[Azure region name](https://azure.microsoft.com/global-infrastructure/regions/) of resource</span></span>|
    |<span data-ttu-id="12acd-338">-MinChildEndpoints</span><span class="sxs-lookup"><span data-stu-id="12acd-338">-MinChildEndpoints</span></span>|<span data-ttu-id="12acd-339">1</span><span class="sxs-lookup"><span data-stu-id="12acd-339">1</span></span>|<span data-ttu-id="12acd-340">Minimum number to child endpoints</span><span class="sxs-lookup"><span data-stu-id="12acd-340">Minimum number to child endpoints</span></span>|

    <span data-ttu-id="12acd-341">The successful response look like the following and includes the new `child-endpoint-useast` endpoint:</span><span class="sxs-lookup"><span data-stu-id="12acd-341">The successful response look like the following and includes the new `child-endpoint-useast` endpoint:</span></span>    

    ```cmd
    Id                               : /subscriptions/<azure-subscription-id>/resourceGroups/luis-traffic-manager/providers/Microsoft.Network/trafficManagerProfiles/luis-profile-parent
    Name                             : luis-profile-parent
    ResourceGroupName                : luis-traffic-manager
    RelativeDnsName                  : luis-dns-parent
    Ttl                              : 30
    ProfileStatus                    : Enabled
    TrafficRoutingMethod             : Performance
    MonitorProtocol                  : HTTPS
    MonitorPort                      : 443
    MonitorPath                      : /
    MonitorIntervalInSeconds         : 30
    MonitorTimeoutInSeconds          : 10
    MonitorToleratedNumberOfFailures : 3
    Endpoints                        : {child-endpoint-useast}
    ```

3. <span data-ttu-id="12acd-342">Add West US child profile to parent with **[Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0)** cmdlet and **NestedEndpoints** type</span><span class="sxs-lookup"><span data-stu-id="12acd-342">Add West US child profile to parent with **[Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0)** cmdlet and **NestedEndpoints** type</span></span>

    ```PowerShell
    Add-AzureRmTrafficManagerEndpointConfig -EndpointName child-endpoint-uswest -TrafficManagerProfile $parentprofile -Type NestedEndpoints -TargetResourceId $westprofile.Id -EndpointStatus Enabled -EndpointLocation "westus" -MinChildEndpoints 1
    ```

    <span data-ttu-id="12acd-343">This table explains each variable in the cmdlet:</span><span class="sxs-lookup"><span data-stu-id="12acd-343">This table explains each variable in the cmdlet:</span></span>

    |<span data-ttu-id="12acd-344">Configuration parameter</span><span class="sxs-lookup"><span data-stu-id="12acd-344">Configuration parameter</span></span>|<span data-ttu-id="12acd-345">Variable name or Value</span><span class="sxs-lookup"><span data-stu-id="12acd-345">Variable name or Value</span></span>|<span data-ttu-id="12acd-346">Purpose</span><span class="sxs-lookup"><span data-stu-id="12acd-346">Purpose</span></span>|
    |--|--|--|
    |<span data-ttu-id="12acd-347">-EndpointName</span><span class="sxs-lookup"><span data-stu-id="12acd-347">-EndpointName</span></span>|<span data-ttu-id="12acd-348">child-endpoint-uswest</span><span class="sxs-lookup"><span data-stu-id="12acd-348">child-endpoint-uswest</span></span>|<span data-ttu-id="12acd-349">West profile</span><span class="sxs-lookup"><span data-stu-id="12acd-349">West profile</span></span>|
    |<span data-ttu-id="12acd-350">-TrafficManagerProfile</span><span class="sxs-lookup"><span data-stu-id="12acd-350">-TrafficManagerProfile</span></span>|<span data-ttu-id="12acd-351">$parentprofile</span><span class="sxs-lookup"><span data-stu-id="12acd-351">$parentprofile</span></span>|<span data-ttu-id="12acd-352">Profile to assign this endpoint to</span><span class="sxs-lookup"><span data-stu-id="12acd-352">Profile to assign this endpoint to</span></span>|
    |<span data-ttu-id="12acd-353">-Type</span><span class="sxs-lookup"><span data-stu-id="12acd-353">-Type</span></span>|<span data-ttu-id="12acd-354">NestedEndpoints</span><span class="sxs-lookup"><span data-stu-id="12acd-354">NestedEndpoints</span></span>|<span data-ttu-id="12acd-355">For more information, see [Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0).</span><span class="sxs-lookup"><span data-stu-id="12acd-355">For more information, see [Add-AzureRmTrafficManagerEndpointConfig](https://docs.microsoft.com/powershell/module/azurerm.trafficmanager/Add-AzureRmTrafficManagerEndpointConfig?view=azurermps-6.2.0).</span></span> |
    |<span data-ttu-id="12acd-356">-TargetResourceId</span><span class="sxs-lookup"><span data-stu-id="12acd-356">-TargetResourceId</span></span>|<span data-ttu-id="12acd-357">$westprofile.Id</span><span class="sxs-lookup"><span data-stu-id="12acd-357">$westprofile.Id</span></span>|<span data-ttu-id="12acd-358">ID of the child profile</span><span class="sxs-lookup"><span data-stu-id="12acd-358">ID of the child profile</span></span>|
    |<span data-ttu-id="12acd-359">-EndpointStatus</span><span class="sxs-lookup"><span data-stu-id="12acd-359">-EndpointStatus</span></span>|<span data-ttu-id="12acd-360">Enabled</span><span class="sxs-lookup"><span data-stu-id="12acd-360">Enabled</span></span>|<span data-ttu-id="12acd-361">Endpoint status after adding to parent</span><span class="sxs-lookup"><span data-stu-id="12acd-361">Endpoint status after adding to parent</span></span>|
    |<span data-ttu-id="12acd-362">-EndpointLocation</span><span class="sxs-lookup"><span data-stu-id="12acd-362">-EndpointLocation</span></span>|<span data-ttu-id="12acd-363">"westus"</span><span class="sxs-lookup"><span data-stu-id="12acd-363">"westus"</span></span>|<span data-ttu-id="12acd-364">[Azure region name](https://azure.microsoft.com/global-infrastructure/regions/) of resource</span><span class="sxs-lookup"><span data-stu-id="12acd-364">[Azure region name](https://azure.microsoft.com/global-infrastructure/regions/) of resource</span></span>|
    |<span data-ttu-id="12acd-365">-MinChildEndpoints</span><span class="sxs-lookup"><span data-stu-id="12acd-365">-MinChildEndpoints</span></span>|<span data-ttu-id="12acd-366">1</span><span class="sxs-lookup"><span data-stu-id="12acd-366">1</span></span>|<span data-ttu-id="12acd-367">Minimum number to child endpoints</span><span class="sxs-lookup"><span data-stu-id="12acd-367">Minimum number to child endpoints</span></span>|

    <span data-ttu-id="12acd-368">The successful response look like  and includes both the previous `child-endpoint-useast` endpoint and the new `child-endpoint-uswest` endpoint:</span><span class="sxs-lookup"><span data-stu-id="12acd-368">The successful response look like  and includes both the previous `child-endpoint-useast` endpoint and the new `child-endpoint-uswest` endpoint:</span></span>

    ```cmd
    Id                               : /subscriptions/<azure-subscription-id>/resourceGroups/luis-traffic-manager/providers/Microsoft.Network/trafficManagerProfiles/luis-profile-parent
    Name                             : luis-profile-parent
    ResourceGroupName                : luis-traffic-manager
    RelativeDnsName                  : luis-dns-parent
    Ttl                              : 30
    ProfileStatus                    : Enabled
    TrafficRoutingMethod             : Performance
    MonitorProtocol                  : HTTPS
    MonitorPort                      : 443
    MonitorPath                      : /
    MonitorIntervalInSeconds         : 30
    MonitorTimeoutInSeconds          : 10
    MonitorToleratedNumberOfFailures : 3
    Endpoints                        : {child-endpoint-useast, child-endpoint-uswest}
    ```

4. <span data-ttu-id="12acd-369">Set endpoints with **[Set-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Set-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)** cmdlet</span><span class="sxs-lookup"><span data-stu-id="12acd-369">Set endpoints with **[Set-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Set-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)** cmdlet</span></span> 

    ```PowerShell
    Set-AzureRmTrafficManagerProfile -TrafficManagerProfile $parentprofile
    ```

    <span data-ttu-id="12acd-370">A successful response is the same response as step 3.</span><span class="sxs-lookup"><span data-stu-id="12acd-370">A successful response is the same response as step 3.</span></span>

### <a name="powershell-variables"></a><span data-ttu-id="12acd-371">PowerShell variables</span><span class="sxs-lookup"><span data-stu-id="12acd-371">PowerShell variables</span></span>
<span data-ttu-id="12acd-372">In the previous sections, three PowerShell variables were created: `$eastprofile`, `$westprofile`, `$parentprofile`.</span><span class="sxs-lookup"><span data-stu-id="12acd-372">In the previous sections, three PowerShell variables were created: `$eastprofile`, `$westprofile`, `$parentprofile`.</span></span> <span data-ttu-id="12acd-373">These variables are used toward the end of the Traffic Manager configuration.</span><span class="sxs-lookup"><span data-stu-id="12acd-373">These variables are used toward the end of the Traffic Manager configuration.</span></span> <span data-ttu-id="12acd-374">If you chose not to create the variables, or forgot to, or your PowerShell window times out, you can use the PowerShell cmdlet, **[Get-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Get-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)**, to get the profile again and assign it to a variable.</span><span class="sxs-lookup"><span data-stu-id="12acd-374">If you chose not to create the variables, or forgot to, or your PowerShell window times out, you can use the PowerShell cmdlet, **[Get-AzureRmTrafficManagerProfile](https://docs.microsoft.com/powershell/module/AzureRM.TrafficManager/Get-AzureRmTrafficManagerProfile?view=azurermps-6.2.0)**, to get the profile again and assign it to a variable.</span></span> 

<span data-ttu-id="12acd-375">Replace the items in angle brackets, `<>`, with the correct values for each of the three profiles you need.</span><span class="sxs-lookup"><span data-stu-id="12acd-375">Replace the items in angle brackets, `<>`, with the correct values for each of the three profiles you need.</span></span> 

```PowerShell
$<variable-name> = Get-AzureRmTrafficManagerProfile -Name <profile-name> -ResourceGroupName luis-traffic-manager
```

## <a name="verify-traffic-manager-works"></a><span data-ttu-id="12acd-376">Verify Traffic Manager works</span><span class="sxs-lookup"><span data-stu-id="12acd-376">Verify Traffic Manager works</span></span>
<span data-ttu-id="12acd-377">To verify that the Traffic Manager profiles work, the profiles need to have the status of `Online` This status is based on the polling path of the endpoint.</span><span class="sxs-lookup"><span data-stu-id="12acd-377">To verify that the Traffic Manager profiles work, the profiles need to have the status of `Online` This status is based on the polling path of the endpoint.</span></span> 

### <a name="view-new-profiles-in-the-azure-portal"></a><span data-ttu-id="12acd-378">View new profiles in the Azure portal</span><span class="sxs-lookup"><span data-stu-id="12acd-378">View new profiles in the Azure portal</span></span>
<span data-ttu-id="12acd-379">You can verify that all three profiles are created by looking at the resources in the `luis-traffic-manager` resource group.</span><span class="sxs-lookup"><span data-stu-id="12acd-379">You can verify that all three profiles are created by looking at the resources in the `luis-traffic-manager` resource group.</span></span>

![Screenshot of Azure resource group luis-traffic-manager](./media/traffic-manager/traffic-manager-profiles.png)

### <a name="verify-the-profile-status-is-online"></a><span data-ttu-id="12acd-381">Verify the profile status is Online</span><span class="sxs-lookup"><span data-stu-id="12acd-381">Verify the profile status is Online</span></span>
<span data-ttu-id="12acd-382">The Traffic Manager polls the path of each endpoint to make sure it is online.</span><span class="sxs-lookup"><span data-stu-id="12acd-382">The Traffic Manager polls the path of each endpoint to make sure it is online.</span></span> <span data-ttu-id="12acd-383">If it is online, the status of the child profiles are `Online`.</span><span class="sxs-lookup"><span data-stu-id="12acd-383">If it is online, the status of the child profiles are `Online`.</span></span> <span data-ttu-id="12acd-384">This is displayed on the **Overview** of each profile.</span><span class="sxs-lookup"><span data-stu-id="12acd-384">This is displayed on the **Overview** of each profile.</span></span> 

![Screenshot of Azure Traffic Manager profile Overview showing Monitor Status of Online](./media/traffic-manager/profile-status-online.png)

### <a name="validate-traffic-manager-polling-works"></a><span data-ttu-id="12acd-386">Validate Traffic Manager polling works</span><span class="sxs-lookup"><span data-stu-id="12acd-386">Validate Traffic Manager polling works</span></span>
<span data-ttu-id="12acd-387">Another way to validate the traffic manager polling works is with the LUIS endpoint logs.</span><span class="sxs-lookup"><span data-stu-id="12acd-387">Another way to validate the traffic manager polling works is with the LUIS endpoint logs.</span></span> <span data-ttu-id="12acd-388">On the [LUIS][LUIS] website apps list page, export the endpoint log for the application.</span><span class="sxs-lookup"><span data-stu-id="12acd-388">On the [LUIS][LUIS] website apps list page, export the endpoint log for the application.</span></span> <span data-ttu-id="12acd-389">Because Traffic Manager polls often for the two endpoints, there are entries in the logs even if they have only been on a few minutes.</span><span class="sxs-lookup"><span data-stu-id="12acd-389">Because Traffic Manager polls often for the two endpoints, there are entries in the logs even if they have only been on a few minutes.</span></span> <span data-ttu-id="12acd-390">Remember to look for entries where the query begins with `traffic-manager-`.</span><span class="sxs-lookup"><span data-stu-id="12acd-390">Remember to look for entries where the query begins with `traffic-manager-`.</span></span>

```text
traffic-manager-west    6/7/2018 19:19  {"query":"traffic-manager-west","intents":[{"intent":"None","score":0.944767}],"entities":[]}
traffic-manager-east    6/7/2018 19:20  {"query":"traffic-manager-east","intents":[{"intent":"None","score":0.944767}],"entities":[]}
```

### <a name="validate-dns-response-from-traffic-manager-works"></a><span data-ttu-id="12acd-391">Validate DNS response from Traffic Manager works</span><span class="sxs-lookup"><span data-stu-id="12acd-391">Validate DNS response from Traffic Manager works</span></span>
<span data-ttu-id="12acd-392">To validate that the DNS response returns a LUIS endpoint, request the Traffic Manage parent profile DNS using a DNS client library.</span><span class="sxs-lookup"><span data-stu-id="12acd-392">To validate that the DNS response returns a LUIS endpoint, request the Traffic Manage parent profile DNS using a DNS client library.</span></span> <span data-ttu-id="12acd-393">The DNS name for the parent profile is `luis-dns-parent.trafficmanager.net`.</span><span class="sxs-lookup"><span data-stu-id="12acd-393">The DNS name for the parent profile is `luis-dns-parent.trafficmanager.net`.</span></span>

<span data-ttu-id="12acd-394">The following Node.js code makes a request for the parent profile and returns a LUIS endpoint:</span><span class="sxs-lookup"><span data-stu-id="12acd-394">The following Node.js code makes a request for the parent profile and returns a LUIS endpoint:</span></span>

```javascript
const dns = require('dns');

dns.resolveAny('luis-dns-parent.trafficmanager.net', (err, ret) => {
  console.log('ret', ret);
});
```

<span data-ttu-id="12acd-395">The successful response with the LUIS endpoint is:</span><span class="sxs-lookup"><span data-stu-id="12acd-395">The successful response with the LUIS endpoint is:</span></span>

```cmd
[
    {
        value: 'westus.api.cognitive.microsoft.com', 
        type: 'CNAME'
    }
]
```

## <a name="use-the-traffic-manager-parent-profile"></a><span data-ttu-id="12acd-396">Use the Traffic Manager parent profile</span><span class="sxs-lookup"><span data-stu-id="12acd-396">Use the Traffic Manager parent profile</span></span>
<span data-ttu-id="12acd-397">In order to manage traffic across endpoints, you need to insert a call to the Traffic Manager DNS to find the LUIS endpoint.</span><span class="sxs-lookup"><span data-stu-id="12acd-397">In order to manage traffic across endpoints, you need to insert a call to the Traffic Manager DNS to find the LUIS endpoint.</span></span> <span data-ttu-id="12acd-398">This call is made for every LUIS endpoint request and needs to simulate the geographic location of the user of the LUIS client application.</span><span class="sxs-lookup"><span data-stu-id="12acd-398">This call is made for every LUIS endpoint request and needs to simulate the geographic location of the user of the LUIS client application.</span></span> <span data-ttu-id="12acd-399">Add the DNS response code in between your LUIS client application and the request to LUIS for the endpoint prediction.</span><span class="sxs-lookup"><span data-stu-id="12acd-399">Add the DNS response code in between your LUIS client application and the request to LUIS for the endpoint prediction.</span></span> 


## <a name="clean-up"></a><span data-ttu-id="12acd-400">Clean up</span><span class="sxs-lookup"><span data-stu-id="12acd-400">Clean up</span></span>
<span data-ttu-id="12acd-401">Remove the two LUIS endpoint keys, the three Traffic Manager profiles, and the resource group that contained these five resources.</span><span class="sxs-lookup"><span data-stu-id="12acd-401">Remove the two LUIS endpoint keys, the three Traffic Manager profiles, and the resource group that contained these five resources.</span></span> <span data-ttu-id="12acd-402">This is done from the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="12acd-402">This is done from the Azure portal.</span></span> <span data-ttu-id="12acd-403">You delete the five resources from the resources list.</span><span class="sxs-lookup"><span data-stu-id="12acd-403">You delete the five resources from the resources list.</span></span> <span data-ttu-id="12acd-404">Then delete the resource group.</span><span class="sxs-lookup"><span data-stu-id="12acd-404">Then delete the resource group.</span></span> 

## <a name="next-steps"></a><span data-ttu-id="12acd-405">Next steps</span><span class="sxs-lookup"><span data-stu-id="12acd-405">Next steps</span></span>

<span data-ttu-id="12acd-406">Review [middleware](https://docs.microsoft.com/azure/bot-service/bot-builder-create-middleware?view=azure-bot-service-4.0&tabs=csaddmiddleware%2Ccsetagoverwrite%2Ccsmiddlewareshortcircuit%2Ccsfallback%2Ccsactivityhandler) options in BotFramework v4 to understand how this traffic management code can be added to a BotFramework bot.</span><span class="sxs-lookup"><span data-stu-id="12acd-406">Review [middleware](https://docs.microsoft.com/azure/bot-service/bot-builder-create-middleware?view=azure-bot-service-4.0&tabs=csaddmiddleware%2Ccsetagoverwrite%2Ccsmiddlewareshortcircuit%2Ccsfallback%2Ccsactivityhandler) options in BotFramework v4 to understand how this traffic management code can be added to a BotFramework bot.</span></span> 

[traffic-manager-marketing]: https://azure.microsoft.com/services/traffic-manager/
[traffic-manager-docs]: https://docs.microsoft.com/azure/traffic-manager/
[LUIS]: https://docs.microsoft.com/azure/cognitive-services/luis/luis-reference-regions#luis-website
[azure-portal]: https://portal.azure.com/
[azure-storage]: https://azure.microsoft.com/services/storage/
[routing-methods]: https://docs.microsoft.com/azure/traffic-manager/traffic-manager-routing-methods
[traffic-manager-endpoints]: https://docs.microsoft.com/azure/traffic-manager/traffic-manager-endpoint-types
