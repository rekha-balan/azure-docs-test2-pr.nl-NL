---
title: How to create a language model with the Speech Service - Microsoft Cognitive Services
description: Learn how to create a language model with the Speech Service in Microsoft Cognitive Services.
services: cognitive-services
author: PanosPeriorellis
ms.service: cognitive-services
ms.component: speech-service
ms.topic: tutorial
ms.date: 06/25/2018
ms.author: panosper
ms.openlocfilehash: 97659bf38b6d06464eee37a33e87d0c528cdcd37
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44967276"
---
# <a name="tutorial-create-a-custom-language-model"></a><span data-ttu-id="c8005-103">Tutorial: Create a custom language model</span><span class="sxs-lookup"><span data-stu-id="c8005-103">Tutorial: Create a custom language model</span></span>

<span data-ttu-id="c8005-104">In this document, you create a custom language model, which you can then use in conjunction with existing state-of-the-art speech models from Microsoft to add voice interaction to your application.</span><span class="sxs-lookup"><span data-stu-id="c8005-104">In this document, you create a custom language model, which you can then use in conjunction with existing state-of-the-art speech models from Microsoft to add voice interaction to your application.</span></span>

<span data-ttu-id="c8005-105">The document discusses how to:</span><span class="sxs-lookup"><span data-stu-id="c8005-105">The document discusses how to:</span></span>
> [!div class="checklist"]
> * <span data-ttu-id="c8005-106">Prepare the data</span><span class="sxs-lookup"><span data-stu-id="c8005-106">Prepare the data</span></span>
> * <span data-ttu-id="c8005-107">Import the language data set</span><span class="sxs-lookup"><span data-stu-id="c8005-107">Import the language data set</span></span>
> * <span data-ttu-id="c8005-108">Create the custom language model</span><span class="sxs-lookup"><span data-stu-id="c8005-108">Create the custom language model</span></span>

<span data-ttu-id="c8005-109">If you don't have a Cognitive Services account, create a [free account](https://azure.microsoft.com/try/cognitive-services/) before you begin.</span><span class="sxs-lookup"><span data-stu-id="c8005-109">If you don't have a Cognitive Services account, create a [free account](https://azure.microsoft.com/try/cognitive-services/) before you begin.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="c8005-110">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="c8005-110">Prerequisites</span></span>

<span data-ttu-id="c8005-111">Ensure that your Cognitive Services account is connected to a subscription by opening the [Cognitive Services Subscriptions](https://customspeech.ai/Subscriptions) page.</span><span class="sxs-lookup"><span data-stu-id="c8005-111">Ensure that your Cognitive Services account is connected to a subscription by opening the [Cognitive Services Subscriptions](https://customspeech.ai/Subscriptions) page.</span></span>

<span data-ttu-id="c8005-112">You can connect to a Speech Service subscription created in the Azure portal by clicking the **Connect existing subscription** button.</span><span class="sxs-lookup"><span data-stu-id="c8005-112">You can connect to a Speech Service subscription created in the Azure portal by clicking the **Connect existing subscription** button.</span></span>

<span data-ttu-id="c8005-113">For information on creating a Speech Service subscription in the Azure portal, see the [get-started](get-started.md) page.</span><span class="sxs-lookup"><span data-stu-id="c8005-113">For information on creating a Speech Service subscription in the Azure portal, see the [get-started](get-started.md) page.</span></span>

## <a name="prepare-the-data"></a><span data-ttu-id="c8005-114">Prepare the data</span><span class="sxs-lookup"><span data-stu-id="c8005-114">Prepare the data</span></span>

<span data-ttu-id="c8005-115">In order to create a custom language model for your application, you need to provide a list of example utterances to the system, for example:</span><span class="sxs-lookup"><span data-stu-id="c8005-115">In order to create a custom language model for your application, you need to provide a list of example utterances to the system, for example:</span></span>

*   <span data-ttu-id="c8005-116">"the patient has had urticaria for the past week."</span><span class="sxs-lookup"><span data-stu-id="c8005-116">"the patient has had urticaria for the past week."</span></span>
*   <span data-ttu-id="c8005-117">"The patient had a well-healed herniorrhaphy scar."</span><span class="sxs-lookup"><span data-stu-id="c8005-117">"The patient had a well-healed herniorrhaphy scar."</span></span>

<span data-ttu-id="c8005-118">The sentences do not need to be complete sentences or grammatically correct, and should accurately reflect the spoken input the system is expected to encounter in deployment.</span><span class="sxs-lookup"><span data-stu-id="c8005-118">The sentences do not need to be complete sentences or grammatically correct, and should accurately reflect the spoken input the system is expected to encounter in deployment.</span></span> <span data-ttu-id="c8005-119">These examples should reflect both the style and content of the task the users will perform with your application.</span><span class="sxs-lookup"><span data-stu-id="c8005-119">These examples should reflect both the style and content of the task the users will perform with your application.</span></span>

<span data-ttu-id="c8005-120">The language model data should be written in UTF-8 BOM.</span><span class="sxs-lookup"><span data-stu-id="c8005-120">The language model data should be written in UTF-8 BOM.</span></span> <span data-ttu-id="c8005-121">The text file should contain one example (sentence, utterance, or query) per line.</span><span class="sxs-lookup"><span data-stu-id="c8005-121">The text file should contain one example (sentence, utterance, or query) per line.</span></span>

<span data-ttu-id="c8005-122">If you wish some terms to have a higher weight (importance), you can add several utterances that include that term to your data.</span><span class="sxs-lookup"><span data-stu-id="c8005-122">If you wish some terms to have a higher weight (importance), you can add several utterances that include that term to your data.</span></span> 

<span data-ttu-id="c8005-123">The main requirements for the language data are summarized in the following table.</span><span class="sxs-lookup"><span data-stu-id="c8005-123">The main requirements for the language data are summarized in the following table.</span></span>

| <span data-ttu-id="c8005-124">Property</span><span class="sxs-lookup"><span data-stu-id="c8005-124">Property</span></span> | <span data-ttu-id="c8005-125">Value</span><span class="sxs-lookup"><span data-stu-id="c8005-125">Value</span></span> |
|----------|-------|
| <span data-ttu-id="c8005-126">Text Encoding</span><span class="sxs-lookup"><span data-stu-id="c8005-126">Text Encoding</span></span> | <span data-ttu-id="c8005-127">UTF-8 BOM</span><span class="sxs-lookup"><span data-stu-id="c8005-127">UTF-8 BOM</span></span>|
| <span data-ttu-id="c8005-128"># of Utterances per line</span><span class="sxs-lookup"><span data-stu-id="c8005-128"># of Utterances per line</span></span> | <span data-ttu-id="c8005-129">1</span><span class="sxs-lookup"><span data-stu-id="c8005-129">1</span></span> |
| <span data-ttu-id="c8005-130">Maximum File Size</span><span class="sxs-lookup"><span data-stu-id="c8005-130">Maximum File Size</span></span> | <span data-ttu-id="c8005-131">1.5 GB</span><span class="sxs-lookup"><span data-stu-id="c8005-131">1.5 GB</span></span> |
| <span data-ttu-id="c8005-132">Remarks</span><span class="sxs-lookup"><span data-stu-id="c8005-132">Remarks</span></span> | <span data-ttu-id="c8005-133">avoid repeating characters more often than four times, for example 'aaaaa'</span><span class="sxs-lookup"><span data-stu-id="c8005-133">avoid repeating characters more often than four times, for example 'aaaaa'</span></span>|
| <span data-ttu-id="c8005-134">Remarks</span><span class="sxs-lookup"><span data-stu-id="c8005-134">Remarks</span></span> | <span data-ttu-id="c8005-135">no special characters like '\t' or any other UTF-8 character above U+00A1 in [Unicode characters table](http://www.utf8-chartable.de/)</span><span class="sxs-lookup"><span data-stu-id="c8005-135">no special characters like '\t' or any other UTF-8 character above U+00A1 in [Unicode characters table](http://www.utf8-chartable.de/)</span></span>|
| <span data-ttu-id="c8005-136">Remarks</span><span class="sxs-lookup"><span data-stu-id="c8005-136">Remarks</span></span> | <span data-ttu-id="c8005-137">URIs will also be rejected since there is no unique way to pronounce a URI</span><span class="sxs-lookup"><span data-stu-id="c8005-137">URIs will also be rejected since there is no unique way to pronounce a URI</span></span>|

<span data-ttu-id="c8005-138">When the text is imported, it is text-normalized so it can be processed by the system.</span><span class="sxs-lookup"><span data-stu-id="c8005-138">When the text is imported, it is text-normalized so it can be processed by the system.</span></span> <span data-ttu-id="c8005-139">However, there are some important normalizations that must be done by the user _prior_ to uploading the data.</span><span class="sxs-lookup"><span data-stu-id="c8005-139">However, there are some important normalizations that must be done by the user _prior_ to uploading the data.</span></span> <span data-ttu-id="c8005-140">See the [Transcription guidelines](prepare-transcription.md) to determine appropriate language when preparing your language data.</span><span class="sxs-lookup"><span data-stu-id="c8005-140">See the [Transcription guidelines](prepare-transcription.md) to determine appropriate language when preparing your language data.</span></span>

## <a name="language-support"></a><span data-ttu-id="c8005-141">Language support</span><span class="sxs-lookup"><span data-stu-id="c8005-141">Language support</span></span>

<span data-ttu-id="c8005-142">The following languages are supported for custom **Speech to Text** language models.</span><span class="sxs-lookup"><span data-stu-id="c8005-142">The following languages are supported for custom **Speech to Text** language models.</span></span>

<span data-ttu-id="c8005-143">Click for Full list of [Supported-languages](supported-languages.md)</span><span class="sxs-lookup"><span data-stu-id="c8005-143">Click for Full list of [Supported-languages](supported-languages.md)</span></span>

## <a name="import-the-language-data-set"></a><span data-ttu-id="c8005-144">Import the language data set</span><span class="sxs-lookup"><span data-stu-id="c8005-144">Import the language data set</span></span>

<span data-ttu-id="c8005-145">Click the “Import” button in the "Language Datasets" row, and the site displays a page for uploading a new data set.</span><span class="sxs-lookup"><span data-stu-id="c8005-145">Click the “Import” button in the "Language Datasets" row, and the site displays a page for uploading a new data set.</span></span>

<span data-ttu-id="c8005-146">When you are ready to import your language data set, log into the [Speech Service Portal](https://customspeech.ai).</span><span class="sxs-lookup"><span data-stu-id="c8005-146">When you are ready to import your language data set, log into the [Speech Service Portal](https://customspeech.ai).</span></span>  <span data-ttu-id="c8005-147">Then click the “Custom Speech” drop-down menu on the top ribbon and select “Adaptation Data”.</span><span class="sxs-lookup"><span data-stu-id="c8005-147">Then click the “Custom Speech” drop-down menu on the top ribbon and select “Adaptation Data”.</span></span> <span data-ttu-id="c8005-148">The first time one attempts to upload data to the Speech Service, you will see an empty table called “Datasets”.</span><span class="sxs-lookup"><span data-stu-id="c8005-148">The first time one attempts to upload data to the Speech Service, you will see an empty table called “Datasets”.</span></span>

<span data-ttu-id="c8005-149">To import a new data set, click the “Import” button in the "Language Datasets" row, and the site displays a page for uploading a new data set.</span><span class="sxs-lookup"><span data-stu-id="c8005-149">To import a new data set, click the “Import” button in the "Language Datasets" row, and the site displays a page for uploading a new data set.</span></span> <span data-ttu-id="c8005-150">Enter a Name and Description to help you identify the data set in the future and choose the locale.</span><span class="sxs-lookup"><span data-stu-id="c8005-150">Enter a Name and Description to help you identify the data set in the future and choose the locale.</span></span> <span data-ttu-id="c8005-151">Next, use the “Choose File” button to locate the text file of language data.</span><span class="sxs-lookup"><span data-stu-id="c8005-151">Next, use the “Choose File” button to locate the text file of language data.</span></span> <span data-ttu-id="c8005-152">After that, click “Import” and the data set will be uploaded.</span><span class="sxs-lookup"><span data-stu-id="c8005-152">After that, click “Import” and the data set will be uploaded.</span></span> <span data-ttu-id="c8005-153">Depending on the size of the data set, import may take several minutes.</span><span class="sxs-lookup"><span data-stu-id="c8005-153">Depending on the size of the data set, import may take several minutes.</span></span>

![try](media/stt/speech-language-datasets-import.png)

<span data-ttu-id="c8005-155">When the import is complete, you will return to the language data table and will see an entry that corresponds to your language data set.</span><span class="sxs-lookup"><span data-stu-id="c8005-155">When the import is complete, you will return to the language data table and will see an entry that corresponds to your language data set.</span></span> <span data-ttu-id="c8005-156">Notice that it has been assigned a unique id (GUID).</span><span class="sxs-lookup"><span data-stu-id="c8005-156">Notice that it has been assigned a unique id (GUID).</span></span> <span data-ttu-id="c8005-157">The data will also have a status that reflects its current state.</span><span class="sxs-lookup"><span data-stu-id="c8005-157">The data will also have a status that reflects its current state.</span></span> <span data-ttu-id="c8005-158">Its status will be “Waiting” while it is being queued for processing, “Processing” while it is going through validation, and “Complete” when the data is ready for use.</span><span class="sxs-lookup"><span data-stu-id="c8005-158">Its status will be “Waiting” while it is being queued for processing, “Processing” while it is going through validation, and “Complete” when the data is ready for use.</span></span> <span data-ttu-id="c8005-159">Data validation performs a series of checks on the text in the file and some text normalization of the data.</span><span class="sxs-lookup"><span data-stu-id="c8005-159">Data validation performs a series of checks on the text in the file and some text normalization of the data.</span></span>

<span data-ttu-id="c8005-160">When the status is “Complete”, you can click “View Report” to see the language data verification report.</span><span class="sxs-lookup"><span data-stu-id="c8005-160">When the status is “Complete”, you can click “View Report” to see the language data verification report.</span></span> <span data-ttu-id="c8005-161">The number of utterances that passed and failed verification are shown, along with details about the failed utterances.</span><span class="sxs-lookup"><span data-stu-id="c8005-161">The number of utterances that passed and failed verification are shown, along with details about the failed utterances.</span></span> <span data-ttu-id="c8005-162">In the example below, two examples failed verification because of improper characters (in this data set, the first line had two TAB characters the second had several characters outside of the ASCII printable character set, while the third line was blank).</span><span class="sxs-lookup"><span data-stu-id="c8005-162">In the example below, two examples failed verification because of improper characters (in this data set, the first line had two TAB characters the second had several characters outside of the ASCII printable character set, while the third line was blank).</span></span>

![try](media/stt/speech-language-datasets-report.png)

<span data-ttu-id="c8005-164">When the status of the language data set is “Complete”, it can be used to create a custom language model.</span><span class="sxs-lookup"><span data-stu-id="c8005-164">When the status of the language data set is “Complete”, it can be used to create a custom language model.</span></span>

![try](media/stt/speech-language-datasets.png)

## <a name="create-a-custom-language-model"></a><span data-ttu-id="c8005-166">Create a custom language model</span><span class="sxs-lookup"><span data-stu-id="c8005-166">Create a custom language model</span></span>

<span data-ttu-id="c8005-167">Once your language data is ready, click “Language Models” from the “Menu” drop-down menu to start the process of custom language model creation.</span><span class="sxs-lookup"><span data-stu-id="c8005-167">Once your language data is ready, click “Language Models” from the “Menu” drop-down menu to start the process of custom language model creation.</span></span> <span data-ttu-id="c8005-168">This page contains a table called “Language Models” with your current custom language models.</span><span class="sxs-lookup"><span data-stu-id="c8005-168">This page contains a table called “Language Models” with your current custom language models.</span></span> <span data-ttu-id="c8005-169">If you have not yet created any custom language models, the table will be empty.</span><span class="sxs-lookup"><span data-stu-id="c8005-169">If you have not yet created any custom language models, the table will be empty.</span></span> <span data-ttu-id="c8005-170">The current locale is shown in the table next to the relevant data entry.</span><span class="sxs-lookup"><span data-stu-id="c8005-170">The current locale is shown in the table next to the relevant data entry.</span></span>

<span data-ttu-id="c8005-171">The appropriate locale must be selected before taking any action.</span><span class="sxs-lookup"><span data-stu-id="c8005-171">The appropriate locale must be selected before taking any action.</span></span> <span data-ttu-id="c8005-172">The current locale is indicated in the table title on all data, model, and deployment pages.</span><span class="sxs-lookup"><span data-stu-id="c8005-172">The current locale is indicated in the table title on all data, model, and deployment pages.</span></span> <span data-ttu-id="c8005-173">To change the locale, click the “Change Locale” button located under the table’s title which will take you to a locale confirmation page.</span><span class="sxs-lookup"><span data-stu-id="c8005-173">To change the locale, click the “Change Locale” button located under the table’s title which will take you to a locale confirmation page.</span></span> <span data-ttu-id="c8005-174">Click “OK” to return to the table.</span><span class="sxs-lookup"><span data-stu-id="c8005-174">Click “OK” to return to the table.</span></span>

<span data-ttu-id="c8005-175">On the "Create Language Model" page, enter a "Name" and "Description" to help you keep track of pertinent information about this model, such as the data set used.</span><span class="sxs-lookup"><span data-stu-id="c8005-175">On the "Create Language Model" page, enter a "Name" and "Description" to help you keep track of pertinent information about this model, such as the data set used.</span></span> <span data-ttu-id="c8005-176">Next, select the “Base Language Model” from the drop-down menu.</span><span class="sxs-lookup"><span data-stu-id="c8005-176">Next, select the “Base Language Model” from the drop-down menu.</span></span> <span data-ttu-id="c8005-177">This model will be the starting point for your customization.</span><span class="sxs-lookup"><span data-stu-id="c8005-177">This model will be the starting point for your customization.</span></span> <span data-ttu-id="c8005-178">There are two base language models to choose from.</span><span class="sxs-lookup"><span data-stu-id="c8005-178">There are two base language models to choose from.</span></span> <span data-ttu-id="c8005-179">The Search and Dictation model is appropriate for speech directed at an application, such as commands, search queries, or dictation.</span><span class="sxs-lookup"><span data-stu-id="c8005-179">The Search and Dictation model is appropriate for speech directed at an application, such as commands, search queries, or dictation.</span></span> <span data-ttu-id="c8005-180">The Conversational model is appropriate for recognizing speech spoken in a conversational style.</span><span class="sxs-lookup"><span data-stu-id="c8005-180">The Conversational model is appropriate for recognizing speech spoken in a conversational style.</span></span> <span data-ttu-id="c8005-181">This type of speech is typically directed at another person and occurs in call centers or meetings.</span><span class="sxs-lookup"><span data-stu-id="c8005-181">This type of speech is typically directed at another person and occurs in call centers or meetings.</span></span> <span data-ttu-id="c8005-182">A new model called "Universal" is also publicly availabe.</span><span class="sxs-lookup"><span data-stu-id="c8005-182">A new model called "Universal" is also publicly availabe.</span></span> <span data-ttu-id="c8005-183">Universal aims to tackle all scenario and eventually replace the Search and Dictation and the Conversational models.</span><span class="sxs-lookup"><span data-stu-id="c8005-183">Universal aims to tackle all scenario and eventually replace the Search and Dictation and the Conversational models.</span></span>

5.  <span data-ttu-id="c8005-184">In the example below After you have specified the base language model, select the language data set you wish to use for the customization using the “Language Data” drop-down menu</span><span class="sxs-lookup"><span data-stu-id="c8005-184">In the example below After you have specified the base language model, select the language data set you wish to use for the customization using the “Language Data” drop-down menu</span></span>

![try](media/stt/speech-language-models-create2.png)

<span data-ttu-id="c8005-186">As with the acoustic model creation, you can optionally choose to perform offline testing of your new model when the processing is complete.</span><span class="sxs-lookup"><span data-stu-id="c8005-186">As with the acoustic model creation, you can optionally choose to perform offline testing of your new model when the processing is complete.</span></span> <span data-ttu-id="c8005-187">Model evaluations require an acoustic data set.</span><span class="sxs-lookup"><span data-stu-id="c8005-187">Model evaluations require an acoustic data set.</span></span>

<span data-ttu-id="c8005-188">To perform offline testing of your language model, select the check box next to “Offline Testing”.</span><span class="sxs-lookup"><span data-stu-id="c8005-188">To perform offline testing of your language model, select the check box next to “Offline Testing”.</span></span> <span data-ttu-id="c8005-189">Then select an acoustic model from the drop-down menu.</span><span class="sxs-lookup"><span data-stu-id="c8005-189">Then select an acoustic model from the drop-down menu.</span></span> <span data-ttu-id="c8005-190">If you have not created any custom acoustic models, the Microsoft base acoustic models will be the only model in the menu.</span><span class="sxs-lookup"><span data-stu-id="c8005-190">If you have not created any custom acoustic models, the Microsoft base acoustic models will be the only model in the menu.</span></span> <span data-ttu-id="c8005-191">In case you have picked a conversational LM base model, you need to use a conversational AM here.</span><span class="sxs-lookup"><span data-stu-id="c8005-191">In case you have picked a conversational LM base model, you need to use a conversational AM here.</span></span> <span data-ttu-id="c8005-192">In case you use a search and dictate LM model, you have to select a search and dictate AM model.</span><span class="sxs-lookup"><span data-stu-id="c8005-192">In case you use a search and dictate LM model, you have to select a search and dictate AM model.</span></span>

<span data-ttu-id="c8005-193">Finally, select the acoustic data set you would like to use to perform the evaluation.</span><span class="sxs-lookup"><span data-stu-id="c8005-193">Finally, select the acoustic data set you would like to use to perform the evaluation.</span></span>

<span data-ttu-id="c8005-194">When you are ready to start processing, press “Create” which will take you to the table of language models.</span><span class="sxs-lookup"><span data-stu-id="c8005-194">When you are ready to start processing, press “Create” which will take you to the table of language models.</span></span> <span data-ttu-id="c8005-195">There will be a new entry in the table corresponding to this model.</span><span class="sxs-lookup"><span data-stu-id="c8005-195">There will be a new entry in the table corresponding to this model.</span></span> <span data-ttu-id="c8005-196">The status reflects the model’s state and will go through several states including “Waiting”, “Processing”, and “Complete”.</span><span class="sxs-lookup"><span data-stu-id="c8005-196">The status reflects the model’s state and will go through several states including “Waiting”, “Processing”, and “Complete”.</span></span>

<span data-ttu-id="c8005-197">When the model has reached the “Complete” state, it can be deployed to an endpoint.</span><span class="sxs-lookup"><span data-stu-id="c8005-197">When the model has reached the “Complete” state, it can be deployed to an endpoint.</span></span> <span data-ttu-id="c8005-198">Clicking on “View Result” will show the results of offline testing, if performed.</span><span class="sxs-lookup"><span data-stu-id="c8005-198">Clicking on “View Result” will show the results of offline testing, if performed.</span></span>

<span data-ttu-id="c8005-199">If you would like to change the "Name" or "Description" of the model at some point, you can use the “Edit” link in the appropriate row of the language models table.</span><span class="sxs-lookup"><span data-stu-id="c8005-199">If you would like to change the "Name" or "Description" of the model at some point, you can use the “Edit” link in the appropriate row of the language models table.</span></span>

## <a name="next-steps"></a><span data-ttu-id="c8005-200">Next steps</span><span class="sxs-lookup"><span data-stu-id="c8005-200">Next steps</span></span>

- [<span data-ttu-id="c8005-201">Get your Speech trial subscription</span><span class="sxs-lookup"><span data-stu-id="c8005-201">Get your Speech trial subscription</span></span>](https://azure.microsoft.com/try/cognitive-services/)
- [<span data-ttu-id="c8005-202">How to recognize speech in C#</span><span class="sxs-lookup"><span data-stu-id="c8005-202">How to recognize speech in C#</span></span>](quickstart-csharp-dotnet-windows.md)
- [<span data-ttu-id="c8005-203">Git Sample Data</span><span class="sxs-lookup"><span data-stu-id="c8005-203">Git Sample Data</span></span>](https://github.com/Microsoft/Cognitive-Custom-Speech-Service)
