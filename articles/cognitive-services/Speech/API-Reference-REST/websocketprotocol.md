---
title: Microsoft speech recognition WebSocket protocol | Microsoft Docs
description: Protocol documentation for Speech Service based on WebSockets
services: cognitive-services
author: zhouwangzw
manager: wolfma
ms.service: cognitive-services
ms.component: bing-speech
ms.topic: article
ms.date: 09/15/2017
ms.author: zhouwang
ms.openlocfilehash: 17954536e8bdb49c09204c2e522586b79cb1bef5
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44868933"
---
# <a name="speech-service-websocket-protocol"></a><span data-ttu-id="5ee98-103">Speech Service WebSocket protocol</span><span class="sxs-lookup"><span data-stu-id="5ee98-103">Speech Service WebSocket protocol</span></span>

  <span data-ttu-id="5ee98-104">Speech Service is a cloud-based platform that features the most advanced algorithms available for converting spoken audio to text.</span><span class="sxs-lookup"><span data-stu-id="5ee98-104">Speech Service is a cloud-based platform that features the most advanced algorithms available for converting spoken audio to text.</span></span> <span data-ttu-id="5ee98-105">The Speech Service protocol defines the [connection setup](#connection-establishment) between client applications and the service and the speech recognition messages exchanged between counterparts ([client-originated Messages](#client-originated-messages) and [service-originated messages](#service-originated-messages)).</span><span class="sxs-lookup"><span data-stu-id="5ee98-105">The Speech Service protocol defines the [connection setup](#connection-establishment) between client applications and the service and the speech recognition messages exchanged between counterparts ([client-originated Messages](#client-originated-messages) and [service-originated messages](#service-originated-messages)).</span></span> <span data-ttu-id="5ee98-106">In addition, [telemetry messages](#telemetry-schema) and [error handling](#error-handling) are described.</span><span class="sxs-lookup"><span data-stu-id="5ee98-106">In addition, [telemetry messages](#telemetry-schema) and [error handling](#error-handling) are described.</span></span>

## <a name="connection-establishment"></a><span data-ttu-id="5ee98-107">Connection establishment</span><span class="sxs-lookup"><span data-stu-id="5ee98-107">Connection establishment</span></span>

<span data-ttu-id="5ee98-108">The Speech Service protocol follows the WebSocket standard specification [IETF RFC 6455](https://tools.ietf.org/html/rfc6455).</span><span class="sxs-lookup"><span data-stu-id="5ee98-108">The Speech Service protocol follows the WebSocket standard specification [IETF RFC 6455](https://tools.ietf.org/html/rfc6455).</span></span> <span data-ttu-id="5ee98-109">A WebSocket connection starts out as an HTTP request that contains HTTP headers that indicate the client's desire to upgrade the connection to a WebSocket instead of using HTTP semantics.</span><span class="sxs-lookup"><span data-stu-id="5ee98-109">A WebSocket connection starts out as an HTTP request that contains HTTP headers that indicate the client's desire to upgrade the connection to a WebSocket instead of using HTTP semantics.</span></span> <span data-ttu-id="5ee98-110">The server indicates its willingness to participate in the WebSocket connection by returning an HTTP `101 Switching Protocols` response.</span><span class="sxs-lookup"><span data-stu-id="5ee98-110">The server indicates its willingness to participate in the WebSocket connection by returning an HTTP `101 Switching Protocols` response.</span></span> <span data-ttu-id="5ee98-111">After the exchange of this handshake, both client and service keep the socket open and begin using a message-based protocol to send and receive information.</span><span class="sxs-lookup"><span data-stu-id="5ee98-111">After the exchange of this handshake, both client and service keep the socket open and begin using a message-based protocol to send and receive information.</span></span>

<span data-ttu-id="5ee98-112">To begin the WebSocket handshake, the client application sends an HTTPS GET request to the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-112">To begin the WebSocket handshake, the client application sends an HTTPS GET request to the service.</span></span> <span data-ttu-id="5ee98-113">It includes standard WebSocket upgrade headers along with other headers that are specific to speech.</span><span class="sxs-lookup"><span data-stu-id="5ee98-113">It includes standard WebSocket upgrade headers along with other headers that are specific to speech.</span></span>

```HTTP
GET /speech/recognition/interactive/cognitiveservices/v1 HTTP/1.1
Host: speech.platform.bing.com
Upgrade: websocket
Connection: Upgrade
Sec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==
Sec-WebSocket-Version: 13
Authorization: t=EwCIAgALBAAUWkziSCJKS1VkhugDegv7L0eAAJqBYKKTzpPZOeGk7RfZmdBhYY28jl&p=
X-ConnectionId: A140CAF92F71469FA41C72C7B5849253
Origin: https://speech.platform.bing.com
```

<span data-ttu-id="5ee98-114">The service responds with:</span><span class="sxs-lookup"><span data-stu-id="5ee98-114">The service responds with:</span></span>

```HTTP
HTTP/1.1 101 Switching Protocols
Upgrade: websocket
Connection: upgrade
Sec-WebSocket-Key: 2PTTXbeeBXlrrUNsY15n01d/Pcc=
Set-Cookie: SpeechServiceToken=AAAAABAAWTC8ncb8COL; expires=Wed, 17 Aug 2016 15:39:06 GMT; domain=bing.com; path="/"
Date: Wed, 17 Aug 2016 15:03:52 GMT
```

<span data-ttu-id="5ee98-115">All speech requests require the [TLS](https://en.wikipedia.org/wiki/Transport_Layer_Security) encryption.</span><span class="sxs-lookup"><span data-stu-id="5ee98-115">All speech requests require the [TLS](https://en.wikipedia.org/wiki/Transport_Layer_Security) encryption.</span></span> <span data-ttu-id="5ee98-116">The use of unencrypted speech requests is not supported.</span><span class="sxs-lookup"><span data-stu-id="5ee98-116">The use of unencrypted speech requests is not supported.</span></span> <span data-ttu-id="5ee98-117">The following TLS version is supported:</span><span class="sxs-lookup"><span data-stu-id="5ee98-117">The following TLS version is supported:</span></span>

* <span data-ttu-id="5ee98-118">TLS 1.2</span><span class="sxs-lookup"><span data-stu-id="5ee98-118">TLS 1.2</span></span>

### <a name="connection-identifier"></a><span data-ttu-id="5ee98-119">Connection identifier</span><span class="sxs-lookup"><span data-stu-id="5ee98-119">Connection identifier</span></span>

<span data-ttu-id="5ee98-120">Speech Service requires that all clients include a unique ID to identify the connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-120">Speech Service requires that all clients include a unique ID to identify the connection.</span></span> <span data-ttu-id="5ee98-121">Clients *must* include the *X-ConnectionId* header when they start a WebSocket handshake.</span><span class="sxs-lookup"><span data-stu-id="5ee98-121">Clients *must* include the *X-ConnectionId* header when they start a WebSocket handshake.</span></span> <span data-ttu-id="5ee98-122">The *X-ConnectionId* header must be a [universally unique identifier](https://en.wikipedia.org/wiki/Universally_unique_identifier) (UUID) value.</span><span class="sxs-lookup"><span data-stu-id="5ee98-122">The *X-ConnectionId* header must be a [universally unique identifier](https://en.wikipedia.org/wiki/Universally_unique_identifier) (UUID) value.</span></span> <span data-ttu-id="5ee98-123">WebSocket upgrade requests that do not include the *X-ConnectionId*, do not specify a value for the *X-ConnectionId* header, or do not include a valid UUID value are rejected by the service with an HTTP `400 Bad Request` response.</span><span class="sxs-lookup"><span data-stu-id="5ee98-123">WebSocket upgrade requests that do not include the *X-ConnectionId*, do not specify a value for the *X-ConnectionId* header, or do not include a valid UUID value are rejected by the service with an HTTP `400 Bad Request` response.</span></span>

### <a name="authorization"></a><span data-ttu-id="5ee98-124">Authorization</span><span class="sxs-lookup"><span data-stu-id="5ee98-124">Authorization</span></span>

<span data-ttu-id="5ee98-125">In addition to the standard WebSocket handshake headers, speech requests require an *Authorization* header.</span><span class="sxs-lookup"><span data-stu-id="5ee98-125">In addition to the standard WebSocket handshake headers, speech requests require an *Authorization* header.</span></span> <span data-ttu-id="5ee98-126">Connection requests without this header are rejected by the service with an HTTP `403 Forbidden` response.</span><span class="sxs-lookup"><span data-stu-id="5ee98-126">Connection requests without this header are rejected by the service with an HTTP `403 Forbidden` response.</span></span>

<span data-ttu-id="5ee98-127">The *Authorization* header must contain a JSON Web Token (JWT) access token.</span><span class="sxs-lookup"><span data-stu-id="5ee98-127">The *Authorization* header must contain a JSON Web Token (JWT) access token.</span></span>

<span data-ttu-id="5ee98-128">For information about how to subscribe and obtain API keys that are used to retrieve valid JWT access tokens, see the [Cognitive Services subscription](https://azure.microsoft.com/try/cognitive-services/) page.</span><span class="sxs-lookup"><span data-stu-id="5ee98-128">For information about how to subscribe and obtain API keys that are used to retrieve valid JWT access tokens, see the [Cognitive Services subscription](https://azure.microsoft.com/try/cognitive-services/) page.</span></span>

<span data-ttu-id="5ee98-129">The API key is passed to the token service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-129">The API key is passed to the token service.</span></span> <span data-ttu-id="5ee98-130">For example:</span><span class="sxs-lookup"><span data-stu-id="5ee98-130">For example:</span></span>

``` HTTP
POST https://api.cognitive.microsoft.com/sts/v1.0/issueToken
Content-Length: 0
```

<span data-ttu-id="5ee98-131">The following header information is required for token access.</span><span class="sxs-lookup"><span data-stu-id="5ee98-131">The following header information is required for token access.</span></span>

| <span data-ttu-id="5ee98-132">Name</span><span class="sxs-lookup"><span data-stu-id="5ee98-132">Name</span></span> | <span data-ttu-id="5ee98-133">Format</span><span class="sxs-lookup"><span data-stu-id="5ee98-133">Format</span></span> | <span data-ttu-id="5ee98-134">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-134">Description</span></span> |
|----|----|----|
| <span data-ttu-id="5ee98-135">Ocp-Apim-Subscription-Key</span><span class="sxs-lookup"><span data-stu-id="5ee98-135">Ocp-Apim-Subscription-Key</span></span> | <span data-ttu-id="5ee98-136">ASCII</span><span class="sxs-lookup"><span data-stu-id="5ee98-136">ASCII</span></span> | <span data-ttu-id="5ee98-137">Your subscription key</span><span class="sxs-lookup"><span data-stu-id="5ee98-137">Your subscription key</span></span> |

<span data-ttu-id="5ee98-138">The token service returns the JWT access token as `text/plain`.</span><span class="sxs-lookup"><span data-stu-id="5ee98-138">The token service returns the JWT access token as `text/plain`.</span></span> <span data-ttu-id="5ee98-139">Then the JWT is passed as a `Base64 access_token` to the handshake as an *Authorization* header prefixed with the string `Bearer`.</span><span class="sxs-lookup"><span data-stu-id="5ee98-139">Then the JWT is passed as a `Base64 access_token` to the handshake as an *Authorization* header prefixed with the string `Bearer`.</span></span> <span data-ttu-id="5ee98-140">For example:</span><span class="sxs-lookup"><span data-stu-id="5ee98-140">For example:</span></span>

`Authorization: Bearer [Base64 access_token]`

### <a name="cookies"></a><span data-ttu-id="5ee98-141">Cookies</span><span class="sxs-lookup"><span data-stu-id="5ee98-141">Cookies</span></span>

<span data-ttu-id="5ee98-142">Clients *must* support HTTP cookies as specified in [RFC 6265](https://tools.ietf.org/html/rfc6265).</span><span class="sxs-lookup"><span data-stu-id="5ee98-142">Clients *must* support HTTP cookies as specified in [RFC 6265](https://tools.ietf.org/html/rfc6265).</span></span>

### <a name="http-redirection"></a><span data-ttu-id="5ee98-143">HTTP redirection</span><span class="sxs-lookup"><span data-stu-id="5ee98-143">HTTP redirection</span></span>

<span data-ttu-id="5ee98-144">Clients *must* support the standard redirection mechanisms specified by the [HTTP protocol specification](http://www.w3.org/Protocols/rfc2616/rfc2616.html).</span><span class="sxs-lookup"><span data-stu-id="5ee98-144">Clients *must* support the standard redirection mechanisms specified by the [HTTP protocol specification](http://www.w3.org/Protocols/rfc2616/rfc2616.html).</span></span>

### <a name="speech-endpoints"></a><span data-ttu-id="5ee98-145">Speech endpoints</span><span class="sxs-lookup"><span data-stu-id="5ee98-145">Speech endpoints</span></span>

<span data-ttu-id="5ee98-146">Clients *must* use an appropriate endpoint of Speech Service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-146">Clients *must* use an appropriate endpoint of Speech Service.</span></span> <span data-ttu-id="5ee98-147">The endpoint is based on recognition mode and language.</span><span class="sxs-lookup"><span data-stu-id="5ee98-147">The endpoint is based on recognition mode and language.</span></span> <span data-ttu-id="5ee98-148">The table shows some examples.</span><span class="sxs-lookup"><span data-stu-id="5ee98-148">The table shows some examples.</span></span>

| <span data-ttu-id="5ee98-149">Mode</span><span class="sxs-lookup"><span data-stu-id="5ee98-149">Mode</span></span> | <span data-ttu-id="5ee98-150">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-150">Path</span></span> | <span data-ttu-id="5ee98-151">Service URI</span><span class="sxs-lookup"><span data-stu-id="5ee98-151">Service URI</span></span> |
| -----|-----|-----|
| <span data-ttu-id="5ee98-152">Interactive</span><span class="sxs-lookup"><span data-stu-id="5ee98-152">Interactive</span></span> | <span data-ttu-id="5ee98-153">/speech/recognition/interactive/cognitiveservices/v1</span><span class="sxs-lookup"><span data-stu-id="5ee98-153">/speech/recognition/interactive/cognitiveservices/v1</span></span> |https://speech.platform.bing.com/speech/recognition/interactive/cognitiveservices/v1?language=pt-BR |
| <span data-ttu-id="5ee98-154">Conversation</span><span class="sxs-lookup"><span data-stu-id="5ee98-154">Conversation</span></span> | <span data-ttu-id="5ee98-155">/speech/recognition/conversation/cognitiveservices/v1</span><span class="sxs-lookup"><span data-stu-id="5ee98-155">/speech/recognition/conversation/cognitiveservices/v1</span></span> |https://speech.platform.bing.com/speech/recognition/conversation/cognitiveservices/v1?language=en-US |
| <span data-ttu-id="5ee98-156">Dictation</span><span class="sxs-lookup"><span data-stu-id="5ee98-156">Dictation</span></span> | <span data-ttu-id="5ee98-157">/speech/recognition/dictation/cognitiveservices/v1</span><span class="sxs-lookup"><span data-stu-id="5ee98-157">/speech/recognition/dictation/cognitiveservices/v1</span></span> |https://speech.platform.bing.com/speech/recognition/dictation/cognitiveservices/v1?language=fr-FR |

<span data-ttu-id="5ee98-158">For more information, see the [Service URI](../GetStarted/GetStartedREST.md#service-uri) page.</span><span class="sxs-lookup"><span data-stu-id="5ee98-158">For more information, see the [Service URI](../GetStarted/GetStartedREST.md#service-uri) page.</span></span>

### <a name="report-connection-problems"></a><span data-ttu-id="5ee98-159">Report connection problems</span><span class="sxs-lookup"><span data-stu-id="5ee98-159">Report connection problems</span></span>

<span data-ttu-id="5ee98-160">Clients should immediately report all problems encountered while making a connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-160">Clients should immediately report all problems encountered while making a connection.</span></span> <span data-ttu-id="5ee98-161">The message protocol for reporting failed connections is described in [Connection failure telemetry](#connection-failure-telemetry).</span><span class="sxs-lookup"><span data-stu-id="5ee98-161">The message protocol for reporting failed connections is described in [Connection failure telemetry](#connection-failure-telemetry).</span></span>

### <a name="connection-duration-limitations"></a><span data-ttu-id="5ee98-162">Connection duration limitations</span><span class="sxs-lookup"><span data-stu-id="5ee98-162">Connection duration limitations</span></span>

<span data-ttu-id="5ee98-163">When compared with typical web service HTTP connections, WebSocket connections last a *long* time.</span><span class="sxs-lookup"><span data-stu-id="5ee98-163">When compared with typical web service HTTP connections, WebSocket connections last a *long* time.</span></span> <span data-ttu-id="5ee98-164">Speech Service places limitations on the duration of the WebSocket connections to the service:</span><span class="sxs-lookup"><span data-stu-id="5ee98-164">Speech Service places limitations on the duration of the WebSocket connections to the service:</span></span>

 * <span data-ttu-id="5ee98-165">The maximum duration for any active WebSocket connection is 10 minutes.</span><span class="sxs-lookup"><span data-stu-id="5ee98-165">The maximum duration for any active WebSocket connection is 10 minutes.</span></span> <span data-ttu-id="5ee98-166">A connection is active if either the service or the client sends WebSocket messages over that connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-166">A connection is active if either the service or the client sends WebSocket messages over that connection.</span></span> <span data-ttu-id="5ee98-167">The service terminates the connection without warning when the limit is reached.</span><span class="sxs-lookup"><span data-stu-id="5ee98-167">The service terminates the connection without warning when the limit is reached.</span></span> <span data-ttu-id="5ee98-168">Clients should develop user scenarios that do not require the connection to remain active at or near the maximum connection lifetime.</span><span class="sxs-lookup"><span data-stu-id="5ee98-168">Clients should develop user scenarios that do not require the connection to remain active at or near the maximum connection lifetime.</span></span>

 * <span data-ttu-id="5ee98-169">The maximum duration for any inactive WebSocket connection is 180 seconds.</span><span class="sxs-lookup"><span data-stu-id="5ee98-169">The maximum duration for any inactive WebSocket connection is 180 seconds.</span></span> <span data-ttu-id="5ee98-170">A connection is inactive if neither the service nor the client sent a WebSocket message over the connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-170">A connection is inactive if neither the service nor the client sent a WebSocket message over the connection.</span></span> <span data-ttu-id="5ee98-171">After the maximum inactive lifetime is reached, the service terminates the inactive WebSocket connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-171">After the maximum inactive lifetime is reached, the service terminates the inactive WebSocket connection.</span></span>

## <a name="message-types"></a><span data-ttu-id="5ee98-172">Message types</span><span class="sxs-lookup"><span data-stu-id="5ee98-172">Message types</span></span>

<span data-ttu-id="5ee98-173">After a WebSocket connection is established between the client and the service, both the client and the service can send messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-173">After a WebSocket connection is established between the client and the service, both the client and the service can send messages.</span></span> <span data-ttu-id="5ee98-174">This section describes the format of these WebSocket messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-174">This section describes the format of these WebSocket messages.</span></span>

<span data-ttu-id="5ee98-175">[IETF RFC 6455](https://tools.ietf.org/html/rfc6455) specifies that WebSocket messages can transmit data by using either a text or a binary encoding.</span><span class="sxs-lookup"><span data-stu-id="5ee98-175">[IETF RFC 6455](https://tools.ietf.org/html/rfc6455) specifies that WebSocket messages can transmit data by using either a text or a binary encoding.</span></span> <span data-ttu-id="5ee98-176">The two encodings use different on-the-wire formats.</span><span class="sxs-lookup"><span data-stu-id="5ee98-176">The two encodings use different on-the-wire formats.</span></span> <span data-ttu-id="5ee98-177">Each format is optimized for efficient encoding, transmission, and decoding of the message payload.</span><span class="sxs-lookup"><span data-stu-id="5ee98-177">Each format is optimized for efficient encoding, transmission, and decoding of the message payload.</span></span>

### <a name="text-websocket-messages"></a><span data-ttu-id="5ee98-178">Text WebSocket messages</span><span class="sxs-lookup"><span data-stu-id="5ee98-178">Text WebSocket messages</span></span>

<span data-ttu-id="5ee98-179">Text WebSocket messages carry a payload of textual information that consists of a section of headers and a body separated by the familiar double-carriage-return newline pair used for HTTP messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-179">Text WebSocket messages carry a payload of textual information that consists of a section of headers and a body separated by the familiar double-carriage-return newline pair used for HTTP messages.</span></span> <span data-ttu-id="5ee98-180">And, like HTTP messages, text WebSocket messages specify headers in *name: value* format separated by a single-carriage-return newline pair.</span><span class="sxs-lookup"><span data-stu-id="5ee98-180">And, like HTTP messages, text WebSocket messages specify headers in *name: value* format separated by a single-carriage-return newline pair.</span></span> <span data-ttu-id="5ee98-181">Any text included in a text WebSocket message *must* use [UTF-8](https://tools.ietf.org/html/rfc3629) encoding.</span><span class="sxs-lookup"><span data-stu-id="5ee98-181">Any text included in a text WebSocket message *must* use [UTF-8](https://tools.ietf.org/html/rfc3629) encoding.</span></span>

<span data-ttu-id="5ee98-182">Text WebSocket messages must specify a message path in the header *Path*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-182">Text WebSocket messages must specify a message path in the header *Path*.</span></span> <span data-ttu-id="5ee98-183">The value of this header must be one of the speech protocol message types defined later in this document.</span><span class="sxs-lookup"><span data-stu-id="5ee98-183">The value of this header must be one of the speech protocol message types defined later in this document.</span></span>

### <a name="binary-websocket-messages"></a><span data-ttu-id="5ee98-184">Binary WebSocket messages</span><span class="sxs-lookup"><span data-stu-id="5ee98-184">Binary WebSocket messages</span></span>

<span data-ttu-id="5ee98-185">Binary WebSocket messages carry a binary payload.</span><span class="sxs-lookup"><span data-stu-id="5ee98-185">Binary WebSocket messages carry a binary payload.</span></span> <span data-ttu-id="5ee98-186">In the Speech Service protocol, audio is transmitted to and received from the service by using binary WebSocket messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-186">In the Speech Service protocol, audio is transmitted to and received from the service by using binary WebSocket messages.</span></span> <span data-ttu-id="5ee98-187">All other messages are text WebSocket messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-187">All other messages are text WebSocket messages.</span></span> 

<span data-ttu-id="5ee98-188">Like text WebSocket messages, binary WebSocket messages consist of a header and a body section.</span><span class="sxs-lookup"><span data-stu-id="5ee98-188">Like text WebSocket messages, binary WebSocket messages consist of a header and a body section.</span></span> <span data-ttu-id="5ee98-189">The first 2 bytes of the binary WebSocket message specify, in [big-endian](https://en.wikipedia.org/wiki/Endianness) order, the 16-bit integer size of the header section.</span><span class="sxs-lookup"><span data-stu-id="5ee98-189">The first 2 bytes of the binary WebSocket message specify, in [big-endian](https://en.wikipedia.org/wiki/Endianness) order, the 16-bit integer size of the header section.</span></span> <span data-ttu-id="5ee98-190">The minimum header section size is 0 bytes.</span><span class="sxs-lookup"><span data-stu-id="5ee98-190">The minimum header section size is 0 bytes.</span></span> <span data-ttu-id="5ee98-191">The maximum size is 8,192 bytes.</span><span class="sxs-lookup"><span data-stu-id="5ee98-191">The maximum size is 8,192 bytes.</span></span> <span data-ttu-id="5ee98-192">The text in the headers of binary WebSocket messages *must* use [US-ASCII](https://tools.ietf.org/html/rfc20) encoding.</span><span class="sxs-lookup"><span data-stu-id="5ee98-192">The text in the headers of binary WebSocket messages *must* use [US-ASCII](https://tools.ietf.org/html/rfc20) encoding.</span></span>

<span data-ttu-id="5ee98-193">Headers in a binary WebSocket message are encoded in the same format as in text WebSocket messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-193">Headers in a binary WebSocket message are encoded in the same format as in text WebSocket messages.</span></span> <span data-ttu-id="5ee98-194">The *name:value* format is separated by a single-carriage-return newline pair.</span><span class="sxs-lookup"><span data-stu-id="5ee98-194">The *name:value* format is separated by a single-carriage-return newline pair.</span></span> <span data-ttu-id="5ee98-195">Binary WebSocket messages must specify a message path in the header *Path*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-195">Binary WebSocket messages must specify a message path in the header *Path*.</span></span> <span data-ttu-id="5ee98-196">The value of this header must be one of the speech protocol message types defined later in this document.</span><span class="sxs-lookup"><span data-stu-id="5ee98-196">The value of this header must be one of the speech protocol message types defined later in this document.</span></span>

<span data-ttu-id="5ee98-197">Both text and binary WebSocket messages are used in the Speech Service protocol.</span><span class="sxs-lookup"><span data-stu-id="5ee98-197">Both text and binary WebSocket messages are used in the Speech Service protocol.</span></span> 

## <a name="client-originated-messages"></a><span data-ttu-id="5ee98-198">Client-originated messages</span><span class="sxs-lookup"><span data-stu-id="5ee98-198">Client-originated messages</span></span>

<span data-ttu-id="5ee98-199">After the connection is established, both the client and the service can start to send messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-199">After the connection is established, both the client and the service can start to send messages.</span></span> <span data-ttu-id="5ee98-200">This section describes the format and payload of messages that client applications send to Speech Service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-200">This section describes the format and payload of messages that client applications send to Speech Service.</span></span> <span data-ttu-id="5ee98-201">The section [Service-originated messages](#service-originated-messages) presents the messages that originate in Speech Service and are sent to the client applications.</span><span class="sxs-lookup"><span data-stu-id="5ee98-201">The section [Service-originated messages](#service-originated-messages) presents the messages that originate in Speech Service and are sent to the client applications.</span></span>

<span data-ttu-id="5ee98-202">The main messages sent by the client to the services are `speech.config`, `audio`, and `telemetry` messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-202">The main messages sent by the client to the services are `speech.config`, `audio`, and `telemetry` messages.</span></span> <span data-ttu-id="5ee98-203">Before we consider each message in detail, the common required message headers for all these messages are described.</span><span class="sxs-lookup"><span data-stu-id="5ee98-203">Before we consider each message in detail, the common required message headers for all these messages are described.</span></span>

### <a name="required-message-headers"></a><span data-ttu-id="5ee98-204">Required message headers</span><span class="sxs-lookup"><span data-stu-id="5ee98-204">Required message headers</span></span>

<span data-ttu-id="5ee98-205">The following headers are required for all client-originated messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-205">The following headers are required for all client-originated messages.</span></span>

| <span data-ttu-id="5ee98-206">Header</span><span class="sxs-lookup"><span data-stu-id="5ee98-206">Header</span></span> | <span data-ttu-id="5ee98-207">Value</span><span class="sxs-lookup"><span data-stu-id="5ee98-207">Value</span></span> |
|----|----|
| <span data-ttu-id="5ee98-208">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-208">Path</span></span> | <span data-ttu-id="5ee98-209">The message path as specified in this document</span><span class="sxs-lookup"><span data-stu-id="5ee98-209">The message path as specified in this document</span></span> |
| <span data-ttu-id="5ee98-210">X-RequestId</span><span class="sxs-lookup"><span data-stu-id="5ee98-210">X-RequestId</span></span> | <span data-ttu-id="5ee98-211">UUID in "no-dash" format</span><span class="sxs-lookup"><span data-stu-id="5ee98-211">UUID in "no-dash" format</span></span> |
| <span data-ttu-id="5ee98-212">X-Timestamp</span><span class="sxs-lookup"><span data-stu-id="5ee98-212">X-Timestamp</span></span> | <span data-ttu-id="5ee98-213">Client UTC clock time stamp in ISO 8601 format</span><span class="sxs-lookup"><span data-stu-id="5ee98-213">Client UTC clock time stamp in ISO 8601 format</span></span> |

#### <a name="x-requestid-header"></a><span data-ttu-id="5ee98-214">X-RequestId header</span><span class="sxs-lookup"><span data-stu-id="5ee98-214">X-RequestId header</span></span>

<span data-ttu-id="5ee98-215">Client-originated requests are uniquely identified by the *X-RequestId* message header.</span><span class="sxs-lookup"><span data-stu-id="5ee98-215">Client-originated requests are uniquely identified by the *X-RequestId* message header.</span></span> <span data-ttu-id="5ee98-216">This header is required for all client-originated messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-216">This header is required for all client-originated messages.</span></span> <span data-ttu-id="5ee98-217">The *X-RequestId* header value must be a UUID in "no-dash" form, for example, *123e4567e89b12d3a456426655440000*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-217">The *X-RequestId* header value must be a UUID in "no-dash" form, for example, *123e4567e89b12d3a456426655440000*.</span></span> <span data-ttu-id="5ee98-218">It *cannot* be in the canonical form *123e4567-e89b-12d3-a456-426655440000*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-218">It *cannot* be in the canonical form *123e4567-e89b-12d3-a456-426655440000*.</span></span> <span data-ttu-id="5ee98-219">Requests without an *X-RequestId* header or with a header value that uses the wrong format for UUIDs cause the service to terminate the WebSocket connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-219">Requests without an *X-RequestId* header or with a header value that uses the wrong format for UUIDs cause the service to terminate the WebSocket connection.</span></span>

#### <a name="x-timestamp-header"></a><span data-ttu-id="5ee98-220">X-Timestamp header</span><span class="sxs-lookup"><span data-stu-id="5ee98-220">X-Timestamp header</span></span>

<span data-ttu-id="5ee98-221">Each message sent to Speech Service by a client application *must* include an *X-Timestamp* header.</span><span class="sxs-lookup"><span data-stu-id="5ee98-221">Each message sent to Speech Service by a client application *must* include an *X-Timestamp* header.</span></span> <span data-ttu-id="5ee98-222">The value for this header is the time when the client sends the message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-222">The value for this header is the time when the client sends the message.</span></span> <span data-ttu-id="5ee98-223">Requests without an *X-Timestamp* header or with a header value that uses the wrong format cause the service to terminate the WebSocket connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-223">Requests without an *X-Timestamp* header or with a header value that uses the wrong format cause the service to terminate the WebSocket connection.</span></span>

<span data-ttu-id="5ee98-224">The *X-Timestamp* header value must be of the form 'yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffffffZ' where 'fffffff' is a fraction of a second.</span><span class="sxs-lookup"><span data-stu-id="5ee98-224">The *X-Timestamp* header value must be of the form 'yyyy'-'MM'-'dd'T'HH':'mm':'ss'.'fffffffZ' where 'fffffff' is a fraction of a second.</span></span> <span data-ttu-id="5ee98-225">For example, '12.5' means '12 + 5/10 seconds' and '12.526' means '12 plus 526/1000 seconds'.</span><span class="sxs-lookup"><span data-stu-id="5ee98-225">For example, '12.5' means '12 + 5/10 seconds' and '12.526' means '12 plus 526/1000 seconds'.</span></span> <span data-ttu-id="5ee98-226">This format complies with [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) and, unlike the standard HTTP *Date* header, it can provide millisecond resolution.</span><span class="sxs-lookup"><span data-stu-id="5ee98-226">This format complies with [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) and, unlike the standard HTTP *Date* header, it can provide millisecond resolution.</span></span> <span data-ttu-id="5ee98-227">Client applications might round time stamps to the nearest millisecond.</span><span class="sxs-lookup"><span data-stu-id="5ee98-227">Client applications might round time stamps to the nearest millisecond.</span></span> <span data-ttu-id="5ee98-228">Client applications need to ensure that the device clock accurately tracks time by using a [Network Time Protocol (NTP) server](https://en.wikipedia.org/wiki/Network_Time_Protocol).</span><span class="sxs-lookup"><span data-stu-id="5ee98-228">Client applications need to ensure that the device clock accurately tracks time by using a [Network Time Protocol (NTP) server](https://en.wikipedia.org/wiki/Network_Time_Protocol).</span></span>

### <a name="message-speechconfig"></a><span data-ttu-id="5ee98-229">Message `speech.config`</span><span class="sxs-lookup"><span data-stu-id="5ee98-229">Message `speech.config`</span></span>

<span data-ttu-id="5ee98-230">Speech Service needs to know the characteristics of your application to provide the best possible speech recognition.</span><span class="sxs-lookup"><span data-stu-id="5ee98-230">Speech Service needs to know the characteristics of your application to provide the best possible speech recognition.</span></span> <span data-ttu-id="5ee98-231">The required characteristics data includes information about the device and OS that powers your application.</span><span class="sxs-lookup"><span data-stu-id="5ee98-231">The required characteristics data includes information about the device and OS that powers your application.</span></span> <span data-ttu-id="5ee98-232">You supply this information in the `speech.config` message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-232">You supply this information in the `speech.config` message.</span></span>

<span data-ttu-id="5ee98-233">Clients *must* send a `speech.config` message immediately after they establish the connection to Speech Service and before they send any `audio` messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-233">Clients *must* send a `speech.config` message immediately after they establish the connection to Speech Service and before they send any `audio` messages.</span></span> <span data-ttu-id="5ee98-234">You need to send a `speech.config` message only once per connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-234">You need to send a `speech.config` message only once per connection.</span></span>

| <span data-ttu-id="5ee98-235">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-235">Field</span></span> | <span data-ttu-id="5ee98-236">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-236">Description</span></span> |
|----|----|
| <span data-ttu-id="5ee98-237">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-237">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-238">Text</span><span class="sxs-lookup"><span data-stu-id="5ee98-238">Text</span></span> |
| <span data-ttu-id="5ee98-239">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-239">Body</span></span> | <span data-ttu-id="5ee98-240">The payload as a JSON structure</span><span class="sxs-lookup"><span data-stu-id="5ee98-240">The payload as a JSON structure</span></span> |

#### <a name="required-message-headers"></a><span data-ttu-id="5ee98-241">Required message headers</span><span class="sxs-lookup"><span data-stu-id="5ee98-241">Required message headers</span></span>

| <span data-ttu-id="5ee98-242">Header name</span><span class="sxs-lookup"><span data-stu-id="5ee98-242">Header name</span></span> | <span data-ttu-id="5ee98-243">Value</span><span class="sxs-lookup"><span data-stu-id="5ee98-243">Value</span></span> |
|----|----|
| <span data-ttu-id="5ee98-244">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-244">Path</span></span> | `speech.config` |
| <span data-ttu-id="5ee98-245">X-Timestamp</span><span class="sxs-lookup"><span data-stu-id="5ee98-245">X-Timestamp</span></span> | <span data-ttu-id="5ee98-246">Client UTC clock time stamp in ISO 8601 format</span><span class="sxs-lookup"><span data-stu-id="5ee98-246">Client UTC clock time stamp in ISO 8601 format</span></span> |
| <span data-ttu-id="5ee98-247">Content-Type</span><span class="sxs-lookup"><span data-stu-id="5ee98-247">Content-Type</span></span> | <span data-ttu-id="5ee98-248">application/json; charset=utf-8</span><span class="sxs-lookup"><span data-stu-id="5ee98-248">application/json; charset=utf-8</span></span> |

<span data-ttu-id="5ee98-249">As with all client-originated messages in the Speech Service protocol, the `speech.config` message *must* include an *X-Timestamp* header that records the client UTC clock time when the message was sent to the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-249">As with all client-originated messages in the Speech Service protocol, the `speech.config` message *must* include an *X-Timestamp* header that records the client UTC clock time when the message was sent to the service.</span></span> <span data-ttu-id="5ee98-250">The `speech.config` message *does not* require an *X-RequestId* header because this message isn't associated with a particular speech request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-250">The `speech.config` message *does not* require an *X-RequestId* header because this message isn't associated with a particular speech request.</span></span>

#### <a name="message-payload"></a><span data-ttu-id="5ee98-251">Message payload</span><span class="sxs-lookup"><span data-stu-id="5ee98-251">Message payload</span></span>
<span data-ttu-id="5ee98-252">The payload of the `speech.config` message is a JSON structure that contains information about the application.</span><span class="sxs-lookup"><span data-stu-id="5ee98-252">The payload of the `speech.config` message is a JSON structure that contains information about the application.</span></span> <span data-ttu-id="5ee98-253">The following example shows this information.</span><span class="sxs-lookup"><span data-stu-id="5ee98-253">The following example shows this information.</span></span> <span data-ttu-id="5ee98-254">Client and device context information is included in the *context* element of the JSON structure.</span><span class="sxs-lookup"><span data-stu-id="5ee98-254">Client and device context information is included in the *context* element of the JSON structure.</span></span> 

```JSON
{
  "context": {
    "system": {
      "version": "2.0.12341",
    },
    "os": {
      "platform": "Linux",
      "name": "Debian",
      "version": "2.14324324"
    },
    "device": {
      "manufacturer": "Contoso",
      "model": "Fabrikan",
      "version": "7.341"
      }
    },
  }
}
```

##### <a name="system-element"></a><span data-ttu-id="5ee98-255">System element</span><span class="sxs-lookup"><span data-stu-id="5ee98-255">System element</span></span>

<span data-ttu-id="5ee98-256">The system.version element of the `speech.config` message contains the version of the speech SDK software used by the client application or device.</span><span class="sxs-lookup"><span data-stu-id="5ee98-256">The system.version element of the `speech.config` message contains the version of the speech SDK software used by the client application or device.</span></span> <span data-ttu-id="5ee98-257">The value is in the form *major.minor.build.branch*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-257">The value is in the form *major.minor.build.branch*.</span></span> <span data-ttu-id="5ee98-258">You can omit the *branch* component if it's not applicable.</span><span class="sxs-lookup"><span data-stu-id="5ee98-258">You can omit the *branch* component if it's not applicable.</span></span>

##### <a name="os-element"></a><span data-ttu-id="5ee98-259">OS element</span><span class="sxs-lookup"><span data-stu-id="5ee98-259">OS element</span></span>

| <span data-ttu-id="5ee98-260">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-260">Field</span></span> | <span data-ttu-id="5ee98-261">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-261">Description</span></span> | <span data-ttu-id="5ee98-262">Usage</span><span class="sxs-lookup"><span data-stu-id="5ee98-262">Usage</span></span> |
|-|-|-|
| <span data-ttu-id="5ee98-263">os.platform</span><span class="sxs-lookup"><span data-stu-id="5ee98-263">os.platform</span></span> | <span data-ttu-id="5ee98-264">The OS platform that hosts the application, for example, Windows, Android, iOS, or Linux</span><span class="sxs-lookup"><span data-stu-id="5ee98-264">The OS platform that hosts the application, for example, Windows, Android, iOS, or Linux</span></span> |<span data-ttu-id="5ee98-265">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-265">Required</span></span> |
| <span data-ttu-id="5ee98-266">os.name</span><span class="sxs-lookup"><span data-stu-id="5ee98-266">os.name</span></span> | <span data-ttu-id="5ee98-267">The OS product name, for example, Debian or Windows 10</span><span class="sxs-lookup"><span data-stu-id="5ee98-267">The OS product name, for example, Debian or Windows 10</span></span> | <span data-ttu-id="5ee98-268">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-268">Required</span></span> |
| <span data-ttu-id="5ee98-269">os.version</span><span class="sxs-lookup"><span data-stu-id="5ee98-269">os.version</span></span> | <span data-ttu-id="5ee98-270">The version of the OS in the form *major.minor.build.branch*</span><span class="sxs-lookup"><span data-stu-id="5ee98-270">The version of the OS in the form *major.minor.build.branch*</span></span> | <span data-ttu-id="5ee98-271">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-271">Required</span></span> |

##### <a name="device-element"></a><span data-ttu-id="5ee98-272">Device element</span><span class="sxs-lookup"><span data-stu-id="5ee98-272">Device element</span></span>

| <span data-ttu-id="5ee98-273">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-273">Field</span></span> | <span data-ttu-id="5ee98-274">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-274">Description</span></span> | <span data-ttu-id="5ee98-275">Usage</span><span class="sxs-lookup"><span data-stu-id="5ee98-275">Usage</span></span> |
|-|-|-|
| <span data-ttu-id="5ee98-276">device.manufacturer</span><span class="sxs-lookup"><span data-stu-id="5ee98-276">device.manufacturer</span></span> | <span data-ttu-id="5ee98-277">The device hardware manufacturer</span><span class="sxs-lookup"><span data-stu-id="5ee98-277">The device hardware manufacturer</span></span> | <span data-ttu-id="5ee98-278">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-278">Required</span></span> |
| <span data-ttu-id="5ee98-279">device.model</span><span class="sxs-lookup"><span data-stu-id="5ee98-279">device.model</span></span> | <span data-ttu-id="5ee98-280">The device model</span><span class="sxs-lookup"><span data-stu-id="5ee98-280">The device model</span></span> | <span data-ttu-id="5ee98-281">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-281">Required</span></span> |
| <span data-ttu-id="5ee98-282">device.version</span><span class="sxs-lookup"><span data-stu-id="5ee98-282">device.version</span></span> | <span data-ttu-id="5ee98-283">The device software version provided by the device manufacturer.</span><span class="sxs-lookup"><span data-stu-id="5ee98-283">The device software version provided by the device manufacturer.</span></span> <span data-ttu-id="5ee98-284">This value specifies a version of the device that can be tracked by the manufacturer.</span><span class="sxs-lookup"><span data-stu-id="5ee98-284">This value specifies a version of the device that can be tracked by the manufacturer.</span></span> | <span data-ttu-id="5ee98-285">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-285">Required</span></span> |

### <a name="message-audio"></a><span data-ttu-id="5ee98-286">Message `audio`</span><span class="sxs-lookup"><span data-stu-id="5ee98-286">Message `audio`</span></span>

<span data-ttu-id="5ee98-287">Speech-enabled client applications send audio to Speech Service by converting the audio stream into a series of audio chunks.</span><span class="sxs-lookup"><span data-stu-id="5ee98-287">Speech-enabled client applications send audio to Speech Service by converting the audio stream into a series of audio chunks.</span></span> <span data-ttu-id="5ee98-288">Each chunk of audio carries a segment of the spoken audio that's to be transcribed by the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-288">Each chunk of audio carries a segment of the spoken audio that's to be transcribed by the service.</span></span> <span data-ttu-id="5ee98-289">The maximum size of a single audio chunk is 8,192 bytes.</span><span class="sxs-lookup"><span data-stu-id="5ee98-289">The maximum size of a single audio chunk is 8,192 bytes.</span></span> <span data-ttu-id="5ee98-290">Audio stream messages are *Binary WebSocket messages*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-290">Audio stream messages are *Binary WebSocket messages*.</span></span>

<span data-ttu-id="5ee98-291">Clients use the `audio` message to send an audio chunk to the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-291">Clients use the `audio` message to send an audio chunk to the service.</span></span> <span data-ttu-id="5ee98-292">Clients read audio from the microphone in chunks and send these chunks to Speech Service for transcription.</span><span class="sxs-lookup"><span data-stu-id="5ee98-292">Clients read audio from the microphone in chunks and send these chunks to Speech Service for transcription.</span></span> <span data-ttu-id="5ee98-293">The first `audio` message must contain a well-formed header that properly specifies that the audio conforms to one of the encoding formats supported by the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-293">The first `audio` message must contain a well-formed header that properly specifies that the audio conforms to one of the encoding formats supported by the service.</span></span> <span data-ttu-id="5ee98-294">Additional `audio` messages contain only the binary audio stream data read from the microphone.</span><span class="sxs-lookup"><span data-stu-id="5ee98-294">Additional `audio` messages contain only the binary audio stream data read from the microphone.</span></span>

<span data-ttu-id="5ee98-295">Clients might optionally send an `audio` message with a zero-length body.</span><span class="sxs-lookup"><span data-stu-id="5ee98-295">Clients might optionally send an `audio` message with a zero-length body.</span></span> <span data-ttu-id="5ee98-296">This message tells the service that the client knows that the user stopped speaking, the utterance is finished, and the microphone is turned off.</span><span class="sxs-lookup"><span data-stu-id="5ee98-296">This message tells the service that the client knows that the user stopped speaking, the utterance is finished, and the microphone is turned off.</span></span>

<span data-ttu-id="5ee98-297">Speech Service uses the first `audio` message that contains a unique request identifier to signal the start of a new request/response cycle or *turn*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-297">Speech Service uses the first `audio` message that contains a unique request identifier to signal the start of a new request/response cycle or *turn*.</span></span> <span data-ttu-id="5ee98-298">After the service receives an `audio` message with a new request identifier, it discards any queued or unsent messages that are associated with any previous turn.</span><span class="sxs-lookup"><span data-stu-id="5ee98-298">After the service receives an `audio` message with a new request identifier, it discards any queued or unsent messages that are associated with any previous turn.</span></span>

| <span data-ttu-id="5ee98-299">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-299">Field</span></span> | <span data-ttu-id="5ee98-300">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-300">Description</span></span> |
|-------------|----------------|
| <span data-ttu-id="5ee98-301">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-301">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-302">Binary</span><span class="sxs-lookup"><span data-stu-id="5ee98-302">Binary</span></span> |
| <span data-ttu-id="5ee98-303">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-303">Body</span></span> | <span data-ttu-id="5ee98-304">The binary data for the audio chunk.</span><span class="sxs-lookup"><span data-stu-id="5ee98-304">The binary data for the audio chunk.</span></span> <span data-ttu-id="5ee98-305">Maximum size is 8,192 bytes.</span><span class="sxs-lookup"><span data-stu-id="5ee98-305">Maximum size is 8,192 bytes.</span></span> |

#### <a name="required-message-headers"></a><span data-ttu-id="5ee98-306">Required message headers</span><span class="sxs-lookup"><span data-stu-id="5ee98-306">Required message headers</span></span>

<span data-ttu-id="5ee98-307">The following headers are required for all `audio` messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-307">The following headers are required for all `audio` messages.</span></span>

| <span data-ttu-id="5ee98-308">Header</span><span class="sxs-lookup"><span data-stu-id="5ee98-308">Header</span></span>         |  <span data-ttu-id="5ee98-309">Value</span><span class="sxs-lookup"><span data-stu-id="5ee98-309">Value</span></span>     |
| ------------- | ---------------- |
| <span data-ttu-id="5ee98-310">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-310">Path</span></span> | `audio` |
| <span data-ttu-id="5ee98-311">X-RequestId</span><span class="sxs-lookup"><span data-stu-id="5ee98-311">X-RequestId</span></span> | <span data-ttu-id="5ee98-312">UUID in "no-dash" format</span><span class="sxs-lookup"><span data-stu-id="5ee98-312">UUID in "no-dash" format</span></span> |
| <span data-ttu-id="5ee98-313">X-Timestamp</span><span class="sxs-lookup"><span data-stu-id="5ee98-313">X-Timestamp</span></span> | <span data-ttu-id="5ee98-314">Client UTC clock time stamp in ISO 8601 format</span><span class="sxs-lookup"><span data-stu-id="5ee98-314">Client UTC clock time stamp in ISO 8601 format</span></span> |
| <span data-ttu-id="5ee98-315">Content-Type</span><span class="sxs-lookup"><span data-stu-id="5ee98-315">Content-Type</span></span> | <span data-ttu-id="5ee98-316">The audio content type.</span><span class="sxs-lookup"><span data-stu-id="5ee98-316">The audio content type.</span></span> <span data-ttu-id="5ee98-317">The type must be either *audio/x-wav* (PCM) or *audio/silk* (SILK).</span><span class="sxs-lookup"><span data-stu-id="5ee98-317">The type must be either *audio/x-wav* (PCM) or *audio/silk* (SILK).</span></span> |

#### <a name="supported-audio-encodings"></a><span data-ttu-id="5ee98-318">Supported audio encodings</span><span class="sxs-lookup"><span data-stu-id="5ee98-318">Supported audio encodings</span></span>

<span data-ttu-id="5ee98-319">This section describes the audio codecs supported by Speech Service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-319">This section describes the audio codecs supported by Speech Service.</span></span>

##### <a name="pcm"></a><span data-ttu-id="5ee98-320">PCM</span><span class="sxs-lookup"><span data-stu-id="5ee98-320">PCM</span></span>

<span data-ttu-id="5ee98-321">Speech Service accepts uncompressed pulse code modulation (PCM) audio.</span><span class="sxs-lookup"><span data-stu-id="5ee98-321">Speech Service accepts uncompressed pulse code modulation (PCM) audio.</span></span> <span data-ttu-id="5ee98-322">Audio is sent to the service in [WAV](https://en.wikipedia.org/wiki/WAV) format, so the first audio chunk *must* contain a valid [Resource Interchange File Format](https://en.wikipedia.org/wiki/Resource_Interchange_File_Format) (RIFF) header.</span><span class="sxs-lookup"><span data-stu-id="5ee98-322">Audio is sent to the service in [WAV](https://en.wikipedia.org/wiki/WAV) format, so the first audio chunk *must* contain a valid [Resource Interchange File Format](https://en.wikipedia.org/wiki/Resource_Interchange_File_Format) (RIFF) header.</span></span> <span data-ttu-id="5ee98-323">If a client initiates a turn with an audio chunk that does *not* include a valid RIFF header, the service rejects the request and terminates the WebSocket connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-323">If a client initiates a turn with an audio chunk that does *not* include a valid RIFF header, the service rejects the request and terminates the WebSocket connection.</span></span>

<span data-ttu-id="5ee98-324">PCM audio *must* be sampled at 16 kHz with 16 bits per sample and one channel (*riff-16khz-16bit-mono-pcm*).</span><span class="sxs-lookup"><span data-stu-id="5ee98-324">PCM audio *must* be sampled at 16 kHz with 16 bits per sample and one channel (*riff-16khz-16bit-mono-pcm*).</span></span> <span data-ttu-id="5ee98-325">Speech Service doesn't support stereo audio streams and rejects audio streams that do not use the specified bit rate, sample rate, or number of channels.</span><span class="sxs-lookup"><span data-stu-id="5ee98-325">Speech Service doesn't support stereo audio streams and rejects audio streams that do not use the specified bit rate, sample rate, or number of channels.</span></span>

##### <a name="opus"></a><span data-ttu-id="5ee98-326">Opus</span><span class="sxs-lookup"><span data-stu-id="5ee98-326">Opus</span></span>

<span data-ttu-id="5ee98-327">Opus is an open, royalty-free, highly versatile audio codec.</span><span class="sxs-lookup"><span data-stu-id="5ee98-327">Opus is an open, royalty-free, highly versatile audio codec.</span></span> <span data-ttu-id="5ee98-328">Speech Service supports Opus at a constant bit rate of `32000` or `16000`.</span><span class="sxs-lookup"><span data-stu-id="5ee98-328">Speech Service supports Opus at a constant bit rate of `32000` or `16000`.</span></span> <span data-ttu-id="5ee98-329">Only the `OGG` container for Opus is currently supported that is specified by the `audio/ogg` mime type.</span><span class="sxs-lookup"><span data-stu-id="5ee98-329">Only the `OGG` container for Opus is currently supported that is specified by the `audio/ogg` mime type.</span></span>

<span data-ttu-id="5ee98-330">To use Opus, modify the [JavaScript sample](https://github.com/Azure-Samples/SpeechToText-WebSockets-Javascript/blob/master/samples/browser/Sample.html#L101) and change the `RecognizerSetup` method to return.</span><span class="sxs-lookup"><span data-stu-id="5ee98-330">To use Opus, modify the [JavaScript sample](https://github.com/Azure-Samples/SpeechToText-WebSockets-Javascript/blob/master/samples/browser/Sample.html#L101) and change the `RecognizerSetup` method to return.</span></span>

```javascript
return SDK.CreateRecognizerWithCustomAudioSource(
            recognizerConfig,
            authentication,
            new SDK.MicAudioSource(
                     new SDK.OpusRecorder(
                     {
                         mimeType: "audio/ogg",
                         bitsPerSecond: 32000
                     }
              )
          ));
```

#### <a name="detect-end-of-speech"></a><span data-ttu-id="5ee98-331">Detect end of speech</span><span class="sxs-lookup"><span data-stu-id="5ee98-331">Detect end of speech</span></span>

<span data-ttu-id="5ee98-332">Humans do not explicitly signal when they're finished speaking.</span><span class="sxs-lookup"><span data-stu-id="5ee98-332">Humans do not explicitly signal when they're finished speaking.</span></span> <span data-ttu-id="5ee98-333">Any application that accepts speech as input has two choices for handling the end of speech in an audio stream: service end-of-speech detection and client end-of-speech detection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-333">Any application that accepts speech as input has two choices for handling the end of speech in an audio stream: service end-of-speech detection and client end-of-speech detection.</span></span> <span data-ttu-id="5ee98-334">Of these two choices, service end-of-speech detection usually provides a better user experience.</span><span class="sxs-lookup"><span data-stu-id="5ee98-334">Of these two choices, service end-of-speech detection usually provides a better user experience.</span></span>

##### <a name="service-end-of-speech-detection"></a><span data-ttu-id="5ee98-335">Service end-of-speech detection</span><span class="sxs-lookup"><span data-stu-id="5ee98-335">Service end-of-speech detection</span></span>

<span data-ttu-id="5ee98-336">To build the ideal hands-free speech experience, applications allow the service to detect when the user has finished speaking.</span><span class="sxs-lookup"><span data-stu-id="5ee98-336">To build the ideal hands-free speech experience, applications allow the service to detect when the user has finished speaking.</span></span> <span data-ttu-id="5ee98-337">Clients send audio from the microphone as *audio* chunks until the service detects silence and responds back with a `speech.endDetected` message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-337">Clients send audio from the microphone as *audio* chunks until the service detects silence and responds back with a `speech.endDetected` message.</span></span>

##### <a name="client-end-of-speech-detection"></a><span data-ttu-id="5ee98-338">Client end-of-speech detection</span><span class="sxs-lookup"><span data-stu-id="5ee98-338">Client end-of-speech detection</span></span>

<span data-ttu-id="5ee98-339">Client applications that allow the user to signal the end of speech in some way also can give the service that signal.</span><span class="sxs-lookup"><span data-stu-id="5ee98-339">Client applications that allow the user to signal the end of speech in some way also can give the service that signal.</span></span> <span data-ttu-id="5ee98-340">For example, a client application might have a "Stop" or "Mute" button that the user can press.</span><span class="sxs-lookup"><span data-stu-id="5ee98-340">For example, a client application might have a "Stop" or "Mute" button that the user can press.</span></span> <span data-ttu-id="5ee98-341">To signal end-of-speech, client applications send an *audio* chunk message with a zero-length body.</span><span class="sxs-lookup"><span data-stu-id="5ee98-341">To signal end-of-speech, client applications send an *audio* chunk message with a zero-length body.</span></span> <span data-ttu-id="5ee98-342">Speech Service interprets this message as the end of the incoming audio stream.</span><span class="sxs-lookup"><span data-stu-id="5ee98-342">Speech Service interprets this message as the end of the incoming audio stream.</span></span>

### <a name="message-telemetry"></a><span data-ttu-id="5ee98-343">Message `telemetry`</span><span class="sxs-lookup"><span data-stu-id="5ee98-343">Message `telemetry`</span></span>

<span data-ttu-id="5ee98-344">Client applications *must* acknowledge the end of each turn by sending telemetry about the turn to Speech Service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-344">Client applications *must* acknowledge the end of each turn by sending telemetry about the turn to Speech Service.</span></span> <span data-ttu-id="5ee98-345">Turn-end acknowledgment allows Speech Service to ensure that all messages necessary for completion of the request and its response were properly received by the client.</span><span class="sxs-lookup"><span data-stu-id="5ee98-345">Turn-end acknowledgment allows Speech Service to ensure that all messages necessary for completion of the request and its response were properly received by the client.</span></span> <span data-ttu-id="5ee98-346">Turn-end acknowledgment also allows Speech Service to verify that the client applications are performing as expected.</span><span class="sxs-lookup"><span data-stu-id="5ee98-346">Turn-end acknowledgment also allows Speech Service to verify that the client applications are performing as expected.</span></span> <span data-ttu-id="5ee98-347">This information is invaluable if you need help troubleshooting your speech-enabled application.</span><span class="sxs-lookup"><span data-stu-id="5ee98-347">This information is invaluable if you need help troubleshooting your speech-enabled application.</span></span>

<span data-ttu-id="5ee98-348">Clients must acknowledge the end of a turn by sending a `telemetry` message soon after receiving a `turn.end` message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-348">Clients must acknowledge the end of a turn by sending a `telemetry` message soon after receiving a `turn.end` message.</span></span> <span data-ttu-id="5ee98-349">Clients should attempt to acknowledge the `turn.end` as soon as possible.</span><span class="sxs-lookup"><span data-stu-id="5ee98-349">Clients should attempt to acknowledge the `turn.end` as soon as possible.</span></span> <span data-ttu-id="5ee98-350">If a client application fails to acknowledge the turn end, Speech Service might terminate the connection with an error.</span><span class="sxs-lookup"><span data-stu-id="5ee98-350">If a client application fails to acknowledge the turn end, Speech Service might terminate the connection with an error.</span></span> <span data-ttu-id="5ee98-351">Clients must send only one `telemetry` message for each request and response identified by the *X-RequestId* value.</span><span class="sxs-lookup"><span data-stu-id="5ee98-351">Clients must send only one `telemetry` message for each request and response identified by the *X-RequestId* value.</span></span>

| <span data-ttu-id="5ee98-352">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-352">Field</span></span> | <span data-ttu-id="5ee98-353">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-353">Description</span></span> |
| ------------- | ---------------- |
| <span data-ttu-id="5ee98-354">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-354">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-355">Text</span><span class="sxs-lookup"><span data-stu-id="5ee98-355">Text</span></span> |
| <span data-ttu-id="5ee98-356">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-356">Path</span></span> | `telemetry` |
| <span data-ttu-id="5ee98-357">X-Timestamp</span><span class="sxs-lookup"><span data-stu-id="5ee98-357">X-Timestamp</span></span> | <span data-ttu-id="5ee98-358">Client UTC clock time stamp in ISO 8601 format</span><span class="sxs-lookup"><span data-stu-id="5ee98-358">Client UTC clock time stamp in ISO 8601 format</span></span> |
| <span data-ttu-id="5ee98-359">Content-Type</span><span class="sxs-lookup"><span data-stu-id="5ee98-359">Content-Type</span></span> | `application/json` |
| <span data-ttu-id="5ee98-360">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-360">Body</span></span> | <span data-ttu-id="5ee98-361">A JSON structure that contains client information about the turn</span><span class="sxs-lookup"><span data-stu-id="5ee98-361">A JSON structure that contains client information about the turn</span></span> |

<span data-ttu-id="5ee98-362">The schema for the body of the `telemetry` message is defined in the [Telemetry schema](#telemetry-schema) section.</span><span class="sxs-lookup"><span data-stu-id="5ee98-362">The schema for the body of the `telemetry` message is defined in the [Telemetry schema](#telemetry-schema) section.</span></span>

#### <a name="telemetry-for-interrupted-connections"></a><span data-ttu-id="5ee98-363">Telemetry for interrupted connections</span><span class="sxs-lookup"><span data-stu-id="5ee98-363">Telemetry for interrupted connections</span></span>

<span data-ttu-id="5ee98-364">If the network connection fails for any reason during a turn and the client does *not* receive a `turn.end` message from the service, the client sends a `telemetry` message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-364">If the network connection fails for any reason during a turn and the client does *not* receive a `turn.end` message from the service, the client sends a `telemetry` message.</span></span> <span data-ttu-id="5ee98-365">This message describes the failed request the next time the client makes a connection to the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-365">This message describes the failed request the next time the client makes a connection to the service.</span></span> <span data-ttu-id="5ee98-366">Clients do not have to immediately attempt a connection to send the `telemetry` message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-366">Clients do not have to immediately attempt a connection to send the `telemetry` message.</span></span> <span data-ttu-id="5ee98-367">The message might be buffered on the client and sent over a future user-requested connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-367">The message might be buffered on the client and sent over a future user-requested connection.</span></span> <span data-ttu-id="5ee98-368">The `telemetry` message for the failed request *must* use the *X-RequestId* value from the failed request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-368">The `telemetry` message for the failed request *must* use the *X-RequestId* value from the failed request.</span></span> <span data-ttu-id="5ee98-369">It might be sent to the service as soon as a connection is established, without waiting to send or receive for other messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-369">It might be sent to the service as soon as a connection is established, without waiting to send or receive for other messages.</span></span>

## <a name="service-originated-messages"></a><span data-ttu-id="5ee98-370">Service-originated messages</span><span class="sxs-lookup"><span data-stu-id="5ee98-370">Service-originated messages</span></span>

<span data-ttu-id="5ee98-371">This section describes the messages that originate in Speech Service and are sent to the client.</span><span class="sxs-lookup"><span data-stu-id="5ee98-371">This section describes the messages that originate in Speech Service and are sent to the client.</span></span> <span data-ttu-id="5ee98-372">Speech Service maintains a registry of client capabilities and generates the messages required by each client, so not all clients receive all the messages that are described here.</span><span class="sxs-lookup"><span data-stu-id="5ee98-372">Speech Service maintains a registry of client capabilities and generates the messages required by each client, so not all clients receive all the messages that are described here.</span></span> <span data-ttu-id="5ee98-373">For brevity, messages are referenced by the value of the *Path* header.</span><span class="sxs-lookup"><span data-stu-id="5ee98-373">For brevity, messages are referenced by the value of the *Path* header.</span></span> <span data-ttu-id="5ee98-374">For example, we refer to a WebSocket text message with the *Path* value `speech.hypothesis` as a speech.hypothesis message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-374">For example, we refer to a WebSocket text message with the *Path* value `speech.hypothesis` as a speech.hypothesis message.</span></span>

### <a name="message-speechstartdetected"></a><span data-ttu-id="5ee98-375">Message `speech.startDetected`</span><span class="sxs-lookup"><span data-stu-id="5ee98-375">Message `speech.startDetected`</span></span>

<span data-ttu-id="5ee98-376">The `speech.startDetected` message indicates that Speech Service detected speech in the audio stream.</span><span class="sxs-lookup"><span data-stu-id="5ee98-376">The `speech.startDetected` message indicates that Speech Service detected speech in the audio stream.</span></span>

| <span data-ttu-id="5ee98-377">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-377">Field</span></span> | <span data-ttu-id="5ee98-378">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-378">Description</span></span> |
| ------------- | ---------------- |
| <span data-ttu-id="5ee98-379">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-379">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-380">Text</span><span class="sxs-lookup"><span data-stu-id="5ee98-380">Text</span></span> |
| <span data-ttu-id="5ee98-381">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-381">Path</span></span> | `speech.startDetected` |
| <span data-ttu-id="5ee98-382">Content-Type</span><span class="sxs-lookup"><span data-stu-id="5ee98-382">Content-Type</span></span> | <span data-ttu-id="5ee98-383">application/json; charset=utf-8</span><span class="sxs-lookup"><span data-stu-id="5ee98-383">application/json; charset=utf-8</span></span> |
| <span data-ttu-id="5ee98-384">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-384">Body</span></span> | <span data-ttu-id="5ee98-385">The JSON structure that contains information about the conditions when the start of speech was detected.</span><span class="sxs-lookup"><span data-stu-id="5ee98-385">The JSON structure that contains information about the conditions when the start of speech was detected.</span></span> <span data-ttu-id="5ee98-386">The *Offset* field in this structure specifies the offset (in 100-nanosecond units) when speech was detected in the audio stream, relative to the start of the stream.</span><span class="sxs-lookup"><span data-stu-id="5ee98-386">The *Offset* field in this structure specifies the offset (in 100-nanosecond units) when speech was detected in the audio stream, relative to the start of the stream.</span></span> |

#### <a name="sample-message"></a><span data-ttu-id="5ee98-387">Sample message</span><span class="sxs-lookup"><span data-stu-id="5ee98-387">Sample message</span></span>

```HTML
Path: speech.startDetected
Content-Type: application/json; charset=utf-8
X-RequestId: 123e4567e89b12d3a456426655440000

{
  "Offset": 100000
}
```

### <a name="message-speechhypothesis"></a><span data-ttu-id="5ee98-388">Message `speech.hypothesis`</span><span class="sxs-lookup"><span data-stu-id="5ee98-388">Message `speech.hypothesis`</span></span>

<span data-ttu-id="5ee98-389">During speech recognition, Speech Service periodically generates hypotheses about the words the service recognized.</span><span class="sxs-lookup"><span data-stu-id="5ee98-389">During speech recognition, Speech Service periodically generates hypotheses about the words the service recognized.</span></span> <span data-ttu-id="5ee98-390">Speech Service sends these hypotheses to the client approximately every 300 milliseconds.</span><span class="sxs-lookup"><span data-stu-id="5ee98-390">Speech Service sends these hypotheses to the client approximately every 300 milliseconds.</span></span> <span data-ttu-id="5ee98-391">The `speech.hypothesis` is suitable *only* for enhancing the user speech experience.</span><span class="sxs-lookup"><span data-stu-id="5ee98-391">The `speech.hypothesis` is suitable *only* for enhancing the user speech experience.</span></span> <span data-ttu-id="5ee98-392">You must not take any dependency on the content or accuracy of the text in these messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-392">You must not take any dependency on the content or accuracy of the text in these messages.</span></span>

 <span data-ttu-id="5ee98-393">The `speech.hypothesis` message is applicable to those clients that have some text rendering capability and want to provide near-real-time feedback of the in-progress recognition to the person who is speaking.</span><span class="sxs-lookup"><span data-stu-id="5ee98-393">The `speech.hypothesis` message is applicable to those clients that have some text rendering capability and want to provide near-real-time feedback of the in-progress recognition to the person who is speaking.</span></span>

| <span data-ttu-id="5ee98-394">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-394">Field</span></span> | <span data-ttu-id="5ee98-395">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-395">Description</span></span> |
| ------------- | ---------------- |
| <span data-ttu-id="5ee98-396">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-396">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-397">Text</span><span class="sxs-lookup"><span data-stu-id="5ee98-397">Text</span></span> |
| <span data-ttu-id="5ee98-398">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-398">Path</span></span> | `speech.hypothesis` |
| <span data-ttu-id="5ee98-399">X-RequestId</span><span class="sxs-lookup"><span data-stu-id="5ee98-399">X-RequestId</span></span> | <span data-ttu-id="5ee98-400">UUID in "no-dash" format</span><span class="sxs-lookup"><span data-stu-id="5ee98-400">UUID in "no-dash" format</span></span> |
| <span data-ttu-id="5ee98-401">Content-Type</span><span class="sxs-lookup"><span data-stu-id="5ee98-401">Content-Type</span></span> | <span data-ttu-id="5ee98-402">application/json</span><span class="sxs-lookup"><span data-stu-id="5ee98-402">application/json</span></span> |
| <span data-ttu-id="5ee98-403">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-403">Body</span></span> | <span data-ttu-id="5ee98-404">The speech hypothesis JSON structure</span><span class="sxs-lookup"><span data-stu-id="5ee98-404">The speech hypothesis JSON structure</span></span> |

#### <a name="sample-message"></a><span data-ttu-id="5ee98-405">Sample message</span><span class="sxs-lookup"><span data-stu-id="5ee98-405">Sample message</span></span>

```HTML
Path: speech.hypothesis
Content-Type: application/json; charset=utf-8
X-RequestId: 123e4567e89b12d3a456426655440000

{
  "Text": "this is a speech hypothesis",
  "Offset": 0,
  "Duration": 23600000
}
```

<span data-ttu-id="5ee98-406">The *Offset* element specifies the offset (in 100-nanosecond units) when the phrase was recognized, relative to the start of the audio stream.</span><span class="sxs-lookup"><span data-stu-id="5ee98-406">The *Offset* element specifies the offset (in 100-nanosecond units) when the phrase was recognized, relative to the start of the audio stream.</span></span>

<span data-ttu-id="5ee98-407">The *Duration* element specifies the duration (in 100-nanosecond units) of this speech phrase.</span><span class="sxs-lookup"><span data-stu-id="5ee98-407">The *Duration* element specifies the duration (in 100-nanosecond units) of this speech phrase.</span></span>

<span data-ttu-id="5ee98-408">Clients must not make any assumptions about the frequency, timing, or text contained in a speech hypothesis or the consistency of text in any two speech hypotheses.</span><span class="sxs-lookup"><span data-stu-id="5ee98-408">Clients must not make any assumptions about the frequency, timing, or text contained in a speech hypothesis or the consistency of text in any two speech hypotheses.</span></span> <span data-ttu-id="5ee98-409">The hypotheses are just snapshots into the transcription process in the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-409">The hypotheses are just snapshots into the transcription process in the service.</span></span> <span data-ttu-id="5ee98-410">They do not represent a stable accumulation of transcription.</span><span class="sxs-lookup"><span data-stu-id="5ee98-410">They do not represent a stable accumulation of transcription.</span></span> <span data-ttu-id="5ee98-411">For example, a first speech hypothesis might contain the words "fine fun," and the second hypothesis might contain the words "find funny."</span><span class="sxs-lookup"><span data-stu-id="5ee98-411">For example, a first speech hypothesis might contain the words "fine fun," and the second hypothesis might contain the words "find funny."</span></span> <span data-ttu-id="5ee98-412">Speech Service doesn't perform any post-processing (for example, capitalization, punctuation) on the text in the speech hypothesis.</span><span class="sxs-lookup"><span data-stu-id="5ee98-412">Speech Service doesn't perform any post-processing (for example, capitalization, punctuation) on the text in the speech hypothesis.</span></span>

### <a name="message-speechphrase"></a><span data-ttu-id="5ee98-413">Message `speech.phrase`</span><span class="sxs-lookup"><span data-stu-id="5ee98-413">Message `speech.phrase`</span></span>

<span data-ttu-id="5ee98-414">When Speech Service determines that it has enough information to produce a recognition result that won't change, the service produces a `speech.phrase` message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-414">When Speech Service determines that it has enough information to produce a recognition result that won't change, the service produces a `speech.phrase` message.</span></span> <span data-ttu-id="5ee98-415">Speech Service produces these results after it detects that the user has finished a sentence or phrase.</span><span class="sxs-lookup"><span data-stu-id="5ee98-415">Speech Service produces these results after it detects that the user has finished a sentence or phrase.</span></span>

| <span data-ttu-id="5ee98-416">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-416">Field</span></span> | <span data-ttu-id="5ee98-417">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-417">Description</span></span> |
| ------------- | ---------------- |
| <span data-ttu-id="5ee98-418">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-418">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-419">Text</span><span class="sxs-lookup"><span data-stu-id="5ee98-419">Text</span></span> |
| <span data-ttu-id="5ee98-420">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-420">Path</span></span> | `speech.phrase` |
| <span data-ttu-id="5ee98-421">Content-Type</span><span class="sxs-lookup"><span data-stu-id="5ee98-421">Content-Type</span></span> | <span data-ttu-id="5ee98-422">application/json</span><span class="sxs-lookup"><span data-stu-id="5ee98-422">application/json</span></span> |
| <span data-ttu-id="5ee98-423">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-423">Body</span></span> | <span data-ttu-id="5ee98-424">The speech phrase JSON structure</span><span class="sxs-lookup"><span data-stu-id="5ee98-424">The speech phrase JSON structure</span></span> |

<span data-ttu-id="5ee98-425">The speech phrase JSON schema includes the following fields: `RecognitionStatus`, `DisplayText`, `Offset`, and `Duration`.</span><span class="sxs-lookup"><span data-stu-id="5ee98-425">The speech phrase JSON schema includes the following fields: `RecognitionStatus`, `DisplayText`, `Offset`, and `Duration`.</span></span> <span data-ttu-id="5ee98-426">For more information about these fields, see [Transcription responses](../concepts.md#transcription-responses).</span><span class="sxs-lookup"><span data-stu-id="5ee98-426">For more information about these fields, see [Transcription responses](../concepts.md#transcription-responses).</span></span>

#### <a name="sample-message"></a><span data-ttu-id="5ee98-427">Sample message</span><span class="sxs-lookup"><span data-stu-id="5ee98-427">Sample message</span></span>

```HTML
Path: speech.phrase
Content-Type: application/json; charset=utf-8
X-RequestId: 123e4567e89b12d3a456426655440000

{
  "RecognitionStatus": "Success",
  "DisplayText": "Remind me to buy 5 pencils.",
  "Offset": 0,
  "Duration": 12300000
}
```

### <a name="message-speechenddetected"></a><span data-ttu-id="5ee98-428">Message `speech.endDetected`</span><span class="sxs-lookup"><span data-stu-id="5ee98-428">Message `speech.endDetected`</span></span>

<span data-ttu-id="5ee98-429">The `speech.endDetected` message specifies that the client application should stop streaming audio to the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-429">The `speech.endDetected` message specifies that the client application should stop streaming audio to the service.</span></span>

| <span data-ttu-id="5ee98-430">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-430">Field</span></span> | <span data-ttu-id="5ee98-431">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-431">Description</span></span> |
| ------------- | ---------------- |
| <span data-ttu-id="5ee98-432">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-432">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-433">Text</span><span class="sxs-lookup"><span data-stu-id="5ee98-433">Text</span></span> |
| <span data-ttu-id="5ee98-434">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-434">Path</span></span> | `speech.endDetected` |
| <span data-ttu-id="5ee98-435">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-435">Body</span></span> | <span data-ttu-id="5ee98-436">The JSON structure that contains the offset when the end of speech was detected.</span><span class="sxs-lookup"><span data-stu-id="5ee98-436">The JSON structure that contains the offset when the end of speech was detected.</span></span> <span data-ttu-id="5ee98-437">The offset is represented in 100-nanosecond units offset from the start of audio that's used for recognition.</span><span class="sxs-lookup"><span data-stu-id="5ee98-437">The offset is represented in 100-nanosecond units offset from the start of audio that's used for recognition.</span></span> |
| <span data-ttu-id="5ee98-438">Content-Type</span><span class="sxs-lookup"><span data-stu-id="5ee98-438">Content-Type</span></span> | <span data-ttu-id="5ee98-439">application/json; charset=utf-8</span><span class="sxs-lookup"><span data-stu-id="5ee98-439">application/json; charset=utf-8</span></span> |

#### <a name="sample-message"></a><span data-ttu-id="5ee98-440">Sample message</span><span class="sxs-lookup"><span data-stu-id="5ee98-440">Sample message</span></span>

```HTML
Path: speech.endDetected
Content-Type: application/json; charset=utf-8
X-RequestId: 123e4567e89b12d3a456426655440000

{
  "Offset": 0
}
```

<span data-ttu-id="5ee98-441">The *Offset* element specifies the offset (in 100-nanosecond units) when the phrase was recognized, relative to the start of the audio stream.</span><span class="sxs-lookup"><span data-stu-id="5ee98-441">The *Offset* element specifies the offset (in 100-nanosecond units) when the phrase was recognized, relative to the start of the audio stream.</span></span>

### <a name="message-turnstart"></a><span data-ttu-id="5ee98-442">Message `turn.start`</span><span class="sxs-lookup"><span data-stu-id="5ee98-442">Message `turn.start`</span></span>

<span data-ttu-id="5ee98-443">The `turn.start` signals the start of a turn from the perspective of the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-443">The `turn.start` signals the start of a turn from the perspective of the service.</span></span> <span data-ttu-id="5ee98-444">The `turn.start` message is always the first response message you receive for any request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-444">The `turn.start` message is always the first response message you receive for any request.</span></span> <span data-ttu-id="5ee98-445">If you don't receive a `turn.start` message, assume that the state of the service connection is invalid.</span><span class="sxs-lookup"><span data-stu-id="5ee98-445">If you don't receive a `turn.start` message, assume that the state of the service connection is invalid.</span></span>

| <span data-ttu-id="5ee98-446">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-446">Field</span></span> | <span data-ttu-id="5ee98-447">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-447">Description</span></span> |
| ------------- | ---------------- |
| <span data-ttu-id="5ee98-448">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-448">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-449">Text</span><span class="sxs-lookup"><span data-stu-id="5ee98-449">Text</span></span> |
| <span data-ttu-id="5ee98-450">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-450">Path</span></span> | `turn.start` |
| <span data-ttu-id="5ee98-451">Content-Type</span><span class="sxs-lookup"><span data-stu-id="5ee98-451">Content-Type</span></span> | <span data-ttu-id="5ee98-452">application/json; charset=utf-8</span><span class="sxs-lookup"><span data-stu-id="5ee98-452">application/json; charset=utf-8</span></span> |
| <span data-ttu-id="5ee98-453">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-453">Body</span></span> | <span data-ttu-id="5ee98-454">JSON structure</span><span class="sxs-lookup"><span data-stu-id="5ee98-454">JSON structure</span></span> |

#### <a name="sample-message"></a><span data-ttu-id="5ee98-455">Sample message</span><span class="sxs-lookup"><span data-stu-id="5ee98-455">Sample message</span></span>

```HTML
Path: turn.start
Content-Type: application/json; charset=utf-8
X-RequestId: 123e4567e89b12d3a456426655440000

{
  "context": {
    "serviceTag": "7B33613B91714B32817815DC89633AFA"
  }
}
```

<span data-ttu-id="5ee98-456">The body of the `turn.start` message is a JSON structure that contains context for the start of the turn.</span><span class="sxs-lookup"><span data-stu-id="5ee98-456">The body of the `turn.start` message is a JSON structure that contains context for the start of the turn.</span></span> <span data-ttu-id="5ee98-457">The *context* element contains a *serviceTag* property.</span><span class="sxs-lookup"><span data-stu-id="5ee98-457">The *context* element contains a *serviceTag* property.</span></span> <span data-ttu-id="5ee98-458">This property specifies a tag value that the service has associated with the turn.</span><span class="sxs-lookup"><span data-stu-id="5ee98-458">This property specifies a tag value that the service has associated with the turn.</span></span> <span data-ttu-id="5ee98-459">This value can be used by Microsoft if you need help troubleshooting failures in your application.</span><span class="sxs-lookup"><span data-stu-id="5ee98-459">This value can be used by Microsoft if you need help troubleshooting failures in your application.</span></span>

### <a name="message-turnend"></a><span data-ttu-id="5ee98-460">Message `turn.end`</span><span class="sxs-lookup"><span data-stu-id="5ee98-460">Message `turn.end`</span></span>

<span data-ttu-id="5ee98-461">The `turn.end` signals the end of a turn from the perspective of the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-461">The `turn.end` signals the end of a turn from the perspective of the service.</span></span> <span data-ttu-id="5ee98-462">The `turn.end` message is always the last response message you receive for any request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-462">The `turn.end` message is always the last response message you receive for any request.</span></span> <span data-ttu-id="5ee98-463">Clients can use the receipt of this message as a signal for cleanup activities and transitioning to an idle state.</span><span class="sxs-lookup"><span data-stu-id="5ee98-463">Clients can use the receipt of this message as a signal for cleanup activities and transitioning to an idle state.</span></span> <span data-ttu-id="5ee98-464">If you don't receive a `turn.end` message, assume that the state of the service connection is invalid.</span><span class="sxs-lookup"><span data-stu-id="5ee98-464">If you don't receive a `turn.end` message, assume that the state of the service connection is invalid.</span></span> <span data-ttu-id="5ee98-465">In those cases, close the existing connection to the service and reconnect.</span><span class="sxs-lookup"><span data-stu-id="5ee98-465">In those cases, close the existing connection to the service and reconnect.</span></span>

| <span data-ttu-id="5ee98-466">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-466">Field</span></span> | <span data-ttu-id="5ee98-467">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-467">Description</span></span> |
| ------------- | ---------------- |
| <span data-ttu-id="5ee98-468">WebSocket message encoding</span><span class="sxs-lookup"><span data-stu-id="5ee98-468">WebSocket message encoding</span></span> | <span data-ttu-id="5ee98-469">Text</span><span class="sxs-lookup"><span data-stu-id="5ee98-469">Text</span></span> |
| <span data-ttu-id="5ee98-470">Path</span><span class="sxs-lookup"><span data-stu-id="5ee98-470">Path</span></span> | `turn.end` |
| <span data-ttu-id="5ee98-471">Body</span><span class="sxs-lookup"><span data-stu-id="5ee98-471">Body</span></span> | <span data-ttu-id="5ee98-472">None</span><span class="sxs-lookup"><span data-stu-id="5ee98-472">None</span></span> |

#### <a name="sample-message"></a><span data-ttu-id="5ee98-473">Sample message</span><span class="sxs-lookup"><span data-stu-id="5ee98-473">Sample message</span></span>

```HTML
Path: turn.end
X-RequestId: 123e4567e89b12d3a456426655440000
```

## <a name="telemetry-schema"></a><span data-ttu-id="5ee98-474">Telemetry schema</span><span class="sxs-lookup"><span data-stu-id="5ee98-474">Telemetry schema</span></span>

<span data-ttu-id="5ee98-475">The body of the *telemetry* message is a JSON structure that contains client information about a turn or an attempted connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-475">The body of the *telemetry* message is a JSON structure that contains client information about a turn or an attempted connection.</span></span> <span data-ttu-id="5ee98-476">The structure is made up of client time stamps that record when client events occur.</span><span class="sxs-lookup"><span data-stu-id="5ee98-476">The structure is made up of client time stamps that record when client events occur.</span></span> <span data-ttu-id="5ee98-477">Each time stamp must be in ISO 8601 format as described in the section titled "X-Timestamp header."</span><span class="sxs-lookup"><span data-stu-id="5ee98-477">Each time stamp must be in ISO 8601 format as described in the section titled "X-Timestamp header."</span></span> <span data-ttu-id="5ee98-478">*Telemetry* messages that do not specify all the required fields in the JSON structure or that do not use the correct time stamp format might cause the service to terminate the connection to the client.</span><span class="sxs-lookup"><span data-stu-id="5ee98-478">*Telemetry* messages that do not specify all the required fields in the JSON structure or that do not use the correct time stamp format might cause the service to terminate the connection to the client.</span></span> <span data-ttu-id="5ee98-479">Clients *must* supply valid values for all required fields.</span><span class="sxs-lookup"><span data-stu-id="5ee98-479">Clients *must* supply valid values for all required fields.</span></span> <span data-ttu-id="5ee98-480">Clients *should* supply values for optional fields whenever appropriate.</span><span class="sxs-lookup"><span data-stu-id="5ee98-480">Clients *should* supply values for optional fields whenever appropriate.</span></span> <span data-ttu-id="5ee98-481">The values shown in samples in this section are for illustration only.</span><span class="sxs-lookup"><span data-stu-id="5ee98-481">The values shown in samples in this section are for illustration only.</span></span>

<span data-ttu-id="5ee98-482">Telemetry schema is divided into the following parts: received message time stamps and metrics.</span><span class="sxs-lookup"><span data-stu-id="5ee98-482">Telemetry schema is divided into the following parts: received message time stamps and metrics.</span></span> <span data-ttu-id="5ee98-483">The format and usage of each part is specified in the following sections.</span><span class="sxs-lookup"><span data-stu-id="5ee98-483">The format and usage of each part is specified in the following sections.</span></span>

### <a name="received-message-time-stamps"></a><span data-ttu-id="5ee98-484">Received message time stamps</span><span class="sxs-lookup"><span data-stu-id="5ee98-484">Received message time stamps</span></span>

<span data-ttu-id="5ee98-485">Clients must include time-of-receipt values for all messages that they receive after successfully connecting to the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-485">Clients must include time-of-receipt values for all messages that they receive after successfully connecting to the service.</span></span> <span data-ttu-id="5ee98-486">These values must record the time when the client *received* each message from the network.</span><span class="sxs-lookup"><span data-stu-id="5ee98-486">These values must record the time when the client *received* each message from the network.</span></span> <span data-ttu-id="5ee98-487">The value should not record any other time.</span><span class="sxs-lookup"><span data-stu-id="5ee98-487">The value should not record any other time.</span></span> <span data-ttu-id="5ee98-488">For example, the client should not record the time when it *acted* on the message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-488">For example, the client should not record the time when it *acted* on the message.</span></span> <span data-ttu-id="5ee98-489">The received message time stamps are specified in an array of *name:value* pairs.</span><span class="sxs-lookup"><span data-stu-id="5ee98-489">The received message time stamps are specified in an array of *name:value* pairs.</span></span> <span data-ttu-id="5ee98-490">The name of the pair specifies the *Path* value of the message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-490">The name of the pair specifies the *Path* value of the message.</span></span> <span data-ttu-id="5ee98-491">The value of the pair specifies the client time when the message was received.</span><span class="sxs-lookup"><span data-stu-id="5ee98-491">The value of the pair specifies the client time when the message was received.</span></span> <span data-ttu-id="5ee98-492">Or, if more than one message of the specified name was received, the value of the pair is an array of time stamps that indicates when those messages were received.</span><span class="sxs-lookup"><span data-stu-id="5ee98-492">Or, if more than one message of the specified name was received, the value of the pair is an array of time stamps that indicates when those messages were received.</span></span>

```JSON
  "ReceivedMessages": [
    { "speech.hypothesis": [ "2016-08-16T15:03:48.172Z", "2016-08-16T15:03:48.331Z", "2016-08-16T15:03:48.881Z" ] },
    { "speech.endDetected": "2016-08-16T15:03:49.721Z" },
    { "speech.phrase": "2016-08-16T15:03:50.001Z" },
    { "turn.end": "2016-08-16T15:03:51.021Z" }
  ]
```

<span data-ttu-id="5ee98-493">Clients *must* acknowledge the receipt of all messages sent by the service by including time stamps for those messages in the JSON body.</span><span class="sxs-lookup"><span data-stu-id="5ee98-493">Clients *must* acknowledge the receipt of all messages sent by the service by including time stamps for those messages in the JSON body.</span></span> <span data-ttu-id="5ee98-494">If a client fails to acknowledge the receipt of a message, the service might terminate the connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-494">If a client fails to acknowledge the receipt of a message, the service might terminate the connection.</span></span>

### <a name="metrics"></a><span data-ttu-id="5ee98-495">Metrics</span><span class="sxs-lookup"><span data-stu-id="5ee98-495">Metrics</span></span>

<span data-ttu-id="5ee98-496">Clients must include information about events that occurred during the lifetime of a request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-496">Clients must include information about events that occurred during the lifetime of a request.</span></span> <span data-ttu-id="5ee98-497">The following metrics are supported: `Connection`, `Microphone`, and `ListeningTrigger`.</span><span class="sxs-lookup"><span data-stu-id="5ee98-497">The following metrics are supported: `Connection`, `Microphone`, and `ListeningTrigger`.</span></span>

### <a name="metric-connection"></a><span data-ttu-id="5ee98-498">Metric `Connection`</span><span class="sxs-lookup"><span data-stu-id="5ee98-498">Metric `Connection`</span></span>

<span data-ttu-id="5ee98-499">The `Connection` metric specifies details about connection attempts by the client.</span><span class="sxs-lookup"><span data-stu-id="5ee98-499">The `Connection` metric specifies details about connection attempts by the client.</span></span> <span data-ttu-id="5ee98-500">The metric must include time stamps of when the WebSocket connection was started and finished.</span><span class="sxs-lookup"><span data-stu-id="5ee98-500">The metric must include time stamps of when the WebSocket connection was started and finished.</span></span> <span data-ttu-id="5ee98-501">The `Connection` metric is required *only for the first turn of a connection*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-501">The `Connection` metric is required *only for the first turn of a connection*.</span></span> <span data-ttu-id="5ee98-502">Subsequent turns are not required to include this information.</span><span class="sxs-lookup"><span data-stu-id="5ee98-502">Subsequent turns are not required to include this information.</span></span> <span data-ttu-id="5ee98-503">If a client makes multiple connection attempts before a connection is established, information about *all* the connection attempts should be included.</span><span class="sxs-lookup"><span data-stu-id="5ee98-503">If a client makes multiple connection attempts before a connection is established, information about *all* the connection attempts should be included.</span></span> <span data-ttu-id="5ee98-504">For more information, see [Connection failure telemetry](#connection-failure-telemetry).</span><span class="sxs-lookup"><span data-stu-id="5ee98-504">For more information, see [Connection failure telemetry](#connection-failure-telemetry).</span></span>

| <span data-ttu-id="5ee98-505">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-505">Field</span></span> | <span data-ttu-id="5ee98-506">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-506">Description</span></span> | <span data-ttu-id="5ee98-507">Usage</span><span class="sxs-lookup"><span data-stu-id="5ee98-507">Usage</span></span> |
| ----- | ----------- | ----- |
| <span data-ttu-id="5ee98-508">Name</span><span class="sxs-lookup"><span data-stu-id="5ee98-508">Name</span></span> | `Connection` | <span data-ttu-id="5ee98-509">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-509">Required</span></span> |
| <span data-ttu-id="5ee98-510">Id</span><span class="sxs-lookup"><span data-stu-id="5ee98-510">Id</span></span> | <span data-ttu-id="5ee98-511">The connection identifier value that was used in the *X-ConnectionId* header for this connection request</span><span class="sxs-lookup"><span data-stu-id="5ee98-511">The connection identifier value that was used in the *X-ConnectionId* header for this connection request</span></span> | <span data-ttu-id="5ee98-512">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-512">Required</span></span> |
| <span data-ttu-id="5ee98-513">Start</span><span class="sxs-lookup"><span data-stu-id="5ee98-513">Start</span></span> | <span data-ttu-id="5ee98-514">The time when the client sent the connection request</span><span class="sxs-lookup"><span data-stu-id="5ee98-514">The time when the client sent the connection request</span></span> | <span data-ttu-id="5ee98-515">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-515">Required</span></span> |
| <span data-ttu-id="5ee98-516">End</span><span class="sxs-lookup"><span data-stu-id="5ee98-516">End</span></span> | <span data-ttu-id="5ee98-517">The time when the client received notification that the connection was established successfully or, in error cases, rejected, refused, or failed</span><span class="sxs-lookup"><span data-stu-id="5ee98-517">The time when the client received notification that the connection was established successfully or, in error cases, rejected, refused, or failed</span></span> | <span data-ttu-id="5ee98-518">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-518">Required</span></span> |
| <span data-ttu-id="5ee98-519">Error</span><span class="sxs-lookup"><span data-stu-id="5ee98-519">Error</span></span> | <span data-ttu-id="5ee98-520">A description of the error that occurred, if any.</span><span class="sxs-lookup"><span data-stu-id="5ee98-520">A description of the error that occurred, if any.</span></span> <span data-ttu-id="5ee98-521">If the connection was successful, clients should omit this field.</span><span class="sxs-lookup"><span data-stu-id="5ee98-521">If the connection was successful, clients should omit this field.</span></span> <span data-ttu-id="5ee98-522">The maximum length of this field is 50 characters.</span><span class="sxs-lookup"><span data-stu-id="5ee98-522">The maximum length of this field is 50 characters.</span></span> | <span data-ttu-id="5ee98-523">Required for error cases, omitted otherwise</span><span class="sxs-lookup"><span data-stu-id="5ee98-523">Required for error cases, omitted otherwise</span></span> |

<span data-ttu-id="5ee98-524">The error description should be at most 50 characters and ideally should be one of the values listed in the following table.</span><span class="sxs-lookup"><span data-stu-id="5ee98-524">The error description should be at most 50 characters and ideally should be one of the values listed in the following table.</span></span> <span data-ttu-id="5ee98-525">If the error condition doesn't match one of these values, clients can use a succinct description of the error condition by using [CamelCasing](https://en.wikipedia.org/wiki/Camel_case) without white space.</span><span class="sxs-lookup"><span data-stu-id="5ee98-525">If the error condition doesn't match one of these values, clients can use a succinct description of the error condition by using [CamelCasing](https://en.wikipedia.org/wiki/Camel_case) without white space.</span></span> <span data-ttu-id="5ee98-526">The ability to send a *telemetry* message requires a connection to the service, so only transient or temporary error conditions can be reported in the *telemetry* message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-526">The ability to send a *telemetry* message requires a connection to the service, so only transient or temporary error conditions can be reported in the *telemetry* message.</span></span> <span data-ttu-id="5ee98-527">Error conditions that *permanently* block a client from establishing a connection to the service prevent the client from sending any message to the service, including *telemetry* messages.</span><span class="sxs-lookup"><span data-stu-id="5ee98-527">Error conditions that *permanently* block a client from establishing a connection to the service prevent the client from sending any message to the service, including *telemetry* messages.</span></span>

| <span data-ttu-id="5ee98-528">Error</span><span class="sxs-lookup"><span data-stu-id="5ee98-528">Error</span></span> | <span data-ttu-id="5ee98-529">Usage</span><span class="sxs-lookup"><span data-stu-id="5ee98-529">Usage</span></span> |
| ----- | ----- |
| <span data-ttu-id="5ee98-530">DNSfailure</span><span class="sxs-lookup"><span data-stu-id="5ee98-530">DNSfailure</span></span> | <span data-ttu-id="5ee98-531">The client was unable to connect to the service because of a DNS failure in the network stack.</span><span class="sxs-lookup"><span data-stu-id="5ee98-531">The client was unable to connect to the service because of a DNS failure in the network stack.</span></span> |
| <span data-ttu-id="5ee98-532">NoNetwork</span><span class="sxs-lookup"><span data-stu-id="5ee98-532">NoNetwork</span></span> | <span data-ttu-id="5ee98-533">The client attempted a connection, but the network stack reported that no physical network was available.</span><span class="sxs-lookup"><span data-stu-id="5ee98-533">The client attempted a connection, but the network stack reported that no physical network was available.</span></span> |
| <span data-ttu-id="5ee98-534">NoAuthorization</span><span class="sxs-lookup"><span data-stu-id="5ee98-534">NoAuthorization</span></span> | <span data-ttu-id="5ee98-535">The client connection failed while attempting to acquire an authorization token for the connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-535">The client connection failed while attempting to acquire an authorization token for the connection.</span></span> |
| <span data-ttu-id="5ee98-536">NoResources</span><span class="sxs-lookup"><span data-stu-id="5ee98-536">NoResources</span></span> | <span data-ttu-id="5ee98-537">The client ran out of some local resource (for example, memory) while trying to make a connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-537">The client ran out of some local resource (for example, memory) while trying to make a connection.</span></span> |
| <span data-ttu-id="5ee98-538">Forbidden</span><span class="sxs-lookup"><span data-stu-id="5ee98-538">Forbidden</span></span> | <span data-ttu-id="5ee98-539">The client was unable to connect to the service because the service returned an HTTP `403 Forbidden` status code on the WebSocket upgrade request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-539">The client was unable to connect to the service because the service returned an HTTP `403 Forbidden` status code on the WebSocket upgrade request.</span></span> |
| <span data-ttu-id="5ee98-540">Unauthorized</span><span class="sxs-lookup"><span data-stu-id="5ee98-540">Unauthorized</span></span> | <span data-ttu-id="5ee98-541">The client was unable to connect to the service because the service returned an HTTP `401 Unauthorized` status code on the WebSocket upgrade request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-541">The client was unable to connect to the service because the service returned an HTTP `401 Unauthorized` status code on the WebSocket upgrade request.</span></span> |
| <span data-ttu-id="5ee98-542">BadRequest</span><span class="sxs-lookup"><span data-stu-id="5ee98-542">BadRequest</span></span> | <span data-ttu-id="5ee98-543">The client was unable to connect to the service because the service returned an HTTP `400 Bad Request` status code on the WebSocket upgrade request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-543">The client was unable to connect to the service because the service returned an HTTP `400 Bad Request` status code on the WebSocket upgrade request.</span></span> |
| <span data-ttu-id="5ee98-544">ServerUnavailable</span><span class="sxs-lookup"><span data-stu-id="5ee98-544">ServerUnavailable</span></span> | <span data-ttu-id="5ee98-545">The client was unable to connect to the service because the service returned an HTTP `503 Server Unavailable` status code on the WebSocket upgrade request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-545">The client was unable to connect to the service because the service returned an HTTP `503 Server Unavailable` status code on the WebSocket upgrade request.</span></span> |
| <span data-ttu-id="5ee98-546">ServerError</span><span class="sxs-lookup"><span data-stu-id="5ee98-546">ServerError</span></span> | <span data-ttu-id="5ee98-547">The client was unable to connect to the service because the service returned an `HTTP 500` Internal Error status code on the WebSocket upgrade request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-547">The client was unable to connect to the service because the service returned an `HTTP 500` Internal Error status code on the WebSocket upgrade request.</span></span> |
| <span data-ttu-id="5ee98-548">Timeout</span><span class="sxs-lookup"><span data-stu-id="5ee98-548">Timeout</span></span> | <span data-ttu-id="5ee98-549">The client's connection request timed out without a response from the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-549">The client's connection request timed out without a response from the service.</span></span> <span data-ttu-id="5ee98-550">The *End* field contains the time when the client timed out and stopped waiting for the connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-550">The *End* field contains the time when the client timed out and stopped waiting for the connection.</span></span> |
| <span data-ttu-id="5ee98-551">ClientError</span><span class="sxs-lookup"><span data-stu-id="5ee98-551">ClientError</span></span> | <span data-ttu-id="5ee98-552">The client terminated the connection because of some internal client error.</span><span class="sxs-lookup"><span data-stu-id="5ee98-552">The client terminated the connection because of some internal client error.</span></span> | 

### <a name="metric-microphone"></a><span data-ttu-id="5ee98-553">Metric `Microphone`</span><span class="sxs-lookup"><span data-stu-id="5ee98-553">Metric `Microphone`</span></span>

<span data-ttu-id="5ee98-554">The `Microphone` metric is required for all speech turns.</span><span class="sxs-lookup"><span data-stu-id="5ee98-554">The `Microphone` metric is required for all speech turns.</span></span> <span data-ttu-id="5ee98-555">This metric measures the time on the client during which audio input is being actively used for a speech request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-555">This metric measures the time on the client during which audio input is being actively used for a speech request.</span></span>

<span data-ttu-id="5ee98-556">Use the following examples as guidelines for recording *Start* time values for the `Microphone` metric in your client application:</span><span class="sxs-lookup"><span data-stu-id="5ee98-556">Use the following examples as guidelines for recording *Start* time values for the `Microphone` metric in your client application:</span></span>

* <span data-ttu-id="5ee98-557">A client application requires that a user must press a physical button to start the microphone.</span><span class="sxs-lookup"><span data-stu-id="5ee98-557">A client application requires that a user must press a physical button to start the microphone.</span></span> <span data-ttu-id="5ee98-558">After the button press, the client application reads the input from the microphone and sends it to Speech Service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-558">After the button press, the client application reads the input from the microphone and sends it to Speech Service.</span></span> <span data-ttu-id="5ee98-559">The *Start* value for the `Microphone` metric records the time after the button push when the microphone is initialized and ready to provide input.</span><span class="sxs-lookup"><span data-stu-id="5ee98-559">The *Start* value for the `Microphone` metric records the time after the button push when the microphone is initialized and ready to provide input.</span></span> <span data-ttu-id="5ee98-560">The *End* value for the `Microphone` metric records the time when the client application stopped streaming audio to the service after it received the `speech.endDetected` message from the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-560">The *End* value for the `Microphone` metric records the time when the client application stopped streaming audio to the service after it received the `speech.endDetected` message from the service.</span></span>

* <span data-ttu-id="5ee98-561">A client application uses a keyword spotter that is "always" listening.</span><span class="sxs-lookup"><span data-stu-id="5ee98-561">A client application uses a keyword spotter that is "always" listening.</span></span> <span data-ttu-id="5ee98-562">Only after the keyword spotter detects a spoken trigger phrase does the client application collect the input from the microphone and send it to Speech Service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-562">Only after the keyword spotter detects a spoken trigger phrase does the client application collect the input from the microphone and send it to Speech Service.</span></span> <span data-ttu-id="5ee98-563">The *Start* value for the `Microphone` metric records the time when the keyword spotter notified the client to start using input from the microphone.</span><span class="sxs-lookup"><span data-stu-id="5ee98-563">The *Start* value for the `Microphone` metric records the time when the keyword spotter notified the client to start using input from the microphone.</span></span> <span data-ttu-id="5ee98-564">The *End* value for the `Microphone` metric records the time when the client application stopped streaming audio to the service after it received the `speech.endDetected` message from the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-564">The *End* value for the `Microphone` metric records the time when the client application stopped streaming audio to the service after it received the `speech.endDetected` message from the service.</span></span>

* <span data-ttu-id="5ee98-565">A client application has access to a constant audio stream and performs silence/speech detection on that audio stream in a *speech detection module*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-565">A client application has access to a constant audio stream and performs silence/speech detection on that audio stream in a *speech detection module*.</span></span> <span data-ttu-id="5ee98-566">The *Start* value for the `Microphone` metric records the time when the *speech detection module* notified the client to start using input from the audio stream.</span><span class="sxs-lookup"><span data-stu-id="5ee98-566">The *Start* value for the `Microphone` metric records the time when the *speech detection module* notified the client to start using input from the audio stream.</span></span> <span data-ttu-id="5ee98-567">The *End* value for the `Microphone` metric records the time when the client application stopped streaming audio to the service after it received the `speech.endDetected` message from the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-567">The *End* value for the `Microphone` metric records the time when the client application stopped streaming audio to the service after it received the `speech.endDetected` message from the service.</span></span>

* <span data-ttu-id="5ee98-568">A client application is processing the second turn of a multi-turn request and is informed by a service response message to turn on the microphone to gather input for the second turn.</span><span class="sxs-lookup"><span data-stu-id="5ee98-568">A client application is processing the second turn of a multi-turn request and is informed by a service response message to turn on the microphone to gather input for the second turn.</span></span> <span data-ttu-id="5ee98-569">The *Start* value for the `Microphone` metric records the time when the client application enables the microphone and starts using input from that audio source.</span><span class="sxs-lookup"><span data-stu-id="5ee98-569">The *Start* value for the `Microphone` metric records the time when the client application enables the microphone and starts using input from that audio source.</span></span> <span data-ttu-id="5ee98-570">The *End* value for the `Microphone` metric records the time when the client application stopped streaming audio to the service after it received the `speech.endDetected` message from the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-570">The *End* value for the `Microphone` metric records the time when the client application stopped streaming audio to the service after it received the `speech.endDetected` message from the service.</span></span>

<span data-ttu-id="5ee98-571">The *End* time value for the `Microphone` metric records the time when the client application stopped streaming audio input.</span><span class="sxs-lookup"><span data-stu-id="5ee98-571">The *End* time value for the `Microphone` metric records the time when the client application stopped streaming audio input.</span></span> <span data-ttu-id="5ee98-572">In most situations, this event occurs shortly after the client received the `speech.endDetected` message from the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-572">In most situations, this event occurs shortly after the client received the `speech.endDetected` message from the service.</span></span> <span data-ttu-id="5ee98-573">Client applications might verify that they're properly conforming to the protocol by ensuring that the *End* time value for the `Microphone` metric occurs later than the receipt time value for the `speech.endDetected` message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-573">Client applications might verify that they're properly conforming to the protocol by ensuring that the *End* time value for the `Microphone` metric occurs later than the receipt time value for the `speech.endDetected` message.</span></span> <span data-ttu-id="5ee98-574">And, because there is usually a delay between the end of one turn and the start of another turn, clients might verify protocol conformance by ensuring that the *Start* time of the `Microphone` metric for any subsequent turn correctly records the time when the client *started* using the microphone to stream audio input to the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-574">And, because there is usually a delay between the end of one turn and the start of another turn, clients might verify protocol conformance by ensuring that the *Start* time of the `Microphone` metric for any subsequent turn correctly records the time when the client *started* using the microphone to stream audio input to the service.</span></span>

| <span data-ttu-id="5ee98-575">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-575">Field</span></span> | <span data-ttu-id="5ee98-576">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-576">Description</span></span> | <span data-ttu-id="5ee98-577">Usage</span><span class="sxs-lookup"><span data-stu-id="5ee98-577">Usage</span></span> |
| ----- | ----------- | ----- |
| <span data-ttu-id="5ee98-578">Name</span><span class="sxs-lookup"><span data-stu-id="5ee98-578">Name</span></span> | <span data-ttu-id="5ee98-579">Microphone</span><span class="sxs-lookup"><span data-stu-id="5ee98-579">Microphone</span></span> | <span data-ttu-id="5ee98-580">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-580">Required</span></span> |
| <span data-ttu-id="5ee98-581">Start</span><span class="sxs-lookup"><span data-stu-id="5ee98-581">Start</span></span> | <span data-ttu-id="5ee98-582">The time when the client started using audio input from the microphone or other audio stream or received a trigger from the keyword spotter</span><span class="sxs-lookup"><span data-stu-id="5ee98-582">The time when the client started using audio input from the microphone or other audio stream or received a trigger from the keyword spotter</span></span> | <span data-ttu-id="5ee98-583">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-583">Required</span></span> |
| <span data-ttu-id="5ee98-584">End</span><span class="sxs-lookup"><span data-stu-id="5ee98-584">End</span></span> | <span data-ttu-id="5ee98-585">The time when the client stopped using the microphone or audio stream</span><span class="sxs-lookup"><span data-stu-id="5ee98-585">The time when the client stopped using the microphone or audio stream</span></span> | <span data-ttu-id="5ee98-586">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-586">Required</span></span> |
| <span data-ttu-id="5ee98-587">Error</span><span class="sxs-lookup"><span data-stu-id="5ee98-587">Error</span></span> | <span data-ttu-id="5ee98-588">A description of the error that occurred, if any.</span><span class="sxs-lookup"><span data-stu-id="5ee98-588">A description of the error that occurred, if any.</span></span> <span data-ttu-id="5ee98-589">If the microphone operations were successful, clients should omit this field.</span><span class="sxs-lookup"><span data-stu-id="5ee98-589">If the microphone operations were successful, clients should omit this field.</span></span> <span data-ttu-id="5ee98-590">The maximum length of this field is 50 characters.</span><span class="sxs-lookup"><span data-stu-id="5ee98-590">The maximum length of this field is 50 characters.</span></span> | <span data-ttu-id="5ee98-591">Required for error cases, omitted otherwise</span><span class="sxs-lookup"><span data-stu-id="5ee98-591">Required for error cases, omitted otherwise</span></span> |

### <a name="metric-listeningtrigger"></a><span data-ttu-id="5ee98-592">Metric `ListeningTrigger`</span><span class="sxs-lookup"><span data-stu-id="5ee98-592">Metric `ListeningTrigger`</span></span>
<span data-ttu-id="5ee98-593">The `ListeningTrigger` metric measures the time when the user executes the action that initiates speech input.</span><span class="sxs-lookup"><span data-stu-id="5ee98-593">The `ListeningTrigger` metric measures the time when the user executes the action that initiates speech input.</span></span> <span data-ttu-id="5ee98-594">The `ListeningTrigger` metric is optional, but clients that can provide this metric are encouraged to do so.</span><span class="sxs-lookup"><span data-stu-id="5ee98-594">The `ListeningTrigger` metric is optional, but clients that can provide this metric are encouraged to do so.</span></span>

<span data-ttu-id="5ee98-595">Use the following examples as guidelines for recording *Start* and *End* time values for the `ListeningTrigger` metric in your client application.</span><span class="sxs-lookup"><span data-stu-id="5ee98-595">Use the following examples as guidelines for recording *Start* and *End* time values for the `ListeningTrigger` metric in your client application.</span></span>

* <span data-ttu-id="5ee98-596">A client application requires that a user must press a physical button to start the microphone.</span><span class="sxs-lookup"><span data-stu-id="5ee98-596">A client application requires that a user must press a physical button to start the microphone.</span></span> <span data-ttu-id="5ee98-597">The *Start* value for this metric records the time of the button push.</span><span class="sxs-lookup"><span data-stu-id="5ee98-597">The *Start* value for this metric records the time of the button push.</span></span> <span data-ttu-id="5ee98-598">The *End* value records the time when the button push finishes.</span><span class="sxs-lookup"><span data-stu-id="5ee98-598">The *End* value records the time when the button push finishes.</span></span>

* <span data-ttu-id="5ee98-599">A client application uses a keyword spotter that is "always" listening.</span><span class="sxs-lookup"><span data-stu-id="5ee98-599">A client application uses a keyword spotter that is "always" listening.</span></span> <span data-ttu-id="5ee98-600">After the keyword spotter detects a spoken trigger phrase, the client application reads the input from the microphone and sends it to Speech Service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-600">After the keyword spotter detects a spoken trigger phrase, the client application reads the input from the microphone and sends it to Speech Service.</span></span> <span data-ttu-id="5ee98-601">The *Start* value for this metric records the time when the keyword spotter received audio that was then detected as the trigger phrase.</span><span class="sxs-lookup"><span data-stu-id="5ee98-601">The *Start* value for this metric records the time when the keyword spotter received audio that was then detected as the trigger phrase.</span></span> <span data-ttu-id="5ee98-602">The *End* value records the time when the last word of the trigger phrase was spoken by the user.</span><span class="sxs-lookup"><span data-stu-id="5ee98-602">The *End* value records the time when the last word of the trigger phrase was spoken by the user.</span></span>

* <span data-ttu-id="5ee98-603">A client application has access to a constant audio stream and performs silence/speech detection on that audio stream in a *speech detection module*.</span><span class="sxs-lookup"><span data-stu-id="5ee98-603">A client application has access to a constant audio stream and performs silence/speech detection on that audio stream in a *speech detection module*.</span></span> <span data-ttu-id="5ee98-604">The *Start* value for this metric records the time that the *speech detection module* received audio that was then detected as speech.</span><span class="sxs-lookup"><span data-stu-id="5ee98-604">The *Start* value for this metric records the time that the *speech detection module* received audio that was then detected as speech.</span></span> <span data-ttu-id="5ee98-605">The *End* value records the time when the *speech detection module* detected speech.</span><span class="sxs-lookup"><span data-stu-id="5ee98-605">The *End* value records the time when the *speech detection module* detected speech.</span></span>

* <span data-ttu-id="5ee98-606">A client application is processing the second turn of a multi-turn request and is informed by a service response message to turn on the microphone to gather input for the second turn.</span><span class="sxs-lookup"><span data-stu-id="5ee98-606">A client application is processing the second turn of a multi-turn request and is informed by a service response message to turn on the microphone to gather input for the second turn.</span></span> <span data-ttu-id="5ee98-607">The client application should *not* include a `ListeningTrigger` metric for this turn.</span><span class="sxs-lookup"><span data-stu-id="5ee98-607">The client application should *not* include a `ListeningTrigger` metric for this turn.</span></span>

| <span data-ttu-id="5ee98-608">Field</span><span class="sxs-lookup"><span data-stu-id="5ee98-608">Field</span></span> | <span data-ttu-id="5ee98-609">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-609">Description</span></span> | <span data-ttu-id="5ee98-610">Usage</span><span class="sxs-lookup"><span data-stu-id="5ee98-610">Usage</span></span> |
| ----- | ----------- | ----- |
| <span data-ttu-id="5ee98-611">Name</span><span class="sxs-lookup"><span data-stu-id="5ee98-611">Name</span></span> | <span data-ttu-id="5ee98-612">ListeningTrigger</span><span class="sxs-lookup"><span data-stu-id="5ee98-612">ListeningTrigger</span></span> | <span data-ttu-id="5ee98-613">Optional</span><span class="sxs-lookup"><span data-stu-id="5ee98-613">Optional</span></span> |
| <span data-ttu-id="5ee98-614">Start</span><span class="sxs-lookup"><span data-stu-id="5ee98-614">Start</span></span> | <span data-ttu-id="5ee98-615">The time when the client listening trigger started</span><span class="sxs-lookup"><span data-stu-id="5ee98-615">The time when the client listening trigger started</span></span> | <span data-ttu-id="5ee98-616">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-616">Required</span></span> |
| <span data-ttu-id="5ee98-617">End</span><span class="sxs-lookup"><span data-stu-id="5ee98-617">End</span></span> | <span data-ttu-id="5ee98-618">The time when the client listening trigger finished</span><span class="sxs-lookup"><span data-stu-id="5ee98-618">The time when the client listening trigger finished</span></span> | <span data-ttu-id="5ee98-619">Required</span><span class="sxs-lookup"><span data-stu-id="5ee98-619">Required</span></span> |
| <span data-ttu-id="5ee98-620">Error</span><span class="sxs-lookup"><span data-stu-id="5ee98-620">Error</span></span> | <span data-ttu-id="5ee98-621">A description of the error that occurred, if any.</span><span class="sxs-lookup"><span data-stu-id="5ee98-621">A description of the error that occurred, if any.</span></span> <span data-ttu-id="5ee98-622">If the trigger operation was successful, clients should omit this field.</span><span class="sxs-lookup"><span data-stu-id="5ee98-622">If the trigger operation was successful, clients should omit this field.</span></span> <span data-ttu-id="5ee98-623">The maximum length of this field is 50 characters.</span><span class="sxs-lookup"><span data-stu-id="5ee98-623">The maximum length of this field is 50 characters.</span></span> | <span data-ttu-id="5ee98-624">Required for error cases, omitted otherwise</span><span class="sxs-lookup"><span data-stu-id="5ee98-624">Required for error cases, omitted otherwise</span></span> |

#### <a name="sample-message"></a><span data-ttu-id="5ee98-625">Sample message</span><span class="sxs-lookup"><span data-stu-id="5ee98-625">Sample message</span></span>

<span data-ttu-id="5ee98-626">The following sample shows a telemetry message with both ReceivedMessages and Metrics parts:</span><span class="sxs-lookup"><span data-stu-id="5ee98-626">The following sample shows a telemetry message with both ReceivedMessages and Metrics parts:</span></span>

```HTML
Path: telemetry
Content-Type: application/json; charset=utf-8
X-RequestId: 123e4567e89b12d3a456426655440000
X-Timestamp: 2016-08-16T15:03:54.183Z

{
  "ReceivedMessages": [
    { "speech.hypothesis": [ "2016-08-16T15:03:48.171Z", "2016-08-16T15:03:48.331Z", "2016-08-16T15:03:48.881Z" ] },
    { "speech.endDetected": "2016-08-16T15:03:49.721Z" },
    { "speech.phrase": "2016-08-16T15:03:50.001Z" },
    { "turn.end": "2016-08-16T15:03:51.021Z" }
  ],
  "Metrics": [
    {
      "Name": "Connection",
      "Id": "A140CAF92F71469FA41C72C7B5849253",
      "Start": "2016-08-16T15:03:47.921Z",
      "End": "2016-08-16T15:03:48.000Z",
    },
    {
      "Name": "ListeningTrigger",
      "Start": "2016-08-16T15:03:48.776Z",
      "End": "2016-08-16T15:03:48.777Z",
    },
    {
      "Name": "Microphone",
      "Start": "2016-08-16T15:03:47.921Z",
      "End": "2016-08-16T15:03:51.921Z",
    },
  ],
}
```

## <a name="error-handling"></a><span data-ttu-id="5ee98-627">Error handling</span><span class="sxs-lookup"><span data-stu-id="5ee98-627">Error handling</span></span>

<span data-ttu-id="5ee98-628">This section describes the kinds of error messages and conditions that your application needs to handle.</span><span class="sxs-lookup"><span data-stu-id="5ee98-628">This section describes the kinds of error messages and conditions that your application needs to handle.</span></span>

### <a name="http-status-codes"></a><span data-ttu-id="5ee98-629">HTTP status codes</span><span class="sxs-lookup"><span data-stu-id="5ee98-629">HTTP status codes</span></span>

<span data-ttu-id="5ee98-630">During the WebSocket upgrade request, Speech Service might return any of the standard HTTP status codes, such as `400 Bad Request`, etc. Your application must correctly handle these error conditions.</span><span class="sxs-lookup"><span data-stu-id="5ee98-630">During the WebSocket upgrade request, Speech Service might return any of the standard HTTP status codes, such as `400 Bad Request`, etc. Your application must correctly handle these error conditions.</span></span>

#### <a name="authorization-errors"></a><span data-ttu-id="5ee98-631">Authorization errors</span><span class="sxs-lookup"><span data-stu-id="5ee98-631">Authorization errors</span></span>

<span data-ttu-id="5ee98-632">If incorrect authorization is provided during the WebSocket upgrade, Speech Service returns an HTTP `403 Forbidden` status code.</span><span class="sxs-lookup"><span data-stu-id="5ee98-632">If incorrect authorization is provided during the WebSocket upgrade, Speech Service returns an HTTP `403 Forbidden` status code.</span></span> <span data-ttu-id="5ee98-633">Among the conditions that can trigger this error code are:</span><span class="sxs-lookup"><span data-stu-id="5ee98-633">Among the conditions that can trigger this error code are:</span></span>

* <span data-ttu-id="5ee98-634">Missing *Authorization* header</span><span class="sxs-lookup"><span data-stu-id="5ee98-634">Missing *Authorization* header</span></span>

* <span data-ttu-id="5ee98-635">Invalid authorization token</span><span class="sxs-lookup"><span data-stu-id="5ee98-635">Invalid authorization token</span></span>

* <span data-ttu-id="5ee98-636">Expired authorization token</span><span class="sxs-lookup"><span data-stu-id="5ee98-636">Expired authorization token</span></span>

<span data-ttu-id="5ee98-637">The `403 Forbidden` error message doesn't indicate a problem with Speech Service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-637">The `403 Forbidden` error message doesn't indicate a problem with Speech Service.</span></span> <span data-ttu-id="5ee98-638">This error message indicates a problem with the client application.</span><span class="sxs-lookup"><span data-stu-id="5ee98-638">This error message indicates a problem with the client application.</span></span>

### <a name="protocol-violation-errors"></a><span data-ttu-id="5ee98-639">Protocol violation errors</span><span class="sxs-lookup"><span data-stu-id="5ee98-639">Protocol violation errors</span></span>

<span data-ttu-id="5ee98-640">If Speech Service detects any protocol violations from a client, the service terminates the WebSocket connection after returning a *status code* and *reason* for the termination.</span><span class="sxs-lookup"><span data-stu-id="5ee98-640">If Speech Service detects any protocol violations from a client, the service terminates the WebSocket connection after returning a *status code* and *reason* for the termination.</span></span> <span data-ttu-id="5ee98-641">Client applications can use this information to troubleshoot and fix the violations.</span><span class="sxs-lookup"><span data-stu-id="5ee98-641">Client applications can use this information to troubleshoot and fix the violations.</span></span>

#### <a name="incorrect-message-format"></a><span data-ttu-id="5ee98-642">Incorrect message format</span><span class="sxs-lookup"><span data-stu-id="5ee98-642">Incorrect message format</span></span>

<span data-ttu-id="5ee98-643">If a client sends a text or binary message to the service that is not encoded in the correct format given in this specification, the service closes the connection with a *1007 Invalid Payload Data* status code.</span><span class="sxs-lookup"><span data-stu-id="5ee98-643">If a client sends a text or binary message to the service that is not encoded in the correct format given in this specification, the service closes the connection with a *1007 Invalid Payload Data* status code.</span></span> 

<span data-ttu-id="5ee98-644">The service returns this status code for a variety of reasons, as shown in the following examples:</span><span class="sxs-lookup"><span data-stu-id="5ee98-644">The service returns this status code for a variety of reasons, as shown in the following examples:</span></span>

* <span data-ttu-id="5ee98-645">"Incorrect message format.</span><span class="sxs-lookup"><span data-stu-id="5ee98-645">"Incorrect message format.</span></span> <span data-ttu-id="5ee98-646">Binary message has invalid header size prefix."</span><span class="sxs-lookup"><span data-stu-id="5ee98-646">Binary message has invalid header size prefix."</span></span> <span data-ttu-id="5ee98-647">The client sent a binary message that has an invalid header size prefix.</span><span class="sxs-lookup"><span data-stu-id="5ee98-647">The client sent a binary message that has an invalid header size prefix.</span></span>

* <span data-ttu-id="5ee98-648">"Incorrect message format.</span><span class="sxs-lookup"><span data-stu-id="5ee98-648">"Incorrect message format.</span></span> <span data-ttu-id="5ee98-649">Binary message has invalid header size."</span><span class="sxs-lookup"><span data-stu-id="5ee98-649">Binary message has invalid header size."</span></span> <span data-ttu-id="5ee98-650">The client sent a binary message that specified an invalid header size.</span><span class="sxs-lookup"><span data-stu-id="5ee98-650">The client sent a binary message that specified an invalid header size.</span></span>

* <span data-ttu-id="5ee98-651">"Incorrect message format.</span><span class="sxs-lookup"><span data-stu-id="5ee98-651">"Incorrect message format.</span></span> <span data-ttu-id="5ee98-652">Binary message headers decoding into UTF-8 failed."</span><span class="sxs-lookup"><span data-stu-id="5ee98-652">Binary message headers decoding into UTF-8 failed."</span></span> <span data-ttu-id="5ee98-653">The client sent a binary message that contains headers that were not correctly encoded in UTF-8.</span><span class="sxs-lookup"><span data-stu-id="5ee98-653">The client sent a binary message that contains headers that were not correctly encoded in UTF-8.</span></span>

* <span data-ttu-id="5ee98-654">"Incorrect message format.</span><span class="sxs-lookup"><span data-stu-id="5ee98-654">"Incorrect message format.</span></span> <span data-ttu-id="5ee98-655">Text message contains no data."</span><span class="sxs-lookup"><span data-stu-id="5ee98-655">Text message contains no data."</span></span> <span data-ttu-id="5ee98-656">The client sent a text message that contains no body data.</span><span class="sxs-lookup"><span data-stu-id="5ee98-656">The client sent a text message that contains no body data.</span></span>

* <span data-ttu-id="5ee98-657">"Incorrect message format.</span><span class="sxs-lookup"><span data-stu-id="5ee98-657">"Incorrect message format.</span></span> <span data-ttu-id="5ee98-658">Text message decoding into UTF-8 failed."</span><span class="sxs-lookup"><span data-stu-id="5ee98-658">Text message decoding into UTF-8 failed."</span></span> <span data-ttu-id="5ee98-659">The client sent a text message that was not correctly encoded in UTF-8.</span><span class="sxs-lookup"><span data-stu-id="5ee98-659">The client sent a text message that was not correctly encoded in UTF-8.</span></span>

* <span data-ttu-id="5ee98-660">"Incorrect message format.</span><span class="sxs-lookup"><span data-stu-id="5ee98-660">"Incorrect message format.</span></span> <span data-ttu-id="5ee98-661">Text message contains no header separator."</span><span class="sxs-lookup"><span data-stu-id="5ee98-661">Text message contains no header separator."</span></span> <span data-ttu-id="5ee98-662">The client sent a text message that did not contain a header separator or used the wrong header separator.</span><span class="sxs-lookup"><span data-stu-id="5ee98-662">The client sent a text message that did not contain a header separator or used the wrong header separator.</span></span>

#### <a name="missing-or-empty-headers"></a><span data-ttu-id="5ee98-663">Missing or empty headers</span><span class="sxs-lookup"><span data-stu-id="5ee98-663">Missing or empty headers</span></span>

<span data-ttu-id="5ee98-664">If a client sends a message that doesn't have the required headers *X-RequestId* or *Path*, the service closes the connection with a *1002 Protocol Error* status code.</span><span class="sxs-lookup"><span data-stu-id="5ee98-664">If a client sends a message that doesn't have the required headers *X-RequestId* or *Path*, the service closes the connection with a *1002 Protocol Error* status code.</span></span> <span data-ttu-id="5ee98-665">The message is "Missing/Empty header.</span><span class="sxs-lookup"><span data-stu-id="5ee98-665">The message is "Missing/Empty header.</span></span> <span data-ttu-id="5ee98-666">{Header name}."</span><span class="sxs-lookup"><span data-stu-id="5ee98-666">{Header name}."</span></span>

#### <a name="requestid-values"></a><span data-ttu-id="5ee98-667">RequestId values</span><span class="sxs-lookup"><span data-stu-id="5ee98-667">RequestId values</span></span>

<span data-ttu-id="5ee98-668">If a client sends a message that specifies an *X-RequestId* header with an incorrect format, the service closes the connection and returns a *1002 Protocol Error* status.</span><span class="sxs-lookup"><span data-stu-id="5ee98-668">If a client sends a message that specifies an *X-RequestId* header with an incorrect format, the service closes the connection and returns a *1002 Protocol Error* status.</span></span> <span data-ttu-id="5ee98-669">The message is "Invalid request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-669">The message is "Invalid request.</span></span> <span data-ttu-id="5ee98-670">X-RequestId header value was not specified in no-dash UUID format."</span><span class="sxs-lookup"><span data-stu-id="5ee98-670">X-RequestId header value was not specified in no-dash UUID format."</span></span>

#### <a name="audio-encoding-errors"></a><span data-ttu-id="5ee98-671">Audio encoding errors</span><span class="sxs-lookup"><span data-stu-id="5ee98-671">Audio encoding errors</span></span>

<span data-ttu-id="5ee98-672">If a client sends an audio chunk that initiates a turn and the audio format or encoding doesn't conform to the required specification, the service closes the connection and returns a *1007 Invalid Payload Data* status code.</span><span class="sxs-lookup"><span data-stu-id="5ee98-672">If a client sends an audio chunk that initiates a turn and the audio format or encoding doesn't conform to the required specification, the service closes the connection and returns a *1007 Invalid Payload Data* status code.</span></span> <span data-ttu-id="5ee98-673">The message indicates the format encoding error source.</span><span class="sxs-lookup"><span data-stu-id="5ee98-673">The message indicates the format encoding error source.</span></span>

#### <a name="requestid-reuse"></a><span data-ttu-id="5ee98-674">RequestId reuse</span><span class="sxs-lookup"><span data-stu-id="5ee98-674">RequestId reuse</span></span>

<span data-ttu-id="5ee98-675">After a turn is finished, if a client sends a message that reuses the request identifier from that turn, the service closes the connection and returns a *1002 Protocol Error* status code.</span><span class="sxs-lookup"><span data-stu-id="5ee98-675">After a turn is finished, if a client sends a message that reuses the request identifier from that turn, the service closes the connection and returns a *1002 Protocol Error* status code.</span></span> <span data-ttu-id="5ee98-676">The message is "Invalid request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-676">The message is "Invalid request.</span></span> <span data-ttu-id="5ee98-677">Reuse of request identifiers is not allowed."</span><span class="sxs-lookup"><span data-stu-id="5ee98-677">Reuse of request identifiers is not allowed."</span></span>

## <a name="connection-failure-telemetry"></a><span data-ttu-id="5ee98-678">Connection failure telemetry</span><span class="sxs-lookup"><span data-stu-id="5ee98-678">Connection failure telemetry</span></span>

<span data-ttu-id="5ee98-679">To ensure the best possible user experience, clients must inform Speech Service of the time stamps for important checkpoints within a connection by using the *telemetry* message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-679">To ensure the best possible user experience, clients must inform Speech Service of the time stamps for important checkpoints within a connection by using the *telemetry* message.</span></span> <span data-ttu-id="5ee98-680">It's equally important that clients inform the service of connections that were attempted but failed.</span><span class="sxs-lookup"><span data-stu-id="5ee98-680">It's equally important that clients inform the service of connections that were attempted but failed.</span></span>

<span data-ttu-id="5ee98-681">For each connection attempt that failed, clients create a *telemetry* message with a unique *X-RequestId* header value.</span><span class="sxs-lookup"><span data-stu-id="5ee98-681">For each connection attempt that failed, clients create a *telemetry* message with a unique *X-RequestId* header value.</span></span> <span data-ttu-id="5ee98-682">Because the client was unable to establish a connection, the *ReceivedMessages* field in the JSON body can be omitted.</span><span class="sxs-lookup"><span data-stu-id="5ee98-682">Because the client was unable to establish a connection, the *ReceivedMessages* field in the JSON body can be omitted.</span></span> <span data-ttu-id="5ee98-683">Only the `Connection` entry in the *Metrics* field is included.</span><span class="sxs-lookup"><span data-stu-id="5ee98-683">Only the `Connection` entry in the *Metrics* field is included.</span></span> <span data-ttu-id="5ee98-684">This entry includes the start and end time stamps as well as the error condition that was encountered.</span><span class="sxs-lookup"><span data-stu-id="5ee98-684">This entry includes the start and end time stamps as well as the error condition that was encountered.</span></span>

### <a name="connection-retries-in-telemetry"></a><span data-ttu-id="5ee98-685">Connection retries in telemetry</span><span class="sxs-lookup"><span data-stu-id="5ee98-685">Connection retries in telemetry</span></span>

<span data-ttu-id="5ee98-686">Clients should distinguish *retries* from *multiple connection attempts* by the event that triggers the connection attempt.</span><span class="sxs-lookup"><span data-stu-id="5ee98-686">Clients should distinguish *retries* from *multiple connection attempts* by the event that triggers the connection attempt.</span></span> <span data-ttu-id="5ee98-687">Connection attempts that are carried out programmatically without any user input are retries.</span><span class="sxs-lookup"><span data-stu-id="5ee98-687">Connection attempts that are carried out programmatically without any user input are retries.</span></span> <span data-ttu-id="5ee98-688">Multiple connection attempts that are carried out in response to user input are multiple connection attempts.</span><span class="sxs-lookup"><span data-stu-id="5ee98-688">Multiple connection attempts that are carried out in response to user input are multiple connection attempts.</span></span> <span data-ttu-id="5ee98-689">Clients give each user-triggered connection attempt a unique *X-RequestId* and *telemetry* message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-689">Clients give each user-triggered connection attempt a unique *X-RequestId* and *telemetry* message.</span></span> <span data-ttu-id="5ee98-690">Clients reuse the *X-RequestId* for programmatic retries.</span><span class="sxs-lookup"><span data-stu-id="5ee98-690">Clients reuse the *X-RequestId* for programmatic retries.</span></span> <span data-ttu-id="5ee98-691">If multiple retries were made for a single connection attempt, each retry attempt is included as a `Connection` entry in the *telemetry* message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-691">If multiple retries were made for a single connection attempt, each retry attempt is included as a `Connection` entry in the *telemetry* message.</span></span>

<span data-ttu-id="5ee98-692">For example, suppose a user speaks the keyword trigger to start a connection and the first connection attempt fails because of DNS errors.</span><span class="sxs-lookup"><span data-stu-id="5ee98-692">For example, suppose a user speaks the keyword trigger to start a connection and the first connection attempt fails because of DNS errors.</span></span> <span data-ttu-id="5ee98-693">However, a second attempt that is made programmatically by the client succeeds.</span><span class="sxs-lookup"><span data-stu-id="5ee98-693">However, a second attempt that is made programmatically by the client succeeds.</span></span> <span data-ttu-id="5ee98-694">Because the client retried the connection without requiring additional input from the user, the client uses a single *telemetry* message with multiple `Connection` entries to describe the connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-694">Because the client retried the connection without requiring additional input from the user, the client uses a single *telemetry* message with multiple `Connection` entries to describe the connection.</span></span>

<span data-ttu-id="5ee98-695">As another example, suppose a user speaks the keyword trigger to start a connection and this connection attempt fails after three retries.</span><span class="sxs-lookup"><span data-stu-id="5ee98-695">As another example, suppose a user speaks the keyword trigger to start a connection and this connection attempt fails after three retries.</span></span> <span data-ttu-id="5ee98-696">The client then gives up, stops attempting to connect to the service, and informs the user that something went wrong.</span><span class="sxs-lookup"><span data-stu-id="5ee98-696">The client then gives up, stops attempting to connect to the service, and informs the user that something went wrong.</span></span> <span data-ttu-id="5ee98-697">The user then speaks the keyword trigger again.</span><span class="sxs-lookup"><span data-stu-id="5ee98-697">The user then speaks the keyword trigger again.</span></span> <span data-ttu-id="5ee98-698">This time, suppose the client connects to the service.</span><span class="sxs-lookup"><span data-stu-id="5ee98-698">This time, suppose the client connects to the service.</span></span> <span data-ttu-id="5ee98-699">After connecting, the client immediately sends a *telemetry* message to the service that contains three `Connection` entries that describe the connection failures.</span><span class="sxs-lookup"><span data-stu-id="5ee98-699">After connecting, the client immediately sends a *telemetry* message to the service that contains three `Connection` entries that describe the connection failures.</span></span> <span data-ttu-id="5ee98-700">After receiving the `turn.end` message, the client sends another *telemetry* message that describes the successful connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-700">After receiving the `turn.end` message, the client sends another *telemetry* message that describes the successful connection.</span></span>

## <a name="error-message-reference"></a><span data-ttu-id="5ee98-701">Error message reference</span><span class="sxs-lookup"><span data-stu-id="5ee98-701">Error message reference</span></span>

### <a name="http-status-codes"></a><span data-ttu-id="5ee98-702">HTTP status codes</span><span class="sxs-lookup"><span data-stu-id="5ee98-702">HTTP status codes</span></span>

| <span data-ttu-id="5ee98-703">HTTP status code</span><span class="sxs-lookup"><span data-stu-id="5ee98-703">HTTP status code</span></span> | <span data-ttu-id="5ee98-704">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-704">Description</span></span> | <span data-ttu-id="5ee98-705">Troubleshooting</span><span class="sxs-lookup"><span data-stu-id="5ee98-705">Troubleshooting</span></span> |
| - | - | - |
| <span data-ttu-id="5ee98-706">400 Bad Request</span><span class="sxs-lookup"><span data-stu-id="5ee98-706">400 Bad Request</span></span> | <span data-ttu-id="5ee98-707">The client sent a WebSocket connection request that was incorrect.</span><span class="sxs-lookup"><span data-stu-id="5ee98-707">The client sent a WebSocket connection request that was incorrect.</span></span> | <span data-ttu-id="5ee98-708">Check that you supplied all the required parameters and HTTP headers and that the values are correct.</span><span class="sxs-lookup"><span data-stu-id="5ee98-708">Check that you supplied all the required parameters and HTTP headers and that the values are correct.</span></span> |
| <span data-ttu-id="5ee98-709">401 Unauthorized</span><span class="sxs-lookup"><span data-stu-id="5ee98-709">401 Unauthorized</span></span> | <span data-ttu-id="5ee98-710">The client did not include the required authorization information.</span><span class="sxs-lookup"><span data-stu-id="5ee98-710">The client did not include the required authorization information.</span></span> | <span data-ttu-id="5ee98-711">Check that you're sending the *Authorization* header in the WebSocket connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-711">Check that you're sending the *Authorization* header in the WebSocket connection.</span></span> |
| <span data-ttu-id="5ee98-712">403 Forbidden</span><span class="sxs-lookup"><span data-stu-id="5ee98-712">403 Forbidden</span></span> | <span data-ttu-id="5ee98-713">The client sent authorization information, but it was invalid.</span><span class="sxs-lookup"><span data-stu-id="5ee98-713">The client sent authorization information, but it was invalid.</span></span> | <span data-ttu-id="5ee98-714">Check that you're not sending an expired or invalid value in the *Authorization* header.</span><span class="sxs-lookup"><span data-stu-id="5ee98-714">Check that you're not sending an expired or invalid value in the *Authorization* header.</span></span> |
| <span data-ttu-id="5ee98-715">404 Not Found</span><span class="sxs-lookup"><span data-stu-id="5ee98-715">404 Not Found</span></span> | <span data-ttu-id="5ee98-716">The client attempted to access a URL path that is not supported.</span><span class="sxs-lookup"><span data-stu-id="5ee98-716">The client attempted to access a URL path that is not supported.</span></span> | <span data-ttu-id="5ee98-717">Check that you're using the correct URL for the WebSocket connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-717">Check that you're using the correct URL for the WebSocket connection.</span></span> |
| <span data-ttu-id="5ee98-718">500 Server Error</span><span class="sxs-lookup"><span data-stu-id="5ee98-718">500 Server Error</span></span> | <span data-ttu-id="5ee98-719">The service encountered an internal error and could not satisfy the request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-719">The service encountered an internal error and could not satisfy the request.</span></span> | <span data-ttu-id="5ee98-720">In most cases, this error is transient.</span><span class="sxs-lookup"><span data-stu-id="5ee98-720">In most cases, this error is transient.</span></span> <span data-ttu-id="5ee98-721">Retry the request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-721">Retry the request.</span></span> |
| <span data-ttu-id="5ee98-722">503 Service Unavailable</span><span class="sxs-lookup"><span data-stu-id="5ee98-722">503 Service Unavailable</span></span> | <span data-ttu-id="5ee98-723">The service was unavailable to handle the request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-723">The service was unavailable to handle the request.</span></span> | <span data-ttu-id="5ee98-724">In most cases, this error is transient.</span><span class="sxs-lookup"><span data-stu-id="5ee98-724">In most cases, this error is transient.</span></span> <span data-ttu-id="5ee98-725">Retry the request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-725">Retry the request.</span></span> |

### <a name="websocket-error-codes"></a><span data-ttu-id="5ee98-726">WebSocket error codes</span><span class="sxs-lookup"><span data-stu-id="5ee98-726">WebSocket error codes</span></span>

| <span data-ttu-id="5ee98-727">WebSocketsStatus code</span><span class="sxs-lookup"><span data-stu-id="5ee98-727">WebSocketsStatus code</span></span> | <span data-ttu-id="5ee98-728">Description</span><span class="sxs-lookup"><span data-stu-id="5ee98-728">Description</span></span> | <span data-ttu-id="5ee98-729">Troubleshooting</span><span class="sxs-lookup"><span data-stu-id="5ee98-729">Troubleshooting</span></span> |
| - | - | - |
| <span data-ttu-id="5ee98-730">1000 Normal Closure</span><span class="sxs-lookup"><span data-stu-id="5ee98-730">1000 Normal Closure</span></span> | <span data-ttu-id="5ee98-731">The service closed the WebSocket connection without an error.</span><span class="sxs-lookup"><span data-stu-id="5ee98-731">The service closed the WebSocket connection without an error.</span></span> | <span data-ttu-id="5ee98-732">If the WebSocket closure was unexpected, reread the documentation to ensure that you understand how and when the service can terminate the WebSocket connection.</span><span class="sxs-lookup"><span data-stu-id="5ee98-732">If the WebSocket closure was unexpected, reread the documentation to ensure that you understand how and when the service can terminate the WebSocket connection.</span></span> |
| <span data-ttu-id="5ee98-733">1002 Protocol Error</span><span class="sxs-lookup"><span data-stu-id="5ee98-733">1002 Protocol Error</span></span> | <span data-ttu-id="5ee98-734">The client failed to adhere to protocol requirements.</span><span class="sxs-lookup"><span data-stu-id="5ee98-734">The client failed to adhere to protocol requirements.</span></span> | <span data-ttu-id="5ee98-735">Ensure that you understand the protocol documentation and are clear about the requirements.</span><span class="sxs-lookup"><span data-stu-id="5ee98-735">Ensure that you understand the protocol documentation and are clear about the requirements.</span></span> <span data-ttu-id="5ee98-736">Read the previous documentation about error reasons to see if you're violating protocol requirements.</span><span class="sxs-lookup"><span data-stu-id="5ee98-736">Read the previous documentation about error reasons to see if you're violating protocol requirements.</span></span> |
| <span data-ttu-id="5ee98-737">1007 Invalid Payload Data</span><span class="sxs-lookup"><span data-stu-id="5ee98-737">1007 Invalid Payload Data</span></span> | <span data-ttu-id="5ee98-738">The client sent an invalid payload in a protocol message.</span><span class="sxs-lookup"><span data-stu-id="5ee98-738">The client sent an invalid payload in a protocol message.</span></span> | <span data-ttu-id="5ee98-739">Check the last message that you sent to the service for errors.</span><span class="sxs-lookup"><span data-stu-id="5ee98-739">Check the last message that you sent to the service for errors.</span></span> <span data-ttu-id="5ee98-740">Read the previous documentation about payload errors.</span><span class="sxs-lookup"><span data-stu-id="5ee98-740">Read the previous documentation about payload errors.</span></span> |
| <span data-ttu-id="5ee98-741">1011 Server Error</span><span class="sxs-lookup"><span data-stu-id="5ee98-741">1011 Server Error</span></span> | <span data-ttu-id="5ee98-742">The service encountered an internal error and could not satisfy the request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-742">The service encountered an internal error and could not satisfy the request.</span></span> | <span data-ttu-id="5ee98-743">In most cases, this error is transient.</span><span class="sxs-lookup"><span data-stu-id="5ee98-743">In most cases, this error is transient.</span></span> <span data-ttu-id="5ee98-744">Retry the request.</span><span class="sxs-lookup"><span data-stu-id="5ee98-744">Retry the request.</span></span> |

## <a name="related-topics"></a><span data-ttu-id="5ee98-745">Related topics</span><span class="sxs-lookup"><span data-stu-id="5ee98-745">Related topics</span></span>

<span data-ttu-id="5ee98-746">See a [JavaScript SDK](https://github.com/Azure-Samples/SpeechToText-WebSockets-Javascript) that is an implementation of the WebSocket-based Speech Service protocol.</span><span class="sxs-lookup"><span data-stu-id="5ee98-746">See a [JavaScript SDK](https://github.com/Azure-Samples/SpeechToText-WebSockets-Javascript) that is an implementation of the WebSocket-based Speech Service protocol.</span></span>
