---
title: Plan capacity and scaling for VMware replication to Azure | Microsoft Docs
description: Use this article to plan capacity and scale when replicating VMware VMs to Azure
services: site-recovery
documentationcenter: ''
author: rayne-wiselman
manager: jwhit
editor: ''
ms.assetid: 0a1cd8eb-a8f7-4228-ab84-9449e0b2887b
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 02/05/2017
ms.author: rayne
ms.openlocfilehash: b0144920dd70bf2f14643c28aa2e26e1fe278b63
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44556431"
---
# <a name="plan-capacity-and-scaling-for-vmware-replication-with-azure-site-recovery"></a><span data-ttu-id="ace43-103">Plan capacity and scaling for VMware replication with Azure Site Recovery</span><span class="sxs-lookup"><span data-stu-id="ace43-103">Plan capacity and scaling for VMware replication with Azure Site Recovery</span></span>

<span data-ttu-id="ace43-104">Use this article to figure out how to plan capacity and scaling when replicating on-premises VMware VMs and physical servers to Azure, with [Azure Site Recovery](site-recovery-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ace43-104">Use this article to figure out how to plan capacity and scaling when replicating on-premises VMware VMs and physical servers to Azure, with [Azure Site Recovery](site-recovery-overview.md).</span></span>

## <a name="how-do-i-start-capacity-planning"></a><span data-ttu-id="ace43-105">How do I start capacity planning?</span><span class="sxs-lookup"><span data-stu-id="ace43-105">How do I start capacity planning?</span></span>

<span data-ttu-id="ace43-106">Gather information about your replication environment by using the [Azure Site Recovery Deployment Planner](https://aka.ms/asr-deployment-planner-doc).</span><span class="sxs-lookup"><span data-stu-id="ace43-106">Gather information about your replication environment by using the [Azure Site Recovery Deployment Planner](https://aka.ms/asr-deployment-planner-doc).</span></span> <span data-ttu-id="ace43-107">This includes information about the number of virtual machines that are compatible and incompatible, disks per VM, and data churn per disk.</span><span class="sxs-lookup"><span data-stu-id="ace43-107">This includes information about the number of virtual machines that are compatible and incompatible, disks per VM, and data churn per disk.</span></span> <span data-ttu-id="ace43-108">It also covers the network bandwidth requirement, and required Azure infrastructure for successful replication and test failover.</span><span class="sxs-lookup"><span data-stu-id="ace43-108">It also covers the network bandwidth requirement, and required Azure infrastructure for successful replication and test failover.</span></span>

## <a name="capacity-considerations"></a><span data-ttu-id="ace43-109">Capacity considerations</span><span class="sxs-lookup"><span data-stu-id="ace43-109">Capacity considerations</span></span>

<span data-ttu-id="ace43-110">**Component**</span><span class="sxs-lookup"><span data-stu-id="ace43-110">**Component**</span></span> | <span data-ttu-id="ace43-111">**Details**</span><span class="sxs-lookup"><span data-stu-id="ace43-111">**Details**</span></span> |
--- | --- | ---
<span data-ttu-id="ace43-112">**Replication**</span><span class="sxs-lookup"><span data-stu-id="ace43-112">**Replication**</span></span> | <span data-ttu-id="ace43-113">**Maximum daily change rate:** A protected machine can only use one process server, and a single process server can handle a daily change rate up to 2 TB.</span><span class="sxs-lookup"><span data-stu-id="ace43-113">**Maximum daily change rate:** A protected machine can only use one process server, and a single process server can handle a daily change rate up to 2 TB.</span></span> <span data-ttu-id="ace43-114">Thus 2 TB is the maximum daily data change rate that’s supported for a protected machine.</span><span class="sxs-lookup"><span data-stu-id="ace43-114">Thus 2 TB is the maximum daily data change rate that’s supported for a protected machine.</span></span><br/><br/> <span data-ttu-id="ace43-115">**Maximum throughput:** A replicated machine can belong to one storage account in Azure.</span><span class="sxs-lookup"><span data-stu-id="ace43-115">**Maximum throughput:** A replicated machine can belong to one storage account in Azure.</span></span> <span data-ttu-id="ace43-116">A standard storage account can handle a maximum of 20,000 requests per second, and we recommend that you keep the number of input/output operations per second (IOPS) across a source machine to 20,000.</span><span class="sxs-lookup"><span data-stu-id="ace43-116">A standard storage account can handle a maximum of 20,000 requests per second, and we recommend that you keep the number of input/output operations per second (IOPS) across a source machine to 20,000.</span></span> <span data-ttu-id="ace43-117">For example, if you have a source machine with 5 disks, and each disk generates 120 IOPS (8K size) on the source machine, then it will be within the Azure per disk IOPS limit of 500.</span><span class="sxs-lookup"><span data-stu-id="ace43-117">For example, if you have a source machine with 5 disks, and each disk generates 120 IOPS (8K size) on the source machine, then it will be within the Azure per disk IOPS limit of 500.</span></span> <span data-ttu-id="ace43-118">(The number of storage accounts required is equal to the total source machine IOPS, divided by 20,000.)</span><span class="sxs-lookup"><span data-stu-id="ace43-118">(The number of storage accounts required is equal to the total source machine IOPS, divided by 20,000.)</span></span>
<span data-ttu-id="ace43-119">**Configuration server**</span><span class="sxs-lookup"><span data-stu-id="ace43-119">**Configuration server**</span></span> | <span data-ttu-id="ace43-120">The configuration server should be able to handle the daily change rate capacity across all workloads running on protected machines, and needs sufficient bandwidth to continuously replicate data to Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="ace43-120">The configuration server should be able to handle the daily change rate capacity across all workloads running on protected machines, and needs sufficient bandwidth to continuously replicate data to Azure Storage.</span></span><br/><br/> <span data-ttu-id="ace43-121">As a best practice, locate the configuration server on the same network and LAN segment as the machines you want to protect.</span><span class="sxs-lookup"><span data-stu-id="ace43-121">As a best practice, locate the configuration server on the same network and LAN segment as the machines you want to protect.</span></span> <span data-ttu-id="ace43-122">It can be located on a different network, but machines you want to protect should have layer 3 network visibility to it.</span><span class="sxs-lookup"><span data-stu-id="ace43-122">It can be located on a different network, but machines you want to protect should have layer 3 network visibility to it.</span></span><br/><br/> <span data-ttu-id="ace43-123">Size recommendations for the configuration server are summarized in the table in the following section.</span><span class="sxs-lookup"><span data-stu-id="ace43-123">Size recommendations for the configuration server are summarized in the table in the following section.</span></span>
<span data-ttu-id="ace43-124">**Process server**</span><span class="sxs-lookup"><span data-stu-id="ace43-124">**Process server**</span></span> | <span data-ttu-id="ace43-125">The first process server is installed by default on the configuration server.</span><span class="sxs-lookup"><span data-stu-id="ace43-125">The first process server is installed by default on the configuration server.</span></span> <span data-ttu-id="ace43-126">You can deploy additional process servers to scale your environment.</span><span class="sxs-lookup"><span data-stu-id="ace43-126">You can deploy additional process servers to scale your environment.</span></span> <br/><br/> <span data-ttu-id="ace43-127">The process server receives replication data from protected machines, and optimizes it with caching, compression, and encryption.</span><span class="sxs-lookup"><span data-stu-id="ace43-127">The process server receives replication data from protected machines, and optimizes it with caching, compression, and encryption.</span></span> <span data-ttu-id="ace43-128">Then it sends the data to Azure.</span><span class="sxs-lookup"><span data-stu-id="ace43-128">Then it sends the data to Azure.</span></span> <span data-ttu-id="ace43-129">The process server machine should have sufficient resources to perform these tasks.</span><span class="sxs-lookup"><span data-stu-id="ace43-129">The process server machine should have sufficient resources to perform these tasks.</span></span><br/><br/> <span data-ttu-id="ace43-130">The process server uses a disk-based cache.</span><span class="sxs-lookup"><span data-stu-id="ace43-130">The process server uses a disk-based cache.</span></span> <span data-ttu-id="ace43-131">Use a separate cache disk of 600 GB or more to handle data changes stored in the event of a network bottleneck or outage.</span><span class="sxs-lookup"><span data-stu-id="ace43-131">Use a separate cache disk of 600 GB or more to handle data changes stored in the event of a network bottleneck or outage.</span></span>

## <a name="size-recommendations-for-the-configuration-server"></a><span data-ttu-id="ace43-132">Size recommendations for the configuration server</span><span class="sxs-lookup"><span data-stu-id="ace43-132">Size recommendations for the configuration server</span></span>

<span data-ttu-id="ace43-133">**CPU**</span><span class="sxs-lookup"><span data-stu-id="ace43-133">**CPU**</span></span> | <span data-ttu-id="ace43-134">**Memory**</span><span class="sxs-lookup"><span data-stu-id="ace43-134">**Memory**</span></span> | <span data-ttu-id="ace43-135">**Cache disk size**</span><span class="sxs-lookup"><span data-stu-id="ace43-135">**Cache disk size**</span></span> | <span data-ttu-id="ace43-136">**Data change rate**</span><span class="sxs-lookup"><span data-stu-id="ace43-136">**Data change rate**</span></span> | <span data-ttu-id="ace43-137">**Protected machines**</span><span class="sxs-lookup"><span data-stu-id="ace43-137">**Protected machines**</span></span>
--- | --- | --- | --- | ---
<span data-ttu-id="ace43-138">8 vCPUs (2 sockets \* 4 cores @ 2.5 gigahertz [GHz])</span><span class="sxs-lookup"><span data-stu-id="ace43-138">8 vCPUs (2 sockets \* 4 cores @ 2.5 gigahertz [GHz])</span></span> | <span data-ttu-id="ace43-139">16 GB</span><span class="sxs-lookup"><span data-stu-id="ace43-139">16 GB</span></span> | <span data-ttu-id="ace43-140">300 GB</span><span class="sxs-lookup"><span data-stu-id="ace43-140">300 GB</span></span> | <span data-ttu-id="ace43-141">500 GB or less</span><span class="sxs-lookup"><span data-stu-id="ace43-141">500 GB or less</span></span> | <span data-ttu-id="ace43-142">Replicate less than 100 machines.</span><span class="sxs-lookup"><span data-stu-id="ace43-142">Replicate less than 100 machines.</span></span>
<span data-ttu-id="ace43-143">12 vCPUs (2 sockets \* 6 cores @ 2.5 GHz)</span><span class="sxs-lookup"><span data-stu-id="ace43-143">12 vCPUs (2 sockets \* 6 cores @ 2.5 GHz)</span></span> | <span data-ttu-id="ace43-144">18 GB</span><span class="sxs-lookup"><span data-stu-id="ace43-144">18 GB</span></span> | <span data-ttu-id="ace43-145">600 GB</span><span class="sxs-lookup"><span data-stu-id="ace43-145">600 GB</span></span> | <span data-ttu-id="ace43-146">500 GB to 1 TB</span><span class="sxs-lookup"><span data-stu-id="ace43-146">500 GB to 1 TB</span></span> | <span data-ttu-id="ace43-147">Replicate between 100-150 machines.</span><span class="sxs-lookup"><span data-stu-id="ace43-147">Replicate between 100-150 machines.</span></span>
<span data-ttu-id="ace43-148">16 vCPUs (2 sockets \* 8 cores @ 2.5 GHz)</span><span class="sxs-lookup"><span data-stu-id="ace43-148">16 vCPUs (2 sockets \* 8 cores @ 2.5 GHz)</span></span> | <span data-ttu-id="ace43-149">32 GB</span><span class="sxs-lookup"><span data-stu-id="ace43-149">32 GB</span></span> | <span data-ttu-id="ace43-150">1 TB</span><span class="sxs-lookup"><span data-stu-id="ace43-150">1 TB</span></span> | <span data-ttu-id="ace43-151">1 TB to 2 TB</span><span class="sxs-lookup"><span data-stu-id="ace43-151">1 TB to 2 TB</span></span> | <span data-ttu-id="ace43-152">Replicate between 150-200 machines.</span><span class="sxs-lookup"><span data-stu-id="ace43-152">Replicate between 150-200 machines.</span></span>
<span data-ttu-id="ace43-153">Deploy another process server</span><span class="sxs-lookup"><span data-stu-id="ace43-153">Deploy another process server</span></span> | | | <span data-ttu-id="ace43-154">> 2 TB</span><span class="sxs-lookup"><span data-stu-id="ace43-154">> 2 TB</span></span> | <span data-ttu-id="ace43-155">Deploy additional process servers if you're replicating more than 200 machines, or if the daily data change rate exceeds 2 TB.</span><span class="sxs-lookup"><span data-stu-id="ace43-155">Deploy additional process servers if you're replicating more than 200 machines, or if the daily data change rate exceeds 2 TB.</span></span>

<span data-ttu-id="ace43-156">Where:</span><span class="sxs-lookup"><span data-stu-id="ace43-156">Where:</span></span>

* <span data-ttu-id="ace43-157">Each source machine is configured with 3 disks of 100 GB each.</span><span class="sxs-lookup"><span data-stu-id="ace43-157">Each source machine is configured with 3 disks of 100 GB each.</span></span>
* <span data-ttu-id="ace43-158">We used benchmarking storage of 8 SAS drives of 10 K RPM, with RAID 10, for cache disk measurements.</span><span class="sxs-lookup"><span data-stu-id="ace43-158">We used benchmarking storage of 8 SAS drives of 10 K RPM, with RAID 10, for cache disk measurements.</span></span>

## <a name="size-recommendations-for-the-process-server"></a><span data-ttu-id="ace43-159">Size recommendations for the process server</span><span class="sxs-lookup"><span data-stu-id="ace43-159">Size recommendations for the process server</span></span>

<span data-ttu-id="ace43-160">If you need to protect more than 200 machines, or the daily change rate is greater than 2 TB, you can add process servers to handle the replication load.</span><span class="sxs-lookup"><span data-stu-id="ace43-160">If you need to protect more than 200 machines, or the daily change rate is greater than 2 TB, you can add process servers to handle the replication load.</span></span> <span data-ttu-id="ace43-161">To scale out, you can:</span><span class="sxs-lookup"><span data-stu-id="ace43-161">To scale out, you can:</span></span>

* <span data-ttu-id="ace43-162">Increase the number of configuration servers.</span><span class="sxs-lookup"><span data-stu-id="ace43-162">Increase the number of configuration servers.</span></span> <span data-ttu-id="ace43-163">For example, you can protect up to 400 machines with two configuration servers.</span><span class="sxs-lookup"><span data-stu-id="ace43-163">For example, you can protect up to 400 machines with two configuration servers.</span></span>
* <span data-ttu-id="ace43-164">Add more process servers, and use these to handle traffic instead of (or in addition to) the configuration server.</span><span class="sxs-lookup"><span data-stu-id="ace43-164">Add more process servers, and use these to handle traffic instead of (or in addition to) the configuration server.</span></span>

<span data-ttu-id="ace43-165">The following table describes a scenario in which:</span><span class="sxs-lookup"><span data-stu-id="ace43-165">The following table describes a scenario in which:</span></span>

* <span data-ttu-id="ace43-166">You're not planning to use the configuration server as a process server.</span><span class="sxs-lookup"><span data-stu-id="ace43-166">You're not planning to use the configuration server as a process server.</span></span>
* <span data-ttu-id="ace43-167">You've set up an additional process server.</span><span class="sxs-lookup"><span data-stu-id="ace43-167">You've set up an additional process server.</span></span>
* <span data-ttu-id="ace43-168">You've configured protected virtual machines to use the additional process server.</span><span class="sxs-lookup"><span data-stu-id="ace43-168">You've configured protected virtual machines to use the additional process server.</span></span>
* <span data-ttu-id="ace43-169">Each protected source machine is configured with three disks of 100 GB each.</span><span class="sxs-lookup"><span data-stu-id="ace43-169">Each protected source machine is configured with three disks of 100 GB each.</span></span>

<span data-ttu-id="ace43-170">**Configuration server**</span><span class="sxs-lookup"><span data-stu-id="ace43-170">**Configuration server**</span></span> | <span data-ttu-id="ace43-171">**Additional process server**</span><span class="sxs-lookup"><span data-stu-id="ace43-171">**Additional process server**</span></span> | <span data-ttu-id="ace43-172">**Cache disk size**</span><span class="sxs-lookup"><span data-stu-id="ace43-172">**Cache disk size**</span></span> | <span data-ttu-id="ace43-173">**Data change rate**</span><span class="sxs-lookup"><span data-stu-id="ace43-173">**Data change rate**</span></span> | <span data-ttu-id="ace43-174">**Protected machines**</span><span class="sxs-lookup"><span data-stu-id="ace43-174">**Protected machines**</span></span>
--- | --- | --- | --- | ---
<span data-ttu-id="ace43-175">8 vCPUs (2 sockets \* 4 cores @ 2.5 GHz), 16 GB memory</span><span class="sxs-lookup"><span data-stu-id="ace43-175">8 vCPUs (2 sockets \* 4 cores @ 2.5 GHz), 16 GB memory</span></span> | <span data-ttu-id="ace43-176">4 vCPUs (2 sockets \* 2 cores @ 2.5 GHz), 8 GB memory</span><span class="sxs-lookup"><span data-stu-id="ace43-176">4 vCPUs (2 sockets \* 2 cores @ 2.5 GHz), 8 GB memory</span></span> | <span data-ttu-id="ace43-177">300 GB</span><span class="sxs-lookup"><span data-stu-id="ace43-177">300 GB</span></span> | <span data-ttu-id="ace43-178">250 GB or less</span><span class="sxs-lookup"><span data-stu-id="ace43-178">250 GB or less</span></span> | <span data-ttu-id="ace43-179">Replicate 85 or fewer machines.</span><span class="sxs-lookup"><span data-stu-id="ace43-179">Replicate 85 or fewer machines.</span></span>
<span data-ttu-id="ace43-180">8 vCPUs (2 sockets \* 4 cores @ 2.5 GHz), 16 GB memory</span><span class="sxs-lookup"><span data-stu-id="ace43-180">8 vCPUs (2 sockets \* 4 cores @ 2.5 GHz), 16 GB memory</span></span> | <span data-ttu-id="ace43-181">8 vCPUs (2 sockets \* 4 cores @ 2.5 GHz), 12 GB memory</span><span class="sxs-lookup"><span data-stu-id="ace43-181">8 vCPUs (2 sockets \* 4 cores @ 2.5 GHz), 12 GB memory</span></span> | <span data-ttu-id="ace43-182">600 GB</span><span class="sxs-lookup"><span data-stu-id="ace43-182">600 GB</span></span> | <span data-ttu-id="ace43-183">250 GB to 1 TB</span><span class="sxs-lookup"><span data-stu-id="ace43-183">250 GB to 1 TB</span></span> | <span data-ttu-id="ace43-184">Replicate between 85-150 machines.</span><span class="sxs-lookup"><span data-stu-id="ace43-184">Replicate between 85-150 machines.</span></span>
<span data-ttu-id="ace43-185">12 vCPUs (2 sockets \* 6 cores @ 2.5 GHz), 18 GB memory</span><span class="sxs-lookup"><span data-stu-id="ace43-185">12 vCPUs (2 sockets \* 6 cores @ 2.5 GHz), 18 GB memory</span></span> | <span data-ttu-id="ace43-186">12 vCPUs (2 sockets \* 6 cores @ 2.5 GHz) 24 GB memory</span><span class="sxs-lookup"><span data-stu-id="ace43-186">12 vCPUs (2 sockets \* 6 cores @ 2.5 GHz) 24 GB memory</span></span> | <span data-ttu-id="ace43-187">1 TB</span><span class="sxs-lookup"><span data-stu-id="ace43-187">1 TB</span></span> | <span data-ttu-id="ace43-188">1 TB to 2 TB</span><span class="sxs-lookup"><span data-stu-id="ace43-188">1 TB to 2 TB</span></span> | <span data-ttu-id="ace43-189">Replicate between 150-225 machines.</span><span class="sxs-lookup"><span data-stu-id="ace43-189">Replicate between 150-225 machines.</span></span>

<span data-ttu-id="ace43-190">The way in which you scale your servers depends on your preference for a scale-up or scale-out model.</span><span class="sxs-lookup"><span data-stu-id="ace43-190">The way in which you scale your servers depends on your preference for a scale-up or scale-out model.</span></span>  <span data-ttu-id="ace43-191">You scale up by deploying a few high-end configuration and process servers, or scale out by deploying more servers with fewer resources.</span><span class="sxs-lookup"><span data-stu-id="ace43-191">You scale up by deploying a few high-end configuration and process servers, or scale out by deploying more servers with fewer resources.</span></span> <span data-ttu-id="ace43-192">For example, if you need to protect 220 machines, you could do either of the following:</span><span class="sxs-lookup"><span data-stu-id="ace43-192">For example, if you need to protect 220 machines, you could do either of the following:</span></span>

* <span data-ttu-id="ace43-193">Set up the configuration server with 12 vCPU, 18 GB of memory, and an additional process server with 12 vCPU, 24 GB of memory.</span><span class="sxs-lookup"><span data-stu-id="ace43-193">Set up the configuration server with 12 vCPU, 18 GB of memory, and an additional process server with 12 vCPU, 24 GB of memory.</span></span> <span data-ttu-id="ace43-194">Configure protected machines to use the additional process server only.</span><span class="sxs-lookup"><span data-stu-id="ace43-194">Configure protected machines to use the additional process server only.</span></span>
* <span data-ttu-id="ace43-195">Set up two configuration servers (2 x 8 vCPU, 16 GB RAM) and two additional process servers (1 x 8 vCPU and 4 vCPU x 1 to handle 135 + 85 [220] machines).</span><span class="sxs-lookup"><span data-stu-id="ace43-195">Set up two configuration servers (2 x 8 vCPU, 16 GB RAM) and two additional process servers (1 x 8 vCPU and 4 vCPU x 1 to handle 135 + 85 [220] machines).</span></span> <span data-ttu-id="ace43-196">Configure protected machines to use the additional process servers only.</span><span class="sxs-lookup"><span data-stu-id="ace43-196">Configure protected machines to use the additional process servers only.</span></span>


## <a name="control-network-bandwidth"></a><span data-ttu-id="ace43-197">Control network bandwidth</span><span class="sxs-lookup"><span data-stu-id="ace43-197">Control network bandwidth</span></span>

<span data-ttu-id="ace43-198">You can use [the deployment planner tool](https://aka.ms/asr-deployment-planner-doc) to calculate the bandwidth you need for replication (including the initial replication, and then the delta).</span><span class="sxs-lookup"><span data-stu-id="ace43-198">You can use [the deployment planner tool](https://aka.ms/asr-deployment-planner-doc) to calculate the bandwidth you need for replication (including the initial replication, and then the delta).</span></span> <span data-ttu-id="ace43-199">To control the amount of bandwidth used for replication, you have a few options:</span><span class="sxs-lookup"><span data-stu-id="ace43-199">To control the amount of bandwidth used for replication, you have a few options:</span></span>

* <span data-ttu-id="ace43-200">**Throttle bandwidth**: VMware traffic that replicates to Azure goes through a specific process server.</span><span class="sxs-lookup"><span data-stu-id="ace43-200">**Throttle bandwidth**: VMware traffic that replicates to Azure goes through a specific process server.</span></span> <span data-ttu-id="ace43-201">You can throttle bandwidth on the machines running as process servers.</span><span class="sxs-lookup"><span data-stu-id="ace43-201">You can throttle bandwidth on the machines running as process servers.</span></span>
* <span data-ttu-id="ace43-202">**Influence bandwidth**: You can influence the bandwidth used for replication by using a couple of registry keys:</span><span class="sxs-lookup"><span data-stu-id="ace43-202">**Influence bandwidth**: You can influence the bandwidth used for replication by using a couple of registry keys:</span></span>
  * <span data-ttu-id="ace43-203">The **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Azure Backup\UploadThreadsPerVM** registry value specifies the number of threads that are used for data transfer (initial or delta replication) of a disk.</span><span class="sxs-lookup"><span data-stu-id="ace43-203">The **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Azure Backup\UploadThreadsPerVM** registry value specifies the number of threads that are used for data transfer (initial or delta replication) of a disk.</span></span> <span data-ttu-id="ace43-204">A higher value increases the network bandwidth used for replication.</span><span class="sxs-lookup"><span data-stu-id="ace43-204">A higher value increases the network bandwidth used for replication.</span></span>
  * <span data-ttu-id="ace43-205">The **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Azure Backup\DownloadThreadsPerVM** specifies the number of threads used for data transfer during failback.</span><span class="sxs-lookup"><span data-stu-id="ace43-205">The **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Azure Backup\DownloadThreadsPerVM** specifies the number of threads used for data transfer during failback.</span></span>

### <a name="throttle-bandwidth"></a><span data-ttu-id="ace43-206">Throttle bandwidth</span><span class="sxs-lookup"><span data-stu-id="ace43-206">Throttle bandwidth</span></span>
1. <span data-ttu-id="ace43-207">Open the Azure Backup MMC snap-in on the machine acting as the process server.</span><span class="sxs-lookup"><span data-stu-id="ace43-207">Open the Azure Backup MMC snap-in on the machine acting as the process server.</span></span> <span data-ttu-id="ace43-208">By default, a shortcut for Backup is available on the desktop, or in the following folder: C:\Program Files\Microsoft Azure Recovery Services Agent\bin\wabadmin.</span><span class="sxs-lookup"><span data-stu-id="ace43-208">By default, a shortcut for Backup is available on the desktop, or in the following folder: C:\Program Files\Microsoft Azure Recovery Services Agent\bin\wabadmin.</span></span>
2. <span data-ttu-id="ace43-209">In the snap-in, click **Change Properties**.</span><span class="sxs-lookup"><span data-stu-id="ace43-209">In the snap-in, click **Change Properties**.</span></span>

    ![Screenshot of Azure Backup MMC snap-in option to change properties](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-vmware-to-azure/throttle1.png)
3. <span data-ttu-id="ace43-211">On the **Throttling** tab, select **Enable internet bandwidth usage throttling for backup operations**.</span><span class="sxs-lookup"><span data-stu-id="ace43-211">On the **Throttling** tab, select **Enable internet bandwidth usage throttling for backup operations**.</span></span> <span data-ttu-id="ace43-212">Set the limits for work and non-work hours.</span><span class="sxs-lookup"><span data-stu-id="ace43-212">Set the limits for work and non-work hours.</span></span> <span data-ttu-id="ace43-213">Valid ranges are from 512 Kbps to 102 Mbps per second.</span><span class="sxs-lookup"><span data-stu-id="ace43-213">Valid ranges are from 512 Kbps to 102 Mbps per second.</span></span>

    ![Screenshot of Azure Backup Properties dialog box](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-vmware-to-azure/throttle2.png)

<span data-ttu-id="ace43-215">You can also use the [Set-OBMachineSetting](https://technet.microsoft.com/library/hh770409.aspx) cmdlet to set throttling.</span><span class="sxs-lookup"><span data-stu-id="ace43-215">You can also use the [Set-OBMachineSetting](https://technet.microsoft.com/library/hh770409.aspx) cmdlet to set throttling.</span></span> <span data-ttu-id="ace43-216">Here's a sample:</span><span class="sxs-lookup"><span data-stu-id="ace43-216">Here's a sample:</span></span>

    $mon = [System.DayOfWeek]::Monday
    $tue = [System.DayOfWeek]::Tuesday
    Set-OBMachineSetting -WorkDay $mon, $tue -StartWorkHour "9:00:00" -EndWorkHour "18:00:00" -WorkHourBandwidth  (512*1024) -NonWorkHourBandwidth (2048*1024)

<span data-ttu-id="ace43-217">**Set-OBMachineSetting -NoThrottle** indicates that no throttling is required.</span><span class="sxs-lookup"><span data-stu-id="ace43-217">**Set-OBMachineSetting -NoThrottle** indicates that no throttling is required.</span></span>

### <a name="influence-network-bandwidth-for-a-vm"></a><span data-ttu-id="ace43-218">Influence network bandwidth for a VM</span><span class="sxs-lookup"><span data-stu-id="ace43-218">Influence network bandwidth for a VM</span></span>

1. <span data-ttu-id="ace43-219">In the VM's registry, navigate to **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Azure Backup\Replication**.</span><span class="sxs-lookup"><span data-stu-id="ace43-219">In the VM's registry, navigate to **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows Azure Backup\Replication**.</span></span>
   * <span data-ttu-id="ace43-220">To influence the bandwidth traffic on a replicating disk, modify the value of **UploadThreadsPerVM**, or create the key if it doesn't exist.</span><span class="sxs-lookup"><span data-stu-id="ace43-220">To influence the bandwidth traffic on a replicating disk, modify the value of **UploadThreadsPerVM**, or create the key if it doesn't exist.</span></span>
   * <span data-ttu-id="ace43-221">To influence the bandwidth for failback traffic from Azure, modify the value of **DownloadThreadsPerVM**.</span><span class="sxs-lookup"><span data-stu-id="ace43-221">To influence the bandwidth for failback traffic from Azure, modify the value of **DownloadThreadsPerVM**.</span></span>
2. <span data-ttu-id="ace43-222">The default value is 4.</span><span class="sxs-lookup"><span data-stu-id="ace43-222">The default value is 4.</span></span> <span data-ttu-id="ace43-223">In an “overprovisioned” network, these registry keys should be changed from the default values.</span><span class="sxs-lookup"><span data-stu-id="ace43-223">In an “overprovisioned” network, these registry keys should be changed from the default values.</span></span> <span data-ttu-id="ace43-224">The maximum is 32.</span><span class="sxs-lookup"><span data-stu-id="ace43-224">The maximum is 32.</span></span> <span data-ttu-id="ace43-225">Monitor traffic to optimize the value.</span><span class="sxs-lookup"><span data-stu-id="ace43-225">Monitor traffic to optimize the value.</span></span>


## <a name="deploy-additional-process-servers"></a><span data-ttu-id="ace43-226">Deploy additional process servers</span><span class="sxs-lookup"><span data-stu-id="ace43-226">Deploy additional process servers</span></span>

<span data-ttu-id="ace43-227">If you have to scale out your deployment beyond 200 source machines, or you have a total daily churn rate of more than 2 TB, you need additional process servers to handle the traffic volume.</span><span class="sxs-lookup"><span data-stu-id="ace43-227">If you have to scale out your deployment beyond 200 source machines, or you have a total daily churn rate of more than 2 TB, you need additional process servers to handle the traffic volume.</span></span> <span data-ttu-id="ace43-228">Follow these instructions to set up the process server.</span><span class="sxs-lookup"><span data-stu-id="ace43-228">Follow these instructions to set up the process server.</span></span> <span data-ttu-id="ace43-229">After setting up the server, you migrate source machines to use it.</span><span class="sxs-lookup"><span data-stu-id="ace43-229">After setting up the server, you migrate source machines to use it.</span></span>

1. <span data-ttu-id="ace43-230">In **Site Recovery servers**, click the configuration server, and then click **Process Server**.</span><span class="sxs-lookup"><span data-stu-id="ace43-230">In **Site Recovery servers**, click the configuration server, and then click **Process Server**.</span></span>

    ![Screenshot of Site Recovery servers option to add a process server](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-vmware-to-azure/migrate-ps1.png)
2. <span data-ttu-id="ace43-232">In **Server type**, click **Process server (on-premises)**.</span><span class="sxs-lookup"><span data-stu-id="ace43-232">In **Server type**, click **Process server (on-premises)**.</span></span>

    ![Screenshot of Process Server dialog box](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-vmware-to-azure/migrate-ps2.png)
3. <span data-ttu-id="ace43-234">Download the Site Recovery Unified Setup file, and run it to install the process server.</span><span class="sxs-lookup"><span data-stu-id="ace43-234">Download the Site Recovery Unified Setup file, and run it to install the process server.</span></span> <span data-ttu-id="ace43-235">This also registers it in the vault.</span><span class="sxs-lookup"><span data-stu-id="ace43-235">This also registers it in the vault.</span></span>
4. <span data-ttu-id="ace43-236">In **Before you begin**, select **Add additional process servers to scale out deployment**.</span><span class="sxs-lookup"><span data-stu-id="ace43-236">In **Before you begin**, select **Add additional process servers to scale out deployment**.</span></span>
5. <span data-ttu-id="ace43-237">Complete the wizard in the same way you did when you [set up](#step-2-set-up-the-source-environment) the configuration server.</span><span class="sxs-lookup"><span data-stu-id="ace43-237">Complete the wizard in the same way you did when you [set up](#step-2-set-up-the-source-environment) the configuration server.</span></span>

    ![Screenshot of Azure Site Recovery Unified Setup wizard](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-vmware-to-azure/add-ps1.png)
6. <span data-ttu-id="ace43-239">In **Configuration Server Details**, specify the IP address of the configuration server, and the passphrase.</span><span class="sxs-lookup"><span data-stu-id="ace43-239">In **Configuration Server Details**, specify the IP address of the configuration server, and the passphrase.</span></span> <span data-ttu-id="ace43-240">To obtain the passphrase, run **[SiteRecoveryInstallationFolder]\home\sysystems\bin\genpassphrase.exe –n** on the configuration server.</span><span class="sxs-lookup"><span data-stu-id="ace43-240">To obtain the passphrase, run **[SiteRecoveryInstallationFolder]\home\sysystems\bin\genpassphrase.exe –n** on the configuration server.</span></span>

    ![Screenshot of Configuration Server Details page](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-vmware-to-azure/add-ps2.png)

### <a name="migrate-machines-to-use-the-new-process-server"></a><span data-ttu-id="ace43-242">Migrate machines to use the new process server</span><span class="sxs-lookup"><span data-stu-id="ace43-242">Migrate machines to use the new process server</span></span>
1. <span data-ttu-id="ace43-243">In **Settings** > **Site Recovery servers**, click the configuration server, and then expand **Process servers**.</span><span class="sxs-lookup"><span data-stu-id="ace43-243">In **Settings** > **Site Recovery servers**, click the configuration server, and then expand **Process servers**.</span></span>

    ![Screenshot of Process Server dialog box](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-vmware-to-azure/migrate-ps2.png)
2. <span data-ttu-id="ace43-245">Right-click the process server currently in use, and click **Switch**.</span><span class="sxs-lookup"><span data-stu-id="ace43-245">Right-click the process server currently in use, and click **Switch**.</span></span>

    ![Screenshot of Configuration server dialog box](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-vmware-to-azure/migrate-ps3.png)
3. <span data-ttu-id="ace43-247">In **Select target process server**, select the new process server you want to use, and then select the virtual machines that the server will handle.</span><span class="sxs-lookup"><span data-stu-id="ace43-247">In **Select target process server**, select the new process server you want to use, and then select the virtual machines that the server will handle.</span></span> <span data-ttu-id="ace43-248">Click the information icon to get information about the server.</span><span class="sxs-lookup"><span data-stu-id="ace43-248">Click the information icon to get information about the server.</span></span> <span data-ttu-id="ace43-249">To help you make load decisions, the average space that's needed to replicate each selected virtual machine to the new process server is displayed.</span><span class="sxs-lookup"><span data-stu-id="ace43-249">To help you make load decisions, the average space that's needed to replicate each selected virtual machine to the new process server is displayed.</span></span> <span data-ttu-id="ace43-250">Click the check mark to start replicating to the new process server.</span><span class="sxs-lookup"><span data-stu-id="ace43-250">Click the check mark to start replicating to the new process server.</span></span>















