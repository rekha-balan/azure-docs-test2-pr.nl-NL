---
title: Test failover to Azure in Site Recovery | Microsoft Docs
description: Learn about running a test failover from on-premises to Azure
services: site-recovery
documentationcenter: ''
author: prateek9us
manager: gauravd
editor: ''
ms.assetid: 44813a48-c680-4581-a92e-cecc57cc3b1e
ms.service: site-recovery
ms.devlang: na
ms.topic: article
ms.tgt_pltfrm: na
ms.workload: storage-backup-recovery
ms.date: 2/15/2017
ms.author: pratshar
ms.openlocfilehash: 708158e17bab7c779f03fd36600a09b5fcc00ee7
ms.sourcegitcommit: 5b9d839c0c0a94b293fdafe1d6e5429506c07e05
ms.translationtype: HT
ms.contentlocale: nl-NL
ms.lasthandoff: 08/02/2018
ms.locfileid: "44553780"
---
# <a name="test--failover-to-azure-in-site-recovery"></a><span data-ttu-id="4884f-103">Test  Failover to Azure in Site Recovery</span><span class="sxs-lookup"><span data-stu-id="4884f-103">Test  Failover to Azure in Site Recovery</span></span>
> [!div class="op_single_selector"]
> * [Test Failover to Azure](./site-recovery-test-failover-to-azure.md)
> * [Test Failover (VMM to VMM)](./site-recovery-test-failover-vmm-to-vmm.md)


<span data-ttu-id="4884f-106">This article provides information and instructions for doing a test failover or a DR drill of virtual machines and physical servers that are protected with Site Recovery using Azure as the recovery site.</span><span class="sxs-lookup"><span data-stu-id="4884f-106">This article provides information and instructions for doing a test failover or a DR drill of virtual machines and physical servers that are protected with Site Recovery using Azure as the recovery site.</span></span>

<span data-ttu-id="4884f-107">Post any comments or questions at the bottom of this article, or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span><span class="sxs-lookup"><span data-stu-id="4884f-107">Post any comments or questions at the bottom of this article, or on the [Azure Recovery Services Forum](https://social.msdn.microsoft.com/forums/azure/home?forum=hypervrecovmgr).</span></span>

<span data-ttu-id="4884f-108">Test failover is run to validate your replication strategy or perform a disaster recovery drill without any data loss or downtime.</span><span class="sxs-lookup"><span data-stu-id="4884f-108">Test failover is run to validate your replication strategy or perform a disaster recovery drill without any data loss or downtime.</span></span> <span data-ttu-id="4884f-109">Doing a test failover doesn't have any impact on the ongoing replication or on your production environment.</span><span class="sxs-lookup"><span data-stu-id="4884f-109">Doing a test failover doesn't have any impact on the ongoing replication or on your production environment.</span></span> <span data-ttu-id="4884f-110">Test failover can be done either on a virtual machine or a [recovery plan](site-recovery-create-recovery-plans.md).</span><span class="sxs-lookup"><span data-stu-id="4884f-110">Test failover can be done either on a virtual machine or a [recovery plan](site-recovery-create-recovery-plans.md).</span></span> <span data-ttu-id="4884f-111">When triggering a test failover, you need to specify the network to which test virtual machines would connect to.</span><span class="sxs-lookup"><span data-stu-id="4884f-111">When triggering a test failover, you need to specify the network to which test virtual machines would connect to.</span></span> <span data-ttu-id="4884f-112">Once a test failover is triggered, you can track progress in the **Jobs** page.</span><span class="sxs-lookup"><span data-stu-id="4884f-112">Once a test failover is triggered, you can track progress in the **Jobs** page.</span></span>  


## <a name="supported-scenarios"></a><span data-ttu-id="4884f-113">Supported scenarios</span><span class="sxs-lookup"><span data-stu-id="4884f-113">Supported scenarios</span></span>
<span data-ttu-id="4884f-114">Test failover is supported in all deployment scenarios other than [legacy VMware site to Azure](site-recovery-vmware-to-azure-classic-legacy.md).</span><span class="sxs-lookup"><span data-stu-id="4884f-114">Test failover is supported in all deployment scenarios other than [legacy VMware site to Azure](site-recovery-vmware-to-azure-classic-legacy.md).</span></span> <span data-ttu-id="4884f-115">Test failover is also not supported when virtual machine has been failed over to Azure.</span><span class="sxs-lookup"><span data-stu-id="4884f-115">Test failover is also not supported when virtual machine has been failed over to Azure.</span></span>  


## <a name="run-a-test-failover"></a><span data-ttu-id="4884f-116">Run a test failover</span><span class="sxs-lookup"><span data-stu-id="4884f-116">Run a test failover</span></span>
<span data-ttu-id="4884f-117">This procedure describes how to run a test failover for a recovery plan.</span><span class="sxs-lookup"><span data-stu-id="4884f-117">This procedure describes how to run a test failover for a recovery plan.</span></span> <span data-ttu-id="4884f-118">Alternatively you can also run test failover for a single machine by using the appropriate option on it.</span><span class="sxs-lookup"><span data-stu-id="4884f-118">Alternatively you can also run test failover for a single machine by using the appropriate option on it.</span></span>

![Test Failover](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-test-failover-to-azure/TestFailover.png)


1. <span data-ttu-id="4884f-120">Select **Recovery Plans** > *recoveryplan_name*.</span><span class="sxs-lookup"><span data-stu-id="4884f-120">Select **Recovery Plans** > *recoveryplan_name*.</span></span> <span data-ttu-id="4884f-121">Click **Test Failover**.</span><span class="sxs-lookup"><span data-stu-id="4884f-121">Click **Test Failover**.</span></span>
1. <span data-ttu-id="4884f-122">Select a **Recovery Point** to failover to.</span><span class="sxs-lookup"><span data-stu-id="4884f-122">Select a **Recovery Point** to failover to.</span></span> <span data-ttu-id="4884f-123">You can use one of the following options:</span><span class="sxs-lookup"><span data-stu-id="4884f-123">You can use one of the following options:</span></span>
    1.  <span data-ttu-id="4884f-124">**Latest processed**: This option fails over all virtual machines of the recovery plan to the latest recovery point that has already been processed by Site Recovery service.</span><span class="sxs-lookup"><span data-stu-id="4884f-124">**Latest processed**: This option fails over all virtual machines of the recovery plan to the latest recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="4884f-125">When you are doing test failover of a virtual machine, time stamp of the latest processed recovery point is also shown.</span><span class="sxs-lookup"><span data-stu-id="4884f-125">When you are doing test failover of a virtual machine, time stamp of the latest processed recovery point is also shown.</span></span> <span data-ttu-id="4884f-126">If you are doing failover of a recovery plan, you can go to individual virtual machine and look at **Latest Recovery Points** tile to get this information.</span><span class="sxs-lookup"><span data-stu-id="4884f-126">If you are doing failover of a recovery plan, you can go to individual virtual machine and look at **Latest Recovery Points** tile to get this information.</span></span> <span data-ttu-id="4884f-127">As no time is spent to process the unprocessed data, this option provides a low RTO (Recovery Time Objective) failover option.</span><span class="sxs-lookup"><span data-stu-id="4884f-127">As no time is spent to process the unprocessed data, this option provides a low RTO (Recovery Time Objective) failover option.</span></span>
    1.    <span data-ttu-id="4884f-128">**Latest app-consistent**: This option fails over all virtual machines of the recovery plan to the latest application consistent recovery point that has already been processed by Site Recovery service.</span><span class="sxs-lookup"><span data-stu-id="4884f-128">**Latest app-consistent**: This option fails over all virtual machines of the recovery plan to the latest application consistent recovery point that has already been processed by Site Recovery service.</span></span> <span data-ttu-id="4884f-129">When you are doing test failover of a virtual machine, time stamp of the latest app-consistent recovery point is also shown.</span><span class="sxs-lookup"><span data-stu-id="4884f-129">When you are doing test failover of a virtual machine, time stamp of the latest app-consistent recovery point is also shown.</span></span> <span data-ttu-id="4884f-130">If you are doing failover of a recovery plan, you can go to individual virtual machine and look at **Latest Recovery Points** tile to get this information.</span><span class="sxs-lookup"><span data-stu-id="4884f-130">If you are doing failover of a recovery plan, you can go to individual virtual machine and look at **Latest Recovery Points** tile to get this information.</span></span>
    1.    <span data-ttu-id="4884f-131">**Latest**: This option first processes all the data that has been sent to Site Recovery service to create a recovery point for each virtual machine before failing them over to it.</span><span class="sxs-lookup"><span data-stu-id="4884f-131">**Latest**: This option first processes all the data that has been sent to Site Recovery service to create a recovery point for each virtual machine before failing them over to it.</span></span> <span data-ttu-id="4884f-132">This option provides the lowest RPO (Recovery Point Objective) as the virtual machine created after failover will have all the data that has been replicated to Site Recovery service when the failover was triggered.</span><span class="sxs-lookup"><span data-stu-id="4884f-132">This option provides the lowest RPO (Recovery Point Objective) as the virtual machine created after failover will have all the data that has been replicated to Site Recovery service when the failover was triggered.</span></span>
    1.  <span data-ttu-id="4884f-133">**Custom**: If you are doing test failover of a virtual machine, then you can use this option to failover to a particular recovery point.</span><span class="sxs-lookup"><span data-stu-id="4884f-133">**Custom**: If you are doing test failover of a virtual machine, then you can use this option to failover to a particular recovery point.</span></span>
1. <span data-ttu-id="4884f-134">Select an **Azure virtual network**: Provide an Azure virtual network where the test virtual machines would be created.</span><span class="sxs-lookup"><span data-stu-id="4884f-134">Select an **Azure virtual network**: Provide an Azure virtual network where the test virtual machines would be created.</span></span> <span data-ttu-id="4884f-135">Site Recovery attempts to create test virtual machines in a subnet of same name and using the same IP as that provided in **Compute and Network** settings of the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="4884f-135">Site Recovery attempts to create test virtual machines in a subnet of same name and using the same IP as that provided in **Compute and Network** settings of the virtual machine.</span></span> <span data-ttu-id="4884f-136">If subnet of same name is not available in the Azure virtual network provided for test failover, then test virtual machine is created in the first subnet alphabetically.</span><span class="sxs-lookup"><span data-stu-id="4884f-136">If subnet of same name is not available in the Azure virtual network provided for test failover, then test virtual machine is created in the first subnet alphabetically.</span></span> <span data-ttu-id="4884f-137">If same IP is not available in the subnet, then virtual machine gets another IP address available in the subnet.</span><span class="sxs-lookup"><span data-stu-id="4884f-137">If same IP is not available in the subnet, then virtual machine gets another IP address available in the subnet.</span></span> <span data-ttu-id="4884f-138">Read this section for [more details](#creating-a-network-for-test-failover)</span><span class="sxs-lookup"><span data-stu-id="4884f-138">Read this section for [more details](#creating-a-network-for-test-failover)</span></span>
1. <span data-ttu-id="4884f-139">If you're failing over to Azure and data encryption is enabled, in **Encryption Key** select the certificate that was issued when you enabled data encryption during Provider installation.</span><span class="sxs-lookup"><span data-stu-id="4884f-139">If you're failing over to Azure and data encryption is enabled, in **Encryption Key** select the certificate that was issued when you enabled data encryption during Provider installation.</span></span> <span data-ttu-id="4884f-140">You can ignore this step if you have not enabled encryption on the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="4884f-140">You can ignore this step if you have not enabled encryption on the virtual machine.</span></span>
1. <span data-ttu-id="4884f-141">Track failover progress on the **Jobs** tab. You should be able to see the test replica machine in the Azure portal.</span><span class="sxs-lookup"><span data-stu-id="4884f-141">Track failover progress on the **Jobs** tab. You should be able to see the test replica machine in the Azure portal.</span></span>
1. <span data-ttu-id="4884f-142">To initiate an RDP connection on the virtual machine, you will need to [add a public ip](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on the network interface of the failed over virtual machine.</span><span class="sxs-lookup"><span data-stu-id="4884f-142">To initiate an RDP connection on the virtual machine, you will need to [add a public ip](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on the network interface of the failed over virtual machine.</span></span> <span data-ttu-id="4884f-143">If you are failing over to a Classic virtual machine, then you need to [add an endpoint](../virtual-machines/windows/classic/setup-endpoints.md) on port 3389</span><span class="sxs-lookup"><span data-stu-id="4884f-143">If you are failing over to a Classic virtual machine, then you need to [add an endpoint](../virtual-machines/windows/classic/setup-endpoints.md) on port 3389</span></span>
1. <span data-ttu-id="4884f-144">Once you're done, click **Cleanup test failover** on the recovery plan.</span><span class="sxs-lookup"><span data-stu-id="4884f-144">Once you're done, click **Cleanup test failover** on the recovery plan.</span></span> <span data-ttu-id="4884f-145">In **Notes** record and save any observations associated with the test failover.</span><span class="sxs-lookup"><span data-stu-id="4884f-145">In **Notes** record and save any observations associated with the test failover.</span></span> <span data-ttu-id="4884f-146">This deletes the virtual machines that were created during test failover.</span><span class="sxs-lookup"><span data-stu-id="4884f-146">This deletes the virtual machines that were created during test failover.</span></span>


> [!TIP]
> Site Recovery attempts to create test virtual machines in a subnet of same name and using the same IP as that provided in **Compute and Network** settings of the virtual machine. If subnet of same name is not available in the Azure virtual network provided for test failover, then test virtual machine is created in the first subnet alphabetically. If the target IP is part of the chosen subnet, then site recovery tries to create the test failover virtual machine using the target IP. If the target IP is not part of the chosen subnet then test failover virtual machine gets created using any available IP in the chosen subnet. 
>
>

## <a name="test-failover-job"></a><span data-ttu-id="4884f-151">Test failover job</span><span class="sxs-lookup"><span data-stu-id="4884f-151">Test failover job</span></span>

![Test Failover](https://docstestmedia1.blob.core.windows.net/azure-media/articles/site-recovery/media/site-recovery-test-failover-to-azure/TestFailoverJob.png)

<span data-ttu-id="4884f-153">When a test failover is triggered, it involves following steps:</span><span class="sxs-lookup"><span data-stu-id="4884f-153">When a test failover is triggered, it involves following steps:</span></span>

1. <span data-ttu-id="4884f-154">Prerequisites check: This step ensures that all conditions required for failover are met</span><span class="sxs-lookup"><span data-stu-id="4884f-154">Prerequisites check: This step ensures that all conditions required for failover are met</span></span>
1. <span data-ttu-id="4884f-155">Failover: This step processes the data and makes it ready so that an Azure virtual machine can be created out of it.</span><span class="sxs-lookup"><span data-stu-id="4884f-155">Failover: This step processes the data and makes it ready so that an Azure virtual machine can be created out of it.</span></span> <span data-ttu-id="4884f-156">If you have chosen **Latest** recovery point, this step creates a recovery point from the data that has been sent to the service.</span><span class="sxs-lookup"><span data-stu-id="4884f-156">If you have chosen **Latest** recovery point, this step creates a recovery point from the data that has been sent to the service.</span></span>
1. <span data-ttu-id="4884f-157">Start: This step creates an Azure virtual machine using the data processed in the previous step.</span><span class="sxs-lookup"><span data-stu-id="4884f-157">Start: This step creates an Azure virtual machine using the data processed in the previous step.</span></span>


## <a name="creating-a-network-for-test-failover"></a><span data-ttu-id="4884f-158">Creating a network for test failover</span><span class="sxs-lookup"><span data-stu-id="4884f-158">Creating a network for test failover</span></span>
<span data-ttu-id="4884f-159">It is recommended that when you are doing a test failover you choose a network that is isolated from your production recovery site network that you provided in **Compute and Network** settings for the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="4884f-159">It is recommended that when you are doing a test failover you choose a network that is isolated from your production recovery site network that you provided in **Compute and Network** settings for the virtual machine.</span></span> <span data-ttu-id="4884f-160">By default when you create an Azure virtual network, it is isolated from other networks.</span><span class="sxs-lookup"><span data-stu-id="4884f-160">By default when you create an Azure virtual network, it is isolated from other networks.</span></span> <span data-ttu-id="4884f-161">This network should mimic your production network:</span><span class="sxs-lookup"><span data-stu-id="4884f-161">This network should mimic your production network:</span></span>

1. <span data-ttu-id="4884f-162">Test network should have same number of subnets as that in your production network and with the same name as those of the subnets in your production network.</span><span class="sxs-lookup"><span data-stu-id="4884f-162">Test network should have same number of subnets as that in your production network and with the same name as those of the subnets in your production network.</span></span>
1. <span data-ttu-id="4884f-163">Test network should use the same IP range as that of your production network.</span><span class="sxs-lookup"><span data-stu-id="4884f-163">Test network should use the same IP range as that of your production network.</span></span>
1. <span data-ttu-id="4884f-164">Update the DNS of the Test Network as the IP that you gave as target IP for the DNS virtual machine under **Compute and Network** settings.</span><span class="sxs-lookup"><span data-stu-id="4884f-164">Update the DNS of the Test Network as the IP that you gave as target IP for the DNS virtual machine under **Compute and Network** settings.</span></span> <span data-ttu-id="4884f-165">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span><span class="sxs-lookup"><span data-stu-id="4884f-165">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>


## <a name="test-failover-to-a-production-network-on-recovery-site"></a><span data-ttu-id="4884f-166">Test failover to a production network on recovery site</span><span class="sxs-lookup"><span data-stu-id="4884f-166">Test failover to a production network on recovery site</span></span>
<span data-ttu-id="4884f-167">It is recommended that when you are doing a test failover you choose a network that is different from your production recovery site network that you provided in **Compute and Network** settings for the virtual machine.</span><span class="sxs-lookup"><span data-stu-id="4884f-167">It is recommended that when you are doing a test failover you choose a network that is different from your production recovery site network that you provided in **Compute and Network** settings for the virtual machine.</span></span> <span data-ttu-id="4884f-168">But if you really want to validate end to end network connectivity in a failed over virtual machine, note the following points:</span><span class="sxs-lookup"><span data-stu-id="4884f-168">But if you really want to validate end to end network connectivity in a failed over virtual machine, note the following points:</span></span>

1. <span data-ttu-id="4884f-169">Make sure that the primary virtual machine is shutdown when you are doing the test failover.</span><span class="sxs-lookup"><span data-stu-id="4884f-169">Make sure that the primary virtual machine is shutdown when you are doing the test failover.</span></span> <span data-ttu-id="4884f-170">If you don't do so, there will be two virtual machines with the same identity running in the same network at the same time and that can lead to undesired consequences.</span><span class="sxs-lookup"><span data-stu-id="4884f-170">If you don't do so, there will be two virtual machines with the same identity running in the same network at the same time and that can lead to undesired consequences.</span></span>
1. <span data-ttu-id="4884f-171">Any changes that you make into the test failover virtual machines would be lost when you cleanup the test failover virtual machines.</span><span class="sxs-lookup"><span data-stu-id="4884f-171">Any changes that you make into the test failover virtual machines would be lost when you cleanup the test failover virtual machines.</span></span> <span data-ttu-id="4884f-172">These changes will not be replicated back to the primary virtual machine.</span><span class="sxs-lookup"><span data-stu-id="4884f-172">These changes will not be replicated back to the primary virtual machine.</span></span>
1. <span data-ttu-id="4884f-173">This way of doing testing leads to a downtime of your production application.</span><span class="sxs-lookup"><span data-stu-id="4884f-173">This way of doing testing leads to a downtime of your production application.</span></span> <span data-ttu-id="4884f-174">Users of the application should be asked to not use the application when the DR drill is in progress.</span><span class="sxs-lookup"><span data-stu-id="4884f-174">Users of the application should be asked to not use the application when the DR drill is in progress.</span></span>  



## <a name="prepare-active-directory-and-dns"></a><span data-ttu-id="4884f-175">Prepare Active Directory and DNS</span><span class="sxs-lookup"><span data-stu-id="4884f-175">Prepare Active Directory and DNS</span></span>
<span data-ttu-id="4884f-176">To run a test failover for application testing, you need a copy of the production Active Directory environment in your test environment.</span><span class="sxs-lookup"><span data-stu-id="4884f-176">To run a test failover for application testing, you need a copy of the production Active Directory environment in your test environment.</span></span> <span data-ttu-id="4884f-177">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span><span class="sxs-lookup"><span data-stu-id="4884f-177">Go through [test failover considerations for active directory](site-recovery-active-directory.md#test-failover-considerations) section for more details.</span></span>

## <a name="prepare-to-connect-to-azure-vms-after-failover"></a><span data-ttu-id="4884f-178">Prepare to connect to Azure VMs after failover</span><span class="sxs-lookup"><span data-stu-id="4884f-178">Prepare to connect to Azure VMs after failover</span></span>

<span data-ttu-id="4884f-179">If you want to connect to Azure VMs using RDP after failover, make sure you do the actions summarized in the table.</span><span class="sxs-lookup"><span data-stu-id="4884f-179">If you want to connect to Azure VMs using RDP after failover, make sure you do the actions summarized in the table.</span></span>

<span data-ttu-id="4884f-180">**Failover**</span><span class="sxs-lookup"><span data-stu-id="4884f-180">**Failover**</span></span> | <span data-ttu-id="4884f-181">**Location**</span><span class="sxs-lookup"><span data-stu-id="4884f-181">**Location**</span></span> | <span data-ttu-id="4884f-182">**Actions**</span><span class="sxs-lookup"><span data-stu-id="4884f-182">**Actions**</span></span>
--- | --- | ---
<span data-ttu-id="4884f-183">**Azure VM running Windows**</span><span class="sxs-lookup"><span data-stu-id="4884f-183">**Azure VM running Windows**</span></span> | <span data-ttu-id="4884f-184">On on-premises machine before failover</span><span class="sxs-lookup"><span data-stu-id="4884f-184">On on-premises machine before failover</span></span> | <span data-ttu-id="4884f-185">To access the Azure VM over the internet, enable RDP, make sure TCP, and UDP rules are added for the **Public**, and that RDP is allowed in **Windows Firewall** > **Allowed Apps**, for all profiles.</span><span class="sxs-lookup"><span data-stu-id="4884f-185">To access the Azure VM over the internet, enable RDP, make sure TCP, and UDP rules are added for the **Public**, and that RDP is allowed in **Windows Firewall** > **Allowed Apps**, for all profiles.</span></span><br/><br/> <span data-ttu-id="4884f-186">To access over a site-to-site connection, enable RDP on the machine, and ensure that RDP is allowed in the **Windows Firewall** -> **Allowed apps and features** for **Domain and Private** networks.</span><span class="sxs-lookup"><span data-stu-id="4884f-186">To access over a site-to-site connection, enable RDP on the machine, and ensure that RDP is allowed in the **Windows Firewall** -> **Allowed apps and features** for **Domain and Private** networks.</span></span><br/><br/>  <span data-ttu-id="4884f-187">Make sure the operating system's SAN policy is set to **OnlineAll**.</span><span class="sxs-lookup"><span data-stu-id="4884f-187">Make sure the operating system's SAN policy is set to **OnlineAll**.</span></span> <span data-ttu-id="4884f-188">[Learn more](https://support.microsoft.com/kb/3031135).</span><span class="sxs-lookup"><span data-stu-id="4884f-188">[Learn more](https://support.microsoft.com/kb/3031135).</span></span><br/><br/> <span data-ttu-id="4884f-189">Make sure there are no Windows updates pending on the virtual machine when you trigger a failover.</span><span class="sxs-lookup"><span data-stu-id="4884f-189">Make sure there are no Windows updates pending on the virtual machine when you trigger a failover.</span></span> <span data-ttu-id="4884f-190">Windows update might start when you failover and you will not be able to login to the virtual machine until the update completes.</span><span class="sxs-lookup"><span data-stu-id="4884f-190">Windows update might start when you failover and you will not be able to login to the virtual machine until the update completes.</span></span> <br/><br/>
<span data-ttu-id="4884f-191">**Azure VM running Windows**</span><span class="sxs-lookup"><span data-stu-id="4884f-191">**Azure VM running Windows**</span></span> | <span data-ttu-id="4884f-192">On Azure VM after failover</span><span class="sxs-lookup"><span data-stu-id="4884f-192">On Azure VM after failover</span></span> | <span data-ttu-id="4884f-193">For a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) for the RDP protocol (port 3389)</span><span class="sxs-lookup"><span data-stu-id="4884f-193">For a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) for the RDP protocol (port 3389)</span></span><br/><br/>  <span data-ttu-id="4884f-194">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span><span class="sxs-lookup"><span data-stu-id="4884f-194">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="4884f-195">The network security group rules on the failed over VM, and the Azure subnet to which it is connected, need to allow incoming connections to the RDP port.</span><span class="sxs-lookup"><span data-stu-id="4884f-195">The network security group rules on the failed over VM, and the Azure subnet to which it is connected, need to allow incoming connections to the RDP port.</span></span><br/><br/> <span data-ttu-id="4884f-196">For a Resource Manager virtual machine, you can check **Boot diagnostics** to look at a screenshot of the virtual machine</span><span class="sxs-lookup"><span data-stu-id="4884f-196">For a Resource Manager virtual machine, you can check **Boot diagnostics** to look at a screenshot of the virtual machine</span></span><br/><br/> <span data-ttu-id="4884f-197">If you can't connect, check that the VM is running and then look at these [troubleshooting tips](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span><span class="sxs-lookup"><span data-stu-id="4884f-197">If you can't connect, check that the VM is running and then look at these [troubleshooting tips](http://social.technet.microsoft.com/wiki/contents/articles/31666.troubleshooting-remote-desktop-connection-after-failover-using-asr.aspx).</span></span><br/><br/>
<span data-ttu-id="4884f-198">**Azure VM running Linux**</span><span class="sxs-lookup"><span data-stu-id="4884f-198">**Azure VM running Linux**</span></span> | <span data-ttu-id="4884f-199">On on-premises machine before failover</span><span class="sxs-lookup"><span data-stu-id="4884f-199">On on-premises machine before failover</span></span> | <span data-ttu-id="4884f-200">Ensure that the Secure Shell service on the Azure VM is set to start automatically on system boot.</span><span class="sxs-lookup"><span data-stu-id="4884f-200">Ensure that the Secure Shell service on the Azure VM is set to start automatically on system boot.</span></span><br/><br/> <span data-ttu-id="4884f-201">Check that firewall rules allow an SSH connection to it.</span><span class="sxs-lookup"><span data-stu-id="4884f-201">Check that firewall rules allow an SSH connection to it.</span></span>
<span data-ttu-id="4884f-202">**Azure VM running Linux**</span><span class="sxs-lookup"><span data-stu-id="4884f-202">**Azure VM running Linux**</span></span> | <span data-ttu-id="4884f-203">Azure VM after failover</span><span class="sxs-lookup"><span data-stu-id="4884f-203">Azure VM after failover</span></span> | <span data-ttu-id="4884f-204">The network security group rules on the failed over VM, and the Azure subnet to which it is connected, need to allow incoming connections to the SSH port.</span><span class="sxs-lookup"><span data-stu-id="4884f-204">The network security group rules on the failed over VM, and the Azure subnet to which it is connected, need to allow incoming connections to the SSH port.</span></span><br/><br/> <span data-ttu-id="4884f-205">For  a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) should be created, to allow incoming connections on the SSH port (TCP port 22 by default).</span><span class="sxs-lookup"><span data-stu-id="4884f-205">For  a classic virtual machine, [add a public endpoint](../virtual-machines/windows/classic/setup-endpoints.md) should be created, to allow incoming connections on the SSH port (TCP port 22 by default).</span></span><br/><br/> <span data-ttu-id="4884f-206">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span><span class="sxs-lookup"><span data-stu-id="4884f-206">For a Resource Manager virtual machine, [add a public IP](site-recovery-monitoring-and-troubleshooting.md#adding-a-public-ip-on-a-resource-manager-virtual-machine) on it.</span></span><br/><br/> <span data-ttu-id="4884f-207">For a Resource Manager virtual machine, you can check **Boot diagnostics** to look at a screenshot of the virtual machine</span><span class="sxs-lookup"><span data-stu-id="4884f-207">For a Resource Manager virtual machine, you can check **Boot diagnostics** to look at a screenshot of the virtual machine</span></span><br/><br/>



## <a name="next-steps"></a><span data-ttu-id="4884f-208">Next Steps</span><span class="sxs-lookup"><span data-stu-id="4884f-208">Next Steps</span></span>
<span data-ttu-id="4884f-209">Once you have successfully tried a test failover you can try doing a [failover](site-recovery-failover.md).</span><span class="sxs-lookup"><span data-stu-id="4884f-209">Once you have successfully tried a test failover you can try doing a [failover](site-recovery-failover.md).</span></span>


