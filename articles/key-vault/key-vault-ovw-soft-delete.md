---
ms.assetid: ''
title: Azure Key Vault soft delete | Microsoft Docs
ms.service: key-vault
author: bryanla
ms.author: bryanla
manager: mbaldwin
ms.date: 09/25/2017
ms.openlocfilehash: ccdefc83642285194635ffe7b561e9e322360533
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44855927"
---
# <a name="azure-key-vault-soft-delete-overview"></a><span data-ttu-id="7d7db-102">Azure Key Vault soft-delete overview</span><span class="sxs-lookup"><span data-stu-id="7d7db-102">Azure Key Vault soft-delete overview</span></span>

<span data-ttu-id="7d7db-103">Key Vault's soft delete feature allows recovery of the deleted vaults and vault objects, known as soft-delete.</span><span class="sxs-lookup"><span data-stu-id="7d7db-103">Key Vault's soft delete feature allows recovery of the deleted vaults and vault objects, known as soft-delete.</span></span> <span data-ttu-id="7d7db-104">Specifically, we address the following scenarios:</span><span class="sxs-lookup"><span data-stu-id="7d7db-104">Specifically, we address the following scenarios:</span></span>

- <span data-ttu-id="7d7db-105">Support for recoverable deletion of a key vault</span><span class="sxs-lookup"><span data-stu-id="7d7db-105">Support for recoverable deletion of a key vault</span></span>
- <span data-ttu-id="7d7db-106">Support for recoverable deletion of key vault objects (ex.</span><span class="sxs-lookup"><span data-stu-id="7d7db-106">Support for recoverable deletion of key vault objects (ex.</span></span> <span data-ttu-id="7d7db-107">keys, secrets, certificates)</span><span class="sxs-lookup"><span data-stu-id="7d7db-107">keys, secrets, certificates)</span></span>

## <a name="supporting-interfaces"></a><span data-ttu-id="7d7db-108">Supporting interfaces</span><span class="sxs-lookup"><span data-stu-id="7d7db-108">Supporting interfaces</span></span>

<span data-ttu-id="7d7db-109">The soft-delete feature is initially available through the REST, .NET/C#, PowerShell and, CLI interfaces.</span><span class="sxs-lookup"><span data-stu-id="7d7db-109">The soft-delete feature is initially available through the REST, .NET/C#, PowerShell and, CLI interfaces.</span></span>

<span data-ttu-id="7d7db-110">For general information see the references for these for more details, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span><span class="sxs-lookup"><span data-stu-id="7d7db-110">For general information see the references for these for more details, [Key Vault Reference](https://docs.microsoft.com/azure/key-vault/).</span></span>

## <a name="scenarios"></a><span data-ttu-id="7d7db-111">Scenarios</span><span class="sxs-lookup"><span data-stu-id="7d7db-111">Scenarios</span></span>

<span data-ttu-id="7d7db-112">Azure Key Vaults are tracked resources, managed by Azure Resource Manager.</span><span class="sxs-lookup"><span data-stu-id="7d7db-112">Azure Key Vaults are tracked resources, managed by Azure Resource Manager.</span></span> <span data-ttu-id="7d7db-113">Azure Resource Manager also specifies a well-defined behavior for deletion, which requires that a successful DELETE operation must result in that resource not being accessible anymore.</span><span class="sxs-lookup"><span data-stu-id="7d7db-113">Azure Resource Manager also specifies a well-defined behavior for deletion, which requires that a successful DELETE operation must result in that resource not being accessible anymore.</span></span> <span data-ttu-id="7d7db-114">The soft-delete feature addresses the recovery of the deleted object, whether the deletion was accidental or intentional.</span><span class="sxs-lookup"><span data-stu-id="7d7db-114">The soft-delete feature addresses the recovery of the deleted object, whether the deletion was accidental or intentional.</span></span>

1. <span data-ttu-id="7d7db-115">In the typical scenario, a user may have inadvertently deleted a key vault or a key vault object; if that key vault or key vault object were to be recoverable for a predetermined period, the user may undo the deletion and recover their data.</span><span class="sxs-lookup"><span data-stu-id="7d7db-115">In the typical scenario, a user may have inadvertently deleted a key vault or a key vault object; if that key vault or key vault object were to be recoverable for a predetermined period, the user may undo the deletion and recover their data.</span></span>

2. <span data-ttu-id="7d7db-116">In a different scenario, a rogue user may attempt to delete a key vault or a key vault object, such as a key inside a vault, to cause a business disruption.</span><span class="sxs-lookup"><span data-stu-id="7d7db-116">In a different scenario, a rogue user may attempt to delete a key vault or a key vault object, such as a key inside a vault, to cause a business disruption.</span></span> <span data-ttu-id="7d7db-117">Separating the deletion of the key vault or key vault object from the actual deletion of the underlying data can be used as a safety measure by, for instance, restricting permissions on data deletion to a different, trusted role.</span><span class="sxs-lookup"><span data-stu-id="7d7db-117">Separating the deletion of the key vault or key vault object from the actual deletion of the underlying data can be used as a safety measure by, for instance, restricting permissions on data deletion to a different, trusted role.</span></span> <span data-ttu-id="7d7db-118">This approach effectively requires quorum for an operation which might otherwise result in an immediate data loss.</span><span class="sxs-lookup"><span data-stu-id="7d7db-118">This approach effectively requires quorum for an operation which might otherwise result in an immediate data loss.</span></span>

### <a name="soft-delete-behavior"></a><span data-ttu-id="7d7db-119">Soft-delete behavior</span><span class="sxs-lookup"><span data-stu-id="7d7db-119">Soft-delete behavior</span></span>

<span data-ttu-id="7d7db-120">With this feature, the DELETE operation on a key vault or key vault object is a soft-delete, effectively holding the resources for a given retention period, while giving the appearance that the object is deleted.</span><span class="sxs-lookup"><span data-stu-id="7d7db-120">With this feature, the DELETE operation on a key vault or key vault object is a soft-delete, effectively holding the resources for a given retention period, while giving the appearance that the object is deleted.</span></span> <span data-ttu-id="7d7db-121">The service further provides a mechanism for recovering the deleted object, essentially undoing the deletion.</span><span class="sxs-lookup"><span data-stu-id="7d7db-121">The service further provides a mechanism for recovering the deleted object, essentially undoing the deletion.</span></span> 

<span data-ttu-id="7d7db-122">Soft-delete is an optional Key Vault behavior and is **not enabled by default** in this release.</span><span class="sxs-lookup"><span data-stu-id="7d7db-122">Soft-delete is an optional Key Vault behavior and is **not enabled by default** in this release.</span></span> 

### <a name="key-vault-recovery"></a><span data-ttu-id="7d7db-123">Key vault recovery</span><span class="sxs-lookup"><span data-stu-id="7d7db-123">Key vault recovery</span></span>

<span data-ttu-id="7d7db-124">Upon deleting a key vault, the service creates a proxy resource under the subscription, adding sufficient metadata for recovery.</span><span class="sxs-lookup"><span data-stu-id="7d7db-124">Upon deleting a key vault, the service creates a proxy resource under the subscription, adding sufficient metadata for recovery.</span></span> <span data-ttu-id="7d7db-125">The proxy resource is a stored object, available in the same location as the deleted key vault.</span><span class="sxs-lookup"><span data-stu-id="7d7db-125">The proxy resource is a stored object, available in the same location as the deleted key vault.</span></span> 

### <a name="key-vault-object-recovery"></a><span data-ttu-id="7d7db-126">Key vault object recovery</span><span class="sxs-lookup"><span data-stu-id="7d7db-126">Key vault object recovery</span></span>

<span data-ttu-id="7d7db-127">Upon deleting a key vault object, such as a key, the service will place the object in a deleted state, thus making it inaccessible to any retrieval operations.</span><span class="sxs-lookup"><span data-stu-id="7d7db-127">Upon deleting a key vault object, such as a key, the service will place the object in a deleted state, thus making it inaccessible to any retrieval operations.</span></span> <span data-ttu-id="7d7db-128">While in this state, the key vault object can only be listed, recovered, or forcefully/permanently deleted.</span><span class="sxs-lookup"><span data-stu-id="7d7db-128">While in this state, the key vault object can only be listed, recovered, or forcefully/permanently deleted.</span></span> 

<span data-ttu-id="7d7db-129">At the same time, Key Vault will schedule the deletion of the underlying data corresponding to the deleted key vault or key vault object for execution after a predetermined retention interval.</span><span class="sxs-lookup"><span data-stu-id="7d7db-129">At the same time, Key Vault will schedule the deletion of the underlying data corresponding to the deleted key vault or key vault object for execution after a predetermined retention interval.</span></span> <span data-ttu-id="7d7db-130">The DNS record corresponding to the vault is also retained for the duration of the retention interval.</span><span class="sxs-lookup"><span data-stu-id="7d7db-130">The DNS record corresponding to the vault is also retained for the duration of the retention interval.</span></span>

### <a name="soft-delete-retention-period"></a><span data-ttu-id="7d7db-131">Soft-delete retention period</span><span class="sxs-lookup"><span data-stu-id="7d7db-131">Soft-delete retention period</span></span>

<span data-ttu-id="7d7db-132">Soft deleted resources are retained for a set period of time, 90 days.</span><span class="sxs-lookup"><span data-stu-id="7d7db-132">Soft deleted resources are retained for a set period of time, 90 days.</span></span> <span data-ttu-id="7d7db-133">During the soft-delete retention interval, the following apply:</span><span class="sxs-lookup"><span data-stu-id="7d7db-133">During the soft-delete retention interval, the following apply:</span></span>

- <span data-ttu-id="7d7db-134">You may list all of the key vaults and key vault objects in the soft-delete state for your subscription as well as access deletion and recovery information about them.</span><span class="sxs-lookup"><span data-stu-id="7d7db-134">You may list all of the key vaults and key vault objects in the soft-delete state for your subscription as well as access deletion and recovery information about them.</span></span>
    - <span data-ttu-id="7d7db-135">Only users with special permissions can list deleted vaults.</span><span class="sxs-lookup"><span data-stu-id="7d7db-135">Only users with special permissions can list deleted vaults.</span></span> <span data-ttu-id="7d7db-136">We recommend that our users create a custom role with these special permissions for handling deleted vaults.</span><span class="sxs-lookup"><span data-stu-id="7d7db-136">We recommend that our users create a custom role with these special permissions for handling deleted vaults.</span></span>
- <span data-ttu-id="7d7db-137">A key vault with the same name cannot be created in the same location; correspondingly, a key vault object cannot be created in a given vault if that key vault contains an object with the same name and which is in a deleted state</span><span class="sxs-lookup"><span data-stu-id="7d7db-137">A key vault with the same name cannot be created in the same location; correspondingly, a key vault object cannot be created in a given vault if that key vault contains an object with the same name and which is in a deleted state</span></span> 
- <span data-ttu-id="7d7db-138">Only a specifically privileged user may restore a key vault or key vault object by issuing a recover command on the corresponding proxy resource.</span><span class="sxs-lookup"><span data-stu-id="7d7db-138">Only a specifically privileged user may restore a key vault or key vault object by issuing a recover command on the corresponding proxy resource.</span></span>
    - <span data-ttu-id="7d7db-139">The user, member of the custom role, who has the privilege to create a key vault under the resource group can restore the vault.</span><span class="sxs-lookup"><span data-stu-id="7d7db-139">The user, member of the custom role, who has the privilege to create a key vault under the resource group can restore the vault.</span></span>
- <span data-ttu-id="7d7db-140">Only a specifically privileged user may forcibly delete a key vault or key vault object by issuing a delete command on the corresponding proxy resource.</span><span class="sxs-lookup"><span data-stu-id="7d7db-140">Only a specifically privileged user may forcibly delete a key vault or key vault object by issuing a delete command on the corresponding proxy resource.</span></span>

<span data-ttu-id="7d7db-141">Unless a key vault or key vault object is recovered, at the end of the retention interval the service performs a purge of the soft-deleted key vault or key vault object and its content.</span><span class="sxs-lookup"><span data-stu-id="7d7db-141">Unless a key vault or key vault object is recovered, at the end of the retention interval the service performs a purge of the soft-deleted key vault or key vault object and its content.</span></span> <span data-ttu-id="7d7db-142">Resource deletion may not be rescheduled.</span><span class="sxs-lookup"><span data-stu-id="7d7db-142">Resource deletion may not be rescheduled.</span></span>

### <a name="permitted-purge"></a><span data-ttu-id="7d7db-143">Permitted purge</span><span class="sxs-lookup"><span data-stu-id="7d7db-143">Permitted purge</span></span>

<span data-ttu-id="7d7db-144">Permanently deleting, purging, a key vault is possible via a POST operation on the proxy resource and requires special privileges.</span><span class="sxs-lookup"><span data-stu-id="7d7db-144">Permanently deleting, purging, a key vault is possible via a POST operation on the proxy resource and requires special privileges.</span></span> <span data-ttu-id="7d7db-145">Generally, only the subscription owner will be able to purge a key vault.</span><span class="sxs-lookup"><span data-stu-id="7d7db-145">Generally, only the subscription owner will be able to purge a key vault.</span></span> <span data-ttu-id="7d7db-146">The POST operation triggers the immediate and irrecoverable deletion of that vault.</span><span class="sxs-lookup"><span data-stu-id="7d7db-146">The POST operation triggers the immediate and irrecoverable deletion of that vault.</span></span> 

<span data-ttu-id="7d7db-147">An exception to this is the case when the Azure subscription has been marked as *undeletable*.</span><span class="sxs-lookup"><span data-stu-id="7d7db-147">An exception to this is the case when the Azure subscription has been marked as *undeletable*.</span></span> <span data-ttu-id="7d7db-148">In this case, only the service may then perform the actual deletion, and does so as a scheduled process.</span><span class="sxs-lookup"><span data-stu-id="7d7db-148">In this case, only the service may then perform the actual deletion, and does so as a scheduled process.</span></span> 

### <a name="billing-implications"></a><span data-ttu-id="7d7db-149">Billing implications</span><span class="sxs-lookup"><span data-stu-id="7d7db-149">Billing implications</span></span>

<span data-ttu-id="7d7db-150">In general, when an object (a key vault or a key or a secret) is in deleted state, there are only two operations possible: 'purge' and 'recover'.</span><span class="sxs-lookup"><span data-stu-id="7d7db-150">In general, when an object (a key vault or a key or a secret) is in deleted state, there are only two operations possible: 'purge' and 'recover'.</span></span> <span data-ttu-id="7d7db-151">All the other operations will fail.</span><span class="sxs-lookup"><span data-stu-id="7d7db-151">All the other operations will fail.</span></span> <span data-ttu-id="7d7db-152">Therefore, even though the object exists, no operations can be performed and hence no usage will occur, so no bill.</span><span class="sxs-lookup"><span data-stu-id="7d7db-152">Therefore, even though the object exists, no operations can be performed and hence no usage will occur, so no bill.</span></span> <span data-ttu-id="7d7db-153">However there are following exceptions:</span><span class="sxs-lookup"><span data-stu-id="7d7db-153">However there are following exceptions:</span></span>

- <span data-ttu-id="7d7db-154">'purge' and 'recover' actions will count towards normal key vault operations and will be billed.</span><span class="sxs-lookup"><span data-stu-id="7d7db-154">'purge' and 'recover' actions will count towards normal key vault operations and will be billed.</span></span>
- <span data-ttu-id="7d7db-155">If the object is an HSM-key, the 'HSM Protected key' charge per key version per month charge will apply if a key version has been used in last 30 days.</span><span class="sxs-lookup"><span data-stu-id="7d7db-155">If the object is an HSM-key, the 'HSM Protected key' charge per key version per month charge will apply if a key version has been used in last 30 days.</span></span> <span data-ttu-id="7d7db-156">After that, since the object is in deleted state no operations can be performed against it, so no charge will apply.</span><span class="sxs-lookup"><span data-stu-id="7d7db-156">After that, since the object is in deleted state no operations can be performed against it, so no charge will apply.</span></span>

## <a name="next-steps"></a><span data-ttu-id="7d7db-157">Next steps</span><span class="sxs-lookup"><span data-stu-id="7d7db-157">Next steps</span></span>

<span data-ttu-id="7d7db-158">The following two guides offer the primary usage scenarios for using soft-delete.</span><span class="sxs-lookup"><span data-stu-id="7d7db-158">The following two guides offer the primary usage scenarios for using soft-delete.</span></span>

- [<span data-ttu-id="7d7db-159">How to use Key Vault soft-delete with PowerShell</span><span class="sxs-lookup"><span data-stu-id="7d7db-159">How to use Key Vault soft-delete with PowerShell</span></span>](key-vault-soft-delete-powershell.md) 
- [<span data-ttu-id="7d7db-160">How to use Key Vault soft-delete with CLI</span><span class="sxs-lookup"><span data-stu-id="7d7db-160">How to use Key Vault soft-delete with CLI</span></span>](key-vault-soft-delete-cli.md)

