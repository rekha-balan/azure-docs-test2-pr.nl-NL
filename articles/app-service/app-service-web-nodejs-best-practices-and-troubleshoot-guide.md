---
title: Best practices and troubleshooting guide for node applications on Azure Web Apps
description: Learn the best practices and troubleshooting steps for node applications on Azure Web Apps.
services: app-service\web
documentationcenter: nodejs
author: ranjithr
manager: wadeh
editor: ''
ms.assetid: 387ea217-7910-4468-8987-9a1022a99bef
ms.service: app-service-web
ms.workload: web
ms.tgt_pltfrm: na
ms.devlang: nodejs
ms.topic: article
ms.date: 11/09/2017
ms.author: ranjithr
ms.openlocfilehash: 860874ed49056e6b4695c060b06bf061820c390e
ms.sourcegitcommit: d1451406a010fd3aa854dc8e5b77dc5537d8050e
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 09/13/2018
ms.locfileid: "44869223"
---
# <a name="best-practices-and-troubleshooting-guide-for-node-applications-on-azure-web-apps"></a><span data-ttu-id="7950c-103">Best practices and troubleshooting guide for node applications on Azure Web Apps</span><span class="sxs-lookup"><span data-stu-id="7950c-103">Best practices and troubleshooting guide for node applications on Azure Web Apps</span></span>

<span data-ttu-id="7950c-104">In this article, you learn best practices and troubleshooting steps for [node applications](app-service-web-get-started-nodejs.md) running on Azure Web Apps (with [iisnode](https://github.com/azure/iisnode)).</span><span class="sxs-lookup"><span data-stu-id="7950c-104">In this article, you learn best practices and troubleshooting steps for [node applications](app-service-web-get-started-nodejs.md) running on Azure Web Apps (with [iisnode](https://github.com/azure/iisnode)).</span></span>

> [!WARNING]
> <span data-ttu-id="7950c-105">Use caution when using troubleshooting steps on your production site.</span><span class="sxs-lookup"><span data-stu-id="7950c-105">Use caution when using troubleshooting steps on your production site.</span></span> <span data-ttu-id="7950c-106">Recommendation is to troubleshoot your app on a non-production setup for example your staging slot and when the issue is fixed, swap your staging slot with your production slot.</span><span class="sxs-lookup"><span data-stu-id="7950c-106">Recommendation is to troubleshoot your app on a non-production setup for example your staging slot and when the issue is fixed, swap your staging slot with your production slot.</span></span>
>

## <a name="iisnode-configuration"></a><span data-ttu-id="7950c-107">IISNODE configuration</span><span class="sxs-lookup"><span data-stu-id="7950c-107">IISNODE configuration</span></span>

<span data-ttu-id="7950c-108">This [schema file](https://github.com/Azure/iisnode/blob/master/src/config/iisnode_schema_x64.xml) shows all the settings that you can configure for iisnode.</span><span class="sxs-lookup"><span data-stu-id="7950c-108">This [schema file](https://github.com/Azure/iisnode/blob/master/src/config/iisnode_schema_x64.xml) shows all the settings that you can configure for iisnode.</span></span> <span data-ttu-id="7950c-109">Some of the settings that are useful for your application:</span><span class="sxs-lookup"><span data-stu-id="7950c-109">Some of the settings that are useful for your application:</span></span>

### <a name="nodeprocesscountperapplication"></a><span data-ttu-id="7950c-110">nodeProcessCountPerApplication</span><span class="sxs-lookup"><span data-stu-id="7950c-110">nodeProcessCountPerApplication</span></span>

<span data-ttu-id="7950c-111">This setting controls the number of node processes that are launched per IIS application.</span><span class="sxs-lookup"><span data-stu-id="7950c-111">This setting controls the number of node processes that are launched per IIS application.</span></span> <span data-ttu-id="7950c-112">The default value is 1.</span><span class="sxs-lookup"><span data-stu-id="7950c-112">The default value is 1.</span></span> <span data-ttu-id="7950c-113">You can launch as many node.exes as your VM vCPU count by changing the value to 0.</span><span class="sxs-lookup"><span data-stu-id="7950c-113">You can launch as many node.exes as your VM vCPU count by changing the value to 0.</span></span> <span data-ttu-id="7950c-114">The recommended value is 0 for most applications so you can use all of the vCPUs on your machine.</span><span class="sxs-lookup"><span data-stu-id="7950c-114">The recommended value is 0 for most applications so you can use all of the vCPUs on your machine.</span></span> <span data-ttu-id="7950c-115">Node.exe is single-threaded so one node.exe consumes a maximum of 1 vCPU.</span><span class="sxs-lookup"><span data-stu-id="7950c-115">Node.exe is single-threaded so one node.exe consumes a maximum of 1 vCPU.</span></span> <span data-ttu-id="7950c-116">To get maximum performance out of your node application, you want to use all vCPUs.</span><span class="sxs-lookup"><span data-stu-id="7950c-116">To get maximum performance out of your node application, you want to use all vCPUs.</span></span>

### <a name="nodeprocesscommandline"></a><span data-ttu-id="7950c-117">nodeProcessCommandLine</span><span class="sxs-lookup"><span data-stu-id="7950c-117">nodeProcessCommandLine</span></span>

<span data-ttu-id="7950c-118">This setting controls the path to the node.exe.</span><span class="sxs-lookup"><span data-stu-id="7950c-118">This setting controls the path to the node.exe.</span></span> <span data-ttu-id="7950c-119">You can set this value to point to your node.exe version.</span><span class="sxs-lookup"><span data-stu-id="7950c-119">You can set this value to point to your node.exe version.</span></span>

### <a name="maxconcurrentrequestsperprocess"></a><span data-ttu-id="7950c-120">maxConcurrentRequestsPerProcess</span><span class="sxs-lookup"><span data-stu-id="7950c-120">maxConcurrentRequestsPerProcess</span></span>

<span data-ttu-id="7950c-121">This setting controls the maximum number of concurrent requests sent by iisnode to each node.exe.</span><span class="sxs-lookup"><span data-stu-id="7950c-121">This setting controls the maximum number of concurrent requests sent by iisnode to each node.exe.</span></span> <span data-ttu-id="7950c-122">On Azure Web Apps, the default value is Infinite.</span><span class="sxs-lookup"><span data-stu-id="7950c-122">On Azure Web Apps, the default value is Infinite.</span></span> <span data-ttu-id="7950c-123">When not hosted on Azure Web Apps, the default value is 1024.</span><span class="sxs-lookup"><span data-stu-id="7950c-123">When not hosted on Azure Web Apps, the default value is 1024.</span></span> <span data-ttu-id="7950c-124">You can configure the value depending on how many requests your application receives and how fast your application processes each request.</span><span class="sxs-lookup"><span data-stu-id="7950c-124">You can configure the value depending on how many requests your application receives and how fast your application processes each request.</span></span>

### <a name="maxnamedpipeconnectionretry"></a><span data-ttu-id="7950c-125">maxNamedPipeConnectionRetry</span><span class="sxs-lookup"><span data-stu-id="7950c-125">maxNamedPipeConnectionRetry</span></span>

<span data-ttu-id="7950c-126">This setting controls the maximum number of times iisnode retries making the connection on the named pipe to send the requests to node.exe.</span><span class="sxs-lookup"><span data-stu-id="7950c-126">This setting controls the maximum number of times iisnode retries making the connection on the named pipe to send the requests to node.exe.</span></span> <span data-ttu-id="7950c-127">This setting in combination with namedPipeConnectionRetryDelay determines the total timeout of each request within iisnode.</span><span class="sxs-lookup"><span data-stu-id="7950c-127">This setting in combination with namedPipeConnectionRetryDelay determines the total timeout of each request within iisnode.</span></span> <span data-ttu-id="7950c-128">The default value is 200 on Azure Web Apps.</span><span class="sxs-lookup"><span data-stu-id="7950c-128">The default value is 200 on Azure Web Apps.</span></span> <span data-ttu-id="7950c-129">Total Timeout in seconds = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span><span class="sxs-lookup"><span data-stu-id="7950c-129">Total Timeout in seconds = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span></span>

### <a name="namedpipeconnectionretrydelay"></a><span data-ttu-id="7950c-130">namedPipeConnectionRetryDelay</span><span class="sxs-lookup"><span data-stu-id="7950c-130">namedPipeConnectionRetryDelay</span></span>

<span data-ttu-id="7950c-131">This setting controls the amount of time (in ms) iisnode waits between each retry to send the request to node.exe over the named pipe.</span><span class="sxs-lookup"><span data-stu-id="7950c-131">This setting controls the amount of time (in ms) iisnode waits between each retry to send the request to node.exe over the named pipe.</span></span> <span data-ttu-id="7950c-132">The default value is 250 ms.</span><span class="sxs-lookup"><span data-stu-id="7950c-132">The default value is 250 ms.</span></span>
<span data-ttu-id="7950c-133">Total Timeout in seconds = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span><span class="sxs-lookup"><span data-stu-id="7950c-133">Total Timeout in seconds = (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000</span></span>

<span data-ttu-id="7950c-134">By default, the total timeout in iisnode on Azure Web Apps is 200 \* 250 ms = 50 seconds.</span><span class="sxs-lookup"><span data-stu-id="7950c-134">By default, the total timeout in iisnode on Azure Web Apps is 200 \* 250 ms = 50 seconds.</span></span>

### <a name="logdirectory"></a><span data-ttu-id="7950c-135">logDirectory</span><span class="sxs-lookup"><span data-stu-id="7950c-135">logDirectory</span></span>

<span data-ttu-id="7950c-136">This setting controls the directory where iisnode logs stdout/stderr.</span><span class="sxs-lookup"><span data-stu-id="7950c-136">This setting controls the directory where iisnode logs stdout/stderr.</span></span> <span data-ttu-id="7950c-137">The default value is iisnode, which is relative to the main script directory (directory where main server.js is present)</span><span class="sxs-lookup"><span data-stu-id="7950c-137">The default value is iisnode, which is relative to the main script directory (directory where main server.js is present)</span></span>

### <a name="debuggerextensiondll"></a><span data-ttu-id="7950c-138">debuggerExtensionDll</span><span class="sxs-lookup"><span data-stu-id="7950c-138">debuggerExtensionDll</span></span>

<span data-ttu-id="7950c-139">This setting controls what version of node-inspector iisnode uses when debugging your node application.</span><span class="sxs-lookup"><span data-stu-id="7950c-139">This setting controls what version of node-inspector iisnode uses when debugging your node application.</span></span> <span data-ttu-id="7950c-140">Currently, iisnode-inspector-0.7.3.dll and iisnode-inspector.dll are the only two valid values for this setting.</span><span class="sxs-lookup"><span data-stu-id="7950c-140">Currently, iisnode-inspector-0.7.3.dll and iisnode-inspector.dll are the only two valid values for this setting.</span></span> <span data-ttu-id="7950c-141">The default value is iisnode-inspector-0.7.3.dll.</span><span class="sxs-lookup"><span data-stu-id="7950c-141">The default value is iisnode-inspector-0.7.3.dll.</span></span> <span data-ttu-id="7950c-142">The iisnode-inspector-0.7.3.dll version uses node-inspector-0.7.3 and uses web sockets.</span><span class="sxs-lookup"><span data-stu-id="7950c-142">The iisnode-inspector-0.7.3.dll version uses node-inspector-0.7.3 and uses web sockets.</span></span> <span data-ttu-id="7950c-143">Enable web sockets on your Azure webapp to use this version.</span><span class="sxs-lookup"><span data-stu-id="7950c-143">Enable web sockets on your Azure webapp to use this version.</span></span> <span data-ttu-id="7950c-144">See <http://ranjithblogs.azurewebsites.net/?p=98> for more details on how to configure iisnode to use the new node-inspector.</span><span class="sxs-lookup"><span data-stu-id="7950c-144">See <http://ranjithblogs.azurewebsites.net/?p=98> for more details on how to configure iisnode to use the new node-inspector.</span></span>

### <a name="flushresponse"></a><span data-ttu-id="7950c-145">flushResponse</span><span class="sxs-lookup"><span data-stu-id="7950c-145">flushResponse</span></span>

<span data-ttu-id="7950c-146">The default behavior of IIS is that it buffers response data up to 4 MB before flushing, or until the end of the response, whichever comes first.</span><span class="sxs-lookup"><span data-stu-id="7950c-146">The default behavior of IIS is that it buffers response data up to 4 MB before flushing, or until the end of the response, whichever comes first.</span></span> <span data-ttu-id="7950c-147">iisnode offers a configuration setting to override this behavior: to flush a fragment of the response entity body as soon as iisnode receives it from node.exe, you need to set the iisnode/@flushResponse attribute in web.config to 'true':</span><span class="sxs-lookup"><span data-stu-id="7950c-147">iisnode offers a configuration setting to override this behavior: to flush a fragment of the response entity body as soon as iisnode receives it from node.exe, you need to set the iisnode/@flushResponse attribute in web.config to 'true':</span></span>

```xml
<configuration>
    <system.webServer>
        <!-- ... -->
        <iisnode flushResponse="true" />
    </system.webServer>
</configuration>
```

<span data-ttu-id="7950c-148">Enable the flushing of every fragment of the response entity body adds performance overhead that reduces the throughput of the system by ~5% (as of v0.1.13).</span><span class="sxs-lookup"><span data-stu-id="7950c-148">Enable the flushing of every fragment of the response entity body adds performance overhead that reduces the throughput of the system by ~5% (as of v0.1.13).</span></span> <span data-ttu-id="7950c-149">The best to scope this setting only to endpoints that require response streaming (for example, using the `<location>` element in the web.config)</span><span class="sxs-lookup"><span data-stu-id="7950c-149">The best to scope this setting only to endpoints that require response streaming (for example, using the `<location>` element in the web.config)</span></span>

<span data-ttu-id="7950c-150">In addition to this, for streaming applications, you must also set responseBufferLimit of your iisnode handler to 0.</span><span class="sxs-lookup"><span data-stu-id="7950c-150">In addition to this, for streaming applications, you must also set responseBufferLimit of your iisnode handler to 0.</span></span>

```xml
<handlers>
    <add name="iisnode" path="app.js" verb="\*" modules="iisnode" responseBufferLimit="0"/>
</handlers>
```

### <a name="watchedfiles"></a><span data-ttu-id="7950c-151">watchedFiles</span><span class="sxs-lookup"><span data-stu-id="7950c-151">watchedFiles</span></span>

<span data-ttu-id="7950c-152">A semi-colon separated list of files that are watched for changes.</span><span class="sxs-lookup"><span data-stu-id="7950c-152">A semi-colon separated list of files that are watched for changes.</span></span> <span data-ttu-id="7950c-153">Any change to a file causes the application to recycle.</span><span class="sxs-lookup"><span data-stu-id="7950c-153">Any change to a file causes the application to recycle.</span></span> <span data-ttu-id="7950c-154">Each entry consists of an optional directory name as well as a required file name, which are relative to the directory where the main application entry point is located.</span><span class="sxs-lookup"><span data-stu-id="7950c-154">Each entry consists of an optional directory name as well as a required file name, which are relative to the directory where the main application entry point is located.</span></span> <span data-ttu-id="7950c-155">Wild cards are allowed in the file name portion only.</span><span class="sxs-lookup"><span data-stu-id="7950c-155">Wild cards are allowed in the file name portion only.</span></span> <span data-ttu-id="7950c-156">The default value is `*.js;web.config`</span><span class="sxs-lookup"><span data-stu-id="7950c-156">The default value is `*.js;web.config`</span></span>

### <a name="recyclesignalenabled"></a><span data-ttu-id="7950c-157">recycleSignalEnabled</span><span class="sxs-lookup"><span data-stu-id="7950c-157">recycleSignalEnabled</span></span>

<span data-ttu-id="7950c-158">The default value is false.</span><span class="sxs-lookup"><span data-stu-id="7950c-158">The default value is false.</span></span> <span data-ttu-id="7950c-159">If enabled, your node application can connect to a named pipe (environment variable IISNODE\_CONTROL\_PIPE) and send a “recycle” message.</span><span class="sxs-lookup"><span data-stu-id="7950c-159">If enabled, your node application can connect to a named pipe (environment variable IISNODE\_CONTROL\_PIPE) and send a “recycle” message.</span></span> <span data-ttu-id="7950c-160">This causes the w3wp to recycle gracefully.</span><span class="sxs-lookup"><span data-stu-id="7950c-160">This causes the w3wp to recycle gracefully.</span></span>

### <a name="idlepageouttimeperiod"></a><span data-ttu-id="7950c-161">idlePageOutTimePeriod</span><span class="sxs-lookup"><span data-stu-id="7950c-161">idlePageOutTimePeriod</span></span>

<span data-ttu-id="7950c-162">The default value is 0, which means this feature is disabled.</span><span class="sxs-lookup"><span data-stu-id="7950c-162">The default value is 0, which means this feature is disabled.</span></span> <span data-ttu-id="7950c-163">When set to some value greater than 0, iisnode will page out all its child processes every ‘idlePageOutTimePeriod’ in milliseconds.</span><span class="sxs-lookup"><span data-stu-id="7950c-163">When set to some value greater than 0, iisnode will page out all its child processes every ‘idlePageOutTimePeriod’ in milliseconds.</span></span> <span data-ttu-id="7950c-164">See [documentation](https://msdn.microsoft.com/library/windows/desktop/ms682606.aspx) to understand what page out means.</span><span class="sxs-lookup"><span data-stu-id="7950c-164">See [documentation](https://msdn.microsoft.com/library/windows/desktop/ms682606.aspx) to understand what page out means.</span></span> <span data-ttu-id="7950c-165">This setting is useful for applications that consume a high amount of memory and want to page out memory to disk occasionally to free up RAM.</span><span class="sxs-lookup"><span data-stu-id="7950c-165">This setting is useful for applications that consume a high amount of memory and want to page out memory to disk occasionally to free up RAM.</span></span>

> [!WARNING]
> <span data-ttu-id="7950c-166">Use caution when enabling the following configuration settings on production applications.</span><span class="sxs-lookup"><span data-stu-id="7950c-166">Use caution when enabling the following configuration settings on production applications.</span></span> <span data-ttu-id="7950c-167">The recommendation is to not enable them on live production applications.</span><span class="sxs-lookup"><span data-stu-id="7950c-167">The recommendation is to not enable them on live production applications.</span></span>
>

### <a name="debugheaderenabled"></a><span data-ttu-id="7950c-168">debugHeaderEnabled</span><span class="sxs-lookup"><span data-stu-id="7950c-168">debugHeaderEnabled</span></span>

<span data-ttu-id="7950c-169">The default value is false.</span><span class="sxs-lookup"><span data-stu-id="7950c-169">The default value is false.</span></span> <span data-ttu-id="7950c-170">If set to true, iisnode adds an HTTP response header `iisnode-debug` to every HTTP response it sends the `iisnode-debug` header value is a URL.</span><span class="sxs-lookup"><span data-stu-id="7950c-170">If set to true, iisnode adds an HTTP response header `iisnode-debug` to every HTTP response it sends the `iisnode-debug` header value is a URL.</span></span> <span data-ttu-id="7950c-171">Individual pieces of diagnostic information can be obtained by looking at the URL fragment, however, a visualization is available by opening the URL in a browser.</span><span class="sxs-lookup"><span data-stu-id="7950c-171">Individual pieces of diagnostic information can be obtained by looking at the URL fragment, however, a visualization is available by opening the URL in a browser.</span></span>

### <a name="loggingenabled"></a><span data-ttu-id="7950c-172">loggingEnabled</span><span class="sxs-lookup"><span data-stu-id="7950c-172">loggingEnabled</span></span>

<span data-ttu-id="7950c-173">This setting controls the logging of stdout and stderr by iisnode.</span><span class="sxs-lookup"><span data-stu-id="7950c-173">This setting controls the logging of stdout and stderr by iisnode.</span></span> <span data-ttu-id="7950c-174">Iisnode captures stdout/stderr from node processes it launches and writes to the directory specified in the ‘logDirectory’ setting.</span><span class="sxs-lookup"><span data-stu-id="7950c-174">Iisnode captures stdout/stderr from node processes it launches and writes to the directory specified in the ‘logDirectory’ setting.</span></span> <span data-ttu-id="7950c-175">Once this is enabled, your application writes logs to the file system and depending on the amount of logging done by the application, there could be performance implications.</span><span class="sxs-lookup"><span data-stu-id="7950c-175">Once this is enabled, your application writes logs to the file system and depending on the amount of logging done by the application, there could be performance implications.</span></span>

### <a name="deverrorsenabled"></a><span data-ttu-id="7950c-176">devErrorsEnabled</span><span class="sxs-lookup"><span data-stu-id="7950c-176">devErrorsEnabled</span></span>

<span data-ttu-id="7950c-177">The default value is false.</span><span class="sxs-lookup"><span data-stu-id="7950c-177">The default value is false.</span></span> <span data-ttu-id="7950c-178">When set to true, iisnode displays the HTTP status code and Win32 error code on your browser.</span><span class="sxs-lookup"><span data-stu-id="7950c-178">When set to true, iisnode displays the HTTP status code and Win32 error code on your browser.</span></span> <span data-ttu-id="7950c-179">The win32 code is helpful in debugging certain types of issues.</span><span class="sxs-lookup"><span data-stu-id="7950c-179">The win32 code is helpful in debugging certain types of issues.</span></span>

### <a name="debuggingenabled-do-not-enable-on-live-production-site"></a><span data-ttu-id="7950c-180">debuggingEnabled (do not enable on live production site)</span><span class="sxs-lookup"><span data-stu-id="7950c-180">debuggingEnabled (do not enable on live production site)</span></span>

<span data-ttu-id="7950c-181">This setting controls debugging feature.</span><span class="sxs-lookup"><span data-stu-id="7950c-181">This setting controls debugging feature.</span></span> <span data-ttu-id="7950c-182">Iisnode is integrated with node-inspector.</span><span class="sxs-lookup"><span data-stu-id="7950c-182">Iisnode is integrated with node-inspector.</span></span> <span data-ttu-id="7950c-183">By enabling this setting, you enable debugging of your node application.</span><span class="sxs-lookup"><span data-stu-id="7950c-183">By enabling this setting, you enable debugging of your node application.</span></span> <span data-ttu-id="7950c-184">Upon enabling this setting, iisnode creates node-inspector files in ‘debuggerVirtualDir’ directory on the first debug request to your node application.</span><span class="sxs-lookup"><span data-stu-id="7950c-184">Upon enabling this setting, iisnode creates node-inspector files in ‘debuggerVirtualDir’ directory on the first debug request to your node application.</span></span> <span data-ttu-id="7950c-185">You can load the node-inspector by sending a request to http://yoursite/server.js/debug.</span><span class="sxs-lookup"><span data-stu-id="7950c-185">You can load the node-inspector by sending a request to http://yoursite/server.js/debug.</span></span> <span data-ttu-id="7950c-186">You can control the debug URL segment with ‘debuggerPathSegment’ setting.</span><span class="sxs-lookup"><span data-stu-id="7950c-186">You can control the debug URL segment with ‘debuggerPathSegment’ setting.</span></span> <span data-ttu-id="7950c-187">By default, debuggerPathSegment=’debug’.</span><span class="sxs-lookup"><span data-stu-id="7950c-187">By default, debuggerPathSegment=’debug’.</span></span> <span data-ttu-id="7950c-188">You can set `debuggerPathSegment` to a GUID, for example, so that it is more difficult to be discovered by others.</span><span class="sxs-lookup"><span data-stu-id="7950c-188">You can set `debuggerPathSegment` to a GUID, for example, so that it is more difficult to be discovered by others.</span></span>

<span data-ttu-id="7950c-189">Read [Debug node.js applications on Windows](https://tomasz.janczuk.org/2011/11/debug-nodejs-applications-on-windows.html) for more details on debugging.</span><span class="sxs-lookup"><span data-stu-id="7950c-189">Read [Debug node.js applications on Windows](https://tomasz.janczuk.org/2011/11/debug-nodejs-applications-on-windows.html) for more details on debugging.</span></span>

## <a name="scenarios-and-recommendationstroubleshooting"></a><span data-ttu-id="7950c-190">Scenarios and recommendations/troubleshooting</span><span class="sxs-lookup"><span data-stu-id="7950c-190">Scenarios and recommendations/troubleshooting</span></span>

### <a name="my-node-application-is-making-excessive-outbound-calls"></a><span data-ttu-id="7950c-191">My node application is making excessive outbound calls</span><span class="sxs-lookup"><span data-stu-id="7950c-191">My node application is making excessive outbound calls</span></span>

<span data-ttu-id="7950c-192">Many applications would want to make outbound connections as part of their regular operation.</span><span class="sxs-lookup"><span data-stu-id="7950c-192">Many applications would want to make outbound connections as part of their regular operation.</span></span> <span data-ttu-id="7950c-193">For example, when a request comes in, your node app would want to contact a REST API elsewhere and get some information to process the request.</span><span class="sxs-lookup"><span data-stu-id="7950c-193">For example, when a request comes in, your node app would want to contact a REST API elsewhere and get some information to process the request.</span></span> <span data-ttu-id="7950c-194">You would want to use a keep alive agent when making http or https calls.</span><span class="sxs-lookup"><span data-stu-id="7950c-194">You would want to use a keep alive agent when making http or https calls.</span></span> <span data-ttu-id="7950c-195">You could use the agentkeepalive module as your keep alive agent when making these outbound calls.</span><span class="sxs-lookup"><span data-stu-id="7950c-195">You could use the agentkeepalive module as your keep alive agent when making these outbound calls.</span></span>

<span data-ttu-id="7950c-196">The agentkeepalive module ensures that sockets are reused on your Azure webapp VM.</span><span class="sxs-lookup"><span data-stu-id="7950c-196">The agentkeepalive module ensures that sockets are reused on your Azure webapp VM.</span></span> <span data-ttu-id="7950c-197">Creating a new socket on each outbound request adds overhead to your application.</span><span class="sxs-lookup"><span data-stu-id="7950c-197">Creating a new socket on each outbound request adds overhead to your application.</span></span> <span data-ttu-id="7950c-198">Having your application reuse sockets for outbound requests ensures that your application doesn't exceed the maxSockets that are allocated per VM.</span><span class="sxs-lookup"><span data-stu-id="7950c-198">Having your application reuse sockets for outbound requests ensures that your application doesn't exceed the maxSockets that are allocated per VM.</span></span> <span data-ttu-id="7950c-199">The recommendation on Azure Web Apps is to set the agentKeepAlive maxSockets value to a total of (4 instances of node.exe \* 40 maxSockets/instance) 160 sockets per VM.</span><span class="sxs-lookup"><span data-stu-id="7950c-199">The recommendation on Azure Web Apps is to set the agentKeepAlive maxSockets value to a total of (4 instances of node.exe \* 40 maxSockets/instance) 160 sockets per VM.</span></span>

<span data-ttu-id="7950c-200">Example [agentKeepALive](https://www.npmjs.com/package/agentkeepalive) configuration:</span><span class="sxs-lookup"><span data-stu-id="7950c-200">Example [agentKeepALive](https://www.npmjs.com/package/agentkeepalive) configuration:</span></span>

```nodejs
var keepaliveAgent = new Agent({
    maxSockets: 40,
    maxFreeSockets: 10,
    timeout: 60000,
    keepAliveTimeout: 300000
});
```

> [!IMPORTANT]
> <span data-ttu-id="7950c-201">This example assumes you have 4 node.exe running on your VM.</span><span class="sxs-lookup"><span data-stu-id="7950c-201">This example assumes you have 4 node.exe running on your VM.</span></span> <span data-ttu-id="7950c-202">If you have a different number of node.exe running on the VM, you must modify the maxSockets setting accordingly.</span><span class="sxs-lookup"><span data-stu-id="7950c-202">If you have a different number of node.exe running on the VM, you must modify the maxSockets setting accordingly.</span></span>
>

#### <a name="my-node-application-is-consuming-too-much-cpu"></a><span data-ttu-id="7950c-203">My node application is consuming too much CPU</span><span class="sxs-lookup"><span data-stu-id="7950c-203">My node application is consuming too much CPU</span></span>

<span data-ttu-id="7950c-204">You may receive a recommendation from Azure Web Apps on your portal about high cpu consumption.</span><span class="sxs-lookup"><span data-stu-id="7950c-204">You may receive a recommendation from Azure Web Apps on your portal about high cpu consumption.</span></span> <span data-ttu-id="7950c-205">You can also set up monitors to watch for certain [metrics](web-sites-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="7950c-205">You can also set up monitors to watch for certain [metrics](web-sites-monitor.md).</span></span> <span data-ttu-id="7950c-206">When checking the CPU usage on the [Azure Portal Dashboard](../application-insights/app-insights-web-monitor-performance.md), check the MAX values for CPU so you don’t miss the peak values.</span><span class="sxs-lookup"><span data-stu-id="7950c-206">When checking the CPU usage on the [Azure Portal Dashboard](../application-insights/app-insights-web-monitor-performance.md), check the MAX values for CPU so you don’t miss the peak values.</span></span>
<span data-ttu-id="7950c-207">If you believe your application is consuming too much CPU and you cannot explain why, you can profile your node application to find out.</span><span class="sxs-lookup"><span data-stu-id="7950c-207">If you believe your application is consuming too much CPU and you cannot explain why, you can profile your node application to find out.</span></span>

#### <a name="profiling-your-node-application-on-azure-web-apps-with-v8-profiler"></a><span data-ttu-id="7950c-208">Profiling your node application on Azure Web Apps with V8-Profiler</span><span class="sxs-lookup"><span data-stu-id="7950c-208">Profiling your node application on Azure Web Apps with V8-Profiler</span></span>

<span data-ttu-id="7950c-209">For example, let's say you have a hello world app that you want to profile as follows:</span><span class="sxs-lookup"><span data-stu-id="7950c-209">For example, let's say you have a hello world app that you want to profile as follows:</span></span>

```nodejs
var http = require('http');
function WriteConsoleLog() {
    for(var i=0;i<99999;++i) {
        console.log('hello world');
    }
}

function HandleRequest() {
    WriteConsoleLog();
}

http.createServer(function (req, res) {
    res.writeHead(200, {'Content-Type': 'text/html'});
    HandleRequest();
    res.end('Hello world!');
}).listen(process.env.PORT);
```

<span data-ttu-id="7950c-210">Go to the Debug Console site https://yoursite.scm.azurewebsites.net/DebugConsole</span><span class="sxs-lookup"><span data-stu-id="7950c-210">Go to the Debug Console site https://yoursite.scm.azurewebsites.net/DebugConsole</span></span>

<span data-ttu-id="7950c-211">Go into your site/wwwroot directory.</span><span class="sxs-lookup"><span data-stu-id="7950c-211">Go into your site/wwwroot directory.</span></span> <span data-ttu-id="7950c-212">You see a command prompt as shown in the following example:</span><span class="sxs-lookup"><span data-stu-id="7950c-212">You see a command prompt as shown in the following example:</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/scm_install_v8.png)

<span data-ttu-id="7950c-213">Run the command `npm install v8-profiler`.</span><span class="sxs-lookup"><span data-stu-id="7950c-213">Run the command `npm install v8-profiler`.</span></span>

<span data-ttu-id="7950c-214">This command installs the v8-profiler under node\_modules directory and all of its dependencies.</span><span class="sxs-lookup"><span data-stu-id="7950c-214">This command installs the v8-profiler under node\_modules directory and all of its dependencies.</span></span>
<span data-ttu-id="7950c-215">Now, edit your server.js to profile your application.</span><span class="sxs-lookup"><span data-stu-id="7950c-215">Now, edit your server.js to profile your application.</span></span>

```nodejs
var http = require('http');
var profiler = require('v8-profiler');
var fs = require('fs');

function WriteConsoleLog() {
    for(var i=0;i<99999;++i) {
        console.log('hello world');
    }
}

function HandleRequest() {
    profiler.startProfiling('HandleRequest');
    WriteConsoleLog();
    fs.writeFileSync('profile.cpuprofile', JSON.stringify(profiler.stopProfiling('HandleRequest')));
}

http.createServer(function (req, res) {
    res.writeHead(200, {'Content-Type': 'text/html'});
    HandleRequest();
    res.end('Hello world!');
}).listen(process.env.PORT);
```

<span data-ttu-id="7950c-216">The preceding code profiles the WriteConsoleLog function and then writes the profile output to the ‘profile.cpuprofile’ file under your site wwwroot.</span><span class="sxs-lookup"><span data-stu-id="7950c-216">The preceding code profiles the WriteConsoleLog function and then writes the profile output to the ‘profile.cpuprofile’ file under your site wwwroot.</span></span> <span data-ttu-id="7950c-217">Send a request to your application.</span><span class="sxs-lookup"><span data-stu-id="7950c-217">Send a request to your application.</span></span> <span data-ttu-id="7950c-218">You see a ‘profile.cpuprofile’ file created under your site wwwroot.</span><span class="sxs-lookup"><span data-stu-id="7950c-218">You see a ‘profile.cpuprofile’ file created under your site wwwroot.</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/scm_profile.cpuprofile.png)

<span data-ttu-id="7950c-219">Download this file and open it with Chrome F12 Tools.</span><span class="sxs-lookup"><span data-stu-id="7950c-219">Download this file and open it with Chrome F12 Tools.</span></span> <span data-ttu-id="7950c-220">Press F12 on Chrome, then choose the **Profiles** tab. Choose the **Load** button.</span><span class="sxs-lookup"><span data-stu-id="7950c-220">Press F12 on Chrome, then choose the **Profiles** tab. Choose the **Load** button.</span></span> <span data-ttu-id="7950c-221">Select your profile.cpuprofile file that you downloaded.</span><span class="sxs-lookup"><span data-stu-id="7950c-221">Select your profile.cpuprofile file that you downloaded.</span></span> <span data-ttu-id="7950c-222">Click on the profile you just loaded.</span><span class="sxs-lookup"><span data-stu-id="7950c-222">Click on the profile you just loaded.</span></span>

![](./media/app-service-web-nodejs-best-practices-and-troubleshoot-guide/chrome_tools_view.png)

<span data-ttu-id="7950c-223">You can see that 95% of the time was consumed by the WriteConsoleLog function.</span><span class="sxs-lookup"><span data-stu-id="7950c-223">You can see that 95% of the time was consumed by the WriteConsoleLog function.</span></span> <span data-ttu-id="7950c-224">The output also shows you the exact line numbers and source files that caused the issue.</span><span class="sxs-lookup"><span data-stu-id="7950c-224">The output also shows you the exact line numbers and source files that caused the issue.</span></span>

### <a name="my-node-application-is-consuming-too-much-memory"></a><span data-ttu-id="7950c-225">My node application is consuming too much memory</span><span class="sxs-lookup"><span data-stu-id="7950c-225">My node application is consuming too much memory</span></span>

<span data-ttu-id="7950c-226">If your application is consuming too much memory, you see a notice from Azure Web Apps on your portal about high memory consumption.</span><span class="sxs-lookup"><span data-stu-id="7950c-226">If your application is consuming too much memory, you see a notice from Azure Web Apps on your portal about high memory consumption.</span></span> <span data-ttu-id="7950c-227">You can set up monitors to watch for certain [metrics](web-sites-monitor.md).</span><span class="sxs-lookup"><span data-stu-id="7950c-227">You can set up monitors to watch for certain [metrics](web-sites-monitor.md).</span></span> <span data-ttu-id="7950c-228">When checking the memory usage on the [Azure Portal Dashboard](../application-insights/app-insights-web-monitor-performance.md), be sure to check the MAX values for memory so you don’t miss the peak values.</span><span class="sxs-lookup"><span data-stu-id="7950c-228">When checking the memory usage on the [Azure Portal Dashboard](../application-insights/app-insights-web-monitor-performance.md), be sure to check the MAX values for memory so you don’t miss the peak values.</span></span>

#### <a name="leak-detection-and-heap-diff-for-nodejs"></a><span data-ttu-id="7950c-229">Leak detection and Heap Diff for node.js</span><span class="sxs-lookup"><span data-stu-id="7950c-229">Leak detection and Heap Diff for node.js</span></span>

<span data-ttu-id="7950c-230">You could use [node-memwatch](https://github.com/lloyd/node-memwatch) to help you identify memory leaks.</span><span class="sxs-lookup"><span data-stu-id="7950c-230">You could use [node-memwatch](https://github.com/lloyd/node-memwatch) to help you identify memory leaks.</span></span>
<span data-ttu-id="7950c-231">You can install `memwatch` just like v8-profiler and edit your code to capture and diff heaps to identify the memory leaks in your application.</span><span class="sxs-lookup"><span data-stu-id="7950c-231">You can install `memwatch` just like v8-profiler and edit your code to capture and diff heaps to identify the memory leaks in your application.</span></span>

### <a name="my-nodeexes-are-getting-killed-randomly"></a><span data-ttu-id="7950c-232">My node.exe’s are getting killed randomly</span><span class="sxs-lookup"><span data-stu-id="7950c-232">My node.exe’s are getting killed randomly</span></span>

<span data-ttu-id="7950c-233">There are a few reasons why node.exe is shut down randomly:</span><span class="sxs-lookup"><span data-stu-id="7950c-233">There are a few reasons why node.exe is shut down randomly:</span></span>

1. <span data-ttu-id="7950c-234">Your application is throwing uncaught exceptions – Check d:\\home\\LogFiles\\Application\\logging-errors.txt file for the details on the exception thrown.</span><span class="sxs-lookup"><span data-stu-id="7950c-234">Your application is throwing uncaught exceptions – Check d:\\home\\LogFiles\\Application\\logging-errors.txt file for the details on the exception thrown.</span></span> <span data-ttu-id="7950c-235">This file has the stack trace to help debug and fix your application.</span><span class="sxs-lookup"><span data-stu-id="7950c-235">This file has the stack trace to help debug and fix your application.</span></span>
2. <span data-ttu-id="7950c-236">Your application is consuming too much memory, which is affecting other processes from getting started.</span><span class="sxs-lookup"><span data-stu-id="7950c-236">Your application is consuming too much memory, which is affecting other processes from getting started.</span></span> <span data-ttu-id="7950c-237">If the total VM memory is close to 100%, your node.exe’s could be killed by the process manager.</span><span class="sxs-lookup"><span data-stu-id="7950c-237">If the total VM memory is close to 100%, your node.exe’s could be killed by the process manager.</span></span> <span data-ttu-id="7950c-238">Process manager kills some processes to let other processes get a chance to do some work.</span><span class="sxs-lookup"><span data-stu-id="7950c-238">Process manager kills some processes to let other processes get a chance to do some work.</span></span> <span data-ttu-id="7950c-239">To fix this issue, profile your application for memory leaks.</span><span class="sxs-lookup"><span data-stu-id="7950c-239">To fix this issue, profile your application for memory leaks.</span></span> <span data-ttu-id="7950c-240">If your application requires large amounts of memory, scale up to a larger VM (which increases the RAM available to the VM).</span><span class="sxs-lookup"><span data-stu-id="7950c-240">If your application requires large amounts of memory, scale up to a larger VM (which increases the RAM available to the VM).</span></span>

### <a name="my-node-application-does-not-start"></a><span data-ttu-id="7950c-241">My node application does not start</span><span class="sxs-lookup"><span data-stu-id="7950c-241">My node application does not start</span></span>

<span data-ttu-id="7950c-242">If your application is returning 500 Errors when it starts, there could be a few reasons:</span><span class="sxs-lookup"><span data-stu-id="7950c-242">If your application is returning 500 Errors when it starts, there could be a few reasons:</span></span>

1. <span data-ttu-id="7950c-243">Node.exe is not present at the correct location.</span><span class="sxs-lookup"><span data-stu-id="7950c-243">Node.exe is not present at the correct location.</span></span> <span data-ttu-id="7950c-244">Check nodeProcessCommandLine setting.</span><span class="sxs-lookup"><span data-stu-id="7950c-244">Check nodeProcessCommandLine setting.</span></span>
2. <span data-ttu-id="7950c-245">Main script file is not present at the correct location.</span><span class="sxs-lookup"><span data-stu-id="7950c-245">Main script file is not present at the correct location.</span></span> <span data-ttu-id="7950c-246">Check web.config and make sure the name of the main script file in the handlers section matches the main script file.</span><span class="sxs-lookup"><span data-stu-id="7950c-246">Check web.config and make sure the name of the main script file in the handlers section matches the main script file.</span></span>
3. <span data-ttu-id="7950c-247">Web.config configuration is not correct – check the settings names/values.</span><span class="sxs-lookup"><span data-stu-id="7950c-247">Web.config configuration is not correct – check the settings names/values.</span></span>
4. <span data-ttu-id="7950c-248">Cold Start – Your application is taking too long to start.</span><span class="sxs-lookup"><span data-stu-id="7950c-248">Cold Start – Your application is taking too long to start.</span></span> <span data-ttu-id="7950c-249">If your application takes longer than (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000 seconds, iisnode returns a 500 error.</span><span class="sxs-lookup"><span data-stu-id="7950c-249">If your application takes longer than (maxNamedPipeConnectionRetry \* namedPipeConnectionRetryDelay) / 1000 seconds, iisnode returns a 500 error.</span></span> <span data-ttu-id="7950c-250">Increase the values of these settings to match your application start time to prevent iisnode from timing out and returning the 500 error.</span><span class="sxs-lookup"><span data-stu-id="7950c-250">Increase the values of these settings to match your application start time to prevent iisnode from timing out and returning the 500 error.</span></span>

### <a name="my-node-application-crashed"></a><span data-ttu-id="7950c-251">My node application crashed</span><span class="sxs-lookup"><span data-stu-id="7950c-251">My node application crashed</span></span>

<span data-ttu-id="7950c-252">Your application is throwing uncaught exceptions – Check `d:\\home\\LogFiles\\Application\\logging-errors.txt` file for the details on the exception thrown.</span><span class="sxs-lookup"><span data-stu-id="7950c-252">Your application is throwing uncaught exceptions – Check `d:\\home\\LogFiles\\Application\\logging-errors.txt` file for the details on the exception thrown.</span></span> <span data-ttu-id="7950c-253">This file has the stack trace to help diagnose and fix your application.</span><span class="sxs-lookup"><span data-stu-id="7950c-253">This file has the stack trace to help diagnose and fix your application.</span></span>

### <a name="my-node-application-takes-too-much-time-to-start-cold-start"></a><span data-ttu-id="7950c-254">My node application takes too much time to start (Cold Start)</span><span class="sxs-lookup"><span data-stu-id="7950c-254">My node application takes too much time to start (Cold Start)</span></span>

<span data-ttu-id="7950c-255">The common cause for long application start times is a high number of files in the node\_modules.</span><span class="sxs-lookup"><span data-stu-id="7950c-255">The common cause for long application start times is a high number of files in the node\_modules.</span></span> <span data-ttu-id="7950c-256">The application tries to load most of these files when starting.</span><span class="sxs-lookup"><span data-stu-id="7950c-256">The application tries to load most of these files when starting.</span></span> <span data-ttu-id="7950c-257">By default, since your files are stored on the network share on Azure Web Apps, loading many files can take time.</span><span class="sxs-lookup"><span data-stu-id="7950c-257">By default, since your files are stored on the network share on Azure Web Apps, loading many files can take time.</span></span>
<span data-ttu-id="7950c-258">Some solutions to make this process faster are:</span><span class="sxs-lookup"><span data-stu-id="7950c-258">Some solutions to make this process faster are:</span></span>

1. <span data-ttu-id="7950c-259">Be sure you have a flat dependency structure and no duplicate dependencies by using npm3 to install your modules.</span><span class="sxs-lookup"><span data-stu-id="7950c-259">Be sure you have a flat dependency structure and no duplicate dependencies by using npm3 to install your modules.</span></span>
2. <span data-ttu-id="7950c-260">Try to lazy load your node\_modules and not load all of the modules at application start.</span><span class="sxs-lookup"><span data-stu-id="7950c-260">Try to lazy load your node\_modules and not load all of the modules at application start.</span></span> <span data-ttu-id="7950c-261">To Lazy load modules, the call to require(‘module’) should be made when you actually need the module within the function before the first execution of module code.</span><span class="sxs-lookup"><span data-stu-id="7950c-261">To Lazy load modules, the call to require(‘module’) should be made when you actually need the module within the function before the first execution of module code.</span></span>
3. <span data-ttu-id="7950c-262">Azure Web Apps offers a feature called local cache.</span><span class="sxs-lookup"><span data-stu-id="7950c-262">Azure Web Apps offers a feature called local cache.</span></span> <span data-ttu-id="7950c-263">This feature copies your content from the network share to the local disk on the VM.</span><span class="sxs-lookup"><span data-stu-id="7950c-263">This feature copies your content from the network share to the local disk on the VM.</span></span> <span data-ttu-id="7950c-264">Since the files are local, the load time of node\_modules is much faster.</span><span class="sxs-lookup"><span data-stu-id="7950c-264">Since the files are local, the load time of node\_modules is much faster.</span></span>

## <a name="iisnode-http-status-and-substatus"></a><span data-ttu-id="7950c-265">IISNODE http status and substatus</span><span class="sxs-lookup"><span data-stu-id="7950c-265">IISNODE http status and substatus</span></span>

<span data-ttu-id="7950c-266">The `cnodeconstants` [source file](https://github.com/Azure/iisnode/blob/master/src/iisnode/cnodeconstants.h) lists all of the possible status/substatus combinations iisnode can return due to an error.</span><span class="sxs-lookup"><span data-stu-id="7950c-266">The `cnodeconstants` [source file](https://github.com/Azure/iisnode/blob/master/src/iisnode/cnodeconstants.h) lists all of the possible status/substatus combinations iisnode can return due to an error.</span></span>

<span data-ttu-id="7950c-267">Enable FREB for your application to see the win32 error code (be sure you enable FREB only on non-production sites for performance reasons).</span><span class="sxs-lookup"><span data-stu-id="7950c-267">Enable FREB for your application to see the win32 error code (be sure you enable FREB only on non-production sites for performance reasons).</span></span>

| <span data-ttu-id="7950c-268">Http Status</span><span class="sxs-lookup"><span data-stu-id="7950c-268">Http Status</span></span> | <span data-ttu-id="7950c-269">Http Substatus</span><span class="sxs-lookup"><span data-stu-id="7950c-269">Http Substatus</span></span> | <span data-ttu-id="7950c-270">Possible Reason?</span><span class="sxs-lookup"><span data-stu-id="7950c-270">Possible Reason?</span></span> |
| --- | --- | --- |
| <span data-ttu-id="7950c-271">500</span><span class="sxs-lookup"><span data-stu-id="7950c-271">500</span></span> |<span data-ttu-id="7950c-272">1000</span><span class="sxs-lookup"><span data-stu-id="7950c-272">1000</span></span> |<span data-ttu-id="7950c-273">There was some issue dispatching the request to IISNODE – Check if node.exe was started.</span><span class="sxs-lookup"><span data-stu-id="7950c-273">There was some issue dispatching the request to IISNODE – Check if node.exe was started.</span></span> <span data-ttu-id="7950c-274">Node.exe could have crashed when starting.</span><span class="sxs-lookup"><span data-stu-id="7950c-274">Node.exe could have crashed when starting.</span></span> <span data-ttu-id="7950c-275">Check your web.config configuration for errors.</span><span class="sxs-lookup"><span data-stu-id="7950c-275">Check your web.config configuration for errors.</span></span> |
| <span data-ttu-id="7950c-276">500</span><span class="sxs-lookup"><span data-stu-id="7950c-276">500</span></span> |<span data-ttu-id="7950c-277">1001</span><span class="sxs-lookup"><span data-stu-id="7950c-277">1001</span></span> |<span data-ttu-id="7950c-278">- Win32Error 0x2 - App is not responding to the URL.</span><span class="sxs-lookup"><span data-stu-id="7950c-278">- Win32Error 0x2 - App is not responding to the URL.</span></span> <span data-ttu-id="7950c-279">Check the URL rewrite rules or check if your express app has the correct routes defined.</span><span class="sxs-lookup"><span data-stu-id="7950c-279">Check the URL rewrite rules or check if your express app has the correct routes defined.</span></span> <span data-ttu-id="7950c-280">- Win32Error 0x6d – named pipe is busy – Node.exe is not accepting requests because the pipe is busy.</span><span class="sxs-lookup"><span data-stu-id="7950c-280">- Win32Error 0x6d – named pipe is busy – Node.exe is not accepting requests because the pipe is busy.</span></span> <span data-ttu-id="7950c-281">Check high cpu usage.</span><span class="sxs-lookup"><span data-stu-id="7950c-281">Check high cpu usage.</span></span> <span data-ttu-id="7950c-282">- Other errors – check if node.exe crashed.</span><span class="sxs-lookup"><span data-stu-id="7950c-282">- Other errors – check if node.exe crashed.</span></span> |
| <span data-ttu-id="7950c-283">500</span><span class="sxs-lookup"><span data-stu-id="7950c-283">500</span></span> |<span data-ttu-id="7950c-284">1002</span><span class="sxs-lookup"><span data-stu-id="7950c-284">1002</span></span> |<span data-ttu-id="7950c-285">Node.exe crashed – check d:\\home\\LogFiles\\logging-errors.txt for stack trace.</span><span class="sxs-lookup"><span data-stu-id="7950c-285">Node.exe crashed – check d:\\home\\LogFiles\\logging-errors.txt for stack trace.</span></span> |
| <span data-ttu-id="7950c-286">500</span><span class="sxs-lookup"><span data-stu-id="7950c-286">500</span></span> |<span data-ttu-id="7950c-287">1003</span><span class="sxs-lookup"><span data-stu-id="7950c-287">1003</span></span> |<span data-ttu-id="7950c-288">Pipe configuration Issue – The named pipe configuration is incorrect.</span><span class="sxs-lookup"><span data-stu-id="7950c-288">Pipe configuration Issue – The named pipe configuration is incorrect.</span></span> |
| <span data-ttu-id="7950c-289">500</span><span class="sxs-lookup"><span data-stu-id="7950c-289">500</span></span> |<span data-ttu-id="7950c-290">1004-1018</span><span class="sxs-lookup"><span data-stu-id="7950c-290">1004-1018</span></span> |<span data-ttu-id="7950c-291">There was some error while sending the request or processing the response to/from node.exe.</span><span class="sxs-lookup"><span data-stu-id="7950c-291">There was some error while sending the request or processing the response to/from node.exe.</span></span> <span data-ttu-id="7950c-292">Check if node.exe crashed.</span><span class="sxs-lookup"><span data-stu-id="7950c-292">Check if node.exe crashed.</span></span> <span data-ttu-id="7950c-293">check d:\\home\\LogFiles\\logging-errors.txt for stack trace.</span><span class="sxs-lookup"><span data-stu-id="7950c-293">check d:\\home\\LogFiles\\logging-errors.txt for stack trace.</span></span> |
| <span data-ttu-id="7950c-294">503</span><span class="sxs-lookup"><span data-stu-id="7950c-294">503</span></span> |<span data-ttu-id="7950c-295">1000</span><span class="sxs-lookup"><span data-stu-id="7950c-295">1000</span></span> |<span data-ttu-id="7950c-296">Not enough memory to allocate more named pipe connections.</span><span class="sxs-lookup"><span data-stu-id="7950c-296">Not enough memory to allocate more named pipe connections.</span></span> <span data-ttu-id="7950c-297">Check why your app is consuming so much memory.</span><span class="sxs-lookup"><span data-stu-id="7950c-297">Check why your app is consuming so much memory.</span></span> <span data-ttu-id="7950c-298">Check maxConcurrentRequestsPerProcess setting value.</span><span class="sxs-lookup"><span data-stu-id="7950c-298">Check maxConcurrentRequestsPerProcess setting value.</span></span> <span data-ttu-id="7950c-299">If it's not infinite and you have many requests, increase this value to prevent this error.</span><span class="sxs-lookup"><span data-stu-id="7950c-299">If it's not infinite and you have many requests, increase this value to prevent this error.</span></span> |
| <span data-ttu-id="7950c-300">503</span><span class="sxs-lookup"><span data-stu-id="7950c-300">503</span></span> |<span data-ttu-id="7950c-301">1001</span><span class="sxs-lookup"><span data-stu-id="7950c-301">1001</span></span> |<span data-ttu-id="7950c-302">Request could not be dispatched to node.exe because the application is recycling.</span><span class="sxs-lookup"><span data-stu-id="7950c-302">Request could not be dispatched to node.exe because the application is recycling.</span></span> <span data-ttu-id="7950c-303">After the application has recycled, requests should be served normally.</span><span class="sxs-lookup"><span data-stu-id="7950c-303">After the application has recycled, requests should be served normally.</span></span> |
| <span data-ttu-id="7950c-304">503</span><span class="sxs-lookup"><span data-stu-id="7950c-304">503</span></span> |<span data-ttu-id="7950c-305">1002</span><span class="sxs-lookup"><span data-stu-id="7950c-305">1002</span></span> |<span data-ttu-id="7950c-306">Check win32 error code for actual reason – Request could not be dispatched to a node.exe.</span><span class="sxs-lookup"><span data-stu-id="7950c-306">Check win32 error code for actual reason – Request could not be dispatched to a node.exe.</span></span> |
| <span data-ttu-id="7950c-307">503</span><span class="sxs-lookup"><span data-stu-id="7950c-307">503</span></span> |<span data-ttu-id="7950c-308">1003</span><span class="sxs-lookup"><span data-stu-id="7950c-308">1003</span></span> |<span data-ttu-id="7950c-309">Named pipe is too Busy – Verify if node.exe is consuming excessive CPU</span><span class="sxs-lookup"><span data-stu-id="7950c-309">Named pipe is too Busy – Verify if node.exe is consuming excessive CPU</span></span> |

<span data-ttu-id="7950c-310">NODE.exe has a setting called `NODE_PENDING_PIPE_INSTANCES`.</span><span class="sxs-lookup"><span data-stu-id="7950c-310">NODE.exe has a setting called `NODE_PENDING_PIPE_INSTANCES`.</span></span> <span data-ttu-id="7950c-311">By default, when not deployed on Azure Web Apps, this value is 4.</span><span class="sxs-lookup"><span data-stu-id="7950c-311">By default, when not deployed on Azure Web Apps, this value is 4.</span></span> <span data-ttu-id="7950c-312">Meaning that node.exe can only accept four requests at a time on the named pipe.</span><span class="sxs-lookup"><span data-stu-id="7950c-312">Meaning that node.exe can only accept four requests at a time on the named pipe.</span></span> <span data-ttu-id="7950c-313">On Azure Web Apps, this value is set to 5000.</span><span class="sxs-lookup"><span data-stu-id="7950c-313">On Azure Web Apps, this value is set to 5000.</span></span> <span data-ttu-id="7950c-314">This value should be good enough for most node applications running on Azure Web Apps.</span><span class="sxs-lookup"><span data-stu-id="7950c-314">This value should be good enough for most node applications running on Azure Web Apps.</span></span> <span data-ttu-id="7950c-315">You should not see 503.1003 on Azure Web Apps because of the high value for the `NODE_PENDING_PIPE_INSTANCES`</span><span class="sxs-lookup"><span data-stu-id="7950c-315">You should not see 503.1003 on Azure Web Apps because of the high value for the `NODE_PENDING_PIPE_INSTANCES`</span></span>

## <a name="more-resources"></a><span data-ttu-id="7950c-316">More resources</span><span class="sxs-lookup"><span data-stu-id="7950c-316">More resources</span></span>

<span data-ttu-id="7950c-317">Follow these links to learn more about node.js applications on Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="7950c-317">Follow these links to learn more about node.js applications on Azure App Service.</span></span>

* [<span data-ttu-id="7950c-318">Get started with Node.js Web Apps in Azure App Service</span><span class="sxs-lookup"><span data-stu-id="7950c-318">Get started with Node.js Web Apps in Azure App Service</span></span>](app-service-web-get-started-nodejs.md)
* [<span data-ttu-id="7950c-319">How to debug a Node.js web app in Azure App Service</span><span class="sxs-lookup"><span data-stu-id="7950c-319">How to debug a Node.js web app in Azure App Service</span></span>](app-service-web-tutorial-nodejs-mongodb-app.md)
* [<span data-ttu-id="7950c-320">Using Node.js Modules with Azure applications</span><span class="sxs-lookup"><span data-stu-id="7950c-320">Using Node.js Modules with Azure applications</span></span>](../nodejs-use-node-modules-azure-apps.md)
* [<span data-ttu-id="7950c-321">Azure App Service Web Apps: Node.js</span><span class="sxs-lookup"><span data-stu-id="7950c-321">Azure App Service Web Apps: Node.js</span></span>](https://blogs.msdn.microsoft.com/silverlining/2012/06/14/windows-azure-websites-node-js/)
* [<span data-ttu-id="7950c-322">Node.js Developer Center</span><span class="sxs-lookup"><span data-stu-id="7950c-322">Node.js Developer Center</span></span>](../nodejs-use-node-modules-azure-apps.md)
* [<span data-ttu-id="7950c-323">Exploring the Super Secret Kudu Debug Console</span><span class="sxs-lookup"><span data-stu-id="7950c-323">Exploring the Super Secret Kudu Debug Console</span></span>](https://azure.microsoft.com/documentation/videos/super-secret-kudu-debug-console-for-azure-web-sites/)